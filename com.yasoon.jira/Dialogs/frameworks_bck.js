


/* module-key = 'jira.webresources:empty-js', location = '/includes/jira/common/empty.js' */
function empty(){};
/* module-key = 'com.atlassian.auiplugin:jquery-lib', location = 'js/external/jquery/jquery.js' */
/*
 * jQuery JavaScript Library v1.7.2
 * http://jquery.com/
 *
 * Copyright 2011, John Resig
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 * Copyright 2011, The Dojo Foundation
 * Released under the MIT, BSD, and GPL Licenses.
 *
 * Date: Wed Mar 21 12:46:34 2012 -0700
 */
(function(window,undefined){var document=window.document,navigator=window.navigator,location=window.location;var jQuery=(function(){var jQuery=function(selector,context){return new jQuery.fn.init(selector,context,rootjQuery)},_jQuery=window.jQuery,_$=window.$,rootjQuery,quickExpr=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,rnotwhite=/\S/,trimLeft=/^\s+/,trimRight=/\s+$/,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,rvalidchars=/^[\],:{}\s]*$/,rvalidescape=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rvalidtokens=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rvalidbraces=/(?:^|:|,)(?:\s*\[)+/g,rwebkit=/(webkit)[ \/]([\w.]+)/,ropera=/(opera)(?:.*version)?[ \/]([\w.]+)/,rmsie=/(msie) ([\w.]+)/,rmozilla=/(mozilla)(?:.*? rv:([\w.]+))?/,rdashAlpha=/-([a-z]|[0-9])/ig,rmsPrefix=/^-ms-/,fcamelCase=function(all,letter){return(letter+"").toUpperCase()},userAgent=navigator.userAgent,browserMatch,readyList,DOMContentLoaded,toString=Object.prototype.toString,hasOwn=Object.prototype.hasOwnProperty,push=Array.prototype.push,slice=Array.prototype.slice,trim=String.prototype.trim,indexOf=Array.prototype.indexOf,class2type={};jQuery.fn=jQuery.prototype={constructor:jQuery,init:function(selector,context,rootjQuery){var match,elem,ret,doc;if(!selector){return this}if(selector.nodeType){this.context=this[0]=selector;this.length=1;return this}if(selector==="body"&&!context&&document.body){this.context=document;this[0]=document.body;this.selector=selector;this.length=1;return this}if(typeof selector==="string"){if(selector.charAt(0)==="<"&&selector.charAt(selector.length-1)===">"&&selector.length>=3){match=[null,selector,null]}else{match=quickExpr.exec(selector)}if(match&&(match[1]||!context)){if(match[1]){context=context instanceof jQuery?context[0]:context;doc=(context?context.ownerDocument||context:document);ret=rsingleTag.exec(selector);if(ret){if(jQuery.isPlainObject(context)){selector=[document.createElement(ret[1])];jQuery.fn.attr.call(selector,context,true)}else{selector=[doc.createElement(ret[1])]}}else{ret=jQuery.buildFragment([match[1]],[doc]);selector=(ret.cacheable?jQuery.clone(ret.fragment):ret.fragment).childNodes}return jQuery.merge(this,selector)}else{elem=document.getElementById(match[2]);if(elem&&elem.parentNode){if(elem.id!==match[2]){return rootjQuery.find(selector)}this.length=1;this[0]=elem}this.context=document;this.selector=selector;return this}}else{if(!context||context.jquery){return(context||rootjQuery).find(selector)}else{return this.constructor(context).find(selector)}}}else{if(jQuery.isFunction(selector)){return rootjQuery.ready(selector)}}if(selector.selector!==undefined){this.selector=selector.selector;this.context=selector.context}return jQuery.makeArray(selector,this)},selector:"",jquery:"1.7.2",length:0,size:function(){return this.length},toArray:function(){return slice.call(this,0)},get:function(num){return num==null?this.toArray():(num<0?this[this.length+num]:this[num])},pushStack:function(elems,name,selector){var ret=this.constructor();if(jQuery.isArray(elems)){push.apply(ret,elems)}else{jQuery.merge(ret,elems)}ret.prevObject=this;ret.context=this.context;if(name==="find"){ret.selector=this.selector+(this.selector?" ":"")+selector}else{if(name){ret.selector=this.selector+"."+name+"("+selector+")"}}return ret},each:function(callback,args){return jQuery.each(this,callback,args)},ready:function(fn){jQuery.bindReady();readyList.add(fn);return this},eq:function(i){i=+i;return i===-1?this.slice(i):this.slice(i,i+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(slice.apply(this,arguments),"slice",slice.call(arguments).join(","))},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},end:function(){return this.prevObject||this.constructor(null)},push:push,sort:[].sort,splice:[].splice};jQuery.fn.init.prototype=jQuery.fn;jQuery.extend=jQuery.fn.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;target=arguments[1]||{};i=2}if(typeof target!=="object"&&!jQuery.isFunction(target)){target={}}if(length===i){target=this;--i}for(;i<length;i++){if((options=arguments[i])!=null){for(name in options){src=target[name];copy=options[name];if(target===copy){continue}if(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&jQuery.isArray(src)?src:[]}else{clone=src&&jQuery.isPlainObject(src)?src:{}}target[name]=jQuery.extend(deep,clone,copy)}else{if(copy!==undefined){target[name]=copy}}}}}return target};jQuery.extend({noConflict:function(deep){if(window.$===jQuery){window.$=_$}if(deep&&window.jQuery===jQuery){window.jQuery=_jQuery}return jQuery},isReady:false,readyWait:1,holdReady:function(hold){if(hold){jQuery.readyWait++}else{jQuery.ready(true)}},ready:function(wait){if((wait===true&&!--jQuery.readyWait)||(wait!==true&&!jQuery.isReady)){if(!document.body){return setTimeout(jQuery.ready,1)}jQuery.isReady=true;if(wait!==true&&--jQuery.readyWait>0){return }readyList.fireWith(document,[jQuery]);if(jQuery.fn.trigger){jQuery(document).trigger("ready").off("ready")}}},bindReady:function(){if(readyList){return }readyList=jQuery.Callbacks("once memory");if(document.readyState==="complete"){return setTimeout(jQuery.ready,1)}if(document.addEventListener){document.addEventListener("DOMContentLoaded",DOMContentLoaded,false);window.addEventListener("load",jQuery.ready,false)}else{if(document.attachEvent){document.attachEvent("onreadystatechange",DOMContentLoaded);window.attachEvent("onload",jQuery.ready);var toplevel=false;try{toplevel=window.frameElement==null}catch(e){}if(document.documentElement.doScroll&&toplevel){doScrollCheck()}}}},isFunction:function(obj){return jQuery.type(obj)==="function"},isArray:Array.isArray||function(obj){return jQuery.type(obj)==="array"},isWindow:function(obj){return obj!=null&&obj==obj.window},isNumeric:function(obj){return !isNaN(parseFloat(obj))&&isFinite(obj)},type:function(obj){return obj==null?String(obj):class2type[toString.call(obj)]||"object"},isPlainObject:function(obj){if(!obj||jQuery.type(obj)!=="object"||obj.nodeType||jQuery.isWindow(obj)){return false}try{if(obj.constructor&&!hasOwn.call(obj,"constructor")&&!hasOwn.call(obj.constructor.prototype,"isPrototypeOf")){return false}}catch(e){return false}var key;for(key in obj){}return key===undefined||hasOwn.call(obj,key)},isEmptyObject:function(obj){for(var name in obj){return false}return true},error:function(msg){throw new Error(msg)},parseJSON:function(data){if(typeof data!=="string"||!data){return null}data=jQuery.trim(data);if(window.JSON&&window.JSON.parse){return window.JSON.parse(data)}if(rvalidchars.test(data.replace(rvalidescape,"@").replace(rvalidtokens,"]").replace(rvalidbraces,""))){return(new Function("return "+data))()}jQuery.error("Invalid JSON: "+data)},parseXML:function(data){if(typeof data!=="string"||!data){return null}var xml,tmp;try{if(window.DOMParser){tmp=new DOMParser();xml=tmp.parseFromString(data,"text/xml")}else{xml=new ActiveXObject("Microsoft.XMLDOM");xml.async="false";xml.loadXML(data)}}catch(e){xml=undefined}if(!xml||!xml.documentElement||xml.getElementsByTagName("parsererror").length){jQuery.error("Invalid XML: "+data)}return xml},noop:function(){},globalEval:function(data){if(data&&rnotwhite.test(data)){(window.execScript||function(data){window["eval"].call(window,data)})(data)}},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toUpperCase()===name.toUpperCase()},each:function(object,callback,args){var name,i=0,length=object.length,isObj=length===undefined||jQuery.isFunction(object);if(args){if(isObj){for(name in object){if(callback.apply(object[name],args)===false){break}}}else{for(;i<length;){if(callback.apply(object[i++],args)===false){break}}}}else{if(isObj){for(name in object){if(callback.call(object[name],name,object[name])===false){break}}}else{for(;i<length;){if(callback.call(object[i],i,object[i++])===false){break}}}}return object},trim:trim?function(text){return text==null?"":trim.call(text)}:function(text){return text==null?"":text.toString().replace(trimLeft,"").replace(trimRight,"")},makeArray:function(array,results){var ret=results||[];if(array!=null){var type=jQuery.type(array);if(array.length==null||type==="string"||type==="function"||type==="regexp"||jQuery.isWindow(array)){push.call(ret,array)}else{jQuery.merge(ret,array)}}return ret},inArray:function(elem,array,i){var len;if(array){if(indexOf){return indexOf.call(array,elem,i)}len=array.length;i=i?i<0?Math.max(0,len+i):i:0;for(;i<len;i++){if(i in array&&array[i]===elem){return i}}}return -1},merge:function(first,second){var i=first.length,j=0;if(typeof second.length==="number"){for(var l=second.length;j<l;j++){first[i++]=second[j]}}else{while(second[j]!==undefined){first[i++]=second[j++]}}first.length=i;return first},grep:function(elems,callback,inv){var ret=[],retVal;inv=!!inv;for(var i=0,length=elems.length;i<length;i++){retVal=!!callback(elems[i],i);if(inv!==retVal){ret.push(elems[i])}}return ret},map:function(elems,callback,arg){var value,key,ret=[],i=0,length=elems.length,isArray=elems instanceof jQuery||length!==undefined&&typeof length==="number"&&((length>0&&elems[0]&&elems[length-1])||length===0||jQuery.isArray(elems));if(isArray){for(;i<length;i++){value=callback(elems[i],i,arg);if(value!=null){ret[ret.length]=value}}}else{for(key in elems){value=callback(elems[key],key,arg);if(value!=null){ret[ret.length]=value}}}return ret.concat.apply([],ret)},guid:1,proxy:function(fn,context){if(typeof context==="string"){var tmp=fn[context];context=fn;fn=tmp}if(!jQuery.isFunction(fn)){return undefined}var args=slice.call(arguments,2),proxy=function(){return fn.apply(context,args.concat(slice.call(arguments)))};proxy.guid=fn.guid=fn.guid||proxy.guid||jQuery.guid++;return proxy},access:function(elems,fn,key,value,chainable,emptyGet,pass){var exec,bulk=key==null,i=0,length=elems.length;if(key&&typeof key==="object"){for(i in key){jQuery.access(elems,fn,i,key[i],1,emptyGet,value)}chainable=1}else{if(value!==undefined){exec=pass===undefined&&jQuery.isFunction(value);if(bulk){if(exec){exec=fn;fn=function(elem,key,value){return exec.call(jQuery(elem),value)}}else{fn.call(elems,value);fn=null}}if(fn){for(;i<length;i++){fn(elems[i],key,exec?value.call(elems[i],i,fn(elems[i],key)):value,pass)}}chainable=1}}return chainable?elems:bulk?fn.call(elems):length?fn(elems[0],key):emptyGet},now:function(){return(new Date()).getTime()},uaMatch:function(ua){ua=ua.toLowerCase();var match=rwebkit.exec(ua)||ropera.exec(ua)||rmsie.exec(ua)||ua.indexOf("compatible")<0&&rmozilla.exec(ua)||[];return{browser:match[1]||"",version:match[2]||"0"}},sub:function(){function jQuerySub(selector,context){return new jQuerySub.fn.init(selector,context)}jQuery.extend(true,jQuerySub,this);jQuerySub.superclass=this;jQuerySub.fn=jQuerySub.prototype=this();jQuerySub.fn.constructor=jQuerySub;jQuerySub.sub=this.sub;jQuerySub.fn.init=function init(selector,context){if(context&&context instanceof jQuery&&!(context instanceof jQuerySub)){context=jQuerySub(context)}return jQuery.fn.init.call(this,selector,context,rootjQuerySub)};jQuerySub.fn.init.prototype=jQuerySub.fn;var rootjQuerySub=jQuerySub(document);return jQuerySub},browser:{}});jQuery.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});browserMatch=jQuery.uaMatch(userAgent);if(browserMatch.browser){jQuery.browser[browserMatch.browser]=true;jQuery.browser.version=browserMatch.version}if(jQuery.browser.webkit){jQuery.browser.safari=true}if(rnotwhite.test("\xA0")){trimLeft=/^[\s\xA0]+/;trimRight=/[\s\xA0]+$/}rootjQuery=jQuery(document);if(document.addEventListener){DOMContentLoaded=function(){document.removeEventListener("DOMContentLoaded",DOMContentLoaded,false);jQuery.ready()}}else{if(document.attachEvent){DOMContentLoaded=function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",DOMContentLoaded);jQuery.ready()}}}}function doScrollCheck(){if(jQuery.isReady){return }try{document.documentElement.doScroll("left")}catch(e){setTimeout(doScrollCheck,1);return }jQuery.ready()}return jQuery})();var flagsCache={};function createFlags(flags){var object=flagsCache[flags]={},i,length;flags=flags.split(/\s+/);for(i=0,length=flags.length;i<length;i++){object[flags[i]]=true}return object}jQuery.Callbacks=function(flags){flags=flags?(flagsCache[flags]||createFlags(flags)):{};var list=[],stack=[],memory,fired,firing,firingStart,firingLength,firingIndex,add=function(args){var i,length,elem,type,actual;for(i=0,length=args.length;i<length;i++){elem=args[i];type=jQuery.type(elem);if(type==="array"){add(elem)}else{if(type==="function"){if(!flags.unique||!self.has(elem)){list.push(elem)}}}}},fire=function(context,args){args=args||[];memory=!flags.memory||[context,args];fired=true;firing=true;firingIndex=firingStart||0;firingStart=0;firingLength=list.length;for(;list&&firingIndex<firingLength;firingIndex++){if(list[firingIndex].apply(context,args)===false&&flags.stopOnFalse){memory=true;break}}firing=false;if(list){if(!flags.once){if(stack&&stack.length){memory=stack.shift();self.fireWith(memory[0],memory[1])}}else{if(memory===true){self.disable()}else{list=[]}}}},self={add:function(){if(list){var length=list.length;add(arguments);if(firing){firingLength=list.length}else{if(memory&&memory!==true){firingStart=length;fire(memory[0],memory[1])}}}return this},remove:function(){if(list){var args=arguments,argIndex=0,argLength=args.length;for(;argIndex<argLength;argIndex++){for(var i=0;i<list.length;i++){if(args[argIndex]===list[i]){if(firing){if(i<=firingLength){firingLength--;if(i<=firingIndex){firingIndex--}}}list.splice(i--,1);if(flags.unique){break}}}}}return this},has:function(fn){if(list){var i=0,length=list.length;for(;i<length;i++){if(fn===list[i]){return true}}}return false},empty:function(){list=[];return this},disable:function(){list=stack=memory=undefined;return this},disabled:function(){return !list},lock:function(){stack=undefined;if(!memory||memory===true){self.disable()}return this},locked:function(){return !stack},fireWith:function(context,args){if(stack){if(firing){if(!flags.once){stack.push([context,args])}}else{if(!(flags.once&&memory)){fire(context,args)}}}return this},fire:function(){self.fireWith(this,arguments);return this},fired:function(){return !!fired}};return self};var sliceDeferred=[].slice;jQuery.extend({Deferred:function(func){var doneList=jQuery.Callbacks("once memory"),failList=jQuery.Callbacks("once memory"),progressList=jQuery.Callbacks("memory"),state="pending",lists={resolve:doneList,reject:failList,notify:progressList},promise={done:doneList.add,fail:failList.add,progress:progressList.add,state:function(){return state},isResolved:doneList.fired,isRejected:failList.fired,then:function(doneCallbacks,failCallbacks,progressCallbacks){deferred.done(doneCallbacks).fail(failCallbacks).progress(progressCallbacks);return this},always:function(){deferred.done.apply(deferred,arguments).fail.apply(deferred,arguments);return this},pipe:function(fnDone,fnFail,fnProgress){return jQuery.Deferred(function(newDefer){jQuery.each({done:[fnDone,"resolve"],fail:[fnFail,"reject"],progress:[fnProgress,"notify"]},function(handler,data){var fn=data[0],action=data[1],returned;if(jQuery.isFunction(fn)){deferred[handler](function(){returned=fn.apply(this,arguments);if(returned&&jQuery.isFunction(returned.promise)){returned.promise().then(newDefer.resolve,newDefer.reject,newDefer.notify)}else{newDefer[action+"With"](this===deferred?newDefer:this,[returned])}})}else{deferred[handler](newDefer[action])}})}).promise()},promise:function(obj){if(obj==null){obj=promise}else{for(var key in promise){obj[key]=promise[key]}}return obj}},deferred=promise.promise({}),key;for(key in lists){deferred[key]=lists[key].fire;deferred[key+"With"]=lists[key].fireWith}deferred.done(function(){state="resolved"},failList.disable,progressList.lock).fail(function(){state="rejected"},doneList.disable,progressList.lock);if(func){func.call(deferred,deferred)}return deferred},when:function(firstParam){var args=sliceDeferred.call(arguments,0),i=0,length=args.length,pValues=new Array(length),count=length,pCount=length,deferred=length<=1&&firstParam&&jQuery.isFunction(firstParam.promise)?firstParam:jQuery.Deferred(),promise=deferred.promise();function resolveFunc(i){return function(value){args[i]=arguments.length>1?sliceDeferred.call(arguments,0):value;if(!(--count)){deferred.resolveWith(deferred,args)}}}function progressFunc(i){return function(value){pValues[i]=arguments.length>1?sliceDeferred.call(arguments,0):value;deferred.notifyWith(promise,pValues)}}if(length>1){for(;i<length;i++){if(args[i]&&args[i].promise&&jQuery.isFunction(args[i].promise)){args[i].promise().then(resolveFunc(i),deferred.reject,progressFunc(i))}else{--count}}if(!count){deferred.resolveWith(deferred,args)}}else{if(deferred!==firstParam){deferred.resolveWith(deferred,length?[firstParam]:[])}}return promise}});jQuery.support=(function(){var support,all,a,select,opt,input,fragment,tds,events,eventName,i,isSupported,div=document.createElement("div"),documentElement=document.documentElement;div.setAttribute("className","t");div.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>";all=div.getElementsByTagName("*");a=div.getElementsByTagName("a")[0];if(!all||!all.length||!a){return{}}select=document.createElement("select");opt=select.appendChild(document.createElement("option"));input=div.getElementsByTagName("input")[0];support={leadingWhitespace:(div.firstChild.nodeType===3),tbody:!div.getElementsByTagName("tbody").length,htmlSerialize:!!div.getElementsByTagName("link").length,style:/top/.test(a.getAttribute("style")),hrefNormalized:(a.getAttribute("href")==="/a"),opacity:/^0.55/.test(a.style.opacity),cssFloat:!!a.style.cssFloat,checkOn:(input.value==="on"),optSelected:opt.selected,getSetAttribute:div.className!=="t",enctype:!!document.createElement("form").enctype,html5Clone:document.createElement("nav").cloneNode(true).outerHTML!=="<:nav></:nav>",submitBubbles:true,changeBubbles:true,focusinBubbles:false,deleteExpando:true,noCloneEvent:true,inlineBlockNeedsLayout:false,shrinkWrapBlocks:false,reliableMarginRight:true,pixelMargin:true};jQuery.boxModel=support.boxModel=(document.compatMode==="CSS1Compat");input.checked=true;support.noCloneChecked=input.cloneNode(true).checked;select.disabled=true;support.optDisabled=!opt.disabled;try{delete div.test}catch(e){support.deleteExpando=false}if(!div.addEventListener&&div.attachEvent&&div.fireEvent){div.attachEvent("onclick",function(){support.noCloneEvent=false});div.cloneNode(true).fireEvent("onclick")}input=document.createElement("input");input.value="t";input.setAttribute("type","radio");support.radioValue=input.value==="t";input.setAttribute("checked","checked");input.setAttribute("name","t");div.appendChild(input);fragment=document.createDocumentFragment();fragment.appendChild(div.lastChild);support.checkClone=fragment.cloneNode(true).cloneNode(true).lastChild.checked;support.appendChecked=input.checked;fragment.removeChild(input);fragment.appendChild(div);if(div.attachEvent){for(i in {submit:1,change:1,focusin:1}){eventName="on"+i;isSupported=(eventName in div);if(!isSupported){div.setAttribute(eventName,"return;");isSupported=(typeof div[eventName]==="function")}support[i+"Bubbles"]=isSupported}}fragment.removeChild(div);fragment=select=opt=div=input=null;jQuery(function(){var container,outer,inner,table,td,offsetSupport,marginDiv,conMarginTop,style,html,positionTopLeftWidthHeight,paddingMarginBorderVisibility,paddingMarginBorder,body=document.getElementsByTagName("body")[0];if(!body){return }conMarginTop=1;paddingMarginBorder="padding:0;margin:0;border:";positionTopLeftWidthHeight="position:absolute;top:0;left:0;width:1px;height:1px;";paddingMarginBorderVisibility=paddingMarginBorder+"0;visibility:hidden;";style="style='"+positionTopLeftWidthHeight+paddingMarginBorder+"5px solid #000;";html="<div "+style+"display:block;'><div style='"+paddingMarginBorder+"0;display:block;overflow:hidden;'></div></div><table "+style+"' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";container=document.createElement("div");container.style.cssText=paddingMarginBorderVisibility+"width:0;height:0;position:static;top:0;margin-top:"+conMarginTop+"px";body.insertBefore(container,body.firstChild);div=document.createElement("div");container.appendChild(div);div.innerHTML="<table><tr><td style='"+paddingMarginBorder+"0;display:none'></td><td>t</td></tr></table>";tds=div.getElementsByTagName("td");isSupported=(tds[0].offsetHeight===0);tds[0].style.display="";tds[1].style.display="none";support.reliableHiddenOffsets=isSupported&&(tds[0].offsetHeight===0);if(window.getComputedStyle){div.innerHTML="";marginDiv=document.createElement("div");marginDiv.style.width="0";marginDiv.style.marginRight="0";div.style.width="2px";div.appendChild(marginDiv);support.reliableMarginRight=(parseInt((window.getComputedStyle(marginDiv,null)||{marginRight:0}).marginRight,10)||0)===0}if(typeof div.style.zoom!=="undefined"){div.innerHTML="";div.style.width=div.style.padding="1px";div.style.border=0;div.style.overflow="hidden";div.style.display="inline";div.style.zoom=1;support.inlineBlockNeedsLayout=(div.offsetWidth===3);div.style.display="block";div.style.overflow="visible";div.innerHTML="<div style='width:5px;'></div>";support.shrinkWrapBlocks=(div.offsetWidth!==3)}div.style.cssText=positionTopLeftWidthHeight+paddingMarginBorderVisibility;div.innerHTML=html;outer=div.firstChild;inner=outer.firstChild;td=outer.nextSibling.firstChild.firstChild;offsetSupport={doesNotAddBorder:(inner.offsetTop!==5),doesAddBorderForTableAndCells:(td.offsetTop===5)};inner.style.position="fixed";inner.style.top="20px";offsetSupport.fixedPosition=(inner.offsetTop===20||inner.offsetTop===15);inner.style.position=inner.style.top="";outer.style.overflow="hidden";outer.style.position="relative";offsetSupport.subtractsBorderForOverflowNotVisible=(inner.offsetTop===-5);offsetSupport.doesNotIncludeMarginInBodyOffset=(body.offsetTop!==conMarginTop);if(window.getComputedStyle){div.style.marginTop="1%";support.pixelMargin=(window.getComputedStyle(div,null)||{marginTop:0}).marginTop!=="1%"}if(typeof container.style.zoom!=="undefined"){container.style.zoom=1}body.removeChild(container);marginDiv=div=container=null;jQuery.extend(support,offsetSupport)});return support})();var rbrace=/^(?:\{.*\}|\[.*\])$/,rmultiDash=/([A-Z])/g;jQuery.extend({cache:{},uuid:0,expando:"jQuery"+(jQuery.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:true,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:true},hasData:function(elem){elem=elem.nodeType?jQuery.cache[elem[jQuery.expando]]:elem[jQuery.expando];return !!elem&&!isEmptyDataObject(elem)},data:function(elem,name,data,pvt){if(!jQuery.acceptData(elem)){return }var privateCache,thisCache,ret,internalKey=jQuery.expando,getByName=typeof name==="string",isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[internalKey]:elem[internalKey]&&internalKey,isEvents=name==="events";if((!id||!cache[id]||(!isEvents&&!pvt&&!cache[id].data))&&getByName&&data===undefined){return }if(!id){if(isNode){elem[internalKey]=id=++jQuery.uuid}else{id=internalKey}}if(!cache[id]){cache[id]={};if(!isNode){cache[id].toJSON=jQuery.noop}}if(typeof name==="object"||typeof name==="function"){if(pvt){cache[id]=jQuery.extend(cache[id],name)}else{cache[id].data=jQuery.extend(cache[id].data,name)}}privateCache=thisCache=cache[id];if(!pvt){if(!thisCache.data){thisCache.data={}}thisCache=thisCache.data}if(data!==undefined){thisCache[jQuery.camelCase(name)]=data}if(isEvents&&!thisCache[name]){return privateCache.events}if(getByName){ret=thisCache[name];if(ret==null){ret=thisCache[jQuery.camelCase(name)]}}else{ret=thisCache}return ret},removeData:function(elem,name,pvt){if(!jQuery.acceptData(elem)){return }var thisCache,i,l,internalKey=jQuery.expando,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[internalKey]:internalKey;if(!cache[id]){return }if(name){thisCache=pvt?cache[id]:cache[id].data;if(thisCache){if(!jQuery.isArray(name)){if(name in thisCache){name=[name]}else{name=jQuery.camelCase(name);if(name in thisCache){name=[name]}else{name=name.split(" ")}}}for(i=0,l=name.length;i<l;i++){delete thisCache[name[i]]}if(!(pvt?isEmptyDataObject:jQuery.isEmptyObject)(thisCache)){return }}}if(!pvt){delete cache[id].data;if(!isEmptyDataObject(cache[id])){return }}if(jQuery.support.deleteExpando||!cache.setInterval){delete cache[id]}else{cache[id]=null}if(isNode){if(jQuery.support.deleteExpando){delete elem[internalKey]}else{if(elem.removeAttribute){elem.removeAttribute(internalKey)}else{elem[internalKey]=null}}}},_data:function(elem,name,data){return jQuery.data(elem,name,data,true)},acceptData:function(elem){if(elem.nodeName){var match=jQuery.noData[elem.nodeName.toLowerCase()];if(match){return !(match===true||elem.getAttribute("classid")!==match)}}return true}});jQuery.fn.extend({data:function(key,value){var parts,part,attr,name,l,elem=this[0],i=0,data=null;if(key===undefined){if(this.length){data=jQuery.data(elem);if(elem.nodeType===1&&!jQuery._data(elem,"parsedAttrs")){attr=elem.attributes;for(l=attr.length;i<l;i++){name=attr[i].name;if(name.indexOf("data-")===0){name=jQuery.camelCase(name.substring(5));dataAttr(elem,name,data[name])}}jQuery._data(elem,"parsedAttrs",true)}}return data}if(typeof key==="object"){return this.each(function(){jQuery.data(this,key)})}parts=key.split(".",2);parts[1]=parts[1]?"."+parts[1]:"";part=parts[1]+"!";return jQuery.access(this,function(value){if(value===undefined){data=this.triggerHandler("getData"+part,[parts[0]]);if(data===undefined&&elem){data=jQuery.data(elem,key);data=dataAttr(elem,key,data)}return data===undefined&&parts[1]?this.data(parts[0]):data}parts[1]=value;this.each(function(){var self=jQuery(this);self.triggerHandler("setData"+part,parts);jQuery.data(this,key,value);self.triggerHandler("changeData"+part,parts)})},null,value,arguments.length>1,null,false)},removeData:function(key){return this.each(function(){jQuery.removeData(this,key)})}});function dataAttr(elem,key,data){if(data===undefined&&elem.nodeType===1){var name="data-"+key.replace(rmultiDash,"-$1").toLowerCase();data=elem.getAttribute(name);if(typeof data==="string"){try{data=data==="true"?true:data==="false"?false:data==="null"?null:jQuery.isNumeric(data)?+data:rbrace.test(data)?jQuery.parseJSON(data):data}catch(e){}jQuery.data(elem,key,data)}else{data=undefined}}return data}function isEmptyDataObject(obj){for(var name in obj){if(name==="data"&&jQuery.isEmptyObject(obj[name])){continue}if(name!=="toJSON"){return false}}return true}function handleQueueMarkDefer(elem,type,src){var deferDataKey=type+"defer",queueDataKey=type+"queue",markDataKey=type+"mark",defer=jQuery._data(elem,deferDataKey);if(defer&&(src==="queue"||!jQuery._data(elem,queueDataKey))&&(src==="mark"||!jQuery._data(elem,markDataKey))){setTimeout(function(){if(!jQuery._data(elem,queueDataKey)&&!jQuery._data(elem,markDataKey)){jQuery.removeData(elem,deferDataKey,true);defer.fire()}},0)}}jQuery.extend({_mark:function(elem,type){if(elem){type=(type||"fx")+"mark";jQuery._data(elem,type,(jQuery._data(elem,type)||0)+1)}},_unmark:function(force,elem,type){if(force!==true){type=elem;elem=force;force=false}if(elem){type=type||"fx";var key=type+"mark",count=force?0:((jQuery._data(elem,key)||1)-1);if(count){jQuery._data(elem,key,count)}else{jQuery.removeData(elem,key,true);handleQueueMarkDefer(elem,type,"mark")}}},queue:function(elem,type,data){var q;if(elem){type=(type||"fx")+"queue";q=jQuery._data(elem,type);if(data){if(!q||jQuery.isArray(data)){q=jQuery._data(elem,type,jQuery.makeArray(data))}else{q.push(data)}}return q||[]}},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),fn=queue.shift(),hooks={};if(fn==="inprogress"){fn=queue.shift()}if(fn){if(type==="fx"){queue.unshift("inprogress")}jQuery._data(elem,type+".run",hooks);fn.call(elem,function(){jQuery.dequeue(elem,type)},hooks)}if(!queue.length){jQuery.removeData(elem,type+"queue "+type+".run",true);handleQueueMarkDefer(elem,type,"queue")}}});jQuery.fn.extend({queue:function(type,data){var setter=2;if(typeof type!=="string"){data=type;type="fx";setter--}if(arguments.length<setter){return jQuery.queue(this[0],type)}return data===undefined?this:this.each(function(){var queue=jQuery.queue(this,type,data);if(type==="fx"&&queue[0]!=="inprogress"){jQuery.dequeue(this,type)}})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},delay:function(time,type){time=jQuery.fx?jQuery.fx.speeds[time]||time:time;type=type||"fx";return this.queue(type,function(next,hooks){var timeout=setTimeout(next,time);hooks.stop=function(){clearTimeout(timeout)}})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,object){if(typeof type!=="string"){object=type;type=undefined}type=type||"fx";var defer=jQuery.Deferred(),elements=this,i=elements.length,count=1,deferDataKey=type+"defer",queueDataKey=type+"queue",markDataKey=type+"mark",tmp;function resolve(){if(!(--count)){defer.resolveWith(elements,[elements])}}while(i--){if((tmp=jQuery.data(elements[i],deferDataKey,undefined,true)||(jQuery.data(elements[i],queueDataKey,undefined,true)||jQuery.data(elements[i],markDataKey,undefined,true))&&jQuery.data(elements[i],deferDataKey,jQuery.Callbacks("once memory"),true))){count++;tmp.add(resolve)}}resolve();return defer.promise(object)}});var rclass=/[\n\t\r]/g,rspace=/\s+/,rreturn=/\r/g,rtype=/^(?:button|input)$/i,rfocusable=/^(?:button|input|object|select|textarea)$/i,rclickable=/^a(?:rea)?$/i,rboolean=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,getSetAttribute=jQuery.support.getSetAttribute,nodeHook,boolHook,fixSpecified;jQuery.fn.extend({attr:function(name,value){return jQuery.access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})},prop:function(name,value){return jQuery.access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){name=jQuery.propFix[name]||name;return this.each(function(){try{this[name]=undefined;delete this[name]}catch(e){}})},addClass:function(value){var classNames,i,l,elem,setClass,c,cl;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className))})}if(value&&typeof value==="string"){classNames=value.split(rspace);for(i=0,l=this.length;i<l;i++){elem=this[i];if(elem.nodeType===1){if(!elem.className&&classNames.length===1){elem.className=value}else{setClass=" "+elem.className+" ";for(c=0,cl=classNames.length;c<cl;c++){if(!~setClass.indexOf(" "+classNames[c]+" ")){setClass+=classNames[c]+" "}}elem.className=jQuery.trim(setClass)}}}}return this},removeClass:function(value){var classNames,i,l,elem,className,c,cl;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className))})}if((value&&typeof value==="string")||value===undefined){classNames=(value||"").split(rspace);for(i=0,l=this.length;i<l;i++){elem=this[i];if(elem.nodeType===1&&elem.className){if(value){className=(" "+elem.className+" ").replace(rclass," ");for(c=0,cl=classNames.length;c<cl;c++){className=className.replace(" "+classNames[c]+" "," ")}elem.className=jQuery.trim(className)}else{elem.className=""}}}}return this},toggleClass:function(value,stateVal){var type=typeof value,isBool=typeof stateVal==="boolean";if(jQuery.isFunction(value)){return this.each(function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal)})}return this.each(function(){if(type==="string"){var className,i=0,self=jQuery(this),state=stateVal,classNames=value.split(rspace);while((className=classNames[i++])){state=isBool?state:!self.hasClass(className);self[state?"addClass":"removeClass"](className)}}else{if(type==="undefined"||type==="boolean"){if(this.className){jQuery._data(this,"__className__",this.className)}this.className=this.className||value===false?"":jQuery._data(this,"__className__")||""}}})},hasClass:function(selector){var className=" "+selector+" ",i=0,l=this.length;for(;i<l;i++){if(this[i].nodeType===1&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>-1){return true}}return false},val:function(value){var hooks,ret,isFunction,elem=this[0];if(!arguments.length){if(elem){hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()];if(hooks&&"get" in hooks&&(ret=hooks.get(elem,"value"))!==undefined){return ret}ret=elem.value;return typeof ret==="string"?ret.replace(rreturn,""):ret==null?"":ret}return }isFunction=jQuery.isFunction(value);return this.each(function(i){var self=jQuery(this),val;if(this.nodeType!==1){return }if(isFunction){val=value.call(this,i,self.val())}else{val=value}if(val==null){val=""}else{if(typeof val==="number"){val+=""}else{if(jQuery.isArray(val)){val=jQuery.map(val,function(value){return value==null?"":value+""})}}}hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()];if(!hooks||!("set" in hooks)||hooks.set(this,val,"value")===undefined){this.value=val}})}});jQuery.extend({valHooks:{option:{get:function(elem){var val=elem.attributes.value;return !val||val.specified?elem.value:elem.text}},select:{get:function(elem){var value,i,max,option,index=elem.selectedIndex,values=[],options=elem.options,one=elem.type==="select-one";if(index<0){return null}i=one?index:0;max=one?index+1:options.length;for(;i<max;i++){option=options[i];if(option.selected&&(jQuery.support.optDisabled?!option.disabled:option.getAttribute("disabled")===null)&&(!option.parentNode.disabled||!jQuery.nodeName(option.parentNode,"optgroup"))){value=jQuery(option).val();if(one){return value}values.push(value)}}if(one&&!values.length&&options.length){return jQuery(options[index]).val()}return values},set:function(elem,value){var values=jQuery.makeArray(value);jQuery(elem).find("option").each(function(){this.selected=jQuery.inArray(jQuery(this).val(),values)>=0});if(!values.length){elem.selectedIndex=-1}return values}}},attrFn:{val:true,css:true,html:true,text:true,data:true,width:true,height:true,offset:true},attr:function(elem,name,value,pass){var ret,hooks,notxml,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return }if(pass&&name in jQuery.attrFn){return jQuery(elem)[name](value)}if(typeof elem.getAttribute==="undefined"){return jQuery.prop(elem,name,value)}notxml=nType!==1||!jQuery.isXMLDoc(elem);if(notxml){name=name.toLowerCase();hooks=jQuery.attrHooks[name]||(rboolean.test(name)?boolHook:nodeHook)}if(value!==undefined){if(value===null){jQuery.removeAttr(elem,name);return }else{if(hooks&&"set" in hooks&&notxml&&(ret=hooks.set(elem,value,name))!==undefined){return ret}else{elem.setAttribute(name,""+value);return value}}}else{if(hooks&&"get" in hooks&&notxml&&(ret=hooks.get(elem,name))!==null){return ret}else{ret=elem.getAttribute(name);return ret===null?undefined:ret}}},removeAttr:function(elem,value){var propName,attrNames,name,l,isBool,i=0;if(value&&elem.nodeType===1){attrNames=value.toLowerCase().split(rspace);l=attrNames.length;for(;i<l;i++){name=attrNames[i];if(name){propName=jQuery.propFix[name]||name;isBool=rboolean.test(name);if(!isBool){jQuery.attr(elem,name,"")}elem.removeAttribute(getSetAttribute?name:propName);if(isBool&&propName in elem){elem[propName]=false}}}}},attrHooks:{type:{set:function(elem,value){if(rtype.test(elem.nodeName)&&elem.parentNode){jQuery.error("type property can't be changed")}else{if(!jQuery.support.radioValue&&value==="radio"&&jQuery.nodeName(elem,"input")){var val=elem.value;elem.setAttribute("type",value);if(val){elem.value=val}return value}}}},value:{get:function(elem,name){if(nodeHook&&jQuery.nodeName(elem,"button")){return nodeHook.get(elem,name)}return name in elem?elem.value:null},set:function(elem,value,name){if(nodeHook&&jQuery.nodeName(elem,"button")){return nodeHook.set(elem,value,name)}elem.value=value}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(elem,name,value){var ret,hooks,notxml,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return }notxml=nType!==1||!jQuery.isXMLDoc(elem);if(notxml){name=jQuery.propFix[name]||name;hooks=jQuery.propHooks[name]}if(value!==undefined){if(hooks&&"set" in hooks&&(ret=hooks.set(elem,value,name))!==undefined){return ret}else{return(elem[name]=value)}}else{if(hooks&&"get" in hooks&&(ret=hooks.get(elem,name))!==null){return ret}else{return elem[name]}}},propHooks:{tabIndex:{get:function(elem){var attributeNode=elem.getAttributeNode("tabindex");return attributeNode&&attributeNode.specified?parseInt(attributeNode.value,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:undefined}}}});jQuery.attrHooks.tabindex=jQuery.propHooks.tabIndex;boolHook={get:function(elem,name){var attrNode,property=jQuery.prop(elem,name);return property===true||typeof property!=="boolean"&&(attrNode=elem.getAttributeNode(name))&&attrNode.nodeValue!==false?name.toLowerCase():undefined},set:function(elem,value,name){var propName;if(value===false){jQuery.removeAttr(elem,name)}else{propName=jQuery.propFix[name]||name;if(propName in elem){elem[propName]=true}elem.setAttribute(name,name.toLowerCase())}return name}};if(!getSetAttribute){fixSpecified={name:true,id:true,coords:true};nodeHook=jQuery.valHooks.button={get:function(elem,name){var ret;ret=elem.getAttributeNode(name);return ret&&(fixSpecified[name]?ret.nodeValue!=="":ret.specified)?ret.nodeValue:undefined},set:function(elem,value,name){var ret=elem.getAttributeNode(name);if(!ret){ret=document.createAttribute(name);elem.setAttributeNode(ret)}return(ret.nodeValue=value+"")}};jQuery.attrHooks.tabindex.set=nodeHook.set;jQuery.each(["width","height"],function(i,name){jQuery.attrHooks[name]=jQuery.extend(jQuery.attrHooks[name],{set:function(elem,value){if(value===""){elem.setAttribute(name,"auto");return value}}})});jQuery.attrHooks.contenteditable={get:nodeHook.get,set:function(elem,value,name){if(value===""){value="false"}nodeHook.set(elem,value,name)}}}if(!jQuery.support.hrefNormalized){jQuery.each(["href","src","width","height"],function(i,name){jQuery.attrHooks[name]=jQuery.extend(jQuery.attrHooks[name],{get:function(elem){var ret=elem.getAttribute(name,2);return ret===null?undefined:ret}})})}if(!jQuery.support.style){jQuery.attrHooks.style={get:function(elem){return elem.style.cssText.toLowerCase()||undefined},set:function(elem,value){return(elem.style.cssText=""+value)}}}if(!jQuery.support.optSelected){jQuery.propHooks.selected=jQuery.extend(jQuery.propHooks.selected,{get:function(elem){var parent=elem.parentNode;if(parent){parent.selectedIndex;if(parent.parentNode){parent.parentNode.selectedIndex}}return null}})}if(!jQuery.support.enctype){jQuery.propFix.enctype="encoding"}if(!jQuery.support.checkOn){jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={get:function(elem){return elem.getAttribute("value")===null?"on":elem.value}}})}jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]=jQuery.extend(jQuery.valHooks[this],{set:function(elem,value){if(jQuery.isArray(value)){return(elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0)}}})});var rformElems=/^(?:textarea|input|select)$/i,rtypenamespace=/^([^\.]*)?(?:\.(.+))?$/,rhoverHack=/(?:^|\s)hover(\.\S+)?\b/,rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rquickIs=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,quickParse=function(selector){var quick=rquickIs.exec(selector);if(quick){quick[1]=(quick[1]||"").toLowerCase();quick[3]=quick[3]&&new RegExp("(?:^|\\s)"+quick[3]+"(?:\\s|$)")}return quick},quickIs=function(elem,m){var attrs=elem.attributes||{};return((!m[1]||elem.nodeName.toLowerCase()===m[1])&&(!m[2]||(attrs.id||{}).value===m[2])&&(!m[3]||m[3].test((attrs["class"]||{}).value)))},hoverHack=function(events){return jQuery.event.special.hover?events:events.replace(rhoverHack,"mouseenter$1 mouseleave$1")};jQuery.event={add:function(elem,types,handler,data,selector){var elemData,eventHandle,events,t,tns,type,namespaces,handleObj,handleObjIn,quick,handlers,special;if(elem.nodeType===3||elem.nodeType===8||!types||!handler||!(elemData=jQuery._data(elem))){return }if(handler.handler){handleObjIn=handler;handler=handleObjIn.handler;selector=handleObjIn.selector}if(!handler.guid){handler.guid=jQuery.guid++}events=elemData.events;if(!events){elemData.events=events={}}eventHandle=elemData.handle;if(!eventHandle){elemData.handle=eventHandle=function(e){return typeof jQuery!=="undefined"&&(!e||jQuery.event.triggered!==e.type)?jQuery.event.dispatch.apply(eventHandle.elem,arguments):undefined};eventHandle.elem=elem}types=jQuery.trim(hoverHack(types)).split(" ");for(t=0;t<types.length;t++){tns=rtypenamespace.exec(types[t])||[];type=tns[1];namespaces=(tns[2]||"").split(".").sort();special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;special=jQuery.event.special[type]||{};handleObj=jQuery.extend({type:type,origType:tns[1],data:data,handler:handler,guid:handler.guid,selector:selector,quick:selector&&quickParse(selector),namespace:namespaces.join(".")},handleObjIn);handlers=events[type];if(!handlers){handlers=events[type]=[];handlers.delegateCount=0;if(!special.setup||special.setup.call(elem,data,namespaces,eventHandle)===false){if(elem.addEventListener){elem.addEventListener(type,eventHandle,false)}else{if(elem.attachEvent){elem.attachEvent("on"+type,eventHandle)}}}}if(special.add){special.add.call(elem,handleObj);if(!handleObj.handler.guid){handleObj.handler.guid=handler.guid}}if(selector){handlers.splice(handlers.delegateCount++,0,handleObj)}else{handlers.push(handleObj)}jQuery.event.global[type]=true}elem=null},global:{},remove:function(elem,types,handler,selector,mappedTypes){var elemData=jQuery.hasData(elem)&&jQuery._data(elem),t,tns,type,origType,namespaces,origCount,j,events,special,handle,eventType,handleObj;if(!elemData||!(events=elemData.events)){return }types=jQuery.trim(hoverHack(types||"")).split(" ");for(t=0;t<types.length;t++){tns=rtypenamespace.exec(types[t])||[];type=origType=tns[1];namespaces=tns[2];if(!type){for(type in events){jQuery.event.remove(elem,type+types[t],handler,selector,true)}continue}special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;eventType=events[type]||[];origCount=eventType.length;namespaces=namespaces?new RegExp("(^|\\.)"+namespaces.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null;for(j=0;j<eventType.length;j++){handleObj=eventType[j];if((mappedTypes||origType===handleObj.origType)&&(!handler||handler.guid===handleObj.guid)&&(!namespaces||namespaces.test(handleObj.namespace))&&(!selector||selector===handleObj.selector||selector==="**"&&handleObj.selector)){eventType.splice(j--,1);if(handleObj.selector){eventType.delegateCount--}if(special.remove){special.remove.call(elem,handleObj)}}}if(eventType.length===0&&origCount!==eventType.length){if(!special.teardown||special.teardown.call(elem,namespaces)===false){jQuery.removeEvent(elem,type,elemData.handle)}delete events[type]}}if(jQuery.isEmptyObject(events)){handle=elemData.handle;if(handle){handle.elem=null}jQuery.removeData(elem,["events","handle"],true)}},customEvent:{getData:true,setData:true,changeData:true},trigger:function(event,data,elem,onlyHandlers){if(elem&&(elem.nodeType===3||elem.nodeType===8)){return }var type=event.type||event,namespaces=[],cache,exclusive,i,cur,old,ontype,special,handle,eventPath,bubbleType;if(rfocusMorph.test(type+jQuery.event.triggered)){return }if(type.indexOf("!")>=0){type=type.slice(0,-1);exclusive=true}if(type.indexOf(".")>=0){namespaces=type.split(".");type=namespaces.shift();namespaces.sort()}if((!elem||jQuery.event.customEvent[type])&&!jQuery.event.global[type]){return }event=typeof event==="object"?event[jQuery.expando]?event:new jQuery.Event(type,event):new jQuery.Event(type);event.type=type;event.isTrigger=true;event.exclusive=exclusive;event.namespace=namespaces.join(".");event.namespace_re=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.)?")+"(\\.|$)"):null;ontype=type.indexOf(":")<0?"on"+type:"";if(!elem){cache=jQuery.cache;for(i in cache){if(cache[i].events&&cache[i].events[type]){jQuery.event.trigger(event,data,cache[i].handle.elem,true)}}return }event.result=undefined;if(!event.target){event.target=elem}data=data!=null?jQuery.makeArray(data):[];data.unshift(event);special=jQuery.event.special[type]||{};if(special.trigger&&special.trigger.apply(elem,data)===false){return }eventPath=[[elem,special.bindType||type]];if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){bubbleType=special.delegateType||type;cur=rfocusMorph.test(bubbleType+type)?elem:elem.parentNode;old=null;for(;cur;cur=cur.parentNode){eventPath.push([cur,bubbleType]);old=cur}if(old&&old===elem.ownerDocument){eventPath.push([old.defaultView||old.parentWindow||window,bubbleType])}}for(i=0;i<eventPath.length&&!event.isPropagationStopped();i++){cur=eventPath[i][0];event.type=eventPath[i][1];handle=(jQuery._data(cur,"events")||{})[event.type]&&jQuery._data(cur,"handle");if(handle){handle.apply(cur,data)}handle=ontype&&cur[ontype];if(handle&&jQuery.acceptData(cur)&&handle.apply(cur,data)===false){event.preventDefault()}}event.type=type;if(!onlyHandlers&&!event.isDefaultPrevented()){if((!special._default||special._default.apply(elem.ownerDocument,data)===false)&&!(type==="click"&&jQuery.nodeName(elem,"a"))&&jQuery.acceptData(elem)){if(ontype&&elem[type]&&((type!=="focus"&&type!=="blur")||event.target.offsetWidth!==0)&&!jQuery.isWindow(elem)){old=elem[ontype];if(old){elem[ontype]=null}jQuery.event.triggered=type;elem[type]();jQuery.event.triggered=undefined;if(old){elem[ontype]=old}}}}return event.result},dispatch:function(event){event=jQuery.event.fix(event||window.event);var handlers=((jQuery._data(this,"events")||{})[event.type]||[]),delegateCount=handlers.delegateCount,args=[].slice.call(arguments,0),run_all=!event.exclusive&&!event.namespace,special=jQuery.event.special[event.type]||{},handlerQueue=[],i,j,cur,jqcur,ret,selMatch,matched,matches,handleObj,sel,related;args[0]=event;event.delegateTarget=this;if(special.preDispatch&&special.preDispatch.call(this,event)===false){return }if(delegateCount&&!(event.button&&event.type==="click")){jqcur=jQuery(this);jqcur.context=this.ownerDocument||this;for(cur=event.target;cur!=this;cur=cur.parentNode||this){if(cur.disabled!==true){selMatch={};matches=[];jqcur[0]=cur;for(i=0;i<delegateCount;i++){handleObj=handlers[i];sel=handleObj.selector;if(selMatch[sel]===undefined){selMatch[sel]=(handleObj.quick?quickIs(cur,handleObj.quick):jqcur.is(sel))}if(selMatch[sel]){matches.push(handleObj)}}if(matches.length){handlerQueue.push({elem:cur,matches:matches})}}}}if(handlers.length>delegateCount){handlerQueue.push({elem:this,matches:handlers.slice(delegateCount)})}for(i=0;i<handlerQueue.length&&!event.isPropagationStopped();i++){matched=handlerQueue[i];event.currentTarget=matched.elem;for(j=0;j<matched.matches.length&&!event.isImmediatePropagationStopped();j++){handleObj=matched.matches[j];if(run_all||(!event.namespace&&!handleObj.namespace)||event.namespace_re&&event.namespace_re.test(handleObj.namespace)){event.data=handleObj.data;event.handleObj=handleObj;ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args);if(ret!==undefined){event.result=ret;if(ret===false){event.preventDefault();event.stopPropagation()}}}}}if(special.postDispatch){special.postDispatch.call(this,event)}return event.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){if(event.which==null){event.which=original.charCode!=null?original.charCode:original.keyCode}return event}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var eventDoc,doc,body,button=original.button,fromElement=original.fromElement;if(event.pageX==null&&original.clientX!=null){eventDoc=event.target.ownerDocument||document;doc=eventDoc.documentElement;body=eventDoc.body;event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)}if(!event.relatedTarget&&fromElement){event.relatedTarget=fromElement===event.target?original.toElement:fromElement}if(!event.which&&button!==undefined){event.which=(button&1?1:(button&2?3:(button&4?2:0)))}return event}},fix:function(event){if(event[jQuery.expando]){return event}var i,prop,originalEvent=event,fixHook=jQuery.event.fixHooks[event.type]||{},copy=fixHook.props?this.props.concat(fixHook.props):this.props;event=jQuery.Event(originalEvent);for(i=copy.length;i;){prop=copy[--i];event[prop]=originalEvent[prop]}if(!event.target){event.target=originalEvent.srcElement||document}if(event.target.nodeType===3){event.target=event.target.parentNode}if(event.metaKey===undefined){event.metaKey=event.ctrlKey}return fixHook.filter?fixHook.filter(event,originalEvent):event},special:{ready:{setup:jQuery.bindReady},load:{noBubble:true},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(data,namespaces,eventHandle){if(jQuery.isWindow(this)){this.onbeforeunload=eventHandle}},teardown:function(namespaces,eventHandle){if(this.onbeforeunload===eventHandle){this.onbeforeunload=null}}}},simulate:function(type,elem,event,bubble){var e=jQuery.extend(new jQuery.Event(),event,{type:type,isSimulated:true,originalEvent:{}});if(bubble){jQuery.event.trigger(e,null,elem)}else{jQuery.event.dispatch.call(elem,e)}if(e.isDefaultPrevented()){event.preventDefault()}}};jQuery.event.handle=jQuery.event.dispatch;jQuery.removeEvent=document.removeEventListener?function(elem,type,handle){if(elem.removeEventListener){elem.removeEventListener(type,handle,false)}}:function(elem,type,handle){if(elem.detachEvent){elem.detachEvent("on"+type,handle)}};jQuery.Event=function(src,props){if(!(this instanceof jQuery.Event)){return new jQuery.Event(src,props)}if(src&&src.type){this.originalEvent=src;this.type=src.type;this.isDefaultPrevented=(src.defaultPrevented||src.returnValue===false||src.getPreventDefault&&src.getPreventDefault())?returnTrue:returnFalse}else{this.type=src}if(props){jQuery.extend(this,props)}this.timeStamp=src&&src.timeStamp||jQuery.now();this[jQuery.expando]=true};function returnFalse(){return false}function returnTrue(){return true}jQuery.Event.prototype={preventDefault:function(){this.isDefaultPrevented=returnTrue;var e=this.originalEvent;if(!e){return }if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}},stopPropagation:function(){this.isPropagationStopped=returnTrue;var e=this.originalEvent;if(!e){return }if(e.stopPropagation){e.stopPropagation()}e.cancelBubble=true},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=returnTrue;this.stopPropagation()},isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse};jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var target=this,related=event.relatedTarget,handleObj=event.handleObj,selector=handleObj.selector,ret;if(!related||(related!==target&&!jQuery.contains(target,related))){event.type=handleObj.origType;ret=handleObj.handler.apply(this,arguments);event.type=fix}return ret}}});if(!jQuery.support.submitBubbles){jQuery.event.special.submit={setup:function(){if(jQuery.nodeName(this,"form")){return false}jQuery.event.add(this,"click._submit keypress._submit",function(e){var elem=e.target,form=jQuery.nodeName(elem,"input")||jQuery.nodeName(elem,"button")?elem.form:undefined;if(form&&!form._submit_attached){jQuery.event.add(form,"submit._submit",function(event){event._submit_bubble=true});form._submit_attached=true}})},postDispatch:function(event){if(event._submit_bubble){delete event._submit_bubble;if(this.parentNode&&!event.isTrigger){jQuery.event.simulate("submit",this.parentNode,event,true)}}},teardown:function(){if(jQuery.nodeName(this,"form")){return false}jQuery.event.remove(this,"._submit")}}}if(!jQuery.support.changeBubbles){jQuery.event.special.change={setup:function(){if(rformElems.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio"){jQuery.event.add(this,"propertychange._change",function(event){if(event.originalEvent.propertyName==="checked"){this._just_changed=true}});jQuery.event.add(this,"click._change",function(event){if(this._just_changed&&!event.isTrigger){this._just_changed=false;jQuery.event.simulate("change",this,event,true)}})}return false}jQuery.event.add(this,"beforeactivate._change",function(e){var elem=e.target;if(rformElems.test(elem.nodeName)&&!elem._change_attached){jQuery.event.add(elem,"change._change",function(event){if(this.parentNode&&!event.isSimulated&&!event.isTrigger){jQuery.event.simulate("change",this.parentNode,event,true)}});elem._change_attached=true}})},handle:function(event){var elem=event.target;if(this!==elem||event.isSimulated||event.isTrigger||(elem.type!=="radio"&&elem.type!=="checkbox")){return event.handleObj.handler.apply(this,arguments)}},teardown:function(){jQuery.event.remove(this,"._change");return rformElems.test(this.nodeName)}}}if(!jQuery.support.focusinBubbles){jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var attaches=0,handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),true)};jQuery.event.special[fix]={setup:function(){if(attaches++===0){document.addEventListener(orig,handler,true)}},teardown:function(){if(--attaches===0){document.removeEventListener(orig,handler,true)}}}})}jQuery.fn.extend({on:function(types,selector,data,fn,one){var origFn,type;if(typeof types==="object"){if(typeof selector!=="string"){data=data||selector;selector=undefined}for(type in types){this.on(type,selector,data,types[type],one)}return this}if(data==null&&fn==null){fn=selector;data=selector=undefined}else{if(fn==null){if(typeof selector==="string"){fn=data;data=undefined}else{fn=data;data=selector;selector=undefined}}}if(fn===false){fn=returnFalse}else{if(!fn){return this}}if(one===1){origFn=fn;fn=function(event){jQuery().off(event);return origFn.apply(this,arguments)};fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)}return this.each(function(){jQuery.event.add(this,types,fn,data,selector)})},one:function(types,selector,data,fn){return this.on(types,selector,data,fn,1)},off:function(types,selector,fn){if(types&&types.preventDefault&&types.handleObj){var handleObj=types.handleObj;jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler);return this}if(typeof types==="object"){for(var type in types){this.off(type,selector,types[type])}return this}if(selector===false||typeof selector==="function"){fn=selector;selector=undefined}if(fn===false){fn=returnFalse}return this.each(function(){jQuery.event.remove(this,types,fn,selector)})},bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},live:function(types,data,fn){jQuery(this.context).on(types,this.selector,data,fn);return this},die:function(types,fn){jQuery(this.context).off(types,this.selector||"**",fn);return this},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return arguments.length==1?this.off(selector,"**"):this.off(types,selector,fn)},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){if(this[0]){return jQuery.event.trigger(type,data,this[0],true)}},toggle:function(fn){var args=arguments,guid=fn.guid||jQuery.guid++,i=0,toggler=function(event){var lastToggle=(jQuery._data(this,"lastToggle"+fn.guid)||0)%i;jQuery._data(this,"lastToggle"+fn.guid,lastToggle+1);event.preventDefault();return args[lastToggle].apply(this,arguments)||false};toggler.guid=guid;while(i<args.length){args[i++].guid=guid}return this.click(toggler)},hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)}});jQuery.each(("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu").split(" "),function(i,name){jQuery.fn[name]=function(data,fn){if(fn==null){fn=data;data=null}return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)};if(jQuery.attrFn){jQuery.attrFn[name]=true}if(rkeyEvent.test(name)){jQuery.event.fixHooks[name]=jQuery.event.keyHooks}if(rmouseEvent.test(name)){jQuery.event.fixHooks[name]=jQuery.event.mouseHooks}});
/*
 * Sizzle CSS Selector Engine
 *  Copyright 2011, The Dojo Foundation
 *  Released under the MIT, BSD, and GPL Licenses.
 *  More information: http://sizzlejs.com/
 */
(function(){var chunker=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,expando="sizcache"+(Math.random()+"").replace(".",""),done=0,toString=Object.prototype.toString,hasDuplicate=false,baseHasDuplicate=true,rBackslash=/\\/g,rReturn=/\r\n/g,rNonWord=/\W/;[0,0].sort(function(){baseHasDuplicate=false;return 0});var Sizzle=function(selector,context,results,seed){results=results||[];context=context||document;var origContext=context;if(context.nodeType!==1&&context.nodeType!==9){return[]}if(!selector||typeof selector!=="string"){return results}var m,set,checkSet,extra,ret,cur,pop,i,prune=true,contextXML=Sizzle.isXML(context),parts=[],soFar=selector;do{chunker.exec("");m=chunker.exec(soFar);if(m){soFar=m[3];parts.push(m[1]);if(m[2]){extra=m[3];break}}}while(m);if(parts.length>1&&origPOS.exec(selector)){if(parts.length===2&&Expr.relative[parts[0]]){set=posProcess(parts[0]+parts[1],context,seed)}else{set=Expr.relative[parts[0]]?[context]:Sizzle(parts.shift(),context);while(parts.length){selector=parts.shift();if(Expr.relative[selector]){selector+=parts.shift()}set=posProcess(selector,set,seed)}}}else{if(!seed&&parts.length>1&&context.nodeType===9&&!contextXML&&Expr.match.ID.test(parts[0])&&!Expr.match.ID.test(parts[parts.length-1])){ret=Sizzle.find(parts.shift(),context,contextXML);context=ret.expr?Sizzle.filter(ret.expr,ret.set)[0]:ret.set[0]}if(context){ret=seed?{expr:parts.pop(),set:makeArray(seed)}:Sizzle.find(parts.pop(),parts.length===1&&(parts[0]==="~"||parts[0]==="+")&&context.parentNode?context.parentNode:context,contextXML);set=ret.expr?Sizzle.filter(ret.expr,ret.set):ret.set;if(parts.length>0){checkSet=makeArray(set)}else{prune=false}while(parts.length){cur=parts.pop();pop=cur;if(!Expr.relative[cur]){cur=""}else{pop=parts.pop()}if(pop==null){pop=context}Expr.relative[cur](checkSet,pop,contextXML)}}else{checkSet=parts=[]}}if(!checkSet){checkSet=set}if(!checkSet){Sizzle.error(cur||selector)}if(toString.call(checkSet)==="[object Array]"){if(!prune){results.push.apply(results,checkSet)}else{if(context&&context.nodeType===1){for(i=0;checkSet[i]!=null;i++){if(checkSet[i]&&(checkSet[i]===true||checkSet[i].nodeType===1&&Sizzle.contains(context,checkSet[i]))){results.push(set[i])}}}else{for(i=0;checkSet[i]!=null;i++){if(checkSet[i]&&checkSet[i].nodeType===1){results.push(set[i])}}}}}else{makeArray(checkSet,results)}if(extra){Sizzle(extra,origContext,results,seed);Sizzle.uniqueSort(results)}return results};Sizzle.uniqueSort=function(results){if(sortOrder){hasDuplicate=baseHasDuplicate;results.sort(sortOrder);if(hasDuplicate){for(var i=1;i<results.length;i++){if(results[i]===results[i-1]){results.splice(i--,1)}}}}return results};Sizzle.matches=function(expr,set){return Sizzle(expr,null,null,set)};Sizzle.matchesSelector=function(node,expr){return Sizzle(expr,null,null,[node]).length>0};Sizzle.find=function(expr,context,isXML){var set,i,len,match,type,left;if(!expr){return[]}for(i=0,len=Expr.order.length;i<len;i++){type=Expr.order[i];if((match=Expr.leftMatch[type].exec(expr))){left=match[1];match.splice(1,1);if(left.substr(left.length-1)!=="\\"){match[1]=(match[1]||"").replace(rBackslash,"");set=Expr.find[type](match,context,isXML);if(set!=null){expr=expr.replace(Expr.match[type],"");break}}}}if(!set){set=typeof context.getElementsByTagName!=="undefined"?context.getElementsByTagName("*"):[]}return{set:set,expr:expr}};Sizzle.filter=function(expr,set,inplace,not){var match,anyFound,type,found,item,filter,left,i,pass,old=expr,result=[],curLoop=set,isXMLFilter=set&&set[0]&&Sizzle.isXML(set[0]);while(expr&&set.length){for(type in Expr.filter){if((match=Expr.leftMatch[type].exec(expr))!=null&&match[2]){filter=Expr.filter[type];left=match[1];anyFound=false;match.splice(1,1);if(left.substr(left.length-1)==="\\"){continue}if(curLoop===result){result=[]}if(Expr.preFilter[type]){match=Expr.preFilter[type](match,curLoop,inplace,result,not,isXMLFilter);if(!match){anyFound=found=true}else{if(match===true){continue}}}if(match){for(i=0;(item=curLoop[i])!=null;i++){if(item){found=filter(item,match,i,curLoop);pass=not^found;if(inplace&&found!=null){if(pass){anyFound=true}else{curLoop[i]=false}}else{if(pass){result.push(item);anyFound=true}}}}}if(found!==undefined){if(!inplace){curLoop=result}expr=expr.replace(Expr.match[type],"");if(!anyFound){return[]}break}}}if(expr===old){if(anyFound==null){Sizzle.error(expr)}else{break}}old=expr}return curLoop};Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)};var getText=Sizzle.getText=function(elem){var i,node,nodeType=elem.nodeType,ret="";if(nodeType){if(nodeType===1||nodeType===9||nodeType===11){if(typeof elem.textContent==="string"){return elem.textContent}else{if(typeof elem.innerText==="string"){return elem.innerText.replace(rReturn,"")}else{for(elem=elem.firstChild;elem;elem=elem.nextSibling){ret+=getText(elem)}}}}else{if(nodeType===3||nodeType===4){return elem.nodeValue}}}else{for(i=0;(node=elem[i]);i++){if(node.nodeType!==8){ret+=getText(node)}}}return ret};var Expr=Sizzle.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(elem){return elem.getAttribute("href")},type:function(elem){return elem.getAttribute("type")}},relative:{"+":function(checkSet,part){var isPartStr=typeof part==="string",isTag=isPartStr&&!rNonWord.test(part),isPartStrNotTag=isPartStr&&!isTag;if(isTag){part=part.toLowerCase()}for(var i=0,l=checkSet.length,elem;i<l;i++){if((elem=checkSet[i])){while((elem=elem.previousSibling)&&elem.nodeType!==1){}checkSet[i]=isPartStrNotTag||elem&&elem.nodeName.toLowerCase()===part?elem||false:elem===part}}if(isPartStrNotTag){Sizzle.filter(part,checkSet,true)}},">":function(checkSet,part){var elem,isPartStr=typeof part==="string",i=0,l=checkSet.length;if(isPartStr&&!rNonWord.test(part)){part=part.toLowerCase();for(;i<l;i++){elem=checkSet[i];if(elem){var parent=elem.parentNode;checkSet[i]=parent.nodeName.toLowerCase()===part?parent:false}}}else{for(;i<l;i++){elem=checkSet[i];if(elem){checkSet[i]=isPartStr?elem.parentNode:elem.parentNode===part}}if(isPartStr){Sizzle.filter(part,checkSet,true)}}},"":function(checkSet,part,isXML){var nodeCheck,doneName=done++,checkFn=dirCheck;if(typeof part==="string"&&!rNonWord.test(part)){part=part.toLowerCase();nodeCheck=part;checkFn=dirNodeCheck}checkFn("parentNode",part,doneName,checkSet,nodeCheck,isXML)},"~":function(checkSet,part,isXML){var nodeCheck,doneName=done++,checkFn=dirCheck;if(typeof part==="string"&&!rNonWord.test(part)){part=part.toLowerCase();nodeCheck=part;checkFn=dirNodeCheck}checkFn("previousSibling",part,doneName,checkSet,nodeCheck,isXML)}},find:{ID:function(match,context,isXML){if(typeof context.getElementById!=="undefined"&&!isXML){var m=context.getElementById(match[1]);return m&&m.parentNode?[m]:[]}},NAME:function(match,context){if(typeof context.getElementsByName!=="undefined"){var ret=[],results=context.getElementsByName(match[1]);for(var i=0,l=results.length;i<l;i++){if(results[i].getAttribute("name")===match[1]){ret.push(results[i])}}return ret.length===0?null:ret}},TAG:function(match,context){if(typeof context.getElementsByTagName!=="undefined"){return context.getElementsByTagName(match[1])}}},preFilter:{CLASS:function(match,curLoop,inplace,result,not,isXML){match=" "+match[1].replace(rBackslash,"")+" ";if(isXML){return match}for(var i=0,elem;(elem=curLoop[i])!=null;i++){if(elem){if(not^(elem.className&&(" "+elem.className+" ").replace(/[\t\n\r]/g," ").indexOf(match)>=0)){if(!inplace){result.push(elem)}}else{if(inplace){curLoop[i]=false}}}}return false},ID:function(match){return match[1].replace(rBackslash,"")},TAG:function(match,curLoop){return match[1].replace(rBackslash,"").toLowerCase()},CHILD:function(match){if(match[1]==="nth"){if(!match[2]){Sizzle.error(match[0])}match[2]=match[2].replace(/^\+|\s*/g,"");var test=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(match[2]==="even"&&"2n"||match[2]==="odd"&&"2n+1"||!/\D/.test(match[2])&&"0n+"+match[2]||match[2]);match[2]=(test[1]+(test[2]||1))-0;match[3]=test[3]-0}else{if(match[2]){Sizzle.error(match[0])}}match[0]=done++;return match},ATTR:function(match,curLoop,inplace,result,not,isXML){var name=match[1]=match[1].replace(rBackslash,"");if(!isXML&&Expr.attrMap[name]){match[1]=Expr.attrMap[name]}match[4]=(match[4]||match[5]||"").replace(rBackslash,"");if(match[2]==="~="){match[4]=" "+match[4]+" "}return match},PSEUDO:function(match,curLoop,inplace,result,not){if(match[1]==="not"){if((chunker.exec(match[3])||"").length>1||/^\w/.test(match[3])){match[3]=Sizzle(match[3],null,null,curLoop)}else{var ret=Sizzle.filter(match[3],curLoop,inplace,true^not);if(!inplace){result.push.apply(result,ret)}return false}}else{if(Expr.match.POS.test(match[0])||Expr.match.CHILD.test(match[0])){return true}}return match},POS:function(match){match.unshift(true);return match}},filters:{enabled:function(elem){return elem.disabled===false&&elem.type!=="hidden"},disabled:function(elem){return elem.disabled===true},checked:function(elem){return elem.checked===true},selected:function(elem){if(elem.parentNode){elem.parentNode.selectedIndex}return elem.selected===true},parent:function(elem){return !!elem.firstChild},empty:function(elem){return !elem.firstChild},has:function(elem,i,match){return !!Sizzle(match[3],elem).length},header:function(elem){return(/h\d/i).test(elem.nodeName)},text:function(elem){var attr=elem.getAttribute("type"),type=elem.type;return elem.nodeName.toLowerCase()==="input"&&"text"===type&&(attr===type||attr===null)},radio:function(elem){return elem.nodeName.toLowerCase()==="input"&&"radio"===elem.type},checkbox:function(elem){return elem.nodeName.toLowerCase()==="input"&&"checkbox"===elem.type},file:function(elem){return elem.nodeName.toLowerCase()==="input"&&"file"===elem.type},password:function(elem){return elem.nodeName.toLowerCase()==="input"&&"password"===elem.type},submit:function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&"submit"===elem.type},image:function(elem){return elem.nodeName.toLowerCase()==="input"&&"image"===elem.type},reset:function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&"reset"===elem.type},button:function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&"button"===elem.type||name==="button"},input:function(elem){return(/input|select|textarea|button/i).test(elem.nodeName)},focus:function(elem){return elem===elem.ownerDocument.activeElement}},setFilters:{first:function(elem,i){return i===0},last:function(elem,i,match,array){return i===array.length-1},even:function(elem,i){return i%2===0},odd:function(elem,i){return i%2===1},lt:function(elem,i,match){return i<match[3]-0},gt:function(elem,i,match){return i>match[3]-0},nth:function(elem,i,match){return match[3]-0===i},eq:function(elem,i,match){return match[3]-0===i}},filter:{PSEUDO:function(elem,match,i,array){var name=match[1],filter=Expr.filters[name];if(filter){return filter(elem,i,match,array)}else{if(name==="contains"){return(elem.textContent||elem.innerText||getText([elem])||"").indexOf(match[3])>=0}else{if(name==="not"){var not=match[3];for(var j=0,l=not.length;j<l;j++){if(not[j]===elem){return false}}return true}else{Sizzle.error(name)}}}},CHILD:function(elem,match){var first,last,doneName,parent,cache,count,diff,type=match[1],node=elem;switch(type){case"only":case"first":while((node=node.previousSibling)){if(node.nodeType===1){return false}}if(type==="first"){return true}node=elem;case"last":while((node=node.nextSibling)){if(node.nodeType===1){return false}}return true;case"nth":first=match[2];last=match[3];if(first===1&&last===0){return true}doneName=match[0];parent=elem.parentNode;if(parent&&(parent[expando]!==doneName||!elem.nodeIndex)){count=0;for(node=parent.firstChild;node;node=node.nextSibling){if(node.nodeType===1){node.nodeIndex=++count}}parent[expando]=doneName}diff=elem.nodeIndex-last;if(first===0){return diff===0}else{return(diff%first===0&&diff/first>=0)}}},ID:function(elem,match){return elem.nodeType===1&&elem.getAttribute("id")===match},TAG:function(elem,match){return(match==="*"&&elem.nodeType===1)||!!elem.nodeName&&elem.nodeName.toLowerCase()===match},CLASS:function(elem,match){return(" "+(elem.className||elem.getAttribute("class"))+" ").indexOf(match)>-1},ATTR:function(elem,match){var name=match[1],result=Sizzle.attr?Sizzle.attr(elem,name):Expr.attrHandle[name]?Expr.attrHandle[name](elem):elem[name]!=null?elem[name]:elem.getAttribute(name),value=result+"",type=match[2],check=match[4];return result==null?type==="!=":!type&&Sizzle.attr?result!=null:type==="="?value===check:type==="*="?value.indexOf(check)>=0:type==="~="?(" "+value+" ").indexOf(check)>=0:!check?value&&result!==false:type==="!="?value!==check:type==="^="?value.indexOf(check)===0:type==="$="?value.substr(value.length-check.length)===check:type==="|="?value===check||value.substr(0,check.length+1)===check+"-":false},POS:function(elem,match,i,array){var name=match[2],filter=Expr.setFilters[name];if(filter){return filter(elem,i,match,array)}}}};var origPOS=Expr.match.POS,fescape=function(all,num){return"\\"+(num-0+1)};for(var type in Expr.match){Expr.match[type]=new RegExp(Expr.match[type].source+(/(?![^\[]*\])(?![^\(]*\))/.source));Expr.leftMatch[type]=new RegExp(/(^(?:.|\r|\n)*?)/.source+Expr.match[type].source.replace(/\\(\d+)/g,fescape))}Expr.match.globalPOS=origPOS;var makeArray=function(array,results){array=Array.prototype.slice.call(array,0);if(results){results.push.apply(results,array);return results}return array};try{Array.prototype.slice.call(document.documentElement.childNodes,0)[0].nodeType}catch(e){makeArray=function(array,results){var i=0,ret=results||[];if(toString.call(array)==="[object Array]"){Array.prototype.push.apply(ret,array)}else{if(typeof array.length==="number"){for(var l=array.length;i<l;i++){ret.push(array[i])}}else{for(;array[i];i++){ret.push(array[i])}}}return ret}}var sortOrder,siblingCheck;if(document.documentElement.compareDocumentPosition){sortOrder=function(a,b){if(a===b){hasDuplicate=true;return 0}if(!a.compareDocumentPosition||!b.compareDocumentPosition){return a.compareDocumentPosition?-1:1}return a.compareDocumentPosition(b)&4?-1:1}}else{sortOrder=function(a,b){if(a===b){hasDuplicate=true;return 0}else{if(a.sourceIndex&&b.sourceIndex){return a.sourceIndex-b.sourceIndex}}var al,bl,ap=[],bp=[],aup=a.parentNode,bup=b.parentNode,cur=aup;if(aup===bup){return siblingCheck(a,b)}else{if(!aup){return -1}else{if(!bup){return 1}}}while(cur){ap.unshift(cur);cur=cur.parentNode}cur=bup;while(cur){bp.unshift(cur);cur=cur.parentNode}al=ap.length;bl=bp.length;for(var i=0;i<al&&i<bl;i++){if(ap[i]!==bp[i]){return siblingCheck(ap[i],bp[i])}}return i===al?siblingCheck(a,bp[i],-1):siblingCheck(ap[i],b,1)};siblingCheck=function(a,b,ret){if(a===b){return ret}var cur=a.nextSibling;while(cur){if(cur===b){return -1}cur=cur.nextSibling}return 1}}(function(){var form=document.createElement("div"),id="script"+(new Date()).getTime(),root=document.documentElement;form.innerHTML="<a name='"+id+"'/>";root.insertBefore(form,root.firstChild);if(document.getElementById(id)){Expr.find.ID=function(match,context,isXML){if(typeof context.getElementById!=="undefined"&&!isXML){var m=context.getElementById(match[1]);return m?m.id===match[1]||typeof m.getAttributeNode!=="undefined"&&m.getAttributeNode("id").nodeValue===match[1]?[m]:undefined:[]}};Expr.filter.ID=function(elem,match){var node=typeof elem.getAttributeNode!=="undefined"&&elem.getAttributeNode("id");return elem.nodeType===1&&node&&node.nodeValue===match}}root.removeChild(form);root=form=null})();(function(){var div=document.createElement("div");div.appendChild(document.createComment(""));if(div.getElementsByTagName("*").length>0){Expr.find.TAG=function(match,context){var results=context.getElementsByTagName(match[1]);if(match[1]==="*"){var tmp=[];for(var i=0;results[i];i++){if(results[i].nodeType===1){tmp.push(results[i])}}results=tmp}return results}}div.innerHTML="<a href='#'></a>";if(div.firstChild&&typeof div.firstChild.getAttribute!=="undefined"&&div.firstChild.getAttribute("href")!=="#"){Expr.attrHandle.href=function(elem){return elem.getAttribute("href",2)}}div=null})();if(document.querySelectorAll){(function(){var oldSizzle=Sizzle,div=document.createElement("div"),id="__sizzle__";div.innerHTML="<p class='TEST'></p>";if(div.querySelectorAll&&div.querySelectorAll(".TEST").length===0){return }Sizzle=function(query,context,extra,seed){context=context||document;if(!seed&&!Sizzle.isXML(context)){var match=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(query);if(match&&(context.nodeType===1||context.nodeType===9)){if(match[1]){return makeArray(context.getElementsByTagName(query),extra)}else{if(match[2]&&Expr.find.CLASS&&context.getElementsByClassName){return makeArray(context.getElementsByClassName(match[2]),extra)}}}if(context.nodeType===9){if(query==="body"&&context.body){return makeArray([context.body],extra)}else{if(match&&match[3]){var elem=context.getElementById(match[3]);if(elem&&elem.parentNode){if(elem.id===match[3]){return makeArray([elem],extra)}}else{return makeArray([],extra)}}}try{return makeArray(context.querySelectorAll(query),extra)}catch(qsaError){}}else{if(context.nodeType===1&&context.nodeName.toLowerCase()!=="object"){var oldContext=context,old=context.getAttribute("id"),nid=old||id,hasParent=context.parentNode,relativeHierarchySelector=/^\s*[+~]/.test(query);if(!old){context.setAttribute("id",nid)}else{nid=nid.replace(/'/g,"\\$&")}if(relativeHierarchySelector&&hasParent){context=context.parentNode}try{if(!relativeHierarchySelector||hasParent){return makeArray(context.querySelectorAll("[id='"+nid+"'] "+query),extra)}}catch(pseudoError){}finally{if(!old){oldContext.removeAttribute("id")}}}}}return oldSizzle(query,context,extra,seed)};for(var prop in oldSizzle){Sizzle[prop]=oldSizzle[prop]}div=null})()}(function(){var html=document.documentElement,matches=html.matchesSelector||html.mozMatchesSelector||html.webkitMatchesSelector||html.msMatchesSelector;if(matches){var disconnectedMatch=!matches.call(document.createElement("div"),"div"),pseudoWorks=false;try{matches.call(document.documentElement,"[test!='']:sizzle")}catch(pseudoError){pseudoWorks=true}Sizzle.matchesSelector=function(node,expr){expr=expr.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!Sizzle.isXML(node)){try{if(pseudoWorks||!Expr.match.PSEUDO.test(expr)&&!/!=/.test(expr)){var ret=matches.call(node,expr);if(ret||!disconnectedMatch||node.document&&node.document.nodeType!==11){return ret}}}catch(e){}}return Sizzle(expr,null,null,[node]).length>0}}})();(function(){var div=document.createElement("div");div.innerHTML="<div class='test e'></div><div class='test'></div>";if(!div.getElementsByClassName||div.getElementsByClassName("e").length===0){return }div.lastChild.className="e";if(div.getElementsByClassName("e").length===1){return }Expr.order.splice(1,0,"CLASS");Expr.find.CLASS=function(match,context,isXML){if(typeof context.getElementsByClassName!=="undefined"&&!isXML){return context.getElementsByClassName(match[1])}};div=null})();function dirNodeCheck(dir,cur,doneName,checkSet,nodeCheck,isXML){for(var i=0,l=checkSet.length;i<l;i++){var elem=checkSet[i];if(elem){var match=false;elem=elem[dir];while(elem){if(elem[expando]===doneName){match=checkSet[elem.sizset];break}if(elem.nodeType===1&&!isXML){elem[expando]=doneName;elem.sizset=i}if(elem.nodeName.toLowerCase()===cur){match=elem;break}elem=elem[dir]}checkSet[i]=match}}}function dirCheck(dir,cur,doneName,checkSet,nodeCheck,isXML){for(var i=0,l=checkSet.length;i<l;i++){var elem=checkSet[i];if(elem){var match=false;elem=elem[dir];while(elem){if(elem[expando]===doneName){match=checkSet[elem.sizset];break}if(elem.nodeType===1){if(!isXML){elem[expando]=doneName;elem.sizset=i}if(typeof cur!=="string"){if(elem===cur){match=true;break}}else{if(Sizzle.filter(cur,[elem]).length>0){match=elem;break}}}elem=elem[dir]}checkSet[i]=match}}}if(document.documentElement.contains){Sizzle.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):true)}}else{if(document.documentElement.compareDocumentPosition){Sizzle.contains=function(a,b){return !!(a.compareDocumentPosition(b)&16)}}else{Sizzle.contains=function(){return false}}}Sizzle.isXML=function(elem){var documentElement=(elem?elem.ownerDocument||elem:0).documentElement;return documentElement?documentElement.nodeName!=="HTML":false};var posProcess=function(selector,context,seed){var match,tmpSet=[],later="",root=context.nodeType?[context]:context;while((match=Expr.match.PSEUDO.exec(selector))){later+=match[0];selector=selector.replace(Expr.match.PSEUDO,"")}selector=Expr.relative[selector]?selector+"*":selector;for(var i=0,l=root.length;i<l;i++){Sizzle(selector,root[i],tmpSet,seed)}return Sizzle.filter(later,tmpSet)};Sizzle.attr=jQuery.attr;Sizzle.selectors.attrMap={};jQuery.find=Sizzle;jQuery.expr=Sizzle.selectors;jQuery.expr[":"]=jQuery.expr.filters;jQuery.unique=Sizzle.uniqueSort;jQuery.text=Sizzle.getText;jQuery.isXMLDoc=Sizzle.isXML;jQuery.contains=Sizzle.contains})();var runtil=/Until$/,rparentsprev=/^(?:parents|prevUntil|prevAll)/,rmultiselector=/,/,isSimple=/^.[^:#\[\.,]*$/,slice=Array.prototype.slice,POS=jQuery.expr.match.globalPOS,guaranteedUnique={children:true,contents:true,next:true,prev:true};jQuery.fn.extend({find:function(selector){var self=this,i,l;if(typeof selector!=="string"){return jQuery(selector).filter(function(){for(i=0,l=self.length;i<l;i++){if(jQuery.contains(self[i],this)){return true}}})}var ret=this.pushStack("","find",selector),length,n,r;for(i=0,l=this.length;i<l;i++){length=ret.length;jQuery.find(selector,this[i],ret);if(i>0){for(n=length;n<ret.length;n++){for(r=0;r<length;r++){if(ret[r]===ret[n]){ret.splice(n--,1);break}}}}}return ret},has:function(target){var targets=jQuery(target);return this.filter(function(){for(var i=0,l=targets.length;i<l;i++){if(jQuery.contains(this,targets[i])){return true}}})},not:function(selector){return this.pushStack(winnow(this,selector,false),"not",selector)},filter:function(selector){return this.pushStack(winnow(this,selector,true),"filter",selector)},is:function(selector){return !!selector&&(typeof selector==="string"?POS.test(selector)?jQuery(selector,this.context).index(this[0])>=0:jQuery.filter(selector,this).length>0:this.filter(selector).length>0)},closest:function(selectors,context){var ret=[],i,l,cur=this[0];if(jQuery.isArray(selectors)){var level=1;while(cur&&cur.ownerDocument&&cur!==context){for(i=0;i<selectors.length;i++){if(jQuery(cur).is(selectors[i])){ret.push({selector:selectors[i],elem:cur,level:level})}}cur=cur.parentNode;level++}return ret}var pos=POS.test(selectors)||typeof selectors!=="string"?jQuery(selectors,context||this.context):0;for(i=0,l=this.length;i<l;i++){cur=this[i];while(cur){if(pos?pos.index(cur)>-1:jQuery.find.matchesSelector(cur,selectors)){ret.push(cur);break}else{cur=cur.parentNode;if(!cur||!cur.ownerDocument||cur===context||cur.nodeType===11){break}}}}ret=ret.length>1?jQuery.unique(ret):ret;return this.pushStack(ret,"closest",selectors)},index:function(elem){if(!elem){return(this[0]&&this[0].parentNode)?this.prevAll().length:-1}if(typeof elem==="string"){return jQuery.inArray(this[0],jQuery(elem))}return jQuery.inArray(elem.jquery?elem[0]:elem,this)},add:function(selector,context){var set=typeof selector==="string"?jQuery(selector,context):jQuery.makeArray(selector&&selector.nodeType?[selector]:selector),all=jQuery.merge(this.get(),set);return this.pushStack(isDisconnected(set[0])||isDisconnected(all[0])?all:jQuery.unique(all))},andSelf:function(){return this.add(this.prevObject)}});function isDisconnected(node){return !node||!node.parentNode||node.parentNode.nodeType===11}jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&parent.nodeType!==11?parent:null},parents:function(elem){return jQuery.dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until)},next:function(elem){return jQuery.nth(elem,2,"nextSibling")},prev:function(elem){return jQuery.nth(elem,2,"previousSibling")},nextAll:function(elem){return jQuery.dir(elem,"nextSibling")},prevAll:function(elem){return jQuery.dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until)},siblings:function(elem){return jQuery.sibling((elem.parentNode||{}).firstChild,elem)},children:function(elem){return jQuery.sibling(elem.firstChild)},contents:function(elem){return jQuery.nodeName(elem,"iframe")?elem.contentDocument||elem.contentWindow.document:jQuery.makeArray(elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var ret=jQuery.map(this,fn,until);if(!runtil.test(name)){selector=until}if(selector&&typeof selector==="string"){ret=jQuery.filter(selector,ret)}ret=this.length>1&&!guaranteedUnique[name]?jQuery.unique(ret):ret;if((this.length>1||rmultiselector.test(selector))&&rparentsprev.test(name)){ret=ret.reverse()}return this.pushStack(ret,name,slice.call(arguments).join(","))}});jQuery.extend({filter:function(expr,elems,not){if(not){expr=":not("+expr+")"}return elems.length===1?jQuery.find.matchesSelector(elems[0],expr)?[elems[0]]:[]:jQuery.find.matches(expr,elems)},dir:function(elem,dir,until){var matched=[],cur=elem[dir];while(cur&&cur.nodeType!==9&&(until===undefined||cur.nodeType!==1||!jQuery(cur).is(until))){if(cur.nodeType===1){matched.push(cur)}cur=cur[dir]}return matched},nth:function(cur,result,dir,elem){result=result||1;var num=0;for(;cur;cur=cur[dir]){if(cur.nodeType===1&&++num===result){break}}return cur},sibling:function(n,elem){var r=[];for(;n;n=n.nextSibling){if(n.nodeType===1&&n!==elem){r.push(n)}}return r}});function winnow(elements,qualifier,keep){qualifier=qualifier||0;if(jQuery.isFunction(qualifier)){return jQuery.grep(elements,function(elem,i){var retVal=!!qualifier.call(elem,i,elem);return retVal===keep})}else{if(qualifier.nodeType){return jQuery.grep(elements,function(elem,i){return(elem===qualifier)===keep})}else{if(typeof qualifier==="string"){var filtered=jQuery.grep(elements,function(elem){return elem.nodeType===1});if(isSimple.test(qualifier)){return jQuery.filter(qualifier,filtered,!keep)}else{qualifier=jQuery.filter(qualifier,filtered)}}}}return jQuery.grep(elements,function(elem,i){return(jQuery.inArray(elem,qualifier)>=0)===keep})}function createSafeFragment(document){var list=nodeNames.split("|"),safeFrag=document.createDocumentFragment();if(safeFrag.createElement){while(list.length){safeFrag.createElement(list.pop())}}return safeFrag}var nodeNames="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",rinlinejQuery=/ jQuery\d+="(?:\d+|null)"/g,rleadingWhitespace=/^\s+/,rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,rtagName=/<([\w:]+)/,rtbody=/<tbody/i,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style)/i,rnocache=/<(?:script|object|embed|option|style)/i,rnoshimcache=new RegExp("<(?:"+nodeNames+")[\\s/>]","i"),rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/\/(java|ecma)script/i,rcleanScript=/^\s*<!(?:\[CDATA\[|\-\-)/,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},safeFragment=createSafeFragment(document);wrapMap.optgroup=wrapMap.option;wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead;wrapMap.th=wrapMap.td;if(!jQuery.support.htmlSerialize){wrapMap._default=[1,"div<div>","</div>"]}jQuery.fn.extend({text:function(value){return jQuery.access(this,function(value){return value===undefined?jQuery.text(this):this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(value))},null,value,arguments.length)},wrapAll:function(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapAll(html.call(this,i))})}if(this[0]){var wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){wrap.insertBefore(this[0])}wrap.map(function(){var elem=this;while(elem.firstChild&&elem.firstChild.nodeType===1){elem=elem.firstChild}return elem}).append(this)}return this},wrapInner:function(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapInner(html.call(this,i))})}return this.each(function(){var self=jQuery(this),contents=self.contents();if(contents.length){contents.wrapAll(html)}else{self.append(html)}})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(){return this.parent().each(function(){if(!jQuery.nodeName(this,"body")){jQuery(this).replaceWith(this.childNodes)}}).end()},append:function(){return this.domManip(arguments,true,function(elem){if(this.nodeType===1){this.appendChild(elem)}})},prepend:function(){return this.domManip(arguments,true,function(elem){if(this.nodeType===1){this.insertBefore(elem,this.firstChild)}})},before:function(){if(this[0]&&this[0].parentNode){return this.domManip(arguments,false,function(elem){this.parentNode.insertBefore(elem,this)})}else{if(arguments.length){var set=jQuery.clean(arguments);set.push.apply(set,this.toArray());return this.pushStack(set,"before",arguments)}}},after:function(){if(this[0]&&this[0].parentNode){return this.domManip(arguments,false,function(elem){this.parentNode.insertBefore(elem,this.nextSibling)})}else{if(arguments.length){var set=this.pushStack(this,"after",arguments);set.push.apply(set,jQuery.clean(arguments));return set}}},remove:function(selector,keepData){for(var i=0,elem;(elem=this[i])!=null;i++){if(!selector||jQuery.filter(selector,[elem]).length){if(!keepData&&elem.nodeType===1){jQuery.cleanData(elem.getElementsByTagName("*"));jQuery.cleanData([elem])}if(elem.parentNode){elem.parentNode.removeChild(elem)}}}return this},empty:function(){for(var i=0,elem;(elem=this[i])!=null;i++){if(elem.nodeType===1){jQuery.cleanData(elem.getElementsByTagName("*"))}while(elem.firstChild){elem.removeChild(elem.firstChild)}}return this},clone:function(dataAndEvents,deepDataAndEvents){dataAndEvents=dataAndEvents==null?false:dataAndEvents;deepDataAndEvents=deepDataAndEvents==null?dataAndEvents:deepDataAndEvents;return this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return jQuery.access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(value===undefined){return elem.nodeType===1?elem.innerHTML.replace(rinlinejQuery,""):null}if(typeof value==="string"&&!rnoInnerhtml.test(value)&&(jQuery.support.leadingWhitespace||!rleadingWhitespace.test(value))&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(;i<l;i++){elem=this[i]||{};if(elem.nodeType===1){jQuery.cleanData(elem.getElementsByTagName("*"));elem.innerHTML=value}}elem=0}catch(e){}}if(elem){this.empty().append(value)}},null,value,arguments.length)},replaceWith:function(value){if(this[0]&&this[0].parentNode){if(jQuery.isFunction(value)){return this.each(function(i){var self=jQuery(this),old=self.html();self.replaceWith(value.call(this,i,old))})}if(typeof value!=="string"){value=jQuery(value).detach()}return this.each(function(){var next=this.nextSibling,parent=this.parentNode;jQuery(this).remove();if(next){jQuery(next).before(value)}else{jQuery(parent).append(value)}})}else{return this.length?this.pushStack(jQuery(jQuery.isFunction(value)?value():value),"replaceWith",value):this}},detach:function(selector){return this.remove(selector,true)},domManip:function(args,table,callback){var results,first,fragment,parent,value=args[0],scripts=[];if(!jQuery.support.checkClone&&arguments.length===3&&typeof value==="string"&&rchecked.test(value)){return this.each(function(){jQuery(this).domManip(args,table,callback,true)})}if(jQuery.isFunction(value)){return this.each(function(i){var self=jQuery(this);args[0]=value.call(this,i,table?self.html():undefined);self.domManip(args,table,callback)})}if(this[0]){parent=value&&value.parentNode;if(jQuery.support.parentNode&&parent&&parent.nodeType===11&&parent.childNodes.length===this.length){results={fragment:parent}}else{results=jQuery.buildFragment(args,this,scripts)}fragment=results.fragment;if(fragment.childNodes.length===1){first=fragment=fragment.firstChild}else{first=fragment.firstChild}if(first){table=table&&jQuery.nodeName(first,"tr");for(var i=0,l=this.length,lastIndex=l-1;i<l;i++){callback.call(table?root(this[i],first):this[i],results.cacheable||(l>1&&i<lastIndex)?jQuery.clone(fragment,true,true):fragment)}}if(scripts.length){jQuery.each(scripts,function(i,elem){if(elem.src){jQuery.ajax({type:"GET",global:false,url:elem.src,async:false,dataType:"script"})}else{jQuery.globalEval((elem.text||elem.textContent||elem.innerHTML||"").replace(rcleanScript,"/*$0*/"))}if(elem.parentNode){elem.parentNode.removeChild(elem)}})}}return this}});function root(elem,cur){return jQuery.nodeName(elem,"table")?(elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody"))):elem}function cloneCopyEvent(src,dest){if(dest.nodeType!==1||!jQuery.hasData(src)){return }var type,i,l,oldData=jQuery._data(src),curData=jQuery._data(dest,oldData),events=oldData.events;if(events){delete curData.handle;curData.events={};for(type in events){for(i=0,l=events[type].length;i<l;i++){jQuery.event.add(dest,type,events[type][i])}}}if(curData.data){curData.data=jQuery.extend({},curData.data)}}function cloneFixAttributes(src,dest){var nodeName;if(dest.nodeType!==1){return }if(dest.clearAttributes){dest.clearAttributes()}if(dest.mergeAttributes){dest.mergeAttributes(src)}nodeName=dest.nodeName.toLowerCase();if(nodeName==="object"){dest.outerHTML=src.outerHTML}else{if(nodeName==="input"&&(src.type==="checkbox"||src.type==="radio")){if(src.checked){dest.defaultChecked=dest.checked=src.checked}if(dest.value!==src.value){dest.value=src.value}}else{if(nodeName==="option"){dest.selected=src.defaultSelected}else{if(nodeName==="input"||nodeName==="textarea"){dest.defaultValue=src.defaultValue}else{if(nodeName==="script"&&dest.text!==src.text){dest.text=src.text}}}}}dest.removeAttribute(jQuery.expando);dest.removeAttribute("_submit_attached");dest.removeAttribute("_change_attached")}jQuery.buildFragment=function(args,nodes,scripts){var fragment,cacheable,cacheresults,doc,first=args[0];if(nodes&&nodes[0]){doc=nodes[0].ownerDocument||nodes[0]}if(!doc.createDocumentFragment){doc=document}if(args.length===1&&typeof first==="string"&&first.length<512&&doc===document&&first.charAt(0)==="<"&&!rnocache.test(first)&&(jQuery.support.checkClone||!rchecked.test(first))&&(jQuery.support.html5Clone||!rnoshimcache.test(first))){cacheable=true;cacheresults=jQuery.fragments[first];if(cacheresults&&cacheresults!==1){fragment=cacheresults}}if(!fragment){fragment=doc.createDocumentFragment();jQuery.clean(args,doc,fragment,scripts)}if(cacheable){jQuery.fragments[first]=cacheresults?fragment:1}return{fragment:fragment,cacheable:cacheable}};jQuery.fragments={};jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){var ret=[],insert=jQuery(selector),parent=this.length===1&&this[0].parentNode;if(parent&&parent.nodeType===11&&parent.childNodes.length===1&&insert.length===1){insert[original](this[0]);return this}else{for(var i=0,l=insert.length;i<l;i++){var elems=(i>0?this.clone(true):this).get();jQuery(insert[i])[original](elems);ret=ret.concat(elems)}return this.pushStack(ret,name,insert.selector)}}});function getAll(elem){if(typeof elem.getElementsByTagName!=="undefined"){return elem.getElementsByTagName("*")}else{if(typeof elem.querySelectorAll!=="undefined"){return elem.querySelectorAll("*")}else{return[]}}}function fixDefaultChecked(elem){if(elem.type==="checkbox"||elem.type==="radio"){elem.defaultChecked=elem.checked}}function findInputs(elem){var nodeName=(elem.nodeName||"").toLowerCase();if(nodeName==="input"){fixDefaultChecked(elem)}else{if(nodeName!=="script"&&typeof elem.getElementsByTagName!=="undefined"){jQuery.grep(elem.getElementsByTagName("input"),fixDefaultChecked)}}}function shimCloneNode(elem){var div=document.createElement("div");safeFragment.appendChild(div);div.innerHTML=elem.outerHTML;return div.firstChild}jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var srcElements,destElements,i,clone=jQuery.support.html5Clone||jQuery.isXMLDoc(elem)||!rnoshimcache.test("<"+elem.nodeName+">")?elem.cloneNode(true):shimCloneNode(elem);if((!jQuery.support.noCloneEvent||!jQuery.support.noCloneChecked)&&(elem.nodeType===1||elem.nodeType===11)&&!jQuery.isXMLDoc(elem)){cloneFixAttributes(elem,clone);srcElements=getAll(elem);destElements=getAll(clone);for(i=0;srcElements[i];++i){if(destElements[i]){cloneFixAttributes(srcElements[i],destElements[i])}}}if(dataAndEvents){cloneCopyEvent(elem,clone);if(deepDataAndEvents){srcElements=getAll(elem);destElements=getAll(clone);for(i=0;srcElements[i];++i){cloneCopyEvent(srcElements[i],destElements[i])}}}srcElements=destElements=null;return clone},clean:function(elems,context,fragment,scripts){var checkScriptType,script,j,ret=[];context=context||document;if(typeof context.createElement==="undefined"){context=context.ownerDocument||context[0]&&context[0].ownerDocument||document}for(var i=0,elem;(elem=elems[i])!=null;i++){if(typeof elem==="number"){elem+=""}if(!elem){continue}if(typeof elem==="string"){if(!rhtml.test(elem)){elem=context.createTextNode(elem)}else{elem=elem.replace(rxhtmlTag,"<$1></$2>");var tag=(rtagName.exec(elem)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,depth=wrap[0],div=context.createElement("div"),safeChildNodes=safeFragment.childNodes,remove;if(context===document){safeFragment.appendChild(div)}else{createSafeFragment(context).appendChild(div)}div.innerHTML=wrap[1]+elem+wrap[2];while(depth--){div=div.lastChild}if(!jQuery.support.tbody){var hasBody=rtbody.test(elem),tbody=tag==="table"&&!hasBody?div.firstChild&&div.firstChild.childNodes:wrap[1]==="<table>"&&!hasBody?div.childNodes:[];for(j=tbody.length-1;j>=0;--j){if(jQuery.nodeName(tbody[j],"tbody")&&!tbody[j].childNodes.length){tbody[j].parentNode.removeChild(tbody[j])}}}if(!jQuery.support.leadingWhitespace&&rleadingWhitespace.test(elem)){div.insertBefore(context.createTextNode(rleadingWhitespace.exec(elem)[0]),div.firstChild)}elem=div.childNodes;if(div){div.parentNode.removeChild(div);if(safeChildNodes.length>0){remove=safeChildNodes[safeChildNodes.length-1];if(remove&&remove.parentNode){remove.parentNode.removeChild(remove)}}}}}var len;if(!jQuery.support.appendChecked){if(elem[0]&&typeof (len=elem.length)==="number"){for(j=0;j<len;j++){findInputs(elem[j])}}else{findInputs(elem)}}if(elem.nodeType){ret.push(elem)}else{ret=jQuery.merge(ret,elem)}}if(fragment){checkScriptType=function(elem){return !elem.type||rscriptType.test(elem.type)};for(i=0;ret[i];i++){script=ret[i];if(scripts&&jQuery.nodeName(script,"script")&&(!script.type||rscriptType.test(script.type))){scripts.push(script.parentNode?script.parentNode.removeChild(script):script)}else{if(script.nodeType===1){var jsTags=jQuery.grep(script.getElementsByTagName("script"),checkScriptType);ret.splice.apply(ret,[i+1,0].concat(jsTags))}fragment.appendChild(script)}}}return ret},cleanData:function(elems){var data,id,cache=jQuery.cache,special=jQuery.event.special,deleteExpando=jQuery.support.deleteExpando;for(var i=0,elem;(elem=elems[i])!=null;i++){if(elem.nodeName&&jQuery.noData[elem.nodeName.toLowerCase()]){continue}id=elem[jQuery.expando];if(id){data=cache[id];if(data&&data.events){for(var type in data.events){if(special[type]){jQuery.event.remove(elem,type)}else{jQuery.removeEvent(elem,type,data.handle)}}if(data.handle){data.handle.elem=null}}if(deleteExpando){delete elem[jQuery.expando]}else{if(elem.removeAttribute){elem.removeAttribute(jQuery.expando)}}delete cache[id]}}}});var ralpha=/alpha\([^)]*\)/i,ropacity=/opacity=([^)]*)/,rupper=/([A-Z]|^ms)/g,rnum=/^[\-+]?(?:\d*\.)?\d+$/i,rnumnonpx=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,rrelNum=/^([\-+])=([\-+.\de]+)/,rmargin=/^margin/,cssShow={position:"absolute",visibility:"hidden",display:"block"},cssExpand=["Top","Right","Bottom","Left"],curCSS,getComputedStyle,currentStyle;jQuery.fn.css=function(name,value){return jQuery.access(this,function(elem,name,value){return value!==undefined?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)};jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return ret===""?"1":ret}else{return elem.style.opacity}}}},cssNumber:{fillOpacity:true,fontWeight:true,lineHeight:true,opacity:true,orphans:true,widows:true,zIndex:true,zoom:true},cssProps:{"float":jQuery.support.cssFloat?"cssFloat":"styleFloat"},style:function(elem,name,value,extra){if(!elem||elem.nodeType===3||elem.nodeType===8||!elem.style){return }var ret,type,origName=jQuery.camelCase(name),style=elem.style,hooks=jQuery.cssHooks[origName];name=jQuery.cssProps[origName]||origName;if(value!==undefined){type=typeof value;if(type==="string"&&(ret=rrelNum.exec(value))){value=(+(ret[1]+1)*+ret[2])+parseFloat(jQuery.css(elem,name));type="number"}if(value==null||type==="number"&&isNaN(value)){return }if(type==="number"&&!jQuery.cssNumber[origName]){value+="px"}if(!hooks||!("set" in hooks)||(value=hooks.set(elem,value))!==undefined){try{style[name]=value}catch(e){}}}else{if(hooks&&"get" in hooks&&(ret=hooks.get(elem,false,extra))!==undefined){return ret}return style[name]}},css:function(elem,name,extra){var ret,hooks;name=jQuery.camelCase(name);hooks=jQuery.cssHooks[name];name=jQuery.cssProps[name]||name;if(name==="cssFloat"){name="float"}if(hooks&&"get" in hooks&&(ret=hooks.get(elem,true,extra))!==undefined){return ret}else{if(curCSS){return curCSS(elem,name)}}},swap:function(elem,options,callback){var old={},ret,name;for(name in options){old[name]=elem.style[name];elem.style[name]=options[name]}ret=callback.call(elem);for(name in options){elem.style[name]=old[name]}return ret}});jQuery.curCSS=jQuery.css;if(document.defaultView&&document.defaultView.getComputedStyle){getComputedStyle=function(elem,name){var ret,defaultView,computedStyle,width,style=elem.style;name=name.replace(rupper,"-$1").toLowerCase();if((defaultView=elem.ownerDocument.defaultView)&&(computedStyle=defaultView.getComputedStyle(elem,null))){ret=computedStyle.getPropertyValue(name);if(ret===""&&!jQuery.contains(elem.ownerDocument.documentElement,elem)){ret=jQuery.style(elem,name)}}if(!jQuery.support.pixelMargin&&computedStyle&&rmargin.test(name)&&rnumnonpx.test(ret)){width=style.width;style.width=ret;ret=computedStyle.width;style.width=width}return ret}}if(document.documentElement.currentStyle){currentStyle=function(elem,name){var left,rsLeft,uncomputed,ret=elem.currentStyle&&elem.currentStyle[name],style=elem.style;if(ret==null&&style&&(uncomputed=style[name])){ret=uncomputed}if(rnumnonpx.test(ret)){left=style.left;rsLeft=elem.runtimeStyle&&elem.runtimeStyle.left;if(rsLeft){elem.runtimeStyle.left=elem.currentStyle.left}style.left=name==="fontSize"?"1em":ret;ret=style.pixelLeft+"px";style.left=left;if(rsLeft){elem.runtimeStyle.left=rsLeft}}return ret===""?"auto":ret}}curCSS=getComputedStyle||currentStyle;function getWidthOrHeight(elem,name,extra){var val=name==="width"?elem.offsetWidth:elem.offsetHeight,i=name==="width"?1:0,len=4;if(val>0){if(extra!=="border"){for(;i<len;i+=2){if(!extra){val-=parseFloat(jQuery.css(elem,"padding"+cssExpand[i]))||0}if(extra==="margin"){val+=parseFloat(jQuery.css(elem,extra+cssExpand[i]))||0}else{val-=parseFloat(jQuery.css(elem,"border"+cssExpand[i]+"Width"))||0}}}return val+"px"}val=curCSS(elem,name);if(val<0||val==null){val=elem.style[name]}if(rnumnonpx.test(val)){return val}val=parseFloat(val)||0;if(extra){for(;i<len;i+=2){val+=parseFloat(jQuery.css(elem,"padding"+cssExpand[i]))||0;if(extra!=="padding"){val+=parseFloat(jQuery.css(elem,"border"+cssExpand[i]+"Width"))||0}if(extra==="margin"){val+=parseFloat(jQuery.css(elem,extra+cssExpand[i]))||0}}}return val+"px"}jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){if(computed){if(elem.offsetWidth!==0){return getWidthOrHeight(elem,name,extra)}else{return jQuery.swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)})}}},set:function(elem,value){return rnum.test(value)?value+"px":value}}});if(!jQuery.support.opacity){jQuery.cssHooks.opacity={get:function(elem,computed){return ropacity.test((computed&&elem.currentStyle?elem.currentStyle.filter:elem.style.filter)||"")?(parseFloat(RegExp.$1)/100)+"":computed?"1":""},set:function(elem,value){var style=elem.style,currentStyle=elem.currentStyle,opacity=jQuery.isNumeric(value)?"alpha(opacity="+value*100+")":"",filter=currentStyle&&currentStyle.filter||style.filter||"";style.zoom=1;if(value>=1&&jQuery.trim(filter.replace(ralpha,""))===""){style.removeAttribute("filter");if(currentStyle&&!currentStyle.filter){return }}style.filter=ralpha.test(filter)?filter.replace(ralpha,opacity):filter+" "+opacity}}}jQuery(function(){if(!jQuery.support.reliableMarginRight){jQuery.cssHooks.marginRight={get:function(elem,computed){return jQuery.swap(elem,{display:"inline-block"},function(){if(computed){return curCSS(elem,"margin-right")}else{return elem.style.marginRight}})}}}});if(jQuery.expr&&jQuery.expr.filters){jQuery.expr.filters.hidden=function(elem){var width=elem.offsetWidth,height=elem.offsetHeight;return(width===0&&height===0)||(!jQuery.support.reliableHiddenOffsets&&((elem.style&&elem.style.display)||jQuery.css(elem,"display"))==="none")};jQuery.expr.filters.visible=function(elem){return !jQuery.expr.filters.hidden(elem)}}jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){var i,parts=typeof value==="string"?value.split(" "):[value],expanded={};for(i=0;i<4;i++){expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0]}return expanded}}});var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rhash=/#.*$/,rheaders=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,rinput=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,rlocalProtocol=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rquery=/\?/,rscript=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,rselectTextarea=/^(?:select|textarea)/i,rspacesAjax=/\s+/,rts=/([?&])_=[^&]*/,rurl=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,_load=jQuery.fn.load,prefilters={},transports={},ajaxLocation,ajaxLocParts,allTypes=["*/"]+["*"];try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a");ajaxLocation.href="";ajaxLocation=ajaxLocation.href}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[];function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){if(typeof dataTypeExpression!=="string"){func=dataTypeExpression;dataTypeExpression="*"}if(jQuery.isFunction(func)){var dataTypes=dataTypeExpression.toLowerCase().split(rspacesAjax),i=0,length=dataTypes.length,dataType,list,placeBefore;for(;i<length;i++){dataType=dataTypes[i];placeBefore=/^\+/.test(dataType);if(placeBefore){dataType=dataType.substr(1)||"*"}list=structure[dataType]=structure[dataType]||[];list[placeBefore?"unshift":"push"](func)}}}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR,dataType,inspected){dataType=dataType||options.dataTypes[0];inspected=inspected||{};inspected[dataType]=true;var list=structure[dataType],i=0,length=list?list.length:0,executeOnly=(structure===prefilters),selection;for(;i<length&&(executeOnly||!selection);i++){selection=list[i](options,originalOptions,jqXHR);if(typeof selection==="string"){if(!executeOnly||inspected[selection]){selection=undefined}else{options.dataTypes.unshift(selection);selection=inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR,selection,inspected)}}}if((executeOnly||!selection)&&!inspected["*"]){selection=inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR,"*",inspected)}return selection}function ajaxExtend(target,src){var key,deep,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src){if(src[key]!==undefined){(flatOptions[key]?target:(deep||(deep={})))[key]=src[key]}}if(deep){jQuery.extend(true,target,deep)}}jQuery.fn.extend({load:function(url,params,callback){if(typeof url!=="string"&&_load){return _load.apply(this,arguments)}else{if(!this.length){return this}}var off=url.indexOf(" ");if(off>=0){var selector=url.slice(off,url.length);url=url.slice(0,off)}var type="GET";if(params){if(jQuery.isFunction(params)){callback=params;params=undefined}else{if(typeof params==="object"){params=jQuery.param(params,jQuery.ajaxSettings.traditional);type="POST"}}}var self=this;jQuery.ajax({url:url,type:type,dataType:"html",data:params,complete:function(jqXHR,status,responseText){responseText=jqXHR.responseText;if(jqXHR.isResolved()){jqXHR.done(function(r){responseText=r});self.html(selector?jQuery("<div>").append(responseText.replace(rscript,"")).find(selector):responseText)}if(callback){self.each(callback,[responseText,status,jqXHR])}}});return this},serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?jQuery.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||rselectTextarea.test(this.nodeName)||rinput.test(this.type))}).map(function(i,elem){var val=jQuery(this).val();return val==null?null:jQuery.isArray(val)?jQuery.map(val,function(val,i){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}});jQuery.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(i,o){jQuery.fn[o]=function(f){return this.on(o,f)}});jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){if(jQuery.isFunction(data)){type=type||callback;callback=data;data=undefined}return jQuery.ajax({type:method,url:url,data:data,success:callback,dataType:type})}});jQuery.extend({getScript:function(url,callback){return jQuery.get(url,undefined,callback,"script")},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},ajaxSetup:function(target,settings){if(settings){ajaxExtend(target,jQuery.ajaxSettings)}else{settings=target;target=jQuery.ajaxSettings}ajaxExtend(target,settings);return target},ajaxSettings:{url:ajaxLocation,isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:true,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:true,async:true,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":allTypes},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":window.String,"text html":true,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{context:true,url:true}},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){if(typeof url==="object"){options=url;url=undefined}options=options||{};var s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=callbackContext!==s&&(callbackContext.nodeType||callbackContext instanceof jQuery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},ifModifiedKey,requestHeaders={},requestHeadersNames={},responseHeadersString,responseHeaders,transport,timeoutTimer,parts,state=0,fireGlobals,i,jqXHR={readyState:0,setRequestHeader:function(name,value){if(!state){var lname=name.toLowerCase();name=requestHeadersNames[lname]=requestHeadersNames[lname]||name;requestHeaders[name]=value}return this},getAllResponseHeaders:function(){return state===2?responseHeadersString:null},getResponseHeader:function(key){var match;if(state===2){if(!responseHeaders){responseHeaders={};while((match=rheaders.exec(responseHeadersString))){responseHeaders[match[1].toLowerCase()]=match[2]}}match=responseHeaders[key.toLowerCase()]}return match===undefined?null:match},overrideMimeType:function(type){if(!state){s.mimeType=type}return this},abort:function(statusText){statusText=statusText||"abort";if(transport){transport.abort(statusText)}done(0,statusText);return this}};function done(status,nativeStatusText,responses,headers){if(state===2){return }state=2;if(timeoutTimer){clearTimeout(timeoutTimer)}transport=undefined;responseHeadersString=headers||"";jqXHR.readyState=status>0?4:0;var isSuccess,success,error,statusText=nativeStatusText,response=responses?ajaxHandleResponses(s,jqXHR,responses):undefined,lastModified,etag;if(status>=200&&status<300||status===304){if(s.ifModified){if((lastModified=jqXHR.getResponseHeader("Last-Modified"))){jQuery.lastModified[ifModifiedKey]=lastModified}if((etag=jqXHR.getResponseHeader("Etag"))){jQuery.etag[ifModifiedKey]=etag}}if(status===304){statusText="notmodified";isSuccess=true}else{try{success=ajaxConvert(s,response);statusText="success";isSuccess=true}catch(e){statusText="parsererror";error=e}}}else{error=statusText;if(!statusText||status){statusText="error";if(status<0){status=0}}}jqXHR.status=status;jqXHR.statusText=""+(nativeStatusText||statusText);if(isSuccess){deferred.resolveWith(callbackContext,[success,statusText,jqXHR])}else{deferred.rejectWith(callbackContext,[jqXHR,statusText,error])}jqXHR.statusCode(statusCode);statusCode=undefined;if(fireGlobals){globalEventContext.trigger("ajax"+(isSuccess?"Success":"Error"),[jqXHR,s,isSuccess?success:error])}completeDeferred.fireWith(callbackContext,[jqXHR,statusText]);if(fireGlobals){globalEventContext.trigger("ajaxComplete",[jqXHR,s]);if(!(--jQuery.active)){jQuery.event.trigger("ajaxStop")}}}deferred.promise(jqXHR);jqXHR.success=jqXHR.done;jqXHR.error=jqXHR.fail;jqXHR.complete=completeDeferred.add;jqXHR.statusCode=function(map){if(map){var tmp;if(state<2){for(tmp in map){statusCode[tmp]=[statusCode[tmp],map[tmp]]}}else{tmp=map[jqXHR.status];jqXHR.then(tmp,tmp)}}return this};s.url=((url||s.url)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//");s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().split(rspacesAjax);if(s.crossDomain==null){parts=rurl.exec(s.url.toLowerCase());s.crossDomain=!!(parts&&(parts[1]!=ajaxLocParts[1]||parts[2]!=ajaxLocParts[2]||(parts[3]||(parts[1]==="http:"?80:443))!=(ajaxLocParts[3]||(ajaxLocParts[1]==="http:"?80:443))))}if(s.data&&s.processData&&typeof s.data!=="string"){s.data=jQuery.param(s.data,s.traditional)}inspectPrefiltersOrTransports(prefilters,s,options,jqXHR);if(state===2){return false}fireGlobals=s.global;s.type=s.type.toUpperCase();s.hasContent=!rnoContent.test(s.type);if(fireGlobals&&jQuery.active++===0){jQuery.event.trigger("ajaxStart")}if(!s.hasContent){if(s.data){s.url+=(rquery.test(s.url)?"&":"?")+s.data;delete s.data}ifModifiedKey=s.url;if(s.cache===false){var ts=jQuery.now(),ret=s.url.replace(rts,"$1_="+ts);s.url=ret+((ret===s.url)?(rquery.test(s.url)?"&":"?")+"_="+ts:"")}}if(s.data&&s.hasContent&&s.contentType!==false||options.contentType){jqXHR.setRequestHeader("Content-Type",s.contentType)}if(s.ifModified){ifModifiedKey=ifModifiedKey||s.url;if(jQuery.lastModified[ifModifiedKey]){jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[ifModifiedKey])}if(jQuery.etag[ifModifiedKey]){jqXHR.setRequestHeader("If-None-Match",jQuery.etag[ifModifiedKey])}}jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+(s.dataTypes[0]!=="*"?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers){jqXHR.setRequestHeader(i,s.headers[i])}if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===false||state===2)){jqXHR.abort();return false}for(i in {success:1,error:1,complete:1}){jqXHR[i](s[i])}transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR);if(!transport){done(-1,"No Transport")}else{jqXHR.readyState=1;if(fireGlobals){globalEventContext.trigger("ajaxSend",[jqXHR,s])}if(s.async&&s.timeout>0){timeoutTimer=setTimeout(function(){jqXHR.abort("timeout")},s.timeout)}try{state=1;transport.send(requestHeaders,done)}catch(e){if(state<2){done(-1,e)}else{throw e}}}return jqXHR},param:function(a,traditional){var s=[],add=function(key,value){value=jQuery.isFunction(value)?value():value;s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};if(traditional===undefined){traditional=jQuery.ajaxSettings.traditional}if(jQuery.isArray(a)||(a.jquery&&!jQuery.isPlainObject(a))){jQuery.each(a,function(){add(this.name,this.value)})}else{for(var prefix in a){buildParams(prefix,a[prefix],traditional,add)}}return s.join("&").replace(r20,"+")}});function buildParams(prefix,obj,traditional,add){if(jQuery.isArray(obj)){jQuery.each(obj,function(i,v){if(traditional||rbracket.test(prefix)){add(prefix,v)}else{buildParams(prefix+"["+(typeof v==="object"?i:"")+"]",v,traditional,add)}})}else{if(!traditional&&jQuery.type(obj)==="object"){for(var name in obj){buildParams(prefix+"["+name+"]",obj[name],traditional,add)}}else{add(prefix,obj)}}}jQuery.extend({active:0,lastModified:{},etag:{}});function ajaxHandleResponses(s,jqXHR,responses){var contents=s.contents,dataTypes=s.dataTypes,responseFields=s.responseFields,ct,type,finalDataType,firstDataType;for(type in responseFields){if(type in responses){jqXHR[responseFields[type]]=responses[type]}}while(dataTypes[0]==="*"){dataTypes.shift();if(ct===undefined){ct=s.mimeType||jqXHR.getResponseHeader("content-type")}}if(ct){for(type in contents){if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}}}if(dataTypes[0] in responses){finalDataType=dataTypes[0]}else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}if(!firstDataType){firstDataType=type}}finalDataType=finalDataType||firstDataType}if(finalDataType){if(finalDataType!==dataTypes[0]){dataTypes.unshift(finalDataType)}return responses[finalDataType]}}function ajaxConvert(s,response){if(s.dataFilter){response=s.dataFilter(response,s.dataType)}var dataTypes=s.dataTypes,converters={},i,key,length=dataTypes.length,tmp,current=dataTypes[0],prev,conversion,conv,conv1,conv2;for(i=1;i<length;i++){if(i===1){for(key in s.converters){if(typeof key==="string"){converters[key.toLowerCase()]=s.converters[key]}}}prev=current;current=dataTypes[i];if(current==="*"){current=prev}else{if(prev!=="*"&&prev!==current){conversion=prev+" "+current;conv=converters[conversion]||converters["* "+current];if(!conv){conv2=undefined;for(conv1 in converters){tmp=conv1.split(" ");if(tmp[0]===prev||tmp[0]==="*"){conv2=converters[tmp[1]+" "+current];if(conv2){conv1=converters[conv1];if(conv1===true){conv=conv2}else{if(conv2===true){conv=conv1}}break}}}}if(!(conv||conv2)){jQuery.error("No conversion from "+conversion.replace(" "," to "))}if(conv!==true){response=conv?conv(response):conv2(conv1(response))}}}}return response}var jsc=jQuery.now(),jsre=/(\=)\?(&|$)|\?\?/i;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return jQuery.expando+"_"+(jsc++)}});jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var inspectData=(typeof s.data==="string")&&/^application\/x\-www\-form\-urlencoded/.test(s.contentType);if(s.dataTypes[0]==="jsonp"||s.jsonp!==false&&(jsre.test(s.url)||inspectData&&jsre.test(s.data))){var responseContainer,jsonpCallback=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,previous=window[jsonpCallback],url=s.url,data=s.data,replace="$1"+jsonpCallback+"$2";if(s.jsonp!==false){url=url.replace(jsre,replace);if(s.url===url){if(inspectData){data=data.replace(jsre,replace)}if(s.data===data){url+=(/\?/.test(url)?"&":"?")+s.jsonp+"="+jsonpCallback}}}s.url=url;s.data=data;window[jsonpCallback]=function(response){responseContainer=[response]};jqXHR.always(function(){window[jsonpCallback]=previous;if(responseContainer&&jQuery.isFunction(previous)){window[jsonpCallback](responseContainer[0])}});s.converters["script json"]=function(){if(!responseContainer){jQuery.error(jsonpCallback+" was not called")}return responseContainer[0]};s.dataTypes[0]="json";return"script"}});jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(text){jQuery.globalEval(text);return text}}});jQuery.ajaxPrefilter("script",function(s){if(s.cache===undefined){s.cache=false}if(s.crossDomain){s.type="GET";s.global=false}});jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,head=document.head||document.getElementsByTagName("head")[0]||document.documentElement;return{send:function(_,callback){script=document.createElement("script");script.async="async";if(s.scriptCharset){script.charset=s.scriptCharset}script.src=s.url;script.onload=script.onreadystatechange=function(_,isAbort){if(isAbort||!script.readyState||/loaded|complete/.test(script.readyState)){script.onload=script.onreadystatechange=null;if(head&&script.parentNode){head.removeChild(script)}script=undefined;if(!isAbort){callback(200,"success")}}};head.insertBefore(script,head.firstChild)},abort:function(){if(script){script.onload(0,1)}}}}});var xhrOnUnloadAbort=window.ActiveXObject?function(){for(var key in xhrCallbacks){xhrCallbacks[key](0,1)}}:false,xhrId=0,xhrCallbacks;function createStandardXHR(){try{return new window.XMLHttpRequest()}catch(e){}}function createActiveXHR(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}jQuery.ajaxSettings.xhr=window.ActiveXObject?function(){return !this.isLocal&&createStandardXHR()||createActiveXHR()}:createStandardXHR;(function(xhr){jQuery.extend(jQuery.support,{ajax:!!xhr,cors:!!xhr&&("withCredentials" in xhr)})})(jQuery.ajaxSettings.xhr());if(jQuery.support.ajax){jQuery.ajaxTransport(function(s){if(!s.crossDomain||jQuery.support.cors){var callback;return{send:function(headers,complete){var xhr=s.xhr(),handle,i;if(s.username){xhr.open(s.type,s.url,s.async,s.username,s.password)}else{xhr.open(s.type,s.url,s.async)}if(s.xhrFields){for(i in s.xhrFields){xhr[i]=s.xhrFields[i]}}if(s.mimeType&&xhr.overrideMimeType){xhr.overrideMimeType(s.mimeType)}if(!s.crossDomain&&!headers["X-Requested-With"]){headers["X-Requested-With"]="XMLHttpRequest"}try{for(i in headers){xhr.setRequestHeader(i,headers[i])}}catch(_){}xhr.send((s.hasContent&&s.data)||null);callback=function(_,isAbort){var status,statusText,responseHeaders,responses,xml;try{if(callback&&(isAbort||xhr.readyState===4)){callback=undefined;if(handle){xhr.onreadystatechange=jQuery.noop;if(xhrOnUnloadAbort){delete xhrCallbacks[handle]}}if(isAbort){if(xhr.readyState!==4){xhr.abort()}}else{status=xhr.status;responseHeaders=xhr.getAllResponseHeaders();responses={};xml=xhr.responseXML;if(xml&&xml.documentElement){responses.xml=xml}try{responses.text=xhr.responseText}catch(_){}try{statusText=xhr.statusText}catch(e){statusText=""}if(!status&&s.isLocal&&!s.crossDomain){status=responses.text?200:404}else{if(status===1223){status=204}}}}}catch(firefoxAccessException){if(!isAbort){complete(-1,firefoxAccessException)}}if(responses){complete(status,statusText,responses,responseHeaders)}};if(!s.async||xhr.readyState===4){callback()}else{handle=++xhrId;if(xhrOnUnloadAbort){if(!xhrCallbacks){xhrCallbacks={};jQuery(window).unload(xhrOnUnloadAbort)}xhrCallbacks[handle]=callback}xhr.onreadystatechange=callback}},abort:function(){if(callback){callback(0,1)}}}}})}var elemdisplay={},iframe,iframeDoc,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,timerId,fxAttrs=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],fxNow;jQuery.fn.extend({show:function(speed,easing,callback){var elem,display;if(speed||speed===0){return this.animate(genFx("show",3),speed,easing,callback)}else{for(var i=0,j=this.length;i<j;i++){elem=this[i];if(elem.style){display=elem.style.display;if(!jQuery._data(elem,"olddisplay")&&display==="none"){display=elem.style.display=""}if((display===""&&jQuery.css(elem,"display")==="none")||!jQuery.contains(elem.ownerDocument.documentElement,elem)){jQuery._data(elem,"olddisplay",defaultDisplay(elem.nodeName))}}}for(i=0;i<j;i++){elem=this[i];if(elem.style){display=elem.style.display;if(display===""||display==="none"){elem.style.display=jQuery._data(elem,"olddisplay")||""}}}return this}},hide:function(speed,easing,callback){if(speed||speed===0){return this.animate(genFx("hide",3),speed,easing,callback)}else{var elem,display,i=0,j=this.length;for(;i<j;i++){elem=this[i];if(elem.style){display=jQuery.css(elem,"display");if(display!=="none"&&!jQuery._data(elem,"olddisplay")){jQuery._data(elem,"olddisplay",display)}}}for(i=0;i<j;i++){if(this[i].style){this[i].style.display="none"}}return this}},_toggle:jQuery.fn.toggle,toggle:function(fn,fn2,callback){var bool=typeof fn==="boolean";if(jQuery.isFunction(fn)&&jQuery.isFunction(fn2)){this._toggle.apply(this,arguments)}else{if(fn==null||bool){this.each(function(){var state=bool?fn:jQuery(this).is(":hidden");jQuery(this)[state?"show":"hide"]()})}else{this.animate(genFx("toggle",3),fn,fn2,callback)}}return this},fadeTo:function(speed,to,easing,callback){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var optall=jQuery.speed(speed,easing,callback);if(jQuery.isEmptyObject(prop)){return this.each(optall.complete,[false])}prop=jQuery.extend({},prop);function doAnimation(){if(optall.queue===false){jQuery._mark(this)}var opt=jQuery.extend({},optall),isElement=this.nodeType===1,hidden=isElement&&jQuery(this).is(":hidden"),name,val,p,e,hooks,replace,parts,start,end,unit,method;opt.animatedProperties={};for(p in prop){name=jQuery.camelCase(p);if(p!==name){prop[name]=prop[p];delete prop[p]}if((hooks=jQuery.cssHooks[name])&&"expand" in hooks){replace=hooks.expand(prop[name]);delete prop[name];for(p in replace){if(!(p in prop)){prop[p]=replace[p]}}}}for(name in prop){val=prop[name];if(jQuery.isArray(val)){opt.animatedProperties[name]=val[1];val=prop[name]=val[0]}else{opt.animatedProperties[name]=opt.specialEasing&&opt.specialEasing[name]||opt.easing||"swing"}if(val==="hide"&&hidden||val==="show"&&!hidden){return opt.complete.call(this)}if(isElement&&(name==="height"||name==="width")){opt.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY];if(jQuery.css(this,"display")==="inline"&&jQuery.css(this,"float")==="none"){if(!jQuery.support.inlineBlockNeedsLayout||defaultDisplay(this.nodeName)==="inline"){this.style.display="inline-block"}else{this.style.zoom=1}}}}if(opt.overflow!=null){this.style.overflow="hidden"}for(p in prop){e=new jQuery.fx(this,opt,p);val=prop[p];if(rfxtypes.test(val)){method=jQuery._data(this,"toggle"+p)||(val==="toggle"?hidden?"show":"hide":0);if(method){jQuery._data(this,"toggle"+p,method==="show"?"hide":"show");e[method]()}else{e[val]()}}else{parts=rfxnum.exec(val);start=e.cur();if(parts){end=parseFloat(parts[2]);unit=parts[3]||(jQuery.cssNumber[p]?"":"px");if(unit!=="px"){jQuery.style(this,p,(end||1)+unit);start=((end||1)/e.cur())*start;jQuery.style(this,p,start+unit)}if(parts[1]){end=((parts[1]==="-="?-1:1)*end)+start}e.custom(start,end,unit)}else{e.custom(start,val,"")}}}return true}return optall.queue===false?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){if(typeof type!=="string"){gotoEnd=clearQueue;clearQueue=type;type=undefined}if(clearQueue&&type!==false){this.queue(type||"fx",[])}return this.each(function(){var index,hadTimers=false,timers=jQuery.timers,data=jQuery._data(this);if(!gotoEnd){jQuery._unmark(true,this)}function stopQueue(elem,data,index){var hooks=data[index];jQuery.removeData(elem,index,true);hooks.stop(gotoEnd)}if(type==null){for(index in data){if(data[index]&&data[index].stop&&index.indexOf(".run")===index.length-4){stopQueue(this,data,index)}}}else{if(data[index=type+".run"]&&data[index].stop){stopQueue(this,data,index)}}for(index=timers.length;index--;){if(timers[index].elem===this&&(type==null||timers[index].queue===type)){if(gotoEnd){timers[index](true)}else{timers[index].saveState()}hadTimers=true;timers.splice(index,1)}}if(!(gotoEnd&&hadTimers)){jQuery.dequeue(this,type)}})}});function createFxNow(){setTimeout(clearFxNow,0);return(fxNow=jQuery.now())}function clearFxNow(){fxNow=undefined}function genFx(type,num){var obj={};jQuery.each(fxAttrs.concat.apply([],fxAttrs.slice(0,num)),function(){obj[this]=type});return obj}jQuery.each({slideDown:genFx("show",1),slideUp:genFx("hide",1),slideToggle:genFx("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}});jQuery.extend({speed:function(speed,easing,fn){var opt=speed&&typeof speed==="object"?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};opt.duration=jQuery.fx.off?0:typeof opt.duration==="number"?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default;if(opt.queue==null||opt.queue===true){opt.queue="fx"}opt.old=opt.complete;opt.complete=function(noUnmark){if(jQuery.isFunction(opt.old)){opt.old.call(this)}if(opt.queue){jQuery.dequeue(this,opt.queue)}else{if(noUnmark!==false){jQuery._unmark(this)}}};return opt},easing:{linear:function(p){return p},swing:function(p){return(-Math.cos(p*Math.PI)/2)+0.5}},timers:[],fx:function(elem,options,prop){this.options=options;this.elem=elem;this.prop=prop;options.orig=options.orig||{}}});jQuery.fx.prototype={update:function(){if(this.options.step){this.options.step.call(this.elem,this.now,this)}(jQuery.fx.step[this.prop]||jQuery.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null)){return this.elem[this.prop]}var parsed,r=jQuery.css(this.elem,this.prop);return isNaN(parsed=parseFloat(r))?!r||r==="auto"?0:r:parsed},custom:function(from,to,unit){var self=this,fx=jQuery.fx;this.startTime=fxNow||createFxNow();this.end=to;this.now=this.start=from;this.pos=this.state=0;this.unit=unit||this.unit||(jQuery.cssNumber[this.prop]?"":"px");function t(gotoEnd){return self.step(gotoEnd)}t.queue=this.options.queue;t.elem=this.elem;t.saveState=function(){if(jQuery._data(self.elem,"fxshow"+self.prop)===undefined){if(self.options.hide){jQuery._data(self.elem,"fxshow"+self.prop,self.start)}else{if(self.options.show){jQuery._data(self.elem,"fxshow"+self.prop,self.end)}}}};if(t()&&jQuery.timers.push(t)&&!timerId){timerId=setInterval(fx.tick,fx.interval)}},show:function(){var dataShow=jQuery._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=dataShow||jQuery.style(this.elem,this.prop);this.options.show=true;if(dataShow!==undefined){this.custom(this.cur(),dataShow)}else{this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur())}jQuery(this.elem).show()},hide:function(){this.options.orig[this.prop]=jQuery._data(this.elem,"fxshow"+this.prop)||jQuery.style(this.elem,this.prop);this.options.hide=true;this.custom(this.cur(),0)},step:function(gotoEnd){var p,n,complete,t=fxNow||createFxNow(),done=true,elem=this.elem,options=this.options;if(gotoEnd||t>=options.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();options.animatedProperties[this.prop]=true;for(p in options.animatedProperties){if(options.animatedProperties[p]!==true){done=false}}if(done){if(options.overflow!=null&&!jQuery.support.shrinkWrapBlocks){jQuery.each(["","X","Y"],function(index,value){elem.style["overflow"+value]=options.overflow[index]})}if(options.hide){jQuery(elem).hide()}if(options.hide||options.show){for(p in options.animatedProperties){jQuery.style(elem,p,options.orig[p]);jQuery.removeData(elem,"fxshow"+p,true);jQuery.removeData(elem,"toggle"+p,true)}}complete=options.complete;if(complete){options.complete=false;complete.call(elem)}}return false}else{if(options.duration==Infinity){this.now=t}else{n=t-this.startTime;this.state=n/options.duration;this.pos=jQuery.easing[options.animatedProperties[this.prop]](this.state,n,0,1,options.duration);this.now=this.start+((this.end-this.start)*this.pos)}this.update()}return true}};jQuery.extend(jQuery.fx,{tick:function(){var timer,timers=jQuery.timers,i=0;for(;i<timers.length;i++){timer=timers[i];if(!timer()&&timers[i]===timer){timers.splice(i--,1)}}if(!timers.length){jQuery.fx.stop()}},interval:13,stop:function(){clearInterval(timerId);timerId=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(fx){jQuery.style(fx.elem,"opacity",fx.now)},_default:function(fx){if(fx.elem.style&&fx.elem.style[fx.prop]!=null){fx.elem.style[fx.prop]=fx.now+fx.unit}else{fx.elem[fx.prop]=fx.now}}}});jQuery.each(fxAttrs.concat.apply([],fxAttrs),function(i,prop){if(prop.indexOf("margin")){jQuery.fx.step[prop]=function(fx){jQuery.style(fx.elem,prop,Math.max(0,fx.now)+fx.unit)}}});if(jQuery.expr&&jQuery.expr.filters){jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length}}function defaultDisplay(nodeName){if(!elemdisplay[nodeName]){var body=document.body,elem=jQuery("<"+nodeName+">").appendTo(body),display=elem.css("display");elem.remove();if(display==="none"||display===""){if(!iframe){iframe=document.createElement("iframe");iframe.frameBorder=iframe.width=iframe.height=0}body.appendChild(iframe);if(!iframeDoc||!iframe.createElement){iframeDoc=(iframe.contentWindow||iframe.contentDocument).document;iframeDoc.write((jQuery.support.boxModel?"<!doctype html>":"")+"<html><body>");iframeDoc.close()}elem=iframeDoc.createElement(nodeName);iframeDoc.body.appendChild(elem);display=jQuery.css(elem,"display");body.removeChild(iframe)}elemdisplay[nodeName]=display}return elemdisplay[nodeName]}var getOffset,rtable=/^t(?:able|d|h)$/i,rroot=/^(?:body|html)$/i;if("getBoundingClientRect" in document.documentElement){getOffset=function(elem,doc,docElem,box){try{box=elem.getBoundingClientRect()}catch(e){}if(!box||!jQuery.contains(docElem,elem)){return box?{top:box.top,left:box.left}:{top:0,left:0}}var body=doc.body,win=getWindow(doc),clientTop=docElem.clientTop||body.clientTop||0,clientLeft=docElem.clientLeft||body.clientLeft||0,scrollTop=win.pageYOffset||jQuery.support.boxModel&&docElem.scrollTop||body.scrollTop,scrollLeft=win.pageXOffset||jQuery.support.boxModel&&docElem.scrollLeft||body.scrollLeft,top=box.top+scrollTop-clientTop,left=box.left+scrollLeft-clientLeft;return{top:top,left:left}}}else{getOffset=function(elem,doc,docElem){var computedStyle,offsetParent=elem.offsetParent,prevOffsetParent=elem,body=doc.body,defaultView=doc.defaultView,prevComputedStyle=defaultView?defaultView.getComputedStyle(elem,null):elem.currentStyle,top=elem.offsetTop,left=elem.offsetLeft;while((elem=elem.parentNode)&&elem!==body&&elem!==docElem){if(jQuery.support.fixedPosition&&prevComputedStyle.position==="fixed"){break}computedStyle=defaultView?defaultView.getComputedStyle(elem,null):elem.currentStyle;top-=elem.scrollTop;left-=elem.scrollLeft;if(elem===offsetParent){top+=elem.offsetTop;left+=elem.offsetLeft;if(jQuery.support.doesNotAddBorder&&!(jQuery.support.doesAddBorderForTableAndCells&&rtable.test(elem.nodeName))){top+=parseFloat(computedStyle.borderTopWidth)||0;left+=parseFloat(computedStyle.borderLeftWidth)||0}prevOffsetParent=offsetParent;offsetParent=elem.offsetParent}if(jQuery.support.subtractsBorderForOverflowNotVisible&&computedStyle.overflow!=="visible"){top+=parseFloat(computedStyle.borderTopWidth)||0;left+=parseFloat(computedStyle.borderLeftWidth)||0}prevComputedStyle=computedStyle}if(prevComputedStyle.position==="relative"||prevComputedStyle.position==="static"){top+=body.offsetTop;left+=body.offsetLeft}if(jQuery.support.fixedPosition&&prevComputedStyle.position==="fixed"){top+=Math.max(docElem.scrollTop,body.scrollTop);left+=Math.max(docElem.scrollLeft,body.scrollLeft)}return{top:top,left:left}}}jQuery.fn.offset=function(options){if(arguments.length){return options===undefined?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)})}var elem=this[0],doc=elem&&elem.ownerDocument;if(!doc){return null}if(elem===doc.body){return jQuery.offset.bodyOffset(elem)}return getOffset(elem,doc,doc.documentElement)};jQuery.offset={bodyOffset:function(body){var top=body.offsetTop,left=body.offsetLeft;if(jQuery.support.doesNotIncludeMarginInBodyOffset){top+=parseFloat(jQuery.css(body,"marginTop"))||0;left+=parseFloat(jQuery.css(body,"marginLeft"))||0}return{top:top,left:left}},setOffset:function(elem,options,i){var position=jQuery.css(elem,"position");if(position==="static"){elem.style.position="relative"}var curElem=jQuery(elem),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),calculatePosition=(position==="absolute"||position==="fixed")&&jQuery.inArray("auto",[curCSSTop,curCSSLeft])>-1,props={},curPosition={},curTop,curLeft;if(calculatePosition){curPosition=curElem.position();curTop=curPosition.top;curLeft=curPosition.left}else{curTop=parseFloat(curCSSTop)||0;curLeft=parseFloat(curCSSLeft)||0}if(jQuery.isFunction(options)){options=options.call(elem,i,curOffset)}if(options.top!=null){props.top=(options.top-curOffset.top)+curTop}if(options.left!=null){props.left=(options.left-curOffset.left)+curLeft}if("using" in options){options.using.call(elem,props)}else{curElem.css(props)}}};jQuery.fn.extend({position:function(){if(!this[0]){return null}var elem=this[0],offsetParent=this.offsetParent(),offset=this.offset(),parentOffset=rroot.test(offsetParent[0].nodeName)?{top:0,left:0}:offsetParent.offset();offset.top-=parseFloat(jQuery.css(elem,"marginTop"))||0;offset.left-=parseFloat(jQuery.css(elem,"marginLeft"))||0;parentOffset.top+=parseFloat(jQuery.css(offsetParent[0],"borderTopWidth"))||0;parentOffset.left+=parseFloat(jQuery.css(offsetParent[0],"borderLeftWidth"))||0;return{top:offset.top-parentOffset.top,left:offset.left-parentOffset.left}},offsetParent:function(){return this.map(function(){var offsetParent=this.offsetParent||document.body;while(offsetParent&&(!rroot.test(offsetParent.nodeName)&&jQuery.css(offsetParent,"position")==="static")){offsetParent=offsetParent.offsetParent}return offsetParent})}});jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top=/Y/.test(prop);jQuery.fn[method]=function(val){return jQuery.access(this,function(elem,method,val){var win=getWindow(elem);if(val===undefined){return win?(prop in win)?win[prop]:jQuery.support.boxModel&&win.document.documentElement[method]||win.document.body[method]:elem[method]}if(win){win.scrollTo(!top?val:jQuery(win).scrollLeft(),top?val:jQuery(win).scrollTop())}else{elem[method]=val}},method,val,arguments.length,null)}});function getWindow(elem){return jQuery.isWindow(elem)?elem:elem.nodeType===9?elem.defaultView||elem.parentWindow:false}jQuery.each({Height:"height",Width:"width"},function(name,type){var clientProp="client"+name,scrollProp="scroll"+name,offsetProp="offset"+name;jQuery.fn["inner"+name]=function(){var elem=this[0];return elem?elem.style?parseFloat(jQuery.css(elem,type,"padding")):this[type]():null};jQuery.fn["outer"+name]=function(margin){var elem=this[0];return elem?elem.style?parseFloat(jQuery.css(elem,type,margin?"margin":"border")):this[type]():null};jQuery.fn[type]=function(value){return jQuery.access(this,function(elem,type,value){var doc,docElemProp,orig,ret;if(jQuery.isWindow(elem)){doc=elem.document;docElemProp=doc.documentElement[clientProp];return jQuery.support.boxModel&&docElemProp||doc.body&&doc.body[clientProp]||docElemProp}if(elem.nodeType===9){doc=elem.documentElement;if(doc[clientProp]>=doc[scrollProp]){return doc[clientProp]}return Math.max(elem.body[scrollProp],doc[scrollProp],elem.body[offsetProp],doc[offsetProp])}if(value===undefined){orig=jQuery.css(elem,type);ret=parseFloat(orig);return jQuery.isNumeric(ret)?ret:orig}jQuery(elem).css(type,value)},type,value,arguments.length,null)}});window.jQuery=window.$=jQuery;if(typeof define==="function"&&define.amd&&define.amd.jQuery){define("jquery",[],function(){return jQuery})}})(window);
/* module-key = 'com.atlassian.auiplugin:jquery-compatibility', location = 'js/external/jquery/jquery-compatibility.js' */
jQuery.noConflict();
/* module-key = 'com.atlassian.auiplugin:aui-core', location = '${pdl.dir}js/atlassian/atlassian.js' */
/* Atlassian UI and the Atlassian Design Guidelines are created by Atlassian. See https://developer.atlassian.com/display/AUI/ for API documentation and https://developer.atlassian.com/design/ for license details. */
if(typeof jQuery!="undefined"){var AJS=(function(){var F=[];function G(H){switch(H){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"'":return"&#39;";case"`":return"&#96;";default:return"&quot;"}}var B=/[&"'<>`]/g;var E={version:"5.1.8",params:{},$:jQuery,log:function(){if(typeof console!="undefined"&&console.log){Function.prototype.apply.apply(console.log,[console,arguments])}},I18n:{getText:function(H){return H}},stopEvent:function(H){H.stopPropagation();return false},include:function(H){if(!this.contains(F,H)){F.push(H);var I=document.createElement("script");I.src=H;this.$("body").append(I)}},toggleClassName:function(H,I){if(!(H=this.$(H))){return }H.toggleClass(I)},setVisible:function(I,H){if(!(I=this.$(I))){return }var J=this.$;J(I).each(function(){var K=J(this).hasClass("hidden");if(K&&H){J(this).removeClass("hidden")}else{if(!K&&!H){J(this).addClass("hidden")}}})},setCurrent:function(H,I){if(!(H=this.$(H))){return }if(I){H.addClass("current")}else{H.removeClass("current")}},isVisible:function(H){return !this.$(H).hasClass("hidden")},isClipped:function(H){H=AJS.$(H);return(H.prop("scrollWidth")>H.prop("clientWidth"))},populateParameters:function(){var H=this;this.$(".parameters input").each(function(){var I=this.value,J=this.title||this.id;if(H.$(this).hasClass("list")){if(H.params[J]){H.params[J].push(I)}else{H.params[J]=[I]}}else{H.params[J]=(I.match(/^(tru|fals)e$/i)?I.toLowerCase()=="true":I)}})},toInit:function(I){var H=this;this.$(function(){try{I.apply(this,arguments)}catch(J){H.log("Failed to run init function: "+J+"\n"+I.toString())}});return this},indexOf:function(L,K,I){var J=L.length;if(I==null){I=0}else{if(I<0){I=Math.max(0,J+I)}}for(var H=I;H<J;H++){if(L[H]===K){return H}}return -1},contains:function(I,H){return this.indexOf(I,H)>-1},format:function(J){var H=/^((?:(?:[^']*'){2})*?[^']*?)\{(\d+)\}/,I=/'(?!')/g;AJS.format=function(N){var L=arguments,M="",K=N.match(H);while(K){N=N.substring(K[0].length);M+=K[1].replace(I,"")+(L.length>++K[2]?L[K[2]]:"");K=N.match(H)}return M+=N.replace(I,"")};return AJS.format.apply(AJS,arguments)},firebug:function(){AJS.log("DEPRECATED: AJS.firebug should no longer be used.");var H=this.$(document.createElement("script"));H.attr("src","http://getfirebug.com/releases/lite/1.2/firebug-lite-compressed.js");this.$("head").append(H);(function(){if(window.firebug){firebug.init()}else{setTimeout(arguments.callee,0)}})()},clone:function(H){return AJS.$(H).clone().removeAttr("id")},alphanum:function(O,N){O=(O+"").toLowerCase();N=(N+"").toLowerCase();var J=/(\d+|\D+)/g,K=O.match(J),H=N.match(J),M=Math.max(K.length,H.length);for(var I=0;I<M;I++){if(I==K.length){return -1}if(I==H.length){return 1}var P=parseInt(K[I],10),L=parseInt(H[I],10);if(P==K[I]&&L==H[I]&&P!=L){return(P-L)/Math.abs(P-L)}if((P!=K[I]||L!=H[I])&&K[I]!=H[I]){return K[I]<H[I]?-1:1}}return 0},dim:function(J){if(!AJS.dim.$dim){AJS.dim.$dim=AJS("div").addClass("aui-blanket");if(AJS.$.browser.msie){AJS.dim.$dim.css({width:"200%",height:Math.max(AJS.$(document).height(),AJS.$(window).height())+"px"})}AJS.$("body").append(AJS.dim.$dim);AJS.hasFlash=false;var I=/^[^:]*:\/*[^/]*|/;var H=I.exec(location.href)[0];if(AJS.$.browser.msie&&typeof AJS.hasFlash==="undefined"&&J===false){AJS.$("object, embed, iframe").each(function(){if(this.nodeName.toLowerCase()==="iframe"){if(I.exec(this.src)[0]===H&&AJS.$(this).contents().find("object, embed").length===0){return true}}AJS.hasFlash=true;return false})}if(AJS.$.browser.msie&&(J!==false||AJS.hasFlash)){AJS.dim.shim=AJS.$('<iframe frameBorder="0" class="aui-blanket-shim" src="javascript:false;"/>');AJS.dim.shim.css({height:Math.max(AJS.$(document).height(),AJS.$(window).height())+"px"});AJS.$("body").append(AJS.dim.shim)}if(AJS.$.browser.msie&&parseInt(AJS.$.browser.version,10)<8){AJS.dim.cachedOverflow=AJS.$("html").css("overflow");AJS.$("html").css("overflow","hidden")}else{AJS.dim.cachedOverflow=AJS.$("body").css("overflow");AJS.$("body").css("overflow","hidden")}}},undim:function(){if(AJS.dim.$dim){AJS.dim.$dim.remove();AJS.dim.$dim=null;if(AJS.dim.shim){AJS.dim.shim.remove()}if(AJS.$.browser.msie&&parseInt(AJS.$.browser.version,10)<8){AJS.$("html").css("overflow",AJS.dim.cachedOverflow)}else{AJS.$("body").css("overflow",AJS.dim.cachedOverflow)}if(AJS.$.browser.safari){var H=AJS.$(window).scrollTop();AJS.$(window).scrollTop(10+5*(H==10)).scrollTop(H)}}},onTextResize:function(I){if(typeof I=="function"){if(AJS.onTextResize["on-text-resize"]){AJS.onTextResize["on-text-resize"].push(function(J){I(J)})}else{var H=AJS("div");H.css({width:"1em",height:"1em",position:"absolute",top:"-9999em",left:"-9999em"});this.$("body").append(H);H.size=H.width();setInterval(function(){if(H.size!=H.width()){H.size=H.width();for(var J=0,K=AJS.onTextResize["on-text-resize"].length;J<K;J++){AJS.onTextResize["on-text-resize"][J](H.size)}}},0);AJS.onTextResize.em=H;AJS.onTextResize["on-text-resize"]=[function(J){I(J)}]}}},unbindTextResize:function(J){for(var H=0,I=AJS.onTextResize["on-text-resize"].length;H<I;H++){if(AJS.onTextResize["on-text-resize"][H]==J){return AJS.onTextResize["on-text-resize"].splice(H,1)}}},escape:function(H){return escape(H).replace(/%u\w{4}/gi,function(I){return unescape(I)})},escapeHtml:function(H){return H.replace(B,G)},filterBySearch:function(L,Q,R){if(Q==""){return[]}var J=this.$;var O=(R&&R.keywordsField)||"keywords";var N=(R&&R.ignoreForCamelCase)?"i":"";var K=(R&&R.matchBoundary)?"\\b":"";var I=(R&&R.splitRegex)||(/\s+/);var M=Q.split(I);var H=[];J.each(M,function(){var T=[new RegExp(K+this,"i")];if(/^([A-Z][a-z]*){2,}$/.test(this)){var S=this.replace(/([A-Z][a-z]*)/g,"\\b$1[^,]*");T.push(new RegExp(S,N))}H.push(T)});var P=[];J.each(L,function(){for(var U=0;U<H.length;U++){var S=false;for(var T=0;T<H[U].length;T++){if(H[U][T].test(this[O])){S=true;break}}if(!S){return }}P.push(this)});return P},drawLogo:function(Q){AJS.log("DEPRECATED: AJS.drawLogo should no longer be used.");var J=Q.scaleFactor||1,O=Q.fill||"#fff",P=Q.stroke||"#000",H=400*J,M=40*J,L=Q.strokeWidth||1,N=Q.containerID||".aui-logo";if(AJS.$(".aui-logo").size()==0){AJS.$("body").append("<div id='aui-logo' class='aui-logo'><div>")}var K=Raphael(N,H+50*J,M+100*J);var I=K.path("M 0,0 c 3.5433333,-4.7243333 7.0866667,-9.4486667 10.63,-14.173 -14.173,0 -28.346,0 -42.519,0 C -35.432667,-9.4486667 -38.976333,-4.7243333 -42.52,0 -28.346667,0 -14.173333,0 0,0 z m 277.031,28.346 c -14.17367,0 -28.34733,0 -42.521,0 C 245.14,14.173 255.77,0 266.4,-14.173 c -14.17267,0 -28.34533,0 -42.518,0 C 213.25167,0 202.62133,14.173 191.991,28.346 c -14.17333,0 -28.34667,0 -42.52,0 14.17333,-18.8976667 28.34667,-37.7953333 42.52,-56.693 -7.08667,-9.448667 -14.17333,-18.897333 -21.26,-28.346 -14.173,0 -28.346,0 -42.519,0 7.08667,9.448667 14.17333,18.897333 21.26,28.346 -14.17333,18.8976667 -28.34667,37.7953333 -42.52,56.693 -14.173333,0 -28.346667,0 -42.52,0 10.63,-14.173 21.26,-28.346 31.89,-42.519 -14.390333,0 -28.780667,0 -43.171,0 C 42.520733,1.330715e-4 31.889933,14.174867 21.26,28.347 c -42.520624,6.24e-4 -85.039187,-8.13e-4 -127.559,-0.001 11.220667,-14.961 22.441333,-29.922 33.662,-44.883 -6.496,-8.661 -12.992,-17.322 -19.488,-25.983 5.905333,0 11.810667,0 17.716,0 -10.63,-14.173333 -21.26,-28.346667 -31.89,-42.52 14.173333,0 28.346667,0 42.52,0 10.63,14.173333 21.26,28.346667 31.89,42.52 14.173333,0 28.3466667,0 42.52,0 -10.63,-14.173333 -21.26,-28.346667 -31.89,-42.52 14.1733333,0 28.3466667,0 42.52,0 10.63,14.173333 21.26,28.346667 31.89,42.52 14.390333,0 28.780667,0 43.171,0 -10.63,-14.173333 -21.26,-28.346667 -31.89,-42.52 42.51967,0 85.03933,0 127.559,0 10.63033,14.173333 21.26067,28.346667 31.891,42.52 14.17267,0 28.34533,0 42.518,0 -10.63,-14.173333 -21.26,-28.346667 -31.89,-42.52 14.17367,0 28.34733,0 42.521,0 14.17333,18.897667 28.34667,37.795333 42.52,56.693 -14.17333,18.8976667 -28.34667,37.7953333 -42.52,56.693 z");I.scale(J,-J,0,0);I.translate(120*J,M);I.attr("fill",O);I.attr("stroke",P);I.attr("stroke-width",L)},debounce:function(I,K){var J;var H;return function(){var L=arguments;var M=this;var N=function(){H=I.apply(M,L)};clearTimeout(J);J=setTimeout(N,K);return H}}};if(typeof AJS!="undefined"){for(var D in AJS){E[D]=AJS[D]}}var A=function(){var H=null;if(arguments.length&&typeof arguments[0]=="string"){H=arguments.callee.$(document.createElement(arguments[0]));if(arguments.length==2){H.html(arguments[1])}}return H};for(var C in E){A[C]=E[C]}return A})();AJS.$(function(){var A=AJS.$("body");if(!A.data("auiVersion")){A.attr("data-aui-version",AJS.version)}AJS.populateParameters()})}if(typeof console=="undefined"){console={messages:[],log:function(A){this.messages.push(A)},show:function(){alert(this.messages.join("\n"));this.messages=[]}}}else{console.show=function(){}}AJS.$.ajaxSettings.traditional=true;
/* module-key = 'com.atlassian.auiplugin:ajs-gadgets-base', location = 'js/external/jquery/plugins/jquery.aop.js' */
(function(){var _after=1;var _afterThrow=2;var _afterFinally=3;var _before=4;var _around=5;var _intro=6;var _regexEnabled=true;var _arguments="arguments";var _undef="undefined";var getType=(function(){var toString=Object.prototype.toString,toStrings={},nodeTypes={1:"element",3:"textnode",9:"document",11:"fragment"},types="Arguments Array Boolean Date Document Element Error Fragment Function NodeList Null Number Object RegExp String TextNode Undefined Window".split(" ");for(var i=types.length;i--;){var type=types[i],constructor=window[type];if(constructor){try{toStrings[toString.call(new constructor)]=type.toLowerCase()}catch(e){}}}return function(item){return item==null&&(item===undefined?_undef:"null")||item.nodeType&&nodeTypes[item.nodeType]||typeof item.length=="number"&&(item.callee&&_arguments||item.alert&&"window"||item.item&&"nodelist")||toStrings[toString.call(item)]}})();var isFunc=function(obj){return getType(obj)=="function"};var weaveOne=function(source,method,advice){var old=source[method];if(advice.type!=_intro&&!isFunc(old)){var oldObject=old;old=function(){var code=arguments.length>0?_arguments+"[0]":"";for(var i=1;i<arguments.length;i++){code+=","+_arguments+"["+i+"]"}return eval("oldObject("+code+");")}}var aspect;if(advice.type==_after||advice.type==_afterThrow||advice.type==_afterFinally){aspect=function(){var returnValue,exceptionThrown=null;try{returnValue=old.apply(this,arguments)}catch(e){exceptionThrown=e}if(advice.type==_after){if(exceptionThrown==null){returnValue=advice.value.apply(this,[returnValue,method])}else{throw exceptionThrown}}else{if(advice.type==_afterThrow&&exceptionThrown!=null){returnValue=advice.value.apply(this,[exceptionThrown,method])}else{if(advice.type==_afterFinally){returnValue=advice.value.apply(this,[returnValue,exceptionThrown,method])}}}return returnValue}}else{if(advice.type==_before){aspect=function(){advice.value.apply(this,[arguments,method]);return old.apply(this,arguments)}}else{if(advice.type==_intro){aspect=function(){return advice.value.apply(this,arguments)}}else{if(advice.type==_around){aspect=function(){var invocation={object:this,args:Array.prototype.slice.call(arguments)};return advice.value.apply(invocation.object,[{arguments:invocation.args,method:method,proceed:function(){return old.apply(invocation.object,invocation.args)}}])}}}}}aspect.unweave=function(){source[method]=old;pointcut=source=aspect=old=null};source[method]=aspect;return aspect};var search=function(source,pointcut,advice){var methods=[];for(var method in source){var item=null;try{item=source[method]}catch(e){}if(item!=null&&method.match(pointcut.method)&&isFunc(item)){methods[methods.length]={source:source,method:method,advice:advice}}}return methods};var weave=function(pointcut,advice){var source=typeof (pointcut.target.prototype)!=_undef?pointcut.target.prototype:pointcut.target;var advices=[];if(advice.type!=_intro&&typeof (source[pointcut.method])==_undef){var methods=search(pointcut.target,pointcut,advice);if(methods.length==0){methods=search(source,pointcut,advice)}for(var i in methods){advices[advices.length]=weaveOne(methods[i].source,methods[i].method,methods[i].advice)}}else{advices[0]=weaveOne(source,pointcut.method,advice)}return _regexEnabled?advices:advices[0]};jQuery.aop={after:function(pointcut,advice){return weave(pointcut,{type:_after,value:advice})},afterThrow:function(pointcut,advice){return weave(pointcut,{type:_afterThrow,value:advice})},afterFinally:function(pointcut,advice){return weave(pointcut,{type:_afterFinally,value:advice})},before:function(pointcut,advice){return weave(pointcut,{type:_before,value:advice})},around:function(pointcut,advice){return weave(pointcut,{type:_around,value:advice})},introduction:function(pointcut,advice){return weave(pointcut,{type:_intro,value:advice})},setup:function(settings){_regexEnabled=settings.regexMatch}}})();
/* module-key = 'com.atlassian.auiplugin:ajs-gadgets-base', location = 'js/atlassian/dropdown.js' */
AJS.dropDown=function(L,E){var U=null,I=[],Q=false,H=AJS.$(document),C={item:"li:has(a)",activeClass:"active",alignment:"right",displayHandler:function(W){return W.name},escapeHandler:function(){this.hide("escape");return false},hideHandler:function(){},moveHandler:function(X,W){},useDisabled:false};AJS.$.extend(C,E);C.alignment={left:"left",right:"right"}[C.alignment.toLowerCase()]||"left";if(L&&L.jquery){U=L}else{if(typeof L=="string"){U=AJS.$(L)}else{if(L&&L.constructor==Array){U=AJS("div").addClass("aui-dropdown").toggleClass("hidden",!!C.isHiddenByDefault);for(var P=0,K=L.length;P<K;P++){var J=AJS("ol");for(var O=0,S=L[P].length;O<S;O++){var M=AJS("li");var G=L[P][O];if(G.href){M.append(AJS("a").html("<span>"+C.displayHandler(G)+"</span>").attr({href:G.href}).addClass(G.className));AJS.$.data(AJS.$("a > span",M)[0],"properties",G)}else{M.html(G.html).addClass(G.className)}if(G.icon){M.prepend(AJS("img").attr("src",G.icon))}if(G.insideSpanIcon){M.children("a").prepend(AJS("span").attr("class","icon"))}AJS.$.data(M[0],"properties",G);J.append(M)}if(P==K-1){J.addClass("last")}U.append(J)}AJS.$("body").append(U)}else{throw new Error("AJS.dropDown function was called with illegal parameter. Should be AJS.$ object, AJS.$ selector or array.")}}}var F=function(){N(+1)};var T=function(){N(-1)};var N=function(Z){var Y=!Q,W=AJS.dropDown.current.$[0],X=AJS.dropDown.current.links,a=W.focused;Q=true;if(X.length===0){return }W.focused=(typeof a==="number")?a:-1;if(!AJS.dropDown.current){AJS.log("move - not current, aborting");return true}W.focused+=Z;if(W.focused<0){W.focused=X.length-1}else{if(W.focused>=X.length){W.focused=0}}C.moveHandler(AJS.$(X[W.focused]),Z<0?"up":"down");if(Y&&X.length){AJS.$(X[W.focused]).addClass(C.activeClass);Q=false}else{if(!X.length){Q=false}}};var V=function(Y){if(!AJS.dropDown.current){return true}var Z=Y.which,W=AJS.dropDown.current.$[0],X=AJS.dropDown.current.links;AJS.dropDown.current.cleanActive();switch(Z){case 40:F();break;case 38:T();break;case 27:return C.escapeHandler.call(AJS.dropDown.current,Y);case 13:if(W.focused>=0){if(!C.selectionHandler){if(AJS.$(X[W.focused]).attr("nodeName")!="a"){return AJS.$("a",X[W.focused]).trigger("focus")}else{return AJS.$(X[W.focused]).trigger("focus")}}else{return C.selectionHandler.call(AJS.dropDown.current,Y,AJS.$(X[W.focused]))}}return true;default:if(X.length){AJS.$(X[W.focused]).addClass(C.activeClass)}return true}Y.stopPropagation();Y.preventDefault();return false};var A=function(W){if(!((W&&W.which&&(W.which==3))||(W&&W.button&&(W.button==2))||false)){if(AJS.dropDown.current){AJS.dropDown.current.hide("click")}}};var D=function(W){return function(){if(!AJS.dropDown.current){return }AJS.dropDown.current.cleanFocus();this.originalClass=this.className;AJS.$(this).addClass(C.activeClass);AJS.dropDown.current.$[0].focused=W}};var R=function(W){if(W.button||W.metaKey||W.ctrlKey||W.shiftKey){return true}if(AJS.dropDown.current&&C.selectionHandler){C.selectionHandler.call(AJS.dropDown.current,W,AJS.$(this))}};var B=function(X){var W=false;if(X.data("events")){AJS.$.each(X.data("events"),function(Y,Z){AJS.$.each(Z,function(b,a){if(R===a){W=true;return false}})})}return W};U.each(function(){var W=this,Y=AJS.$(this),Z={};var X={reset:function(){Z=AJS.$.extend(Z,{$:Y,links:AJS.$(C.item||"li:has(a)",W),cleanActive:function(){if(W.focused+1&&Z.links.length){AJS.$(Z.links[W.focused]).removeClass(C.activeClass)}},cleanFocus:function(){Z.cleanActive();W.focused=-1},moveDown:F,moveUp:T,moveFocus:V,getFocusIndex:function(){return(typeof W.focused=="number")?W.focused:-1}});Z.links.each(function(a){var b=AJS.$(this);if(!B(b)){b.hover(D(a),Z.cleanFocus);b.click(R)}})},appear:function(a){if(a){Y.removeClass("hidden");Y.addClass("aui-dropdown-"+C.alignment)}else{Y.addClass("hidden")}},fade:function(a){if(a){Y.fadeIn("fast")}else{Y.fadeOut("fast")}},scroll:function(a){if(a){Y.slideDown("fast")}else{Y.slideUp("fast")}}};Z.reset=X.reset;Z.reset();Z.addControlProcess=function(b,a){AJS.$.aop.around({target:this,method:b},a)};Z.addCallback=function(b,a){return AJS.$.aop.after({target:this,method:b},a)};Z.show=function(a){if(C.useDisabled&&this.$.closest(".aui-dd-parent").hasClass("disabled")){return }this.alignment=C.alignment;A();AJS.dropDown.current=this;this.method=a||this.method||"appear";this.timer=setTimeout(function(){H.click(A)},0);H.keydown(V);if(C.firstSelected&&this.links[0]){D(0).call(this.links[0])}AJS.$(W.offsetParent).css({zIndex:2000});X[this.method](true);AJS.$(document).trigger("showLayer",["dropdown",AJS.dropDown.current])};Z.hide=function(a){this.method=this.method||"appear";AJS.$(Y.get(0).offsetParent).css({zIndex:""});this.cleanFocus();X[this.method](false);H.unbind("click",A).unbind("keydown",V);AJS.$(document).trigger("hideLayer",["dropdown",AJS.dropDown.current]);AJS.dropDown.current=null;return a};Z.addCallback("reset",function(){if(C.firstSelected&&this.links[0]){D(0).call(this.links[0])}});if(!AJS.dropDown.iframes){AJS.dropDown.iframes=[]}AJS.dropDown.createShims=function(){AJS.$("iframe").each(function(a){var b=this;if(!b.shim){b.shim=AJS.$("<div />").addClass("shim hidden").appendTo("body");AJS.dropDown.iframes.push(b)}});return arguments.callee}();Z.addCallback("show",function(){AJS.$(AJS.dropDown.iframes).each(function(){var a=AJS.$(this);if(a.is(":visible")){var b=a.offset();b.height=a.height();b.width=a.width();this.shim.css({left:b.left+"px",top:b.top+"px",height:b.height+"px",width:b.width+"px"}).removeClass("hidden")}})});Z.addCallback("hide",function(){AJS.$(AJS.dropDown.iframes).each(function(){this.shim.addClass("hidden")});C.hideHandler()});if(AJS.$.browser.msie&&~~(AJS.$.browser.version)<9){(function(){var a=function(){if(this.$.is(":visible")){if(!this.iframeShim){this.iframeShim=AJS.$('<iframe class="dropdown-shim" src="javascript:false;" frameBorder="0" />').insertBefore(this.$)}this.iframeShim.css({display:"block",top:this.$.css("top"),width:this.$.outerWidth()+"px",height:this.$.outerHeight()+"px"});if(C.alignment=="left"){this.iframeShim.css({left:"0px"})}else{this.iframeShim.css({right:"0px"})}}};Z.addCallback("reset",a);Z.addCallback("show",a);Z.addCallback("hide",function(){if(this.iframeShim){this.iframeShim.css({display:"none"})}})})()}I.push(Z)});return I};AJS.dropDown.getAdditionalPropertyValue=function(D,A){var C=D[0];if(!C||(typeof C.tagName!="string")||C.tagName.toLowerCase()!="li"){AJS.log("AJS.dropDown.getAdditionalPropertyValue : item passed in should be an LI element wrapped by jQuery")}var B=AJS.$.data(C,"properties");return B?B[A]:null};AJS.dropDown.removeAllAdditionalProperties=function(A){};AJS.dropDown.Standard=function(H){var C=[],G,B={selector:".aui-dd-parent",dropDown:".aui-dropdown",trigger:".aui-dd-trigger"};AJS.$.extend(B,H);var F=function(I,L,K,J){AJS.$.extend(J,{trigger:I});L.addClass("dd-allocated");K.addClass("hidden");if(B.isHiddenByDefault==false){J.show()}J.addCallback("show",function(){L.addClass("active")});J.addCallback("hide",function(){L.removeClass("active")})};var A=function(K,I,L,J){if(J!=AJS.dropDown.current){L.css({top:I.outerHeight()});J.show();K.stopImmediatePropagation()}K.preventDefault()};if(B.useLiveEvents){var D=[];var E=[];AJS.$(B.trigger).live("click",function(L){var I=AJS.$(this);var N,M,J;var K;if((K=AJS.$.inArray(this,D))>=0){var O=E[K];N=O.parent;M=O.dropdown;J=O.ddcontrol}else{N=I.closest(B.selector);M=N.find(B.dropDown);if(M.length===0){return }J=AJS.dropDown(M,B)[0];if(!J){return }D.push(this);O={parent:N,dropdown:M,ddcontrol:J};F(I,N,M,J);E.push(O)}A(L,I,M,J)})}else{if(this instanceof AJS.$){G=this}else{G=AJS.$(B.selector)}G=G.not(".dd-allocated").filter(":has("+B.dropDown+")").filter(":has("+B.trigger+")");G.each(function(){var L=AJS.$(this),K=AJS.$(B.dropDown,this),I=AJS.$(B.trigger,this),J=AJS.dropDown(K,B)[0];AJS.$.extend(J,{trigger:I});F(I,L,K,J);I.click(function(M){A(M,I,K,J)});C.push(J)})}return C};AJS.dropDown.Ajax=function(C){var B,A={cache:true};AJS.$.extend(A,C||{});B=AJS.dropDown.Standard.call(this,A);AJS.$(B).each(function(){var D=this;AJS.$.extend(D,{getAjaxOptions:function(E){var F=function(G){if(A.formatResults){G=A.formatResults(G)}if(A.cache){D.cache.set(D.getAjaxOptions(),G)}D.refreshSuccess(G)};if(A.ajaxOptions){if(AJS.$.isFunction(A.ajaxOptions)){return AJS.$.extend(A.ajaxOptions.call(D),{success:F})}else{return AJS.$.extend(A.ajaxOptions,{success:F})}}return AJS.$.extend(E,{success:F})},refreshSuccess:function(E){this.$.html(E)},cache:function(){var E={};return{get:function(F){var G=F.data||"";return E[(F.url+G).replace(/[\?\&]/gi,"")]},set:function(F,G){var H=F.data||"";E[(F.url+H).replace(/[\?\&]/gi,"")]=G},reset:function(){E={}}}}(),show:function(E){return function(F){if(A.cache&&!!D.cache.get(D.getAjaxOptions())){D.refreshSuccess(D.cache.get(D.getAjaxOptions()));E.call(D)}else{AJS.$(AJS.$.ajax(D.getAjaxOptions())).throbber({target:D.$,end:function(){D.reset()}});E.call(D);if(D.iframeShim){D.iframeShim.hide()}}}}(D.show),resetCache:function(){D.cache.reset()}});D.addCallback("refreshSuccess",function(){D.reset()})});return B};AJS.$.fn.dropDown=function(B,A){B=(B||"Standard").replace(/^([a-z])/,function(C){return C.toUpperCase()});return AJS.dropDown[B].call(this,A)};
/* module-key = 'com.atlassian.auiplugin:ajs-raphael', location = 'js/external/raphael/raphael.js' */
/* THIS FILE HAS BEEN MODIFIED BY ATLASSIAN. See https://ecosystem.atlassian.net/browse/AUI-1535 for details. Modified lines are marked below, search "ATLASSIAN" */
(function(I){var E="0.3.4",J="hasOwnProperty",B=/[\.\/]/,A="*",G=function(){},F=function(M,L){return M-L},D,H,K={n:{}},C=function(L,a){var U=K,R=H,V=Array.prototype.slice.call(arguments,2),X=C.listeners(L),W=0,T=false,O,N=[],S={},P=[],M=D,Y=[];D=L;H=0;for(var Q=0,Z=X.length;Q<Z;Q++){if("zIndex" in X[Q]){N.push(X[Q].zIndex);if(X[Q].zIndex<0){S[X[Q].zIndex]=X[Q]}}}N.sort(F);while(N[W]<0){O=S[N[W++]];P.push(O.apply(a,V));if(H){H=R;return P}}for(Q=0;Q<Z;Q++){O=X[Q];if("zIndex" in O){if(O.zIndex==N[W]){P.push(O.apply(a,V));if(H){break}do{W++;O=S[N[W]];O&&P.push(O.apply(a,V));if(H){break}}while(O)}else{S[O.zIndex]=O}}else{P.push(O.apply(a,V));if(H){break}}}H=R;D=M;return P.length?P:null};C.listeners=function(L){var T=L.split(B),R=K,X,S,M,P,W,O,Q,U,V=[R],N=[];for(P=0,W=T.length;P<W;P++){U=[];for(O=0,Q=V.length;O<Q;O++){R=V[O].n;S=[R[T[P]],R[A]];M=2;while(M--){X=S[M];if(X){U.push(X);N=N.concat(X.f||[])}}}V=U}return N};C.on=function(L,O){var Q=L.split(B),P=K;for(var M=0,N=Q.length;M<N;M++){P=P.n;!P[Q[M]]&&(P[Q[M]]={n:{}});P=P[Q[M]]}P.f=P.f||[];for(M=0,N=P.f.length;M<N;M++){if(P.f[M]==O){return G}}P.f.push(O);return function(R){if(+R==+R){O.zIndex=+R}}};C.stop=function(){H=1};C.nt=function(L){if(L){return new RegExp("(?:\\.|\\/|^)"+L+"(?:\\.|\\/|$)").test(D)}return D};C.off=C.unbind=function(M,R){var T=M.split(B),S,V,N,P,W,O,Q,U=[K];for(P=0,W=T.length;P<W;P++){for(O=0;O<U.length;O+=N.length-2){N=[O,1];S=U[O].n;if(T[P]!=A){if(S[T[P]]){N.push(S[T[P]])}}else{for(V in S){if(S[J](V)){N.push(S[V])}}}U.splice.apply(U,N)}}for(P=0,W=U.length;P<W;P++){S=U[P];while(S.n){if(R){if(S.f){for(O=0,Q=S.f.length;O<Q;O++){if(S.f[O]==R){S.f.splice(O,1);break}}!S.f.length&&delete S.f}for(V in S.n){if(S.n[J](V)&&S.n[V].f){var L=S.n[V].f;for(O=0,Q=L.length;O<Q;O++){if(L[O]==R){L.splice(O,1);break}}!L.length&&delete S.n[V].f}}}else{delete S.f;for(V in S.n){if(S.n[J](V)&&S.n[V].f){delete S.n[V].f}}}S=S.n}}};C.once=function(L,M){var N=function(){var O=M.apply(this,arguments);C.unbind(L,N);return O};return C.on(L,N)};C.version=E;C.toString=function(){return"You are running Eve "+E};(typeof module!="undefined"&&module.exports)?(module.exports=C):(typeof define!="undefined"?(define("eve",[],function(){return C})):(I.eve=C))})(this);if(!window.eve&&typeof define==="function"&&typeof require==="function"){window.eve=require("eve")}(function(){function Aq(S){if(Aq.is(S,"function")){return AO?S():eve.on("raphael.DOMload",S)}else{if(Aq.is(S,BC)){return Aq._engine.create[Bf](Aq,S.splice(0,3+Aq.is(S[0],Ak))).add(S)}else{var E=Array.prototype.slice.call(arguments,0);if(Aq.is(E[E.length-1],"function")){var R=E.pop();return AO?R.call(Aq._engine.create[Bf](Aq,E)):eve.on("raphael.DOMload",function(){R.call(Aq._engine.create[Bf](Aq,E))})}else{return Aq._engine.create[Bf](Aq,arguments)}}}}Aq.version="2.1.0";Aq.eve=eve;var AO,A=/[, ]+/,BV={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},BQ=/\{(\d+)\}/g,Bi="prototype",AK="hasOwnProperty",AZ={doc:document,win:window},P={was:Object.prototype[AK].call(AZ.win,"Raphael"),is:AZ.win.Raphael},Be=function(){this.ca=this.customAttributes={}},A3,BN="appendChild",Bf="apply",Bd="concat",z="createTouch" in AZ.doc,Aw="",Ap=" ",Bg=String,f="split",s="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[f](Ap),BW={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},Bj=Bg.prototype.toLowerCase,AT=Math,J=AT.max,BL=AT.min,AV=AT.abs,BO=AT.pow,Au=AT.PI,Ak="number",AJ="string",BC="array",A4="toString",A8="fill",A0=Object.prototype.toString,BY={},G="push",D=Aq._ISURL=/^url\(['"]?([^\)]+?)['"]?\)$/i,Z=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,AU={"NaN":1,"Infinity":1,"-Infinity":1},B=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,AH=AT.round,Y="setAttribute",AN=parseFloat,u=parseInt,BS=Bg.prototype.toUpperCase,O=Aq._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0},AR=Aq._availableAnimAttrs={blur:Ak,"clip-rect":"csv",cx:Ak,cy:Ak,fill:"colour","fill-opacity":Ak,"font-size":Ak,height:Ak,opacity:Ak,path:"path",r:Ak,rx:Ak,ry:Ak,stroke:"colour","stroke-opacity":Ak,"stroke-width":Ak,transform:"transform",width:Ak,x:Ak,y:Ak},AC=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]/g,BH=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,K={hs:1,rg:1},BF=/,?([achlmqrstvxz]),?/gi,Az=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,AI=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,Ao=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/ig,Av=Aq._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,At={},BP=function(R,E){return R.key-E.key},T=function(R,E){return AN(R)-AN(E)},k=function(){},Ba=function(E){return E},AY=Aq._rectPath=function(E,d,R,S,b){if(b){return[["M",E+b,d],["l",R-b*2,0],["a",b,b,0,0,1,b,b],["l",0,S-b*2],["a",b,b,0,0,1,-b,b],["l",b*2-R,0],["a",b,b,0,0,1,-b,-b],["l",0,b*2-S],["a",b,b,0,0,1,b,-b],["z"]]}return[["M",E,d],["l",R,0],["l",0,S],["l",-R,0],["z"]]},m=function(E,b,S,R){if(R==null){R=S}return[["M",E,b],["m",0,-R],["a",S,R,0,1,1,0,2*R],["a",S,R,0,1,1,0,-2*R],["z"]]},p=Aq._getPath={path:function(E){return E.attr("path")},circle:function(R){var E=R.attrs;return m(E.cx,E.cy,E.r)},ellipse:function(R){var E=R.attrs;return m(E.cx,E.cy,E.rx,E.ry)},rect:function(R){var E=R.attrs;return AY(E.x,E.y,E.width,E.height,E.r)},image:function(R){var E=R.attrs;return AY(E.x,E.y,E.width,E.height)},text:function(E){var R=E._getBBox();return AY(R.x,R.y,R.width,R.height)}},n=Aq.mapPath=function(Bm,g){if(!g){return Bm}var Bk,d,S,E,Bl,b,R;Bm=w(Bm);for(S=0,Bl=Bm.length;S<Bl;S++){R=Bm[S];for(E=1,b=R.length;E<b;E+=2){Bk=g.x(R[E],R[E+1]);d=g.y(R[E],R[E+1]);R[E]=Bk;R[E+1]=d}}return Bm};Aq._g=AZ;Aq.type=(AZ.win.SVGAngle||AZ.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML");if(Aq.type=="VML"){var Ad=AZ.doc.createElement("div"),Ag;Ad.innerHTML='<v:shape adj="1"/>';Ag=Ad.firstChild;Ag.style.behavior="url(#default#VML)";if(!(Ag&&typeof Ag.adj=="object")){return(Aq.type=Aw)}Ad=null}Aq.svg=!(Aq.vml=Aq.type=="VML");Aq._Paper=Be;Aq.fn=A3=Be.prototype=Aq.prototype;Aq._id=0;Aq._oid=0;Aq.is=function(R,E){E=Bj.call(E);if(E=="finite"){return !AU[AK](+R)}if(E=="array"){return R instanceof Array}return(E=="null"&&R===null)||(E==typeof R&&R!==null)||(E=="object"&&R===Object(R))||(E=="array"&&Array.isArray&&Array.isArray(R))||A0.call(R).slice(8,-1).toLowerCase()==E};function x(S){if(Object(S)!==S){return S}var R=new S.constructor;for(var E in S){if(S[AK](E)){R[E]=x(S[E])}}return R}Aq.angle=function(d,i,S,g,R,b){if(R==null){var E=d-S,Bk=i-g;if(!E&&!Bk){return 0}return(180+AT.atan2(-Bk,-E)*180/Au+360)%360}else{return Aq.angle(d,i,R,b)-Aq.angle(S,g,R,b)}};Aq.rad=function(E){return E%360*Au/180};Aq.deg=function(E){return E*180/Au%360};Aq.snapTo=function(R,b,E){E=Aq.is(E,"finite")?E:10;if(Aq.is(R,BC)){var S=R.length;while(S--){if(AV(R[S]-b)<=E){return R[S]}}}else{R=+R;var d=b%R;if(d<E){return b-d}if(d>R-E){return b-d+R}}return b};var F=Aq.createUUID=(function(E,R){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(E,R).toUpperCase()}})(/[xy]/g,function(S){var R=AT.random()*16|0,E=S=="x"?R:(R&3|8);return E.toString(16)});Aq.setWindow=function(E){eve("raphael.setWindow",Aq,AZ.win,E);AZ.win=E;AZ.doc=AZ.win.document;if(Aq._engine.initWin){Aq._engine.initWin(AZ.win)}};var BE=function(S){if(Aq.vml){var E=/^\s+|\s+$/g;var d;try{var g=new ActiveXObject("htmlfile");g.write("<body>");g.close();d=g.body}catch(Bk){d=createPopup().document.body}var R=d.createTextRange();BE=Af(function(i){try{d.style.color=Bg(i).replace(E,Aw);var Bl=R.queryCommandValue("ForeColor");Bl=((Bl&255)<<16)|(Bl&65280)|((Bl&16711680)>>>16);return"#"+("000000"+Bl.toString(16)).slice(-6)}catch(Bm){return"none"}})}else{var b=AZ.doc.createElement("i");b.title="Rapha\xebl Colour Picker";b.style.display="none";AZ.doc.body.appendChild(b);BE=Af(function(i){b.style.color=i;return AZ.doc.defaultView.getComputedStyle(b,Aw).getPropertyValue("color")})}return BE(S)},Ah=function(){return"hsb("+[this.h,this.s,this.b]+")"},o=function(){return"hsl("+[this.h,this.s,this.l]+")"},W=function(){return this.hex},Ax=function(d,S,E){if(S==null&&Aq.is(d,"object")&&"r" in d&&"g" in d&&"b" in d){E=d.b;S=d.g;d=d.r}if(S==null&&Aq.is(d,AJ)){var R=Aq.getRGB(d);d=R.r;S=R.g;E=R.b}if(d>1||S>1||E>1){d/=255;S/=255;E/=255}return[d,S,E]},A1=function(d,S,E,i){d*=255;S*=255;E*=255;var R={r:d,g:S,b:E,hex:Aq.rgb(d,S,E),toString:W};Aq.is(i,"finite")&&(R.opacity=i);return R};Aq.color=function(E){var R;if(Aq.is(E,"object")&&"h" in E&&"s" in E&&"b" in E){R=Aq.hsb2rgb(E);E.r=R.r;E.g=R.g;E.b=R.b;E.hex=R.hex}else{if(Aq.is(E,"object")&&"h" in E&&"s" in E&&"l" in E){R=Aq.hsl2rgb(E);E.r=R.r;E.g=R.g;E.b=R.b;E.hex=R.hex}else{if(Aq.is(E,"string")){E=Aq.getRGB(E)}if(Aq.is(E,"object")&&"r" in E&&"g" in E&&"b" in E){R=Aq.rgb2hsl(E);E.h=R.h;E.s=R.s;E.l=R.l;R=Aq.rgb2hsb(E);E.v=R.b}else{E={hex:"none"};E.r=E.g=E.b=E.h=E.s=E.v=E.l=-1}}}E.toString=W;return E};Aq.hsb2rgb=function(i,Bm,Bk,d){if(this.is(i,"object")&&"h" in i&&"s" in i&&"b" in i){Bk=i.b;Bm=i.s;i=i.h;d=i.o}i*=360;var g,Bl,S,b,E;i=(i%360)/60;E=Bk*Bm;b=E*(1-AV(i%2-1));g=Bl=S=Bk-E;i=~~i;g+=[E,b,0,0,b,E][i];Bl+=[b,E,E,b,0,0][i];S+=[0,0,b,E,E,b][i];return A1(g,Bl,S,d)};Aq.hsl2rgb=function(Bk,Bm,g,d){if(this.is(Bk,"object")&&"h" in Bk&&"s" in Bk&&"l" in Bk){g=Bk.l;Bm=Bk.s;Bk=Bk.h}if(Bk>1||Bm>1||g>1){Bk/=360;Bm/=100;g/=100}Bk*=360;var i,Bl,S,b,E;Bk=(Bk%360)/60;E=2*Bm*(g<0.5?g:1-g);b=E*(1-AV(Bk%2-1));i=Bl=S=g-E/2;Bk=~~Bk;i+=[E,b,0,0,b,E][Bk];Bl+=[b,E,E,b,0,0][Bk];S+=[0,0,b,E,E,b][Bk];return A1(i,Bl,S,d)};Aq.rgb2hsb=function(Bl,Bk,E){E=Ax(Bl,Bk,E);Bl=E[0];Bk=E[1];E=E[2];var i,d,R,Bm;R=J(Bl,Bk,E);Bm=R-BL(Bl,Bk,E);i=(Bm==0?null:R==Bl?(Bk-E)/Bm:R==Bk?(E-Bl)/Bm+2:(Bl-Bk)/Bm+4);i=((i+360)%6)*60/360;d=Bm==0?0:Bm/R;return{h:i,s:d,b:R,toString:Ah}};Aq.rgb2hsl=function(E,Bk,Bn){Bn=Ax(E,Bk,Bn);E=Bn[0];Bk=Bn[1];Bn=Bn[2];var Bo,i,Bm,Bl,d,R;Bl=J(E,Bk,Bn);d=BL(E,Bk,Bn);R=Bl-d;Bo=(R==0?null:Bl==E?(Bk-Bn)/R:Bl==Bk?(Bn-E)/R+2:(E-Bk)/R+4);Bo=((Bo+360)%6)*60/360;Bm=(Bl+d)/2;i=(R==0?0:Bm<0.5?R/(2*Bm):R/(2-2*Bm));return{h:Bo,s:i,l:Bm,toString:o}};Aq._path2string=function(){return this.join(",").replace(BF,"$1")};function BJ(b,S){for(var E=0,R=b.length;E<R;E++){if(b[E]===S){return b.push(b.splice(E,1)[0])}}}function Af(b,R,E){function S(){var d=Array.prototype.slice.call(arguments,0),i=d.join("\u2400"),g=S.cache=S.cache||{},Bk=S.count=S.count||[];if(g[AK](i)){BJ(Bk,i);return E?E(g[i]):g[i]}Bk.length>=1000&&delete g[Bk.shift()];Bk.push(i);g[i]=b[Bf](R,d);return E?E(g[i]):g[i]}return S}var BU=Aq._preload=function(S,R){var E=AZ.doc.createElement("img");E.style.cssText="position:absolute;left:-9999em;top:-9999em";E.onload=function(){R.call(this);this.onload=null;AZ.doc.body.removeChild(this)};E.onerror=function(){AZ.doc.body.removeChild(this)};AZ.doc.body.appendChild(E);E.src=S};function AQ(){return this.hex}Aq.getRGB=Af(function(E){if(!E||!!((E=Bg(E)).indexOf("-")+1)){return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:AQ}}if(E=="none"){return{r:-1,g:-1,b:-1,hex:"none",toString:AQ}}!(K[AK](E.toLowerCase().substring(0,2))||E.charAt()=="#")&&(E=BE(E));var d,R,S,i,b,Bl,Bk,g=E.match(Z);if(g){if(g[2]){i=u(g[2].substring(5),16);S=u(g[2].substring(3,5),16);R=u(g[2].substring(1,3),16)}if(g[3]){i=u((Bl=g[3].charAt(3))+Bl,16);S=u((Bl=g[3].charAt(2))+Bl,16);R=u((Bl=g[3].charAt(1))+Bl,16)}if(g[4]){Bk=g[4][f](BH);R=AN(Bk[0]);Bk[0].slice(-1)=="%"&&(R*=2.55);S=AN(Bk[1]);Bk[1].slice(-1)=="%"&&(S*=2.55);i=AN(Bk[2]);Bk[2].slice(-1)=="%"&&(i*=2.55);g[1].toLowerCase().slice(0,4)=="rgba"&&(b=AN(Bk[3]));Bk[3]&&Bk[3].slice(-1)=="%"&&(b/=100)}if(g[5]){Bk=g[5][f](BH);R=AN(Bk[0]);Bk[0].slice(-1)=="%"&&(R*=2.55);S=AN(Bk[1]);Bk[1].slice(-1)=="%"&&(S*=2.55);i=AN(Bk[2]);Bk[2].slice(-1)=="%"&&(i*=2.55);(Bk[0].slice(-3)=="deg"||Bk[0].slice(-1)=="\xb0")&&(R/=360);g[1].toLowerCase().slice(0,4)=="hsba"&&(b=AN(Bk[3]));Bk[3]&&Bk[3].slice(-1)=="%"&&(b/=100);return Aq.hsb2rgb(R,S,i,b)}if(g[6]){Bk=g[6][f](BH);R=AN(Bk[0]);Bk[0].slice(-1)=="%"&&(R*=2.55);S=AN(Bk[1]);Bk[1].slice(-1)=="%"&&(S*=2.55);i=AN(Bk[2]);Bk[2].slice(-1)=="%"&&(i*=2.55);(Bk[0].slice(-3)=="deg"||Bk[0].slice(-1)=="\xb0")&&(R/=360);g[1].toLowerCase().slice(0,4)=="hsla"&&(b=AN(Bk[3]));Bk[3]&&Bk[3].slice(-1)=="%"&&(b/=100);return Aq.hsl2rgb(R,S,i,b)}g={r:R,g:S,b:i,toString:AQ};g.hex="#"+(16777216|i|(S<<8)|(R<<16)).toString(16).slice(1);Aq.is(b,"finite")&&(g.opacity=b);return g}return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:AQ}},Aq);Aq.hsb=Af(function(S,R,E){return Aq.hsb2rgb(S,R,E).hex});Aq.hsl=Af(function(S,R,E){return Aq.hsl2rgb(S,R,E).hex});Aq.rgb=Af(function(S,R,E){return"#"+(16777216|E|(R<<8)|(S<<16)).toString(16).slice(1)});Aq.getColor=function(R){var S=this.getColor.start=this.getColor.start||{h:0,s:1,b:R||0.75},E=this.hsb2rgb(S.h,S.s,S.b);S.h+=0.075;if(S.h>1){S.h=0;S.s-=0.2;S.s<=0&&(this.getColor.start={h:0,s:1,b:S.b})}return E.hex};Aq.getColor.reset=function(){delete this.start};function BA(S,Bk){var g=[];for(var R=0,E=S.length;E-2*!Bk>R;R+=2){var b=[{x:+S[R-2],y:+S[R-1]},{x:+S[R],y:+S[R+1]},{x:+S[R+2],y:+S[R+3]},{x:+S[R+4],y:+S[R+5]}];if(Bk){if(!R){b[0]={x:+S[E-2],y:+S[E-1]}}else{if(E-4==R){b[3]={x:+S[0],y:+S[1]}}else{if(E-2==R){b[2]={x:+S[0],y:+S[1]};b[3]={x:+S[2],y:+S[3]}}}}}else{if(E-4==R){b[3]=b[2]}else{if(!R){b[0]={x:+S[R],y:+S[R+1]}}}}g.push(["C",(-b[0].x+6*b[1].x+b[2].x)/6,(-b[0].y+6*b[1].y+b[2].y)/6,(b[1].x+6*b[2].x-b[3].x)/6,(b[1].y+6*b[2].y-b[3].y)/6,b[2].x,b[2].y])}return g}Aq.parsePathString=function(E){if(!E){return null}var S=y(E);if(S.arr){return Ay(S.arr)}var b={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},R=[];if(Aq.is(E,BC)&&Aq.is(E[0],BC)){R=Ay(E)}if(!R.length){Bg(E).replace(Az,function(g,d,Bl){var Bk=[],i=d.toLowerCase();Bl.replace(Ao,function(Bn,Bm){Bm&&Bk.push(+Bm)});if(i=="m"&&Bk.length>2){R.push([d][Bd](Bk.splice(0,2)));i="l";d=d=="m"?"l":"L"}if(i=="r"){R.push([d][Bd](Bk))}else{while(Bk.length>=b[i]){R.push([d][Bd](Bk.splice(0,b[i])));if(!b[i]){break}}}})}R.toString=Aq._path2string;S.arr=Ay(R);return R};Aq.parseTransformString=Af(function(R){if(!R){return null}var S={r:3,s:4,t:2,m:6},E=[];if(Aq.is(R,BC)&&Aq.is(R[0],BC)){E=Ay(R)}if(!E.length){Bg(R).replace(AI,function(g,d,Bl){var Bk=[],i=Bj.call(d);Bl.replace(Ao,function(Bn,Bm){Bm&&Bk.push(+Bm)});E.push([d][Bd](Bk))})}E.toString=Aq._path2string;return E});var y=function(R){var E=y.ps=y.ps||{};if(E[R]){E[R].sleep=100}else{E[R]={sleep:100}}setTimeout(function(){for(var S in E){if(E[AK](S)&&S!=R){E[S].sleep--;!E[S].sleep&&delete E[S]}}});return E[R]};Aq.findDotsAtSegment=function(R,E,B1,Bz,i,d,Bm,Bk,Bu){var Br=1-Bu,Bw=BO(Br,3),Bx=BO(Br,2),Bo=Bu*Bu,Bl=Bo*Bu,Bq=Bw*R+Bx*3*Bu*B1+Br*3*Bu*Bu*i+Bl*Bm,Bn=Bw*E+Bx*3*Bu*Bz+Br*3*Bu*Bu*d+Bl*Bk,Bv=R+2*Bu*(B1-R)+Bo*(i-2*B1+R),Bt=E+2*Bu*(Bz-E)+Bo*(d-2*Bz+E),B0=B1+2*Bu*(i-B1)+Bo*(Bm-2*i+B1),By=Bz+2*Bu*(d-Bz)+Bo*(Bk-2*d+Bz),Bs=Br*R+Bu*B1,Bp=Br*E+Bu*Bz,b=Br*i+Bu*Bm,S=Br*d+Bu*Bk,g=(90-AT.atan2(Bv-B0,Bt-By)*180/Au);(Bv>B0||Bt<By)&&(g+=180);return{x:Bq,y:Bn,m:{x:Bv,y:Bt},n:{x:B0,y:By},start:{x:Bs,y:Bp},end:{x:b,y:S},alpha:g}};Aq.bezierBBox=function(R,E,b,S,Bl,i,g,d){if(!Aq.is(R,"array")){R=[R,E,b,S,Bl,i,g,d]}var Bk=A9.apply(null,R);return{x:Bk.min.x,y:Bk.min.y,x2:Bk.max.x,y2:Bk.max.y,width:Bk.max.x-Bk.min.x,height:Bk.max.y-Bk.min.y}};Aq.isPointInsideBBox=function(R,E,S){return E>=R.x&&E<=R.x2&&S>=R.y&&S<=R.y2};Aq.isBBoxIntersect=function(S,R){var E=Aq.isPointInsideBBox;return E(R,S.x,S.y)||E(R,S.x2,S.y)||E(R,S.x,S.y2)||E(R,S.x2,S.y2)||E(S,R.x,R.y)||E(S,R.x2,R.y)||E(S,R.x,R.y2)||E(S,R.x2,R.y2)||(S.x<R.x2&&S.x>R.x||R.x<S.x2&&R.x>S.x)&&(S.y<R.y2&&S.y>R.y||R.y<S.y2&&R.y>S.y)};function BI(E,i,g,d,b){var S=-3*i+9*g-9*d+3*b,R=E*S+6*i-12*g+6*d;return E*R-3*i+3*g}function N(Bv,d,Bu,S,Bt,R,Bq,E,Bn){if(Bn==null){Bn=1}Bn=Bn>1?1:Bn<0?0:Bn;var Bo=Bn/2,Bp=12,Bk=[-0.1252,0.1252,-0.3678,0.3678,-0.5873,0.5873,-0.7699,0.7699,-0.9041,0.9041,-0.9816,0.9816],Bs=[0.2491,0.2491,0.2335,0.2335,0.2032,0.2032,0.1601,0.1601,0.1069,0.1069,0.0472,0.0472],b=0;for(var Br=0;Br<Bp;Br++){var Bl=Bo*Bk[Br]+Bo,Bm=BI(Bl,Bv,Bu,Bt,Bq),Bw=BI(Bl,d,S,R,E),g=Bm*Bm+Bw*Bw;b+=Bs[Br]*AT.sqrt(g)}return Bo*b}function c(S,Bo,R,Bn,E,Bl,Bq,Bk,Bm){if(Bm<0||N(S,Bo,R,Bn,E,Bl,Bq,Bk)<Bm){return }var Bp=1,b=Bp/2,g=Bp-b,d,i=0.01;d=N(S,Bo,R,Bn,E,Bl,Bq,Bk,g);while(AV(d-Bm)>i){b/=2;g+=(d<Bm?1:-1)*b;d=N(S,Bo,R,Bn,E,Bl,Bq,Bk,g)}return g}function q(b,Bp,S,Bn,E,Bm,Br,Bl){if(J(b,S)<BL(E,Br)||BL(b,S)>J(E,Br)||J(Bp,Bn)<BL(Bm,Bl)||BL(Bp,Bn)>J(Bm,Bl)){return }var Bk=(b*Bn-Bp*S)*(E-Br)-(b-S)*(E*Bl-Bm*Br),i=(b*Bn-Bp*S)*(Bm-Bl)-(Bp-Bn)*(E*Bl-Bm*Br),d=(b-S)*(Bm-Bl)-(Bp-Bn)*(E-Br);if(!d){return }var Bq=Bk/d,Bo=i/d,g=+Bq.toFixed(2),R=+Bo.toFixed(2);if(g<+BL(b,S).toFixed(2)||g>+J(b,S).toFixed(2)||g<+BL(E,Br).toFixed(2)||g>+J(E,Br).toFixed(2)||R<+BL(Bp,Bn).toFixed(2)||R>+J(Bp,Bn).toFixed(2)||R<+BL(Bm,Bl).toFixed(2)||R>+J(Bm,Bl).toFixed(2)){return }return{x:Bq,y:Bo}}function AX(R,E){return AF(R,E)}function Q(R,E){return AF(R,E,1)}function AF(B1,B0,Bz){var b=Aq.bezierBBox(B1),R=Aq.bezierBBox(B0);if(!Aq.isBBoxIntersect(b,R)){return Bz?0:[]}var Bu=N.apply(0,B1),Bt=N.apply(0,B0),Bl=~~(Bu/5),Bk=~~(Bt/5),Br=[],Bq=[],S={},B2=Bz?0:[];for(var Bw=0;Bw<Bl+1;Bw++){var Bs=Aq.findDotsAtSegment.apply(Aq,B1.concat(Bw/Bl));Br.push({x:Bs.x,y:Bs.y,t:Bw/Bl})}for(Bw=0;Bw<Bk+1;Bw++){Bs=Aq.findDotsAtSegment.apply(Aq,B0.concat(Bw/Bk));Bq.push({x:Bs.x,y:Bs.y,t:Bw/Bk})}for(Bw=0;Bw<Bl;Bw++){for(var Bv=0;Bv<Bk;Bv++){var By=Br[Bw],E=Br[Bw+1],Bx=Bq[Bv],g=Bq[Bv+1],Bp=AV(E.x-By.x)<0.001?"y":"x",Bo=AV(g.x-Bx.x)<0.001?"y":"x",d=q(By.x,By.y,E.x,E.y,Bx.x,Bx.y,g.x,g.y);if(d){if(S[d.x.toFixed(4)]==d.y.toFixed(4)){continue}S[d.x.toFixed(4)]=d.y.toFixed(4);var Bn=By.t+AV((d[Bp]-By[Bp])/(E[Bp]-By[Bp]))*(E.t-By.t),Bm=Bx.t+AV((d[Bo]-Bx[Bo])/(g[Bo]-Bx[Bo]))*(g.t-Bx.t);if(Bn>=0&&Bn<=1&&Bm>=0&&Bm<=1){if(Bz){B2++}else{B2.push({x:d.x,y:d.y,t1:Bn,t2:Bm})}}}}}return B2}Aq.pathIntersection=function(R,E){return e(R,E)};Aq.pathIntersectionNumber=function(R,E){return e(R,E,1)};function e(S,E,Bv){S=Aq._path2curve(S);E=Aq._path2curve(E);var Bt,g,Bs,b,Bq,Bk,R,Bn,Bz,By,B0=Bv?0:[];for(var Br=0,Bl=S.length;Br<Bl;Br++){var Bx=S[Br];if(Bx[0]=="M"){Bt=Bq=Bx[1];g=Bk=Bx[2]}else{if(Bx[0]=="C"){Bz=[Bt,g].concat(Bx.slice(1));Bt=Bz[6];g=Bz[7]}else{Bz=[Bt,g,Bt,g,Bq,Bk,Bq,Bk];Bt=Bq;g=Bk}for(var Bp=0,Bu=E.length;Bp<Bu;Bp++){var Bw=E[Bp];if(Bw[0]=="M"){Bs=R=Bw[1];b=Bn=Bw[2]}else{if(Bw[0]=="C"){By=[Bs,b].concat(Bw.slice(1));Bs=By[6];b=By[7]}else{By=[Bs,b,Bs,b,R,Bn,R,Bn];Bs=R;b=Bn}var Bm=AF(Bz,By,Bv);if(Bv){B0+=Bm}else{for(var Bo=0,d=Bm.length;Bo<d;Bo++){Bm[Bo].segment1=Br;Bm[Bo].segment2=Bp;Bm[Bo].bez1=Bz;Bm[Bo].bez2=By}B0=B0.concat(Bm)}}}}}return B0}Aq.isPointInsidePath=function(R,E,b){var S=Aq.pathBBox(R);return Aq.isPointInsideBBox(S,E,b)&&e(R,[["M",E,b],["H",S.x2+10]],1)%2==1};Aq._removedFactory=function(E){return function(){eve("raphael.log",null,"Rapha\xebl: you are calling to method \u201c"+E+"\u201d of removed object",E)}};var AM=Aq.pathBBox=function(Bs){var Bm=y(Bs);if(Bm.bbox){return Bm.bbox}if(!Bs){return{x:0,y:0,width:0,height:0,x2:0,y2:0}}Bs=w(Bs);var Bp=0,Bo=0,d=[],R=[],S;for(var Bk=0,Br=Bs.length;Bk<Br;Bk++){S=Bs[Bk];if(S[0]=="M"){Bp=S[1];Bo=S[2];d.push(Bp);R.push(Bo)}else{var Bl=A9(Bp,Bo,S[1],S[2],S[3],S[4],S[5],S[6]);d=d[Bd](Bl.min.x,Bl.max.x);R=R[Bd](Bl.min.y,Bl.max.y);Bp=S[5];Bo=S[6]}}var E=BL[Bf](0,d),Bq=BL[Bf](0,R),g=J[Bf](0,d),b=J[Bf](0,R),Bn={x:E,y:Bq,x2:g,y2:b,width:g-E,height:b-Bq};Bm.bbox=x(Bn);return Bn},Ay=function(R){var E=x(R);E.toString=Aq._path2string;return E},Ab=Aq._pathToRelative=function(b){var Bl=y(b);if(Bl.rel){return Ay(Bl.rel)}if(!Aq.is(b,BC)||!Aq.is(b&&b[0],BC)){b=Aq.parsePathString(b)}var Bo=[],Bq=0,Bp=0,Bt=0,Bs=0,S=0;if(b[0][0]=="M"){Bq=b[0][1];Bp=b[0][2];Bt=Bq;Bs=Bp;S++;Bo.push(["M",Bq,Bp])}for(var Bk=S,Bu=b.length;Bk<Bu;Bk++){var E=Bo[Bk]=[],Br=b[Bk];if(Br[0]!=Bj.call(Br[0])){E[0]=Bj.call(Br[0]);switch(E[0]){case"a":E[1]=Br[1];E[2]=Br[2];E[3]=Br[3];E[4]=Br[4];E[5]=Br[5];E[6]=+(Br[6]-Bq).toFixed(3);E[7]=+(Br[7]-Bp).toFixed(3);break;case"v":E[1]=+(Br[1]-Bp).toFixed(3);break;case"m":Bt=Br[1];Bs=Br[2];default:for(var g=1,Bm=Br.length;g<Bm;g++){E[g]=+(Br[g]-((g%2)?Bq:Bp)).toFixed(3)}}}else{E=Bo[Bk]=[];if(Br[0]=="m"){Bt=Br[1]+Bq;Bs=Br[2]+Bp}for(var d=0,R=Br.length;d<R;d++){Bo[Bk][d]=Br[d]}}var Bn=Bo[Bk].length;switch(Bo[Bk][0]){case"z":Bq=Bt;Bp=Bs;break;case"h":Bq+=+Bo[Bk][Bn-1];break;case"v":Bp+=+Bo[Bk][Bn-1];break;default:Bq+=+Bo[Bk][Bn-2];Bp+=+Bo[Bk][Bn-1]}}Bo.toString=Aq._path2string;Bl.rel=Ay(Bo);return Bo},V=Aq._pathToAbsolute=function(Bp){var S=y(Bp);if(S.abs){return Ay(S.abs)}if(!Aq.is(Bp,BC)||!Aq.is(Bp&&Bp[0],BC)){Bp=Aq.parsePathString(Bp)}if(!Bp||!Bp.length){return[["M",0,0]]}var Bv=[],Bk=0,g=0,Bn=0,Bm=0,b=0;if(Bp[0][0]=="M"){Bk=+Bp[0][1];g=+Bp[0][2];Bn=Bk;Bm=g;b++;Bv[0]=["M",Bk,g]}var Bu=Bp.length==3&&Bp[0][0]=="M"&&Bp[1][0].toUpperCase()=="R"&&Bp[2][0].toUpperCase()=="Z";for(var Bo,E,Bs=b,Bl=Bp.length;Bs<Bl;Bs++){Bv.push(Bo=[]);E=Bp[Bs];if(E[0]!=BS.call(E[0])){Bo[0]=BS.call(E[0]);switch(Bo[0]){case"A":Bo[1]=E[1];Bo[2]=E[2];Bo[3]=E[3];Bo[4]=E[4];Bo[5]=E[5];Bo[6]=+(E[6]+Bk);Bo[7]=+(E[7]+g);break;case"V":Bo[1]=+E[1]+g;break;case"H":Bo[1]=+E[1]+Bk;break;case"R":var d=[Bk,g][Bd](E.slice(1));for(var Br=2,Bt=d.length;Br<Bt;Br++){d[Br]=+d[Br]+Bk;d[++Br]=+d[Br]+g}Bv.pop();Bv=Bv[Bd](BA(d,Bu));break;case"M":Bn=+E[1]+Bk;Bm=+E[2]+g;default:for(Br=1,Bt=E.length;Br<Bt;Br++){Bo[Br]=+E[Br]+((Br%2)?Bk:g)}}}else{if(E[0]=="R"){d=[Bk,g][Bd](E.slice(1));Bv.pop();Bv=Bv[Bd](BA(d,Bu));Bo=["R"][Bd](E.slice(-2))}else{for(var Bq=0,R=E.length;Bq<R;Bq++){Bo[Bq]=E[Bq]}}}switch(Bo[0]){case"Z":Bk=Bn;g=Bm;break;case"H":Bk=Bo[1];break;case"V":g=Bo[1];break;case"M":Bn=Bo[Bo.length-2];Bm=Bo[Bo.length-1];default:Bk=Bo[Bo.length-2];g=Bo[Bo.length-1]}}Bv.toString=Aq._path2string;S.abs=Ay(Bv);return Bv},Bh=function(R,b,E,S){return[R,b,E,S,E,S]},BM=function(R,b,i,d,E,S){var g=1/3,Bk=2/3;return[g*R+Bk*i,g*b+Bk*d,g*E+Bk*i,g*S+Bk*d,E,S]},AE=function(Br,CM,B0,By,Bs,Bm,b,Bq,CL,Bt){var Bx=Au*120/180,E=Au/180*(+Bs||0),B4=[],B1,CI=Af(function(CN,CQ,i){var CP=CN*AT.cos(i)-CQ*AT.sin(i),CO=CN*AT.sin(i)+CQ*AT.cos(i);return{x:CP,y:CO}});if(!Bt){B1=CI(Br,CM,-E);Br=B1.x;CM=B1.y;B1=CI(Bq,CL,-E);Bq=B1.x;CL=B1.y;var R=AT.cos(Au/180*Bs),Bo=AT.sin(Au/180*Bs),B6=(Br-Bq)/2,B5=(CM-CL)/2;var CG=(B6*B6)/(B0*B0)+(B5*B5)/(By*By);if(CG>1){CG=AT.sqrt(CG);B0=CG*B0;By=CG*By}var S=B0*B0,B9=By*By,CB=(Bm==b?-1:1)*AT.sqrt(AV((S*B9-S*B5*B5-B9*B6*B6)/(S*B5*B5+B9*B6*B6))),Bv=CB*B0*B5/By+(Br+Bq)/2,Bu=CB*-By*B6/B0+(CM+CL)/2,Bl=AT.asin(((CM-Bu)/By).toFixed(9)),Bk=AT.asin(((CL-Bu)/By).toFixed(9));Bl=Br<Bv?Au-Bl:Bl;Bk=Bq<Bv?Au-Bk:Bk;Bl<0&&(Bl=Au*2+Bl);Bk<0&&(Bk=Au*2+Bk);if(b&&Bl>Bk){Bl=Bl-Au*2}if(!b&&Bk>Bl){Bk=Bk-Au*2}}else{Bl=Bt[0];Bk=Bt[1];Bv=Bt[2];Bu=Bt[3]}var Bp=Bk-Bl;if(AV(Bp)>Bx){var Bw=Bk,Bz=Bq,Bn=CL;Bk=Bl+Bx*(b&&Bk>Bl?1:-1);Bq=Bv+B0*AT.cos(Bk);CL=Bu+By*AT.sin(Bk);B4=AE(Bq,CL,B0,By,Bs,0,b,Bz,Bn,[Bk,Bw,Bv,Bu])}Bp=Bk-Bl;var g=AT.cos(Bl),CK=AT.sin(Bl),d=AT.cos(Bk),CJ=AT.sin(Bk),B7=AT.tan(Bp/4),CA=4/3*B0*B7,B8=4/3*By*B7,CH=[Br,CM],CF=[Br+CA*CK,CM-B8*g],CE=[Bq+CA*CJ,CL-B8*d],CC=[Bq,CL];CF[0]=2*CH[0]-CF[0];CF[1]=2*CH[1]-CF[1];if(Bt){return[CF,CE,CC][Bd](B4)}else{B4=[CF,CE,CC][Bd](B4).join()[f](",");var B2=[];for(var CD=0,B3=B4.length;CD<B3;CD++){B2[CD]=CD%2?CI(B4[CD-1],B4[CD],E).y:CI(B4[CD],B4[CD+1],E).x}return B2}},AG=function(R,E,b,S,Bl,Bk,i,g,Bm){var d=1-Bm;return{x:BO(d,3)*R+BO(d,2)*3*Bm*b+d*3*Bm*Bm*Bl+BO(Bm,3)*i,y:BO(d,3)*E+BO(d,2)*3*Bm*S+d*3*Bm*Bm*Bk+BO(Bm,3)*g}},A9=Af(function(S,E,g,d,Bt,Bs,Bp,Bm){var Br=(Bt-2*g+S)-(Bp-2*Bt+g),Bo=2*(g-S)-2*(Bt-g),Bl=S-g,Bk=(-Bo+AT.sqrt(Bo*Bo-4*Br*Bl))/2/Br,i=(-Bo-AT.sqrt(Bo*Bo-4*Br*Bl))/2/Br,Bn=[E,Bm],Bq=[S,Bp],R;AV(Bk)>"1e12"&&(Bk=0.5);AV(i)>"1e12"&&(i=0.5);if(Bk>0&&Bk<1){R=AG(S,E,g,d,Bt,Bs,Bp,Bm,Bk);Bq.push(R.x);Bn.push(R.y)}if(i>0&&i<1){R=AG(S,E,g,d,Bt,Bs,Bp,Bm,i);Bq.push(R.x);Bn.push(R.y)}Br=(Bs-2*d+E)-(Bm-2*Bs+d);Bo=2*(d-E)-2*(Bs-d);Bl=E-d;Bk=(-Bo+AT.sqrt(Bo*Bo-4*Br*Bl))/2/Br;i=(-Bo-AT.sqrt(Bo*Bo-4*Br*Bl))/2/Br;AV(Bk)>"1e12"&&(Bk=0.5);AV(i)>"1e12"&&(i=0.5);if(Bk>0&&Bk<1){R=AG(S,E,g,d,Bt,Bs,Bp,Bm,Bk);Bq.push(R.x);Bn.push(R.y)}if(i>0&&i<1){R=AG(S,E,g,d,Bt,Bs,Bp,Bm,i);Bq.push(R.x);Bn.push(R.y)}return{min:{x:BL[Bf](0,Bq),y:BL[Bf](0,Bn)},max:{x:J[Bf](0,Bq),y:J[Bf](0,Bn)}}}),w=Aq._path2curve=Af(function(Bt,Bo){var Bm=!Bo&&y(Bt);if(!Bo&&Bm.curve){return Ay(Bm.curve)}var b=V(Bt),Bp=Bo&&V(Bo),Bq={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},R={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},g=function(Bu,Bv){var i,Bw;if(!Bu){return["C",Bv.x,Bv.y,Bv.x,Bv.y,Bv.x,Bv.y]}!(Bu[0] in {T:1,Q:1})&&(Bv.qx=Bv.qy=null);switch(Bu[0]){case"M":Bv.X=Bu[1];Bv.Y=Bu[2];break;case"A":Bu=["C"][Bd](AE[Bf](0,[Bv.x,Bv.y][Bd](Bu.slice(1))));break;case"S":i=Bv.x+(Bv.x-(Bv.bx||Bv.x));Bw=Bv.y+(Bv.y-(Bv.by||Bv.y));Bu=["C",i,Bw][Bd](Bu.slice(1));break;case"T":Bv.qx=Bv.x+(Bv.x-(Bv.qx||Bv.x));Bv.qy=Bv.y+(Bv.y-(Bv.qy||Bv.y));Bu=["C"][Bd](BM(Bv.x,Bv.y,Bv.qx,Bv.qy,Bu[1],Bu[2]));break;case"Q":Bv.qx=Bu[1];Bv.qy=Bu[2];Bu=["C"][Bd](BM(Bv.x,Bv.y,Bu[1],Bu[2],Bu[3],Bu[4]));break;case"L":Bu=["C"][Bd](Bh(Bv.x,Bv.y,Bu[1],Bu[2]));break;case"H":Bu=["C"][Bd](Bh(Bv.x,Bv.y,Bu[1],Bv.y));break;case"V":Bu=["C"][Bd](Bh(Bv.x,Bv.y,Bv.x,Bu[1]));break;case"Z":Bu=["C"][Bd](Bh(Bv.x,Bv.y,Bv.X,Bv.Y));break}return Bu},E=function(Bu,Bv){if(Bu[Bv].length>7){Bu[Bv].shift();var Bw=Bu[Bv];while(Bw.length){Bu.splice(Bv++,0,["C"][Bd](Bw.splice(0,6)))}Bu.splice(Bv,1);Br=J(b.length,Bp&&Bp.length||0)}},S=function(By,Bx,Bv,Bu,Bw){if(By&&Bx&&By[Bw][0]=="M"&&Bx[Bw][0]!="M"){Bx.splice(Bw,0,["M",Bu.x,Bu.y]);Bv.bx=0;Bv.by=0;Bv.x=By[Bw][1];Bv.y=By[Bw][2];Br=J(b.length,Bp&&Bp.length||0)}};for(var Bl=0,Br=J(b.length,Bp&&Bp.length||0);Bl<Br;Bl++){b[Bl]=g(b[Bl],Bq);E(b,Bl);Bp&&(Bp[Bl]=g(Bp[Bl],R));Bp&&E(Bp,Bl);S(b,Bp,Bq,R,Bl);S(Bp,b,R,Bq,Bl);var Bk=b[Bl],Bs=Bp&&Bp[Bl],d=Bk.length,Bn=Bp&&Bs.length;Bq.x=Bk[d-2];Bq.y=Bk[d-1];Bq.bx=AN(Bk[d-4])||Bq.x;Bq.by=AN(Bk[d-3])||Bq.y;R.bx=Bp&&(AN(Bs[Bn-4])||R.x);R.by=Bp&&(AN(Bs[Bn-3])||R.y);R.x=Bp&&Bs[Bn-2];R.y=Bp&&Bs[Bn-1]}if(!Bp){Bm.curve=Ay(b)}return Bp?[b,Bp]:b},null,Ay),U=Aq._parseDots=Af(function(Bn){var Bm=[];for(var g=0,Bo=Bn.length;g<Bo;g++){var E={},Bl=Bn[g].match(/^([^:]*):?([\d\.]*)/);E.color=Aq.getRGB(Bl[1]);if(E.color.error){return null}E.color=E.color.hex;Bl[2]&&(E.offset=Bl[2]+"%");Bm.push(E)}for(g=1,Bo=Bm.length-1;g<Bo;g++){if(!Bm[g].offset){var R=AN(Bm[g-1].offset||0),S=0;for(var b=g+1;b<Bo;b++){if(Bm[b].offset){S=Bm[b].offset;break}}if(!S){S=100;b=Bo}S=AN(S);var Bk=(S-R)/(b-g+1);for(;g<b;g++){R+=Bk;Bm[g].offset=R+"%"}}}return Bm}),Aj=Aq._tear=function(E,R){E==R.top&&(R.top=E.prev);E==R.bottom&&(R.bottom=E.next);E.next&&(E.next.prev=E.prev);E.prev&&(E.prev.next=E.next)},AP=Aq._tofront=function(E,R){if(R.top===E){return }Aj(E,R);E.next=null;E.prev=R.top;R.top.next=E;R.top=E},M=Aq._toback=function(E,R){if(R.bottom===E){return }Aj(E,R);E.next=R.bottom;E.prev=null;R.bottom.prev=E;R.bottom=E},h=Aq._insertafter=function(R,E,S){Aj(R,S);E==S.top&&(S.top=R);E.next&&(E.next.prev=R);R.next=E.next;R.prev=E;E.next=R},As=Aq._insertbefore=function(R,E,S){Aj(R,S);E==S.bottom&&(S.bottom=R);E.prev&&(E.prev.next=R);R.prev=E.prev;E.prev=R;R.next=E},BK=Aq.toMatrix=function(S,E){var b=AM(S),R={_:{transform:Aw},getBBox:function(){return b}};An(R,E);return R.matrix},t=Aq.transformPath=function(R,E){return n(R,BK(R,E))},An=Aq._extractTransform=function(R,By){if(By==null){return R._.transform}By=Bg(By).replace(/\.{3}|\u2026/g,R._.transform||Aw);var Bq=Aq.parseTransformString(By),Bo=0,Bm=0,Bl=0,Bs=1,Br=1,Bz=R._,Bt=new Ae;Bz.transform=Bq||[];if(Bq){for(var Bu=0,Bn=Bq.length;Bu<Bn;Bu++){var Bp=Bq[Bu],E=Bp.length,d=Bg(Bp[0]).toLowerCase(),Bx=Bp[0]!=d,Bk=Bx?Bt.invert():0,Bw,b,Bv,S,g;if(d=="t"&&E==3){if(Bx){Bw=Bk.x(0,0);b=Bk.y(0,0);Bv=Bk.x(Bp[1],Bp[2]);S=Bk.y(Bp[1],Bp[2]);Bt.translate(Bv-Bw,S-b)}else{Bt.translate(Bp[1],Bp[2])}}else{if(d=="r"){if(E==2){g=g||R.getBBox(1);Bt.rotate(Bp[1],g.x+g.width/2,g.y+g.height/2);Bo+=Bp[1]}else{if(E==4){if(Bx){Bv=Bk.x(Bp[2],Bp[3]);S=Bk.y(Bp[2],Bp[3]);Bt.rotate(Bp[1],Bv,S)}else{Bt.rotate(Bp[1],Bp[2],Bp[3])}Bo+=Bp[1]}}}else{if(d=="s"){if(E==2||E==3){g=g||R.getBBox(1);Bt.scale(Bp[1],Bp[E-1],g.x+g.width/2,g.y+g.height/2);Bs*=Bp[1];Br*=Bp[E-1]}else{if(E==5){if(Bx){Bv=Bk.x(Bp[3],Bp[4]);S=Bk.y(Bp[3],Bp[4]);Bt.scale(Bp[1],Bp[2],Bv,S)}else{Bt.scale(Bp[1],Bp[2],Bp[3],Bp[4])}Bs*=Bp[1];Br*=Bp[2]}}}else{if(d=="m"&&E==7){Bt.add(Bp[1],Bp[2],Bp[3],Bp[4],Bp[5],Bp[6])}}}}Bz.dirtyT=1;R.matrix=Bt}}R.matrix=Bt;Bz.sx=Bs;Bz.sy=Br;Bz.deg=Bo;Bz.dx=Bm=Bt.e;Bz.dy=Bl=Bt.f;if(Bs==1&&Br==1&&!Bo&&Bz.bbox){Bz.bbox.x+=+Bm;Bz.bbox.y+=+Bl}else{Bz.dirtyT=1}},I=function(R){var E=R[0];switch(E.toLowerCase()){case"t":return[E,0,0];case"m":return[E,1,0,0,1,0,0];case"r":if(R.length==4){return[E,0,R[2],R[3]]}else{return[E,0]}case"s":if(R.length==5){return[E,1,1,R[3],R[4]]}else{if(R.length==3){return[E,1,1]}else{return[E,1]}}}},Aa=Aq._equaliseTransform=function(d,b){b=Bg(b).replace(/\.{3}|\u2026/g,d);d=Aq.parseTransformString(d)||[];b=Aq.parseTransformString(b)||[];var E=J(d.length,b.length),Bm=[],Bn=[],S=0,R,g,Bl,Bk;for(;S<E;S++){Bl=d[S]||I(b[S]);Bk=b[S]||I(Bl);if((Bl[0]!=Bk[0])||(Bl[0].toLowerCase()=="r"&&(Bl[2]!=Bk[2]||Bl[3]!=Bk[3]))||(Bl[0].toLowerCase()=="s"&&(Bl[3]!=Bk[3]||Bl[4]!=Bk[4]))){return }Bm[S]=[];Bn[S]=[];for(R=0,g=J(Bl.length,Bk.length);R<g;R++){R in Bl&&(Bm[S][R]=Bl[R]);R in Bk&&(Bn[S][R]=Bk[R])}}return{from:Bm,to:Bn}};Aq._getContainer=function(E,d,S,b){var R;R=b==null&&!Aq.is(E,"object")?AZ.doc.getElementById(E):E;if(R==null){return }if(R.tagName){if(d==null){return{container:R,width:R.style.pixelWidth||R.offsetWidth,height:R.style.pixelHeight||R.offsetHeight}}else{return{container:R,width:d,height:S}}}return{container:1,x:E,y:d,width:S,height:b}};Aq.pathToRelative=Ab;Aq._engine={};Aq.path2curve=w;Aq.matrix=function(R,E,Bk,i,g,S){return new Ae(R,E,Bk,i,g,S)};function Ae(R,E,Bk,i,g,S){if(R!=null){this.a=+R;this.b=+E;this.c=+Bk;this.d=+i;this.e=+g;this.f=+S}else{this.a=1;this.b=0;this.c=0;this.d=1;this.e=0;this.f=0}}(function(S){S.add=function(Bu,Br,Bp,Bn,Bl,Bk){var i=[[],[],[]],g=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],Bt=[[Bu,Bp,Bl],[Br,Bn,Bk],[0,0,1]],Bs,Bq,Bo,Bm;if(Bu&&Bu instanceof Ae){Bt=[[Bu.a,Bu.c,Bu.e],[Bu.b,Bu.d,Bu.f],[0,0,1]]}for(Bs=0;Bs<3;Bs++){for(Bq=0;Bq<3;Bq++){Bm=0;for(Bo=0;Bo<3;Bo++){Bm+=g[Bs][Bo]*Bt[Bo][Bq]}i[Bs][Bq]=Bm}}this.a=i[0][0];this.b=i[1][0];this.c=i[0][1];this.d=i[1][1];this.e=i[0][2];this.f=i[1][2]};S.invert=function(){var d=this,b=d.a*d.d-d.b*d.c;return new Ae(d.d/b,-d.b/b,-d.c/b,d.a/b,(d.c*d.f-d.d*d.e)/b,(d.b*d.e-d.a*d.f)/b)};S.clone=function(){return new Ae(this.a,this.b,this.c,this.d,this.e,this.f)};S.translate=function(b,d){this.add(1,0,0,1,b,d)};S.scale=function(d,i,b,g){i==null&&(i=d);(b||g)&&this.add(1,0,0,1,b,g);this.add(d,0,0,i,0,0);(b||g)&&this.add(1,0,0,1,-b,-g)};S.rotate=function(d,b,Bk){d=Aq.rad(d);b=b||0;Bk=Bk||0;var i=+AT.cos(d).toFixed(9),g=+AT.sin(d).toFixed(9);this.add(i,g,-g,i,b,Bk);this.add(1,0,0,1,-b,-Bk)};S.x=function(b,d){return b*this.a+d*this.c+this.e};S.y=function(b,d){return b*this.b+d*this.d+this.f};S.get=function(b){return +this[Bg.fromCharCode(97+b)].toFixed(4)};S.toString=function(){return Aq.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()};S.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"};S.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]};function R(b){return b[0]*b[0]+b[1]*b[1]}function E(b){var d=AT.sqrt(R(b));b[0]&&(b[0]/=d);b[1]&&(b[1]/=d)}S.split=function(){var d={};d.dx=this.e;d.dy=this.f;var i=[[this.a,this.c],[this.b,this.d]];d.scalex=AT.sqrt(R(i[0]));E(i[0]);d.shear=i[0][0]*i[1][0]+i[0][1]*i[1][1];i[1]=[i[1][0]-i[0][0]*d.shear,i[1][1]-i[0][1]*d.shear];d.scaley=AT.sqrt(R(i[1]));E(i[1]);d.shear/=d.scaley;var b=-i[0][1],g=i[1][1];if(g<0){d.rotate=Aq.deg(AT.acos(g));if(b<0){d.rotate=360-d.rotate}}else{d.rotate=Aq.deg(AT.asin(b))}d.isSimple=!+d.shear.toFixed(9)&&(d.scalex.toFixed(9)==d.scaley.toFixed(9)||!d.rotate);d.isSuperSimple=!+d.shear.toFixed(9)&&d.scalex.toFixed(9)==d.scaley.toFixed(9)&&!d.rotate;d.noRotation=!+d.shear.toFixed(9)&&!d.rotate;return d};S.toTransformString=function(b){var d=b||this[f]();if(d.isSimple){d.scalex=+d.scalex.toFixed(4);d.scaley=+d.scaley.toFixed(4);d.rotate=+d.rotate.toFixed(4);return(d.dx||d.dy?"t"+[d.dx,d.dy]:Aw)+(d.scalex!=1||d.scaley!=1?"s"+[d.scalex,d.scaley,0,0]:Aw)+(d.rotate?"r"+[d.rotate,0,0]:Aw)}else{return"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}})(Ae.prototype);var v=navigator.userAgent.match(/Version\/(.*?)\s/)||navigator.userAgent.match(/Chrome\/(\d+)/);if((navigator.vendor=="Apple Computer, Inc.")&&(v&&v[1]<4||navigator.platform.slice(0,2)=="iP")||(navigator.vendor=="Google Inc."&&v&&v[1]<8)){A3.safari=function(){var E=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});setTimeout(function(){E.remove()})}}else{A3.safari=k}var r=function(){this.returnValue=false},Bc=function(){return this.originalEvent.preventDefault()},A7=function(){this.cancelBubble=true},Ai=function(){return this.originalEvent.stopPropagation()},Ac=(function(){if(AZ.doc.addEventListener){return function(g,b,S,R){var E=z&&BW[b]?BW[b]:b,d=function(Bp){var Bo=AZ.doc.documentElement.scrollTop||AZ.doc.body.scrollTop,Bq=AZ.doc.documentElement.scrollLeft||AZ.doc.body.scrollLeft,Bk=Bp.clientX+Bq,Br=Bp.clientY+Bo;if(z&&BW[AK](b)){for(var Bm=0,Bn=Bp.targetTouches&&Bp.targetTouches.length;Bm<Bn;Bm++){if(Bp.targetTouches[Bm].target==g){var Bl=Bp;Bp=Bp.targetTouches[Bm];Bp.originalEvent=Bl;Bp.preventDefault=Bc;Bp.stopPropagation=Ai;break}}}return S.call(R,Bp,Bk,Br)};g.addEventListener(E,d,false);return function(){g.removeEventListener(E,d,false);return true}}}else{if(AZ.doc.attachEvent){return function(g,b,S,R){var d=function(Bl){Bl=Bl||AZ.win.event;var Bk=AZ.doc.documentElement.scrollTop||AZ.doc.body.scrollTop,Bm=AZ.doc.documentElement.scrollLeft||AZ.doc.body.scrollLeft,i=Bl.clientX+Bm,Bn=Bl.clientY+Bk;Bl.preventDefault=Bl.preventDefault||r;Bl.stopPropagation=Bl.stopPropagation||A7;return S.call(R,Bl,i,Bn)};g.attachEvent("on"+b,d);var E=function(){g.detachEvent("on"+b,d);return true};return E}}}})(),BD=[],BX=function(Bl){var Bo=Bl.clientX,Bn=Bl.clientY,Bq=AZ.doc.documentElement.scrollTop||AZ.doc.body.scrollTop,Br=AZ.doc.documentElement.scrollLeft||AZ.doc.body.scrollLeft,S,b=BD.length;while(b--){S=BD[b];if(z){var g=Bl.touches.length,d;while(g--){d=Bl.touches[g];if(d.identifier==S.el._drag.id){Bo=d.clientX;Bn=d.clientY;(Bl.originalEvent?Bl.originalEvent:Bl).preventDefault();break}}}else{Bl.preventDefault()}var R=S.el.node,E,Bk=R.nextSibling,Bp=R.parentNode,Bm=R.style.display;AZ.win.opera&&Bp.removeChild(R);R.style.display="none";E=S.el.paper.getElementByPoint(Bo,Bn);R.style.display=Bm;AZ.win.opera&&(Bk?Bp.insertBefore(R,Bk):Bp.appendChild(R));E&&eve("raphael.drag.over."+S.el.id,S.el,E);Bo+=Br;Bn+=Bq;eve("raphael.drag.move."+S.el.id,S.move_scope||S.el,Bo-S.el._drag.x,Bn-S.el._drag.y,Bo,Bn,Bl)}},C=function(S){Aq.unmousemove(BX).unmouseup(C);var R=BD.length,E;while(R--){E=BD[R];E.el._drag={};eve("raphael.drag.end."+E.el.id,E.end_scope||E.start_scope||E.move_scope||E.el,S)}BD=[]},BG=Aq.el={};for(var AW=s.length;AW--;){(function(E){Aq[E]=BG[E]=function(S,R){if(Aq.is(S,"function")){this.events=this.events||[];this.events.push({name:E,f:S,unbind:Ac(this.shape||this.node||AZ.doc,E,S,R||this)})}return this};Aq["un"+E]=BG["un"+E]=function(b){var S=this.events||[],R=S.length;while(R--){if(S[R].name==E&&S[R].f==b){S[R].unbind();S.splice(R,1);!S.length&&delete this.events;return this}}return this}})(s[AW])}BG.data=function(R,b){var S=At[this.id]=At[this.id]||{};if(arguments.length==1){if(Aq.is(R,"object")){for(var E in R){if(R[AK](E)){this.data(E,R[E])}}return this}eve("raphael.data.get."+this.id,this,S[R],R);return S[R]}S[R]=b;eve("raphael.data.set."+this.id,this,b,R);return this};BG.removeData=function(E){if(E==null){At[this.id]={}}else{At[this.id]&&delete At[this.id][E]}return this};BG.hover=function(b,E,S,R){return this.mouseover(b,S).mouseout(E,R||S)};BG.unhover=function(R,E){return this.unmouseover(R).unmouseout(E)};var BT=[];BG.drag=function(R,g,d,E,S,b){function i(Bl){(Bl.originalEvent||Bl).preventDefault();var Bk=AZ.doc.documentElement.scrollTop||AZ.doc.body.scrollTop,Bm=AZ.doc.documentElement.scrollLeft||AZ.doc.body.scrollLeft;this._drag.x=Bl.clientX+Bm;this._drag.y=Bl.clientY+Bk;this._drag.id=Bl.identifier;!BD.length&&Aq.mousemove(BX).mouseup(C);BD.push({el:this,move_scope:E,start_scope:S,end_scope:b});g&&eve.on("raphael.drag.start."+this.id,g);R&&eve.on("raphael.drag.move."+this.id,R);d&&eve.on("raphael.drag.end."+this.id,d);eve("raphael.drag.start."+this.id,S||E||this,Bl.clientX+Bm,Bl.clientY+Bk,Bl)}this._drag={};BT.push({el:this,start:i});this.mousedown(i);return this};BG.onDragOver=function(E){E?eve.on("raphael.drag.over."+this.id,E):eve.unbind("raphael.drag.over."+this.id)};BG.undrag=function(){var E=BT.length;while(E--){if(BT[E].el==this){this.unmousedown(BT[E].start);BT.splice(E,1);eve.unbind("raphael.drag.*."+this.id)}}!BT.length&&Aq.unmousemove(BX).unmouseup(C)};A3.circle=function(E,b,S){var R=Aq._engine.circle(this,E||0,b||0,S||0);this.__set__&&this.__set__.push(R);return R};A3.rect=function(E,g,R,b,d){var S=Aq._engine.rect(this,E||0,g||0,R||0,b||0,d||0);this.__set__&&this.__set__.push(S);return S};A3.ellipse=function(E,d,b,S){var R=Aq._engine.ellipse(this,E||0,d||0,b||0,S||0);this.__set__&&this.__set__.push(R);return R};A3.path=function(E){E&&!Aq.is(E,AJ)&&!Aq.is(E[0],BC)&&(E+=Aw);var R=Aq._engine.path(Aq.format[Bf](Aq,arguments),this);this.__set__&&this.__set__.push(R);return R};A3.image=function(d,E,g,R,b){var S=Aq._engine.image(this,d||"about:blank",E||0,g||0,R||0,b||0);this.__set__&&this.__set__.push(S);return S};A3.text=function(E,b,S){var R=Aq._engine.text(this,E||0,b||0,Bg(S));this.__set__&&this.__set__.push(R);return R};A3.set=function(R){!Aq.is(R,"array")&&(R=Array.prototype.splice.call(arguments,0,arguments.length));var E=new AL(R);this.__set__&&this.__set__.push(E);return E};A3.setStart=function(E){this.__set__=E||this.set()};A3.setFinish=function(R){var E=this.__set__;delete this.__set__;return E};A3.setSize=function(R,E){return Aq._engine.setSize.call(this,R,E)};A3.setViewBox=function(E,d,R,b,S){return Aq._engine.setViewBox.call(this,E,d,R,b,S)};A3.top=A3.bottom=null;A3.raphael=Aq;var BR=function(S){var d=S.getBoundingClientRect(),Bl=S.ownerDocument,g=Bl.body,E=Bl.documentElement,b=E.clientTop||g.clientTop||0,i=E.clientLeft||g.clientLeft||0,Bk=d.top+(AZ.win.pageYOffset||E.scrollTop||g.scrollTop)-b,R=d.left+(AZ.win.pageXOffset||E.scrollLeft||g.scrollLeft)-i;return{y:Bk,x:R}};A3.getElementByPoint=function(R,Bk){var i=this,S=i.canvas,g=AZ.doc.elementFromPoint(R,Bk);if(AZ.win.opera&&g.tagName=="svg"){var d=BR(S),b=S.createSVGRect();b.x=R-d.x;b.y=Bk-d.y;b.width=b.height=1;var E=S.getIntersectionList(b,null);if(E.length){g=E[E.length-1]}}if(!g){return null}while(g.parentNode&&g!=S.parentNode&&!g.raphael){g=g.parentNode}g==i.canvas.parentNode&&(g=S);g=g&&g.raphael?i.getById(g.raphaelid):null;return g};A3.getById=function(R){var E=this.bottom;while(E){if(E.id==R){return E}E=E.next}return null};A3.forEach=function(S,E){var R=this.bottom;while(R){if(S.call(E,R)===false){return this}R=R.next}return this};A3.getElementsByPoint=function(E,S){var R=this.set();this.forEach(function(b){if(b.isPointInside(E,S)){R.push(b)}});return R};function X(){return this.x+Ap+this.y}function AS(){return this.x+Ap+this.y+Ap+this.width+" \xd7 "+this.height}BG.isPointInside=function(E,S){var R=this.realPath=this.realPath||p[this.type](this);return Aq.isPointInsidePath(R,E,S)};BG.getBBox=function(R){if(this.removed){return{}}var E=this._;if(R){if(E.dirty||!E.bboxwt){this.realPath=p[this.type](this);E.bboxwt=AM(this.realPath);E.bboxwt.toString=AS;E.dirty=0}return E.bboxwt}if(E.dirty||E.dirtyT||!E.bbox){if(E.dirty||!this.realPath){E.bboxwt=0;this.realPath=p[this.type](this)}E.bbox=AM(n(this.realPath,this.matrix));E.bbox.toString=AS;E.dirty=E.dirtyT=0}return E.bbox};BG.clone=function(){if(this.removed){return null}var E=this.paper[this.type]().attr(this.attr());this.__set__&&this.__set__.push(E);return E};BG.glow=function(Bk){if(this.type=="text"){return null}Bk=Bk||{};var S={width:(Bk.width||10)+(+this.attr("stroke-width")||1),fill:Bk.fill||false,opacity:Bk.opacity||0.5,offsetx:Bk.offsetx||0,offsety:Bk.offsety||0,color:Bk.color||"#000"},g=S.width/2,b=this.paper,E=b.set(),d=this.realPath||p[this.type](this);d=this.matrix?n(d,this.matrix):d;for(var R=1;R<g+1;R++){E.push(b.path(d).attr({stroke:S.color,fill:S.fill?S.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(S.width/g*R).toFixed(3),opacity:+(S.opacity/g).toFixed(3)}))}return E.insertBefore(this).translate(S.offsetx,S.offsety)};var A6={},H=function(R,E,d,b,Bl,Bk,i,g,S){if(S==null){return N(R,E,d,b,Bl,Bk,i,g)}else{return Aq.findDotsAtSegment(R,E,d,b,Bl,Bk,i,g,c(R,E,d,b,Bl,Bk,i,g,S))}},A5=function(E,R){return function(Bs,d,g){Bs=w(Bs);var Bo,Bn,S,Bk,b="",Br={},Bp,Bm=0;for(var Bl=0,Bq=Bs.length;Bl<Bq;Bl++){S=Bs[Bl];if(S[0]=="M"){Bo=+S[1];Bn=+S[2]}else{Bk=H(Bo,Bn,S[1],S[2],S[3],S[4],S[5],S[6]);if(Bm+Bk>d){if(R&&!Br.start){Bp=H(Bo,Bn,S[1],S[2],S[3],S[4],S[5],S[6],d-Bm);b+=["C"+Bp.start.x,Bp.start.y,Bp.m.x,Bp.m.y,Bp.x,Bp.y];if(g){return b}Br.start=b;b=["M"+Bp.x,Bp.y+"C"+Bp.n.x,Bp.n.y,Bp.end.x,Bp.end.y,S[5],S[6]].join();Bm+=Bk;Bo=+S[5];Bn=+S[6];continue}if(!E&&!R){Bp=H(Bo,Bn,S[1],S[2],S[3],S[4],S[5],S[6],d-Bm);return{x:Bp.x,y:Bp.y,alpha:Bp.alpha}}}Bm+=Bk;Bo=+S[5];Bn=+S[6]}b+=S.shift()+S}Br.end=b;Bp=E?Bm:R?Br:Aq.findDotsAtSegment(Bo,Bn,S[0],S[1],S[2],S[3],S[4],S[5],1);Bp.alpha&&(Bp={x:Bp.x,y:Bp.y,alpha:Bp.alpha});return Bp}};var Ar=A5(1),l=A5(),AD=A5(0,1);Aq.getTotalLength=Ar;Aq.getPointAtLength=l;Aq.getSubpath=function(R,b,S){if(this.getTotalLength(R)-S<0.000001){return AD(R,b).end}var E=AD(R,S,1);return b?AD(E,b).end:E};BG.getTotalLength=function(){if(this.type!="path"){return }if(this.node.getTotalLength){return this.node.getTotalLength()}return Ar(this.attrs.path)};BG.getPointAtLength=function(E){if(this.type!="path"){return }return l(this.attrs.path,E)};BG.getSubpath=function(R,E){if(this.type!="path"){return }return Aq.getSubpath(this.attrs.path,R,E)};var L=Aq.easing_formulas={linear:function(E){return E},"<":function(E){return BO(E,1.7)},">":function(E){return BO(E,0.48)},"<>":function(Bk){var b=0.48-Bk/1.04,S=AT.sqrt(0.1734+b*b),E=S-b,i=BO(AV(E),1/3)*(E<0?-1:1),g=-S-b,d=BO(AV(g),1/3)*(g<0?-1:1),R=i+d+0.5;return(1-R)*3*R*R+R*R*R},backIn:function(R){var E=1.70158;return R*R*((E+1)*R-E)},backOut:function(R){R=R-1;var E=1.70158;return R*R*((E+1)*R+E)+1},elastic:function(E){if(E==!!E){return E}return BO(2,-10*E)*AT.sin((E-0.075)*(2*Au)/0.3)+1},bounce:function(b){var R=7.5625,S=2.75,E;if(b<(1/S)){E=R*b*b}else{if(b<(2/S)){b-=(1.5/S);E=R*b*b+0.75}else{if(b<(2.5/S)){b-=(2.25/S);E=R*b*b+0.9375}else{b-=(2.625/S);E=R*b*b+0.984375}}}return E}};L.easeIn=L["ease-in"]=L["<"];L.easeOut=L["ease-out"]=L[">"];L.easeInOut=L["ease-in-out"]=L["<>"];L["back-in"]=L.backIn;L["back-out"]=L.backOut;var AB=[],Am=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(E){setTimeout(E,16)},Bb=function(){var Bk=+new Date,Bs=0;for(;Bs<AB.length;Bs++){var By=AB[Bs];if(By.el.removed||By.paused){continue}var b=Bk-By.start,Bq=By.ms,Bp=By.easing,Bt=By.from,Bn=By.diff,R=By.to,Bm=By.t,g=By.el,Bo={},E,Bw={},B0;if(By.initstatus){b=(By.initstatus*By.anim.top-By.prev)/(By.percent-By.prev)*Bq;By.status=By.initstatus;delete By.initstatus;By.stop&&AB.splice(Bs--,1)}else{By.status=(By.prev+(By.percent-By.prev)*(b/Bq))/By.anim.top}if(b<0){continue}if(b<Bq){var S=Bp(b/Bq);for(var Br in Bt){if(Bt[AK](Br)){switch(AR[Br]){case Ak:E=+Bt[Br]+S*Bq*Bn[Br];break;case"colour":E="rgb("+[j(AH(Bt[Br].r+S*Bq*Bn[Br].r)),j(AH(Bt[Br].g+S*Bq*Bn[Br].g)),j(AH(Bt[Br].b+S*Bq*Bn[Br].b))].join(",")+")";break;case"path":E=[];for(var Bv=0,Bl=Bt[Br].length;Bv<Bl;Bv++){E[Bv]=[Bt[Br][Bv][0]];for(var Bu=1,Bx=Bt[Br][Bv].length;Bu<Bx;Bu++){E[Bv][Bu]=+Bt[Br][Bv][Bu]+S*Bq*Bn[Br][Bv][Bu]}E[Bv]=E[Bv].join(Ap)}E=E.join(Ap);break;case"transform":if(Bn[Br].real){E=[];for(Bv=0,Bl=Bt[Br].length;Bv<Bl;Bv++){E[Bv]=[Bt[Br][Bv][0]];for(Bu=1,Bx=Bt[Br][Bv].length;Bu<Bx;Bu++){E[Bv][Bu]=Bt[Br][Bv][Bu]+S*Bq*Bn[Br][Bv][Bu]}}}else{var Bz=function(B1){return +Bt[Br][B1]+S*Bq*Bn[Br][B1]};E=[["m",Bz(0),Bz(1),Bz(2),Bz(3),Bz(4),Bz(5)]]}break;case"csv":if(Br=="clip-rect"){E=[];Bv=4;while(Bv--){E[Bv]=+Bt[Br][Bv]+S*Bq*Bn[Br][Bv]}}break;default:var d=[][Bd](Bt[Br]);E=[];Bv=g.paper.customAttributes[Br].length;while(Bv--){E[Bv]=+d[Bv]+S*Bq*Bn[Br][Bv]}break}Bo[Br]=E}}g.attr(Bo);(function(B2,i,B1){setTimeout(function(){eve("raphael.anim.frame."+B2,i,B1)})})(g.id,g,By.anim)}else{(function(B2,B1,i){setTimeout(function(){eve("raphael.anim.frame."+B1.id,B1,i);eve("raphael.anim.finish."+B1.id,B1,i);Aq.is(B2,"function")&&B2.call(B1)})})(By.callback,g,By.anim);g.attr(R);AB.splice(Bs--,1);if(By.repeat>1&&!By.next){for(B0 in R){if(R[AK](B0)){Bw[B0]=By.totalOrigin[B0]}}By.el.attr(Bw);Al(By.anim,By.el,By.anim.percents[0],null,By.totalOrigin,By.repeat-1)}if(By.next&&!By.stop){Al(By.anim,By.el,By.next,null,By.totalOrigin,By.repeat)}}}Aq.svg&&g&&g.paper&&g.paper.safari();AB.length&&Am(Bb)},j=function(E){return E>255?255:E<0?0:E};BG.animateWith=function(R,b,S,E,Bk,Bp){var g=this;if(g.removed){Bp&&Bp.call(g);return g}var Bn=S instanceof BZ?S:Aq.animation(S,E,Bk,Bp),Bm,Bl;Al(Bn,g,Bn.percents[0],null,g.attr());for(var d=0,Bo=AB.length;d<Bo;d++){if(AB[d].anim==b&&AB[d].el==R){AB[Bo-1].start=AB[d].start;break}}return g};function A2(Bq,b,R,Bp,Bo,Bk){var Bl=3*b,Bn=3*(Bp-b)-Bl,E=1-Bl-Bn,i=3*R,Bm=3*(Bo-R)-i,Br=1-i-Bm;function g(Bs){return((E*Bs+Bn)*Bs+Bl)*Bs}function S(Bs,Bu){var Bt=d(Bs,Bu);return((Br*Bt+Bm)*Bt+i)*Bt}function d(Bs,Bz){var By,Bx,Bv,Bt,Bw,Bu;for(Bv=Bs,Bu=0;Bu<8;Bu++){Bt=g(Bv)-Bs;if(AV(Bt)<Bz){return Bv}Bw=(3*E*Bv+2*Bn)*Bv+Bl;if(AV(Bw)<0.000001){break}Bv=Bv-Bt/Bw}By=0;Bx=1;Bv=Bs;if(Bv<By){return By}if(Bv>Bx){return Bx}while(By<Bx){Bt=g(Bv);if(AV(Bt-Bs)<Bz){return Bv}if(Bs>Bt){By=Bv}else{Bx=Bv}Bv=(Bx-By)/2+By}return Bv}return S(Bq,1/(200*Bk))}BG.onAnimation=function(E){E?eve.on("raphael.anim.frame."+this.id,E):eve.unbind("raphael.anim.frame."+this.id);return this};function BZ(d,S){var R=[],b={};this.ms=S;this.times=1;if(d){for(var E in d){if(d[AK](E)){b[AN(E)]=d[E];R.push(AN(E))}}R.sort(T)}this.anim=b;this.top=R[R.length-1];this.percents=R}BZ.prototype.delay=function(R){var E=new BZ(this.anim,this.ms);E.times=this.times;E.del=+R||0;return E};BZ.prototype.repeat=function(R){var E=new BZ(this.anim,this.ms);E.del=this.del;E.times=AT.floor(J(R,0))||1;return E};function Al(B2,S,E,B0,Bk,Bo){E=AN(E);var B9,g,Bn,CA=[],Bu,Bt,d,Bw=B2.ms,B1={},b={},Bq={};if(B0){for(B5=0,Bp=AB.length;B5<Bp;B5++){var B7=AB[B5];if(B7.el.id==S.id&&B7.anim==B2){if(B7.percent!=E){AB.splice(B5,1);Bn=1}else{g=B7}S.attr(B7.totalOrigin);break}}}else{B0=+b}for(var B5=0,Bp=B2.percents.length;B5<Bp;B5++){if(B2.percents[B5]==E||B2.percents[B5]>B0*B2.top){E=B2.percents[B5];Bt=B2.percents[B5-1]||0;Bw=Bw/B2.top*(E-Bt);Bu=B2.percents[B5+1];B9=B2.anim[E];break}else{if(B0){S.attr(B2.anim[B2.percents[B5]])}}}if(!B9){return }if(!g){for(var By in B9){if(B9[AK](By)){if(AR[AK](By)||S.paper.customAttributes[AK](By)){B1[By]=S.attr(By);(B1[By]==null)&&(B1[By]=O[By]);b[By]=B9[By];switch(AR[By]){case Ak:Bq[By]=(b[By]-B1[By])/Bw;break;case"colour":B1[By]=Aq.getRGB(B1[By]);var Bz=Aq.getRGB(b[By]);Bq[By]={r:(Bz.r-B1[By].r)/Bw,g:(Bz.g-B1[By].g)/Bw,b:(Bz.b-B1[By].b)/Bw};break;case"path":var Bl=w(B1[By],b[By]),Bs=Bl[1];B1[By]=Bl[0];Bq[By]=[];for(B5=0,Bp=B1[By].length;B5<Bp;B5++){Bq[By][B5]=[0];for(var B4=1,B6=B1[By][B5].length;B4<B6;B4++){Bq[By][B5][B4]=(Bs[B5][B4]-B1[By][B5][B4])/Bw}}break;case"transform":var CC=S._,CB=Aa(CC[By],b[By]);if(CB){B1[By]=CB.from;b[By]=CB.to;Bq[By]=[];Bq[By].real=true;for(B5=0,Bp=B1[By].length;B5<Bp;B5++){Bq[By][B5]=[B1[By][B5][0]];for(B4=1,B6=B1[By][B5].length;B4<B6;B4++){Bq[By][B5][B4]=(b[By][B5][B4]-B1[By][B5][B4])/Bw}}}else{var Bx=(S.matrix||new Ae),B8={_:{transform:CC.transform},getBBox:function(){return S.getBBox(1)}};B1[By]=[Bx.a,Bx.b,Bx.c,Bx.d,Bx.e,Bx.f];An(B8,b[By]);b[By]=B8._.transform;Bq[By]=[(B8.matrix.a-Bx.a)/Bw,(B8.matrix.b-Bx.b)/Bw,(B8.matrix.c-Bx.c)/Bw,(B8.matrix.d-Bx.d)/Bw,(B8.matrix.e-Bx.e)/Bw,(B8.matrix.f-Bx.f)/Bw]}break;case"csv":var R=Bg(B9[By])[f](A),Bm=Bg(B1[By])[f](A);if(By=="clip-rect"){B1[By]=Bm;Bq[By]=[];B5=Bm.length;while(B5--){Bq[By][B5]=(R[B5]-B1[By][B5])/Bw}}b[By]=R;break;default:R=[][Bd](B9[By]);Bm=[][Bd](B1[By]);Bq[By]=[];B5=S.paper.customAttributes[By].length;while(B5--){Bq[By][B5]=((R[B5]||0)-(Bm[B5]||0))/Bw}break}}}}var Bv=B9.easing,B3=Aq.easing_formulas[Bv];if(!B3){B3=Bg(Bv).match(B);if(B3&&B3.length==5){var Br=B3;B3=function(i){return A2(i,+Br[1],+Br[2],+Br[3],+Br[4],Bw)}}else{B3=Ba}}d=B9.start||B2.start||+new Date;B7={anim:B2,percent:E,timestamp:d,start:d+(B2.del||0),status:0,initstatus:B0||0,stop:false,ms:Bw,easing:B3,from:B1,diff:Bq,to:b,el:S,callback:B9.callback,prev:Bt,next:Bu,repeat:Bo||B2.times,origin:S.attr(),totalOrigin:Bk};AB.push(B7);if(B0&&!g&&!Bn){B7.stop=true;B7.start=new Date-Bw*B0;if(AB.length==1){return Bb()}}if(Bn){B7.start=new Date-B7.ms*B0}AB.length==1&&Am(Bb)}else{g.initstatus=B0;g.start=new Date-g.ms*B0}eve("raphael.anim.start."+S.id,S,B2)}Aq.animation=function(d,R,i,g){if(d instanceof BZ){return d}if(Aq.is(i,"function")||!i){g=g||i||null;i=null}d=Object(d);R=+R||0;var b={},S,E;for(E in d){if(d[AK](E)&&AN(E)!=E&&AN(E)+"%"!=E){S=true;b[E]=d[E]}}if(!S){return new BZ(d,R)}else{i&&(b.easing=i);g&&(b.callback=g);return new BZ({100:b},R)}};BG.animate=function(b,E,g,d){var R=this;if(R.removed){d&&d.call(R);return R}var S=b instanceof BZ?b:Aq.animation(b,E,g,d);Al(S,R,S.percents[0],null,R.attr());return R};BG.setTime=function(R,E){if(R&&E!=null){this.status(R,BL(E,R.ms)/R.ms)}return this};BG.status=function(d,b){var R=[],S=0,E,g;if(b!=null){Al(d,this,-1,BL(b,1));return this}else{E=AB.length;for(;S<E;S++){g=AB[S];if(g.el.id==this.id&&(!d||g.anim==d)){if(d){return g.status}R.push({anim:g.anim,status:g.status})}}if(d){return 0}return R}};BG.pause=function(R){for(var E=0;E<AB.length;E++){if(AB[E].el.id==this.id&&(!R||AB[E].anim==R)){if(eve("raphael.anim.pause."+this.id,this,AB[E].anim)!==false){AB[E].paused=true}}}return this};BG.resume=function(R){for(var E=0;E<AB.length;E++){if(AB[E].el.id==this.id&&(!R||AB[E].anim==R)){var S=AB[E];if(eve("raphael.anim.resume."+this.id,this,S.anim)!==false){delete S.paused;this.status(S.anim,S.status)}}}return this};BG.stop=function(R){for(var E=0;E<AB.length;E++){if(AB[E].el.id==this.id&&(!R||AB[E].anim==R)){if(eve("raphael.anim.stop."+this.id,this,AB[E].anim)!==false){AB.splice(E--,1)}}}return this};function AA(R){for(var E=0;E<AB.length;E++){if(AB[E].el.paper==R){AB.splice(E--,1)}}}eve.on("raphael.remove",AA);eve.on("raphael.clear",AA);BG.toString=function(){return"Rapha\xebl\u2019s object"};var AL=function(E){this.items=[];this.length=0;this.type="set";if(E){for(var R=0,S=E.length;R<S;R++){if(E[R]&&(E[R].constructor==BG.constructor||E[R].constructor==AL)){this[this.items.length]=this.items[this.items.length]=E[R];this.length++}}}},BB=AL.prototype;BB.push=function(){var b,E;for(var R=0,S=arguments.length;R<S;R++){b=arguments[R];if(b&&(b.constructor==BG.constructor||b.constructor==AL)){E=this.items.length;this[E]=this.items[E]=b;this.length++}}return this};BB.pop=function(){this.length&&delete this[this.length--];return this.items.pop()};BB.forEach=function(b,E){for(var R=0,S=this.items.length;R<S;R++){if(b.call(E,this.items[R],R)===false){return this}}return this};for(var a in BG){if(BG[AK](a)){BB[a]=(function(E){return function(){var R=arguments;return this.forEach(function(S){S[E][Bf](S,R)})}})(a)}}BB.attr=function(R,g){if(R&&Aq.is(R,BC)&&Aq.is(R[0],"object")){for(var E=0,d=R.length;E<d;E++){this.items[E].attr(R[E])}}else{for(var S=0,b=this.items.length;S<b;S++){this.items[S].attr(R,g)}}return this};BB.clear=function(){while(this.length){this.pop()}};BB.splice=function(b,Bk,Bl){b=b<0?J(this.length+b,0):b;Bk=J(0,BL(this.length-b,Bk));var S=[],E=[],R=[],d;for(d=2;d<arguments.length;d++){R.push(arguments[d])}for(d=0;d<Bk;d++){E.push(this[b+d])}for(;d<this.length-b;d++){S.push(this[b+d])}var g=R.length;for(d=0;d<g+S.length;d++){this.items[b+d]=this[b+d]=d<g?R[d]:S[d-g]}d=this.items.length=this.length-=Bk-g;while(this[d]){delete this[d++]}return new AL(E)};BB.exclude=function(S){for(var E=0,R=this.length;E<R;E++){if(this[E]==S){this.splice(E,1);return true}}};BB.animate=function(S,E,Bk,Bm){(Aq.is(Bk,"function")||!Bk)&&(Bm=Bk||null);var g=this.items.length,b=g,Bn,Bl=this,d;if(!g){return this}Bm&&(d=function(){!--g&&Bm.call(Bl)});Bk=Aq.is(Bk,AJ)?Bk:d;var R=Aq.animation(S,E,Bk,d);Bn=this.items[--b].animate(R);while(b--){this.items[b]&&!this.items[b].removed&&this.items[b].animateWith(Bn,R,R)}return this};BB.insertAfter=function(R){var E=this.items.length;while(E--){this.items[E].insertAfter(R)}return this};BB.getBBox=function(){var E=[],g=[],R=[],b=[];for(var S=this.items.length;S--;){if(!this.items[S].removed){var d=this.items[S].getBBox();E.push(d.x);g.push(d.y);R.push(d.x+d.width);b.push(d.y+d.height)}}E=BL[Bf](0,E);g=BL[Bf](0,g);R=J[Bf](0,R);b=J[Bf](0,b);return{x:E,y:g,x2:R,y2:b,width:R-E,height:b-g}};BB.clone=function(S){S=new AL;for(var E=0,R=this.items.length;E<R;E++){S.push(this.items[E].clone())}return S};BB.toString=function(){return"Rapha\xebl\u2018s set"};Aq.registerFont=function(R){if(!R.face){return R}this.fonts=this.fonts||{};var b={w:R.w,face:{},glyphs:{}},S=R.face["font-family"];for(var i in R.face){if(R.face[AK](i)){b.face[i]=R.face[i]}}if(this.fonts[S]){this.fonts[S].push(b)}else{this.fonts[S]=[b]}if(!R.svg){b.face["units-per-em"]=u(R.face["units-per-em"],10);for(var d in R.glyphs){if(R.glyphs[AK](d)){var g=R.glyphs[d];b.glyphs[d]={w:g.w,k:{},d:g.d&&"M"+g.d.replace(/[mlcxtrv]/g,function(Bk){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[Bk]||"M"})+"z"};if(g.k){for(var E in g.k){if(g[AK](E)){b.glyphs[d].k[E]=g.k[E]}}}}}}return R};A3.getFont=function(Bl,Bm,R,b){b=b||"normal";R=R||"normal";Bm=+Bm||{normal:400,bold:700,lighter:300,bolder:800}[Bm]||400;if(!Aq.fonts){return }var d=Aq.fonts[Bl];if(!d){var S=new RegExp("(^|\\s)"+Bl.replace(/[^\w\d\s+!~.:_-]/g,Aw)+"(\\s|$)","i");for(var E in Aq.fonts){if(Aq.fonts[AK](E)){if(S.test(E)){d=Aq.fonts[E];break}}}}var g;if(d){for(var Bk=0,Bn=d.length;Bk<Bn;Bk++){g=d[Bk];if(g.face["font-weight"]==Bm&&(g.face["font-style"]==R||!g.face["font-style"])&&g.face["font-stretch"]==b){break}}}return g};A3.print=function(Bk,g,E,Bn,Bo,Bx,R){Bx=Bx||"middle";R=J(BL(R||0,1),-1);var Bw=Bg(E)[f](Aw),Bt=0,Bv=0,Br=Aw,By;Aq.is(Bn,E)&&(Bn=this.getFont(Bn));if(Bn){By=(Bo||16)/Bn.face["units-per-em"];var b=Bn.face.bbox[f](A),Bm=+b[0],S=b[3]-b[1],d=0,Bp=+b[1]+(Bx=="baseline"?S+(+Bn.face.descent):S/2);for(var Bs=0,Bl=Bw.length;Bs<Bl;Bs++){if(Bw[Bs]=="\n"){Bt=0;Bu=0;Bv=0;d+=S}else{var Bq=Bv&&Bn.glyphs[Bw[Bs-1]]||{},Bu=Bn.glyphs[Bw[Bs]];Bt+=Bv?(Bq.w||Bn.w)+(Bq.k&&Bq.k[Bw[Bs]]||0)+(Bn.w*R):0;Bv=1}if(Bu&&Bu.d){Br+=Aq.transformPath(Bu.d,["t",Bt*By,d*By,"s",By,By,Bm,Bp,"t",(Bk-Bm)/By,(g-Bp)/By])}}}return this.path(Br).attr({fill:"#000",stroke:"none"})};A3.add=function(b){if(Aq.is(b,"array")){var S=this.set(),R=0,d=b.length,E;for(;R<d;R++){E=b[R]||{};BV[AK](E.type)&&S.push(this[E.type]().attr(E))}}return S};Aq.format=function(R,S){var E=Aq.is(S,BC)?[0][Bd](S):arguments;R&&Aq.is(R,AJ)&&E.length-1&&(R=R.replace(BQ,function(d,b){return E[++b]==null?Aw:E[b]}));return R||Aw};Aq.fullfill=(function(){var S=/\{([^\}]+)\}/g,E=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,R=function(g,d,i){var b=i;d.replace(E,function(Bm,Bl,Bk,Bo,Bn){Bl=Bl||Bo;if(b){if(Bl in b){b=b[Bl]}typeof b=="function"&&Bn&&(b=b())}});b=(b==null||b==i?g:b)+"";return b};return function(d,b){return String(d).replace(S,function(i,g){return R(i,g,b)})}})();Aq.ninja=function(){P.was?(AZ.win.Raphael=P.is):delete Raphael;return Aq};Aq.st=BB;(function(b,R,S){if(b.readyState==null&&b.addEventListener){b.addEventListener(R,S=function(){b.removeEventListener(R,S,false);b.readyState="complete"},false);b.readyState="loading"}function E(){(/in/).test(b.readyState)?setTimeout(E,9):Aq.eve("raphael.DOMload")}E()})(document,"DOMContentLoaded");P.was?(AZ.win.Raphael=Aq):(Raphael=Aq);eve.on("raphael.DOMload",function(){AO=true})})();window.Raphael&&window.Raphael.svg&&function(M){var D="hasOwnProperty",e=String,O=parseFloat,T=parseInt,G=Math,f=G.max,V=G.abs,I=G.pow,H=/[, ]+/,c=M.eve,U="",K=" ";var P="http://www.w3.org/1999/xlink",b={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},X={};M.toString=function(){return"Your browser supports SVG.\nYou are running Rapha\xebl "+this.version};var J=function(S,E){if(E){if(typeof S=="string"){S=J(S)}for(var R in E){if(E[D](R)){if(R.substring(0,6)=="xlink:"){S.setAttributeNS(P,R.substring(6),e(E[R]))}else{S.setAttribute(R,e(E[R]))}}}}else{S=M._g.doc.createElementNS("http://www.w3.org/2000/svg",S);S.style&&(S.style.webkitTapHighlightColor="rgba(0,0,0,0)")}return S},A=function(n,t){var q="linear",R=n.id+t,l=0.5,j=0.5,g=n.node,E=n.paper,v=g.style,S=M._g.doc.getElementById(R);if(!S){t=e(t).replace(M._radial_gradient,function(s,i,w){q="radial";if(i&&w){l=O(i);j=O(w);var o=((j>0.5)*2-1);I(l-0.5,2)+I(j-0.5,2)>0.25&&(j=G.sqrt(0.25-I(l-0.5,2))*o+0.5)&&j!=0.5&&(j=j.toFixed(5)-0.00001*o)}return U});t=t.split(/\s*\-\s*/);if(q=="linear"){var k=t.shift();k=-O(k);if(isNaN(k)){return null}var h=[0,0,G.cos(M.rad(k)),G.sin(M.rad(k))],r=1/(f(V(h[2]),V(h[3]))||1);h[2]*=r;h[3]*=r;if(h[2]<0){h[0]=-h[2];h[2]=0}if(h[3]<0){h[1]=-h[3];h[3]=0}}var p=M._parseDots(t);if(!p){return null}R=R.replace(/[\(\)\s,\xb0#]/g,"_");if(n.gradient&&R!=n.gradient.id){E.defs.removeChild(n.gradient);delete n.gradient}if(!n.gradient){S=J(q+"Gradient",{id:R});n.gradient=S;J(S,q=="radial"?{fx:l,fy:j}:{x1:h[0],y1:h[1],x2:h[2],y2:h[3],gradientTransform:n.matrix.invert()});E.defs.appendChild(S);for(var m=0,u=p.length;m<u;m++){S.appendChild(J("stop",{offset:p[m].offset?p[m].offset:m?"100%":"0%","stop-color":p[m].color||"#fff"}))}}}J(g,{fill:"url(#"+R+")",opacity:1,"fill-opacity":1});v.fill=U;v.opacity=1;v.fillOpacity=1;return 1},B=function(R){var E=R.getBBox(1);J(R.pattern,{patternTransform:R.matrix.invert()+" translate("+E.x+","+E.y+")"})},C=function(s,v,l){if(s.type=="path"){var E=e(v).toLowerCase().split("-"),r=s.paper,AH=l?"end":"start",y=s.node,u=s.attrs,k=u["stroke-width"],AC=E.length,g="classic",AB,S,n,z,x,m=3,AD=3,q=5;while(AC--){switch(E[AC]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":g=E[AC];break;case"wide":AD=5;break;case"narrow":AD=2;break;case"long":m=5;break;case"short":m=2;break}}if(g=="open"){m+=2;AD+=2;q+=2;n=1;z=l?4:1;x={fill:"none",stroke:u.stroke}}else{z=n=m/2;x={fill:u.stroke,stroke:"none"}}if(s._.arrows){if(l){s._.arrows.endPath&&X[s._.arrows.endPath]--;s._.arrows.endMarker&&X[s._.arrows.endMarker]--}else{s._.arrows.startPath&&X[s._.arrows.startPath]--;s._.arrows.startMarker&&X[s._.arrows.startMarker]--}}else{s._.arrows={}}if(g!="none"){var R="raphael-marker-"+g,AG="raphael-marker-"+AH+g+m+AD;if(!M._g.doc.getElementById(R)){r.defs.appendChild(J(J("path"),{"stroke-linecap":"round",d:b[g],id:R}));X[R]=1}else{X[R]++}var j=M._g.doc.getElementById(AG),AA;if(!j){j=J(J("marker"),{id:AG,markerHeight:AD,markerWidth:m,orient:"auto",refX:z,refY:AD/2});AA=J(J("use"),{"xlink:href":"#"+R,transform:(l?"rotate(180 "+m/2+" "+AD/2+") ":U)+"scale("+m/q+","+AD/q+")","stroke-width":(1/((m/q+AD/q)/2)).toFixed(4)});j.appendChild(AA);r.defs.appendChild(j);X[AG]=1}else{X[AG]++;AA=j.getElementsByTagName("use")[0]}J(AA,x);var AF=n*(g!="diamond"&&g!="oval");if(l){AB=s._.arrows.startdx*k||0;S=M.getTotalLength(u.path)-AF*k}else{AB=AF*k;S=M.getTotalLength(u.path)-(s._.arrows.enddx*k||0)}x={};x["marker-"+AH]="url(#"+AG+")";if(S||AB){x.d=Raphael.getSubpath(u.path,AB,S)}J(y,x);s._.arrows[AH+"Path"]=R;s._.arrows[AH+"Marker"]=AG;s._.arrows[AH+"dx"]=AF;s._.arrows[AH+"Type"]=g;s._.arrows[AH+"String"]=v}else{if(l){AB=s._.arrows.startdx*k||0;S=M.getTotalLength(u.path)-AB}else{AB=0;S=M.getTotalLength(u.path)-(s._.arrows.enddx*k||0)}s._.arrows[AH+"Path"]&&J(y,{d:Raphael.getSubpath(u.path,AB,S)});delete s._.arrows[AH+"Path"];delete s._.arrows[AH+"Marker"];delete s._.arrows[AH+"dx"];delete s._.arrows[AH+"Type"];delete s._.arrows[AH+"String"]}for(x in X){if(X[D](x)&&!X[x]){var AE=M._g.doc.getElementById(x);AE&&AE.parentNode.removeChild(AE)}}}},Y={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},L=function(k,h,j){h=Y[e(h).toLowerCase()];if(h){var S=k.attrs["stroke-width"]||"1",E={round:S,square:S,butt:0}[k.attrs["stroke-linecap"]||j["stroke-linecap"]]||0,g=[],R=h.length;while(R--){g[R]=h[R]*S+((R%2)?1:-1)*E}J(k.node,{"stroke-dasharray":g.join(",")})}},Z=function(p,x){var t=p.node,q=p.attrs,m=t.style.visibility;t.style.visibility="hidden";for(var s in x){if(x[D](s)){if(!M._availableAttrs[D](s)){continue}var r=x[s];q[s]=r;switch(s){case"blur":p.blur(r);break;case"href":case"title":case"target":var v=t.parentNode;if(v.tagName.toLowerCase()!="a"){var h=J("a");v.insertBefore(h,t);h.appendChild(t);v=h}if(s=="target"){v.setAttributeNS(P,"show",r=="blank"?"new":r)}else{v.setAttributeNS(P,s,r)}break;case"cursor":t.style.cursor=r;break;case"transform":p.transform(r);break;case"arrow-start":C(p,r);break;case"arrow-end":C(p,r,1);break;case"clip-rect":var R=e(r).split(H);if(R.length==4){p.clip&&p.clip.parentNode.parentNode.removeChild(p.clip.parentNode);var S=J("clipPath"),u=J("rect");S.id=M.createUUID();J(u,{x:R[0],y:R[1],width:R[2],height:R[3]});S.appendChild(u);p.paper.defs.appendChild(S);J(t,{"clip-path":"url(#"+S.id+")"});p.clip=u}if(!r){var n=t.getAttribute("clip-path");if(n){var w=M._g.doc.getElementById(n.replace(/(^url\(#|\)$)/g,U));w&&w.parentNode.removeChild(w);J(t,{"clip-path":U});delete p.clip}}break;case"path":if(p.type=="path"){J(t,{d:r?q.path=M._pathToAbsolute(r):"M0,0"});p._.dirty=1;if(p._.arrows){"startString" in p._.arrows&&C(p,p._.arrows.startString);"endString" in p._.arrows&&C(p,p._.arrows.endString,1)}}break;case"width":t.setAttribute(s,r);p._.dirty=1;if(q.fx){s="x";r=q.x}else{break}case"x":if(q.fx){r=-q.x-(q.width||0)}case"rx":if(s=="rx"&&p.type=="rect"){break}case"cx":t.setAttribute(s,r);p.pattern&&B(p);p._.dirty=1;break;case"height":t.setAttribute(s,r);p._.dirty=1;if(q.fy){s="y";r=q.y}else{break}case"y":if(q.fy){r=-q.y-(q.height||0)}case"ry":if(s=="ry"&&p.type=="rect"){break}case"cy":t.setAttribute(s,r);p.pattern&&B(p);p._.dirty=1;break;case"r":if(p.type=="rect"){J(t,{rx:r,ry:r})}else{t.setAttribute(s,r)}p._.dirty=1;break;case"src":if(p.type=="image"){t.setAttributeNS(P,"href",r)}break;case"stroke-width":if(p._.sx!=1||p._.sy!=1){r/=f(V(p._.sx),V(p._.sy))||1}if(p.paper._vbSize){r*=p.paper._vbSize}t.setAttribute(s,r);if(q["stroke-dasharray"]){L(p,q["stroke-dasharray"],x)}if(p._.arrows){"startString" in p._.arrows&&C(p,p._.arrows.startString);"endString" in p._.arrows&&C(p,p._.arrows.endString,1)}break;case"stroke-dasharray":L(p,r,x);break;case"fill":var i=e(r).match(M._ISURL);if(i){S=J("pattern");var l=J("image");S.id=M.createUUID();J(S,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1});J(l,{x:0,y:0,"xlink:href":i[1]});S.appendChild(l);(function(o){M._preload(i[1],function(){var y=this.offsetWidth,z=this.offsetHeight;J(o,{width:y,height:z});J(l,{width:y,height:z});p.paper.safari()})})(S);p.paper.defs.appendChild(S);J(t,{fill:"url(#"+S.id+")"});p.pattern=S;p.pattern&&B(p);break}var g=M.getRGB(r);if(!g.error){delete x.gradient;delete q.gradient;!M.is(q.opacity,"undefined")&&M.is(x.opacity,"undefined")&&J(t,{opacity:q.opacity});!M.is(q["fill-opacity"],"undefined")&&M.is(x["fill-opacity"],"undefined")&&J(t,{"fill-opacity":q["fill-opacity"]})}else{if((p.type=="circle"||p.type=="ellipse"||e(r).charAt()!="r")&&A(p,r)){if("opacity" in q||"fill-opacity" in q){var E=M._g.doc.getElementById(t.getAttribute("fill").replace(/^url\(#|\)$/g,U));if(E){var j=E.getElementsByTagName("stop");J(j[j.length-1],{"stop-opacity":("opacity" in q?q.opacity:1)*("fill-opacity" in q?q["fill-opacity"]:1)})}}q.gradient=r;q.fill="none";break}}g[D]("opacity")&&J(t,{"fill-opacity":g.opacity>1?g.opacity/100:g.opacity});case"stroke":g=M.getRGB(r);t.setAttribute(s,g.hex);s=="stroke"&&g[D]("opacity")&&J(t,{"stroke-opacity":g.opacity>1?g.opacity/100:g.opacity});if(s=="stroke"&&p._.arrows){"startString" in p._.arrows&&C(p,p._.arrows.startString);"endString" in p._.arrows&&C(p,p._.arrows.endString,1)}break;case"gradient":(p.type=="circle"||p.type=="ellipse"||e(r).charAt()!="r")&&A(p,r);break;case"opacity":if(q.gradient&&!q[D]("stroke-opacity")){J(t,{"stroke-opacity":r>1?r/100:r})}case"fill-opacity":if(q.gradient){E=M._g.doc.getElementById(t.getAttribute("fill").replace(/^url\(#|\)$/g,U));if(E){j=E.getElementsByTagName("stop");J(j[j.length-1],{"stop-opacity":r})}break}default:s=="font-size"&&(r=T(r,10)+"px");var k=s.replace(/(\-.)/g,function(o){return o.substring(1).toUpperCase()});t.style[k]=r;p._.dirty=1;t.setAttribute(s,r);break}}}Q(p,x);t.style.visibility=m},d=1.2,Q=function(E,h){if(E.type!="text"||!(h[D]("text")||h[D]("font")||h[D]("font-size")||h[D]("x")||h[D]("y"))){return }var n=E.attrs,S=E.node,p=S.firstChild?T(M._g.doc.defaultView.getComputedStyle(S.firstChild,U).getPropertyValue("font-size"),10):10;if(h[D]("text")){n.text=h.text;while(S.firstChild){S.removeChild(S.firstChild)}var g=e(h.text).split("\n"),R=[],l;for(var j=0,o=g.length;j<o;j++){l=J("tspan");j&&J(l,{dy:p*d,x:n.x});l.appendChild(M._g.doc.createTextNode(g[j]));S.appendChild(l);R[j]=l}}else{R=S.getElementsByTagName("tspan");for(j=0,o=R.length;j<o;j++){if(j){J(R[j],{dy:p*d,x:n.x})}else{J(R[0],{dy:0})}}}J(S,{x:n.x,y:n.y});E._.dirty=1;var k=E._getBBox(),m=n.y-(k.y+k.height/2);m&&M.is(m,"finite")&&J(R[0],{dy:m})},W=function(R,E){var g=0,S=0;this[0]=this.node=R;R.raphael=true;this.id=M._oid++;R.raphaelid=this.id;this.matrix=M.matrix();this.realPath=null;this.paper=E;this.attrs=this.attrs||{};this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1};!E.bottom&&(E.bottom=this);this.prev=E.top;E.top&&(E.top.next=this);E.top=this;this.next=null},N=M.el;W.prototype=N;N.constructor=W;M._engine.path=function(E,g){var R=J("path");g.canvas&&g.canvas.appendChild(R);var S=new W(R,g);S.type="path";Z(S,{fill:"none",stroke:"#000",path:E});return S};N.rotate=function(R,E,g){if(this.removed){return this}R=e(R).split(H);if(R.length-1){E=O(R[1]);g=O(R[2])}R=O(R[0]);(g==null)&&(E=g);if(E==null||g==null){var S=this.getBBox(1);E=S.x+S.width/2;g=S.y+S.height/2}this.transform(this._.transform.concat([["r",R,E,g]]));return this};N.scale=function(h,S,E,g){if(this.removed){return this}h=e(h).split(H);if(h.length-1){S=O(h[1]);E=O(h[2]);g=O(h[3])}h=O(h[0]);(S==null)&&(S=h);(g==null)&&(E=g);if(E==null||g==null){var R=this.getBBox(1)}E=E==null?R.x+R.width/2:E;g=g==null?R.y+R.height/2:g;this.transform(this._.transform.concat([["s",h,S,E,g]]));return this};N.translate=function(R,E){if(this.removed){return this}R=e(R).split(H);if(R.length-1){E=O(R[1])}R=O(R[0])||0;E=+E||0;this.transform(this._.transform.concat([["t",R,E]]));return this};N.transform=function(R){var S=this._;if(R==null){return S.transform}M._extractTransform(this,R);this.clip&&J(this.clip,{transform:this.matrix.invert()});this.pattern&&B(this);this.node&&J(this.node,{transform:this.matrix});if(S.sx!=1||S.sy!=1){var E=this.attrs[D]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":E})}return this};N.hide=function(){!this.removed&&this.paper.safari(this.node.style.display="none");return this};N.show=function(){!this.removed&&this.paper.safari(this.node.style.display="");return this};N.remove=function(){if(this.removed||!this.node.parentNode){return }var R=this.paper;R.__set__&&R.__set__.exclude(this);c.unbind("raphael.*.*."+this.id);if(this.gradient){R.defs.removeChild(this.gradient)}M._tear(this,R);if(this.node.parentNode.tagName.toLowerCase()=="a"){this.node.parentNode.parentNode.removeChild(this.node.parentNode)}else{this.node.parentNode.removeChild(this.node)}for(var E in this){this[E]=typeof this[E]=="function"?M._removedFactory(E):null}this.removed=true};N._getBBox=function(){if(this.node.style.display=="none"){this.show();var E=true}var S={};try{S=this.node.getBBox()}catch(R){}finally{S=S||{}}E&&this.hide();return S};N.attr=function(E,n){if(this.removed){return this}if(E==null){var k={};for(var m in this.attrs){if(this.attrs[D](m)){k[m]=this.attrs[m]}}k.gradient&&k.fill=="none"&&(k.fill=k.gradient)&&delete k.gradient;k.transform=this._.transform;return k}if(n==null&&M.is(E,"string")){if(E=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient){return this.attrs.gradient}if(E=="transform"){return this._.transform}var l=E.split(H),g={};for(var h=0,p=l.length;h<p;h++){E=l[h];if(E in this.attrs){g[E]=this.attrs[E]}else{if(M.is(this.paper.customAttributes[E],"function")){g[E]=this.paper.customAttributes[E].def}else{g[E]=M._availableAttrs[E]}}}return p-1?g:g[l[0]]}if(n==null&&M.is(E,"array")){g={};for(h=0,p=E.length;h<p;h++){g[E[h]]=this.attr(E[h])}return g}if(n!=null){var R={};R[E]=n}else{if(E!=null&&M.is(E,"object")){R=E}}for(var o in R){c("raphael.attr."+o+"."+this.id,this,R[o])}for(o in this.paper.customAttributes){if(this.paper.customAttributes[D](o)&&R[D](o)&&M.is(this.paper.customAttributes[o],"function")){var j=this.paper.customAttributes[o].apply(this,[].concat(R[o]));this.attrs[o]=R[o];for(var S in j){if(j[D](S)){R[S]=j[S]}}}}Z(this,R);return this};N.toFront=function(){if(this.removed){return this}if(this.node.parentNode.tagName.toLowerCase()=="a"){this.node.parentNode.parentNode.appendChild(this.node.parentNode)}else{this.node.parentNode.appendChild(this.node)}var E=this.paper;E.top!=this&&M._tofront(this,E);return this};N.toBack=function(){if(this.removed){return this}var R=this.node.parentNode;if(R.tagName.toLowerCase()=="a"){R.parentNode.insertBefore(this.node.parentNode,this.node.parentNode.parentNode.firstChild)}else{if(R.firstChild!=this.node){R.insertBefore(this.node,this.node.parentNode.firstChild)}}M._toback(this,this.paper);var E=this.paper;return this};N.insertAfter=function(E){if(this.removed){return this}var R=E.node||E[E.length-1].node;if(R.nextSibling){R.parentNode.insertBefore(this.node,R.nextSibling)}else{R.parentNode.appendChild(this.node)}M._insertafter(this,E,this.paper);return this};N.insertBefore=function(E){if(this.removed){return this}var R=E.node||E[0].node;R.parentNode.insertBefore(this.node,R);M._insertbefore(this,E,this.paper);return this};N.blur=function(R){var E=this;if(+R!==0){var S=J("filter"),g=J("feGaussianBlur");E.attrs.blur=R;S.id=M.createUUID();J(g,{stdDeviation:+R||1.5});S.appendChild(g);E.paper.defs.appendChild(S);E._blur=S;J(E.node,{filter:"url(#"+S.id+")"})}else{if(E._blur){E._blur.parentNode.removeChild(E._blur);delete E._blur;delete E.attrs.blur}E.node.removeAttribute("filter")}};M._engine.circle=function(R,E,i,h){var g=J("circle");R.canvas&&R.canvas.appendChild(g);var S=new W(g,R);S.attrs={cx:E,cy:i,r:h,fill:"none",stroke:"#000"};S.type="circle";J(g,S.attrs);return S};M._engine.rect=function(S,E,l,R,j,k){var i=J("rect");S.canvas&&S.canvas.appendChild(i);var g=new W(i,S);g.attrs={x:E,y:l,width:R,height:j,r:k||0,rx:k||0,ry:k||0,fill:"none",stroke:"#000"};g.type="rect";J(i,g.attrs);return g};M._engine.ellipse=function(R,E,j,i,h){var g=J("ellipse");R.canvas&&R.canvas.appendChild(g);var S=new W(g,R);S.attrs={cx:E,cy:j,rx:i,ry:h,fill:"none",stroke:"#000"};S.type="ellipse";J(g,S.attrs);return S};M._engine.image=function(S,k,E,l,R,j){var i=J("image");J(i,{x:E,y:l,width:R,height:j,preserveAspectRatio:"none"});i.setAttributeNS(P,"href",k);S.canvas&&S.canvas.appendChild(i);var g=new W(i,S);g.attrs={x:E,y:l,width:R,height:j,src:k};g.type="image";return g};M._engine.text=function(R,E,i,h){var g=J("text");R.canvas&&R.canvas.appendChild(g);var S=new W(g,R);S.attrs={x:E,y:i,"text-anchor":"middle",text:h,font:M._availableAttrs.font,stroke:"none",fill:"#000"};S.type="text";Z(S,S.attrs);return S};M._engine.setSize=function(R,E){this.width=R||this.width;this.height=E||this.height;this.canvas.setAttribute("width",this.width);this.canvas.setAttribute("height",this.height);if(this._viewBox){this.setViewBox.apply(this,this._viewBox)}return this};M._engine.create=function(){var g=M._getContainer.apply(0,arguments),R=g&&g.container,k=g.x,j=g.y,S=g.width,l=g.height;if(!R){throw new Error("SVG container not found.")}var E=J("svg"),i="overflow:hidden;",h;k=k||0;j=j||0;S=S||512;l=l||342;J(E,{height:l,version:1.1,width:S,xmlns:"http://www.w3.org/2000/svg"});if(R==1){E.style.cssText=i+"position:absolute;left:"+k+"px;top:"+j+"px";M._g.doc.body.appendChild(E);h=1}else{E.style.cssText=i+"position:relative";if(R.firstChild){R.insertBefore(E,R.firstChild)}else{R.appendChild(E)}}R=new M._Paper;R.width=S;R.height=l;R.canvas=E;R.clear();R._left=R._top=0;h&&(R.renderfix=function(){});R.renderfix();return R};M._engine.setViewBox=function(j,g,l,E,R){c("raphael.setViewBox",this,this._viewBox,[j,g,l,E,R]);var n=f(l/this.width,E/this.height),i=this.top,m=R?"meet":"xMinYMin",S,k;if(j==null){if(this._vbSize){n=1}delete this._vbSize;S="0 0 "+this.width+K+this.height}else{this._vbSize=n;S=j+K+g+K+l+K+E}J(this.canvas,{viewBox:S,preserveAspectRatio:m});while(n&&i){k="stroke-width" in i.attrs?i.attrs["stroke-width"]:1;i.attr({"stroke-width":k});i._.dirty=1;i._.dirtyT=1;i=i.prev}this._viewBox=[j,g,l,E,!!R];return this};M.prototype.renderfix=function(){var i=this.canvas,E=i.style,h;try{h=i.getScreenCTM()||i.createSVGMatrix()}catch(g){h=i.createSVGMatrix()}var S=-h.e%1,R=-h.f%1;if(S||R){if(S){this._left=(this._left+S)%1;E.left=this._left+"px"}if(R){this._top=(this._top+R)%1;E.top=this._top+"px"}}};M.prototype.clear=function(){M.eve("raphael.clear",this);var E=this.canvas;while(E.firstChild){E.removeChild(E.firstChild)}this.bottom=this.top=null;(this.desc=J("desc")).appendChild(M._g.doc.createTextNode("Created with Rapha\xebl "+M.version));E.appendChild(this.desc);E.appendChild(this.defs=J("defs"))};M.prototype.remove=function(){c("raphael.remove",this);this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var E in this){this[E]=typeof this[E]=="function"?M._removedFactory(E):null}};var a=M.st;for(var F in N){if(N[D](F)&&!a[D](F)){a[F]=(function(E){return function(){var R=arguments;return this.forEach(function(S){S[E].apply(S,R)})}})(F)}}}(window.Raphael);window.Raphael&&window.Raphael.vml&&function(M){var F="hasOwnProperty",h=String,O=parseFloat,I=Math,e=I.round,k=I.max,f=I.min,V=I.abs,Y="fill",J=/[, ]+/,d=M.eve,Z=" progid:DXImageTransform.Microsoft",L=" ",T="",g={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},K=/([clmz]),?([^clmz]*)/gi,W=/ progid:\S+Blur\([^\)]+\)/g,j=/-?[^,\s-]+/g,D="position:absolute;left:0;top:0;width:1px;height:1px",B=21600,c={path:1,rect:1,image:1},U={circle:1,ellipse:1},G=function(u){var q=/[ahqstv]/ig,S=M._pathToAbsolute;h(u).match(q)&&(S=M._path2curve);q=/[clmz]/g;if(S==M._pathToAbsolute&&!h(u).match(q)){var o=h(u).replace(K,function(w,y,r){var x=[],p=y.toLowerCase()=="m",v=g[y];r.replace(j,function(z){if(p&&x.length==2){v+=x+g[y=="m"?"l":"L"];x=[]}x.push(e(z*B))});return v+x});return o}var s=S(u),R,E;o=[];for(var m=0,t=s.length;m<t;m++){R=s[m];E=s[m][0].toLowerCase();E=="z"&&(E="x");for(var l=1,n=R.length;l<n;l++){E+=e(R[l]*B)+(l!=n-1?",":T)}o.push(E)}return o.join(L)},P=function(l,S,R){var E=M.matrix();E.rotate(-l,0.5,0.5);return{dx:E.x(S,R),dy:E.y(S,R)}},Q=function(v,u,t,n,l,q){var AE=v._,x=v.matrix,E=AE.fillpos,w=v.node,r=w.style,S=1,R="",AA,AC=B/u,AB=B/t;r.visibility="hidden";if(!u||!t){return }w.coordsize=V(AC)+L+V(AB);r.rotation=q*(u*t<0?-1:1);if(q){var AD=P(q,n,l);n=AD.dx;l=AD.dy}u<0&&(R+="x");t<0&&(R+=" y")&&(S=-1);r.flip=R;w.coordorigin=(n*-AC)+L+(l*-AB);if(E||AE.fillsize){var z=w.getElementsByTagName(Y);z=z&&z[0];w.removeChild(z);if(E){AD=P(q,x.x(E[0],E[1]),x.y(E[0],E[1]));z.position=AD.dx*S+L+AD.dy*S}if(AE.fillsize){z.size=AE.fillsize[0]*V(u)+L+AE.fillsize[1]*V(t)}w.appendChild(z)}r.visibility="visible"};M.toString=function(){return"Your browser doesn\u2019t support SVG. Falling down to VML.\nYou are running Rapha\xebl "+this.version};var C=function(E,p,R){var r=h(p).toLowerCase().split("-"),m=R?"end":"start",S=r.length,n="classic",q="medium",l="medium";while(S--){switch(r[S]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":n=r[S];break;case"wide":case"narrow":l=r[S];break;case"long":case"short":q=r[S];break}}var s=E.node.getElementsByTagName("stroke")[0];s[m+"arrow"]=n;s[m+"arrowlength"]=q;s[m+"arrowwidth"]=l},a=function(AC,AM){AC.attrs=AC.attrs||{};var AH=AC.node,AQ=AC.attrs,y=AH.style,u,AK=c[AC.type]&&(AM.x!=AQ.x||AM.y!=AQ.y||AM.width!=AQ.width||AM.height!=AQ.height||AM.cx!=AQ.cx||AM.cy!=AQ.cy||AM.rx!=AQ.rx||AM.ry!=AQ.ry||AM.r!=AQ.r),AB=U[AC.type]&&(AQ.cx!=AM.cx||AQ.cy!=AM.cy||AQ.r!=AM.r||AQ.rx!=AM.rx||AQ.ry!=AM.ry),AT=AC;for(var z in AM){if(AM[F](z)){AQ[z]=AM[z]}}if(AK){AQ.path=M._getPath[AC.type](AC);AC._.dirty=1}AM.href&&(AH.href=AM.href);AM.title&&(AH.title=AM.title);AM.target&&(AH.target=AM.target);AM.cursor&&(y.cursor=AM.cursor);"blur" in AM&&AC.blur(AM.blur);if(AM.path&&AC.type=="path"||AK){AH.path=G(~h(AQ.path).toLowerCase().indexOf("r")?M._pathToAbsolute(AQ.path):AQ.path);if(AC.type=="image"){AC._.fillpos=[AQ.x,AQ.y];AC._.fillsize=[AQ.width,AQ.height];Q(AC,1,1,0,0,0)}}"transform" in AM&&AC.transform(AM.transform);if(AB){var n=+AQ.cx,S=+AQ.cy,t=+AQ.rx||+AQ.r||0,r=+AQ.ry||+AQ.r||0;AH.path=M.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",e((n-t)*B),e((S-r)*B),e((n+t)*B),e((S+r)*B),e(n*B))}if("clip-rect" in AM){var R=h(AM["clip-rect"]).split(J);if(R.length==4){R[2]=+R[2]+(+R[0]);R[3]=+R[3]+(+R[1]);var AA=AH.clipRect||M._g.doc.createElement("div"),AS=AA.style;AS.clip=M.format("rect({1}px {2}px {3}px {0}px)",R);if(!AH.clipRect){AS.position="absolute";AS.top=0;AS.left=0;AS.width=AC.paper.width+"px";AS.height=AC.paper.height+"px";AH.parentNode.insertBefore(AA,AH);AA.appendChild(AH);AH.clipRect=AA}}if(!AM["clip-rect"]){AH.clipRect&&(AH.clipRect.style.clip="auto")}}if(AC.textpath){var AO=AC.textpath.style;AM.font&&(AO.font=AM.font);AM["font-family"]&&(AO.fontFamily='"'+AM["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,T)+'"');AM["font-size"]&&(AO.fontSize=AM["font-size"]);AM["font-weight"]&&(AO.fontWeight=AM["font-weight"]);AM["font-style"]&&(AO.fontStyle=AM["font-style"])}if("arrow-start" in AM){C(AT,AM["arrow-start"])}if("arrow-end" in AM){C(AT,AM["arrow-end"],1)}if(AM.opacity!=null||AM["stroke-width"]!=null||AM.fill!=null||AM.src!=null||AM.stroke!=null||AM["stroke-width"]!=null||AM["stroke-opacity"]!=null||AM["fill-opacity"]!=null||AM["stroke-dasharray"]!=null||AM["stroke-miterlimit"]!=null||AM["stroke-linejoin"]!=null||AM["stroke-linecap"]!=null){var AI=AH.getElementsByTagName(Y),AP=false;AI=AI&&AI[0];!AI&&(AP=AI=i(Y));if(AC.type=="image"&&AM.src){AI.src=AM.src}AM.fill&&(AI.on=true);if(AI.on==null||AM.fill=="none"||AM.fill===null){AI.on=false}if(AI.on&&AM.fill){var q=h(AM.fill).match(M._ISURL);if(q){AI.parentNode==AH&&AH.removeChild(AI);AI.rotate=true;AI.src=q[1];AI.type="tile";var E=AC.getBBox(1);AI.position=E.x+L+E.y;AC._.fillpos=[E.x,E.y];M._preload(q[1],function(){AC._.fillsize=[this.offsetWidth,this.offsetHeight]})}else{AI.color=M.getRGB(AM.fill).hex;AI.src=T;AI.type="solid";if(M.getRGB(AM.fill).error&&(AT.type in {circle:1,ellipse:1}||h(AM.fill).charAt()!="r")&&A(AT,AM.fill,AI)){AQ.fill="none";AQ.gradient=AM.fill;AI.rotate=false}}}if("fill-opacity" in AM||"opacity" in AM){var p=((+AQ["fill-opacity"]+1||2)-1)*((+AQ.opacity+1||2)-1)*((+M.getRGB(AM.fill).o+1||2)-1);p=f(k(p,0),1);AI.opacity=p;if(AI.src){AI.color="none"}}AH.appendChild(AI);var v=(AH.getElementsByTagName("stroke")&&AH.getElementsByTagName("stroke")[0]),AR=false;!v&&(AR=v=i("stroke"));if((AM.stroke&&AM.stroke!="none")||AM["stroke-width"]||AM["stroke-opacity"]!=null||AM["stroke-dasharray"]||AM["stroke-miterlimit"]||AM["stroke-linejoin"]||AM["stroke-linecap"]){v.on=true}(AM.stroke=="none"||AM.stroke===null||v.on==null||AM.stroke==0||AM["stroke-width"]==0)&&(v.on=false);var AG=M.getRGB(AM.stroke);v.on&&AM.stroke&&(v.color=AG.hex);p=((+AQ["stroke-opacity"]+1||2)-1)*((+AQ.opacity+1||2)-1)*((+AG.o+1||2)-1);var AD=(O(AM["stroke-width"])||1)*0.75;p=f(k(p,0),1);AM["stroke-width"]==null&&(AD=AQ["stroke-width"]);AM["stroke-width"]&&(v.weight=AD);AD&&AD<1&&(p*=AD)&&(v.weight=1);v.opacity=p;AM["stroke-linejoin"]&&(v.joinstyle=AM["stroke-linejoin"]||"miter");v.miterlimit=AM["stroke-miterlimit"]||8;AM["stroke-linecap"]&&(v.endcap=AM["stroke-linecap"]=="butt"?"flat":AM["stroke-linecap"]=="square"?"square":"round");if(AM["stroke-dasharray"]){var AF={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};v.dashstyle=AF[F](AM["stroke-dasharray"])?AF[AM["stroke-dasharray"]]:T}AR&&AH.appendChild(v)}if(AT.type=="text"){AT.paper.canvas.style.display=T;var AJ=AT.paper.span,AE=100,l=AQ.font&&AQ.font.match(/\d+(?:\.\d*)?(?=px)/);y=AJ.style;AQ.font&&(y.font=AQ.font);AQ["font-family"]&&(y.fontFamily=AQ["font-family"]);AQ["font-weight"]&&(y.fontWeight=AQ["font-weight"]);AQ["font-style"]&&(y.fontStyle=AQ["font-style"]);l=O(AQ["font-size"]||l&&l[0])||10;y.fontSize=l*AE+"px";AT.textpath.string&&(AJ.innerHTML=h(AT.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var x=AJ.getBoundingClientRect();AT.W=AQ.w=(x.right-x.left)/AE;AT.H=AQ.h=(x.bottom-x.top)/AE;AT.X=AQ.x;AT.Y=AQ.y+AT.H/2;("x" in AM||"y" in AM)&&(AT.path.v=M.format("m{0},{1}l{2},{1}",e(AQ.x*B),e(AQ.y*B),e(AQ.x*B)+1));var w=["x","y","text","font","font-family","font-weight","font-style","font-size"];for(var AL=0,AN=w.length;AL<AN;AL++){if(w[AL] in AM){AT._.dirty=1;break}}switch(AQ["text-anchor"]){case"start":AT.textpath.style["v-text-align"]="left";AT.bbx=AT.W/2;break;case"end":AT.textpath.style["v-text-align"]="right";AT.bbx=-AT.W/2;break;default:AT.textpath.style["v-text-align"]="center";AT.bbx=0;break}AT.textpath.style["v-text-kern"]=true}},A=function(E,s,v){E.attrs=E.attrs||{};var t=E.attrs,l=Math.pow,m,n,q="linear",r=".5 .5";E.attrs.gradient=s;s=h(s).replace(M._radial_gradient,function(x,y,o){q="radial";if(y&&o){y=O(y);o=O(o);l(y-0.5,2)+l(o-0.5,2)>0.25&&(o=I.sqrt(0.25-l(y-0.5,2))*((o>0.5)*2-1)+0.5);r=y+L+o}return T});s=s.split(/\s*\-\s*/);if(q=="linear"){var R=s.shift();R=-O(R);if(isNaN(R)){return null}}var p=M._parseDots(s);if(!p){return null}E=E.shape||E.node;if(p.length){E.removeChild(v);v.on=true;v.method="none";v.color=p[0].color;v.color2=p[p.length-1].color;var w=[];for(var S=0,u=p.length;S<u;S++){p[S].offset&&w.push(p[S].offset+L+p[S].color)}v.colors=w.length?w.join():"0% "+v.color;if(q=="radial"){v.type="gradientTitle";v.focus="100%";v.focussize="0 0";v.focusposition=r;v.angle=0}else{v.type="gradient";v.angle=(270-R)%360}E.appendChild(v)}return 1},X=function(R,E){this[0]=this.node=R;R.raphael=true;this.id=M._oid++;R.raphaelid=this.id;this.X=0;this.Y=0;this.attrs={};this.paper=E;this.matrix=M.matrix();this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1};!E.bottom&&(E.bottom=this);this.prev=E.top;E.top&&(E.top.next=this);E.top=this;this.next=null};var N=M.el;X.prototype=N;N.constructor=X;N.transform=function(m){if(m==null){return this._.transform}var p=this.paper._viewBoxShift,n=p?"s"+[p.scale,p.scale]+"-1-1t"+[p.dx,p.dy]:T,s;if(p){s=m=h(m).replace(/\.{3}|\u2026/g,this._.transform||T)}M._extractTransform(this,n+m);var t=this.matrix.clone(),v=this.skew,S=this.node,r,l=~h(this.attrs.fill).indexOf("-"),E=!h(this.attrs.fill).indexOf("url(");t.translate(-0.5,-0.5);if(E||l||this.type=="image"){v.matrix="1 0 0 1";v.offset="0 0";r=t.split();if((l&&r.noRotation)||!r.isSimple){S.style.filter=t.toFilter();var q=this.getBBox(),R=this.getBBox(1),w=q.x-R.x,u=q.y-R.y;S.coordorigin=(w*-B)+L+(u*-B);Q(this,1,1,w,u,0)}else{S.style.filter=T;Q(this,r.scalex,r.scaley,r.dx,r.dy,r.rotate)}}else{S.style.filter=T;v.matrix=h(t);v.offset=t.offset()}s&&(this._.transform=s);return this};N.rotate=function(R,E,l){if(this.removed){return this}if(R==null){return }R=h(R).split(J);if(R.length-1){E=O(R[1]);l=O(R[2])}R=O(R[0]);(l==null)&&(E=l);if(E==null||l==null){var S=this.getBBox(1);E=S.x+S.width/2;l=S.y+S.height/2}this._.dirtyT=1;this.transform(this._.transform.concat([["r",R,E,l]]));return this};N.translate=function(R,E){if(this.removed){return this}R=h(R).split(J);if(R.length-1){E=O(R[1])}R=O(R[0])||0;E=+E||0;if(this._.bbox){this._.bbox.x+=R;this._.bbox.y+=E}this.transform(this._.transform.concat([["t",R,E]]));return this};N.scale=function(m,S,E,l){if(this.removed){return this}m=h(m).split(J);if(m.length-1){S=O(m[1]);E=O(m[2]);l=O(m[3]);isNaN(E)&&(E=null);isNaN(l)&&(l=null)}m=O(m[0]);(S==null)&&(S=m);(l==null)&&(E=l);if(E==null||l==null){var R=this.getBBox(1)}E=E==null?R.x+R.width/2:E;l=l==null?R.y+R.height/2:l;this.transform(this._.transform.concat([["s",m,S,E,l]]));this._.dirtyT=1;return this};N.hide=function(){!this.removed&&(this.node.style.display="none");return this};N.show=function(){!this.removed&&(this.node.style.display=T);return this};N._getBBox=function(){if(this.removed){return{}}return{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}};N.remove=function(){if(this.removed||!this.node.parentNode){return }this.paper.__set__&&this.paper.__set__.exclude(this);M.eve.unbind("raphael.*.*."+this.id);M._tear(this,this.paper);this.node.parentNode.removeChild(this.node);this.shape&&this.shape.parentNode.removeChild(this.shape);for(var E in this){this[E]=typeof this[E]=="function"?M._removedFactory(E):null}this.removed=true};N.attr=function(E,r){if(this.removed){return this}if(E==null){var o={};for(var q in this.attrs){if(this.attrs[F](q)){o[q]=this.attrs[q]}}o.gradient&&o.fill=="none"&&(o.fill=o.gradient)&&delete o.gradient;o.transform=this._.transform;return o}if(r==null&&M.is(E,"string")){if(E==Y&&this.attrs.fill=="none"&&this.attrs.gradient){return this.attrs.gradient}var p=E.split(J),l={};for(var m=0,t=p.length;m<t;m++){E=p[m];if(E in this.attrs){l[E]=this.attrs[E]}else{if(M.is(this.paper.customAttributes[E],"function")){l[E]=this.paper.customAttributes[E].def}else{l[E]=M._availableAttrs[E]}}}return t-1?l:l[p[0]]}if(this.attrs&&r==null&&M.is(E,"array")){l={};for(m=0,t=E.length;m<t;m++){l[E[m]]=this.attr(E[m])}return l}var R;if(r!=null){R={};R[E]=r}r==null&&M.is(E,"object")&&(R=E);for(var s in R){d("raphael.attr."+s+"."+this.id,this,R[s])}if(R){for(s in this.paper.customAttributes){if(this.paper.customAttributes[F](s)&&R[F](s)&&M.is(this.paper.customAttributes[s],"function")){var n=this.paper.customAttributes[s].apply(this,[].concat(R[s]));this.attrs[s]=R[s];for(var S in n){if(n[F](S)){R[S]=n[S]}}}}if(R.text&&this.type=="text"){this.textpath.string=R.text}a(this,R)}return this};N.toFront=function(){!this.removed&&this.node.parentNode.appendChild(this.node);this.paper&&this.paper.top!=this&&M._tofront(this,this.paper);return this};N.toBack=function(){if(this.removed){return this}if(this.node.parentNode.firstChild!=this.node){this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild);M._toback(this,this.paper)}return this};N.insertAfter=function(E){if(this.removed){return this}if(E.constructor==M.st.constructor){E=E[E.length-1]}if(E.node.nextSibling){E.node.parentNode.insertBefore(this.node,E.node.nextSibling)}else{E.node.parentNode.appendChild(this.node)}M._insertafter(this,E,this.paper);return this};N.insertBefore=function(E){if(this.removed){return this}if(E.constructor==M.st.constructor){E=E[0]}E.node.parentNode.insertBefore(this.node,E.node);M._insertbefore(this,E,this.paper);return this};N.blur=function(E){var R=this.node.runtimeStyle,S=R.filter;S=S.replace(W,T);if(+E!==0){this.attrs.blur=E;R.filter=S+L+Z+".Blur(pixelradius="+(+E||1.5)+")";R.margin=M.format("-{0}px 0 0 -{0}px",e(+E||1.5))}else{R.filter=S;R.margin=0;delete this.attrs.blur}};M._engine.path=function(l,R){var m=i("shape");m.style.cssText=D;m.coordsize=B+L+B;m.coordorigin=R.coordorigin;var n=new X(m,R),E={fill:"none",stroke:"#000"};l&&(E.path=l);n.type="path";n.path=[];n.Path=T;a(n,E);R.canvas.appendChild(m);var S=i("skew");S.on=true;m.appendChild(S);n.skew=S;n.transform(T);return n};M._engine.rect=function(R,o,m,p,S,E){var q=M._rectPath(o,m,p,S,E),l=R.path(q),n=l.attrs;l.X=n.x=o;l.Y=n.y=m;l.W=n.width=p;l.H=n.height=S;n.r=E;n.path=q;l.type="rect";return l};M._engine.ellipse=function(R,E,o,n,m){var l=R.path(),S=l.attrs;l.X=E-n;l.Y=o-m;l.W=n*2;l.H=m*2;l.type="ellipse";a(l,{cx:E,cy:o,rx:n,ry:m});return l};M._engine.circle=function(R,E,n,m){var l=R.path(),S=l.attrs;l.X=E-m;l.Y=n-m;l.W=l.H=m*2;l.type="circle";a(l,{cx:E,cy:n,r:m});return l};M._engine.image=function(R,E,p,n,q,l){var s=M._rectPath(p,n,q,l),m=R.path(s).attr({stroke:"none"}),o=m.attrs,S=m.node,r=S.getElementsByTagName(Y)[0];o.src=E;m.X=o.x=p;m.Y=o.y=n;m.W=o.width=q;m.H=o.height=l;o.path=s;m.type="image";r.parentNode==S&&S.removeChild(r);r.rotate=true;r.src=E;r.type="tile";m._.fillpos=[p,n];m._.fillsize=[q,l];S.appendChild(r);Q(m,1,1,0,0,0);return m};M._engine.text=function(E,q,n,r){var l=i("shape"),t=i("path"),S=i("textpath");q=q||0;n=n||0;r=r||"";t.v=M.format("m{0},{1}l{2},{1}",e(q*B),e(n*B),e(q*B)+1);t.textpathok=true;S.string=h(r);S.on=true;l.style.cssText=D;l.coordsize=B+L+B;l.coordorigin="0 0";var R=new X(l,E),m={fill:"#000",stroke:"none",font:M._availableAttrs.font,text:r};R.shape=l;R.path=t;R.textpath=S;R.type="text";R.attrs.text=h(r);R.attrs.x=q;R.attrs.y=n;R.attrs.w=1;R.attrs.h=1;a(R,m);l.appendChild(S);l.appendChild(t);E.canvas.appendChild(l);var s=i("skew");s.on=true;l.appendChild(s);R.skew=s;R.transform(T);return R};M._engine.setSize=function(S,E){var R=this.canvas.style;this.width=S;this.height=E;S==+S&&(S+="px");E==+E&&(E+="px");R.width=S;R.height=E;R.clip="rect(0 "+S+" "+E+" 0)";if(this._viewBox){M._engine.setViewBox.apply(this,this._viewBox)}return this};M._engine.setViewBox=function(n,m,o,S,l){M.eve("raphael.setViewBox",this,this._viewBox,[n,m,o,S,l]);var E=this.width,q=this.height,r=1/k(o/E,S/q),p,R;if(l){p=q/S;R=E/o;if(o*p<E){n-=(E-o*p)/2/p}if(S*R<q){m-=(q-S*R)/2/R}}this._viewBox=[n,m,o,S,!!l];this._viewBoxShift={dx:-n,dy:-m,scale:r};this.forEach(function(s){s.transform("...")});return this};var i;M._engine.initWin=function(S){var R=S.document;R.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!R.namespaces.rvml&&R.namespaces.add("rvml","urn:schemas-microsoft-com:vml");i=function(l){return R.createElement("<rvml:"+l+' class="rvml">')}}catch(E){i=function(l){return R.createElement("<"+l+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}};M._engine.initWin(M._g.win);M._engine.create=function(){var S=M._getContainer.apply(0,arguments),E=S.container,q=S.height,r,R=S.width,p=S.x,o=S.y;if(!E){throw new Error("VML container not found.")}var m=new M._Paper,n=m.canvas=M._g.doc.createElement("div"),l=n.style;p=p||0;o=o||0;R=R||512;q=q||342;m.width=R;m.height=q;R==+R&&(R+="px");q==+q&&(q+="px");m.coordsize=B*1000+L+B*1000;m.coordorigin="0 0";m.span=M._g.doc.createElement("span");m.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;";n.appendChild(m.span);l.cssText=M.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",R,q);if(E==1){M._g.doc.body.appendChild(n);l.left=p+"px";l.top=o+"px";l.position="absolute"}else{if(E.firstChild){E.insertBefore(n,E.firstChild)}else{E.appendChild(n)}}m.renderfix=function(){};return m};M.prototype.clear=function(){M.eve("raphael.clear",this);this.canvas.innerHTML=T;this.span=M._g.doc.createElement("span");this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";this.canvas.appendChild(this.span);this.bottom=this.top=null};M.prototype.remove=function(){M.eve("raphael.remove",this);this.canvas.parentNode.removeChild(this.canvas);for(var E in this){this[E]=typeof this[E]=="function"?M._removedFactory(E):null}return true};var b=M.st;for(var H in N){if(N[F](H)&&!b[F](H)){b[H]=(function(E){return function(){var R=arguments;return this.forEach(function(S){S[E].apply(S,R)})}})(H)}}}(window.Raphael);
/* module-key = 'com.atlassian.auiplugin:ajs-contextpath', location = 'js/atlassian/context-path.cp.js' */
AJS=AJS||{};(function(){var A="";A=(A.indexOf("%_CONTEXT_PATH")==0?false:A);AJS.contextPath=function(){var B=null;var D=[A,window.contextPath,window.Confluence&&Confluence.getContextPath(),window.BAMBOO&&BAMBOO.contextPath,window.FECRU&&FECRU.pageContext];for(var C=0;C<D.length;C++){if(typeof D[C]==="string"){B=D[C];break}}return B}})();
/* module-key = 'com.atlassian.auiplugin:aui-header', location = '${pdl.dir}js/atlassian/aui-header-responsive.js' */
AJS.$(function(C){var B=C(".aui-header");if(!B.length){return }B.each(function(D,E){A(C(E),D)});function A(J,O){var T=J.find(".aui-header-secondary .aui-nav").first();C(".aui-header").attr("data-aui-responsive","true");var U=[];var E=0;var H=0;var L;var I;var Q=J.find("#logo");var P=0;var N=(function(){var W=J.find(".aui-header-primary").first();return function(X){return W.find(X)}})();var S=0;N(".aui-button").each(function(W,X){S+=C(X).parent().outerWidth(true)});N(".aui-nav > li > a:not(.aui-button)").each(function(X,Y){var W=C(Y).parent();var Z=W.outerWidth(true);U.push({itemElement:W,itemWidth:Z});H+=Z});I=U.length;C(window).resize(function(){I=F(O)});D(O);var V=Q.find("img");if(V.length!==0){V.attr("data-aui-responsive-header-index",O);V.load(function(W){I=F(O)})}I=F(O);N(".aui-nav").css("width","auto");function F(Y){var X;R();if(E>H){M(Y)}else{L.show();X=E-P;for(var W=0;X>=0;W++){X-=U[W].itemWidth}W=W-1;K(W,Y);G(W,I,Y);return W}}function R(){var X=T.length!=0?T.position().left:C(window).width();var W=Q.position().left+Q.outerWidth(true)+S;E=X-W}function D(X){var W=C("<li>"+aui.dropdown2.trigger({menu:{id:"aui-responsive-header-dropdown-content-"+X},text:"More",extraAttributes:{href:"#"},id:"aui-responsive-header-dropdown-trigger-"+X})+"</li>");W.append(aui.dropdown2.contents({id:"aui-responsive-header-dropdown-content-"+X,extraClasses:"aui-style-default",content:aui.dropdown2.section({content:"<ul id='aui-responsive-header-dropdown-list-"+X+"'></ul>"})}));if(S==0){W.appendTo(N(".aui-nav"))}else{W.insertBefore(N(".aui-nav > li > .aui-button").first().parent())}L=W;P=L.outerWidth(true)}function G(W,b,d){if(W<0||b<0||W===b){return }var Z=C("#aui-responsive-header-dropdown-trigger-"+d);var c=Z.parent();var a;var X;if(Z.hasClass("active")){Z.trigger("aui-button-invoke")}var Y=N(".aui-nav > li > a:not(.aui-button):not(#aui-responsive-header-dropdown-trigger-"+d+")").length;while(W>b){a=U[b];if(a&&a.itemElement){X=a.itemElement;if(Y==0){X.prependTo(N(".aui-nav"))}else{X.insertBefore(c)}X.children("a").removeClass("aui-dropdown2-sub-trigger active");b=b+1;Y=Y+1}}}function K(W,a){if(W<0){return }var Y=C("#aui-responsive-header-dropdown-list-"+a);for(var X=W;X<U.length;X++){U[X].itemElement.appendTo(Y);var Z=U[X].itemElement.children("a");if(Z.hasClass("aui-dropdown2-trigger")){Z.addClass("aui-dropdown2-sub-trigger")}}}function M(W){L.hide();G(U.length,I,W)}}});
/* module-key = 'com.atlassian.auiplugin:aui-dropdown2', location = 'js/atlassian/dropdown2.js' */
(function(G){var E=G(document),K=(AJS.$.browser.msie&&parseInt(AJS.$.browser.version,10)==8);var C=null;function I(M){M.preventDefault()}var B=(function(){var O=false;function M(Q){if(!O&&Q.which===1){O=true;E.bind("mouseup mouseleave",N);G(this).trigger("aui-button-invoke")}}function N(){E.unbind("mouseup mouseleave",N);setTimeout(function(){O=false},0)}function P(){if(!O){G(this).trigger("aui-button-invoke")}}if(typeof document.addEventListener==="undefined"){return{click:P,"click selectstart":I,mousedown:function(S){M.call(this,S);var T=this;var R=document.activeElement;if(R!==null){R.attachEvent("onbeforedeactivate",Q);setTimeout(function(){R.detachEvent("onbeforedeactivate",Q)},0)}function Q(U){switch(U.toElement){case null:case T:case document.body:case document.documentElement:U.returnValue=false}}}}}return{click:P,"click mousedown":I,mousedown:M}})();var A={"aui-button-invoke":function(i,S){S=G.extend({selectFirst:true},S);var P=J(this);var O=G(this).addClass("active");var s=O.hasClass("aui-dropdown2-sub-trigger");var n=P.parent()[0];var q=P.next()[0];var e=G(this).attr("data-dropdown2-hide-location");if(e){var a=document.getElementById(e);if(a){n=G(a);q=undefined}else{throw new Error("The specified data-dropdown2-hide-location id doesn't exist")}}var U=S.$menu||O.closest(".aui-dropdown2-trigger-group");if(s){var f=O.closest(".aui-dropdown2");P.addClass(f.attr("class")).addClass("aui-dropdown2-sub-menu")}var T={click:function(u){var t=G(this);if(!Q(t)){return }if(!t.hasClass("interactive")){m()}if(W(t)){g(t,{selectFirst:false});I(u)}},mousemove:function(){var u=G(this);var t=V(u);if(t){g(u,{selectFirst:false})}}};var o={"click focusin mousedown":function(t){var u=t.target;if(document===u&&t.type==="focusin"){return }if(!D(u,P[0])&&!D(u,O[0])){m()}},keydown:function(v){if(v.shiftKey&&v.keyCode==9){k(-1)}else{switch(v.keyCode){case 13:var u=Z();if(W(u)){g(u)}else{L(u[0])}break;case 27:b();break;case 37:var u=Z();if(W(u)){var t=J(u);if(t.is(":visible")){P.trigger("aui-dropdown2-step-out");return }}if(s){b()}else{r(-1)}break;case 38:k(-1);break;case 39:var u=Z();if(W(u)){g(u)}else{r(1)}break;case 40:k(1);break;case 9:k(1);break;default:return }}I(v)}};function d(t,u){t.each(function(){var v=G(this);v.attr("role",u);if(v.hasClass("checked")){v.attr("aria-checked","true");if(u=="radio"){v.closest("ul").attr("role","radiogroup")}}else{v.attr("aria-checked","false")}})}O.attr("aria-controls",O.attr("aria-owns"));if(K){P.removeClass("aui-dropdown2-tailed")}P.find(".disabled").attr("aria-disabled","true");P.find("li.hidden > a").addClass("disabled").attr("aria-disabled","true");d(P.find(".aui-dropdown2-checkbox"),"checkbox");d(P.find(".aui-dropdown2-radio"),"radio");function R(){var AC=O.offset();var AG=O.outerWidth();var AF=P.outerWidth();var AB=G("body").outerWidth(true);var u=Math.max(parseInt(P.css("min-width"),10),AG);var v=O.data("container")||false;var AE="left";if(K){var w=parseInt(P.css("border-left-width"),10)+parseInt(P.css("border-right-width"),10);AF=AF-w;u=u-w}if(!s){P.css("min-width",u+"px")}var x=AC.left,AD=AC.top+O.outerHeight();if(s){var z=3;x=AC.left+f.outerWidth()-z;AD=AC.top}if(AB<x+AF&&AF<=x+AG){x=AC.left+AG-AF;if(s){x=AC.left-AF}AE="right"}if(v){var t=O.closest(v),AA=O.offset().left+O.outerWidth(),y=AA+AF;if(u>=AF){AF=u}if(y>AA){x=AA-AF;AE="right"}if(K){x-=w}}P.attr({"data-dropdown2-alignment":AE,"aria-hidden":"false"}).css({display:"block",left:x+"px",top:AD+"px"});P.appendTo(document.body)}R();if(O.hasClass("toolbar-trigger")){P.addClass("aui-dropdown2-in-toolbar")}if(O.parent().hasClass("aui-buttons")){P.addClass("aui-dropdown2-in-buttons")}if(O.parents().hasClass("aui-header")){P.addClass("aui-dropdown2-in-header")}P.trigger("aui-dropdown2-show",S);if(S.selectFirst){N()}j("on");function b(){M();j("off");setTimeout(function(){P.css("display","none").css("min-width","").insertAfter(O).attr("aria-hidden","true");if(!s){O.removeClass("active")}Z().removeClass("active");P.removeClass("aui-dropdown2-in-toolbar");P.removeClass("aui-dropdown2-in-buttons");if(q){P.insertBefore(q)}else{P.appendTo(n)}P.trigger("aui-dropdown2-hide")},0)}function m(){b();if(s){f.trigger("aui-dropdown2-hide-all")}}function h(t){if(s&&t.target===f[0]){b()}}function Q(t){return !t.is(".disabled, [aria-disabled=true]")}function W(t){return t.hasClass("aui-dropdown2-sub-trigger")}function g(t,u){if(!W(t)){return }u=G.extend({},u,{$menu:U});var v=J(t);if(v.is(":visible")){v.trigger("aui-dropdown2-select-first")}else{t.trigger("aui-button-invoke",u)}}function Z(){return P.find("a.active")}var X=null;function V(t){if(X&&X[0]===t[0]){return false}X=t;Z().removeClass("active");if(Q(t)){t.addClass("active")}P.trigger("aui-dropdown2-item-selected");Y();return true}function N(){V(P.find("a:not(.disabled)").first())}function k(u){var t=P.find("> ul > li > a, > .aui-dropdown2-section > ul > li > a").not(".disabled");V(l(t,u,true))}function c(t){if(t.length>0){m();t.trigger("aui-button-invoke")}}function r(t){c(l(U.find(".aui-dropdown2-trigger").not(".disabled, [aria-disabled=true], .aui-dropdown2-sub-trigger"),t,false))}function l(v,w,u){var t=v.index(v.filter(".active"));t+=(t<0&&w<0)?1:0;t+=w;if(u){t%=v.length}else{if(t<0){t=v.length}}return v.eq(t)}function p(){c(G(this))}function M(){if(C===o){E.unbind(o);C=null}}function Y(){if(C===o){return }E.unbind(C);E.bind(o);C=o}function j(u){var v="bind";var t="delegate";if(u!=="on"){v="unbind";t="undelegate"}if(!s){U[t](".aui-dropdown2-trigger:not(.active)","mousemove",p);O[v]("aui-button-invoke",b)}else{f[v]("aui-dropdown2-hide aui-dropdown2-item-selected aui-dropdown2-step-out",h)}P[v]("aui-dropdown2-hide-all",m);P[t]("a",T);P[v]("aui-dropdown2-hide",Y);P[v]("aui-dropdown2-select-first",N)}},mousedown:function(M){if(M.which===1){G(this).bind(F)}}};var F={mouseleave:function(){E.bind(H)},"mouseup mouseleave":function(){G(this).unbind(F)}};var H={mouseup:function(M){var N=G(M.target).closest(".aui-dropdown2 a, .aui-dropdown2-trigger")[0];if(N){setTimeout(function(){L(N)},0)}},"mouseup mouseleave":function(){G(this).unbind(H)}};function L(M){if(M.click){M.click()}else{var N=document.createEvent("MouseEvents");N.initMouseEvent("click",true,true,window,0,0,0,0,0,false,false,false,false,0,null);M.dispatchEvent(N)}}function D(N,M){return(N===M)||G.contains(M,N)}function J(O){if(!(O instanceof AJS.$)){O=G(O)}var P=O.attr("aria-owns"),M=O.attr("aria-haspopup"),N=document.getElementById(P);if(N){return G(N)}else{if(!P){throw new Error("Dropdown 2 trigger required attribute not set: aria-owns")}if(!M){throw new Error("Dropdown 2 trigger required attribute not set: aria-haspopup")}if(!N){throw new Error("Dropdown 2 trigger aria-owns attr set to nonexistent id: "+P)}throw new Error("Dropdown 2 trigger unknown error. I don't know what you did, but there's smoke everywhere. Consult the documentation.")}}E.delegate(".aui-dropdown2-trigger",B);E.delegate(".aui-dropdown2-trigger:not(.active):not([aria-disabled=true]),.aui-dropdown2-sub-trigger:not([aria-disabled=true])",A);E.delegate(".aui-dropdown2-checkbox:not(.disabled)","click",function(){var M=G(this);if(M.hasClass("checked")){M.removeClass("checked").attr("aria-checked","false");M.trigger("aui-dropdown2-item-uncheck")}else{M.addClass("checked").attr("aria-checked","true");M.trigger("aui-dropdown2-item-check")}});E.delegate(".aui-dropdown2-radio:not(.checked):not(.disabled)","click",function(){var M=G(this);var N=M.closest("ul").find(".checked");N.removeClass("checked").attr("aria-checked","false").trigger("aui-dropdown2-item-uncheck");M.addClass("checked").attr("aria-checked","true").trigger("aui-dropdown2-item-check")});E.delegate(".aui-dropdown2 a.disabled","click",function(M){I(M)})})(AJS.$);
/* module-key = 'com.atlassian.auiplugin:ajs', location = 'js/atlassian/raphael/raphael.shadow.js' */
if(window.Raphael){Raphael.shadow=function(K,J,L,F,Q){Q=Q||{};var B=jQuery(Q.target),N=jQuery("<div/>",{"class":"aui-shadow"}),A=Q.shadow||Q.color||"#000",P=Q.size*10||0,O=Q.offsetSize||3,M=Q.zindex||0,H=Q.radius||0,G="0.4",D=Q.blur||3,C,I,E;L+=P+2*D;F+=P+2*D;if(Raphael.shadow.BOX_SHADOW_SUPPORT){B.addClass("aui-box-shadow");return N.addClass("hidden")}if(K===0&&J===0&&B.length>0){E=B.offset();K=O-D+E.left;J=O-D+E.top}if(jQuery.browser.msie&&jQuery.browser.version<"9"){A="#f0f0f0";G="0.2"}N.css({position:"absolute",left:K,top:J,width:L,height:F,zIndex:M});if(B.length>0){N.appendTo(document.body);C=Raphael(N[0],L,F,H)}else{C=Raphael(K,J,L,F,H)}C.canvas.style.position="absolute";I=C.rect(D,D,L-2*D,F-2*D).attr({fill:A,stroke:A,blur:""+D,opacity:G});return N};Raphael.shadow.BOX_SHADOW_SUPPORT=(function(){var C=document.documentElement.style;var A=["boxShadow","MozBoxShadow","WebkitBoxShadow","msBoxShadow"];for(var B=0;B<A.length;B++){if(A[B] in C){return true}}return false})()};
/* module-key = 'com.atlassian.auiplugin:ajs', location = 'js/atlassian/jquery/jquery.os.js' */
jQuery.os={};var jQueryOSplatform=navigator.platform.toLowerCase();jQuery.os.windows=(jQueryOSplatform.indexOf("win")!=-1);jQuery.os.mac=(jQueryOSplatform.indexOf("mac")!=-1);jQuery.os.linux=(jQueryOSplatform.indexOf("linux")!=-1);
/* module-key = 'com.atlassian.auiplugin:ajs', location = 'js/external/jquery/jquery-ui.js' */
/*
 * jQuery UI 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI
 */
(function(A,C){A.ui=A.ui||{};if(A.ui.version){return }A.extend(A.ui,{version:"1.8.11",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}});A.fn.extend({_focus:A.fn.focus,focus:function(D,E){return typeof D==="number"?this.each(function(){var F=this;setTimeout(function(){A(F).focus();if(E){E.call(F)}},D)}):this._focus.apply(this,arguments)},scrollParent:function(){var D;if((A.browser.msie&&(/(static|relative)/).test(this.css("position")))||(/absolute/).test(this.css("position"))){D=this.parents().filter(function(){return(/(relative|absolute|fixed)/).test(A.curCSS(this,"position",1))&&(/(auto|scroll)/).test(A.curCSS(this,"overflow",1)+A.curCSS(this,"overflow-y",1)+A.curCSS(this,"overflow-x",1))}).eq(0)}else{D=this.parents().filter(function(){return(/(auto|scroll)/).test(A.curCSS(this,"overflow",1)+A.curCSS(this,"overflow-y",1)+A.curCSS(this,"overflow-x",1))}).eq(0)}return(/fixed/).test(this.css("position"))||!D.length?A(document):D},zIndex:function(G){if(G!==C){return this.css("zIndex",G)}if(this.length){var E=A(this[0]),D,F;while(E.length&&E[0]!==document){D=E.css("position");if(D==="absolute"||D==="relative"||D==="fixed"){F=parseInt(E.css("zIndex"),10);if(!isNaN(F)&&F!==0){return F}}E=E.parent()}}return 0},disableSelection:function(){return this.bind((A.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(D){D.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});A.each(["Width","Height"],function(F,D){var E=D==="Width"?["Left","Right"]:["Top","Bottom"],G=D.toLowerCase(),I={innerWidth:A.fn.innerWidth,innerHeight:A.fn.innerHeight,outerWidth:A.fn.outerWidth,outerHeight:A.fn.outerHeight};function H(L,K,J,M){A.each(E,function(){K-=parseFloat(A.curCSS(L,"padding"+this,true))||0;if(J){K-=parseFloat(A.curCSS(L,"border"+this+"Width",true))||0}if(M){K-=parseFloat(A.curCSS(L,"margin"+this,true))||0}});return K}A.fn["inner"+D]=function(J){if(J===C){return I["inner"+D].call(this)}return this.each(function(){A(this).css(G,H(this,J)+"px")})};A.fn["outer"+D]=function(J,K){if(typeof J!=="number"){return I["outer"+D].call(this,J)}return this.each(function(){A(this).css(G,H(this,J,true,K)+"px")})}});function B(D){return !A(D).parents().andSelf().filter(function(){return A.curCSS(this,"visibility")==="hidden"||A.expr.filters.hidden(this)}).length}A.extend(A.expr[":"],{data:function(F,E,D){return !!A.data(F,D[3])},focusable:function(F){var I=F.nodeName.toLowerCase(),D=A.attr(F,"tabindex");if("area"===I){var H=F.parentNode,G=H.name,E;if(!F.href||!G||H.nodeName.toLowerCase()!=="map"){return false}E=A("img[usemap=#"+G+"]")[0];return !!E&&B(E)}return(/input|select|textarea|button|object/.test(I)?!F.disabled:"a"==I?F.href||!isNaN(D):!isNaN(D))&&B(F)},tabbable:function(E){var D=A.attr(E,"tabindex");return(isNaN(D)||D>=0)&&A(E).is(":focusable")}});A(function(){var D=document.body,E=D.appendChild(E=document.createElement("div"));A.extend(E.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});A.support.minHeight=E.offsetHeight===100;A.support.selectstart="onselectstart" in E;D.removeChild(E).style.display="none"});A.extend(A.ui,{plugin:{add:function(E,F,H){var G=A.ui[E].prototype;for(var D in H){G.plugins[D]=G.plugins[D]||[];G.plugins[D].push([F,H[D]])}},call:function(D,F,E){var H=D.plugins[F];if(!H||!D.element[0].parentNode){return }for(var G=0;G<H.length;G++){if(D.options[H[G][0]]){H[G][1].apply(D.element,E)}}}},contains:function(E,D){return document.compareDocumentPosition?E.compareDocumentPosition(D)&16:E!==D&&E.contains(D)},hasScroll:function(G,E){if(A(G).css("overflow")==="hidden"){return false}var D=(E&&E==="left")?"scrollLeft":"scrollTop",F=false;if(G[D]>0){return true}G[D]=1;F=(G[D]>0);G[D]=0;return F},isOverAxis:function(E,D,F){return(E>D)&&(E<(D+F))},isOver:function(I,E,H,G,D,F){return A.ui.isOverAxis(I,H,D)&&A.ui.isOverAxis(E,G,F)}})})(jQuery);
/*
 * jQuery UI Widget 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Widget
 */
(function(B,D){if(B.cleanData){var C=B.cleanData;B.cleanData=function(E){for(var F=0,G;(G=E[F])!=null;F++){B(G).triggerHandler("remove")}C(E)}}else{var A=B.fn.remove;B.fn.remove=function(E,F){return this.each(function(){if(!F){if(!E||B.filter(E,[this]).length){B("*",this).add([this]).each(function(){B(this).triggerHandler("remove")})}}return A.call(B(this),E,F)})}}B.widget=function(F,H,E){var G=F.split(".")[0],J;F=F.split(".")[1];J=G+"-"+F;if(!E){E=H;H=B.Widget}B.expr[":"][J]=function(K){return !!B.data(K,F)};B[G]=B[G]||{};B[G][F]=function(K,L){if(arguments.length){this._createWidget(K,L)}};var I=new H();I.options=B.extend(true,{},I.options);B[G][F].prototype=B.extend(true,I,{namespace:G,widgetName:F,widgetEventPrefix:B[G][F].prototype.widgetEventPrefix||F,widgetBaseClass:J},E);B.widget.bridge(F,B[G][F])};B.widget.bridge=function(F,E){B.fn[F]=function(I){var G=typeof I==="string",H=Array.prototype.slice.call(arguments,1),J=this;I=!G&&H.length?B.extend.apply(null,[true,I].concat(H)):I;if(G&&I.charAt(0)==="_"){return J}if(G){this.each(function(){var K=B.data(this,F),L=K&&B.isFunction(K[I])?K[I].apply(K,H):K;if(L!==K&&L!==D){J=L;return false}})}else{this.each(function(){var K=B.data(this,F);if(K){K.option(I||{})._init()}else{B.data(this,F,new E(I,this))}})}return J}};B.Widget=function(E,F){if(arguments.length){this._createWidget(E,F)}};B.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(F,G){B.data(G,this.widgetName,this);this.element=B(G);this.options=B.extend(true,{},this.options,this._getCreateOptions(),F);var E=this;this.element.bind("remove."+this.widgetName,function(){E.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return B.metadata&&B.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled")},widget:function(){return this.element},option:function(F,G){var E=F;if(arguments.length===0){return B.extend({},this.options)}if(typeof F==="string"){if(G===D){return this.options[F]}E={};E[F]=G}this._setOptions(E);return this},_setOptions:function(F){var E=this;B.each(F,function(G,H){E._setOption(G,H)});return this},_setOption:function(E,F){this.options[E]=F;if(E==="disabled"){this.widget()[F?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",F)}return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_trigger:function(F,G,H){var J=this.options[F];G=B.Event(G);G.type=(F===this.widgetEventPrefix?F:this.widgetEventPrefix+F).toLowerCase();H=H||{};if(G.originalEvent){for(var E=B.event.props.length,I;E;){I=B.event.props[--E];G[I]=G.originalEvent[I]}}this.element.trigger(G,H);return !(B.isFunction(J)&&J.call(this.element[0],G,H)===false||G.isDefaultPrevented())}}})(jQuery);
/*
 * jQuery UI Mouse 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Mouse
 *
 * Depends:
 *	jquery.ui.widget.js
 */
(function(A,B){A.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var C=this;this.element.bind("mousedown."+this.widgetName,function(D){return C._mouseDown(D)}).bind("click."+this.widgetName,function(D){if(true===A.data(D.target,C.widgetName+".preventClickEvent")){A.removeData(D.target,C.widgetName+".preventClickEvent");D.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName)},_mouseDown:function(E){E.originalEvent=E.originalEvent||{};if(E.originalEvent.mouseHandled){return }(this._mouseStarted&&this._mouseUp(E));this._mouseDownEvent=E;var D=this,F=(E.which==1),C=(typeof this.options.cancel=="string"?A(E.target).parents().add(E.target).filter(this.options.cancel).length:false);if(!F||C||!this._mouseCapture(E)){return true}this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){D.mouseDelayMet=true},this.options.delay)}if(this._mouseDistanceMet(E)&&this._mouseDelayMet(E)){this._mouseStarted=(this._mouseStart(E)!==false);if(!this._mouseStarted){E.preventDefault();return true}}if(true===A.data(E.target,this.widgetName+".preventClickEvent")){A.removeData(E.target,this.widgetName+".preventClickEvent")}this._mouseMoveDelegate=function(G){return D._mouseMove(G)};this._mouseUpDelegate=function(G){return D._mouseUp(G)};A(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);E.preventDefault();E.originalEvent.mouseHandled=true;return true},_mouseMove:function(C){if(A.browser.msie&&!(document.documentMode>=9)&&!C.button){return this._mouseUp(C)}if(this._mouseStarted){this._mouseDrag(C);return C.preventDefault()}if(this._mouseDistanceMet(C)&&this._mouseDelayMet(C)){this._mouseStarted=(this._mouseStart(this._mouseDownEvent,C)!==false);(this._mouseStarted?this._mouseDrag(C):this._mouseUp(C))}return !this._mouseStarted},_mouseUp:function(C){A(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;if(C.target==this._mouseDownEvent.target){A.data(C.target,this.widgetName+".preventClickEvent",true)}this._mouseStop(C)}return false},_mouseDistanceMet:function(C){return(Math.max(Math.abs(this._mouseDownEvent.pageX-C.pageX),Math.abs(this._mouseDownEvent.pageY-C.pageY))>=this.options.distance)},_mouseDelayMet:function(C){return this.mouseDelayMet},_mouseStart:function(C){},_mouseDrag:function(C){},_mouseStop:function(C){},_mouseCapture:function(C){return true}})})(jQuery);(function(A,B){A.widget("ui.draggable",A.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false},_create:function(){if(this.options.helper=="original"&&!(/^(?:r|a|f)/).test(this.element.css("position"))){this.element[0].style.position="relative"}(this.options.addClasses&&this.element.addClass("ui-draggable"));(this.options.disabled&&this.element.addClass("ui-draggable-disabled"));this._mouseInit()},destroy:function(){if(!this.element.data("draggable")){return }this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy();return this},_mouseCapture:function(C){var D=this.options;if(this.helper||D.disabled||A(C.target).is(".ui-resizable-handle")){return false}this.handle=this._getHandle(C);if(!this.handle){return false}return true},_mouseStart:function(C){var D=this.options;this.helper=this._createHelper(C);this._cacheHelperProportions();if(A.ui.ddmanager){A.ui.ddmanager.current=this}this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};A.extend(this.offset,{click:{left:C.pageX-this.offset.left,top:C.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(C);this.originalPageX=C.pageX;this.originalPageY=C.pageY;(D.cursorAt&&this._adjustOffsetFromHelper(D.cursorAt));if(D.containment){this._setContainment()}if(this._trigger("start",C)===false){this._clear();return false}this._cacheHelperProportions();if(A.ui.ddmanager&&!D.dropBehaviour){A.ui.ddmanager.prepareOffsets(this,C)}this.helper.addClass("ui-draggable-dragging");this._mouseDrag(C,true);return true},_mouseDrag:function(C,E){this.position=this._generatePosition(C);this.positionAbs=this._convertPositionTo("absolute");if(!E){var D=this._uiHash();if(this._trigger("drag",C,D)===false){this._mouseUp({});return false}this.position=D.position}if(!this.options.axis||this.options.axis!="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!="x"){this.helper[0].style.top=this.position.top+"px"}if(A.ui.ddmanager){A.ui.ddmanager.drag(this,C)}return false},_mouseStop:function(D){var E=false;if(A.ui.ddmanager&&!this.options.dropBehaviour){E=A.ui.ddmanager.drop(this,D)}if(this.dropped){E=this.dropped;this.dropped=false}if((!this.element[0]||!this.element[0].parentNode)&&this.options.helper=="original"){return false}if((this.options.revert=="invalid"&&!E)||(this.options.revert=="valid"&&E)||this.options.revert===true||(A.isFunction(this.options.revert)&&this.options.revert.call(this.element,E))){var C=this;A(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){if(C._trigger("stop",D)!==false){C._clear()}})}else{if(this._trigger("stop",D)!==false){this._clear()}}return false},cancel:function(){if(this.helper.is(".ui-draggable-dragging")){this._mouseUp({})}else{this._clear()}return this},_getHandle:function(C){var D=!this.options.handle||!A(this.options.handle,this.element).length?true:false;A(this.options.handle,this.element).find("*").andSelf().each(function(){if(this==C.target){D=true}});return D},_createHelper:function(D){var E=this.options;var C=A.isFunction(E.helper)?A(E.helper.apply(this.element[0],[D])):(E.helper=="clone"?this.element.clone():this.element);if(!C.parents("body").length){C.appendTo((E.appendTo=="parent"?this.element[0].parentNode:E.appendTo))}if(C[0]!=this.element[0]&&!(/(fixed|absolute)/).test(C.css("position"))){C.css("position","absolute")}return C},_adjustOffsetFromHelper:function(C){if(typeof C=="string"){C=C.split(" ")}if(A.isArray(C)){C={left:+C[0],top:+C[1]||0}}if("left" in C){this.offset.click.left=C.left+this.margins.left}if("right" in C){this.offset.click.left=this.helperProportions.width-C.right+this.margins.left}if("top" in C){this.offset.click.top=C.top+this.margins.top}if("bottom" in C){this.offset.click.top=this.helperProportions.height-C.bottom+this.margins.top}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var C=this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&A.ui.contains(this.scrollParent[0],this.offsetParent[0])){C.left+=this.scrollParent.scrollLeft();C.top+=this.scrollParent.scrollTop()}if((this.offsetParent[0]==document.body)||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&A.browser.msie)){C={top:0,left:0}}return{top:C.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:C.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var C=this.element.position();return{top:C.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:C.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:(parseInt(this.element.css("marginLeft"),10)||0),top:(parseInt(this.element.css("marginTop"),10)||0),right:(parseInt(this.element.css("marginRight"),10)||0),bottom:(parseInt(this.element.css("marginBottom"),10)||0)}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var F=this.options;if(F.containment=="parent"){F.containment=this.helper[0].parentNode}if(F.containment=="document"||F.containment=="window"){this.containment=[(F.containment=="document"?0:A(window).scrollLeft())-this.offset.relative.left-this.offset.parent.left,(F.containment=="document"?0:A(window).scrollTop())-this.offset.relative.top-this.offset.parent.top,(F.containment=="document"?0:A(window).scrollLeft())+A(F.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(F.containment=="document"?0:A(window).scrollTop())+(A(F.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!(/^(document|window|parent)$/).test(F.containment)&&F.containment.constructor!=Array){var D=A(F.containment)[0];if(!D){return }var E=A(F.containment).offset();var C=(A(D).css("overflow")!="hidden");this.containment=[E.left+(parseInt(A(D).css("borderLeftWidth"),10)||0)+(parseInt(A(D).css("paddingLeft"),10)||0),E.top+(parseInt(A(D).css("borderTopWidth"),10)||0)+(parseInt(A(D).css("paddingTop"),10)||0),E.left+(C?Math.max(D.scrollWidth,D.offsetWidth):D.offsetWidth)-(parseInt(A(D).css("borderLeftWidth"),10)||0)-(parseInt(A(D).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,E.top+(C?Math.max(D.scrollHeight,D.offsetHeight):D.offsetHeight)-(parseInt(A(D).css("borderTopWidth"),10)||0)-(parseInt(A(D).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom]}else{if(F.containment.constructor==Array){this.containment=F.containment}}},_convertPositionTo:function(F,H){if(!H){H=this.position}var D=F=="absolute"?1:-1;var E=this.options,C=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&A.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,G=(/(html|body)/i).test(C[0].tagName);return{top:(H.top+this.offset.relative.top*D+this.offset.parent.top*D-(A.browser.safari&&A.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(G?0:C.scrollTop()))*D)),left:(H.left+this.offset.relative.left*D+this.offset.parent.left*D-(A.browser.safari&&A.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():G?0:C.scrollLeft())*D))}},_generatePosition:function(F){var I=this.options,C=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&A.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,J=(/(html|body)/i).test(C[0].tagName);var E=F.pageX;var D=F.pageY;if(this.originalPosition){if(this.containment){if(F.pageX-this.offset.click.left<this.containment[0]){E=this.containment[0]+this.offset.click.left}if(F.pageY-this.offset.click.top<this.containment[1]){D=this.containment[1]+this.offset.click.top}if(F.pageX-this.offset.click.left>this.containment[2]){E=this.containment[2]+this.offset.click.left}if(F.pageY-this.offset.click.top>this.containment[3]){D=this.containment[3]+this.offset.click.top}}if(I.grid){var H=this.originalPageY+Math.round((D-this.originalPageY)/I.grid[1])*I.grid[1];D=this.containment?(!(H-this.offset.click.top<this.containment[1]||H-this.offset.click.top>this.containment[3])?H:(!(H-this.offset.click.top<this.containment[1])?H-I.grid[1]:H+I.grid[1])):H;var G=this.originalPageX+Math.round((E-this.originalPageX)/I.grid[0])*I.grid[0];E=this.containment?(!(G-this.offset.click.left<this.containment[0]||G-this.offset.click.left>this.containment[2])?G:(!(G-this.offset.click.left<this.containment[0])?G-I.grid[0]:G+I.grid[0])):G}}return{top:(D-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(A.browser.safari&&A.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(J?0:C.scrollTop())))),left:(E-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(A.browser.safari&&A.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():J?0:C.scrollLeft())))}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");if(this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval){this.helper.remove()}this.helper=null;this.cancelHelperRemoval=false},_trigger:function(C,D,E){E=E||this._uiHash();A.ui.plugin.call(this,C,[D,E]);if(C=="drag"){this.positionAbs=this._convertPositionTo("absolute")}return A.Widget.prototype._trigger.call(this,C,D,E)},plugins:{},_uiHash:function(C){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});A.extend(A.ui.draggable,{version:"1.8.11"});A.ui.plugin.add("draggable","connectToSortable",{start:function(D,F){var E=A(this).data("draggable"),G=E.options,C=A.extend({},F,{item:E.element});E.sortables=[];A(G.connectToSortable).each(function(){var H=A.data(this,"sortable");if(H&&!H.options.disabled){E.sortables.push({instance:H,shouldRevert:H.options.revert});H.refreshPositions();H._trigger("activate",D,C)}})},stop:function(D,F){var E=A(this).data("draggable"),C=A.extend({},F,{item:E.element});A.each(E.sortables,function(){if(this.instance.isOver){this.instance.isOver=0;E.cancelHelperRemoval=true;this.instance.cancelHelperRemoval=false;if(this.shouldRevert){this.instance.options.revert=true}this.instance._mouseStop(D);this.instance.options.helper=this.instance.options._helper;if(E.options.helper=="original"){this.instance.currentItem.css({top:"auto",left:"auto"})}}else{this.instance.cancelHelperRemoval=false;this.instance._trigger("deactivate",D,C)}})},drag:function(D,G){var F=A(this).data("draggable"),C=this;var E=function(J){var O=this.offset.click.top,N=this.offset.click.left;var H=this.positionAbs.top,L=this.positionAbs.left;var K=J.height,M=J.width;var P=J.top,I=J.left;return A.ui.isOver(H+O,L+N,P,I,K,M)};A.each(F.sortables,function(H){this.instance.positionAbs=F.positionAbs;this.instance.helperProportions=F.helperProportions;this.instance.offset.click=F.offset.click;if(this.instance._intersectsWith(this.instance.containerCache)){if(!this.instance.isOver){this.instance.isOver=1;this.instance.currentItem=A(C).clone().appendTo(this.instance.element).data("sortable-item",true);this.instance.options._helper=this.instance.options.helper;this.instance.options.helper=function(){return G.helper[0]};D.target=this.instance.currentItem[0];this.instance._mouseCapture(D,true);this.instance._mouseStart(D,true,true);this.instance.offset.click.top=F.offset.click.top;this.instance.offset.click.left=F.offset.click.left;this.instance.offset.parent.left-=F.offset.parent.left-this.instance.offset.parent.left;this.instance.offset.parent.top-=F.offset.parent.top-this.instance.offset.parent.top;F._trigger("toSortable",D);F.dropped=this.instance.element;F.currentItem=F.element;this.instance.fromOutside=F}if(this.instance.currentItem){this.instance._mouseDrag(D)}}else{if(this.instance.isOver){this.instance.isOver=0;this.instance.cancelHelperRemoval=true;this.instance.options.revert=false;this.instance._trigger("out",D,this.instance._uiHash(this.instance));this.instance._mouseStop(D,true);this.instance.options.helper=this.instance.options._helper;this.instance.currentItem.remove();if(this.instance.placeholder){this.instance.placeholder.remove()}F._trigger("fromSortable",D);F.dropped=false}}})}});A.ui.plugin.add("draggable","cursor",{start:function(D,E){var C=A("body"),F=A(this).data("draggable").options;if(C.css("cursor")){F._cursor=C.css("cursor")}C.css("cursor",F.cursor)},stop:function(C,D){var E=A(this).data("draggable").options;if(E._cursor){A("body").css("cursor",E._cursor)}}});A.ui.plugin.add("draggable","iframeFix",{start:function(C,D){var E=A(this).data("draggable").options;A(E.iframeFix===true?"iframe":E.iframeFix).each(function(){A('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1000}).css(A(this).offset()).appendTo("body")})},stop:function(C,D){A("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)})}});A.ui.plugin.add("draggable","opacity",{start:function(D,E){var C=A(E.helper),F=A(this).data("draggable").options;if(C.css("opacity")){F._opacity=C.css("opacity")}C.css("opacity",F.opacity)},stop:function(C,D){var E=A(this).data("draggable").options;if(E._opacity){A(D.helper).css("opacity",E._opacity)}}});A.ui.plugin.add("draggable","scroll",{start:function(D,E){var C=A(this).data("draggable");if(C.scrollParent[0]!=document&&C.scrollParent[0].tagName!="HTML"){C.overflowOffset=C.scrollParent.offset()}},drag:function(E,F){var D=A(this).data("draggable"),G=D.options,C=false;if(D.scrollParent[0]!=document&&D.scrollParent[0].tagName!="HTML"){if(!G.axis||G.axis!="x"){if((D.overflowOffset.top+D.scrollParent[0].offsetHeight)-E.pageY<G.scrollSensitivity){D.scrollParent[0].scrollTop=C=D.scrollParent[0].scrollTop+G.scrollSpeed}else{if(E.pageY-D.overflowOffset.top<G.scrollSensitivity){D.scrollParent[0].scrollTop=C=D.scrollParent[0].scrollTop-G.scrollSpeed}}}if(!G.axis||G.axis!="y"){if((D.overflowOffset.left+D.scrollParent[0].offsetWidth)-E.pageX<G.scrollSensitivity){D.scrollParent[0].scrollLeft=C=D.scrollParent[0].scrollLeft+G.scrollSpeed}else{if(E.pageX-D.overflowOffset.left<G.scrollSensitivity){D.scrollParent[0].scrollLeft=C=D.scrollParent[0].scrollLeft-G.scrollSpeed}}}}else{if(!G.axis||G.axis!="x"){if(E.pageY-A(document).scrollTop()<G.scrollSensitivity){C=A(document).scrollTop(A(document).scrollTop()-G.scrollSpeed)}else{if(A(window).height()-(E.pageY-A(document).scrollTop())<G.scrollSensitivity){C=A(document).scrollTop(A(document).scrollTop()+G.scrollSpeed)}}}if(!G.axis||G.axis!="y"){if(E.pageX-A(document).scrollLeft()<G.scrollSensitivity){C=A(document).scrollLeft(A(document).scrollLeft()-G.scrollSpeed)}else{if(A(window).width()-(E.pageX-A(document).scrollLeft())<G.scrollSensitivity){C=A(document).scrollLeft(A(document).scrollLeft()+G.scrollSpeed)}}}}if(C!==false&&A.ui.ddmanager&&!G.dropBehaviour){A.ui.ddmanager.prepareOffsets(D,E)}}});A.ui.plugin.add("draggable","snap",{start:function(D,E){var C=A(this).data("draggable"),F=C.options;C.snapElements=[];A(F.snap.constructor!=String?(F.snap.items||":data(draggable)"):F.snap).each(function(){var H=A(this);var G=H.offset();if(this!=C.element[0]){C.snapElements.push({item:this,width:H.outerWidth(),height:H.outerHeight(),top:G.top,left:G.left})}})},drag:function(O,L){var F=A(this).data("draggable"),M=F.options;var S=M.snapTolerance;var R=L.offset.left,Q=R+F.helperProportions.width,E=L.offset.top,D=E+F.helperProportions.height;for(var P=F.snapElements.length-1;P>=0;P--){var N=F.snapElements[P].left,K=N+F.snapElements[P].width,J=F.snapElements[P].top,U=J+F.snapElements[P].height;if(!((N-S<R&&R<K+S&&J-S<E&&E<U+S)||(N-S<R&&R<K+S&&J-S<D&&D<U+S)||(N-S<Q&&Q<K+S&&J-S<E&&E<U+S)||(N-S<Q&&Q<K+S&&J-S<D&&D<U+S))){if(F.snapElements[P].snapping){(F.options.snap.release&&F.options.snap.release.call(F.element,O,A.extend(F._uiHash(),{snapItem:F.snapElements[P].item})))}F.snapElements[P].snapping=false;continue}if(M.snapMode!="inner"){var C=Math.abs(J-D)<=S;var T=Math.abs(U-E)<=S;var H=Math.abs(N-Q)<=S;var I=Math.abs(K-R)<=S;if(C){L.position.top=F._convertPositionTo("relative",{top:J-F.helperProportions.height,left:0}).top-F.margins.top}if(T){L.position.top=F._convertPositionTo("relative",{top:U,left:0}).top-F.margins.top}if(H){L.position.left=F._convertPositionTo("relative",{top:0,left:N-F.helperProportions.width}).left-F.margins.left}if(I){L.position.left=F._convertPositionTo("relative",{top:0,left:K}).left-F.margins.left}}var G=(C||T||H||I);if(M.snapMode!="outer"){var C=Math.abs(J-E)<=S;var T=Math.abs(U-D)<=S;var H=Math.abs(N-R)<=S;var I=Math.abs(K-Q)<=S;if(C){L.position.top=F._convertPositionTo("relative",{top:J,left:0}).top-F.margins.top}if(T){L.position.top=F._convertPositionTo("relative",{top:U-F.helperProportions.height,left:0}).top-F.margins.top}if(H){L.position.left=F._convertPositionTo("relative",{top:0,left:N}).left-F.margins.left}if(I){L.position.left=F._convertPositionTo("relative",{top:0,left:K-F.helperProportions.width}).left-F.margins.left}}if(!F.snapElements[P].snapping&&(C||T||H||I||G)){(F.options.snap.snap&&F.options.snap.snap.call(F.element,O,A.extend(F._uiHash(),{snapItem:F.snapElements[P].item})))}F.snapElements[P].snapping=(C||T||H||I||G)}}});A.ui.plugin.add("draggable","stack",{start:function(D,E){var G=A(this).data("draggable").options;var F=A.makeArray(A(G.stack)).sort(function(I,H){return(parseInt(A(I).css("zIndex"),10)||0)-(parseInt(A(H).css("zIndex"),10)||0)});if(!F.length){return }var C=parseInt(F[0].style.zIndex)||0;A(F).each(function(H){this.style.zIndex=C+H});this[0].style.zIndex=C+F.length}});A.ui.plugin.add("draggable","zIndex",{start:function(D,E){var C=A(E.helper),F=A(this).data("draggable").options;if(C.css("zIndex")){F._zIndex=C.css("zIndex")}C.css("zIndex",F.zIndex)},stop:function(C,D){var E=A(this).data("draggable").options;if(E._zIndex){A(D.helper).css("zIndex",E._zIndex)}}})})(jQuery);(function(A,B){A.widget("ui.sortable",A.ui.mouse,{widgetEventPrefix:"sort",options:{appendTo:"parent",axis:false,connectWith:false,containment:false,cursor:"auto",cursorAt:false,dropOnEmpty:true,forcePlaceholderSize:false,forceHelperSize:false,grid:false,handle:false,helper:"original",items:"> *",opacity:false,placeholder:false,revert:false,scroll:true,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1000},_create:function(){var C=this.options;this.containerCache={};this.element.addClass("ui-sortable");this.refresh();this.floating=this.items.length?(/left|right/).test(this.items[0].item.css("float"))||(/inline|table-cell/).test(this.items[0].item.css("display")):false;this.offset=this.element.offset();this._mouseInit()},destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").removeData("sortable").unbind(".sortable");this._mouseDestroy();for(var C=this.items.length-1;C>=0;C--){this.items[C].item.removeData("sortable-item")}return this},_setOption:function(C,D){if(C==="disabled"){this.options[C]=D;this.widget()[D?"addClass":"removeClass"]("ui-sortable-disabled")}else{A.Widget.prototype._setOption.apply(this,arguments)}},_mouseCapture:function(F,G){if(this.reverting){return false}if(this.options.disabled||this.options.type=="static"){return false}this._refreshItems(F);var E=null,D=this,C=A(F.target).parents().each(function(){if(A.data(this,"sortable-item")==D){E=A(this);return false}});if(A.data(F.target,"sortable-item")==D){E=A(F.target)}if(!E){return false}if(this.options.handle&&!G){var H=false;A(this.options.handle,E).find("*").andSelf().each(function(){if(this==F.target){H=true}});if(!H){return false}}this.currentItem=E;this._removeCurrentsFromItems();return true},_mouseStart:function(F,G,C){var H=this.options,D=this;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(F);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");A.extend(this.offset,{click:{left:F.pageX-this.offset.left,top:F.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this._generatePosition(F);this.originalPageX=F.pageX;this.originalPageY=F.pageY;(H.cursorAt&&this._adjustOffsetFromHelper(H.cursorAt));this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};if(this.helper[0]!=this.currentItem[0]){this.currentItem.hide()}this._createPlaceholder();if(H.containment){this._setContainment()}if(H.cursor){if(A("body").css("cursor")){this._storedCursor=A("body").css("cursor")}A("body").css("cursor",H.cursor)}if(H.opacity){if(this.helper.css("opacity")){this._storedOpacity=this.helper.css("opacity")}this.helper.css("opacity",H.opacity)}if(H.zIndex){if(this.helper.css("zIndex")){this._storedZIndex=this.helper.css("zIndex")}this.helper.css("zIndex",H.zIndex)}if(this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"){this.overflowOffset=this.scrollParent.offset()}this._trigger("start",F,this._uiHash());if(!this._preserveHelperProportions){this._cacheHelperProportions()}if(!C){for(var E=this.containers.length-1;E>=0;E--){this.containers[E]._trigger("activate",F,D._uiHash(this))}}if(A.ui.ddmanager){A.ui.ddmanager.current=this}if(A.ui.ddmanager&&!H.dropBehaviour){A.ui.ddmanager.prepareOffsets(this,F)}this.dragging=true;this.helper.addClass("ui-sortable-helper");this._mouseDrag(F);return true},_mouseDrag:function(G){this.position=this._generatePosition(G);this.positionAbs=this._convertPositionTo("absolute");if(!this.lastPositionAbs){this.lastPositionAbs=this.positionAbs}if(this.options.scroll){var H=this.options,C=false;if(this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"){if((this.overflowOffset.top+this.scrollParent[0].offsetHeight)-G.pageY<H.scrollSensitivity){this.scrollParent[0].scrollTop=C=this.scrollParent[0].scrollTop+H.scrollSpeed}else{if(G.pageY-this.overflowOffset.top<H.scrollSensitivity){this.scrollParent[0].scrollTop=C=this.scrollParent[0].scrollTop-H.scrollSpeed}}if((this.overflowOffset.left+this.scrollParent[0].offsetWidth)-G.pageX<H.scrollSensitivity){this.scrollParent[0].scrollLeft=C=this.scrollParent[0].scrollLeft+H.scrollSpeed}else{if(G.pageX-this.overflowOffset.left<H.scrollSensitivity){this.scrollParent[0].scrollLeft=C=this.scrollParent[0].scrollLeft-H.scrollSpeed}}}else{if(G.pageY-A(document).scrollTop()<H.scrollSensitivity){C=A(document).scrollTop(A(document).scrollTop()-H.scrollSpeed)}else{if(A(window).height()-(G.pageY-A(document).scrollTop())<H.scrollSensitivity){C=A(document).scrollTop(A(document).scrollTop()+H.scrollSpeed)}}if(G.pageX-A(document).scrollLeft()<H.scrollSensitivity){C=A(document).scrollLeft(A(document).scrollLeft()-H.scrollSpeed)}else{if(A(window).width()-(G.pageX-A(document).scrollLeft())<H.scrollSensitivity){C=A(document).scrollLeft(A(document).scrollLeft()+H.scrollSpeed)}}}if(C!==false&&A.ui.ddmanager&&!H.dropBehaviour){A.ui.ddmanager.prepareOffsets(this,G)}}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!="x"){this.helper[0].style.top=this.position.top+"px"}for(var E=this.items.length-1;E>=0;E--){var F=this.items[E],D=F.item[0],I=this._intersectsWithPointer(F);if(!I){continue}if(D!=this.currentItem[0]&&this.placeholder[I==1?"next":"prev"]()[0]!=D&&!A.ui.contains(this.placeholder[0],D)&&(this.options.type=="semi-dynamic"?!A.ui.contains(this.element[0],D):true)){this.direction=I==1?"down":"up";if(this.options.tolerance=="pointer"||this._intersectsWithSides(F)){this._rearrange(G,F)}else{break}this._trigger("change",G,this._uiHash());break}}this._contactContainers(G);if(A.ui.ddmanager){A.ui.ddmanager.drag(this,G)}this._trigger("sort",G,this._uiHash());this.lastPositionAbs=this.positionAbs;return false},_mouseStop:function(D,E){if(!D){return }if(A.ui.ddmanager&&!this.options.dropBehaviour){A.ui.ddmanager.drop(this,D)}if(this.options.revert){var C=this;var F=C.placeholder.offset();C.reverting=true;A(this.helper).animate({left:F.left-this.offset.parent.left-C.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:F.top-this.offset.parent.top-C.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){C._clear(D)})}else{this._clear(D,E)}return false},cancel:function(){var C=this;if(this.dragging){this._mouseUp({target:null});if(this.options.helper=="original"){this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else{this.currentItem.show()}for(var D=this.containers.length-1;D>=0;D--){this.containers[D]._trigger("deactivate",null,C._uiHash(this));if(this.containers[D].containerCache.over){this.containers[D]._trigger("out",null,C._uiHash(this));this.containers[D].containerCache.over=0}}}if(this.placeholder){if(this.placeholder[0].parentNode){this.placeholder[0].parentNode.removeChild(this.placeholder[0])}if(this.options.helper!="original"&&this.helper&&this.helper[0].parentNode){this.helper.remove()}A.extend(this,{helper:null,dragging:false,reverting:false,_noFinalSort:null});if(this.domPosition.prev){A(this.domPosition.prev).after(this.currentItem)}else{A(this.domPosition.parent).prepend(this.currentItem)}}return this},serialize:function(E){var C=this._getItemsAsjQuery(E&&E.connected);var D=[];E=E||{};A(C).each(function(){var F=(A(E.item||this).attr(E.attribute||"id")||"").match(E.expression||(/(.+)[-=_](.+)/));if(F){D.push((E.key||F[1]+"[]")+"="+(E.key&&E.expression?F[1]:F[2]))}});if(!D.length&&E.key){D.push(E.key+"=")}return D.join("&")},toArray:function(E){var C=this._getItemsAsjQuery(E&&E.connected);var D=[];E=E||{};C.each(function(){D.push(A(E.item||this).attr(E.attribute||"id")||"")});return D},_intersectsWith:function(L){var E=this.positionAbs.left,D=E+this.helperProportions.width,K=this.positionAbs.top,J=K+this.helperProportions.height;var F=L.left,C=F+L.width,M=L.top,I=M+L.height;var N=this.offset.click.top,H=this.offset.click.left;var G=(K+N)>M&&(K+N)<I&&(E+H)>F&&(E+H)<C;if(this.options.tolerance=="pointer"||this.options.forcePointerForContainers||(this.options.tolerance!="pointer"&&this.helperProportions[this.floating?"width":"height"]>L[this.floating?"width":"height"])){return G}else{return(F<E+(this.helperProportions.width/2)&&D-(this.helperProportions.width/2)<C&&M<K+(this.helperProportions.height/2)&&J-(this.helperProportions.height/2)<I)}},_intersectsWithPointer:function(E){var F=A.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,E.top,E.height),D=A.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,E.left,E.width),H=F&&D,C=this._getDragVerticalDirection(),G=this._getDragHorizontalDirection();if(!H){return false}return this.floating?(((G&&G=="right")||C=="down")?2:1):(C&&(C=="down"?2:1))},_intersectsWithSides:function(F){var D=A.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,F.top+(F.height/2),F.height),E=A.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,F.left+(F.width/2),F.width),C=this._getDragVerticalDirection(),G=this._getDragHorizontalDirection();if(this.floating&&G){return((G=="right"&&E)||(G=="left"&&!E))}else{return C&&((C=="down"&&D)||(C=="up"&&!D))}},_getDragVerticalDirection:function(){var C=this.positionAbs.top-this.lastPositionAbs.top;return C!=0&&(C>0?"down":"up")},_getDragHorizontalDirection:function(){var C=this.positionAbs.left-this.lastPositionAbs.left;return C!=0&&(C>0?"right":"left")},refresh:function(C){this._refreshItems(C);this.refreshPositions();return this},_connectWith:function(){var C=this.options;return C.connectWith.constructor==String?[C.connectWith]:C.connectWith},_getItemsAsjQuery:function(C){var K=this;var H=[];var F=[];var I=this._connectWith();if(I&&C){for(var E=I.length-1;E>=0;E--){var J=A(I[E]);for(var D=J.length-1;D>=0;D--){var G=A.data(J[D],"sortable");if(G&&G!=this&&!G.options.disabled){F.push([A.isFunction(G.options.items)?G.options.items.call(G.element):A(G.options.items,G.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),G])}}}}F.push([A.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):A(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(var E=F.length-1;E>=0;E--){F[E][0].each(function(){H.push(this)})}return A(H)},_removeCurrentsFromItems:function(){var E=this.currentItem.find(":data(sortable-item)");for(var D=0;D<this.items.length;D++){for(var C=0;C<E.length;C++){if(E[C]==this.items[D].item[0]){this.items.splice(D,1)}}}},_refreshItems:function(C){this.items=[];this.containers=[this];var I=this.items;var O=this;var G=[[A.isFunction(this.options.items)?this.options.items.call(this.element[0],C,{item:this.currentItem}):A(this.options.items,this.element),this]];var K=this._connectWith();if(K){for(var F=K.length-1;F>=0;F--){var L=A(K[F]);for(var E=L.length-1;E>=0;E--){var H=A.data(L[E],"sortable");if(H&&H!=this&&!H.options.disabled){G.push([A.isFunction(H.options.items)?H.options.items.call(H.element[0],C,{item:this.currentItem}):A(H.options.items,H.element),H]);this.containers.push(H)}}}}for(var F=G.length-1;F>=0;F--){var J=G[F][1];var D=G[F][0];for(var E=0,M=D.length;E<M;E++){var N=A(D[E]);N.data("sortable-item",J);I.push({item:N,instance:J,width:0,height:0,left:0,top:0})}}},refreshPositions:function(C){if(this.offsetParent&&this.helper){this.offset.parent=this._getParentOffset()}for(var E=this.items.length-1;E>=0;E--){var F=this.items[E];var D=this.options.toleranceElement?A(this.options.toleranceElement,F.item):F.item;if(!C){F.width=D.outerWidth();F.height=D.outerHeight()}var G=D.offset();F.left=G.left;F.top=G.top}if(this.options.custom&&this.options.custom.refreshContainers){this.options.custom.refreshContainers.call(this)}else{for(var E=this.containers.length-1;E>=0;E--){var G=this.containers[E].element.offset();this.containers[E].containerCache.left=G.left;this.containers[E].containerCache.top=G.top;this.containers[E].containerCache.width=this.containers[E].element.outerWidth();this.containers[E].containerCache.height=this.containers[E].element.outerHeight()}}return this},_createPlaceholder:function(E){var C=E||this,F=C.options;if(!F.placeholder||F.placeholder.constructor==String){var D=F.placeholder;F.placeholder={element:function(){var G=A(document.createElement(C.currentItem[0].nodeName)).addClass(D||C.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];if(!D){G.style.visibility="hidden"}return G},update:function(G,H){if(D&&!F.forcePlaceholderSize){return }if(!H.height()){H.height(C.currentItem.innerHeight()-parseInt(C.currentItem.css("paddingTop")||0,10)-parseInt(C.currentItem.css("paddingBottom")||0,10))}if(!H.width()){H.width(C.currentItem.innerWidth()-parseInt(C.currentItem.css("paddingLeft")||0,10)-parseInt(C.currentItem.css("paddingRight")||0,10))}}}}C.placeholder=A(F.placeholder.element.call(C.element,C.currentItem));C.currentItem.after(C.placeholder);F.placeholder.update(C,C.placeholder)},_contactContainers:function(C){var E=null,J=null;for(var G=this.containers.length-1;G>=0;G--){if(A.ui.contains(this.currentItem[0],this.containers[G].element[0])){continue}if(this._intersectsWith(this.containers[G].containerCache)){if(E&&A.ui.contains(this.containers[G].element[0],E.element[0])){continue}E=this.containers[G];J=G}else{if(this.containers[G].containerCache.over){this.containers[G]._trigger("out",C,this._uiHash(this));this.containers[G].containerCache.over=0}}}if(!E){return }if(this.containers.length===1){this.containers[J]._trigger("over",C,this._uiHash(this));this.containers[J].containerCache.over=1}else{if(this.currentContainer!=this.containers[J]){var I=10000;var H=null;var D=this.positionAbs[this.containers[J].floating?"left":"top"];for(var F=this.items.length-1;F>=0;F--){if(!A.ui.contains(this.containers[J].element[0],this.items[F].item[0])){continue}var K=this.items[F][this.containers[J].floating?"left":"top"];if(Math.abs(K-D)<I){I=Math.abs(K-D);H=this.items[F]}}if(!H&&!this.options.dropOnEmpty){return }this.currentContainer=this.containers[J];H?this._rearrange(C,H,null,true):this._rearrange(C,null,this.containers[J].element,true);this._trigger("change",C,this._uiHash());this.containers[J]._trigger("change",C,this._uiHash(this));this.options.placeholder.update(this.currentContainer,this.placeholder);this.containers[J]._trigger("over",C,this._uiHash(this));this.containers[J].containerCache.over=1}}},_createHelper:function(D){var E=this.options;var C=A.isFunction(E.helper)?A(E.helper.apply(this.element[0],[D,this.currentItem])):(E.helper=="clone"?this.currentItem.clone():this.currentItem);if(!C.parents("body").length){A(E.appendTo!="parent"?E.appendTo:this.currentItem[0].parentNode)[0].appendChild(C[0])}if(C[0]==this.currentItem[0]){this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}}if(C[0].style.width==""||E.forceHelperSize){C.width(this.currentItem.width())}if(C[0].style.height==""||E.forceHelperSize){C.height(this.currentItem.height())}return C},_adjustOffsetFromHelper:function(C){if(typeof C=="string"){C=C.split(" ")}if(A.isArray(C)){C={left:+C[0],top:+C[1]||0}}if("left" in C){this.offset.click.left=C.left+this.margins.left}if("right" in C){this.offset.click.left=this.helperProportions.width-C.right+this.margins.left}if("top" in C){this.offset.click.top=C.top+this.margins.top}if("bottom" in C){this.offset.click.top=this.helperProportions.height-C.bottom+this.margins.top}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var C=this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&A.ui.contains(this.scrollParent[0],this.offsetParent[0])){C.left+=this.scrollParent.scrollLeft();C.top+=this.scrollParent.scrollTop()}if((this.offsetParent[0]==document.body)||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&A.browser.msie)){C={top:0,left:0}}return{top:C.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:C.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var C=this.currentItem.position();return{top:C.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:C.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:(parseInt(this.currentItem.css("marginLeft"),10)||0),top:(parseInt(this.currentItem.css("marginTop"),10)||0)}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var F=this.options;if(F.containment=="parent"){F.containment=this.helper[0].parentNode}if(F.containment=="document"||F.containment=="window"){this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,A(F.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(A(F.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!(/^(document|window|parent)$/).test(F.containment)){var D=A(F.containment)[0];var E=A(F.containment).offset();var C=(A(D).css("overflow")!="hidden");this.containment=[E.left+(parseInt(A(D).css("borderLeftWidth"),10)||0)+(parseInt(A(D).css("paddingLeft"),10)||0)-this.margins.left,E.top+(parseInt(A(D).css("borderTopWidth"),10)||0)+(parseInt(A(D).css("paddingTop"),10)||0)-this.margins.top,E.left+(C?Math.max(D.scrollWidth,D.offsetWidth):D.offsetWidth)-(parseInt(A(D).css("borderLeftWidth"),10)||0)-(parseInt(A(D).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,E.top+(C?Math.max(D.scrollHeight,D.offsetHeight):D.offsetHeight)-(parseInt(A(D).css("borderTopWidth"),10)||0)-(parseInt(A(D).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(F,H){if(!H){H=this.position}var D=F=="absolute"?1:-1;var E=this.options,C=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&A.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,G=(/(html|body)/i).test(C[0].tagName);return{top:(H.top+this.offset.relative.top*D+this.offset.parent.top*D-(A.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(G?0:C.scrollTop()))*D)),left:(H.left+this.offset.relative.left*D+this.offset.parent.left*D-(A.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():G?0:C.scrollLeft())*D))}},_generatePosition:function(F){var I=this.options,C=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&A.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,J=(/(html|body)/i).test(C[0].tagName);if(this.cssPosition=="relative"&&!(this.scrollParent[0]!=document&&this.scrollParent[0]!=this.offsetParent[0])){this.offset.relative=this._getRelativeOffset()}var E=F.pageX;var D=F.pageY;if(this.originalPosition){if(this.containment){if(F.pageX-this.offset.click.left<this.containment[0]){E=this.containment[0]+this.offset.click.left}if(F.pageY-this.offset.click.top<this.containment[1]){D=this.containment[1]+this.offset.click.top}if(F.pageX-this.offset.click.left>this.containment[2]){E=this.containment[2]+this.offset.click.left}if(F.pageY-this.offset.click.top>this.containment[3]){D=this.containment[3]+this.offset.click.top}}if(I.grid){var H=this.originalPageY+Math.round((D-this.originalPageY)/I.grid[1])*I.grid[1];D=this.containment?(!(H-this.offset.click.top<this.containment[1]||H-this.offset.click.top>this.containment[3])?H:(!(H-this.offset.click.top<this.containment[1])?H-I.grid[1]:H+I.grid[1])):H;var G=this.originalPageX+Math.round((E-this.originalPageX)/I.grid[0])*I.grid[0];E=this.containment?(!(G-this.offset.click.left<this.containment[0]||G-this.offset.click.left>this.containment[2])?G:(!(G-this.offset.click.left<this.containment[0])?G-I.grid[0]:G+I.grid[0])):G}}return{top:(D-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(A.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(J?0:C.scrollTop())))),left:(E-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(A.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():J?0:C.scrollLeft())))}},_rearrange:function(H,G,D,F){D?D[0].appendChild(this.placeholder[0]):G.item[0].parentNode.insertBefore(this.placeholder[0],(this.direction=="down"?G.item[0]:G.item[0].nextSibling));this.counter=this.counter?++this.counter:1;var E=this,C=this.counter;window.setTimeout(function(){if(C==E.counter){E.refreshPositions(!F)}},0)},_clear:function(E,F){this.reverting=false;var G=[],C=this;if(!this._noFinalSort&&this.currentItem[0].parentNode){this.placeholder.before(this.currentItem)}this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var D in this._storedCSS){if(this._storedCSS[D]=="auto"||this._storedCSS[D]=="static"){this._storedCSS[D]=""}}this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else{this.currentItem.show()}if(this.fromOutside&&!F){G.push(function(H){this._trigger("receive",H,this._uiHash(this.fromOutside))})}if((this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!F){G.push(function(H){this._trigger("update",H,this._uiHash())})}if(!A.ui.contains(this.element[0],this.currentItem[0])){if(!F){G.push(function(H){this._trigger("remove",H,this._uiHash())})}for(var D=this.containers.length-1;D>=0;D--){if(A.ui.contains(this.containers[D].element[0],this.currentItem[0])&&!F){G.push((function(H){return function(I){H._trigger("receive",I,this._uiHash(this))}}).call(this,this.containers[D]));G.push((function(H){return function(I){H._trigger("update",I,this._uiHash(this))}}).call(this,this.containers[D]))}}}for(var D=this.containers.length-1;D>=0;D--){if(!F){G.push((function(H){return function(I){H._trigger("deactivate",I,this._uiHash(this))}}).call(this,this.containers[D]))}if(this.containers[D].containerCache.over){G.push((function(H){return function(I){H._trigger("out",I,this._uiHash(this))}}).call(this,this.containers[D]));this.containers[D].containerCache.over=0}}if(this._storedCursor){A("body").css("cursor",this._storedCursor)}if(this._storedOpacity){this.helper.css("opacity",this._storedOpacity)}if(this._storedZIndex){this.helper.css("zIndex",this._storedZIndex=="auto"?"":this._storedZIndex)}this.dragging=false;if(this.cancelHelperRemoval){if(!F){this._trigger("beforeStop",E,this._uiHash());for(var D=0;D<G.length;D++){G[D].call(this,E)}this._trigger("stop",E,this._uiHash())}return false}if(!F){this._trigger("beforeStop",E,this._uiHash())}this.placeholder[0].parentNode.removeChild(this.placeholder[0]);if(this.helper[0]!=this.currentItem[0]){this.helper.remove()}this.helper=null;if(!F){for(var D=0;D<G.length;D++){G[D].call(this,E)}this._trigger("stop",E,this._uiHash())}this.fromOutside=false;return true},_trigger:function(){if(A.Widget.prototype._trigger.apply(this,arguments)===false){this.cancel()}},_uiHash:function(D){var C=D||this;return{helper:C.helper,placeholder:C.placeholder||A([]),position:C.position,originalPosition:C.originalPosition,offset:C.positionAbs,item:C.currentItem,sender:D?D.element:null}}});A.extend(A.ui.sortable,{version:"1.8.11"})})(jQuery);
/* module-key = 'com.atlassian.auiplugin:ajs', location = 'js/external/jquery/jquery-ui-1.7-bug-fixes.js' */
jQuery.ui.draggable.prototype._mouseCapture=(function(A){return function(C){var B=A.call(this,C);if(B&&jQuery.browser.msie){C.stopPropagation()}return B}})(jQuery.ui.draggable.prototype._mouseCapture);
/* module-key = 'com.atlassian.auiplugin:ajs', location = 'js/external/jquery/plugins/jquery.form.js' */
/*
 * jQuery Form Plugin
 * version: 2.67 (12-MAR-2011)
 * @requires jQuery v1.3.2 or later
 *
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */
(function(B){B.fn.ajaxSubmit=function(Q){if(!this.length){A("ajaxSubmit: skipping submit process - no element selected");return this}if(typeof Q=="function"){Q={success:Q}}var H=this.attr("action");var D=(typeof H==="string")?B.trim(H):"";if(D){D=(D.match(/^([^#]+)/)||[])[1]}D=D||window.location.href||"";Q=B.extend(true,{url:D,type:this[0].getAttribute("method")||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},Q);var R={};this.trigger("form-pre-serialize",[this,Q,R]);if(R.veto){A("ajaxSubmit: submit vetoed via form-pre-serialize trigger");return this}if(Q.beforeSerialize&&Q.beforeSerialize(this,Q)===false){A("ajaxSubmit: submit aborted via beforeSerialize callback");return this}var F,N,L=this.formToArray(Q.semantic);if(Q.data){Q.extraData=Q.data;for(F in Q.data){if(Q.data[F] instanceof Array){for(var I in Q.data[F]){L.push({name:F,value:Q.data[F][I]})}}else{N=Q.data[F];N=B.isFunction(N)?N():N;L.push({name:F,value:N})}}}if(Q.beforeSubmit&&Q.beforeSubmit(L,this,Q)===false){A("ajaxSubmit: submit aborted via beforeSubmit callback");return this}this.trigger("form-submit-validate",[L,this,Q,R]);if(R.veto){A("ajaxSubmit: submit vetoed via form-submit-validate trigger");return this}var C=B.param(L);if(Q.type.toUpperCase()=="GET"){Q.url+=(Q.url.indexOf("?")>=0?"&":"?")+C;Q.data=null}else{Q.data=C}var P=this,K=[];if(Q.resetForm){K.push(function(){P.resetForm()})}if(Q.clearForm){K.push(function(){P.clearForm()})}if(!Q.dataType&&Q.target){var O=Q.success||function(){};K.push(function(T){var S=Q.replaceTarget?"replaceWith":"html";B(Q.target)[S](T).each(O,arguments)})}else{if(Q.success){K.push(Q.success)}}Q.success=function(W,T,X){var V=Q.context||Q;for(var U=0,S=K.length;U<S;U++){K[U].apply(V,[W,T,X||P,P])}};var G=B("input:file",this).length>0;var E="multipart/form-data";var J=(P.attr("enctype")==E||P.attr("encoding")==E);if(Q.iframe!==false&&(G||Q.iframe||J)){if(Q.closeKeepAlive){B.get(Q.closeKeepAlive,M)}else{M()}}else{B.ajax(Q)}this.trigger("form-submit-notify",[this,Q]);return this;function M(){var U=P[0];if(B(":input[name=submit],:input[id=submit]",U).length){alert('Error: Form elements must not have name or id of "submit".');return }var a=B.extend(true,{},B.ajaxSettings,Q);a.context=a.context||a;var d="jqFormIO"+(new Date().getTime()),Y="_"+d;var V=B('<iframe id="'+d+'" name="'+d+'" src="'+a.iframeSrc+'" />');var Z=V[0];V.css({position:"absolute",top:"-1000px",left:"-1000px"});var W={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(){A("aborting upload...");var g="aborted";this.aborted=1;V.attr("src",a.iframeSrc);W.error=g;a.error&&a.error.call(a.context,W,"error",g);i&&B.event.trigger("ajaxError",[W,a,g]);a.complete&&a.complete.call(a.context,W,"error")}};var i=a.global;if(i&&!B.active++){B.event.trigger("ajaxStart")}if(i){B.event.trigger("ajaxSend",[W,a])}if(a.beforeSend&&a.beforeSend.call(a.context,W,a)===false){if(a.global){B.active--}return }if(W.aborted){return }var h=0;var X=U.clk;if(X){var e=X.name;if(e&&!X.disabled){a.extraData=a.extraData||{};a.extraData[e]=X.value;if(X.type=="image"){a.extraData[e+".x"]=U.clk_x;a.extraData[e+".y"]=U.clk_y}}}function f(){var o=P.attr("target"),g=P.attr("action");U.setAttribute("target",d);if(U.getAttribute("method")!="POST"){U.setAttribute("method","POST")}if(U.getAttribute("action")!=a.url){U.setAttribute("action",a.url)}if(!a.skipEncodingOverride){P.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"})}if(a.timeout){setTimeout(function(){h=true;c()},a.timeout)}var m=[];try{if(a.extraData){for(var p in a.extraData){m.push(B('<input type="hidden" name="'+p+'" value="'+a.extraData[p]+'" />').appendTo(U)[0])}}V.appendTo("body");Z.attachEvent?Z.attachEvent("onload",c):Z.addEventListener("load",c,false);U.submit()}finally{U.setAttribute("action",g);if(o){U.setAttribute("target",o)}else{P.removeAttr("target")}B(m).remove()}}if(a.forceSync){f()}else{setTimeout(f,10)}var k,l,j=50;function c(){if(W.aborted){return }var r=Z.contentWindow?Z.contentWindow.document:Z.contentDocument?Z.contentDocument:Z.document;if(!r||r.location.href==a.iframeSrc){return }Z.detachEvent?Z.detachEvent("onload",c):Z.removeEventListener("load",c,false);var n=true;try{if(h){throw"timeout"}var s=a.dataType=="xml"||r.XMLDocument||B.isXMLDoc(r);A("isXml="+s);if(!s&&window.opera&&(r.body==null||r.body.innerHTML=="")){if(--j){A("requeing onLoad callback, DOM not available");setTimeout(c,250);return }}W.responseText=r.body?r.body.innerHTML:r.documentElement?r.documentElement.innerHTML:null;W.responseXML=r.XMLDocument?r.XMLDocument:r;W.getResponseHeader=function(u){var t={"content-type":a.dataType};return t[u]};var q=/(json|script)/.test(a.dataType);if(q||a.textarea){var m=r.getElementsByTagName("textarea")[0];if(m){W.responseText=m.value}else{if(q){var p=r.getElementsByTagName("pre")[0];var g=r.getElementsByTagName("body")[0];if(p){W.responseText=p.textContent}else{if(g){W.responseText=g.innerHTML}}}}}else{if(a.dataType=="xml"&&!W.responseXML&&W.responseText!=null){W.responseXML=b(W.responseText)}}k=S(W,a.dataType,a)}catch(o){A("error caught:",o);n=false;W.error=o;a.error&&a.error.call(a.context,W,"error",o);i&&B.event.trigger("ajaxError",[W,a,o])}if(W.aborted){A("upload aborted");n=false}if(n){a.success&&a.success.call(a.context,k,"success",W);i&&B.event.trigger("ajaxSuccess",[W,a])}i&&B.event.trigger("ajaxComplete",[W,a]);if(i&&!--B.active){B.event.trigger("ajaxStop")}a.complete&&a.complete.call(a.context,W,n?"success":"error");setTimeout(function(){V.removeData("form-plugin-onload");V.remove();W.responseXML=null},100)}var b=B.parseXML||function(g,m){if(window.ActiveXObject){m=new ActiveXObject("Microsoft.XMLDOM");m.async="false";m.loadXML(g)}else{m=(new DOMParser()).parseFromString(g,"text/xml")}return(m&&m.documentElement&&m.documentElement.nodeName!="parsererror")?m:null};var T=B.parseJSON||function(g){return window["eval"]("("+g+")")};var S=function(q,o,n){var m=q.getResponseHeader("content-type")||"",g=o==="xml"||!o&&m.indexOf("xml")>=0,p=g?q.responseXML:q.responseText;if(g&&p.documentElement.nodeName==="parsererror"){B.error&&B.error("parsererror")}if(n&&n.dataFilter){p=n.dataFilter(p,o)}if(typeof p==="string"){if(o==="json"||!o&&m.indexOf("json")>=0){p=T(p)}else{if(o==="script"||!o&&m.indexOf("javascript")>=0){B.globalEval(p)}}}return p}}};B.fn.ajaxForm=function(C){if(this.length===0){var D={s:this.selector,c:this.context};if(!B.isReady&&D.s){A("DOM not ready, queuing ajaxForm");B(function(){B(D.s,D.c).ajaxForm(C)});return this}A("terminating; zero elements found by selector"+(B.isReady?"":" (DOM not ready)"));return this}return this.ajaxFormUnbind().bind("submit.form-plugin",function(E){if(!E.isDefaultPrevented()){E.preventDefault();B(this).ajaxSubmit(C)}}).bind("click.form-plugin",function(I){var H=I.target;var F=B(H);if(!(F.is(":submit,input:image"))){var E=F.closest(":submit");if(E.length==0){return }H=E[0]}var G=this;G.clk=H;if(H.type=="image"){if(I.offsetX!=undefined){G.clk_x=I.offsetX;G.clk_y=I.offsetY}else{if(typeof B.fn.offset=="function"){var J=F.offset();G.clk_x=I.pageX-J.left;G.clk_y=I.pageY-J.top}else{G.clk_x=I.pageX-H.offsetLeft;G.clk_y=I.pageY-H.offsetTop}}}setTimeout(function(){G.clk=G.clk_x=G.clk_y=null},100)})};B.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};B.fn.formToArray=function(N){var M=[];if(this.length===0){return M}var D=this[0];var G=N?D.getElementsByTagName("*"):D.elements;if(!G){return M}var I,H,F,O,E,K,C;for(I=0,K=G.length;I<K;I++){E=G[I];F=E.name;if(!F){continue}if(N&&D.clk&&E.type=="image"){if(!E.disabled&&D.clk==E){M.push({name:F,value:B(E).val()});M.push({name:F+".x",value:D.clk_x},{name:F+".y",value:D.clk_y})}continue}O=B.fieldValue(E,true);if(O&&O.constructor==Array){for(H=0,C=O.length;H<C;H++){M.push({name:F,value:O[H]})}}else{if(O!==null&&typeof O!="undefined"){M.push({name:F,value:O})}}}if(!N&&D.clk){var J=B(D.clk),L=J[0];F=L.name;if(F&&!L.disabled&&L.type=="image"){M.push({name:F,value:J.val()});M.push({name:F+".x",value:D.clk_x},{name:F+".y",value:D.clk_y})}}return M};B.fn.formSerialize=function(C){return B.param(this.formToArray(C))};B.fn.fieldSerialize=function(D){var C=[];this.each(function(){var H=this.name;if(!H){return }var F=B.fieldValue(this,D);if(F&&F.constructor==Array){for(var G=0,E=F.length;G<E;G++){C.push({name:H,value:F[G]})}}else{if(F!==null&&typeof F!="undefined"){C.push({name:this.name,value:F})}}});return B.param(C)};B.fn.fieldValue=function(H){for(var G=[],E=0,C=this.length;E<C;E++){var F=this[E];var D=B.fieldValue(F,H);if(D===null||typeof D=="undefined"||(D.constructor==Array&&!D.length)){continue}D.constructor==Array?B.merge(G,D):G.push(D)}return G};B.fieldValue=function(C,I){var E=C.name,N=C.type,O=C.tagName.toLowerCase();if(I===undefined){I=true}if(I&&(!E||C.disabled||N=="reset"||N=="button"||(N=="checkbox"||N=="radio")&&!C.checked||(N=="submit"||N=="image")&&C.form&&C.form.clk!=C||O=="select"&&C.selectedIndex==-1)){return null}if(O=="select"){var J=C.selectedIndex;if(J<0){return null}var L=[],D=C.options;var G=(N=="select-one");var K=(G?J+1:D.length);for(var F=(G?J:0);F<K;F++){var H=D[F];if(H.selected){var M=H.value;if(!M){M=(H.attributes&&H.attributes.value&&!(H.attributes.value.specified))?H.text:H.value}if(G){return M}L.push(M)}}return L}return B(C).val()};B.fn.clearForm=function(){return this.each(function(){B("input,select,textarea",this).clearFields()})};B.fn.clearFields=B.fn.clearInputs=function(){return this.each(function(){var D=this.type,C=this.tagName.toLowerCase();if(D=="text"||D=="password"||C=="textarea"){this.value=""}else{if(D=="checkbox"||D=="radio"){this.checked=false}else{if(C=="select"){this.selectedIndex=-1}}}})};B.fn.resetForm=function(){return this.each(function(){if(typeof this.reset=="function"||(typeof this.reset=="object"&&!this.reset.nodeType)){this.reset()}})};B.fn.enable=function(C){if(C===undefined){C=true}return this.each(function(){this.disabled=!C})};B.fn.selected=function(C){if(C===undefined){C=true}return this.each(function(){var D=this.type;if(D=="checkbox"||D=="radio"){this.checked=C}else{if(this.tagName.toLowerCase()=="option"){var E=B(this).parent("select");if(C&&E[0]&&E[0].type=="select-one"){E.find("option").selected(false)}this.selected=C}}})};function A(){if(B.fn.ajaxSubmit.debug){var C="[jquery.form] "+Array.prototype.join.call(arguments,"");if(window.console&&window.console.log){window.console.log(C)}else{if(window.opera&&window.opera.postError){window.opera.postError(C)}}}}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:ajs', location = 'js/atlassian/jquery/jquery.hotkeys.js' */
(function(D){D.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",91:"meta",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",188:",",190:".",191:"/",224:"meta",219:"[",221:"]"},keypressKeys:["<",">","?"],shiftNums:{"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|"}};D.each(D.hotkeys.keypressKeys,function(E,F){D.hotkeys.shiftNums[F]=F});function A(E){this.num=0;this.timer=E>0?E:false}A.prototype.val=function(){return this.num};A.prototype.inc=function(){if(this.timer){clearTimeout(this.timeout);this.timeout=setTimeout(D.proxy(A.prototype.reset,this),this.timer)}this.num++};A.prototype.reset=function(){if(this.timer){clearTimeout(this.timeout)}this.num=0};function C(G){if(!(D.isPlainObject(G.data)||D.isArray(G.data)||typeof G.data==="string")){return }var F=G.handler,E={timer:700};(function(H){if(typeof H==="string"){E.combo=[H]}else{if(D.isArray(H)){E.combo=H}else{D.extend(E,H)}}E.combo=D.map(E.combo,function(I){return I.toLowerCase()})})(G.data);G.index=new A(E.timer);G.handler=function(M){if(this!==M.target&&(/textarea|select|input/i.test(M.target.nodeName))){return }var J=M.type!=="keypress"?D.hotkeys.specialKeys[M.which]:null,N=String.fromCharCode(M.which).toLowerCase(),K,L="",I={};if(M.altKey&&J!=="alt"){L+="alt+"}if(M.ctrlKey&&J!=="ctrl"){L+="ctrl+"}if(M.metaKey&&!M.ctrlKey&&J!=="meta"){L+="meta+"}if(M.shiftKey&&J!=="shift"){L+="shift+"}if(J){I[L+J]=true}if(N){I[L+N]=true}if(/shift+/.test(L)){I[L.replace("shift+","")+D.hotkeys.shiftNums[(J||N)]]=true}var H=G.index,O=E.combo;if(B(O[H.val()],I)){if(H.val()===O.length-1){H.reset();return F.apply(this,arguments)}else{H.inc()}}else{H.reset();if(B(O[0],I)){H.inc()}}}}function B(H,F){var I=H.split(" ");for(var G=0,E=I.length;G<E;G++){if(F[I[G]]){return true}}return false}D.each(["keydown","keyup","keypress"],function(){D.event.special[this]={add:C}})})(jQuery);
/* module-key = 'com.atlassian.auiplugin:ajs', location = 'js/atlassian/jquery/jquery.moveto.js' */
jQuery.fn.moveTo=function(C){var F={transition:false,scrollOffset:35};var E=jQuery.extend(F,C),A=this,D=A.offset().top,B;if((jQuery(window).scrollTop()+jQuery(window).height()-this.outerHeight()<D||jQuery(window).scrollTop()+E.scrollOffset>D)&&jQuery(window).height()>E.scrollOffset){if(jQuery(window).scrollTop()+E.scrollOffset>D){B=D-(jQuery(window).height()-this.outerHeight())+E.scrollOffset}else{B=D-E.scrollOffset}if(!jQuery.fn.moveTo.animating&&E.transition){jQuery(document).trigger("moveToStarted",this);jQuery.fn.moveTo.animating=true;jQuery("html,body").animate({scrollTop:B},1000,function(){jQuery(document).trigger("moveToFinished",A);delete jQuery.fn.moveTo.animating});return this}else{if(jQuery("html, body").is(":animated")){jQuery("html, body").stop();delete jQuery.fn.moveTo.animating}jQuery(document).trigger("moveToStarted");jQuery(window).scrollTop(B);setTimeout(function(){jQuery(document).trigger("moveToFinished",A)},100);return this}}jQuery(document).trigger("moveToFinished",this);return this};
/* module-key = 'com.atlassian.auiplugin:ajs', location = 'js/atlassian/event.js' */
AJS.bind=function(A,C,B){try{if(typeof B==="function"){return AJS.$(window).bind(A,C,B)}else{return AJS.$(window).bind(A,C)}}catch(D){AJS.log("error while binding: "+D.message)}};AJS.unbind=function(A,B){try{return AJS.$(window).unbind(A,B)}catch(C){AJS.log("error while unbinding: "+C.message)}};AJS.trigger=function(A,C){try{return AJS.$(window).trigger(A,C)}catch(B){AJS.log("error while triggering: "+B.message)}};
/* module-key = 'com.atlassian.auiplugin:ajs', location = 'js/atlassian/cookie.js' */
(function(){var B="AJS.conglomerate.cookie",F=/(\\|^"|"$)/g,G=/\|\|+/g,I=/"/g,C=/[.*+?|^$()[\]{\\]/g;function E(L,O){O=O||"";var N=new RegExp(D(L)+"=([^|]+)"),M=O.match(N);return M&&M[1]}function J(L,N,P){var M=new RegExp("(\\s|\\|)*\\b"+D(L)+"=[^|]*[|]*");P=P||"";P=P.replace(M,"|");if(N!==""){var O=L+"="+N;if(P.length+O.length<4020){P+="|"+O}}return P.replace(G,"|")}function H(L){return L.replace(F,"")}function K(L){var N=new RegExp("\\b"+D(L)+"=((?:[^\\\\;]+|\\\\.)*)(?:;|$)"),M=document.cookie.match(N);return M&&H(M[1])}function A(M,O,Q){var N="",P,L='"'+O.replace(I,'\\"')+'"';if(Q){P=new Date();P.setTime(+P+Q*24*60*60*1000);N="; expires="+P.toGMTString()}document.cookie=M+"="+L+N+";path=/"}function D(L){return L.replace(C,"\\$&")}AJS.Cookie={save:function(M,N,L){var O=K(B);O=J(M,N,O);A(B,O,L||365)},read:function(M,L){var O=K(B);var N=E(M,O);if(N!=null){return N}return L},erase:function(L){this.save(L,"")}}})();
/* module-key = 'com.atlassian.auiplugin:ajs', location = '${pdl.dir}js/atlassian/dialog.js' */
AJS.popup=function(I){var D={width:800,height:600,closeOnOutsideClick:false,keypressListener:function(J){if(J.keyCode===27&&B.is(":visible")){F.hide()}}};if(typeof I!="object"){I={width:arguments[0],height:arguments[1],id:arguments[2]};I=AJS.$.extend({},I,arguments[3])}I=AJS.$.extend({},D,I);var B=AJS("div").addClass("aui-popup");if(I.id){B.attr("id",I.id)}var E=3000;AJS.$(".aui-dialog").each(function(){var J=AJS.$(this);E=(J.css("z-index")>E)?J.css("z-index"):E});var G=(function(K,J){I.width=(K=(K||I.width));I.height=(J=(J||I.height));B.css({marginTop:-Math.round(J/2)+"px",marginLeft:-Math.round(K/2)+"px",width:K,height:J,"z-index":parseInt(E,10)+2});return arguments.callee})(I.width,I.height);AJS.$("body").append(B);B.hide();B.enable();var C=AJS.$(".aui-blanket"),A=function(J,K){var L=AJS.$(J,K);if(L.length){L.focus();return true}return false},H=function(J){if(AJS.$(".dialog-page-body",J).find(":focus").length!==0){return }if(I.focusSelector){return A(I.focusSelector,J)}var K=":input:visible:enabled:first";if(A(K,AJS.$(".dialog-page-body",J))){return }if(A(K,AJS.$(".dialog-button-panel",J))){return }A(K,AJS.$(".dialog-page-menu",J))};var F={changeSize:function(J,K){if((J&&J!=I.width)||(K&&K!=I.height)){G(J,K)}this.show()},show:function(){var J=function(){var K=5;if(AJS.$.browser.msie&&~~(AJS.$.browser.version)<9){K=3}AJS.$(document).keydown(I.keypressListener);AJS.dim();C=AJS.$(".aui-blanket");if(C.size()!=0&&I.closeOnOutsideClick){C.click(function(){if(B.is(":visible")){F.hide()}})}B.show();AJS.popup.current=this;H(B);AJS.$(document).trigger("showLayer",["popup",this])};J.call(this);this.show=J},hide:function(){AJS.$(document).unbind("keydown",I.keypressListener);C.unbind();this.element.hide();if(AJS.$(".aui-dialog:visible").size()==0){AJS.undim()}var J=document.activeElement;if(this.element.has(J).length){J.blur()}AJS.$(document).trigger("hideLayer",["popup",this]);AJS.popup.current=null;this.enable()},element:B,remove:function(){B.remove();this.element=null},disable:function(){if(!this.disabled){this.popupBlanket=AJS.$("<div class='dialog-blanket'> </div>").css({height:B.height(),width:B.width()});B.append(this.popupBlanket);this.disabled=true}},enable:function(){if(this.disabled){this.disabled=false;this.popupBlanket.remove();this.popupBlanket=null}}};return F};(function(){function F(N,L,K,M){if(!N.buttonpanel){N.addButtonPanel()}this.page=N;this.onclick=K;this._onclick=function(){return K.call(this,N.dialog,N)===true};this.item=AJS("button",L).addClass("button-panel-button");if(M){this.item.addClass(M)}if(typeof K=="function"){this.item.click(this._onclick)}N.buttonpanel.append(this.item);this.id=N.button.length;N.button[this.id]=this}function A(O,M,L,N,K){if(!O.buttonpanel){O.addButtonPanel()}if(!K){K="#"}this.page=O;this.onclick=L;this._onclick=function(){return L.call(this,O.dialog,O)===true};this.item=AJS("a",M).attr("href",K).addClass("button-panel-link");if(N){this.item.addClass(N)}if(typeof L=="function"){this.item.click(this._onclick)}O.buttonpanel.append(this.item);this.id=O.button.length;O.button[this.id]=this}function B(M,L){var K=M=="left"?-1:1;return function(Q){var O=this.page[L];if(this.id!=((K==1)?O.length-1:0)){K*=(Q||1);O[this.id+K].item[(K<0?"before":"after")](this.item);O.splice(this.id,1);O.splice(this.id+K,0,this);for(var N=0,P=O.length;N<P;N++){if(L=="panel"&&this.page.curtab==O[N].id){this.page.curtab=N}O[N].id=N}}return this}}function G(K){return function(){this.page[K].splice(this.id,1);for(var L=0,M=this.page[K].length;L<M;L++){this.page[K][L].id=L}this.item.remove()}}F.prototype.moveUp=F.prototype.moveLeft=B("left","button");F.prototype.moveDown=F.prototype.moveRight=B("right","button");F.prototype.remove=G("button");F.prototype.html=function(K){return this.item.html(K)};F.prototype.onclick=function(K){if(typeof K=="undefined"){return this.onclick}else{this.item.unbind("click",this._onclick);this._onclick=function(){return K.call(this,page.dialog,page)===true};if(typeof K=="function"){this.item.click(this._onclick)}}};var D=20;var H=function(Q,R,K,P,N){if(!(K instanceof AJS.$)){K=AJS.$(K)}this.dialog=Q.dialog;this.page=Q;this.id=Q.panel.length;this.button=AJS("button").html(R).addClass("item-button");if(N){this.button[0].id=N}this.item=AJS("li").append(this.button).addClass("page-menu-item");this.body=AJS("div").append(K).addClass("dialog-panel-body").css("height",Q.dialog.height+"px");this.padding=D;if(P){this.body.addClass(P)}var M=Q.panel.length,O=this;Q.menu.append(this.item);Q.body.append(this.body);Q.panel[M]=this;var L=function(){var S;if(Q.curtab+1){S=Q.panel[Q.curtab];S.body.hide();S.item.removeClass("selected");(typeof S.onblur=="function")&&S.onblur()}Q.curtab=O.id;O.body.show();O.item.addClass("selected");(typeof O.onselect=="function")&&O.onselect();(typeof Q.ontabchange=="function")&&Q.ontabchange(O,S)};if(!this.button.click){AJS.log("atlassian-dialog:Panel:constructor - this.button.click false");this.button.onclick=L}else{this.button.click(L)}L();if(M==0){Q.menu.css("display","none")}else{Q.menu.show()}};H.prototype.select=function(){this.button.click()};H.prototype.moveUp=H.prototype.moveLeft=B("left","panel");H.prototype.moveDown=H.prototype.moveRight=B("right","panel");H.prototype.remove=G("panel");H.prototype.html=function(K){if(K){this.body.html(K);return this}else{return this.body.html()}};H.prototype.setPadding=function(K){if(!isNaN(+K)){this.body.css("padding",+K);this.padding=+K;this.page.recalcSize()}return this};var E=56;var C=51;var I=50;var J=function(K,L){this.dialog=K;this.id=K.page.length;this.element=AJS("div").addClass("dialog-components");this.body=AJS("div").addClass("dialog-page-body");this.menu=AJS("ul").addClass("dialog-page-menu").css("height",K.height+"px");this.body.append(this.menu);this.curtab;this.panel=[];this.button=[];if(L){this.body.addClass(L)}K.popup.element.append(this.element.append(this.menu).append(this.body));K.page[K.page.length]=this};J.prototype.recalcSize=function(){var K=this.header?E:0;var N=this.buttonpanel?C:0;for(var M=this.panel.length;M--;){var L=this.dialog.height-K-N;this.panel[M].body.css("height",L);this.menu.css("height",L)}};J.prototype.addButtonPanel=function(){this.buttonpanel=AJS("div").addClass("dialog-button-panel");this.element.append(this.buttonpanel)};J.prototype.addPanel=function(N,K,M,L){new H(this,N,K,M,L);this.recalcSize();return this};J.prototype.addHeader=function(L,K){if(this.header){this.header.remove()}this.header=AJS("h2").text(L||"").addClass("dialog-title");K&&this.header.addClass(K);this.element.prepend(this.header);this.recalcSize();return this};J.prototype.addButton=function(L,K,M){new F(this,L,K,M);this.recalcSize();return this};J.prototype.addLink=function(M,L,N,K){new A(this,M,L,N,K);this.recalcSize();return this};J.prototype.gotoPanel=function(K){this.panel[K.id||K].select()};J.prototype.getCurrentPanel=function(){return this.panel[this.curtab]};J.prototype.hide=function(){this.element.hide()};J.prototype.show=function(){this.element.show()};J.prototype.remove=function(){this.element.remove()};AJS.Dialog=function(M,K,N){var L={};if(!+M){L=Object(M);M=L.width;K=L.height;N=L.id}this.height=K||480;this.width=M||640;this.id=N;L=AJS.$.extend({},L,{width:this.width,height:this.height,id:this.id});this.popup=AJS.popup(L);this.popup.element.addClass("aui-dialog");this.page=[];this.curpage=0;new J(this)};AJS.Dialog.prototype.addHeader=function(L,K){this.page[this.curpage].addHeader(L,K);return this};AJS.Dialog.prototype.addButton=function(L,K,M){this.page[this.curpage].addButton(L,K,M);return this};AJS.Dialog.prototype.addLink=function(M,L,N,K){this.page[this.curpage].addLink(M,L,N,K);return this};AJS.Dialog.prototype.addSubmit=function(L,K){this.page[this.curpage].addButton(L,K,"button-panel-submit-button");return this};AJS.Dialog.prototype.addCancel=function(L,K){this.page[this.curpage].addLink(L,K,"button-panel-cancel-link");return this};AJS.Dialog.prototype.addButtonPanel=function(){this.page[this.curpage].addButtonPanel();return this};AJS.Dialog.prototype.addPanel=function(N,K,M,L){this.page[this.curpage].addPanel(N,K,M,L);return this};AJS.Dialog.prototype.addPage=function(K){new J(this,K);this.page[this.curpage].hide();this.curpage=this.page.length-1;return this};AJS.Dialog.prototype.nextPage=function(){this.page[this.curpage++].hide();if(this.curpage>=this.page.length){this.curpage=0}this.page[this.curpage].show();return this};AJS.Dialog.prototype.prevPage=function(){this.page[this.curpage--].hide();if(this.curpage<0){this.curpage=this.page.length-1}this.page[this.curpage].show();return this};AJS.Dialog.prototype.gotoPage=function(K){this.page[this.curpage].hide();this.curpage=K;if(this.curpage<0){this.curpage=this.page.length-1}else{if(this.curpage>=this.page.length){this.curpage=0}}this.page[this.curpage].show();return this};AJS.Dialog.prototype.getPanel=function(L,M){var K=(M==null)?this.curpage:L;if(M==null){M=L}return this.page[K].panel[M]};AJS.Dialog.prototype.getPage=function(K){return this.page[K]};AJS.Dialog.prototype.getCurrentPanel=function(){return this.page[this.curpage].getCurrentPanel()};AJS.Dialog.prototype.gotoPanel=function(M,L){if(L!=null){var K=M.id||M;this.gotoPage(K)}this.page[this.curpage].gotoPanel(typeof L=="undefined"?M:L)};AJS.Dialog.prototype.show=function(){this.popup.show();AJS.trigger("show.dialog",{dialog:this});return this};AJS.Dialog.prototype.hide=function(){this.popup.hide();AJS.trigger("hide.dialog",{dialog:this});return this};AJS.Dialog.prototype.remove=function(){this.popup.hide();this.popup.remove();AJS.trigger("remove.dialog",{dialog:this})};AJS.Dialog.prototype.disable=function(){this.popup.disable();return this};AJS.Dialog.prototype.enable=function(){this.popup.enable();return this};AJS.Dialog.prototype.get=function(S){var L=[],R=this;var T='#([^"][^ ]*|"[^"]*")';var U=":(\\d+)";var M="page|panel|button|header";var N="(?:("+M+")(?:"+T+"|"+U+")?|"+T+")";var P=new RegExp("(?:^|,)\\s*"+N+"(?:\\s+"+N+")?\\s*(?=,|$)","ig");(S+"").replace(P,function(f,V,e,W,c,b,Y,g,d){V=V&&V.toLowerCase();var X=[];if(V=="page"&&R.page[W]){X.push(R.page[W]);V=b;V=V&&V.toLowerCase();e=Y;W=g;c=d}else{X=R.page}e=e&&(e+"").replace(/"/g,"");Y=Y&&(Y+"").replace(/"/g,"");c=c&&(c+"").replace(/"/g,"");d=d&&(d+"").replace(/"/g,"");if(V||c){for(var a=X.length;a--;){if(c||(V=="panel"&&(e||(!e&&W==null)))){for(var Z=X[a].panel.length;Z--;){if(X[a].panel[Z].button.html()==c||X[a].panel[Z].button.html()==e||(V=="panel"&&!e&&W==null)){L.push(X[a].panel[Z])}}}if(c||(V=="button"&&(e||(!e&&W==null)))){for(var Z=X[a].button.length;Z--;){if(X[a].button[Z].item.html()==c||X[a].button[Z].item.html()==e||(V=="button"&&!e&&W==null)){L.push(X[a].button[Z])}}}if(X[a][V]&&X[a][V][W]){L.push(X[a][V][W])}if(V=="header"&&X[a].header){L.push(X[a].header)}}}else{L=L.concat(X)}});var Q={length:L.length};for(var O=L.length;O--;){Q[O]=L[O];for(var K in L[O]){if(!(K in Q)){(function(V){Q[V]=function(){for(var W=this.length;W--;){if(typeof this[W][V]=="function"){this[W][V].apply(this[W],arguments)}}}})(K)}}}return Q};AJS.Dialog.prototype.updateHeight=function(){var K=0;var M=AJS.$(window).height()-E-C-(I*2);for(var L=0;this.getPanel(L);L++){if(this.getPanel(L).body.css({height:"auto",display:"block"}).outerHeight()>K){K=Math.min(M,this.getPanel(L).body.outerHeight())}if(L!==this.page[this.curpage].curtab){this.getPanel(L).body.css({display:"none"})}}for(L=0;this.getPanel(L);L++){this.getPanel(L).body.css({height:K||this.height})}this.page[0].menu.height(K);this.height=K+E+C+1;this.popup.changeSize(undefined,this.height)};AJS.Dialog.prototype.isMaximised=function(){return this.popup.element.outerHeight()>=AJS.$(window).height()-(I*2)};AJS.Dialog.prototype.getCurPanel=function(){return this.getPanel(this.page[this.curpage].curtab)};AJS.Dialog.prototype.getCurPanelButton=function(){return this.getCurPanel().button}})();
/* module-key = 'com.atlassian.auiplugin:ajs', location = 'js/atlassian/inline-dialog.js' */
(function(B){AJS.InlineDialog=function(V,I,L,J){if(J&&J.getArrowAttributes){AJS.log("DEPRECATED: getArrowAttributes - See https://ecosystem.atlassian.net/browse/AUI-1362")}if(J&&J.getArrowPath){AJS.log("DEPRECATED: getArrowPath - See https://ecosystem.atlassian.net/browse/AUI-1362")}if(typeof I==="undefined"){I=String(Math.random()).replace(".","");if(B("#inline-dialog-"+I+", #arrow-"+I+", #inline-dialog-shim-"+I).length){throw"GENERATED_IDENTIFIER_NOT_UNIQUE"}}var T=B.extend(false,AJS.InlineDialog.opts,J);var P=function(){return window.Raphael&&J&&(J.getArrowPath||J.getArrowAttributes)};var F;var K;var d;var O=false;var U=false;var b=false;var c;var R;var C=B('<div id="inline-dialog-'+I+'" class="aui-inline-dialog"><div class="contents"></div><div id="arrow-'+I+'" class="arrow"></div></div>');var H=B("#arrow-"+I,C);var a=C.find(".contents");if(!P()){C.find(".arrow").addClass("aui-css-arrow")}a.css("width",T.width+"px");a.mouseover(function(f){clearTimeout(K);C.unbind("mouseover")}).mouseout(function(){Y()});var X=function(){if(!F){F={popup:C,hide:function(){Y(0)},id:I,show:function(){S()},persistent:T.persistent?true:false,reset:function(){function f(h,g){h.css(g.popupCss);if(P()){if(g.displayAbove){g.arrowCss.top-=B.browser.msie?10:9}if(!h.arrowCanvas){h.arrowCanvas=Raphael("arrow-"+I,16,16)}var i=T.getArrowPath,j=B.isFunction(i)?i(g):i;h.arrowCanvas.path(j).attr(T.getArrowAttributes())}else{if(g.displayAbove&&!H.hasClass("aui-bottom-arrow")){H.addClass("aui-bottom-arrow")}else{if(!g.displayAbove){H.removeClass("aui-bottom-arrow")}}}H.css(g.arrowCss)}var e=T.calculatePositions(C,R,c,T);f(C,e);C.fadeIn(T.fadeTime,function(){});if(B.browser.msie&&~~(B.browser.version)<10){if(B("#inline-dialog-shim-"+I).length==0){B(C).prepend(B('<iframe class = "inline-dialog-shim" id="inline-dialog-shim-'+I+'" frameBorder="0" src="javascript:false;"></iframe>'))}B("#inline-dialog-shim-"+I).css({width:a.outerWidth(),height:a.outerHeight()})}}}}return F};var S=function(){if(C.is(":visible")){return }d=setTimeout(function(){if(!b||!U){return }T.addActiveClass&&B(V).addClass("active");O=true;!T.persistent&&G();AJS.InlineDialog.current=X();B(document).trigger("showLayer",["inlineDialog",X()]);X().reset()},T.showDelay)};var Y=function(e){if(typeof e=="undefined"&&T.persistent){return }U=false;if(O&&T.preHideCallback.call(C[0].popup)){e=(e==null)?T.hideDelay:e;clearTimeout(K);clearTimeout(d);if(e!=null){K=setTimeout(function(){W();T.addActiveClass&&B(V).removeClass("active");C.fadeOut(T.fadeTime,function(){T.hideCallback.call(C[0].popup)});if(C.arrowCanvas){C.arrowCanvas.remove();C.arrowCanvas=null}O=false;U=false;B(document).trigger("hideLayer",["inlineDialog",X()]);AJS.InlineDialog.current=null;if(!T.cacheContent){b=false;Q=false}},e)}}};var Z=function(i,g){var f=B(g);T.upfrontCallback.call({popup:C,hide:function(){Y(0)},id:I,show:function(){S()}});C.each(function(){if(typeof this.popup!="undefined"){this.popup.hide()}});if(T.closeOthers){B(".aui-inline-dialog").each(function(){!this.popup.persistent&&this.popup.hide()})}R={target:f};if(!i){c={x:f.offset().left,y:f.offset().top}}else{c={x:i.pageX,y:i.pageY}}if(!O){clearTimeout(d)}U=true;var h=function(){Q=false;b=true;T.initCallback.call({popup:C,hide:function(){Y(0)},id:I,show:function(){S()}});S()};if(!Q){Q=true;if(B.isFunction(L)){L(a,g,h)}else{B.get(L,function(j,e,k){a.html(T.responseHandler(j,e,k));b=true;T.initCallback.call({popup:C,hide:function(){Y(0)},id:I,show:function(){S()}});S()})}}clearTimeout(K);if(!O){S()}return false};C[0].popup=X();var Q=false;var N=false;var M=function(){if(!N){B(T.container).append(C);N=true}};if(T.onHover){if(T.useLiveEvents){B(V).live("mousemove",function(f){M();Z(f,this)}).live("mouseout",function(){Y()})}else{B(V).mousemove(function(f){M();Z(f,this)}).mouseout(function(){Y()})}}else{if(!T.noBind){if(T.useLiveEvents){B(V).live("click",function(f){M();Z(f,this);return false}).live("mouseout",function(){Y()})}else{B(V).click(function(f){M();Z(f,this);return false}).mouseout(function(){Y()})}}}var E=false;var D=I+".inline-dialog-check";var G=function(){if(!E){B("body").bind("click."+D,function(g){var f=B(g.target);if(f.closest("#inline-dialog-"+I+" .contents").length===0){Y(0)}});E=true}};var W=function(){if(E){B("body").unbind("click."+D)}E=false};C.show=function(f){if(f){f.stopPropagation()}M();Z(null,V)};C.hide=function(){Y(0)};C.refresh=function(){if(O){X().reset()}};C.getOptions=function(){return T};return C};function A(D){var C=B(D);var E=B.extend({left:0,top:0},C.offset());return{left:E.left,top:E.top,width:C.outerWidth(),height:C.outerHeight()}}AJS.InlineDialog.opts={onTop:false,responseHandler:function(D,C,E){return D},closeOthers:true,isRelativeToMouse:false,addActiveClass:true,onHover:false,useLiveEvents:false,noBind:false,fadeTime:100,persistent:false,hideDelay:10000,showDelay:0,width:300,offsetX:0,offsetY:10,arrowOffsetX:0,container:"body",cacheContent:true,displayShadow:true,preHideCallback:function(){return true},hideCallback:function(){},initCallback:function(){},upfrontCallback:function(){},calculatePositions:function(D,I,S,C){C=C||{};var P=A(window);var F=A(I.target);var O=A(D);var E=A(D.find(".arrow"));var J=F.left+F.width/2;var N=(window.pageYOffset||document.documentElement.scrollTop)+P.height;var H=10;O.top=F.top+F.height+~~C.offsetY;O.left=F.left+~~C.offsetX;var Q=P.width-(O.left+O.width+H);E.left=J-O.left+~~C.arrowOffsetX;E.top=-(E.height/2);var L=F.top>O.height;var M=(O.top+O.height)<N;var K=(!M&&L)||(L&&C.onTop);if(K){O.top=F.top-O.height-(E.height/2);E.top=O.height}if(C.isRelativeToMouse){if(Q<0){O.right=H;O.left="auto";E.left=S.x-(P.width-O.width)}else{O.left=S.x-20;E.left=S.x-O.left}}else{if(Q<0){O.right=H;O.left="auto";var G=P.width-O.right;var R=G-O.width;E.right="auto";E.left=J-R-E.width/2}else{if(O.width<=F.width/2){E.left=O.width/2;O.left=J-O.width/2}}}return{displayAbove:K,popupCss:{left:O.left,top:O.top,right:O.right},arrowCss:{left:E.left,top:E.top,right:E.right}}},getArrowPath:function(C){return C.displayAbove?"M0,8L8,16,16,8":"M0,8L8,0,16,8"},getArrowAttributes:function(){return{fill:"#fff",stroke:"#ccc"}}}})(AJS.$);
/* module-key = 'com.atlassian.auiplugin:ajs', location = 'js/atlassian/firebug.js' */
AJS.warnAboutFirebug=function(A){AJS.log("DEPRECATED: please remove all uses of AJS.warnAboutFirebug")};
/* module-key = 'com.atlassian.auiplugin:ajs', location = 'js/atlassian/forms.js' */
AJS.inlineHelp=function(){AJS.$(".icon-inline-help").click(function(){var A=AJS.$(this).siblings(".field-help");if(A.hasClass("hidden")){A.removeClass("hidden")}else{A.addClass("hidden")}})};
/* module-key = 'com.atlassian.auiplugin:ajs', location = 'js/atlassian/messages.js' */
(function(){var A=500;var C=5000;var B=100;AJS.messages={setup:function(){AJS.messages.createMessage("generic");AJS.messages.createMessage("error");AJS.messages.createMessage("warning");AJS.messages.createMessage("info");AJS.messages.createMessage("success");AJS.messages.createMessage("hint");AJS.messages.makeCloseable();AJS.messages.makeFadeout()},makeCloseable:function(D){AJS.$(D||"div.aui-message.closeable").each(function(){var F=AJS.$(this),E=AJS.$('<span class="aui-icon icon-close" role="button" tabindex="0"></span>').click(function(){F.closeMessage()}).keypress(function(G){if((G.which===AJS.$.ui.keyCode.ENTER)||(G.which===AJS.$.ui.keyCode.SPACE)){F.closeMessage();G.preventDefault()}});F.append(E)})},makeFadeout:function(E,D,F){D=(typeof D!="undefined")?D:C;F=(typeof F!="undefined")?F:A;AJS.$(E||"div.aui-message.fadeout").each(function(){var J=AJS.$(this);var L=false;var H=false;function G(){J.stop(true,false).delay(D).fadeOut(F,function(){J.closeMessage()})}function K(){J.stop(true,false).fadeTo(B,1)}function I(){return !L&&!H}J.focusin(function(){L=true;K()}).focusout(function(){L=false;if(I()){G()}}).hover(function(){H=true;K()},function(){H=false;if(I()){G()}});G()})},template:'<div class="aui-message {type} {closeable} {shadowed} {fadeout}"><p class="title"><span class="aui-icon icon-{type}"></span><strong>{title}</strong></p>{body}<!-- .aui-message --></div>',createMessage:function(D){AJS.messages[D]=function(G,I){var H=this.template,F,E;if(!I){I=G;G="#aui-message-bar"}I.closeable=(I.closeable==false)?false:true;I.shadowed=(I.shadowed==false)?false:true;F=AJS.$(AJS.template(H).fill({type:D,closeable:I.closeable?"closeable":"",shadowed:I.shadowed?"shadowed":"",fadeout:I.fadeout?"fadeout":"",title:I.title||"","body:html":I.body||""}).toString());if(I.id){if(/[#\'\"\.\s]/g.test(I.id)){AJS.log("AJS.Messages error: ID rejected, must not include spaces, hashes, dots or quotes.")}else{F.attr("id",I.id)}}E=I.insert||"append";if(E==="prepend"){F.prependTo(G)}else{F.appendTo(G)}I.closeable&&AJS.messages.makeCloseable(F);I.fadeout&&AJS.messages.makeFadeout(F,I.delay,I.duration);return F}}};AJS.$.fn.closeMessage=function(){var D=AJS.$(this);if(D.hasClass("aui-message","closeable")){D.stop(true);D.trigger("messageClose",[this]).remove()}};AJS.$(function(){AJS.messages.setup()})})();
/* module-key = 'com.atlassian.auiplugin:ajs', location = 'js/atlassian/tabs.js' */
(function(){var B,G,E,C,D=/#.*/,F="active-tab",A="active-pane";AJS.tabs={setup:function(){var J;B=AJS.$(".aui-tabs:not(.aui-tabs-disabled)");for(var H=0,I=B.length;H<I;H++){J=AJS.$(B[H]);if(!J.data("aui-tab-events-bound")){G=AJS.$("ul.tabs-menu",B[H]);G.delegate("a","click",function(K){AJS.tabs.change(AJS.$(this),K);K&&K.preventDefault()});J.data("aui-tab-events-bound",true)}}AJS.$(".aui-tabs.vertical-tabs").find("a").each(function(K){E=AJS.$(this);if(!E.attr("title")){C=E.children("strong:first");if(AJS.isClipped(C)){E.attr("title",E.text())}}})},change:function(I,J){var H=AJS.$(I.attr("href").match(D)[0]);H.addClass(A).siblings().removeClass(A);I.parent("li.menu-item").addClass(F).siblings().removeClass(F);I.trigger("tabSelect",{tab:I,pane:H})}};AJS.$(AJS.tabs.setup)})();
/* module-key = 'com.atlassian.auiplugin:ajs', location = 'js/atlassian/template.js' */
AJS.template=(function(G){var J=/\{([^\}]+)\}/g,D=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,H=/([^\\])'/g,F=function(O,N,P,L){var M=P;N.replace(D,function(S,R,Q,U,T){R=R||U;if(M){if(R+":html" in M){M=M[R+":html"];L=true}else{if(R in M){M=M[R]}}if(T&&typeof M=="function"){M=M()}}});if(M==null||M==P){M=O}M=String(M);if(!L){M=E.escape(M)}return M},B=function(L){this.template=this.template.replace(J,function(N,M){return F(N,M,L,true)});return this},K=function(L){this.template=this.template.replace(J,function(N,M){return F(N,M,L)});return this},C=function(){return this.template};var E=function(M){function L(){return L.template}L.template=String(M);L.toString=L.valueOf=C;L.fill=K;L.fillHtml=B;return L},A={},I=[];E.load=function(L){L=String(L);if(!A.hasOwnProperty(L)){I.length>=1000&&delete A[I.shift()];I.push(L);A[L]=G("script[title='"+L.replace(H,"$1\\'")+"']")[0].text}return this(A[L])};E.escape=AJS.escapeHtml;return E})(AJS.$);
/* module-key = 'com.atlassian.auiplugin:ajs', location = 'js/atlassian/whenitype.js' */
(function(A,E){var D=navigator.platform.indexOf("Mac")!==-1;var B=/^(backspace|tab|r(ight|eturn)|s(hift|pace|croll)|c(trl|apslock)|alt|pa(use|ge(up|down))|e(sc|nd)|home|left|up|d(el|own)|insert|f\d\d?|numlock|meta)/i;A.whenIType=function(Q){var P=[],J=E.Callbacks();function G(R){if(!AJS.popup.current&&J){J.fire(R)}}function H(R){R.preventDefault()}function O(R){var S=R&&R.split?E.trim(R).split(" "):[R];E.each(S,function(){I(this)})}function L(S){var R=S.length;while(R--){if(S[R].length>1&&S[R]!=="space"){return true}}return false}function I(T){var S=T instanceof Array?T:N(T.toString());var R=L(S)?"keydown":"keypress";P.push(S);E(document).bind(R,S,G);E(document).bind(R+" keyup",S,H)}function N(T){var V=[],U="",S,R;while(T.length){if(S=T.match(/^(ctrl|meta|shift|alt)\+/i)){U+=S[0];T=T.substring(S[0].length)}else{if(R=T.match(B)){V.push(U+R[0]);T=T.substring(R[0].length);U=""}else{V.push(U+T[0]);T=T.substring(1);U=""}}}return V}function K(T){var V=E(T),X=V.attr("title")||"",W=P.slice();var S=V.data("kbShortcutAppended")||"";var R=!S;var U=R?X:X.substring(0,X.length-S.length);while(W.length){S=F(W.shift().slice(),S,R);R=false}if(D){S=S.replace(/Meta/ig,"\u2318").replace(/Shift/ig,"\u21E7")}V.attr("title",U+S);V.data("kbShortcutAppended",S)}function M(S){var T=E(S);var R=T.data("kbShortcutAppended");if(!R){return }var U=T.attr("title");T.attr("title",U.replace(R,""));T.removeData("kbShortcutAppended")}function F(T,S,R){if(R){S+=" ("+AJS.format("Type \'\'{0}\'\'",T.shift())}else{S=S.replace(/\)$/,"");S+=AJS.format("OR \'\'{0}\'\'",T.shift())}E.each(T,function(){S+=" "+AJS.format("then \'\'{0}\'\'",this)});S+=")";return S}O(Q);return A.whenIType.makeShortcut({executor:J,bindKeys:O,addShortcutsToTitle:K,removeShortcutsFromTitle:M,keypressHandler:G,defaultPreventionHandler:H})};A.whenIType.makeShortcut=function(N){var I=N.executor;var L=N.bindKeys;var J=N.addShortcutsToTitle;var K=N.removeShortcutsFromTitle;var G=N.keypressHandler;var H=N.defaultPreventionHandler;var M=[];function F(O){return function(P,R){R=R||{};var Q=R.focusedClass||"focused";var S=R.hasOwnProperty("wrapAround")?R.wrapAround:true;var T=R.hasOwnProperty("escToCancel")?R.escToCancel:true;I.add(function(){var W=E(P),V=W.filter("."+Q),U=V.length===0?undefined:{transition:true};if(T){E(document).one("keydown",function(X){if(X.keyCode===E.ui.keyCode.ESCAPE&&V){V.removeClass(Q)}})}if(V.length){V.removeClass(Q)}V=O(V,W,S);if(V&&V.length>0){V.addClass(Q);V.moveTo(U);if(V.is("a")){V.focus()}else{V.find("a:first").focus()}}});return this}}return{moveToNextItem:F(function(Q,R,P){var O;if(P&&Q.length===0){return R.eq(0)}else{O=E.inArray(Q.get(0),R);if(O<R.length-1){O=O+1;return R.eq(O)}else{if(P){return R.eq(0)}}}return Q}),moveToPrevItem:F(function(Q,R,P){var O;if(P&&Q.length===0){return R.filter(":last")}else{O=E.inArray(Q.get(0),R);if(O>0){O=O-1;return R.eq(O)}else{if(P){return R.filter(":last")}}}return Q}),click:function(O){M.push(O);J(O);I.add(function(){var P=E(O);if(P.length>0){P.click()}});return this},goTo:function(O){I.add(function(){window.location.href=O});return this},followLink:function(O){M.push(O);J(O);I.add(function(){var P=E(O)[0];if(P&&{a:true,link:true}[P.nodeName.toLowerCase()]){window.location.href=P.href}});return this},execute:function(P){var O=this;I.add(function(){P.apply(O,arguments)});return this},evaluate:function(O){O.call(this)},moveToAndClick:function(O){M.push(O);J(O);I.add(function(){var P=E(O);if(P.length>0){P.click();P.moveTo()}});return this},moveToAndFocus:function(O){M.push(O);J(O);I.add(function(Q){var P=AJS.$(O);if(P.length>0){P.focus();P.moveTo&&P.moveTo();if(P.is(":input")){Q.preventDefault()}}});return this},or:function(O){L(O);return this},unbind:function(){E(document).unbind("keydown keypress",G).unbind("keydown keypress keyup",H);for(var P=0,O=M.length;P<O;P++){K(M[P])}M=[]}}};A.whenIType.fromJSON=function(H,G){var F=[];if(H){E.each(H,function(J,K){var I=K.op,N=K.param,M;if(I==="execute"||I==="evaluate"){M=[new Function(N)]}else{if(/^\[[^\]\[]*,[^\]\[]*\]$/.test(N)){try{M=JSON.parse(N)}catch(L){C("When using a parameter array, array must be in strict JSON format: "+N)}if(!E.isArray(M)){C("Badly formatted shortcut parameter. String or JSON Array of parameters required: "+N)}}else{M=[N]}}E.each(K.keys,function(){var P=this;if(G&&D){P=E.map(this,function(Q){return Q.replace(/ctrl/i,"meta")})}var O=AJS.whenIType(P);O[I].apply(O,M);F.push(O)})})}return F};function C(F){if(console&&console.error){console.error(F)}else{AJS.log(F)}}E(document).bind("iframeAppended",function(G,F){E(F).load(function(){var H=E(F).contents();H.bind("keyup keydown keypress",function(I){if(E.browser.safari&&I.type==="keypress"){return }if(!E(I.target).is(":input")){E.event.trigger(I,arguments,document,true)}})})})})(AJS,AJS.$);
/* module-key = 'com.atlassian.auiplugin:ajs', location = 'js/atlassian/jquery/jquery.is-dirty.js' */
jQuery.fn.isDirty=function(){var B,A=[];window.onbeforeunload=function(){var C=window.onbeforeunload;if(B!==false){jQuery.each(A,function(){if(this.initVal!==AJS.$(this).val()){B=true;return false}})}if(B){window.onbeforeunload=null;window.setTimeout(function(){jQuery(document).bind("mousemove",function(){window.onbeforeunload=C;jQuery(document).unbind("mousemove",arguments.callee)})},1000);B=void (0);return AJS.params.dirtyMessage||""}};return function(D){if(this.length===0){return }function C(F){var E=jQuery(this);jQuery.fn.isDirty.fieldInFocus=E;if(jQuery.inArray(this,A)===-1){this.initVal=E.val();A.push(this);E.die(F.type,C)}}jQuery(":not(:input)").live("click",function(){delete jQuery.fn.isDirty.fieldInFocus});jQuery(":input[type != hidden]",this.selector).bind("keydown",C).bind("keypress",C).bind("click",C);jQuery(D.ignoreUnloadFromElems).live("mousedown",function(){B=false});this.each(function(){this.onsubmit=function(E){return function(){B=false;if(E){return E.apply(this,arguments)}}}(this.onsubmit);AJS.$(this).submit(function(){B=false})});return this}}();
/* module-key = 'com.atlassian.auiplugin:ajs', location = 'js/atlassian/jquery/jquery.progressbar.js' */
(function(A){A.fn.progressBar=function(I,L){var C=this;var F={height:"1em",showPercentage:true};var B=A.extend(F,L);var J=C.attr("id")+"-incomplete-bar";var D=C.attr("id")+"-complete-bar";var K=C.attr("id")+"-percent-complete-text";if(A("#"+J).length==0){var E=A(document.createElement("div"));E.attr("id",J);E.css({width:"90%",border:"solid 1px #ccc","float":"left","margin-right":"0.5em"});E.addClass("progress-background-color");var G=A(document.createElement("div"));G.attr("id",D);G.addClass("progress-fill-color");G.css({height:B.height,width:I+"%"});var H=A(document.createElement("span"));H.attr("id",K);H.addClass("percent-complete-text");H.html(I+"%");E.append(G);C.append(E);if(B.showPercentage){C.append(H)}}else{A("#"+D).css("width",I+"%");A("#"+K).html(I+"%")}}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:ajs', location = 'js/atlassian/jquery/jquery.selection.js' */
(function(A){if(document.selection){var B=function(C){return C.replace(/\u000D/g,"")};A.fn.selection=function(F){var E=this[0];this.focus();if(!E){return false}if(F==null){return document.selection.createRange().text}else{var D=E.scrollTop;var C=document.selection.createRange();C.text=F;C.select();E.focus();E.scrollTop=D}};A.fn.selectionRange=function(C,F){var G=this[0];this.focus();var I=document.selection.createRange();if(C==null){var K=this.val(),J=K.length,E=I.duplicate();E.moveToElementText(G);E.setEndPoint("StartToEnd",I);var D=J-B(E.text).length;E.setEndPoint("StartToStart",I);var H=J-B(E.text).length;if(D!=H&&K.charAt(D+1)=="\n"){D+=1}return{end:D,start:H,text:K.substring(H,D),textBefore:K.substring(0,H),textAfter:K.substring(D)}}else{I.moveToElementText(G);I.collapse(true);I.moveStart("character",C);I.moveEnd("character",F-C);I.select()}}}else{A.fn.selection=function(E){var D=this[0];if(!D){return false}if(E==null){if(D.setSelectionRange){return D.value.substring(D.selectionStart,D.selectionEnd)}else{return false}}else{var C=D.scrollTop;if(!!D.setSelectionRange){var F=D.selectionStart;D.value=D.value.substring(0,F)+E+D.value.substring(D.selectionEnd);D.selectionStart=F;D.selectionEnd=F+E.length}D.focus();D.scrollTop=C}};A.fn.selectionRange=function(F,C){if(F==null){var D={start:this[0].selectionStart,end:this[0].selectionEnd};var E=this.val();D.text=E.substring(D.start,D.end);D.textBefore=E.substring(0,D.start);D.textAfter=E.substring(D.end);return D}else{this[0].selectionStart=F;this[0].selectionEnd=C}}}A.fn.wrapSelection=function(C,D){this.selection(C+this.selection()+(D||""))}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:ajs', location = 'js/atlassian/jquery/jquery.throbber.js' */
jQuery.fn.throbber=function(A){return function(){var C=[],B={isLatentThreshold:100,minThrobberDisplay:200,loadingClass:"loading"};A(document).ajaxComplete(function(E,D){A(C).each(function(F){if(D===this.get(0)){this.hideThrobber();C.splice(F,1)}})});return function(F){var E,G,D=function(I,H){D.t=setTimeout(function(){clearTimeout(D.t);D.t=undefined;I()},H)};F=A.extend(B,F||{});if(!F.target){return this}G=jQuery(F.target);C.push(A.extend(this,{showThrobber:function(){D(function(){if(!E){G.addClass(F.loadingClass);D(function(){if(E){E()}},F.minThrobberDisplay)}},F.isLatentThreshold)},hideThrobber:function(){E=function(){G.removeClass(F.loadingClass);if(F.end){F.end()}};if(!D.t){E()}}}));this.showThrobber();return this}}()}(jQuery);
/* module-key = 'com.atlassian.auiplugin:aui-experimental-spinner', location = 'js/external/spin/spin.js' */
!function(I,K,A){var E=["webkit","Moz","ms","O"],P={},O;function G(Q,T){var R=K.createElement(Q||"div"),S;for(S in T){R[S]=T[S]}return R}function H(R){for(var Q=1,S=arguments.length;Q<S;Q++){R.appendChild(arguments[Q])}return R}var J=function(){var Q=G("style",{type:"text/css"});H(K.getElementsByTagName("head")[0],Q);return Q.sheet||Q.styleSheet}();function C(U,Q,V,Y){var R=["opacity",Q,~~(U*100),V,Y].join("-"),S=0.01+V/Y*100,X=Math.max(1-(1-U)/Q*(100-S),U),W=O.substring(0,O.indexOf("Animation")).toLowerCase(),T=W&&"-"+W+"-"||"";if(!P[R]){J.insertRule("@"+T+"keyframes "+R+"{0%{opacity:"+X+"}"+S+"%{opacity:"+U+"}"+(S+0.01)+"%{opacity:1}"+(S+Q)%100+"%{opacity:"+U+"}100%{opacity:"+X+"}}",J.cssRules.length);P[R]=1}return R}function N(T,U){var S=T.style,Q,R;if(S[U]!==A){return U}U=U.charAt(0).toUpperCase()+U.slice(1);for(R=0;R<E.length;R++){Q=E[R]+U;if(S[Q]!==A){return Q}}}function F(Q,S){for(var R in S){Q.style[N(Q,R)||R]=S[R]}return Q}function M(S){for(var Q=1;Q<arguments.length;Q++){var R=arguments[Q];for(var T in R){if(S[T]===A){S[T]=R[T]}}}return S}function L(Q){var R={x:Q.offsetLeft,y:Q.offsetTop};while((Q=Q.offsetParent)){R.x+=Q.offsetLeft,R.y+=Q.offsetTop}return R}var D={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",speed:1,trail:100,opacity:1/4,fps:20,zIndex:2000000000,className:"spinner",top:"auto",left:"auto",position:"relative"};var B=function B(Q){if(!this.spin){return new B(Q)}this.opts=M(Q||{},B.defaults,D)};B.defaults={};M(B.prototype,{spin:function(X){this.stop();var b=this,Q=b.opts,R=b.el=F(G(0,{className:Q.className}),{position:Q.position,width:0,zIndex:Q.zIndex}),a=Q.radius+Q.length+Q.width,c,Z;if(X){X.insertBefore(R,X.firstChild||null);Z=L(X);c=L(R);F(R,{left:(Q.left=="auto"?Z.x-c.x+(X.offsetWidth>>1):parseInt(Q.left,10)+a)+"px",top:(Q.top=="auto"?Z.y-c.y+(X.offsetHeight>>1):parseInt(Q.top,10)+a)+"px"})}R.setAttribute("aria-role","progressbar");b.lines(R,b.opts);if(!O){var U=0,S=Q.fps,W=S/Q.speed,V=(1-Q.opacity)/(W*Q.trail/100),Y=W/Q.lines;(function T(){U++;for(var d=Q.lines;d;d--){var e=Math.max(1-(U+d*Y)%W*V,Q.opacity);b.opacity(R,Q.lines-d,e,Q)}b.timeout=b.el&&setTimeout(T,~~(1000/S))})()}return b},stop:function(){var Q=this.el;if(Q){clearTimeout(this.timeout);if(Q.parentNode){Q.parentNode.removeChild(Q)}this.el=A}return this},lines:function(S,U){var R=0,Q;function T(V,W){return F(G(),{position:"absolute",width:(U.length+U.width)+"px",height:U.width+"px",background:V,boxShadow:W,transformOrigin:"left",transform:"rotate("+~~(360/U.lines*R+U.rotate)+"deg) translate("+U.radius+"px,0)",borderRadius:(U.corners*U.width>>1)+"px"})}for(;R<U.lines;R++){Q=F(G(),{position:"absolute",top:1+~(U.width/2)+"px",transform:U.hwaccel?"translate3d(0,0,0)":"",opacity:U.opacity,animation:O&&C(U.opacity,U.trail,R,U.lines)+" "+1/U.speed+"s linear infinite"});if(U.shadow){H(Q,F(T("#000","0 0 4px #000"),{top:2+"px"}))}H(S,H(Q,T(U.color,"0 0 1px rgba(0,0,0,.1)")))}return S},opacity:function(R,Q,S){if(Q<R.childNodes.length){R.childNodes[Q].style.opacity=S}}});(function(){function Q(T,S){return G("<"+T+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',S)}var R=F(G("group"),{behavior:"url(#default#VML)"});if(!N(R,"transform")&&R.adj){J.addRule(".spin-vml","behavior:url(#default#VML)");B.prototype.lines=function(U,T){var S=T.length+T.width,a=2*S;function Z(){return F(Q("group",{coordsize:a+" "+a,coordorigin:-S+" "+-S}),{width:a,height:a})}var V=-(T.width+T.length)*2+"px",Y=F(Z(),{position:"absolute",top:V,left:V}),X;function W(c,b,d){H(Y,H(F(Z(),{rotation:360/T.lines*c+"deg",left:~~b}),H(F(Q("roundrect",{arcsize:T.corners}),{width:S,height:T.width,left:T.radius,top:-T.width>>1,filter:d}),Q("fill",{color:T.color,opacity:T.opacity}),Q("stroke",{opacity:0}))))}if(T.shadow){for(X=1;X<=T.lines;X++){W(X,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)")}}for(X=1;X<=T.lines;X++){W(X)}return H(U,Y)};B.prototype.opacity=function(T,S,V,U){var W=T.firstChild;U=U.shadow&&U.lines||0;if(W&&S+U<W.childNodes.length){W=W.childNodes[S+U];W=W&&W.firstChild;W=W&&W.firstChild;if(W){W.opacity=V}}}}else{O=N(R,"animation")}})();if(typeof define=="function"&&define.amd){define(function(){return B})}else{I.Spinner=B}}(window,document);
/* module-key = 'com.atlassian.auiplugin:aui-experimental-spinner', location = 'js/external/jquery/jquery.spin.js' */
(function(A){A.fn.spin=function(E,D){var C,B;if(typeof E==="string"){if(!E in A.fn.spin.presets){throw new Error("Preset '"+E+"' isn't defined")}C=A.fn.spin.presets[E];B=D||{}}else{if(D){throw new Error("Invalid arguments. Accepted arguments:\n$.spin([String preset[, Object options]]),\n$.spin(Object options),\n$.spin(Boolean shouldSpin)")}C=A.fn.spin.presets.small;B=A.isPlainObject(E)?E:{}}if(window.Spinner){return this.each(function(){var G=A(this),F=G.data();if(F.spinner){F.spinner.stop();delete F.spinner}if(E===false){return }B=A.extend({color:G.css("color")},C,B);F.spinner=new Spinner(B).spin(this)})}else{throw"Spinner class not available."}};A.fn.spin.presets={small:{lines:12,length:3,width:2,radius:3,trail:60,speed:1.5},medium:{lines:12,length:5,width:3,radius:8,trail:60,speed:1.5},large:{lines:12,length:8,width:4,radius:10,trail:60,speed:1.5}};A.fn.spinStop=function(){if(window.Spinner){return this.each(function(){var C=A(this),B=C.data();if(B.spinner){B.spinner.stop();delete B.spinner}})}else{throw"Spinner class not available."}}})(jQuery);
/* module-key = 'jira.webresources:almond', location = '/static/lib/almond-noconflict-pre.js' */
window.__require=window.require;window.__requirejs=window.requirejs;window.__define=window.define;
/* module-key = 'jira.webresources:almond', location = '/static/lib/almond/almond.js' */
var requirejs,require,define;(function(undef){var main,req,makeMap,handlers,defined={},waiting={},config={},defining={},hasOwn=Object.prototype.hasOwnProperty,aps=[].slice;function hasProp(obj,prop){return hasOwn.call(obj,prop)}function normalize(name,baseName){var nameParts,nameSegment,mapValue,foundMap,foundI,foundStarMap,starI,i,j,part,baseParts=baseName&&baseName.split("/"),map=config.map,starMap=(map&&map["*"])||{};if(name&&name.charAt(0)==="."){if(baseName){baseParts=baseParts.slice(0,baseParts.length-1);name=baseParts.concat(name.split("/"));for(i=0;i<name.length;i+=1){part=name[i];if(part==="."){name.splice(i,1);i-=1}else{if(part===".."){if(i===1&&(name[2]===".."||name[0]==="..")){break}else{if(i>0){name.splice(i-1,2);i-=2}}}}}name=name.join("/")}else{if(name.indexOf("./")===0){name=name.substring(2)}}}if((baseParts||starMap)&&map){nameParts=name.split("/");for(i=nameParts.length;i>0;i-=1){nameSegment=nameParts.slice(0,i).join("/");if(baseParts){for(j=baseParts.length;j>0;j-=1){mapValue=map[baseParts.slice(0,j).join("/")];if(mapValue){mapValue=mapValue[nameSegment];if(mapValue){foundMap=mapValue;foundI=i;break}}}}if(foundMap){break}if(!foundStarMap&&starMap&&starMap[nameSegment]){foundStarMap=starMap[nameSegment];starI=i}}if(!foundMap&&foundStarMap){foundMap=foundStarMap;foundI=starI}if(foundMap){nameParts.splice(0,foundI,foundMap);name=nameParts.join("/")}}return name}function makeRequire(relName,forceSync){return function(){return req.apply(undef,aps.call(arguments,0).concat([relName,forceSync]))}}function makeNormalize(relName){return function(name){return normalize(name,relName)}}function makeLoad(depName){return function(value){defined[depName]=value}}function callDep(name){if(hasProp(waiting,name)){var args=waiting[name];delete waiting[name];defining[name]=true;main.apply(undef,args)}if(!hasProp(defined,name)&&!hasProp(defining,name)){throw new Error("No "+name)}return defined[name]}function splitPrefix(name){var prefix,index=name?name.indexOf("!"):-1;if(index>-1){prefix=name.substring(0,index);name=name.substring(index+1,name.length)}return[prefix,name]}makeMap=function(name,relName){var plugin,parts=splitPrefix(name),prefix=parts[0];name=parts[1];if(prefix){prefix=normalize(prefix,relName);plugin=callDep(prefix)}if(prefix){if(plugin&&plugin.normalize){name=plugin.normalize(name,makeNormalize(relName))}else{name=normalize(name,relName)}}else{name=normalize(name,relName);parts=splitPrefix(name);prefix=parts[0];name=parts[1];if(prefix){plugin=callDep(prefix)}}return{f:prefix?prefix+"!"+name:name,n:name,pr:prefix,p:plugin}};function makeConfig(name){return function(){return(config&&config.config&&config.config[name])||{}}}handlers={require:function(name){return makeRequire(name)},exports:function(name){var e=defined[name];if(typeof e!=="undefined"){return e}else{return(defined[name]={})}},module:function(name){return{id:name,uri:"",exports:defined[name],config:makeConfig(name)}}};main=function(name,deps,callback,relName){var cjsModule,depName,ret,map,i,args=[],usingExports;relName=relName||name;if(typeof callback==="function"){deps=!deps.length&&callback.length?["require","exports","module"]:deps;for(i=0;i<deps.length;i+=1){map=makeMap(deps[i],relName);depName=map.f;if(depName==="require"){args[i]=handlers.require(name)}else{if(depName==="exports"){args[i]=handlers.exports(name);usingExports=true}else{if(depName==="module"){cjsModule=args[i]=handlers.module(name)}else{if(hasProp(defined,depName)||hasProp(waiting,depName)||hasProp(defining,depName)){args[i]=callDep(depName)}else{if(map.p){map.p.load(map.n,makeRequire(relName,true),makeLoad(depName),{});args[i]=defined[depName]}else{throw new Error(name+" missing "+depName)}}}}}}ret=callback.apply(defined[name],args);if(name){if(cjsModule&&cjsModule.exports!==undef&&cjsModule.exports!==defined[name]){defined[name]=cjsModule.exports}else{if(ret!==undef||!usingExports){defined[name]=ret}}}}else{if(name){defined[name]=callback}}};requirejs=require=req=function(deps,callback,relName,forceSync,alt){if(typeof deps==="string"){if(handlers[deps]){return handlers[deps](callback)}return callDep(makeMap(deps,callback).f)}else{if(!deps.splice){config=deps;if(callback.splice){deps=callback;callback=relName;relName=null}else{deps=undef}}}callback=callback||function(){};if(typeof relName==="function"){relName=forceSync;forceSync=alt}if(forceSync){main(undef,deps,callback,relName)}else{setTimeout(function(){main(undef,deps,callback,relName)},4)}return req};req.config=function(cfg){config=cfg;if(config.deps){req(config.deps,config.callback)}return req};define=function(name,deps,callback){if(!deps.splice){callback=deps;deps=[]}if(!hasProp(defined,name)&&!hasProp(waiting,name)){waiting[name]=[name,deps,callback]}};define.amd={jQuery:true}}());
/* module-key = 'jira.webresources:almond', location = '/static/lib/almond-noconflict-post.js' */
if(window.__require){window.require=window.__require;window.requirejs=window.__requirejs;window.define=window.__define}else{delete window.define.amd}try{delete window.__require}catch(e){window.__require=undefined}try{delete window.__requirejs}catch(e){window.__requirejs=undefined}try{delete window.__define}catch(e){window.__define=undefined};
/* module-key = 'jira.webresources:util-lite', location = '/includes/ajs/browser/describeBrowser.js' */
AJS.describeBrowser=function(userAgent){userAgent=userAgent||navigator.userAgent;var isChrome=/chrome/.test(navigator.userAgent.toLowerCase()),isSafari=!isChrome&&/safari/.test(navigator.userAgent.toLowerCase()),match=jQuery.uaMatch(userAgent),browser=match.browser,version=match.version.replace(/\.0$/,""),classNames=[];if(isChrome){classNames.push("chrome")}if(isSafari){classNames.push("safari")}classNames.push(browser);if(browser==="msie"){classNames.push(browser+"-"+version);version=parseInt(version);while(version>6){--version;classNames.push(browser+"-gt-"+version)}}jQuery("html").addClass(classNames.join(" "))};
/* module-key = 'jira.webresources:util-lite', location = '/includes/ajs/copyobject/copyObject.js' */
AJS.copyObject=function(object,deep){var copiedObject={};AJS.$.each(object,function(name,property){if(typeof property!=="object"||property===null||property instanceof AJS.$){copiedObject[name]=property}else{if(deep!==false){copiedObject[name]=AJS.copyObject(property,deep)}}});return copiedObject};
/* module-key = 'jira.webresources:util-lite', location = '/includes/jquery/plugins/inputevent/jquery.inputevent.js' */
(function(){var browserMajorVersion=parseInt(jQuery.browser.version,10);if(!jQuery.browser.msie||browserMajorVersion>=10){return }var EVENTS={};var PREVIOUS_INPUT_VALUE="com.atlassian.aui.PREVIOUS_INPUT_VALUE";if(browserMajorVersion>=9){var EDIT_EVENTS="contextmenu cut keydown";var timeoutId=0;var validEdit=function(e){return !(jQuery(e.target).not("textarea")&&e.keyCode===13)};var onEditEvent=function(e){if(validEdit(e)){var $target=jQuery(this);clearTimeout(timeoutId);timeoutId=setTimeout(function(){var previousValue=$target.data(PREVIOUS_INPUT_VALUE);if(previousValue!==$target.val()){$target.trigger("input")}},0)}};EVENTS.input=function(){var $target=jQuery(this);$target.data(PREVIOUS_INPUT_VALUE,$target.val())};EVENTS.focus=function(){var $target=jQuery(this);$target.unbind(EDIT_EVENTS,onEditEvent);$target.bind(EDIT_EVENTS,onEditEvent);$target.data(PREVIOUS_INPUT_VALUE,$target.val())};EVENTS.blur=function(){jQuery(this).unbind(EDIT_EVENTS,onEditEvent)}}else{var isUserInput=true;var onPropertyChange=function(){if(isUserInput&&event.propertyName==="value"){var $target=jQuery(event.srcElement);var previousValue=$target.data(PREVIOUS_INPUT_VALUE);if(previousValue!==$target.val()){$target.trigger("input");$target.data(PREVIOUS_INPUT_VALUE,$target.val())}}};var onKeyDown=function(event){var $target=jQuery(this);setTimeout(function(){var previousValue=$target.data(PREVIOUS_INPUT_VALUE);if(previousValue!==$target.val()){jQuery(event.srcElement).trigger("input");$target.data(PREVIOUS_INPUT_VALUE,$target.val())}},0)};EVENTS.focus=function(){jQuery(this).unbind("keydown",onKeyDown).bind("keydown",onKeyDown);this.detachEvent("onpropertychange",onPropertyChange);this.attachEvent("onpropertychange",onPropertyChange);jQuery(this).data(PREVIOUS_INPUT_VALUE,jQuery(this).val())};EVENTS.blur=function(){jQuery(this).unbind("keydown",onKeyDown);this.detachEvent("onpropertychange",onPropertyChange)};var TEXT_VALUE_SETTER={set:function(element,value){isUserInput=false;element.value=value;isUserInput=true;jQuery(element).data(PREVIOUS_INPUT_VALUE,value);return true}};jQuery.valHooks.text=TEXT_VALUE_SETTER;jQuery.valHooks.textarea=TEXT_VALUE_SETTER}jQuery(document).delegate("input:text, textarea",EVENTS)})();
/* module-key = 'jira.webresources:util-lite', location = '/includes/jira/common/util.js' */
var JIRA=window.JIRA||{};var jira=window.jira||{};JIRA.bind=function(types,data,fn){jQuery(AJS).bind(types,data,fn)};JIRA.one=function(evt,handler){jQuery(AJS).one(evt,handler)};JIRA.unbind=function(evt,handler){jQuery(AJS).unbind(evt,handler)};JIRA.trigger=function(evt,args){jQuery(AJS).trigger(evt,args)};JIRA.isSysadmin=function(){return !!AJS.Meta.getBoolean("is-sysadmin")};JIRA.isAdmin=function(){return !!AJS.Meta.getBoolean("is-admin")};AJS.namespace=function(namespace,context,value){var names=namespace.split(".");context=context||window;for(var i=0,n=names.length-1;i<n;i++){var x=context[names[i]];context=(x!=null)?x:context[names[i]]={}}return context[names[i]]=value||{}};AJS.canAccessIframe=function(iframe){var $iframe=AJS.$(iframe);return !/^(http|https):\/\//.test($iframe.attr("src"))||(AJS.params.baseURL&&(AJS.$.trim($iframe.attr("src")).indexOf(AJS.params.baseURL)===0))};AJS.elementIsFocused=function(input){if(input&&AJS.$(input).get(0)===document.activeElement){return true}return false};AJS.consumesKeyboardEvents=function($e){return !($e.is(":button"))&&($e.is(":input")||$e.is("[contentEditable]"))};(function(){function preventScrolling(e){var keyCode=e.keyCode,keys=AJS.$.ui.keyCode;if(e.type=="keypress"){return }if(keyCode===keys.DOWN||keyCode===keys.UP||keyCode===keys.LEFT||keyCode===keys.RIGHT){var $el=jQuery(e.target);if(AJS.consumesKeyboardEvents($el)){}else{e.preventDefault()}}}AJS.disableKeyboardScrolling=function(){AJS.$(document.body).bind("keydown",preventScrolling)};AJS.enableKeyboardScrolling=function(){AJS.$(document.body).unbind("keydown",preventScrolling)}})();AJS.$.namespace=function(namespace){return AJS.namespace(namespace)};jQuery.noConflict();jQuery.ajaxSettings.traditional=true;contextPath=typeof contextPath==="undefined"?"":contextPath;AJS.LEFT="left";AJS.RIGHT="right";AJS.ACTIVE_CLASS="active";AJS.BOX_SHADOW_CLASS="box-shadow";AJS.LOADING_CLASS="loading";AJS.INTELLIGENT_GUESS="Intelligent Guess";(function(){var SPECIAL_CHARS=/[.*+?|^$()[\]{\\]/g;RegExp.escape=function(str){return str.replace(SPECIAL_CHARS,"\\$&")}})();(function($){$.readData=function(s){var r={},n="";$(s).children().each(function(i){if(i%2){r[n]=jQuery.trim($(this).text())}else{n=jQuery.trim($(this).text())}}).remove();$(s).remove();return r}})(jQuery);String.prototype.escapejQuerySelector=function(){return this.replace(/([:.])/g,"\\$1")};AJS.isSelenium=function(){return window.name.toLowerCase().indexOf("selenium")>=0};AJS.reloadViaWindowLocation=function(url){AJS.reloadViaWindowLocation._delegate(url,window.location)};AJS.reloadViaWindowLocation._delegate=(function(){var secondsSinceMidnight=function(){var now=new Date();var midnight=new Date(now.getFullYear(),now.getMonth(),now.getDate(),0,0,0,0);var secs=(now.getTime()-midnight.getTime())/1000;return Math.max(Math.floor(secs),1)};var MAGIC_PARAM="jwupdated";var MAGIC_PARAM_RE=/(jwupdated=[0-9]*)/;var makeHashUrlsUnique=function(url){var hashIndex=url.indexOf("#");if(hashIndex==-1){return url}var firstQuestionMark=url.indexOf("?");var magicParamValue=MAGIC_PARAM+"="+secondsSinceMidnight();if(firstQuestionMark==-1){url=url.replace("#","?"+magicParamValue+"#")}else{if(MAGIC_PARAM_RE.test(url)){url=url.replace(MAGIC_PARAM_RE,magicParamValue)}else{url=url.replace("?","?"+magicParamValue+"&")}}return url};return function(url,location){var targetUrl=url||location.href;var uniqueUrl=makeHashUrlsUnique(targetUrl);if(jQuery.browser.webkit&&parseInt(jQuery.browser.version)<533){location.href=uniqueUrl}else{if(targetUrl===location.href){location.replace(uniqueUrl)}else{location.assign(uniqueUrl)}}}})();AJS.extractBodyFromResponse=function(text){var fragment=text.match(/<body[^>]*>([\S\s]*)<\/body[^>]*>/);if(fragment&&fragment.length>0){return fragment[1]}return text};AJS.escapeHTML=AJS.escapeHtml;AJS.isDevMode=function(){return AJS.Meta.get("dev-mode")};function tryIt(f,defaultVal){try{return f()}catch(ex){return defaultVal}}function begetObject(obj){var f=function(){};f.prototype=obj;return new f}function submitOnEnter(e){if(e.keyCode==13&&e.target.form&&!e.ctrlKey&&!e.shiftKey){jQuery(e.target.form).submit();return false}return true}function submitOnCtrlEnter(e){if(e.ctrlKey&&e.target.form&&(e.keyCode==13||e.keyCode==10)){jQuery(e.target.form).submit();return false}return true}function getMultiSelectValues(selectObject){var selectedValues="";for(var i=0;i<selectObject.length;i++){if(selectObject.options[i].selected){if(selectObject.options[i].value&&selectObject.options[i].value.length>0){selectedValues=selectedValues+" "+selectObject.options[i].value}}}return selectedValues}function getMultiSelectValuesAsArray(selectObject){var selectedValues=new Array();for(var i=0;i<selectObject.length;i++){if(selectObject.options[i].selected){if(selectObject.options[i].value&&selectObject.options[i].value.length>0){selectedValues[selectedValues.length]=selectObject.options[i].value}}}return selectedValues}function arrayContains(array,value){for(var i=0;i<array.length;i++){if(array[i]==value){return true}}return false}function addClassName(elementId,classNameToAdd){var elem=document.getElementById(elementId);if(elem){elem.className=elem.className+" "+classNameToAdd}}function removeClassName(elementId,classNameToRemove){var elem=document.getElementById(elementId);if(elem){elem.className=(" "+elem.className+" ").replace(" "+classNameToRemove+" "," ")}}function getEscapedFieldValue(id){var e=document.getElementById(id);if(e.value){return id+"="+encodeURIComponent(e.value)}else{return""}}function getEscapedFieldValues(ids){var s="";for(var i=0;i<ids.length;i++){s=s+"&"+getEscapedFieldValue(ids[i])}return s}var GuiPrefs={toggleVisibility:function(elementId){var elem=document.getElementById(elementId);if(elem){if(readFromConglomerateCookie("jira.conglomerate.cookie",elementId,"1")=="1"){elem.style.display="none";removeClassName(elementId+"header","headerOpened");addClassName(elementId+"header","headerClosed");saveToConglomerateCookie("jira.conglomerate.cookie",elementId,"0")}else{elem.style.display="";removeClassName(elementId+"header","headerClosed");addClassName(elementId+"header","headerOpened");eraseFromConglomerateCookie("jira.conglomerate.cookie",elementId)}}}};function toggle(elementId){GuiPrefs.toggleVisibility(elementId)}function toggleDivsWithCookie(elementShowId,elementHideId){var elementShow=document.getElementById(elementShowId);var elementHide=document.getElementById(elementHideId);if(elementShow.style.display=="none"){elementHide.style.display="none";elementShow.style.display="block";saveToConglomerateCookie("jira.viewissue.cong.cookie",elementShowId,"1");saveToConglomerateCookie("jira.viewissue.cong.cookie",elementHideId,"0")}else{elementShow.style.display="none";elementHide.style.display="block";saveToConglomerateCookie("jira.viewissue.cong.cookie",elementHideId,"1");saveToConglomerateCookie("jira.viewissue.cong.cookie",elementShowId,"0")}}function restoreDivFromCookie(elementId,cookieName,defaultValue){if(defaultValue==null){defaultValue="1"}var elem=document.getElementById(elementId);if(elem){if(readFromConglomerateCookie(cookieName,elementId,defaultValue)!="1"){elem.style.display="none";removeClassName(elementId+"header","headerOpened");addClassName(elementId+"header","headerClosed")}else{elem.style.display="";removeClassName(elementId+"header","headerClosed");addClassName(elementId+"header","headerOpened")}}}function restore(elementId){restoreDivFromCookie(elementId,"jira.conglomerate.cookie","1")}function saveToConglomerateCookie(cookieName,name,value){var cookieValue=getCookieValue(cookieName);cookieValue=addOrAppendToValue(name,value,cookieValue);saveCookie(cookieName,cookieValue,365)}function readFromConglomerateCookie(cookieName,name,defaultValue){var cookieValue=getCookieValue(cookieName);var value=getValueFromCongolmerate(name,cookieValue);if(value!=null){return value}return defaultValue}function eraseFromConglomerateCookie(cookieName,name){saveToConglomerateCookie(cookieName,name,"")}function getValueFromCongolmerate(name,cookieValue){if(cookieValue==null){cookieValue=""}var eq=name+"=";var cookieParts=cookieValue.split("|");for(var i=0;i<cookieParts.length;i++){var cp=cookieParts[i];while(cp.charAt(0)==" "){cp=cp.substring(1,cp.length)}if(cp.indexOf(name)==0){return cp.substring(eq.length,cp.length)}}return null}function addOrAppendToValue(name,value,cookieValue){var newCookieValue="";if(cookieValue==null){cookieValue=""}var cookieParts=cookieValue.split("|");for(var i=0;i<cookieParts.length;i++){var cp=cookieParts[i];if(cp!=""){while(cp.charAt(0)==" "){cp=cp.substring(1,cp.length)}if(cp.indexOf(name)!=0){newCookieValue+=cp+"|"}}}if(value!=null&&value!=""){var pair=name+"="+value;if((newCookieValue.length+pair.length)<4020){newCookieValue+=pair}}return newCookieValue}function getCookieValue(name){var eq=name+"=";var ca=document.cookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==" "){c=c.substring(1,c.length)}if(c.indexOf(eq)==0){return unescape(c.substring(eq.length,c.length))}}return null}function saveCookie(name,value,days){if(typeof contextPath==="undefined"){return }var path=contextPath;if(!path){path="/"}var ex;if(days){var d=new Date();d.setTime(d.getTime()+(days*24*60*60*1000));ex="; expires="+d.toGMTString()}else{ex=""}document.cookie=name+"="+escape(value)+ex+";path="+path}function readCookie(name,defaultValue){var cookieVal=getCookieValue(name);if(cookieVal!=null){return cookieVal}if(defaultValue){saveCookie(name,defaultValue,365);return defaultValue}else{return null}}function eraseCookie(name){saveCookie(name,"",-1)}function recolourSimpleTableRows(tableId){recolourTableRows(tableId,"rowNormal","rowAlternate",tableId+"_empty")}function recolourTableRows(tableId,rowNormal,rowAlternate,emptyTableId){var tbl=document.getElementById(tableId);var emptyTable=document.getElementById(emptyTableId);var alternate=false;var rowsFound=0;var rows=tbl.rows;var firstVisibleRow=null;var lastVisibleRow=null;if(AJS.$(tbl).hasClass("aui")){rowNormal="";rowAlternate="zebra"}for(var i=1;i<rows.length;i++){var row=rows[i];if(row.style.display!="none"){if(!alternate){row.className=rowNormal}else{row.className=rowAlternate}rowsFound++;alternate=!alternate}if(row.style.display!="none"){if(firstVisibleRow==null){firstVisibleRow=row}lastVisibleRow=row}}if(firstVisibleRow!=null){firstVisibleRow.className=firstVisibleRow.className+" first-row"}if(lastVisibleRow!=null){lastVisibleRow.className=lastVisibleRow.className+" last-row"}if(emptyTable){if(rowsFound==0){tbl.style.display="none";emptyTable.style.display=""}else{tbl.style.display="";emptyTable.style.display="none"}}}function htmlEscape(str){var divE=document.createElement("div");divE.appendChild(document.createTextNode(str));return divE.innerHTML}function atl_token(){return jQuery("#atlassian-token").attr("content")}function openDateRangePicker(formName,previousFieldName,nextFieldName,fieldId){var previousFieldValue=document.forms[formName].elements[previousFieldName].value;var nextFieldValue=document.forms[formName].elements[nextFieldName].value;var url=contextPath+"/secure/popups/DateRangePicker.jspa?";url+="formName="+formName+"&";url+="previousFieldName="+escape(previousFieldName)+"&";url+="nextFieldName="+escape(nextFieldName)+"&";url+="previousFieldValue="+escape(previousFieldValue)+"&";url+="nextFieldValue="+escape(nextFieldValue)+"&";url+="fieldId="+escape(fieldId);var vWinUsers=window.open(url,"DateRangePopup","status=no,resizable=yes,top=100,left=200,width=580,height=400,scrollbars=yes");vWinUsers.opener=self;vWinUsers.focus()}function show_calendar2(formName,fieldName){var form=document.forms[formName];var element=form.elements[fieldName];var vWinCal=window.open(contextPath+"/secure/popups/Calendar.jspa?form="+formName+"&field="+fieldName+"&value="+escape(element.value)+"&decorator=none","Calendar","width=230,height=170,status=no,resizable=yes,top=220,left=200");vWinCal.opener=self;vWinCal.focus()};
/* module-key = 'jira.webresources:util-lite', location = '/includes/jira/common/trace.js' */
var JIRA=window.JIRA||{};JIRA.trace=function(){};
/* module-key = 'jira.webresources:util-lite', location = '/includes/jira/common/meta.js' */
(function($){AJS.namespace("JIRA.Meta");JIRA.Meta.getLoggedInUser=function(){return{name:AJS.Meta.get("remote-user"),fullName:AJS.Meta.get("remote-user-fullname")}};JIRA.Meta.getProject=function(){return AJS.params.projectKey};JIRA.Meta.getIssueKey=function(){return AJS.Meta.get("issue-key")}}(AJS.$));
/* module-key = 'jira.webresources:util-lite', location = '/includes/lib/class/Class.js' */
(function(){begetObject=function(obj){var f=function(){};f.prototype=obj;return new f()};var initializing=false,fnTest=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(){var prop;var _super=this.prototype;if(arguments.length>1){var interfaces=AJS.$.makeArray(arguments);prop=interfaces.pop();var completeInterface;AJS.$.each(interfaces,function(i,inter){if(completeInterface){completeInterface=completeInterface.extend(inter)}else{completeInterface=inter}});return completeInterface.extend(this.prototype).extend(prop)}else{prop=arguments[0]}initializing=true;var prototype=new this();initializing=false;for(var name in prop){if(prototype[name]=typeof prop[name]=="function"&&typeof _super[name]=="function"&&fnTest.test(prop[name])){prototype[name]=(function(name,fn){return function(){var tmp=this._super;this._super=_super[name];var ret=fn.apply(this,arguments);this._super=tmp;return ret}})(name,prop[name])}else{if(typeof _super[name]==="object"){var newObj=begetObject(prop[name]);AJS.$.each(_super[name],function(name,obj){if(!newObj[name]){newObj[name]=obj}else{if(typeof newObj[name]==="object"){var newSubObj=begetObject(newObj[name]);AJS.$.each(obj,function(subName,subObj){if(!newSubObj[subName]){newSubObj[subName]=subObj}});newObj[name]=newSubObj}}});prototype[name]=newObj}else{prototype[name]=prop[name]}}}function Class(){if(!initializing&&this.init){this.init.apply(this,arguments)}}Class.fn=Class.prototype=prototype;Class.constructor=Class;Class.extend=arguments.callee;return Class}})();Class.prototype.bind=function(evt,func){jQuery(this).bind(evt,func);return this};Class.prototype.trigger=function(event){var instance=jQuery(this),args=Array().slice.call(arguments,1);event=new jQuery.Event(event);args.unshift(event);instance.trigger.apply(instance,args);return !event.isDefaultPrevented()};
/* module-key = 'jira.webresources:util-lite', location = '/includes/ajs/control/Control.js' */
AJS.Control=Class.extend({INVALID:"INVALID",_throwReadOnlyError:function(property){new Error(this.CLASS_SIGNATURE+": Sorry ["+property+"] is a read-only property")},_assignEvents:function(group,$target){this._unassignEvents(group,$target);if(typeof $target==="string"){for(var eventType in this._events[group]){AJS.$(document).delegate($target,eventType,this._getDispatcher(group,eventType))}}else{$target=jQuery($target);for(eventType in this._events[group]){$target.bind(eventType,this._getDispatcher(group,eventType))}}return this},_unassignEvents:function(group,$target){if(typeof $target==="string"){for(var eventType in this._events[group]){AJS.$(document).undelegate($target,eventType,this._getDispatcher(group,eventType))}}else{$target=jQuery($target);for(eventType in this._events[group]){$target.unbind(eventType,this._getDispatcher(group,eventType))}}},_getDispatcher:function(group,eventType){var ns=group+"/"+eventType;if(!this._dispatchers){this._dispatchers={}}if(!this._dispatchers[ns]){var handler=this._events[group][eventType];var instance=this;this._dispatchers[ns]=function(event){return handler.call(instance,event,AJS.$(this))}}return this._dispatchers[ns]},_isValidInput:function(){return true},_handleKeyEvent:function(event){if(this._isValidInput(event)){if(event.type==="input"){if(typeof this.onEdit==="function"){this.onEdit(event)}}else{var heyHandler=this.keys&&this.keys[event.key];if(typeof heyHandler==="function"){heyHandler.call(this,event)}}}},getCustomEventName:function(methodName){return(this.CLASS_SIGNATURE||"")+"_"+methodName},_getCustomEventArgs:function(){return[this]},_supportsBoxShadow:function(){var s=document.body.style;return s.WebkitBoxShadow!==undefined||s.MozBoxShadow!==undefined||s.boxShadow!==undefined},_setOptions:function(options){var element,optionsFromDOM;options=options||{};if(options instanceof AJS.$||typeof options==="string"||(typeof options==="object"&&options.nodeName)){options={element:options}}element=AJS.$(options.element);optionsFromDOM=element.getOptionsFromAttributes();this.options=AJS.$.extend(true,this._getDefaultOptions(options),optionsFromDOM,options);if(element.length===0){return this.INVALID}return undefined},getCaret:function(node){var startIndex=node.selectionStart;if(startIndex>=0){return(node.selectionEnd>startIndex)?-1:startIndex}if(document.selection){var textRange1=document.selection.createRange();if(textRange1.text.length===0){var textRange2=textRange1.duplicate();textRange2.moveToElementText(node);textRange2.setEndPoint("EndToStart",textRange1);return textRange2.text.length}}return -1},_render:function(){var i,name=arguments[0],args=[];for(i=1;i<arguments.length;i++){args.push(arguments[i])}return this._renders[name].apply(this,args)}});
/* module-key = 'jira.webresources:util-lite', location = '/includes/ajs/descriptor/Descriptor.js' */
AJS.Descriptor=Class.extend({init:function(properties){if(this._validate(properties)){this.properties=AJS.$.extend(this._getDefaultOptions(),properties)}},allProperties:function(){return this.properties},_validate:function(properties){if(this.REQUIRED_PROPERTIES){AJS.$.each(this.REQUIRED_PROPERTIES,function(name){if(typeof properties[name]==="undefined"){throw new Error("AJS.Descriptor: expected property ["+name+"] but was undefined")}})}return true}});
/* module-key = 'jira.webresources:util-lite', location = '/includes/ajs/input/Keyboard.js' */
JIRA.Keyboard={};(function($){var _keyCodeToEnum={},_enumToKeyCode={},_keyCodeToIsAscii={};var SpecialKey=JIRA.Keyboard.SpecialKey={BACKSPACE:specialKey("backspace",8,true),TAB:specialKey("tab",9,true),RETURN:specialKey("return",13,true),SHIFT:specialKey("shift",16),CTRL:specialKey("ctrl",17),ALT:specialKey("alt",18),PAUSE:specialKey("pause",19),CAPS_LOCK:specialKey("capslock",20),ESC:specialKey("esc",27,true),SPACE:specialKey("space",32,true),PAGE_UP:specialKey("pageup",33),PAGE_DOWN:specialKey("pagedown",34),END:specialKey("end",35),HOME:specialKey("home",36),LEFT:specialKey("left",37),UP:specialKey("up",38),RIGHT:specialKey("right",39),DOWN:specialKey("down",40),INSERT:specialKey("insert",45),DELETE:specialKey("del",46),F1:specialKey("f1",112),F2:specialKey("f2",113),F3:specialKey("f3",114),F4:specialKey("f4",115),F5:specialKey("f5",116),F6:specialKey("f6",117),F7:specialKey("f7",118),F8:specialKey("f8",119),F9:specialKey("f9",120),F10:specialKey("f10",121),F11:specialKey("f11",122),F12:specialKey("f12",123),NUMLOCK:specialKey("numlock",144),SCROLL:specialKey("scroll",145),META:specialKey("meta",224)};function specialKey(name,keyCode,isAscii){_keyCodeToEnum[keyCode]=name;_enumToKeyCode[name]=keyCode;if(isAscii){_keyCodeToIsAscii[keyCode]=true}return name}SpecialKey.eventType=function(){return $.browser.mozilla?"keypress":"keydown"};SpecialKey.fromKeyCode=function(keyCode){return _keyCodeToEnum[keyCode]};SpecialKey.toKeyCode=function(specialKey){return _enumToKeyCode[specialKey]};SpecialKey.isAscii=function(keyCode){return !!_keyCodeToIsAscii[keyCode]};SpecialKey.isSpecialKey=function(keyName){return !!SpecialKey.toKeyCode(keyName)};function originalEvent(e){return e.originalEvent||e}JIRA.Keyboard.characterEntered=function(keypressEvent){var e=originalEvent(keypressEvent);if(e.type==="keypress"){var characterCode=characterCodeForKeypress(e);if(characterCode!==null&&(!SpecialKey.isAscii(characterCode)||SpecialKey.fromKeyCode(characterCode)===SpecialKey.SPACE)){return String.fromCharCode(characterCode)}}return undefined};function characterCodeForKeypress(keypressEvent){var e=originalEvent(keypressEvent);if(e.which==null){return e.keyCode}else{if(e.which!=0&&e.charCode!=0){return e.which}else{return null}}}JIRA.Keyboard.specialKeyEntered=function(e){e=originalEvent(e);if($.browser.mozilla){if(e.type==="keypress"){var characterCode=characterCodeForKeypress(e);if(characterCode===null){return SpecialKey.fromKeyCode(e.keyCode)}else{if(SpecialKey.isAscii(characterCode)){return SpecialKey.fromKeyCode(characterCode)}}}}else{if(e.type!=="keypress"){return SpecialKey.fromKeyCode(e.keyCode)}}return undefined};function keyEntered(e){e=originalEvent(e);var special=JIRA.Keyboard.specialKeyEntered(e);if(special){return special}else{if($.browser.mozilla){if(e.type==="keypress"){var characterCode=characterCodeForKeypress(e);if(characterCode!==null){return String.fromCharCode(characterCode).toLowerCase()}}}else{if(e.type!=="keypress"){return String.fromCharCode(e.keyCode).toLowerCase()}}}return undefined}JIRA.Keyboard.shortcutEntered=function(e){e=originalEvent(e);if(e.type===JIRA.Keyboard.SpecialKey.eventType()){var specialKey=JIRA.Keyboard.specialKeyEntered(e),modifiers="";if(e.altKey&&specialKey!==SpecialKey.ALT){modifiers+=modifier(SpecialKey.ALT)}if(e.ctrlKey&&specialKey!==SpecialKey.CTRL){modifiers+=modifier(SpecialKey.CTRL)}if(e.metaKey&&!e.ctrlKey&&specialKey!==SpecialKey.META){modifiers+=modifier(SpecialKey.META)}if(e.shiftKey&&specialKey!==SpecialKey.SHIFT){modifiers+=modifier(SpecialKey.SHIFT)}if(specialKey){return modifiers+specialKey}else{if(modifiers.length>0&&modifiers!=="shift+"){var key=keyEntered(e);if(key){return modifiers+key}}}}return undefined};function modifier(modifier){return modifier+"+"}})(AJS.$);
/* module-key = 'jira.webresources:util-lite', location = '/includes/ajs/input/Mouse.js' */
(function($){JIRA.Mouse={};var MotionDetector=JIRA.Mouse.MotionDetector=function(){this.reset()};MotionDetector.prototype.reset=function(){this._handler=null;this._x=null;this._y=null;this.moved=false};MotionDetector.prototype.wait=function(eventHandler){var instance=this;if(!instance._handler){this.reset();$(window.top.document).bind("mousemove",instance._handler=function(e){if(!instance._x&&!instance._y){instance._x=e.pageX;instance._y=e.pageY}else{if(!(e.pageX===instance._x&&e.pageY===instance._y)){instance.unbind();instance.moved=true;if(eventHandler){eventHandler.call(this,e)}}}})}};MotionDetector.prototype.unbind=function(){if(this._handler){$(window.top.document).unbind("mousemove",this._handler);this.reset()}}})(AJS.$);
/* module-key = 'jira.webresources:util-lite', location = '/includes/jquery/plugins/getoptionsfromattributes/getOptionsFromAttributes.js' */
jQuery.fn.getOptionsFromAttributes=function(){var options={};if(this.length){jQuery.each(this[0].attributes,function(){var map,nodeValue=this.nodeValue,target=options;if(/^data-/.test(this.nodeName)){map=this.nodeName.replace(/^data-/,"").split("."),AJS.$.each(map,function(i,propertyName){propertyName=propertyName.replace(/([a-z])-([a-z])/gi,function(entireMatch,firstMatch,secondMatch){return firstMatch+secondMatch.toUpperCase()});propertyName=propertyName.replace(/_([a-z]+)/gi,function(entireMatch,firstMatch){return firstMatch.toUpperCase()});if(i===map.length-1){target[propertyName]=nodeValue.match(/^(tru|fals)e$/i)?nodeValue.toLowerCase()=="true":nodeValue}else{if(!target[propertyName]){target[propertyName]={}}}target=target[propertyName]})}})}return options};
/* module-key = 'jira.webresources:util-lite', location = '/includes/ajs/ajax/SmartAjax.js' */
JIRA.SmartAjax={};(function($){JIRA.SmartAjax.SmartAjaxResult=function(xhr,requestId,statusText,data,successful,errorThrown){var status=tryIt(function(){return xhr.status},0);var result={successful:successful,status:status,statusText:statusText,errorThrown:errorThrown,readyState:xhr.readyState,hasData:data!=null&&data.length>0,data:data,xhr:xhr,aborted:xhr.aborted,requestId:requestId,validationError:!!(xhr.status===400&&data&&data.errors)};result.toString=function(){return"{\n"+"successful  : "+this.successful+",\n"+"status      : "+this.status+",\n"+"statusText  : "+this.statusText+",\n"+"hasData     : "+this.hasData+",\n"+"readyState  : "+this.readyState+",\n"+"requestId   : "+this.requestId+",\n"+"aborted     : "+this.aborted+",\n"+"}"};return result};JIRA.SmartAjax.SmartAjaxResult.ERROR="error";JIRA.SmartAjax.SmartAjaxResult.TIMEOUT="timeout";JIRA.SmartAjax.SmartAjaxResult.NOTMODIFIED="notmodified";JIRA.SmartAjax.SmartAjaxResult.PARSEERROR="parseerror";JIRA.SmartAjax.makeRequest=function(ajaxOptions){var _smartAjaxResult={};var log=function(calltype,requestId,msg){if(AJS.log){var id=requestId?"["+requestId+"] ":" ";AJS.log("ajax"+id+calltype+" : "+msg)}};var generateRequestId=function(){var now=new Date();var midnight=new Date(now.getFullYear(),now.getMonth(),now.getDate(),0,0,0,0);var ms=(now.getTime()-midnight.getTime());return Math.max(Math.floor(ms),1)};var errorHandler=function(xhr,statusText,errorThrown,smartAjaxResult){if(!smartAjaxResult){var data=tryIt(function(){return xhr.responseText},"");smartAjaxResult=_smartAjaxResult=new JIRA.SmartAjax.SmartAjaxResult(xhr,_requestId,statusText,data,false,errorThrown)}log("error",smartAjaxResult.requestId,smartAjaxResult);if($.isFunction(ajaxOptions.error)){ajaxOptions.error(xhr,statusText,errorThrown,smartAjaxResult)}};var successHandler=function(data,statusText,xhr){if(xhr.status<100){_smartAjaxResult=new JIRA.SmartAjax.SmartAjaxResult(xhr,_requestId,JIRA.SmartAjax.SmartAjaxResult.ERROR,"",false);errorHandler(xhr,JIRA.SmartAjax.SmartAjaxResult.ERROR,undefined,_smartAjaxResult);return }_smartAjaxResult=new JIRA.SmartAjax.SmartAjaxResult(xhr,_requestId,statusText,data,true);if($.isFunction(ajaxOptions.success)){ajaxOptions.success(data,statusText,xhr,_smartAjaxResult)}};var completeHandler=function(xhr,textStatus){if($.isFunction(ajaxOptions.complete)){ajaxOptions.complete(xhr,textStatus,_smartAjaxResult)}};var DEFAULT_AJAX_OPTS={jqueryAjaxFn:$.ajax,headers:{"X-AUSERNAME":encodeURIComponent(AJS.params.loggedInUser)}};var ourAjaxOptions=$.extend(true,{},DEFAULT_AJAX_OPTS,ajaxOptions);ourAjaxOptions.error=errorHandler;ourAjaxOptions.success=successHandler;ourAjaxOptions.complete=completeHandler;var xhr=ourAjaxOptions.jqueryAjaxFn.apply(ourAjaxOptions,[ourAjaxOptions]);var _requestId=generateRequestId();try{xhr.abort=function(oldabort){return function(){log("aborted",_requestId,"");xhr.aborted=true;if($.isFunction(oldabort)){try{oldabort.call(xhr)}catch(ex){}}}}(xhr.abort)}catch(ex){}return xhr};JIRA.SmartAjax.buildDialogErrorContent=function(smartAjaxResult,noHeader){var fourHundredClass=Math.floor(smartAjaxResult.status/100);if(smartAjaxResult.hasData&&fourHundredClass!=4){return wrapDialogErrorContent(AJS.extractBodyFromResponse(smartAjaxResult.data))}else{var errMsg=buildRawHttpErrorMessage(smartAjaxResult);return buildDialogAjaxErrorMessage(errMsg,noHeader)}};JIRA.SmartAjax.buildSimpleErrorContent=function(smartAjaxResult,options){return buildRawHttpErrorMessage(smartAjaxResult,options?options:{})};function buildRawHttpErrorMessage(smartAjaxResult,options){var AJS=window.top.AJS;var errMsg;if(smartAjaxResult.statusText==JIRA.SmartAjax.SmartAjaxResult.TIMEOUT){errMsg="The call to the JIRA server did not complete within the timeout period.  We are unsure of the result of this operation."}else{if(smartAjaxResult.status==401){errMsg="You are not authorized to perform this operation.  Please log in."}else{if(smartAjaxResult.hasData){errMsg="The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation."}else{errMsg="The JIRA server could not be contacted.  This may be a temporary glitch or the server may be down."}}}return errMsg}function buildDialogAjaxErrorMessage(errorMessage,noHeader){var errorContent='<div class="aui-message error"><span class="aui-icon icon-error"></span>'+"<p>"+errorMessage+"</p>"+"<p>"+"Close this dialog and press refresh in your browser"+"</p>"+"</div>";if(!noHeader){errorContent="<h1>"+"Communications Breakdown"+"</h1>"+errorContent}return wrapDialogErrorContent(errorContent)}function wrapDialogErrorContent(content){var $container=$('<div class="ajaxerror"/>');$container.append(content);return $container}})(AJS.$);AJS.$(function(){AJS.$.ajaxSetup({timeout:60000,async:true,cache:false,global:true})});AJS.namespace("jira.ajax",null,JIRA.SmartAjax);
/* module-key = 'jira.webresources:util-lite', location = '/includes/ajs/reasons.js' */
AJS.HIDE_REASON={clickOutside:"clickOutside",toggle:"toggle",escPressed:"esc",cancelClicked:"cancelClicked",submit:"submit",tabbedOut:"tabbedOut"};
/* module-key = 'jira.webresources:util-lite', location = '/includes/ajs/layer/LayerManager.js' */
(function(){JIRA.bind("Dialog.beforeHide",function(e){if(typeof Calendar!=="undefined"&&Calendar.current){e.preventDefault()}if(JIRA.Dropdown&&JIRA.Dropdown.current){e.preventDefault()}if(AJS.InlineLayer&&AJS.InlineLayer.current){e.preventDefault()}if(AJS.Dropdown&&AJS.Dropdown.current){e.preventDefault()}if(AJS.InlineDialog&&AJS.InlineDialog.current){e.preventDefault()}});JIRA.bind("Dialog.show",function(e){if(JIRA.Dropdown&&JIRA.Dropdown.current){JIRA.Dropdown.current.hide()}if(AJS.InlineLayer&&AJS.InlineLayer.current){AJS.InlineLayer.current.hide();e.preventDefault()}if(AJS.Dropdown&&AJS.Dropdown.current){AJS.Dropdown.current.hide();e.preventDefault()}if(AJS.InlineDialog&&AJS.InlineDialog.current){AJS.InlineDialog.current.hide();e.preventDefault()}});jQuery(function(){if(typeof Calendar!=="undefined"){jQuery(document).bind("beforeBlurInput",function(e){if(Calendar.current){e.preventDefault()}if(JIRA.InlineLayer&&JIRA.InlineLayer.current){e.preventDefault()}});if(JIRA.Events.BEFORE_INLINE_EDIT_CANCEL){JIRA.bind(JIRA.Events.BEFORE_INLINE_EDIT_CANCEL,function(e,id,type,reason){if(reason===JIRA.Issues.CANCEL_REASON.escPressed&&Calendar.current){e.preventDefault()}})}}});var $doc=jQuery(document);function getWindow(){var topWindow=window;try{while(topWindow.parent.window!==topWindow.window&&topWindow.parent.AJS){topWindow=topWindow.parent}}catch(error){}return topWindow}function getLayer(instance){return(instance.$layer||instance.$popup||instance.$||instance.popup||instance.element||instance)[0]}function listenForLayerEvents($doc){$doc.bind("showLayer",function(e,type,item){if(item&&item.id&&(item.id.indexOf("user-hover-dialog")>=0||item.id.indexOf("aui-inline-edit-error")>=0||item.id.indexOf("watchers")>=0)){return }var topWindow=getWindow().AJS;if(topWindow.currentLayerItem&&item!==topWindow.currentLayerItem&&topWindow.currentLayerItem.type!=="popup"){topWindow.currentLayerItem.hide()}if(item){topWindow.currentLayerItem=item;topWindow.currentLayerItem.type=type}}).bind("hideLayer",function(e,type,item){if(!item||item.id&&(item.id.indexOf("user-hover-dialog")>=0||item.id.indexOf("aui-inline-edit-error")>=0)){return }var topWindow=getWindow().AJS;if(topWindow.currentLayerItem){if(topWindow.currentLayerItem===item){topWindow.currentLayerItem=null}else{if(jQuery.contains(getLayer(item),getLayer(topWindow.currentLayerItem))){topWindow.currentLayerItem.hide()}}}}).bind("hideAllLayers",function(){var topWindow=getWindow().AJS;if(topWindow.currentLayerItem){topWindow.currentLayerItem.hide()}}).click(function(e){var topWindow=getWindow().AJS;var layerItem=topWindow.currentLayerItem;if(layerItem&&layerItem.type!=="popup"){if(layerItem._validateClickToClose){if(layerItem._validateClickToClose(e)){if(layerItem instanceof AJS.InlineLayer){layerItem.hide(AJS.HIDE_REASON.clickOutside,e)}else{layerItem.hide()}}}else{layerItem.hide()}}})}$doc.bind("iframeAppended",function(e,iframe){iframe=jQuery(iframe);iframe.load(function(){listenForLayerEvents(iframe.contents())})});listenForLayerEvents($doc)})();
/* module-key = 'jira.webresources:util-lite', location = '/includes/jquery/plugins/hasFixedParent/hasFixedParent.js' */
jQuery.fn.hasFixedParent=function(){var hasFixedParent=false;this.parents().each(function(){if(AJS.$(this).css("position")==="fixed"){hasFixedParent=this;return false}});return hasFixedParent};
/* module-key = 'jira.webresources:browser-properties', location = '/includes/ajs/browser/Navigator.js' */
AJS.Navigator=jQuery.extend({},AJS.Navigator,{family:function(){if(jQuery.browser["msie"]){return this.Families.INTERNET_EXPLORER}if(jQuery.browser["mozilla"]){return this.Families.MOZILLA}if(jQuery.browser["webkit"]){return this.Families.WEBKIT}if(jQuery.browser["opera"]){return this.Families.OPERA}return this.Families.UNKNOWN},modifierKey:function(){if(this.family()===this.Families.INTERNET_EXPLORER){return"Alt"}if(this.family()===this.Families.MOZILLA){if(jQuery.os.mac){return"Ctrl"}else{return"Alt+Shift"}}if(this.family()===this.Families.WEBKIT){if(jQuery.os.windows){return"Alt"}else{return"Ctrl+Alt"}}if(this.family()===this.Families.OPERA){return"Shift+Esc"}return"Alt"},platform:function(){return AJS.Navigator.Platform}});AJS.Navigator.Families=jQuery.extend({},AJS.Navigator.Families,{INTERNET_EXPLORER:"msie",MOZILLA:"mozilla",WEBKIT:"webkit",OPERA:"opera",UNKNOWN:"unknown"});AJS.Navigator.Platform={platform:navigator.platform,isIOS:function(){return this.platform==="iPod"||this.platform==="iPhone"||this.platform==="iPad"}};
/* module-key = 'com.atlassian.auiplugin:ajs-underscorejs', location = 'js/external/underscorejs/underscore.js' */
(function(){var W=this;var K=W._;var d={};var c=Array.prototype,F=Object.prototype,R=Function.prototype;var h=c.push,O=c.slice,Y=c.concat,D=F.toString,J=F.hasOwnProperty;var l=c.forEach,Q=c.map,e=c.reduce,C=c.reduceRight,B=c.filter,b=c.every,P=c.some,N=c.indexOf,L=c.lastIndexOf,U=Array.isArray,E=Object.keys,f=R.bind;var m=function(n){if(n instanceof m){return n}if(!(this instanceof m)){return new m(n)}this._wrapped=n};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=m}exports._=m}else{W._=m}m.VERSION="1.4.3";var i=m.each=m.forEach=function(s,r,q){if(s==null){return }if(l&&s.forEach===l){s.forEach(r,q)}else{if(s.length===+s.length){for(var p=0,n=s.length;p<n;p++){if(r.call(q,s[p],p,s)===d){return }}}else{for(var o in s){if(m.has(s,o)){if(r.call(q,s[o],o,s)===d){return }}}}}};m.map=m.collect=function(q,p,o){var n=[];if(q==null){return n}if(Q&&q.map===Q){return q.map(p,o)}i(q,function(t,r,s){n[n.length]=p.call(o,t,r,s)});return n};var G="Reduce of empty array with no initial value";m.reduce=m.foldl=m.inject=function(r,q,n,p){var o=arguments.length>2;if(r==null){r=[]}if(e&&r.reduce===e){if(p){q=m.bind(q,p)}return o?r.reduce(q,n):r.reduce(q)}i(r,function(u,s,t){if(!o){n=u;o=true}else{n=q.call(p,n,u,s,t)}});if(!o){throw new TypeError(G)}return n};m.reduceRight=m.foldr=function(t,q,n,p){var o=arguments.length>2;if(t==null){t=[]}if(C&&t.reduceRight===C){if(p){q=m.bind(q,p)}return o?t.reduceRight(q,n):t.reduceRight(q)}var s=t.length;if(s!==+s){var r=m.keys(t);s=r.length}i(t,function(w,u,v){u=r?r[--s]:--s;if(!o){n=t[u];o=true}else{n=q.call(p,n,t[u],u,v)}});if(!o){throw new TypeError(G)}return n};m.find=m.detect=function(q,p,o){var n;a(q,function(t,r,s){if(p.call(o,t,r,s)){n=t;return true}});return n};m.filter=m.select=function(q,p,o){var n=[];if(q==null){return n}if(B&&q.filter===B){return q.filter(p,o)}i(q,function(t,r,s){if(p.call(o,t,r,s)){n[n.length]=t}});return n};m.reject=function(p,o,n){return m.filter(p,function(s,q,r){return !o.call(n,s,q,r)},n)};m.every=m.all=function(q,p,o){p||(p=m.identity);var n=true;if(q==null){return n}if(b&&q.every===b){return q.every(p,o)}i(q,function(t,r,s){if(!(n=n&&p.call(o,t,r,s))){return d}});return !!n};var a=m.some=m.any=function(q,p,o){p||(p=m.identity);var n=false;if(q==null){return n}if(P&&q.some===P){return q.some(p,o)}i(q,function(t,r,s){if(n||(n=p.call(o,t,r,s))){return d}});return !!n};m.contains=m.include=function(o,n){if(o==null){return false}if(N&&o.indexOf===N){return o.indexOf(n)!=-1}return a(o,function(p){return p===n})};m.invoke=function(o,p){var n=O.call(arguments,2);return m.map(o,function(q){return(m.isFunction(p)?p:q[p]).apply(q,n)})};m.pluck=function(o,n){return m.map(o,function(p){return p[n]})};m.where=function(o,n){if(m.isEmpty(n)){return[]}return m.filter(o,function(q){for(var p in n){if(n[p]!==q[p]){return false}}return true})};m.max=function(q,p,o){if(!p&&m.isArray(q)&&q[0]===+q[0]&&q.length<65535){return Math.max.apply(Math,q)}if(!p&&m.isEmpty(q)){return -Infinity}var n={computed:-Infinity,value:-Infinity};i(q,function(u,r,t){var s=p?p.call(o,u,r,t):u;s>=n.computed&&(n={value:u,computed:s})});return n.value};m.min=function(q,p,o){if(!p&&m.isArray(q)&&q[0]===+q[0]&&q.length<65535){return Math.min.apply(Math,q)}if(!p&&m.isEmpty(q)){return Infinity}var n={computed:Infinity,value:Infinity};i(q,function(u,r,t){var s=p?p.call(o,u,r,t):u;s<n.computed&&(n={value:u,computed:s})});return n.value};m.shuffle=function(q){var p;var o=0;var n=[];i(q,function(r){p=m.random(o++);n[o-1]=n[p];n[p]=r});return n};var A=function(n){return m.isFunction(n)?n:function(o){return o[n]}};m.sortBy=function(q,p,n){var o=A(p);return m.pluck(m.map(q,function(t,r,s){return{value:t,index:r,criteria:o.call(n,t,r,s)}}).sort(function(u,t){var s=u.criteria;var r=t.criteria;if(s!==r){if(s>r||s===void 0){return 1}if(s<r||r===void 0){return -1}}return u.index<t.index?-1:1}),"value")};var T=function(s,r,o,q){var n={};var p=A(r||m.identity);i(s,function(v,t){var u=p.call(o,v,t,s);q(n,u,v)});return n};m.groupBy=function(p,o,n){return T(p,o,n,function(q,r,s){(m.has(q,r)?q[r]:(q[r]=[])).push(s)})};m.countBy=function(p,o,n){return T(p,o,n,function(q,r){if(!m.has(q,r)){q[r]=0}q[r]++})};m.sortedIndex=function(u,t,q,p){q=q==null?m.identity:A(q);var s=q.call(p,t);var n=0,r=u.length;while(n<r){var o=(n+r)>>>1;q.call(p,u[o])<s?n=o+1:r=o}return n};m.toArray=function(n){if(!n){return[]}if(m.isArray(n)){return O.call(n)}if(n.length===+n.length){return m.map(n,m.identity)}return m.values(n)};m.size=function(n){if(n==null){return 0}return(n.length===+n.length)?n.length:m.keys(n).length};m.first=m.head=m.take=function(q,p,o){if(q==null){return void 0}return(p!=null)&&!o?O.call(q,0,p):q[0]};m.initial=function(q,p,o){return O.call(q,0,q.length-((p==null)||o?1:p))};m.last=function(q,p,o){if(q==null){return void 0}if((p!=null)&&!o){return O.call(q,Math.max(q.length-p,0))}else{return q[q.length-1]}};m.rest=m.tail=m.drop=function(q,p,o){return O.call(q,(p==null)||o?1:p)};m.compact=function(n){return m.filter(n,m.identity)};var X=function(o,p,n){i(o,function(q){if(m.isArray(q)){p?h.apply(n,q):X(q,p,n)}else{n.push(q)}});return n};m.flatten=function(o,n){return X(o,n,[])};m.without=function(n){return m.difference(n,O.call(arguments,1))};m.uniq=m.unique=function(t,s,r,q){if(m.isFunction(s)){q=r;r=s;s=false}var o=r?m.map(t,r,q):t;var p=[];var n=[];i(o,function(v,u){if(s?(!u||n[n.length-1]!==v):!m.contains(n,v)){n.push(v);p.push(t[u])}});return p};m.union=function(){return m.uniq(Y.apply(c,arguments))};m.intersection=function(o){var n=O.call(arguments,1);return m.filter(m.uniq(o),function(p){return m.every(n,function(q){return m.indexOf(q,p)>=0})})};m.difference=function(o){var n=Y.apply(c,O.call(arguments,1));return m.filter(o,function(p){return !m.contains(n,p)})};m.zip=function(){var n=O.call(arguments);var q=m.max(m.pluck(n,"length"));var p=new Array(q);for(var o=0;o<q;o++){p[o]=m.pluck(n,""+o)}return p};m.object=function(r,p){if(r==null){return{}}var n={};for(var q=0,o=r.length;q<o;q++){if(p){n[r[q]]=p[q]}else{n[r[q][0]]=r[q][1]}}return n};m.indexOf=function(r,p,q){if(r==null){return -1}var o=0,n=r.length;if(q){if(typeof q=="number"){o=(q<0?Math.max(0,n+q):q)}else{o=m.sortedIndex(r,p);return r[o]===p?o:-1}}if(N&&r.indexOf===N){return r.indexOf(p,q)}for(;o<n;o++){if(r[o]===p){return o}}return -1};m.lastIndexOf=function(r,p,q){if(r==null){return -1}var n=q!=null;if(L&&r.lastIndexOf===L){return n?r.lastIndexOf(p,q):r.lastIndexOf(p)}var o=(n?q:r.length);while(o--){if(r[o]===p){return o}}return -1};m.range=function(s,q,r){if(arguments.length<=1){q=s||0;s=0}r=arguments[2]||1;var o=Math.max(Math.ceil((q-s)/r),0);var n=0;var p=new Array(o);while(n<o){p[n++]=s;s+=r}return p};var g=function(){};m.bind=function(q,o){var n,p;if(q.bind===f&&f){return f.apply(q,O.call(arguments,1))}if(!m.isFunction(q)){throw new TypeError}n=O.call(arguments,2);return p=function(){if(!(this instanceof p)){return q.apply(o,n.concat(O.call(arguments)))}g.prototype=q.prototype;var s=new g;g.prototype=null;var r=q.apply(s,n.concat(O.call(arguments)));if(Object(r)===r){return r}return s}};m.bindAll=function(o){var n=O.call(arguments,1);if(n.length==0){n=m.functions(o)}i(n,function(p){o[p]=m.bind(o[p],o)});return o};m.memoize=function(p,o){var n={};o||(o=m.identity);return function(){var q=o.apply(this,arguments);return m.has(n,q)?n[q]:(n[q]=p.apply(this,arguments))}};m.delay=function(o,p){var n=O.call(arguments,2);return setTimeout(function(){return o.apply(null,n)},p)};m.defer=function(n){return m.delay.apply(m,[n,1].concat(O.call(arguments,1)))};m.throttle=function(s,u){var q,p,t,n;var r=0;var o=function(){r=new Date;t=null;n=s.apply(q,p)};return function(){var v=new Date;var w=u-(v-r);q=this;p=arguments;if(w<=0){clearTimeout(t);t=null;r=v;n=s.apply(q,p)}else{if(!t){t=setTimeout(o,w)}}return n}};m.debounce=function(p,r,o){var q,n;return function(){var v=this,u=arguments;var t=function(){q=null;if(!o){n=p.apply(v,u)}};var s=o&&!q;clearTimeout(q);q=setTimeout(t,r);if(s){n=p.apply(v,u)}return n}};m.once=function(p){var n=false,o;return function(){if(n){return o}n=true;o=p.apply(this,arguments);p=null;return o}};m.wrap=function(n,o){return function(){var p=[n];h.apply(p,arguments);return o.apply(this,p)}};m.compose=function(){var n=arguments;return function(){var o=arguments;for(var p=n.length-1;p>=0;p--){o=[n[p].apply(this,o)]}return o[0]}};m.after=function(o,n){if(o<=0){return n()}return function(){if(--o<1){return n.apply(this,arguments)}}};m.keys=E||function(p){if(p!==Object(p)){throw new TypeError("Invalid object")}var o=[];for(var n in p){if(m.has(p,n)){o[o.length]=n}}return o};m.values=function(p){var n=[];for(var o in p){if(m.has(p,o)){n.push(p[o])}}return n};m.pairs=function(p){var o=[];for(var n in p){if(m.has(p,n)){o.push([n,p[n]])}}return o};m.invert=function(p){var n={};for(var o in p){if(m.has(p,o)){n[p[o]]=o}}return n};m.functions=m.methods=function(p){var o=[];for(var n in p){if(m.isFunction(p[n])){o.push(n)}}return o.sort()};m.extend=function(n){i(O.call(arguments,1),function(o){if(o){for(var p in o){n[p]=o[p]}}});return n};m.pick=function(o){var p={};var n=Y.apply(c,O.call(arguments,1));i(n,function(q){if(q in o){p[q]=o[q]}});return p};m.omit=function(p){var q={};var o=Y.apply(c,O.call(arguments,1));for(var n in p){if(!m.contains(o,n)){q[n]=p[n]}}return q};m.defaults=function(n){i(O.call(arguments,1),function(o){if(o){for(var p in o){if(n[p]==null){n[p]=o[p]}}}});return n};m.clone=function(n){if(!m.isObject(n)){return n}return m.isArray(n)?n.slice():m.extend({},n)};m.tap=function(o,n){n(o);return o};var j=function(u,t,o,p){if(u===t){return u!==0||1/u==1/t}if(u==null||t==null){return u===t}if(u instanceof m){u=u._wrapped}if(t instanceof m){t=t._wrapped}var r=D.call(u);if(r!=D.call(t)){return false}switch(r){case"[object String]":return u==String(t);case"[object Number]":return u!=+u?t!=+t:(u==0?1/u==1/t:u==+t);case"[object Date]":case"[object Boolean]":return +u==+t;case"[object RegExp]":return u.source==t.source&&u.global==t.global&&u.multiline==t.multiline&&u.ignoreCase==t.ignoreCase}if(typeof u!="object"||typeof t!="object"){return false}var n=o.length;while(n--){if(o[n]==u){return p[n]==t}}o.push(u);p.push(t);var w=0,x=true;if(r=="[object Array]"){w=u.length;x=w==t.length;if(x){while(w--){if(!(x=j(u[w],t[w],o,p))){break}}}}else{var s=u.constructor,q=t.constructor;if(s!==q&&!(m.isFunction(s)&&(s instanceof s)&&m.isFunction(q)&&(q instanceof q))){return false}for(var v in u){if(m.has(u,v)){w++;if(!(x=m.has(t,v)&&j(u[v],t[v],o,p))){break}}}if(x){for(v in t){if(m.has(t,v)&&!(w--)){break}}x=!w}}o.pop();p.pop();return x};m.isEqual=function(o,n){return j(o,n,[],[])};m.isEmpty=function(o){if(o==null){return true}if(m.isArray(o)||m.isString(o)){return o.length===0}for(var n in o){if(m.has(o,n)){return false}}return true};m.isElement=function(n){return !!(n&&n.nodeType===1)};m.isArray=U||function(n){return D.call(n)=="[object Array]"};m.isObject=function(n){return n===Object(n)};i(["Arguments","Function","String","Number","Date","RegExp"],function(n){m["is"+n]=function(o){return D.call(o)=="[object "+n+"]"}});if(!m.isArguments(arguments)){m.isArguments=function(n){return !!(n&&m.has(n,"callee"))}}if(typeof (/./)!=="function"){m.isFunction=function(n){return typeof n==="function"}}m.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))};m.isNaN=function(n){return m.isNumber(n)&&n!=+n};m.isBoolean=function(n){return n===true||n===false||D.call(n)=="[object Boolean]"};m.isNull=function(n){return n===null};m.isUndefined=function(n){return n===void 0};m.has=function(o,n){return J.call(o,n)};m.noConflict=function(){W._=K;return this};m.identity=function(n){return n};m.times=function(s,r,q){var o=Array(s);for(var p=0;p<s;p++){o[p]=r.call(q,p)}return o};m.random=function(o,n){if(n==null){n=o;o=0}return o+(0|Math.random()*(n-o+1))};var M={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};M.unescape=m.invert(M.escape);var k={escape:new RegExp("["+m.keys(M.escape).join("")+"]","g"),unescape:new RegExp("("+m.keys(M.unescape).join("|")+")","g")};m.each(["escape","unescape"],function(n){m[n]=function(o){if(o==null){return""}return(""+o).replace(k[n],function(p){return M[n][p]})}});m.result=function(n,p){if(n==null){return null}var o=n[p];return m.isFunction(o)?o.call(n):o};m.mixin=function(n){i(m.functions(n),function(o){var p=m[o]=n[o];m.prototype[o]=function(){var q=[this._wrapped];h.apply(q,arguments);return S.call(this,p.apply(m,q))}})};var Z=0;m.uniqueId=function(n){var o=""+ ++Z;return n?n+o:o};m.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var V=/(.)^/;var H={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"};var I=/\\|'|\r|\n|\t|\u2028|\u2029/g;m.template=function(v,q,p){p=m.defaults({},p,m.templateSettings);var r=new RegExp([(p.escape||V).source,(p.interpolate||V).source,(p.evaluate||V).source].join("|")+"|$","g");var s=0;var n="__p+='";v.replace(r,function(x,y,w,AA,z){n+=v.slice(s,z).replace(I,function(AB){return"\\"+H[AB]});if(y){n+="'+\n((__t=("+y+"))==null?'':_.escape(__t))+\n'"}if(w){n+="'+\n((__t=("+w+"))==null?'':__t)+\n'"}if(AA){n+="';\n"+AA+"\n__p+='"}s=z+x.length;return x});n+="';\n";if(!p.variable){n="with(obj||{}){\n"+n+"}\n"}n="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+n+"return __p;\n";try{var o=new Function(p.variable||"obj","_",n)}catch(t){t.source=n;throw t}if(q){return o(q,m)}var u=function(w){return o.call(this,w,m)};u.source="function("+(p.variable||"obj")+"){\n"+n+"}";return u};m.chain=function(n){return m(n).chain()};var S=function(n){return this._chain?m(n).chain():n};m.mixin(m);i(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var o=c[n];m.prototype[n]=function(){var p=this._wrapped;o.apply(p,arguments);if((n=="shift"||n=="splice")&&p.length===0){delete p[0]}return S.call(this,p)}});i(["concat","join","slice"],function(n){var o=c[n];m.prototype[n]=function(){return S.call(this,o.apply(this._wrapped,arguments))}});m.extend(m.prototype,{chain:function(){this._chain=true;return this},value:function(){return this._wrapped}})}).call(this);
/* module-key = 'com.atlassian.auiplugin:ajs-backbone', location = 'js/external/backbone/backbone.js' */
(function(){var Q=this;var O=Q.Backbone;var P=Array.prototype.slice;var Y=Array.prototype.splice;var C;if(typeof exports!=="undefined"){C=exports}else{C=Q.Backbone={}}C.VERSION="0.9.2";var a=Q._;if(!a&&(typeof require!=="undefined")){a=require("underscore")}var G=Q.jQuery||Q.Zepto||Q.ender;C.setDomLibrary=function(c){G=c};C.noConflict=function(){Q.Backbone=O;return this};C.emulateHTTP=false;C.emulateJSON=false;var A=/\s+/;var N=C.Events={on:function(f,j,e){var d,h,g,c,i;if(!j){return this}f=f.split(A);d=this._callbacks||(this._callbacks={});while(h=f.shift()){i=d[h];g=i?i.tail:{};g.next=c={};g.context=e;g.callback=j;d[h]={tail:c,next:i?i.next:g}}return this},off:function(j,h,d){var c,k,e,g,f,i;if(!(k=this._callbacks)){return }if(!(j||h||d)){delete this._callbacks;return this}j=j?j.split(A):a.keys(k);while(c=j.shift()){e=k[c];delete k[c];if(!e||!(h||d)){continue}g=e.tail;while((e=e.next)!==g){f=e.callback;i=e.context;if((h&&f!==h)||(d&&i!==d)){this.on(c,f,i)}}}return this},trigger:function(f){var j,i,e,d,c,h,g;if(!(e=this._callbacks)){return this}h=e.all;f=f.split(A);g=P.call(arguments,1);while(j=f.shift()){if(i=e[j]){d=i.tail;while((i=i.next)!==d){i.callback.apply(i.context||this,g)}}if(i=h){d=i.tail;c=[j].concat(g);while((i=i.next)!==d){i.callback.apply(i.context||this,c)}}}return this}};N.bind=N.on;N.unbind=N.off;var K=C.Model=function(c,d){var e;c||(c={});if(d&&d.parse){c=this.parse(c)}if(e=D(this,"defaults")){c=a.extend({},e,c)}if(d&&d.collection){this.collection=d.collection}this.attributes={};this._escapedAttributes={};this.cid=a.uniqueId("c");this.changed={};this._silent={};this._pending={};this.set(c,{silent:true});this.changed={};this._silent={};this._pending={};this._previousAttributes=a.clone(this.attributes);this.initialize.apply(this,arguments)};a.extend(K.prototype,N,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(c){return a.clone(this.attributes)},get:function(c){return this.attributes[c]},escape:function(c){var d;if(d=this._escapedAttributes[c]){return d}var e=this.get(c);return this._escapedAttributes[c]=a.escape(e==null?"":""+e)},has:function(c){return this.get(c)!=null},set:function(j,i,l){var k,g,e;if(a.isObject(j)||j==null){k=j;l=i}else{k={};k[j]=i}l||(l={});if(!k){return this}if(k instanceof K){k=k.attributes}if(l.unset){for(g in k){k[g]=void 0}}if(!this._validate(k,l)){return false}if(this.idAttribute in k){this.id=k[this.idAttribute]}var h=l.changes={};var d=this.attributes;var c=this._escapedAttributes;var f=this._previousAttributes||{};for(g in k){e=k[g];if(!a.isEqual(d[g],e)||(l.unset&&a.has(d,g))){delete c[g];(l.silent?this._silent:h)[g]=true}l.unset?delete d[g]:d[g]=e;if(!a.isEqual(f[g],e)||(a.has(d,g)!=a.has(f,g))){this.changed[g]=e;if(!l.silent){this._pending[g]=true}}else{delete this.changed[g];delete this._pending[g]}}if(!l.silent){this.change(l)}return this},unset:function(c,d){(d||(d={})).unset=true;return this.set(c,null,d)},clear:function(c){(c||(c={})).unset=true;return this.set(a.clone(this.attributes),c)},fetch:function(d){d=d?a.clone(d):{};var c=this;var e=d.success;d.success=function(h,f,g){if(!c.set(c.parse(h,g),d)){return false}if(e){e(c,h)}};d.error=C.wrapError(d.error,c,d);return(this.sync||C.sync).call(this,"read",this,d)},save:function(h,g,l){var i,f;if(a.isObject(h)||h==null){i=h;l=g}else{i={};i[h]=g}l=l?a.clone(l):{};if(l.wait){if(!this._validate(i,l)){return false}f=a.clone(this.attributes)}var d=a.extend({},l,{silent:true});if(i&&!this.set(i,l.wait?d:l)){return false}var e=this;var j=l.success;l.success=function(p,m,o){var n=e.parse(p,o);if(l.wait){delete l.wait;n=a.extend(i||{},n)}if(!e.set(n,l)){return false}if(j){j(e,p)}else{e.trigger("sync",e,p,l)}};l.error=C.wrapError(l.error,e,l);var c=this.isNew()?"create":"update";var k=(this.sync||C.sync).call(this,c,this,l);if(l.wait){this.set(f,d)}return k},destroy:function(d){d=d?a.clone(d):{};var c=this;var g=d.success;var f=function(){c.trigger("destroy",c,c.collection,d)};if(this.isNew()){f();return false}d.success=function(h){if(d.wait){f()}if(g){g(c,h)}else{c.trigger("sync",c,h,d)}};d.error=C.wrapError(d.error,c,d);var e=(this.sync||C.sync).call(this,"delete",this,d);if(!d.wait){f()}return e},url:function(){var c=D(this,"urlRoot")||D(this.collection,"url")||T();if(this.isNew()){return c}return c+(c.charAt(c.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(d,c){return d},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},change:function(d){d||(d={});var f=this._changing;this._changing=true;for(var c in this._silent){this._pending[c]=true}var e=a.extend({},d.changes,this._silent);this._silent={};for(var c in e){this.trigger("change:"+c,this,this.get(c),d)}if(f){return this}while(!a.isEmpty(this._pending)){this._pending={};this.trigger("change",this,d);for(var c in this.changed){if(this._pending[c]||this._silent[c]){continue}delete this.changed[c]}this._previousAttributes=a.clone(this.attributes)}this._changing=false;return this},hasChanged:function(c){if(!arguments.length){return !a.isEmpty(this.changed)}return a.has(this.changed,c)},changedAttributes:function(e){if(!e){return this.hasChanged()?a.clone(this.changed):false}var g,f=false,d=this._previousAttributes;for(var c in e){if(a.isEqual(d[c],(g=e[c]))){continue}(f||(f={}))[c]=g}return f},previous:function(c){if(!arguments.length||!this._previousAttributes){return null}return this._previousAttributes[c]},previousAttributes:function(){return a.clone(this._previousAttributes)},isValid:function(){return !this.validate(this.attributes)},_validate:function(e,d){if(d.silent||!this.validate){return true}e=a.extend({},this.attributes,e);var c=this.validate(e,d);if(!c){return true}if(d&&d.error){d.error(this,c,d)}else{this.trigger("error",this,c,d)}return false}});var b=C.Collection=function(d,c){c||(c={});if(c.model){this.model=c.model}if(c.comparator){this.comparator=c.comparator}this._reset();this.initialize.apply(this,arguments);if(d){this.reset(d,{silent:true,parse:c.parse})}};a.extend(b.prototype,N,{model:K,initialize:function(){},toJSON:function(c){return this.map(function(d){return d.toJSON(c)})},add:function(d,n){var j,l,f,k,m,e,g={},c={},h=[];n||(n={});d=a.isArray(d)?d.slice():[d];for(j=0,f=d.length;j<f;j++){if(!(k=d[j]=this._prepareModel(d[j],n))){throw new Error("Can't add an invalid model to a collection")}m=k.cid;e=k.id;if(g[m]||this._byCid[m]||((e!=null)&&(c[e]||this._byId[e]))){h.push(j);continue}g[m]=c[e]=k}j=h.length;while(j--){d.splice(h[j],1)}for(j=0,f=d.length;j<f;j++){(k=d[j]).on("all",this._onModelEvent,this);this._byCid[k.cid]=k;if(k.id!=null){this._byId[k.id]=k}}this.length+=f;l=n.at!=null?n.at:this.models.length;Y.apply(this.models,[l,0].concat(d));if(this.comparator){this.sort({silent:true})}if(n.silent){return this}for(j=0,f=this.models.length;j<f;j++){if(!g[(k=this.models[j]).cid]){continue}n.index=j;k.trigger("add",k,this,n)}return this},remove:function(h,f){var g,c,e,d;f||(f={});h=a.isArray(h)?h.slice():[h];for(g=0,c=h.length;g<c;g++){d=this.getByCid(h[g])||this.get(h[g]);if(!d){continue}delete this._byId[d.id];delete this._byCid[d.cid];e=this.indexOf(d);this.models.splice(e,1);this.length--;if(!f.silent){f.index=e;d.trigger("remove",d,this,f)}this._removeReference(d)}return this},push:function(d,c){d=this._prepareModel(d,c);this.add(d,c);return d},pop:function(d){var c=this.at(this.length-1);this.remove(c,d);return c},unshift:function(d,c){d=this._prepareModel(d,c);this.add(d,a.extend({at:0},c));return d},shift:function(d){var c=this.at(0);this.remove(c,d);return c},get:function(c){if(c==null){return void 0}return this._byId[c.id!=null?c.id:c]},getByCid:function(c){return c&&this._byCid[c.cid||c]},at:function(c){return this.models[c]},where:function(c){if(a.isEmpty(c)){return[]}return this.filter(function(d){for(var e in c){if(c[e]!==d.get(e)){return false}}return true})},sort:function(d){d||(d={});if(!this.comparator){throw new Error("Cannot sort a set without a comparator")}var c=a.bind(this.comparator,this);if(this.comparator.length==1){this.models=this.sortBy(c)}else{this.models.sort(c)}if(!d.silent){this.trigger("reset",this,d)}return this},pluck:function(c){return a.map(this.models,function(d){return d.get(c)})},reset:function(f,d){f||(f=[]);d||(d={});for(var e=0,c=this.models.length;e<c;e++){this._removeReference(this.models[e])}this._reset();this.add(f,a.extend({silent:true},d));if(!d.silent){this.trigger("reset",this,d)}return this},fetch:function(c){c=c?a.clone(c):{};if(c.parse===undefined){c.parse=true}var e=this;var d=c.success;c.success=function(h,f,g){e[c.add?"add":"reset"](e.parse(h,g),c);if(d){d(e,h)}};c.error=C.wrapError(c.error,e,c);return(this.sync||C.sync).call(this,"read",this,c)},create:function(d,c){var e=this;c=c?a.clone(c):{};d=this._prepareModel(d,c);if(!d){return false}if(!c.wait){e.add(d,c)}var f=c.success;c.success=function(g,i,h){if(c.wait){e.add(g,c)}if(f){f(g,i)}else{g.trigger("sync",d,i,c)}};d.save(null,c);return d},parse:function(d,c){return d},chain:function(){return a(this.models).chain()},_reset:function(c){this.length=0;this.models=[];this._byId={};this._byCid={}},_prepareModel:function(e,d){d||(d={});if(!(e instanceof K)){var c=e;d.collection=this;e=new this.model(c,d);if(!e._validate(e.attributes,d)){e=false}}else{if(!e.collection){e.collection=this}}return e},_removeReference:function(c){if(this==c.collection){delete c.collection}c.off("all",this._onModelEvent,this)},_onModelEvent:function(e,d,f,c){if((e=="add"||e=="remove")&&f!=this){return }if(e=="destroy"){this.remove(d,c)}if(d&&e==="change:"+d.idAttribute){delete this._byId[d.previous(d.idAttribute)];this._byId[d.id]=d}this.trigger.apply(this,arguments)}});var W=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];a.each(W,function(c){b.prototype[c]=function(){return a[c].apply(a,[this.models].concat(a.toArray(arguments)))}});var Z=C.Router=function(c){c||(c={});if(c.routes){this.routes=c.routes}this._bindRoutes();this.initialize.apply(this,arguments)};var I=/:\w+/g;var X=/\*\w+/g;var E=/[-[\]{}()+?.,\\^$|#\s]/g;a.extend(Z.prototype,N,{initialize:function(){},route:function(c,d,e){C.history||(C.history=new B);if(!a.isRegExp(c)){c=this._routeToRegExp(c)}if(!e){e=this[d]}C.history.route(c,a.bind(function(g){var f=this._extractParameters(c,g);e&&e.apply(this,f);this.trigger.apply(this,["route:"+d].concat(f));C.history.trigger("route",this,d,f)},this));return this},navigate:function(d,c){C.history.navigate(d,c)},_bindRoutes:function(){if(!this.routes){return }var d=[];for(var e in this.routes){d.unshift([e,this.routes[e]])}for(var f=0,c=d.length;f<c;f++){this.route(d[f][0],d[f][1],this[d[f][1]])}},_routeToRegExp:function(c){c=c.replace(E,"\\$&").replace(I,"([^/]+)").replace(X,"(.*?)");return new RegExp("^"+c+"$")},_extractParameters:function(c,d){return c.exec(d).slice(1)}});var B=C.History=function(){this.handlers=[];a.bindAll(this,"checkUrl")};var M=/^[#\/]/;var J=/msie [\w.]+/;B.started=false;a.extend(B.prototype,N,{interval:50,getHash:function(e){var d=e?e.location:window.location;var c=d.href.match(/#(.*)$/);return c?c[1]:""},getFragment:function(d,c){if(d==null){if(this._hasPushState||c){d=window.location.pathname;var e=window.location.search;if(e){d+=e}}else{d=this.getHash()}}if(!d.indexOf(this.options.root)){d=d.substr(this.options.root.length)}return d.replace(M,"")},start:function(e){if(B.started){throw new Error("Backbone.history has already been started")}B.started=true;this.options=a.extend({},{root:"/"},this.options,e);this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var d=this.getFragment();var c=document.documentMode;var g=(J.exec(navigator.userAgent.toLowerCase())&&(!c||c<=7));if(g){this.iframe=G('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(d)}if(this._hasPushState){G(window).bind("popstate",this.checkUrl)}else{if(this._wantsHashChange&&("onhashchange" in window)&&!g){G(window).bind("hashchange",this.checkUrl)}else{if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}}}this.fragment=d;var h=window.location;var f=h.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!f){this.fragment=this.getFragment(null,true);window.location.replace(this.options.root+"#"+this.fragment);return true}else{if(this._wantsPushState&&this._hasPushState&&f&&h.hash){this.fragment=this.getHash().replace(M,"");window.history.replaceState({},document.title,h.protocol+"//"+h.host+this.options.root+this.fragment)}}if(!this.options.silent){return this.loadUrl()}},stop:function(){G(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);B.started=false},route:function(c,d){this.handlers.unshift({route:c,callback:d})},checkUrl:function(d){var c=this.getFragment();if(c==this.fragment&&this.iframe){c=this.getFragment(this.getHash(this.iframe))}if(c==this.fragment){return false}if(this.iframe){this.navigate(c)}this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var d=this.fragment=this.getFragment(e);var c=a.any(this.handlers,function(f){if(f.route.test(d)){f.callback(d);return true}});return c},navigate:function(d,c){if(!B.started){return false}if(!c||c===true){c={trigger:c}}var e=(d||"").replace(M,"");if(this.fragment==e){return }if(this._hasPushState){if(e.indexOf(this.options.root)!=0){e=this.options.root+e}this.fragment=e;window.history[c.replace?"replaceState":"pushState"]({},document.title,e)}else{if(this._wantsHashChange){this.fragment=e;this._updateHash(window.location,e,c.replace);if(this.iframe&&(e!=this.getFragment(this.getHash(this.iframe)))){if(!c.replace){this.iframe.document.open().close()}this._updateHash(this.iframe.location,e,c.replace)}}else{window.location.assign(this.options.root+d)}}if(c.trigger){this.loadUrl(d)}},_updateHash:function(c,d,e){if(e){c.replace(c.toString().replace(/(javascript:|#).*$/,"")+"#"+d)}else{c.hash=d}}});var S=C.View=function(c){this.cid=a.uniqueId("view");this._configure(c||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var F=/^(\S+)\s*(.*)$/;var U=["model","collection","el","id","attributes","className","tagName"];a.extend(S.prototype,N,{tagName:"div",$:function(c){return this.$el.find(c)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();return this},make:function(d,c,f){var e=document.createElement(d);if(c){G(e).attr(c)}if(f){G(e).html(f)}return e},setElement:function(c,d){if(this.$el){this.undelegateEvents()}this.$el=(c instanceof G)?c:G(c);this.el=this.$el[0];if(d!==false){this.delegateEvents()}return this},delegateEvents:function(g){if(!(g||(g=D(this,"events")))){return }this.undelegateEvents();for(var f in g){var h=g[f];if(!a.isFunction(h)){h=this[g[f]]}if(!h){throw new Error('Method "'+g[f]+'" does not exist')}var e=f.match(F);var d=e[1],c=e[2];h=a.bind(h,this);d+=".delegateEvents"+this.cid;if(c===""){this.$el.bind(d,h)}else{this.$el.delegate(c,d,h)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(e){if(this.options){e=a.extend({},this.options,e)}for(var f=0,d=U.length;f<d;f++){var c=U[f];if(e[c]){this[c]=e[c]}}this.options=e},_ensureElement:function(){if(!this.el){var c=D(this,"attributes")||{};if(this.id){c.id=this.id}if(this.className){c["class"]=this.className}this.setElement(this.make(this.tagName,c),false)}else{this.setElement(this.el,false)}}});var V=function(c,d){var e=L(this,c,d);e.extend=this.extend;return e};K.extend=b.extend=Z.extend=S.extend=V;var R={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};C.sync=function(g,d,c){var e=R[g];c||(c={});var f={type:e,dataType:"json"};if(!c.url){f.url=D(d,"url")||T()}if(!c.data&&d&&(g=="create"||g=="update")){f.contentType="application/json";f.data=JSON.stringify(d.toJSON())}if(C.emulateJSON){f.contentType="application/x-www-form-urlencoded";f.data=f.data?{model:f.data}:{}}if(C.emulateHTTP){if(e==="PUT"||e==="DELETE"){if(C.emulateJSON){f.data._method=e}f.type="POST";f.beforeSend=function(h){h.setRequestHeader("X-HTTP-Method-Override",e)}}}if(f.type!=="GET"&&!C.emulateJSON){f.processData=false}return G.ajax(a.extend(f,c))};C.wrapError=function(d,e,c){return function(f,g){g=f===e?g:f;if(d){d(e,g,c)}else{e.trigger("error",e,g,c)}}};var H=function(){};var L=function(d,c,e){var f;if(c&&c.hasOwnProperty("constructor")){f=c.constructor}else{f=function(){d.apply(this,arguments)}}a.extend(f,d);H.prototype=d.prototype;f.prototype=new H();if(c){a.extend(f.prototype,c)}if(e){a.extend(f,e)}f.prototype.constructor=f;f.__super__=d.prototype;return f};var D=function(c,d){if(!(c&&c[d])){return null}return a.isFunction(c[d])?c[d]():c[d]};var T=function(){throw new Error('A "url" property or function must be specified')}}).call(this);
/* module-key = 'com.atlassian.soy.soy-template-plugin:soy-deps', location = 'js/soyutils.js' */
/*
 * Copyright 2008 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var goog=goog||{};
goog.inherits=function(B,A){function C(){}C.prototype=A.prototype;
B.superClass_=A.prototype;
B.prototype=new C();
B.prototype.constructor=B
};
if(!goog.userAgent){goog.userAgent=(function(){var B="";
if("undefined"!==typeof navigator&&navigator&&"string"==typeof navigator.userAgent){B=navigator.userAgent
}var A=B.indexOf("Opera")==0;
return{HAS_JSCRIPT:typeof "ScriptEngine" in this,IS_OPERA:A,IS_IE:!A&&B.indexOf("MSIE")!=-1,IS_WEBKIT:!A&&B.indexOf("WebKit")!=-1}
})()
}if(!goog.asserts){goog.asserts={fail:function(A){}}
}if(!goog.dom){goog.dom={};
goog.dom.DomHelper=function(A){this.document_=A||document
};
goog.dom.DomHelper.prototype.getDocument=function(){return this.document_
};
goog.dom.DomHelper.prototype.createElement=function(A){return this.document_.createElement(A)
};
goog.dom.DomHelper.prototype.createDocumentFragment=function(){return this.document_.createDocumentFragment()
}
}if(!goog.format){goog.format={insertWordBreaks:function(I,A){I=String(I);
var F=[];
var H=0;
var B=false;
var J=false;
var G=0;
var D=0;
for(var E=0,C=I.length;
E<C;
++E){var K=I.charCodeAt(E);
if(G>=A&&K!=32){F[H++]=I.substring(D,E);
D=E;
F[H++]=goog.format.WORD_BREAK;
G=0
}if(B){if(K==62){B=false
}}else{if(J){switch(K){case 59:J=false;
++G;
break;
case 60:J=false;
B=true;
break;
case 32:J=false;
G=0;
break
}}else{switch(K){case 60:B=true;
break;
case 38:J=true;
break;
case 32:G=0;
break;
default:++G;
break
}}}}F[H++]=I.substring(D);
return F.join("")
},WORD_BREAK:goog.userAgent.IS_WEBKIT?"<wbr></wbr>":goog.userAgent.IS_OPERA?"&shy;":"<wbr>"}
}if(!goog.i18n){goog.i18n={bidi:{detectRtlDirectionality:function(B,A){B=soyshim.$$bidiStripHtmlIfNecessary_(B,A);
return soyshim.$$bidiRtlWordRatio_(B)>soyshim.$$bidiRtlDetectionThreshold_
}}}
}goog.i18n.bidi.Dir={RTL:-1,UNKNOWN:0,LTR:1};
goog.i18n.bidi.toDir=function(A){if(typeof A=="number"){return A>0?goog.i18n.bidi.Dir.LTR:A<0?goog.i18n.bidi.Dir.RTL:goog.i18n.bidi.Dir.UNKNOWN
}else{return A?goog.i18n.bidi.Dir.RTL:goog.i18n.bidi.Dir.LTR
}};
goog.i18n.BidiFormatter=function(A){this.dir_=goog.i18n.bidi.toDir(A)
};
goog.i18n.BidiFormatter.prototype.dirAttr=function(C,A){var B=soy.$$bidiTextDir(C,A);
return B&&B!=this.dir_?B<0?"dir=rtl":"dir=ltr":""
};
goog.i18n.BidiFormatter.prototype.endEdge=function(){return this.dir_<0?"left":"right"
};
goog.i18n.BidiFormatter.prototype.mark=function(){return((this.dir_>0)?"\u200E":(this.dir_<0)?"\u200F":"")
};
goog.i18n.BidiFormatter.prototype.markAfter=function(C,A){var B=soy.$$bidiTextDir(C,A);
return soyshim.$$bidiMarkAfterKnownDir_(this.dir_,B,C,A)
};
goog.i18n.BidiFormatter.prototype.spanWrap=function(D,C){D=String(D);
var B=soy.$$bidiTextDir(D,true);
var A=soyshim.$$bidiMarkAfterKnownDir_(this.dir_,B,D,true);
if(B>0&&this.dir_<=0){D="<span dir=ltr>"+D+"</span>"
}else{if(B<0&&this.dir_>=0){D="<span dir=rtl>"+D+"</span>"
}}return D+A
};
goog.i18n.BidiFormatter.prototype.startEdge=function(){return this.dir_<0?"right":"left"
};
goog.i18n.BidiFormatter.prototype.unicodeWrap=function(D,C){D=String(D);
var B=soy.$$bidiTextDir(D,true);
var A=soyshim.$$bidiMarkAfterKnownDir_(this.dir_,B,D,true);
if(B>0&&this.dir_<=0){D="\u202A"+D+"\u202C"
}else{if(B<0&&this.dir_>=0){D="\u202B"+D+"\u202C"
}}return D+A
};
goog.string={newLineToBr:function(B,A){B=String(B);
if(!goog.string.NEWLINE_TO_BR_RE_.test(B)){return B
}return B.replace(/(\r\n|\r|\n)/g,A?"<br />":"<br>")
},urlEncode:encodeURIComponent,NEWLINE_TO_BR_RE_:/[\r\n]/};
goog.string.StringBuffer=function(A,B){this.buffer_=goog.userAgent.HAS_JSCRIPT?[]:"";
if(A!=null){this.append.apply(this,arguments)
}};
goog.string.StringBuffer.prototype.bufferLength_=0;
goog.string.StringBuffer.prototype.append=function(C,B,E){if(goog.userAgent.HAS_JSCRIPT){if(B==null){this.buffer_[this.bufferLength_++]=C
}else{var A=this.buffer_;
A.push.apply(A,arguments);
this.bufferLength_=this.buffer_.length
}}else{this.buffer_+=C;
if(B!=null){for(var D=1;
D<arguments.length;
D++){this.buffer_+=arguments[D]
}}}return this
};
goog.string.StringBuffer.prototype.clear=function(){if(goog.userAgent.HAS_JSCRIPT){this.buffer_.length=0;
this.bufferLength_=0
}else{this.buffer_=""
}};
goog.string.StringBuffer.prototype.toString=function(){if(goog.userAgent.HAS_JSCRIPT){var A=this.buffer_.join("");
this.clear();
if(A){this.append(A)
}return A
}else{return(this.buffer_)
}};
if(!goog.soy){goog.soy={renderAsElement:function(C,A,B,D){return(soyshim.$$renderWithWrapper_(C,A,D,true,B))
},renderAsFragment:function(C,A,B,D){return soyshim.$$renderWithWrapper_(C,A,D,false,B)
},renderElement:function(C,D,A,B){C.innerHTML=D(A,null,B)
}}
}var soy={esc:{}};
var soydata={};
var soyshim={$$DEFAULT_TEMPLATE_DATA_:{}};
soyshim.$$renderWithWrapper_=function(H,F,B,C,I){var D=B||document;
var A=D.createElement("div");
A.innerHTML=H(F||soyshim.$$DEFAULT_TEMPLATE_DATA_,undefined,I);
if(A.childNodes.length==1){var G=A.firstChild;
if(!C||G.nodeType==1){return(G)
}}if(C){return A
}var E=D.createDocumentFragment();
while(A.firstChild){E.appendChild(A.firstChild)
}return E
};
soyshim.$$bidiMarkAfterKnownDir_=function(C,B,D,A){return(C>0&&(B<0||soyshim.$$bidiIsRtlExitText_(D,A))?"\u200E":C<0&&(B>0||soyshim.$$bidiIsLtrExitText_(D,A))?"\u200F":"")
};
soyshim.$$bidiStripHtmlIfNecessary_=function(B,A){return A?B.replace(soyshim.$$BIDI_HTML_SKIP_RE_," "):B
};
soyshim.$$BIDI_HTML_SKIP_RE_=/<[^>]*>|&[^;]+;/g;
soyshim.$$bidiLtrChars_="A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02B8\u0300-\u0590\u0800-\u1FFF\u2C00-\uFB1C\uFDFE-\uFE6F\uFEFD-\uFFFF";
soyshim.$$bidiNeutralChars_="\u0000-\u0020!-@[-`{-\u00BF\u00D7\u00F7\u02B9-\u02FF\u2000-\u2BFF";
soyshim.$$bidiRtlChars_="\u0591-\u07FF\uFB1D-\uFDFD\uFE70-\uFEFC";
soyshim.$$bidiRtlDirCheckRe_=new RegExp("^[^"+soyshim.$$bidiLtrChars_+"]*["+soyshim.$$bidiRtlChars_+"]");
soyshim.$$bidiNeutralDirCheckRe_=new RegExp("^["+soyshim.$$bidiNeutralChars_+"]*$|^http://");
soyshim.$$bidiIsRtlText_=function(A){return soyshim.$$bidiRtlDirCheckRe_.test(A)
};
soyshim.$$bidiIsNeutralText_=function(A){return soyshim.$$bidiNeutralDirCheckRe_.test(A)
};
soyshim.$$bidiRtlDetectionThreshold_=0.4;
soyshim.$$bidiRtlWordRatio_=function(E){var B=0;
var A=0;
var D=E.split(" ");
for(var C=0;
C<D.length;
C++){if(soyshim.$$bidiIsRtlText_(D[C])){B++;
A++
}else{if(!soyshim.$$bidiIsNeutralText_(D[C])){A++
}}}return A==0?0:B/A
};
soyshim.$$bidiLtrExitDirCheckRe_=new RegExp("["+soyshim.$$bidiLtrChars_+"][^"+soyshim.$$bidiRtlChars_+"]*$");
soyshim.$$bidiRtlExitDirCheckRe_=new RegExp("["+soyshim.$$bidiRtlChars_+"][^"+soyshim.$$bidiLtrChars_+"]*$");
soyshim.$$bidiIsLtrExitText_=function(B,A){B=soyshim.$$bidiStripHtmlIfNecessary_(B,A);
return soyshim.$$bidiLtrExitDirCheckRe_.test(B)
};
soyshim.$$bidiIsRtlExitText_=function(B,A){B=soyshim.$$bidiStripHtmlIfNecessary_(B,A);
return soyshim.$$bidiRtlExitDirCheckRe_.test(B)
};
soy.StringBuilder=goog.string.StringBuffer;
soydata.SanitizedContentKind={HTML:0,JS_STR_CHARS:1,URI:2,HTML_ATTRIBUTE:3};
soydata.SanitizedContent=function(A){this.content=A
};
soydata.SanitizedContent.prototype.contentKind;
soydata.SanitizedContent.prototype.toString=function(){return this.content
};
soydata.SanitizedHtml=function(A){soydata.SanitizedContent.call(this,A)
};
goog.inherits(soydata.SanitizedHtml,soydata.SanitizedContent);
soydata.SanitizedHtml.prototype.contentKind=soydata.SanitizedContentKind.HTML;
soydata.SanitizedJsStrChars=function(A){soydata.SanitizedContent.call(this,A)
};
goog.inherits(soydata.SanitizedJsStrChars,soydata.SanitizedContent);
soydata.SanitizedJsStrChars.prototype.contentKind=soydata.SanitizedContentKind.JS_STR_CHARS;
soydata.SanitizedUri=function(A){soydata.SanitizedContent.call(this,A)
};
goog.inherits(soydata.SanitizedUri,soydata.SanitizedContent);
soydata.SanitizedUri.prototype.contentKind=soydata.SanitizedContentKind.URI;
soydata.SanitizedHtmlAttribute=function(A){soydata.SanitizedContent.call(this,A)
};
goog.inherits(soydata.SanitizedHtmlAttribute,soydata.SanitizedContent);
soydata.SanitizedHtmlAttribute.prototype.contentKind=soydata.SanitizedContentKind.HTML_ATTRIBUTE;
soy.renderElement=goog.soy.renderElement;
soy.renderAsFragment=function(D,B,A,C){return goog.soy.renderAsFragment(D,B,C,new goog.dom.DomHelper(A))
};
soy.renderAsElement=function(D,B,A,C){return goog.soy.renderAsElement(D,B,C,new goog.dom.DomHelper(A))
};
soy.$$augmentData=function(D,A){function E(){}E.prototype=D;
var C=new E();
for(var B in A){C[B]=A[B]
}return C
};
soy.$$getMapKeys=function(C){var B=[];
for(var A in C){B.push(A)
}return B
};
soy.$$getDelegateId=function(A){return A
};
soy.$$DELEGATE_REGISTRY_PRIORITIES_={};
soy.$$DELEGATE_REGISTRY_FUNCTIONS_={};
soy.$$registerDelegateFn=function(E,C,B){var D="key_"+E;
var A=soy.$$DELEGATE_REGISTRY_PRIORITIES_[D];
if(A===undefined||C>A){soy.$$DELEGATE_REGISTRY_PRIORITIES_[D]=C;
soy.$$DELEGATE_REGISTRY_FUNCTIONS_[D]=B
}else{if(C==A){throw Error('Encountered two active delegates with same priority (id/name "'+E+'").')
}else{}}};
soy.$$getDelegateFn=function(B){var A=soy.$$DELEGATE_REGISTRY_FUNCTIONS_["key_"+B];
return A?A:soy.$$EMPTY_TEMPLATE_FN_
};
soy.$$EMPTY_TEMPLATE_FN_=function(A,C,B){return""
};
soy.$$escapeHtml=function(A){if(typeof A==="object"&&A&&A.contentKind===soydata.SanitizedContentKind.HTML){return A.content
}return soy.esc.$$escapeHtmlHelper(A)
};
soy.$$escapeHtmlRcdata=function(A){if(typeof A==="object"&&A&&A.contentKind===soydata.SanitizedContentKind.HTML){return soy.esc.$$normalizeHtmlHelper(A.content)
}return soy.esc.$$escapeHtmlHelper(A)
};
soy.$$stripHtmlTags=function(A){return String(A).replace(soy.esc.$$HTML_TAG_REGEX_,"")
};
soy.$$escapeHtmlAttribute=function(A){if(typeof A==="object"&&A&&A.contentKind===soydata.SanitizedContentKind.HTML){return soy.esc.$$normalizeHtmlHelper(soy.$$stripHtmlTags(A.content))
}return soy.esc.$$escapeHtmlHelper(A)
};
soy.$$escapeHtmlAttributeNospace=function(A){if(typeof A==="object"&&A&&A.contentKind===soydata.SanitizedContentKind.HTML){return soy.esc.$$normalizeHtmlNospaceHelper(soy.$$stripHtmlTags(A.content))
}return soy.esc.$$escapeHtmlNospaceHelper(A)
};
soy.$$filterHtmlAttribute=function(A){if(typeof A==="object"&&A&&A.contentKind===soydata.SanitizedContentKind.HTML_ATTRIBUTE){return A.content.replace(/=([^"']*)$/,'="$1"')
}return soy.esc.$$filterHtmlAttributeHelper(A)
};
soy.$$filterHtmlElementName=function(A){return soy.esc.$$filterHtmlElementNameHelper(A)
};
soy.$$escapeJs=function(A){return soy.$$escapeJsString(A)
};
soy.$$escapeJsString=function(A){if(typeof A==="object"&&A.contentKind===soydata.SanitizedContentKind.JS_STR_CHARS){return A.content
}return soy.esc.$$escapeJsStringHelper(A)
};
soy.$$escapeJsValue=function(A){if(A==null){return" null "
}switch(typeof A){case"boolean":case"number":return" "+A+" ";
default:return"'"+soy.esc.$$escapeJsStringHelper(String(A))+"'"
}};
soy.$$escapeJsRegex=function(A){return soy.esc.$$escapeJsRegexHelper(A)
};
soy.$$problematicUriMarks_=/['()]/g;
soy.$$pctEncode_=function(A){return"%"+A.charCodeAt(0).toString(16)
};
soy.$$escapeUri=function(A){if(typeof A==="object"&&A.contentKind===soydata.SanitizedContentKind.URI){return soy.$$normalizeUri(A)
}var B=soy.esc.$$escapeUriHelper(A);
soy.$$problematicUriMarks_.lastIndex=0;
if(soy.$$problematicUriMarks_.test(B)){return B.replace(soy.$$problematicUriMarks_,soy.$$pctEncode_)
}return B
};
soy.$$normalizeUri=function(A){return soy.esc.$$normalizeUriHelper(A)
};
soy.$$filterNormalizeUri=function(A){return soy.esc.$$filterNormalizeUriHelper(A)
};
soy.$$escapeCssString=function(A){return soy.esc.$$escapeCssStringHelper(A)
};
soy.$$filterCssValue=function(A){if(A==null){return""
}return soy.esc.$$filterCssValueHelper(A)
};
soy.$$changeNewlineToBr=function(A){return goog.string.newLineToBr(String(A),false)
};
soy.$$insertWordBreaks=function(B,A){return goog.format.insertWordBreaks(String(B),A)
};
soy.$$truncate=function(C,A,B){C=String(C);
if(C.length<=A){return C
}if(B){if(A>3){A-=3
}else{B=false
}}if(soy.$$isHighSurrogate_(C.charAt(A-1))&&soy.$$isLowSurrogate_(C.charAt(A))){A-=1
}C=C.substring(0,A);
if(B){C+="..."
}return C
};
soy.$$isHighSurrogate_=function(A){return 55296<=A&&A<=56319
};
soy.$$isLowSurrogate_=function(A){return 56320<=A&&A<=57343
};
soy.$$bidiFormatterCache_={};
soy.$$getBidiFormatterInstance_=function(A){return soy.$$bidiFormatterCache_[A]||(soy.$$bidiFormatterCache_[A]=new goog.i18n.BidiFormatter(A))
};
soy.$$bidiTextDir=function(B,A){if(!B){return 0
}return goog.i18n.bidi.detectRtlDirectionality(B,A)?-1:1
};
soy.$$bidiDirAttr=function(B,C,A){return new soydata.SanitizedHtmlAttribute(soy.$$getBidiFormatterInstance_(B).dirAttr(C,A))
};
soy.$$bidiMarkAfter=function(B,D,A){var C=soy.$$getBidiFormatterInstance_(B);
return C.markAfter(D,A)
};
soy.$$bidiSpanWrap=function(A,C){var B=soy.$$getBidiFormatterInstance_(A);
return B.spanWrap(C+"",true)
};
soy.$$bidiUnicodeWrap=function(A,C){var B=soy.$$getBidiFormatterInstance_(A);
return B.unicodeWrap(C+"",true)
};
soy.esc.$$escapeUriHelper=function(A){return encodeURIComponent(String(A))
};
soy.esc.$$ESCAPE_MAP_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_={"\x00":"\x26#0;","\x22":"\x26quot;","\x26":"\x26amp;","\x27":"\x26#39;","\x3c":"\x26lt;","\x3e":"\x26gt;","\x09":"\x26#9;","\x0a":"\x26#10;","\x0b":"\x26#11;","\x0c":"\x26#12;","\x0d":"\x26#13;"," ":"\x26#32;","-":"\x26#45;","/":"\x26#47;","\x3d":"\x26#61;","`":"\x26#96;","\x85":"\x26#133;","\xa0":"\x26#160;","\u2028":"\x26#8232;","\u2029":"\x26#8233;"};
soy.esc.$$REPLACER_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_=function(A){return soy.esc.$$ESCAPE_MAP_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_[A]
};
soy.esc.$$ESCAPE_MAP_FOR_ESCAPE_JS_STRING__AND__ESCAPE_JS_REGEX_={"\x00":"\\x00","\x08":"\\x08","\x09":"\\t","\x0a":"\\n","\x0b":"\\x0b","\x0c":"\\f","\x0d":"\\r","\x22":"\\x22","\x26":"\\x26","\x27":"\\x27","/":"\\/","\x3c":"\\x3c","\x3d":"\\x3d","\x3e":"\\x3e","\\":"\\\\","\x85":"\\x85","\u2028":"\\u2028","\u2029":"\\u2029","$":"\\x24","(":"\\x28",")":"\\x29","*":"\\x2a","+":"\\x2b",",":"\\x2c","-":"\\x2d",".":"\\x2e",":":"\\x3a","?":"\\x3f","[":"\\x5b","]":"\\x5d","^":"\\x5e","{":"\\x7b","|":"\\x7c","}":"\\x7d"};
soy.esc.$$REPLACER_FOR_ESCAPE_JS_STRING__AND__ESCAPE_JS_REGEX_=function(A){return soy.esc.$$ESCAPE_MAP_FOR_ESCAPE_JS_STRING__AND__ESCAPE_JS_REGEX_[A]
};
soy.esc.$$ESCAPE_MAP_FOR_ESCAPE_CSS_STRING_={"\x00":"\\0 ","\x08":"\\8 ","\x09":"\\9 ","\x0a":"\\a ","\x0b":"\\b ","\x0c":"\\c ","\x0d":"\\d ","\x22":"\\22 ","\x26":"\\26 ","\x27":"\\27 ","(":"\\28 ",")":"\\29 ","*":"\\2a ","/":"\\2f ",":":"\\3a ",";":"\\3b ","\x3c":"\\3c ","\x3d":"\\3d ","\x3e":"\\3e ","@":"\\40 ","\\":"\\5c ","{":"\\7b ","}":"\\7d ","\x85":"\\85 ","\xa0":"\\a0 ","\u2028":"\\2028 ","\u2029":"\\2029 "};
soy.esc.$$REPLACER_FOR_ESCAPE_CSS_STRING_=function(A){return soy.esc.$$ESCAPE_MAP_FOR_ESCAPE_CSS_STRING_[A]
};
soy.esc.$$ESCAPE_MAP_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_={"\x00":"%00","\x01":"%01","\x02":"%02","\x03":"%03","\x04":"%04","\x05":"%05","\x06":"%06","\x07":"%07","\x08":"%08","\x09":"%09","\x0a":"%0A","\x0b":"%0B","\x0c":"%0C","\x0d":"%0D","\x0e":"%0E","\x0f":"%0F","\x10":"%10","\x11":"%11","\x12":"%12","\x13":"%13","\x14":"%14","\x15":"%15","\x16":"%16","\x17":"%17","\x18":"%18","\x19":"%19","\x1a":"%1A","\x1b":"%1B","\x1c":"%1C","\x1d":"%1D","\x1e":"%1E","\x1f":"%1F"," ":"%20","\x22":"%22","\x27":"%27","(":"%28",")":"%29","\x3c":"%3C","\x3e":"%3E","\\":"%5C","{":"%7B","}":"%7D","\x7f":"%7F","\x85":"%C2%85","\xa0":"%C2%A0","\u2028":"%E2%80%A8","\u2029":"%E2%80%A9","\uff01":"%EF%BC%81","\uff03":"%EF%BC%83","\uff04":"%EF%BC%84","\uff06":"%EF%BC%86","\uff07":"%EF%BC%87","\uff08":"%EF%BC%88","\uff09":"%EF%BC%89","\uff0a":"%EF%BC%8A","\uff0b":"%EF%BC%8B","\uff0c":"%EF%BC%8C","\uff0f":"%EF%BC%8F","\uff1a":"%EF%BC%9A","\uff1b":"%EF%BC%9B","\uff1d":"%EF%BC%9D","\uff1f":"%EF%BC%9F","\uff20":"%EF%BC%A0","\uff3b":"%EF%BC%BB","\uff3d":"%EF%BC%BD"};
soy.esc.$$REPLACER_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_=function(A){return soy.esc.$$ESCAPE_MAP_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_[A]
};
soy.esc.$$MATCHER_FOR_ESCAPE_HTML_=/[\x00\x22\x26\x27\x3c\x3e]/g;
soy.esc.$$MATCHER_FOR_NORMALIZE_HTML_=/[\x00\x22\x27\x3c\x3e]/g;
soy.esc.$$MATCHER_FOR_ESCAPE_HTML_NOSPACE_=/[\x00\x09-\x0d \x22\x26\x27\x2d\/\x3c-\x3e`\x85\xa0\u2028\u2029]/g;
soy.esc.$$MATCHER_FOR_NORMALIZE_HTML_NOSPACE_=/[\x00\x09-\x0d \x22\x27\x2d\/\x3c-\x3e`\x85\xa0\u2028\u2029]/g;
soy.esc.$$MATCHER_FOR_ESCAPE_JS_STRING_=/[\x00\x08-\x0d\x22\x26\x27\/\x3c-\x3e\\\x85\u2028\u2029]/g;
soy.esc.$$MATCHER_FOR_ESCAPE_JS_REGEX_=/[\x00\x08-\x0d\x22\x24\x26-\/\x3a\x3c-\x3f\x5b-\x5e\x7b-\x7d\x85\u2028\u2029]/g;
soy.esc.$$MATCHER_FOR_ESCAPE_CSS_STRING_=/[\x00\x08-\x0d\x22\x26-\x2a\/\x3a-\x3e@\\\x7b\x7d\x85\xa0\u2028\u2029]/g;
soy.esc.$$MATCHER_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_=/[\x00- \x22\x27-\x29\x3c\x3e\\\x7b\x7d\x7f\x85\xa0\u2028\u2029\uff01\uff03\uff04\uff06-\uff0c\uff0f\uff1a\uff1b\uff1d\uff1f\uff20\uff3b\uff3d]/g;
soy.esc.$$FILTER_FOR_FILTER_CSS_VALUE_=/^(?!-*(?:expression|(?:moz-)?binding))(?:[.#]?-?(?:[_a-z0-9-]+)(?:-[_a-z0-9-]+)*-?|-?(?:[0-9]+(?:\.[0-9]*)?|\.[0-9]+)(?:[a-z]{1,2}|%)?|!important|)$/i;
soy.esc.$$FILTER_FOR_FILTER_NORMALIZE_URI_=/^(?:(?:https?|mailto):|[^&:\/?#]*(?:[\/?#]|$))/i;
soy.esc.$$FILTER_FOR_FILTER_HTML_ATTRIBUTE_=/^(?!style|on|action|archive|background|cite|classid|codebase|data|dsync|href|longdesc|src|usemap)(?:[a-z0-9_$:-]*)$/i;
soy.esc.$$FILTER_FOR_FILTER_HTML_ELEMENT_NAME_=/^(?!script|style|title|textarea|xmp|no)[a-z0-9_$:-]*$/i;
soy.esc.$$escapeHtmlHelper=function(A){var B=String(A);
return B.replace(soy.esc.$$MATCHER_FOR_ESCAPE_HTML_,soy.esc.$$REPLACER_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_)
};
soy.esc.$$normalizeHtmlHelper=function(A){var B=String(A);
return B.replace(soy.esc.$$MATCHER_FOR_NORMALIZE_HTML_,soy.esc.$$REPLACER_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_)
};
soy.esc.$$escapeHtmlNospaceHelper=function(A){var B=String(A);
return B.replace(soy.esc.$$MATCHER_FOR_ESCAPE_HTML_NOSPACE_,soy.esc.$$REPLACER_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_)
};
soy.esc.$$normalizeHtmlNospaceHelper=function(A){var B=String(A);
return B.replace(soy.esc.$$MATCHER_FOR_NORMALIZE_HTML_NOSPACE_,soy.esc.$$REPLACER_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_)
};
soy.esc.$$escapeJsStringHelper=function(A){var B=String(A);
return B.replace(soy.esc.$$MATCHER_FOR_ESCAPE_JS_STRING_,soy.esc.$$REPLACER_FOR_ESCAPE_JS_STRING__AND__ESCAPE_JS_REGEX_)
};
soy.esc.$$escapeJsRegexHelper=function(A){var B=String(A);
return B.replace(soy.esc.$$MATCHER_FOR_ESCAPE_JS_REGEX_,soy.esc.$$REPLACER_FOR_ESCAPE_JS_STRING__AND__ESCAPE_JS_REGEX_)
};
soy.esc.$$escapeCssStringHelper=function(A){var B=String(A);
return B.replace(soy.esc.$$MATCHER_FOR_ESCAPE_CSS_STRING_,soy.esc.$$REPLACER_FOR_ESCAPE_CSS_STRING_)
};
soy.esc.$$filterCssValueHelper=function(A){var B=String(A);
if(!soy.esc.$$FILTER_FOR_FILTER_CSS_VALUE_.test(B)){return"zSoyz"
}return B
};
soy.esc.$$normalizeUriHelper=function(A){var B=String(A);
return B.replace(soy.esc.$$MATCHER_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_,soy.esc.$$REPLACER_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_)
};
soy.esc.$$filterNormalizeUriHelper=function(A){var B=String(A);
if(!soy.esc.$$FILTER_FOR_FILTER_NORMALIZE_URI_.test(B)){return"zSoyz"
}return B.replace(soy.esc.$$MATCHER_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_,soy.esc.$$REPLACER_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_)
};
soy.esc.$$filterHtmlAttributeHelper=function(A){var B=String(A);
if(!soy.esc.$$FILTER_FOR_FILTER_HTML_ATTRIBUTE_.test(B)){return"zSoyz"
}return B
};
soy.esc.$$filterHtmlElementNameHelper=function(A){var B=String(A);
if(!soy.esc.$$FILTER_FOR_FILTER_HTML_ELEMENT_NAME_.test(B)){return"zSoyz"
}return B
};
soy.esc.$$HTML_TAG_REGEX_=/<(?:!|\/?[a-zA-Z])(?:[^>'"]|"[^"]*"|'[^']*')*>/g;
/* module-key = 'com.atlassian.soy.soy-template-plugin:soy-deps', location = 'js/atlassian-deps.js' */
window.atl_soy=window.atl_soy||{};
atl_soy.concat=function(B,A){if(B.concat){return B.concat(A)
}var C={};
for(var D in B){if(B.hasOwnProperty(D)){C[D]=B[D]
}}for(var D in A){if(A.hasOwnProperty(D)){C[D]=A[D]
}}return C
};
/* module-key = 'jira.webresources:util', location = '/includes/jira/common/observer.js' */
(function($){JIRA.Events=JIRA.Events||{};JIRA.CONTENT_ADDED_REASON={pageLoad:"pageLoad",inlineEditStarted:"inlineEditStarted",panelRefreshed:"panelRefreshed",criteriaPanelRefreshed:"criteriaPanelRefreshed",issueTableRefreshed:"issueTableRefreshed",issueTableRowRefreshed:"issueTableRowRefreshed",filterPanelOpened:"filterPanelOpened",layoutSwitcherReady:"layoutSwitcherReady",returnToSearch:"returnToSearch",shareDialogOpened:"shareDialogOpened",filtersSearchRefreshed:"filtersSearchRefreshed",tabUpdated:"tabUpdated",dialogReady:"dialogReady",componentsTableReady:"componentsTableReady",workflowReady:"workflowReady",workflowHeaderReady:"workflowHeaderReady"};(function(){JIRA.Events.NEW_CONTENT_ADDED="newContentAdded";JIRA.Events.NEW_PAGE_ADDED="newPageAdded";$(function(){JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[$(document),JIRA.CONTENT_ADDED_REASON.pageLoad]);JIRA.trigger(JIRA.Events.NEW_PAGE_ADDED,[$(document)])});$(document).bind("dialogContentReady",function(e,dialog){JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[dialog.get$popupContent(),JIRA.CONTENT_ADDED_REASON.dialogReady]);JIRA.trigger(JIRA.Events.NEW_PAGE_ADDED,[dialog.get$popupContent()])});JIRA.bind("contentRefreshed",function(e,context){JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[$(context)])})})()})(AJS.$);
/* module-key = 'jira.webresources:util', location = '/includes/ajs/aui-experimental.js' */
AJS.asBooleanOrString=function(value){var lc=value?value.toLowerCase():"";if(lc=="true"){return true}if(lc=="false"){return false}return value};AJS.overrides={};AJS.Meta=jQuery.extend({},AJS.Meta,{set:function(key,value){AJS.overrides[key]=value},get:function(key){if(typeof AJS.overrides[key]!="undefined"){return AJS.overrides[key]}var metaEl=jQuery("meta[name='ajs-"+key+"']");if(!metaEl.length){return undefined}var value=metaEl.attr("content");return AJS.asBooleanOrString(value)},getBoolean:function(key){return this.get(key)===true},getNumber:function(key){return +this.get(key)},getAllAsMap:function(){var map={};jQuery("meta[name^=ajs-]").each(function(){map[this.name.substring(4)]=this.content});return jQuery.extend(map,AJS.overrides)}});
/* module-key = 'jira.webresources:util', location = '/includes/jquery/plugins/getdocheight/getDocHeight.js' */
jQuery.getDocHeight=function(){return Math.max(jQuery(document).height(),jQuery(window).height(),document.documentElement.clientHeight)};
/* module-key = 'jira.webresources:util', location = '/includes/jquery/plugins/os/os.js' */
jQuery.os={};if(navigator.platform.toLowerCase().indexOf("win")!=-1){jQuery.os.windows=true}if(navigator.platform.toLowerCase().indexOf("mac")!=-1){jQuery.os.mac=true}if(navigator.platform.toLowerCase().indexOf("linux")!=-1){jQuery.os.linux=true};
/* module-key = 'jira.webresources:util', location = '/includes/lib/json/JSONiefix.js' */
if(jQuery.browser.msie&&jQuery.browser.version>7&&typeof JSON!=="undefined"){JSON.stringify=null};
/* module-key = 'jira.webresources:util', location = '/includes/jira/common/version.js' */
JIRA.Version={};JIRA.Version.compare=function(str2){if(!AJS.params.JiraVersion){return }var parts1=AJS.params.JiraVersion.split(".");var parts2=str2.split(".");var len;var ret=-1;len=parts1.length;if(parts1.length>parts2.length){len=parts2.length;ret=1}else{if(parts1.length==parts2.length){ret=0}}for(var i=0;i<len;i++){var p1,p2;var m1,m2;var pat;var i1,i2;p1=parts1[i];p2=parts2[i];pat=/^(0+)(.*)$/;m1=p1.match(pat);if(m1!=null){p1="0."+p1;i1=parseFloat(p1)}else{i1=parseInt(p1,10)}m2=p2.match(pat);if(m2!=null){p2="0."+p2;i2=parseFloat(p2)}else{i2=parseInt(p2,10)}if(i1<i2){return -1}if(i1>i2){return 1}}return ret};JIRA.Version.isGreaterThanOrEqualTo=function(ver){return JIRA.Version.compare(ver)!==-1};
/* module-key = 'jira.webresources:util', location = '/includes/lib/json/JSON.js' */
if(!this.JSON){this.JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());
/* module-key = 'jira.webresources:util', location = '/includes/lib/parseuri/parseUri.js' */
function parseUri(str){var o=parseUri.options,m=o.parser[o.strictMode?"strict":"loose"].exec(str),uri={},i=14;while(i--){uri[o.key[i]]=m[i]||""}uri[o.q.name]={};uri[o.key[12]].replace(o.q.parser,function($0,$1,$2){if($1){uri[o.q.name][$1]=$2}});return uri}parseUri.options={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};
/* module-key = 'jira.webresources:util', location = '/includes/jquery/plugins/effects/effects.js' */
jQuery.effects||(function($){$.effects={};$.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","color","outlineColor"],function(i,attr){$.fx.step[attr]=function(fx){if(!fx.colorInit){fx.start=getColor(fx.elem,attr);fx.end=getRGB(fx.end);fx.colorInit=true}fx.elem.style[attr]="rgb("+Math.max(Math.min(parseInt((fx.pos*(fx.end[0]-fx.start[0]))+fx.start[0],10),255),0)+","+Math.max(Math.min(parseInt((fx.pos*(fx.end[1]-fx.start[1]))+fx.start[1],10),255),0)+","+Math.max(Math.min(parseInt((fx.pos*(fx.end[2]-fx.start[2]))+fx.start[2],10),255),0)+")"}});function getRGB(color){var result;if(color&&color.constructor==Array&&color.length==3){return color}if(result=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(color)){return[parseInt(result[1],10),parseInt(result[2],10),parseInt(result[3],10)]}if(result=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(color)){return[parseFloat(result[1])*2.55,parseFloat(result[2])*2.55,parseFloat(result[3])*2.55]}if(result=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(color)){return[parseInt(result[1],16),parseInt(result[2],16),parseInt(result[3],16)]}if(result=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(color)){return[parseInt(result[1]+result[1],16),parseInt(result[2]+result[2],16),parseInt(result[3]+result[3],16)]}if(result=/rgba\(0, 0, 0, 0\)/.exec(color)){return colors["transparent"]}return colors[$.trim(color).toLowerCase()]}function getColor(elem,attr){var color;do{color=$.curCSS(elem,attr);if(color!=""&&color!="transparent"||$.nodeName(elem,"body")){break}attr="backgroundColor"}while(elem=elem.parentNode);return getRGB(color)}var colors={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]};var classAnimationActions=["add","remove","toggle"],shorthandStyles={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};function getElementStyles(){var style=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,newStyle={},key,camelCase;if(style&&style.length&&style[0]&&style[style[0]]){var len=style.length;while(len--){key=style[len];if(typeof style[key]=="string"){camelCase=key.replace(/\-(\w)/g,function(all,letter){return letter.toUpperCase()});newStyle[camelCase]=style[key]}}}else{for(key in style){if(typeof style[key]==="string"){newStyle[key]=style[key]}}}return newStyle}function filterStyles(styles){var name,value;for(name in styles){value=styles[name];if(value==null||$.isFunction(value)||name in shorthandStyles||(/scrollbar/).test(name)||(!(/color/i).test(name)&&isNaN(parseFloat(value)))){delete styles[name]}}return styles}function styleDifference(oldStyle,newStyle){var diff={_:0},name;for(name in newStyle){if(oldStyle[name]!=newStyle[name]){diff[name]=newStyle[name]}}return diff}$.effects.animateClass=function(value,duration,easing,callback){if($.isFunction(easing)){callback=easing;easing=null}return this.each(function(){var that=$(this),originalStyleAttr=that.attr("style")||" ",originalStyle=filterStyles(getElementStyles.call(this)),newStyle,className=that.prop("className");$.each(classAnimationActions,function(i,action){if(value[action]){that[action+"Class"](value[action])}});newStyle=filterStyles(getElementStyles.call(this));that.prop("className",className);that.animate(styleDifference(originalStyle,newStyle),duration,easing,function(){$.each(classAnimationActions,function(i,action){if(value[action]){that[action+"Class"](value[action])}});if(typeof that.attr("style")=="object"){that.attr("style").cssText="";that.attr("style").cssText=originalStyleAttr}else{that.attr("style",originalStyleAttr)}if(callback){callback.apply(this,arguments)}})})};$.fn.extend({_addClass:$.fn.addClass,addClass:function(classNames,speed,easing,callback){return speed?$.effects.animateClass.apply(this,[{add:classNames},speed,easing,callback]):this._addClass(classNames)},_removeClass:$.fn.removeClass,removeClass:function(classNames,speed,easing,callback){return speed?$.effects.animateClass.apply(this,[{remove:classNames},speed,easing,callback]):this._removeClass(classNames)},_toggleClass:$.fn.toggleClass,toggleClass:function(classNames,force,speed,easing,callback){if(typeof force=="boolean"||force===undefined){if(!speed){return this._toggleClass(classNames,force)}else{return $.effects.animateClass.apply(this,[(force?{add:classNames}:{remove:classNames}),speed,easing,callback])}}else{return $.effects.animateClass.apply(this,[{toggle:classNames},force,speed,easing])}},switchClass:function(remove,add,speed,easing,callback){return $.effects.animateClass.apply(this,[{add:add,remove:remove},speed,easing,callback])}});$.extend($.effects,{version:"1.8rc3",save:function(element,set){for(var i=0;i<set.length;i++){if(set[i]!==null){element.data("ec.storage."+set[i],element[0].style[set[i]])}}},restore:function(element,set){for(var i=0;i<set.length;i++){if(set[i]!==null){element.css(set[i],element.data("ec.storage."+set[i]))}}},setMode:function(el,mode){if(mode=="toggle"){mode=el.is(":hidden")?"show":"hide"}return mode},getBaseline:function(origin,original){var y,x;switch(origin[0]){case"top":y=0;break;case"middle":y=0.5;break;case"bottom":y=1;break;default:y=origin[0]/original.height}switch(origin[1]){case"left":x=0;break;case"center":x=0.5;break;case"right":x=1;break;default:x=origin[1]/original.width}return{x:x,y:y}},createWrapper:function(element){if(element.parent().is(".ui-effects-wrapper")){return element.parent()}var props={width:element.outerWidth(true),height:element.outerHeight(true),"float":element.css("float")},wrapper=$("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0});element.wrap(wrapper);wrapper=element.parent();if(element.css("position")=="static"){wrapper.css({position:"relative"});element.css({position:"relative"})}else{$.extend(props,{position:element.css("position"),zIndex:element.css("z-index")});$.each(["top","left","bottom","right"],function(i,pos){props[pos]=element.css(pos);if(isNaN(parseInt(props[pos],10))){props[pos]="auto"}});element.css({position:"relative",top:0,left:0})}return wrapper.css(props).show()},removeWrapper:function(element){if(element.parent().is(".ui-effects-wrapper")){return element.parent().replaceWith(element)}return element},setTransition:function(element,list,factor,value){value=value||{};$.each(list,function(i,x){unit=element.cssUnit(x);if(unit[0]>0){value[x]=unit[0]*factor+unit[1]}});return value}});function _normalizeArguments(effect,options,speed,callback){if(typeof effect=="object"){callback=options;speed=null;options=effect;effect=options.effect}if($.isFunction(options)){callback=options;speed=null;options={}}if(typeof options=="number"||$.fx.speeds[options]){callback=speed;speed=options;options={}}options=options||{};speed=speed||options.duration;speed=$.fx.off?0:typeof speed=="number"?speed:$.fx.speeds[speed]||$.fx.speeds._default;callback=callback||options.complete;return[effect,options,speed,callback]}$.fn.extend({effect:function(effect,options,speed,callback){var args=_normalizeArguments.apply(this,arguments),args2={options:args[1],duration:args[2],callback:args[3]},effectMethod=$.effects[effect];return effectMethod&&!$.fx.off?effectMethod.call(this,args2):this},_show:$.fn.show,show:function(speed){if(!speed||typeof speed=="number"||$.fx.speeds[speed]){return this._show.apply(this,arguments)}else{var args=_normalizeArguments.apply(this,arguments);args[1].mode="show";return this.effect.apply(this,args)}},_hide:$.fn.hide,hide:function(speed){if(!speed||typeof speed=="number"||$.fx.speeds[speed]){return this._hide.apply(this,arguments)}else{var args=_normalizeArguments.apply(this,arguments);args[1].mode="hide";return this.effect.apply(this,args)}},__toggle:$.fn.toggle,toggle:function(speed){if(!speed||typeof speed=="number"||$.fx.speeds[speed]||typeof speed=="boolean"||$.isFunction(speed)){return this.__toggle.apply(this,arguments)}else{var args=_normalizeArguments.apply(this,arguments);args[1].mode="toggle";return this.effect.apply(this,args)}},cssUnit:function(key){var style=this.css(key),val=[];$.each(["em","px","%","pt"],function(i,unit){if(style.indexOf(unit)>0){val=[parseFloat(style),unit]}});return val}});$.easing.jswing=$.easing.swing;$.extend($.easing,{def:"easeOutQuad",swing:function(x,t,b,c,d){return $.easing[$.easing.def](x,t,b,c,d)},easeInQuad:function(x,t,b,c,d){return c*(t/=d)*t+b},easeOutQuad:function(x,t,b,c,d){return -c*(t/=d)*(t-2)+b},easeInOutQuad:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t+b}return -c/2*((--t)*(t-2)-1)+b},easeInCubic:function(x,t,b,c,d){return c*(t/=d)*t*t+b},easeOutCubic:function(x,t,b,c,d){return c*((t=t/d-1)*t*t+1)+b},easeInOutCubic:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t*t+b}return c/2*((t-=2)*t*t+2)+b},easeInQuart:function(x,t,b,c,d){return c*(t/=d)*t*t*t+b},easeOutQuart:function(x,t,b,c,d){return -c*((t=t/d-1)*t*t*t-1)+b},easeInOutQuart:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t*t*t+b}return -c/2*((t-=2)*t*t*t-2)+b},easeInQuint:function(x,t,b,c,d){return c*(t/=d)*t*t*t*t+b},easeOutQuint:function(x,t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b},easeInOutQuint:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t*t*t*t+b}return c/2*((t-=2)*t*t*t*t+2)+b},easeInSine:function(x,t,b,c,d){return -c*Math.cos(t/d*(Math.PI/2))+c+b},easeOutSine:function(x,t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b},easeInOutSine:function(x,t,b,c,d){return -c/2*(Math.cos(Math.PI*t/d)-1)+b},easeInExpo:function(x,t,b,c,d){return(t==0)?b:c*Math.pow(2,10*(t/d-1))+b},easeOutExpo:function(x,t,b,c,d){return(t==d)?b+c:c*(-Math.pow(2,-10*t/d)+1)+b},easeInOutExpo:function(x,t,b,c,d){if(t==0){return b}if(t==d){return b+c}if((t/=d/2)<1){return c/2*Math.pow(2,10*(t-1))+b}return c/2*(-Math.pow(2,-10*--t)+2)+b},easeInCirc:function(x,t,b,c,d){return -c*(Math.sqrt(1-(t/=d)*t)-1)+b},easeOutCirc:function(x,t,b,c,d){return c*Math.sqrt(1-(t=t/d-1)*t)+b},easeInOutCirc:function(x,t,b,c,d){if((t/=d/2)<1){return -c/2*(Math.sqrt(1-t*t)-1)+b}return c/2*(Math.sqrt(1-(t-=2)*t)+1)+b},easeInElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0){return b}if((t/=d)==1){return b+c}if(!p){p=d*0.3}if(a<Math.abs(c)){a=c;var s=p/4}else{var s=p/(2*Math.PI)*Math.asin(c/a)}return -(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b},easeOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0){return b}if((t/=d)==1){return b+c}if(!p){p=d*0.3}if(a<Math.abs(c)){a=c;var s=p/4}else{var s=p/(2*Math.PI)*Math.asin(c/a)}return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b},easeInOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0){return b}if((t/=d/2)==2){return b+c}if(!p){p=d*(0.3*1.5)}if(a<Math.abs(c)){a=c;var s=p/4}else{var s=p/(2*Math.PI)*Math.asin(c/a)}if(t<1){return -0.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b}return a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*0.5+c+b},easeInBack:function(x,t,b,c,d,s){if(s==undefined){s=1.70158}return c*(t/=d)*t*((s+1)*t-s)+b},easeOutBack:function(x,t,b,c,d,s){if(s==undefined){s=1.70158}return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},easeInOutBack:function(x,t,b,c,d,s){if(s==undefined){s=1.70158}if((t/=d/2)<1){return c/2*(t*t*(((s*=(1.525))+1)*t-s))+b}return c/2*((t-=2)*t*(((s*=(1.525))+1)*t+s)+2)+b},easeInBounce:function(x,t,b,c,d){return c-$.easing.easeOutBounce(x,d-t,0,c,d)+b},easeOutBounce:function(x,t,b,c,d){if((t/=d)<(1/2.75)){return c*(7.5625*t*t)+b}else{if(t<(2/2.75)){return c*(7.5625*(t-=(1.5/2.75))*t+0.75)+b}else{if(t<(2.5/2.75)){return c*(7.5625*(t-=(2.25/2.75))*t+0.9375)+b}else{return c*(7.5625*(t-=(2.625/2.75))*t+0.984375)+b}}}},easeInOutBounce:function(x,t,b,c,d){if(t<d/2){return $.easing.easeInBounce(x,t*2,0,c,d)*0.5+b}return $.easing.easeOutBounce(x,t*2-d,0,c,d)*0.5+c*0.5+b}})})(jQuery);
/* module-key = 'jira.webresources:util', location = '/includes/jira/data/parseOptionsFromFieldset.js' */
(function(){JIRA.parseOptionsFromFieldset=function($fieldset){var parsedValues=parseFieldset($fieldset,$fieldset);$fieldset.remove();return parsedValues};function parseFieldset($fieldset,$parentFieldset){var ret={};$fieldset.children().each(function(){var itemValue,$item=jQuery(this);if($item.is("input[type=hidden]")){itemValue=parseValue($item);ret[itemValue.id]=itemValue.value}else{if($item.is("fieldset")){ret[$item.attr("title")||$item.attr("id")]=parseFieldset($item,$parentFieldset)}else{$item.insertBefore($parentFieldset)}}});return ret}function parseValue($item){var itemValue={},value=$item.val();itemValue.id=$item.attr("title")||$item.attr("id");itemValue.value=(value.match(/^(tru|fals)e$/i)?value.toLowerCase()=="true":value);return itemValue}})();
/* module-key = 'jira.webresources:util', location = '/includes/jquery/plugins/handleaccesskeys/handleAccessKeys.js' */
jQuery.fn.handleAccessKeys=function(options){var accessKeyAttr="accesskey";if(jQuery.browser.msie&&jQuery.browser.version=="7.0"){accessKeyAttr="accessKey"}options=options||{};this.each(function(){var $form=AJS.$(this),blackList=[],$myAccessKeyElems,$accessKeyElems;$accessKeyElems=jQuery("form").not(this).find(":input["+accessKeyAttr+"], a["+accessKeyAttr+"]");$myAccessKeyElems=jQuery(":input["+accessKeyAttr+"], a["+accessKeyAttr+"]",this);if(!$form.is("form")){console.warn("jQuery.fn.enableAccessKeys: node type ["+$form.prop("nodeName")+"] is not valid. "+"Only <form> supported");return this}if($form.data("handleAccessKeys.applied")){return }$form.data("handleAccessKeys.applied",true);$form.find(":input["+accessKeyAttr+"], a["+accessKeyAttr+"]").each(function(){var accessKey=jQuery(this).attr(accessKeyAttr);if(accessKey){blackList.push(accessKey.toLowerCase())}});$form.delegate(":input, a","focus",function(){removeAccessKeys($accessKeyElems,blackList);attachAccessKeys($myAccessKeyElems)}).delegate(":input, a","blur",function(){attachAccessKeys($accessKeyElems)})});function isInvalid(key,blackList){if(key){if(options.selective===false){return true}if(/[a-z]/i.test(key)){key=key.toLowerCase()}return jQuery.inArray(key,blackList)!==-1}}function attachAccessKeys($accessKeyElems){$accessKeyElems.each(function(){var $this=AJS.$(this);if($this.data(accessKeyAttr)){$this.attr(accessKeyAttr,$this.data(accessKeyAttr))}})}function removeAccessKeys($accessKeyElems,blackList){$accessKeyElems.each(function(){var $this=AJS.$(this);if(isInvalid($this.attr(accessKeyAttr),blackList)){$this.data(accessKeyAttr,$this.attr(accessKeyAttr));$this.removeAttr(accessKeyAttr)}})}return this};
/* module-key = 'jira.webresources:util', location = '/includes/jquery/plugins/setselectionrange/setSelectionRange.js' */
jQuery.fn.setSelectionRange=function(selectionStart,selectionEnd){if(this.length==0){return }if(this[0].setSelectionRange){this[0].focus();this[0].setSelectionRange(selectionStart,selectionEnd)}else{if(this[0].createTextRange){var range=this[0].createTextRange();range.collapse(true);range.moveEnd("character",selectionEnd);range.moveStart("character",selectionStart);range.select()}}},jQuery.fn.setCaretToPosition=function(position){this.setSelectionRange(position,position)};
/* module-key = 'jira.webresources:util', location = '/includes/jquery/plugins/pjax/jquery.pjax.js' */
(function($){$.fn.pjax=function(container,options){if(options){options.container=container}else{options=$.isPlainObject(container)?container:{container:container}}if(options.container&&typeof options.container!=="string"){throw"pjax container must be a string selector!";return false}return this.live("click",function(event){if(event.which>1||event.metaKey){return true}var defaults={url:this.href,container:$(this).attr("data-pjax"),clickedElement:$(this),fragment:null};$.pjax($.extend({},defaults,options));event.preventDefault()})};$.pjax=function(options){var $container=$(options.container),success=options.success||$.noop;delete options.success;if(typeof options.container!=="string"){throw"pjax container must be a string selector!"}var defaults={timeout:650,push:true,replace:false,data:{_pjax:true},type:"GET",dataType:"html",beforeSend:function(xhr){$container.trigger("start.pjax");xhr.setRequestHeader("X-PJAX","true")},error:function(){window.location=options.url},complete:function(){$container.trigger("end.pjax")},success:function(data){if(options.fragment){var $fragment=$(data).find(options.fragment);if($fragment.length){data=$fragment.children()}else{return window.location=options.url}}else{if(!$.trim(data)||/<html/i.test(data)){return window.location=options.url}}$container.html(data);var oldTitle=document.title,title=$.trim($container.find("title").remove().text());if(title){document.title=title}var state={pjax:options.container,fragment:options.fragment,timeout:options.timeout};var query=$.param(options.data);if(query!="_pjax=true"){state.url=options.url+(/\?/.test(options.url)?"&":"?")+query}if(options.replace){window.history.replaceState(state,document.title,options.url)}else{if(options.push){if(!$.pjax.active){window.history.replaceState($.extend({},state,{url:null}),oldTitle);$.pjax.active=true}window.history.pushState(state,document.title,options.url)}}if((options.replace||options.push)&&window._gaq){_gaq.push(["_trackPageview"])}var hash=window.location.hash.toString();if(hash!==""){window.location.href=hash}success.apply(this,arguments)}};options=$.extend(true,{},defaults,options);if($.isFunction(options.url)){options.url=options.url()}var xhr=$.pjax.xhr;if(xhr&&xhr.readyState<4){xhr.onreadystatechange=$.noop;xhr.abort()}$.pjax.xhr=$.ajax(options);$(document).trigger("pjax",$.pjax.xhr,options);return $.pjax.xhr};var popped=("state" in window.history),initialURL=location.href;$(window).bind("popstate",function(event){var initialPop=!popped&&location.href==initialURL;popped=true;if(initialPop){return }var state=event.state;if(state&&state.pjax){var container=state.pjax;if($(container+"").length){$.pjax({url:state.url||location.href,fragment:state.fragment,container:container,push:false,timeout:state.timeout})}else{window.location=location.href}}});if($.inArray("state",$.event.props)<0){$.event.props.push("state")}$.support.pjax=window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/(iPod|iPhone|iPad|WebApps\/.+CFNetwork)/);if(!$.support.pjax){$.pjax=function(options){window.location=$.isFunction(options.url)?options.url():options.url};$.fn.pjax=function(){return this}}})(jQuery);
/* module-key = 'jira.webresources:util', location = '/includes/jquery/plugins/simpleclick/simpleClick.js' */
(function($){$.event.special.simpleClick={add:function(handleObj){handleObj._clickHandler=function(event){if(!event.ctrlKey&&!event.metaKey&&!event.shiftKey){return handleObj.handler.apply(this,arguments)}};$(this).on("click",handleObj.selector,handleObj._clickHandler)},remove:function(handleObj){$(this).off("click",handleObj.selector,handleObj._clickHandler)}}})(jQuery);
/* module-key = 'jira.webresources:util', location = '/includes/jira/data/SessionStorage.js' */
JIRA.SessionStorage={};(function(){var MAGIC_MARK="jsessionstorage:";var nonNativeSessionStorageObjInitialised=false;var nonNativeSessionStorageObj={};var nonNativeSessionStorageImpl={nonnativeimplementation:true,_storage:function(){if(nonNativeSessionStorageObjInitialised){return nonNativeSessionStorageObj}if(typeof window.name!="string"){window.name=MAGIC_MARK+"{}"}if(window.name.indexOf(MAGIC_MARK)!=0){window.name=MAGIC_MARK+"{}"}var jsonData=window.name.substr(MAGIC_MARK.length);nonNativeSessionStorageObj=JSON.parse(jsonData);if(!nonNativeSessionStorageObj){nonNativeSessionStorageObj={}}nonNativeSessionStorageObjInitialised=true;return nonNativeSessionStorageObj},_persistStorage:function(){var storeObj=this._storage();var jsonData=JSON.stringify(storeObj);window.name=MAGIC_MARK+jsonData},length:function(){var i=0;var store=this._storage();for(var x in store){i++}return i},key:function(index){var i=0;var store=this._storage();for(var x in store){if(i==index){return x}i++}return null},getItem:function(key){return this._storage()[key]},setItem:function(key,value){this._storage()[key]=value;this._persistStorage()},removeItem:function(key){delete this._storage()[key];this._persistStorage()},clear:function(){var store=this._storage();for(var x in store){delete x}this._persistStorage()}};var _sessionStorageImpl=window.sessionStorage!=null?window.sessionStorage:nonNativeSessionStorageImpl;JIRA.SessionStorage.nativesupport=window.sessionStorage!=null;JIRA.SessionStorage.length=function(){if(typeof _sessionStorageImpl.length=="function"){return _sessionStorageImpl.length()}return _sessionStorageImpl.length};JIRA.SessionStorage.key=function(index){return _sessionStorageImpl.key(index)};JIRA.SessionStorage.getItem=function(key){return _sessionStorageImpl.getItem(key)};JIRA.SessionStorage.setItem=function(key,value){_sessionStorageImpl.setItem(key,value)};JIRA.SessionStorage.removeItem=function(key){_sessionStorageImpl.removeItem(key)};JIRA.SessionStorage.clear=function(){_sessionStorageImpl.clear()};JIRA.SessionStorage.asJSON=function(){var len=this.length();var jsData="{\n";for(var i=0;i<len;i++){var key=this.key(i);var value=this.getItem(key);jsData+=key+":"+value;if(i<len-1){jsData+=","}jsData+="\n"}jsData+="}\n";return jsData}})(jQuery);AJS.namespace("jira.app.session.storage",null,JIRA.SessionStorage);
/* module-key = 'jira.webresources:util', location = '/includes/jira/data/LocalStorage.js' */
if(typeof localStorage==="undefined"){localStorage={getItem:jQuery.noop,setItem:jQuery.noop,removeItem:jQuery.noop,clear:jQuery.noop}};
/* module-key = 'jira.webresources:util', location = '/includes/ajs/persistence/persistence.js' */
AJS.nextPage=function(){var data=[],oldBeforeUnload=window.onbeforeunload;window.onbeforeunload=function(){if(window.sessionStorage){sessionStorage.setItem("AJS.thisPage",JSON.stringify(data))}else{saveCookie("AJS.thisPage",JSON.stringify(data))}if(oldBeforeUnload){oldBeforeUnload()}};return function(name,value){var replaced;jQuery.each(data,function(){if(this.name===name){this.value=value;replaced=true}});if(!replaced){data.push({name:name,value:value})}}}();AJS.thisPage=function(){var i,value,unformattedData,data={};if(window.sessionStorage){unformattedData=sessionStorage.getItem("AJS.thisPage");sessionStorage.removeItem("AJS.thisPage")}else{unformattedData=readCookie("AJS.thisPage");eraseCookie("AJS.thisPage")}if(unformattedData){unformattedData=JSON.parse(unformattedData);for(i=0;i<unformattedData.length;i++){data[unformattedData[i].name]=unformattedData[i].value}}return function(key){return data[key]}}();
/* module-key = 'jira.webresources:util', location = '/includes/jira/xsrf/XSRF.js' */
(function(){var META_TOKEN_ID="atlassian-token";var PARAM_TOKEN_NAME="atl_token";var INPUT_TOKEN_NAME="atl_token";var tokenQueryParam=function(token){return AJS.format("{0}={1}",PARAM_TOKEN_NAME,token)};var replaceTokenInMeta=function(oldToken,newToken){var metaTokenSelector=AJS.format("meta#{0}",META_TOKEN_ID);AJS.$(metaTokenSelector).attr("content",newToken)};var replaceTokenInLinks=function(oldToken,newToken){AJS.$("a,link").each(function(){var link=AJS.$(this);var href=link.attr("href");if(href){link.attr("href",href.replace(tokenQueryParam(oldToken),tokenQueryParam(newToken)))}})};var replaceTokenInForms=function(oldToken,newToken){AJS.$("form").each(function(){var $form=AJS.$(this);var action=$form.attr("action");if(action){$form.attr("action",action.replace(tokenQueryParam(oldToken),tokenQueryParam(newToken)))}var formInputSelector=AJS.format("input[name={0}][value={1}]",INPUT_TOKEN_NAME,oldToken);$form.find(formInputSelector).each(function(){AJS.$(this).attr("value",newToken)})})};AJS.namespace("JIRA.XSRF");if(typeof JIRA.XSRF.updateTokenOnPage!=="function"){JIRA.XSRF.updateTokenOnPage=function(newToken){var oldToken=atl_token();if(oldToken!==newToken){replaceTokenInMeta(oldToken,newToken);replaceTokenInLinks(oldToken,newToken);replaceTokenInForms(oldToken,newToken)}}}}());AJS.namespace("jira.xsrf",null,JIRA.XSRF);
/* module-key = 'jira.webresources:util', location = '/includes/ajs/bindDefaultCustomEvent/bindDefaultCustomEvent.js' */
(function(){var defaultEvents={};AJS.bindDefaultCustomEvent=function(name,defaultHandler){if(defaultEvents[name]){throw new Error("You have already bound a default handler for ["+name+"] event")}defaultEvents[name]=function(e){var events=AJS.$(document).data("events")[name],lastEventHandler=events[events.length-1].handler;if(lastEventHandler!==arguments.callee){e.preventDefault=function(){defaultHandler=null};events[events.length-1].handler=function(){lastEventHandler.apply(this,arguments);if(defaultHandler){defaultHandler.apply(this,arguments)}events[events.length-1].handler=lastEventHandler}}else{defaultHandler.apply(this,arguments)}};AJS.$(document).bind(name,defaultEvents[name])};AJS.unbindDefaultCustomEvent=function(name){if(defaultEvents[name]){AJS.$(document).unbind(name,defaultEvents[name]);delete defaultEvents[name]}}})();
/* module-key = 'jira.webresources:util', location = '/includes/jira/numberformatter/NumberFormatter.js' */
JIRA.NumberFormatter={format:function(integer){var groupSeparator=AJS.Meta.get("user-locale-group-separator")||"";return integer.toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g,groupSeparator)}};
/* module-key = 'jira.webresources:content-retrievers', location = '/includes/ajs/contentretriever/ContentRetriever.js' */
AJS.ContentRetriever=Class.extend({startingRequest:jQuery.noop,finishedRequest:jQuery.noop,cache:jQuery.noop,isLocked:jQuery.noop,content:jQuery.noop});
/* module-key = 'jira.webresources:content-retrievers', location = '/includes/ajs/contentretriever/AjaxContentRetriever.js' */
AJS.AjaxContentRetriever=AJS.ContentRetriever.extend({init:function(options){var instance=this;this.ajaxOptions=options;if(!this.ajaxOptions.requestDelay&&this.ajaxOptions.requestDelay!==0){this.ajaxOptions.requestDelay=75}},getAjaxOptions:function(){var ajaxOptions,instance=this;if(typeof this.ajaxOptions==="string"){ajaxOptions={url:this.ajaxOptions}}else{if(jQuery.isFunction(this.ajaxOptions)){ajaxOptions=this.ajaxOptions()}else{ajaxOptions=this.ajaxOptions}}ajaxOptions.globalThrobber=false;ajaxOptions.success=function(data,textStatus,xhr){instance._requestComplete(xhr,textStatus,data,true,null)};ajaxOptions.error=function(xhr,textStatus){if(xhr.rc){xhr.status=xhr.rc}instance._requestComplete(xhr,textStatus,null,false,null)};return ajaxOptions},content:function(arg){if(AJS.$.isFunction(arg)){this.callback=arg;this._makeRequest(arg)}else{if(arg){if(this.callback){this.callback(arg);delete this.callback}}}return this.$content},startingRequest:function(callback){if(callback){this.startingCallback=callback}else{if(this.startingCallback){this.locked=true;this.startingCallback()}}},finishedRequest:function(callback){if(callback){this.finishedCallback=callback}else{if(this.finishedCallback){this.locked=false;this.finishedCallback()}}},failedRequest:function(callback){if(callback){this.failedCallback=callback}else{if(this.failedCallback){this.locked=false;this.failedCallback()}}},cache:function(cache){if(typeof cache!=="undefined"){this.getAjaxOptions().cache=cache}return this.getAjaxOptions().cache},isLocked:function(){return this.locked},_requestComplete:function(xhr,statusText,data,successful,errorThrown){if(statusText==="abort"){this.locked=false;return }var $content,smartAjaxResult,ajaxOptions=this.getAjaxOptions();if(JIRA.SmartAjax.SmartAjaxResult){smartAjaxResult=JIRA.SmartAjax.SmartAjaxResult.apply(window,arguments)}if(successful){if(AJS.$.isFunction(ajaxOptions.formatSuccess)){$content=ajaxOptions.formatSuccess(data)}else{$content=AJS.$("<div>"+data+"</div>")}}else{if(AJS.$.isFunction(ajaxOptions.formatError)){$content=ajaxOptions.formatError(data)}else{if(smartAjaxResult){var errorClass=smartAjaxResult.status===401?"warning":"error";$content=AJS.$('<div class="aui-message '+errorClass+'"><span class="aui-icon icon-'+errorClass+'"></span>'+JIRA.SmartAjax.buildSimpleErrorContent(smartAjaxResult)+"</div>")}}this.failedRequest()}this.content($content);this.finishedRequest()},_makeRequest:function(){var instance=this,ajaxOptions=this.getAjaxOptions();if(this.outstandingRequest){this.outstandingRequest.abort();this.outstandingRequest=null}clearTimeout(this._queuedRequest);if(this.isLocked()){this._queuedRequest=setTimeout(function(){instance._makeRequest()},this.ajaxOptions.requestDelay)}else{doRequest()}function doRequest(){instance.startingRequest();instance.outstandingRequest=AJS.$.ajax(instance.getAjaxOptions())}}});
/* module-key = 'jira.webresources:content-retrievers', location = '/includes/ajs/contentretriever/DOMContentRetriever.js' */
AJS.DOMContentRetriever=AJS.ContentRetriever.extend({init:function(content){this.$content=AJS.$(content)},content:function(callback){if(AJS.$.isFunction(callback)){callback(this.$content)}return this.$content},cache:function(){},isLocked:function(){},startingRequest:function(){},finishedRequest:function(){}});
/* module-key = 'jira.webresources:content-retrievers', location = '/includes/ajs/contentretriever/DeferredContentRetriever.js' */
AJS.DeferredContentRetriever=AJS.ContentRetriever.extend({init:function(func){this.func=func},content:function(callback){if(AJS.$.isFunction(callback)){var res=this.func();if(res instanceof jQuery){callback(res)}else{res.done(_.bind(function(content){callback(content)},this))}}},cache:function(){return false},isLocked:function(){},startingRequest:function(){},finishedRequest:function(){}});
/* module-key = 'jira.webresources:inline-layer', location = '/includes/ajs/layer/InlineLayer.js' */
AJS.InlineLayer=AJS.Control.extend({CLASS_SIGNATURE:"AJS_InlineLayer",SCROLL_HIDE_EVENT:"scroll.hide-dropdown",init:function(options){var instance=this;if(!(options instanceof AJS.InlineLayer.OptionsDescriptor)){this.options=new AJS.InlineLayer.OptionsDescriptor(options)}else{this.options=options}this.offsetTarget(this.options.offsetTarget());this.contentRetriever=this.options.contentRetriever();AJS.$.extend(this,this.options.positioningController());if(!(this.contentRetriever instanceof AJS.ContentRetriever)){throw new Error("AJS.InlineLayer: Failed construction, Content retriever does not implement interface "+"[AJS.ContentRetrieverInterface]")}this.contentRetriever.startingRequest(function(){instance._showLoading()});this.contentRetriever.finishedRequest(function(){instance._hideLoading()});if(this.contentRetriever.failedRequest){this.contentRetriever.failedRequest(function(){instance.onerror()})}this.$layer=this._render("layer",this.options.alignment())},content:function(arg){var instance=this;if(AJS.$.isFunction(arg)){this.contentRetriever.content(function(content){instance.$content=content.removeClass("hidden");arg.call(instance)})}else{return this.$content}},offsetTarget:function(){var $offsetTarget=this.options.offsetTarget();if(AJS.$.isFunction($offsetTarget)){$offsetTarget=$offsetTarget()}return $offsetTarget},contentChange:function(callback){var instance=this;if(AJS.$.isFunction(callback)){if(!this.contentChangeCallback){this.contentChangeCallback=[]}this.contentChangeCallback.push(callback)}else{if(!callback){this.trigger("contentChanged",[this]);this.setWidth(this.options.width());if(this.contentChangeCallback){AJS.$.each(this.contentChangeCallback,function(i,callback){callback(instance)})}}}},onhide:function(callback){var instance=this;if(AJS.$.isFunction(callback)){if(!this.hideCallback){this.hideCallback=[]}this.hideCallback.push(callback)}else{if(!callback&&this.hideCallback){AJS.$.each(this.hideCallback,function(i,callback){callback(instance)})}}},onerror:function(callback){var instance=this;if(AJS.$.isFunction(callback)){if(!this.errorCallback){this.errorCallback=[]}this.errorCallback.push(callback)}else{if(!callback&&this.errorCallback){AJS.$.each(this.errorCallback,function(i,callback){callback(instance)})}}},layer:function(layer){if(layer){this.$layer=layer}else{return this.$layer}},placeholder:function(placeholder){if(placeholder){this._throwReadOnlyError("placeholder")}else{return this.$placeholder}},isVisible:function(visible){if(typeof visible!=="undefined"){this._throwReadOnlyError("visible")}return this.visible},scrollableContainer:function(scrollableContainer){if(scrollableContainer){this._throwReadOnlyError("scrollableContainer")}return this.$scrollableContainer},isInitialized:function(initialised){if(initialised){this._throwReadOnlyError("initialized")}return this.initialized},hide:function(reason,e){var event;var target=e&&e.target;if(!this.isVisible()){return false}event=AJS.$.Event(AJS.InlineLayer.EVENTS.beforeHide);this.trigger(event,[this.layer(),reason,this.options.id,target]);JIRA.trigger(event,[this.layer(),reason,this.options.id,target]);if(!event.isDefaultPrevented()){this.visible=false;this._makeInactiveAndHideLayer();var positionController=this;setTimeout(function(){positionController.appendToPlaceholder()},0);this._unbindEvents();this.onhide();this.trigger("hideLayer",[this]);AJS.$(document).trigger("hideLayer",[this.CLASS_SIGNATURE,this]);this.trigger(AJS.InlineLayer.EVENTS.hide,[this.layer(),reason,this.options.id]);JIRA.trigger(AJS.InlineLayer.EVENTS.hide,[this.layer(),reason,this.options.id]);AJS.InlineLayer.current=null}},_makeInactiveAndHideLayer:function(){this.layer().removeClass(AJS.ACTIVE_CLASS).hide();this.offsetTarget().removeClass(AJS.ACTIVE_CLASS)},refreshContent:function(callback){var instance=this;this.content(function(){if(this.layer().has(this.content()).length===0){this.layer().html(this.content())}if(AJS.$.isFunction(callback)){callback.call(instance)}this.contentChange()})},show:function(){var instance=this,event;if(this.isVisible()){return }event=AJS.$.Event(AJS.InlineLayer.EVENTS.beforeShow);this.trigger(event,[this.layer(),this.options.id]);JIRA.trigger(event,[this.layer(),this.options.id]);if(!event.isDefaultPrevented()){if(!this.isInitialized()){this._lazyInit(function(){instance._showContent()})}else{if(this.contentRetriever.cache()===false){this.refreshContent(function(){instance._showContent()})}else{instance._showContent()}}}},_showContent:function(){if(this.offsetTarget().is(":visible")){this._show()}else{this._makeInactiveAndHideLayer()}},toggle:function(shouldShow){if(shouldShow==null){shouldShow=!this.isVisible()}if(shouldShow){this.show()}else{this.hide(AJS.HIDE_REASON.toggle)}},setPosition:function(){var positioning,$window=AJS.$(window);if(!this.isInitialized()||!this.offsetTarget()||this.offsetTarget().length===0){return }var offsetTargetLeft=this.offsetTarget().offset().left;var layerWidth=this.layer().width();var hasSpaceOnRight=offsetTargetLeft+layerWidth<$window.width()+$window.scrollLeft();var hasSpaceOnLeft=offsetTargetLeft+this.offsetTarget().outerWidth()-layerWidth>$window.scrollLeft();if(this.options.alignment()===AJS.RIGHT){if(hasSpaceOnLeft||!hasSpaceOnRight){positioning=this.right()}else{positioning=this.left()}}else{if(this.options.alignment()===AJS.LEFT){if(hasSpaceOnRight||!hasSpaceOnLeft){positioning=this.left()}else{positioning=this.right()}}else{if(this.options.alignment()===AJS.INTELLIGENT_GUESS){if((offsetTargetLeft+(this.offsetTarget().width()/2))>$window.width()/2){positioning=this.right()}else{positioning=this.left()}}}}this.trigger("setLayerPosition",[positioning,this]);if(this.options.properties.setMaxHeightToWindow||(this.options.properties.setMaxHeightToWindow!==false&&AJS.$(".aui-blanket").is(":visible"))){var scrollLeft=$window.scrollLeft();if(scrollLeft>0){positioning.left-=scrollLeft}var $fixedParents=this.fixedParent();var scrollTop;if($fixedParents.size()){scrollTop=0}else{scrollTop=$window.scrollTop()}positioning.maxHeight=$window.height()-positioning.top+scrollTop-this.options.cushion()}positioning.minHeight=this.options.properties.minHeight;this.layer().css(positioning)},setOverflowAndHeight:function(){if(this.options.properties.maxInlineResultsDisplayed){this.layer().addClass("limited")}},fixedParent:function(){return this.offsetTarget().parents().filter(function(){return jQuery(this).css("position")==="fixed"})},setWidth:function(width){this.layer().width(width)},_lazyInit:function(callback){if(this.initializing){return }this.initializing=true;this.refreshContent(function(){var instance=this;this.initializing=false;this.initialized=true;this.layer().insertAfter(this.offsetTarget());if(this._supportsBoxShadow()){this.layer().addClass(AJS.BOX_SHADOW_CLASS)}this.$placeholder=AJS.$("<div class='ajs-layer-placeholder' />").insertAfter(this.offsetTarget());this.$scrollableContainer=this.offsetTarget().closest(this.options.hideOnScroll());this.rebuilt(function(layer){instance.layer(layer)});callback()})},_show:function(){if(AJS.InlineLayer.current){AJS.InlineLayer.current.hide()}this.visible=true;this.content().show();this.appendToBody();this.layer().addClass(AJS.ACTIVE_CLASS);this.offsetTarget().addClass(AJS.ACTIVE_CLASS);this.layer().show();this.setWidth(this.options.width());this.setPosition();this.setOverflowAndHeight();this._bindEvents();if(!AJS.dim.dim){this.scrollTo()}AJS.InlineLayer.current=this;this.trigger("showLayer",[this]);AJS.$(document).trigger("showLayer",[this.CLASS_SIGNATURE,this]);this.trigger(AJS.InlineLayer.EVENTS.show,[this.layer(),this.options.id]);JIRA.trigger(AJS.InlineLayer.EVENTS.show,[this.layer(),this.options.id])},_hideLoading:function(){this.$layer.removeClass(AJS.LOADING_CLASS);this.offsetTarget().removeClass(AJS.LOADING_CLASS)},_showLoading:function(){this.$layer.addClass(AJS.LOADING_CLASS);this.offsetTarget().addClass(AJS.LOADING_CLASS)},_unbindEvents:function(){this.$scrollableContainer.unbind(this.SCROLL_HIDE_EVENT);this._unassignCustomEvents();this._unassignEvents("container",document);this._unassignEvents("win",window)},_bindEvents:function(){var instance=this;this.$scrollableContainer.one(this.SCROLL_HIDE_EVENT,function(){instance.hide()});this._assignCustomEvents();this._assignEvents("container",document);this._assignEvents("win",window)},_assignCustomEvents:function(){var customEvents=this.options.customEvents();if(!customEvents){return }this._unassignCustomEvents();for(var target in customEvents){for(var eventType in customEvents[target]){AJS.$(target).on(eventType,this._getCustomEventsDispatcher(target,eventType,customEvents))}}},_unassignCustomEvents:function(){var customEvents=this.options.customEvents();if(!customEvents){return }for(var target in customEvents){for(var eventType in customEvents[target]){AJS.$(target).off(eventType,this._getCustomEventsDispatcher(target,eventType,customEvents))}}},_getCustomEventsDispatcher:function(target,eventType,events){var group="custom";var ns=group+"/"+target+"/"+eventType;if(!this._dispatchers){this._dispatchers={}}if(!this._dispatchers[ns]){var instance=this;var handler=events[target][eventType];this._dispatchers[ns]=function(event){return handler.call(instance,event,AJS.$(this))}}return this._dispatchers[ns]},_validateClickToClose:function(e){if(e.target===this.offsetTarget()[0]){return false}else{if(e.target===this.layer()[0]){return false}else{if(this.offsetTarget().has(e.target).length>0){return false}else{if(this.layer().has(e.target).length>0){return false}}}}return true},"keys":{Esc:function(e){this.hide(AJS.HIDE_REASON.escPressed,e)}},_events:{container:{"aui:keydown":function(event){this._handleKeyEvent(event)},click:function(e){if(this._validateClickToClose(e)){this.hide(AJS.HIDE_REASON.clickOutside,e)}}},win:{resize:function(){this.setPosition()},scroll:function(){this.setPosition()}}},_renders:{layer:function(){return AJS.$("<div />").addClass("ajs-layer "+(this.options.styleClass()||""))}}});AJS.InlineLayer.EVENTS={beforeHide:"InlineLayer.beforeHide",hide:"InlineLayer.hide",beforeShow:"InlineLayer.beforeShow",show:"InlineLayer.show"};JIRA.bind(AJS.InlineLayer.EVENTS.beforeHide,function(e){if(typeof Calendar!=="undefined"&&Calendar.current){e.preventDefault()}});
/* module-key = 'jira.webresources:inline-layer', location = '/includes/ajs/layer/InlineLayer.OptionsDescriptor.js' */
AJS.InlineLayer.OptionsDescriptor=AJS.Descriptor.extend({init:function(properties){this._super(properties);if(!this.contentRetriever()){if(this.ajaxOptions()){this.contentRetriever(new AJS.AjaxContentRetriever(this.ajaxOptions()))}else{if(AJS.$.isFunction(this.content())){this.contentRetriever(new AJS.DeferredContentRetriever(this.content()))}else{if(this.content()){this.contentRetriever(new AJS.DOMContentRetriever(this.content()))}else{throw new Error("AJS.InlineLayer.OptionsDescriptor: Expected either [ajaxOptions] or [contentRetriever] or [content] to be defined")}}}}if(!this.positioningController()){if(!AJS.params.ignoreFrame&&this._inIFrame()){this.positioningController(new AJS.InlineLayer.IframePositioning())}else{var $body=jQuery("body");var isBodyOverflowHidden=$body.css("overflow")==="hidden"||$body.css("overflowY")==="hidden";if(isBodyOverflowHidden){this.positioningController(new AJS.InlineLayer.WindowPositioning())}else{this.positioningController(new AJS.InlineLayer.StandardPositioning())}}}if(AJS.$.browser.msie&&AJS.$.browser.version<9&&this.positioningController().isOffsetIncludingScroll){this.positioningController().isOffsetIncludingScroll(false)}if(!this.offsetTarget()&&this.content() instanceof AJS.$){this.offsetTarget(this.content().prev())}},_inIFrame:function(){var parentWindow=window;try{while(parentWindow.parent.window!==parentWindow.window){parentWindow=parentWindow.parent;if(parentWindow.AJS){return true}}}catch(error){}return false},_getDefaultOptions:function(){return{alignment:AJS.INTELLIGENT_GUESS,hideOnScroll:".form-body",cushion:20,width:200}},positioningController:function(positioningController){if(positioningController){this.properties.positioningController=positioningController}else{return this.properties.positioningController}},ajaxOptions:function(ajaxOptions){if(ajaxOptions){this.properties.ajaxOptions=ajaxOptions}else{return this.properties.ajaxOptions}},content:function(content){if(content){content=AJS.$(content);if(content.length){this.properties.content=content}}else{if(this.properties.content&&(this.properties.content.length||AJS.$.isFunction(this.properties.content))){return this.properties.content}}},contentRetriever:function(contentRetriever){if(contentRetriever){this.properties.contentRetriever=contentRetriever}else{return this.properties.contentRetriever}},offsetTarget:function(offsetTarget){if(offsetTarget){offsetTarget=AJS.$(offsetTarget);if(offsetTarget.length){this.properties.offsetTarget=offsetTarget}}else{if(this.properties.offsetTarget&&(this.properties.offsetTarget.length||AJS.$.isFunction(this.properties.offsetTarget))){return this.properties.offsetTarget}}},cushion:function(cushion){if(cushion){this.properties.cushion=cushion}else{return this.properties.cushion}},styleClass:function(styleClass){if(styleClass){this.properties.styleClass=styleClass}else{return this.properties.styleClass}},hideOnScroll:function(hideOnScroll){if(hideOnScroll){this.properties.hideOnScroll=hideOnScroll}else{return this.properties.hideOnScroll}},alignment:function(alignment){if(alignment){this.properties.alignment=alignment}else{return this.properties.alignment}},width:function(width){if(width){this.properties.width=width}else{if(AJS.$.isFunction(this.properties.width)){return this.properties.width.call(this)}else{return this.properties.width}}},allowDownsize:function(allowDownsize){if(allowDownsize){this.properties.allowDownsize=allowDownsize}else{return this.properties.allowDownsize}},customEvents:function(customEvents){if(customEvents){this.properties.customEvents=customEvents}else{return this.properties.customEvents}}});
/* module-key = 'jira.webresources:inline-layer', location = '/includes/ajs/layer/InlineLayer.create.js' */
AJS.InlineLayer.create=function(options){var inlineLayers=[];if(options.content){options.content=AJS.$(options.content);AJS.$.each(options.content,function(){var instanceOptions=AJS.copyObject(options);instanceOptions.content=AJS.$(this);inlineLayers.push(new AJS.InlineLayer(instanceOptions))})}if(inlineLayers.length==1){return inlineLayers[0]}else{return inlineLayers}};
/* module-key = 'jira.webresources:inline-layer', location = '/includes/ajs/layer/InlineLayer.StandardPositioning.js' */
AJS.InlineLayer.StandardPositioning=Class.extend({init:function(){this.rebuiltCallbacks=[]},left:function(){var offset=this.offset();return{left:offset.left,top:offset.top+this.offsetTarget().outerHeight()}},right:function(){var offset=this.offset();return{left:offset.left-this.layer().outerWidth()+this.offsetTarget().outerWidth(),top:offset.top+this.offsetTarget().outerHeight()}},window:function(){return window},offset:function(){var offset=this.offsetTarget().offset();if(this.offsetTarget().hasFixedParent()){this.layer().css("position","fixed");offset.top=offset.top-AJS.$(window).scrollTop()}else{this.layer().css("position","absolute")}return offset},rebuilt:function(arg){var instance=this;if(AJS.$.isFunction(arg)){this.rebuiltCallbacks.push(arg)}else{AJS.$.each(this.rebuiltCallbacks,function(){this(instance.layer())})}},appendToBody:function(){this.layer().appendTo("body")},appendToPlaceholder:function(){this.layer().appendTo(this.$placeholder)},scrollTo:function(){}});AJS.InlineLayer.WindowPositioning=AJS.InlineLayer.StandardPositioning.extend({_calculateOverflow:function(offset){var isFixed=this.layer().css("position")==="fixed",layerBottom=offset.top+this.layer().outerHeight(true),windowHeight=jQuery(window).outerHeight(),windowScroll=jQuery(window).scrollTop();if(isFixed){return Math.max(0,layerBottom-windowHeight)}else{return Math.max(0,layerBottom-windowScroll-windowHeight)}},left:function(){var offset=this._super(),overflow=this._calculateOverflow(offset);if(overflow>0){offset.left+=this.offsetTarget().outerWidth();offset.top-=overflow}return offset},right:function(){var offset=this._super(),overflow=this._calculateOverflow(offset);if(overflow>0){offset.left-=this.offsetTarget().outerWidth();offset.top-=overflow}return offset}});
/* module-key = 'jira.webresources:inline-layer', location = '/includes/ajs/layer/InlineLayer.IframePositioning.js' */
AJS.InlineLayer.IframePositioning=AJS.InlineLayer.StandardPositioning.extend({offset:function(){var offsetInDocument=this._super(),iframeOffset=AJS.$("iframe[name="+window.name+"]",window.top.document.body).parent().offset(),topDocumentScrollTop=this._topDocumentScrollTop(),topDocumentScrollLeft=this._topDocumentScrollLeft(),iframeScrollTop=this._iframeScrollTop(),iframeScrollLeft=this._iframeScrollLeft(),scrollTopModifier=topDocumentScrollTop-iframeScrollTop,scrollLeftModifier=topDocumentScrollLeft-iframeScrollLeft;return{left:iframeOffset.left+offsetInDocument.left+scrollLeftModifier,top:iframeOffset.top+offsetInDocument.top+scrollTopModifier}},_topDocumentScrollTop:function(){return this.isOffsetIncludingScroll()?0:Math.max(window.top.document.body.scrollTop,window.top.document.documentElement.scrollTop)},_topDocumentScrollLeft:function(){return this.isOffsetIncludingScroll()?0:Math.max(window.top.document.body.scrollLeft,window.top.document.documentElement.scrollLeft)},_iframeScrollTop:function(){return this.isOffsetIncludingScroll()?2*Math.max(window.document.body.scrollTop,window.document.documentElement.scrollTop):0},_iframeScrollLeft:function(){return this.isOffsetIncludingScroll()?2*Math.max(window.document.body.scrollLeft,window.document.documentElement.scrollLeft):0},isOffsetIncludingScroll:function(offsetIncludingScroll){if(typeof this.offsetIncludingScroll==="undefined"){this.offsetIncludingScroll=true}if(typeof offsetIncludingScroll!=="undefined"){this.offsetIncludingScroll=offsetIncludingScroll}return this.offsetIncludingScroll},appendToBody:function(){window.top.jQuery("body").append(this.layer())},window:function(){return window.top},scrollTo:function(){}});if(AJS.$.browser.safari||(AJS.$.browser.msie&&AJS.$.browser.version<8)){AJS.InlineLayer.IframePositioning=AJS.InlineLayer.IframePositioning.extend({appendToBody:function(){var oldLayer=this.layer();this.layer(this._rebuildLayerInParent());window.top.jQuery("body").append(this.layer());oldLayer.remove();this.rebuilt()},appendToPlaceholder:function(){var oldLayer=this.layer();this.layer(this._rebuildLayerInIframe());this.layer().appendTo(this.placeholder());oldLayer.remove();this.rebuilt()},_rebuildLayerInParent:function(){return window.top.jQuery("<div class='ajs-layer'>"+this.layer().html()+"</div>")},_rebuildLayerInIframe:function(){return AJS.$("<div class='ajs-layer'>"+this.layer().html()+"</div>")}})}if(AJS.$.browser.mozilla){AJS.InlineLayer.IframePositioning=AJS.InlineLayer.IframePositioning.extend({appendToPlaceholder:function(){var $oldLayer=this.layer();this.layer($oldLayer.clone(true).appendTo(this.placeholder()));this.rebuilt();window.setTimeout(function(){$oldLayer.remove()},10)}})};
/* module-key = 'jira.webresources:list', location = '/includes/ajs/group/Group.js' */
AJS.Group=AJS.Control.extend({init:function(){this.items=[];this.index=-1;this._assignEvents("instance",this)},addItem:function(item){this.items.push(item);this._assignEvents("item",item)},_removeItem:function(item){var index=AJS.$.inArray(item,this.items);if(index<0){throw new Error("AJS.Group: item ["+item+"] is not a member of this group")}item.trigger("blur");if(index<this.index){this.index--}this.items.splice(index,1);this._unassignEvents("item",item)},removeItem:function(item){item.trigger("remove")},removeAllItems:function(){while(this.items.length){this.items[0].trigger("remove")}},shiftFocus:function(offset){if(this.index===-1&&offset===1){offset=0}if(this.items.length>0){var i=(Math.max(0,this.index)+this.items.length+offset)%this.items.length;this.items[i].trigger("focus")}},prepareForInput:function(){this._assignEvents("keys",document)},_events:{"instance":{"focus":function(){if(this.items.length===0){return }if(this.index<0){this.items[0].trigger("focus")}else{this._assignEvents("keys",document)}},"blur":function(){if(this.index>=0){this.items[this.index].trigger("blur")}else{this._unassignEvents("keys",document)}}},"keys":{"aui:keydown":function(event){this._handleKeyEvent(event)}},"item":{"focus":function(event){var index=this.index;this.index=AJS.$.inArray(event.target,this.items);if(index<0){this.trigger("focus")}else{if(index!==this.index){this.items[index].trigger("blur")}}},"blur":function(event){if(this.index===AJS.$.inArray(event.target,this.items)){this.index=-1;this.trigger("blur")}},"remove":function(event){this._removeItem(event.target)}}},keys:{}});
/* module-key = 'jira.webresources:list', location = '/includes/ajs/list/ItemDescriptor.js' */
AJS.ItemDescriptor=AJS.Descriptor.extend({init:function(options){if(options&&typeof options.meta==="object"){options.meta=JSON.stringify(options.meta)}this._super(options)},REQUIRED_PROPERTIES:{label:true},_getDefaultOptions:function(){return{showLabel:true}},styleClass:function(){return this.properties.styleClass},meta:function(){if(this.properties.meta){return JSON.parse(this.properties.meta)}},value:function(){return this.properties.value},invalid:function(){return this.properties.invalid},labelSuffix:function(value){if(typeof value!=="undefined"){this.properties.labelSuffix=value}return this.properties.labelSuffix},title:function(){return this.properties.title},label:function(){return this.properties.label},disabled:function(disabled){if(disabled){this.properties.disabled=disabled}else{return this.properties.disabled}},allowDuplicate:function(){return this.properties.allowDuplicate},removeOnUnSelect:function(value){if(typeof value!=="undefined"){this.properties.removeOnUnSelect=value}return this.properties.removeOnUnSelect},icon:function(){return this.properties.icon},fallbackIcon:function(){return this.properties.fallbackIcon},selected:function(value){if(typeof value!=="undefined"){this.properties.selected=value}return this.properties.selected},model:function($model){if($model){this.properties.model=$model}else{return this.properties.model}},keywords:function(){return this.properties.keywords},href:function(){return this.properties.href},highlighted:function(value){if(value===false){if(this.properties.html){this.properties.label=jQuery("<div>"+this.properties.html+"</div>").text();this.properties.html=null}this.properties.highlighted=false}return this.properties.highlighted&&this.properties.html},html:function(){return this.properties.html},fieldText:function(){return this.properties.fieldText},noExactMatch:function(){return this.properties.noExactMatch}});AJS.ItemDescriptor.create=function(suggestion,groupIndex){if(suggestion.isMessage){return AJS.MessageDescriptor.create(suggestion,groupIndex)}else{return new AJS.ItemDescriptor({label:suggestion.label,styleClass:suggestion.styleClass,value:suggestion.value,keywords:suggestion.keywords,meta:{groupIndex:groupIndex}})}};
/* module-key = 'jira.webresources:list', location = '/includes/ajs/list/MessageDescriptor.js' */
AJS.MessageDescriptor=AJS.ItemDescriptor.extend({useAUI:function(){return this.properties.useAUI},messageID:function(){return this.properties.messageID},_getDefaultOptions:function(){return AJS.$.extend(this._super(),{useAUI:true})}});AJS.MessageDescriptor.create=function(suggestion,groupIndex){return new AJS.MessageDescriptor({label:suggestion.label,styleClass:suggestion.styleClass,useAUI:suggestion.useAUI,messageID:suggestion.messageID,value:suggestion.value,keywords:suggestion.keywords,meta:{groupIndex:groupIndex}})};
/* module-key = 'jira.webresources:list', location = '/includes/ajs/list/GroupDescriptor.js' */
AJS.GroupDescriptor=AJS.Descriptor.extend({_getDefaultOptions:function(){return{showLabel:true,label:"",items:[]}},placement:function(){return this.properties.placement},styleClass:function(){return this.properties.styleClass},weight:function(){return this.properties.weight},label:function(){return this.properties.label},footerText:function(footerText){if(footerText){this.properties.footerText=footerText}else{return this.properties.footerText}},footerHtml:function(footerHtml){if(footerHtml){this.properties.footerHtml=footerHtml}else{return this.properties.footerHtml}},actionBarHtml:function(actionBarHtml){if(actionBarHtml){this.properties.actionBarHtml=actionBarHtml}return this.properties.actionBarHtml},showLabel:function(){return this.properties.showLabel},items:function(items){if(items){this.properties.items=items;return this}else{return this.properties.items}},addItem:function(item){this.properties.items.push(item);return this},id:function(){return this.properties.id},setModel:function($model){this.properties.model=$model},replace:function(){return this.properties.replace},uniqueItemScope:function(){return this.properties.uniqueItemScope},description:function(){return this.properties.description},model:function($model){if($model){this.properties.model=$model}else{return this.properties.model}}});
/* module-key = 'jira.webresources:list', location = '/includes/ajs/list/List.js' */
AJS.List=AJS.Control.extend({MAX_RESULT_LIMIT:2000,init:function(options){options=options||{};if(options){this.options=AJS.$.extend(true,this._getDefaultOptions(options),options)}else{this.options=this._getDefaultOptions(options)}this._renders=jQuery.extend({},this._renders,this.options.renderers);this.disabled=true;this.reset();var instance=this;if(this.options.selectionHandler){this.$container.delegate(this.options.itemSelector,this.options.selectionEvent,function(e){instance.options.selectionHandler.call(instance,e)})}this.motionDetector.wait();this.$container.delegate(this.options.itemSelector,"mousemove",function(){if(!instance.disabled&&(instance.motionDetector.moved||AJS.isSelenium())){instance.index=AJS.$.inArray(this,instance.$visibleItems);instance.focus(true)}})},_getDefaultOptions:function(){return{selectionEvent:"click",delegateTarget:document,matchingStrategy:"(^|.*?(\\s+|\\())({0})(.*)",itemSelector:"li.aui-list-item",hasLinks:true,stallEventBind:true}},index:0,moveToFirst:function(){if(this.$visibleItems.length>0){this.index=0;this.focus()}},moveToNext:function(){if(this.index<this.maxIndex){++this.index;this.focus()}else{if(this.$visibleItems.length>1){this.index=0;this.focus()}}},container:function(container){if(container){this.$container=AJS.$(container);this.containerSelector=container}else{return this.$container}},getItemsByDescriptor:function(descriptorToMatch){var $matches=AJS.$();this.$container.find(this.options.itemSelector).each(function(){var descriptor=AJS.$.data(this,"descriptor");if(descriptor&&descriptor.value()===descriptorToMatch.value()){$matches=$matches.add(this)}});return $matches},scrollContainer:function(){return(this.options.scrollContainer)?this.$container.find(this.options.scrollContainer):this.$container.parent()},_isScrollConstrained:function(){var scrollContainer=this.scrollContainer()[0];return scrollContainer.clientHeight<scrollContainer.scrollHeight},moveToPrevious:function(){if(this.index>0){--this.index;this.focus()}else{if(this.$visibleItems.length>0){this.index=this.$visibleItems.length-1;this.focus()}}},scrollActiveItemIntoView:function(){var $activeItem=this.$visibleItems.filter(".active");var $scrollContainer=this.scrollContainer();var scrollTop=$scrollContainer.scrollTop();if($activeItem.length===0){return }if(!this._isScrollConstrained()){$activeItem.scrollIntoView({callback:AJS.$.proxy(this.motionDetector,"wait")});return }if($activeItem.closest($scrollContainer).length===0){return }if($activeItem.is($scrollContainer.find(this.items).first())){this._scrollContainerTo(0);return }var roomAbove=$activeItem.offset().top-$scrollContainer.offset().top;var roomBelow=$scrollContainer.outerHeight()-$activeItem.outerHeight()-roomAbove;if(roomAbove>=0){if(roomBelow<0){this._scrollContainerTo(scrollTop-roomBelow)}}else{this._scrollContainerTo(scrollTop+roomAbove)}},_scrollContainerTo:function(scrollTop){var $scrollContainer=this.scrollContainer();if($scrollContainer.scrollTop()!==scrollTop){this.motionDetector.unbind();this.motionDetector.wait();$scrollContainer.scrollTop(scrollTop)}},focus:function(noScroll){this.$visibleItems.removeClass("active");var $target=this.$visibleItems.eq(this.index);$target.addClass("active");this.lastFocusedItemDescriptor=$target.data("descriptor");if(!noScroll){this.scrollActiveItemIntoView()}},motionDetector:new JIRA.Mouse.MotionDetector(),disable:function(){if(this.disabled){return }this._unassignEvents("delegateTarget",this.options.delegateTarget);this.disabled=true;this.lastFocusedItemDescriptor=null},enable:function(){var instance=this;if(!instance.disabled){return }if(this.options.stallEventBind){window.setTimeout(function(){instance._assignEvents("delegateTarget",instance.options.delegateTarget)},0)}else{instance._assignEvents("delegateTarget",instance.options.delegateTarget)}instance.disabled=false;this._scrollContainerTo(0)},getFocused:function(){return this.$visibleItems.filter(".active")},reset:function(index){this.$container=AJS.$(this.options.containerSelector);this.items=AJS.$(this.options.itemSelector,this.$container).not(".no-suggestions");this.$visibleItems=this._computeVisibleItems();this.groups=AJS.$(this.options.groupSelector,this.$container);this.maxIndex=this.$visibleItems.length-1;this.index=this.$visibleItems[index]?index:0;this.focus(true)},_computeVisibleItems:function(){return this.items.not(".hidden, .disabled")},selectValue:function(value){var matchedItem=this.$container.find(this.options.itemSelector).filter(function(){return AJS.$(this).parent().data("descriptor").value()==value});if(!matchedItem.length){AJS.log("WARN: No List item found with Decriptor value '"+value+"'")}matchedItem.click()},_getLinkFromItem:function(item){var link;item=AJS.$(item);if(item.is("a")){link=item}else{link=item.find("a")}return link},_makeResultDiv:function(data,query){var $fixedContainer=AJS.$('<div class="aui-list-fixed">'),$resultsContainer=AJS.$('<div class="aui-list-scroll" tabindex="-1">'),instance=this,ungrouped=[];function appendUngrouped(){if(ungrouped.length>0){$resultsContainer.append(instance._generateUngroupedOptions(ungrouped,query));ungrouped=[]}}AJS.$.each(data,function(i,descriptor){var $container,$optgroup;if(descriptor instanceof AJS.GroupDescriptor){appendUngrouped();$container=(descriptor.placement()==="fixed")?$fixedContainer:$resultsContainer;$optgroup=instance._generateOptGroup(descriptor,query);$container.append($optgroup)}else{if(descriptor instanceof AJS.ItemDescriptor){ungrouped.push(descriptor)}}});appendUngrouped();if($fixedContainer.children().length===0){return $resultsContainer}return $fixedContainer.add($resultsContainer)},_addResultToContainer:function($result){if($result.not(".aui-list-fixed").find(this.options.itemSelector).length===0){var $scrollContainer=this.$container.find(".aui-list-scroll");if($scrollContainer.length==0){$scrollContainer=AJS.$('<div class="aui-list-scroll" tabindex="-1">').appendTo(this.$container)}$scrollContainer.html(this._render("noSuggestion"))}else{$result.find("ul:last").addClass("aui-last");this.$container.html($result)}},generateListFromJSON:function(data,query){this.suggestions=0;this.exactMatchIndex=-1;this.lastFocusedIndex=-1;this.lastQuery=query;var $result=this._makeResultDiv(data,query);this.$container.hide();this._addResultToContainer($result,query);this.$container.show();var indexToHighlight=this.exactMatchIndex>=0?this.exactMatchIndex:this.lastFocusedIndex;this.reset(indexToHighlight)},_generateOption:function(item,query,labelRegex){var replacementText;if(!item.highlighted()&&labelRegex&&labelRegex.test(item.label())){replacementText=item.label().replace(labelRegex,function(_,prefix,spaceOrParenthesis,match,suffix){var div=AJS.$("<div>");prefix&&div.append(AJS.$("<span>").text(prefix));div.append(AJS.$("<em>").text(match));suffix&&div.append(AJS.$("<span>").text(suffix));return div.html()})}if(this.exactMatchIndex<0){var itemValue=AJS.$.trim(item.label()).toLowerCase();if(!item.noExactMatch()&&itemValue===AJS.$.trim(query).toLowerCase()){this.exactMatchIndex=this.suggestions}else{if(this.lastFocusedIndex<0&&this.lastFocusedItemDescriptor&&itemValue===AJS.$.trim(this.lastFocusedItemDescriptor.label()).toLowerCase()){this.lastFocusedIndex=this.suggestions}}}this.suggestions++;return this._render("suggestion",item,replacementText)},_filterOptions:function(options,regexEscapedQuery,labelRegex){if(!regexEscapedQuery){return options}var filtered=[],keywordsRegex=new RegExp(AJS.format(".*{0}.*",regexEscapedQuery),"i");for(var i=0,len=options.length;i<len;i++){var item=this._filterOption(options[i],keywordsRegex,labelRegex);if(item){filtered.push(item)}}return filtered},_filterOption:function(item,keywordsRegex,labelRegex){var result;if(item.highlighted()){result=item}else{if(labelRegex.test(item.label())){result=item}else{if(item.keywords()){var matchedKeywords=[];var keywordString=""+item.keywords(),keywords=keywordString.split(",");for(var j=0;j<keywords.length;j++){var keyword=keywords[j];if(keywordsRegex.test(keyword)){matchedKeywords.push(keyword)}}if(matchedKeywords.length){item.labelSuffix(" "+matchedKeywords.join(", "));result=item}}}}return result},_addOptionsToContainer:function(options,$container,query,labelRegex){var instance=this,maxResult=this.options.maxInlineResultsDisplayed||this.MAX_RESULT_LIMIT,hasSuggestion=false,suggestions=[];for(var i=0,len=options.length;i<len;i++){var option=options[i];if(i<maxResult){var $suggestion=instance._generateOption(option,query,labelRegex);if($suggestion){hasSuggestion=true;suggestions.push($suggestion[0])}}else{suggestions.push(instance._render("tooManySuggestions",options.length-i)[0]);break}}$container.html(AJS.$(suggestions));return hasSuggestion},_filterAndAddOptions:function(options,container,query){var regexEscapedQuery,labelRegex;if(query){regexEscapedQuery=RegExp.escape(query);labelRegex=new RegExp(AJS.format(this.options.matchingStrategy,regexEscapedQuery),"i");options=this._filterOptions(options,regexEscapedQuery,labelRegex)}if(this.options.maxResultsDisplayedPerGroup){options=options.slice(0,this.options.maxResultsDisplayedPerGroup)}return this._addOptionsToContainer(options,container,query,labelRegex)},_generateUngroupedOptions:function(options,query){var $container=this._render("ungroupedSuggestions");var optionsAdded=this._filterAndAddOptions(options,$container,query);if(optionsAdded){return $container}},_generateOptGroup:function(groupDescriptor,query){var res=AJS.$(),optContainer=this._render("suggestionGroup",groupDescriptor),options=groupDescriptor.items(),optionsAdded;optionsAdded=this._filterAndAddOptions(options,optContainer,query);if(!optionsAdded){return }if(groupDescriptor.label()&&groupDescriptor.showLabel()!==false){res=res.add(this._render("suggestionGroupHeading",groupDescriptor))}if(groupDescriptor.footerText()){optContainer.append(this._render("suggestionsGroupFooter",groupDescriptor.footerText()))}else{if(groupDescriptor.footerHtml()){optContainer.append(groupDescriptor.footerHtml())}}if(groupDescriptor.actionBarHtml()){optContainer.prepend(groupDescriptor.actionBarHtml())}res=res.add(optContainer);return res},_events:{delegateTarget:{"aui:keydown":function(event){this._handleKeyEvent(event)}}},_renders:{suggestion:function(descriptor,replacementText){var idSuffix=descriptor.fieldText()||descriptor.label();var itemId=AJS.escapeHTML(AJS.$.trim(idSuffix.toLowerCase()).replace(/[\s\.]+/g,"-")),listElem=AJS.$('<li class="aui-list-item aui-list-item-li-'+itemId+'"><a class="aui-list-item-link"/></li>'),linkElem=listElem.children();if(descriptor.selected()){listElem.addClass("aui-checked")}if(this.options.hasLinks){linkElem.attr("href",descriptor.href()||"#")}if(descriptor.styleClass()){linkElem.addClass(descriptor.styleClass())}if(replacementText){linkElem.html(replacementText)}else{if(descriptor.html()){linkElem.html(descriptor.html())}else{linkElem.text(descriptor.label())}}if(descriptor.labelSuffix()){var suffixSpan=AJS.$("<span class='aui-item-suffix' />").text(descriptor.labelSuffix());linkElem.append(suffixSpan)}if(descriptor.icon()&&descriptor.icon()!=="none"){linkElem.addClass("aui-iconised-link").prepend('<img class="icon" src="'+descriptor.icon()+'" alt="" />')}if(descriptor.title()){linkElem.prop("title",descriptor.title())}else{linkElem.prop("title",linkElem.text())}listElem.data("descriptor",descriptor);return listElem},noSuggestion:function(){return AJS.$("<li class='no-suggestions'>"+"No Matches"+"</li>")},tooManySuggestions:function(suggestionCount){return AJS.$("<li class='no-suggestions'>"+AJS.format("{0} more options. Continue typing to refine further.",suggestionCount)+"</li>")},ungroupedSuggestions:function(){return AJS.$("<ul>")},suggestionGroup:function(descriptor){return AJS.$("<ul class='aui-list-section' />").attr("id",descriptor.label().replace(/\s/g,"-").toLowerCase()).addClass(descriptor.styleClass()).data("descriptor",descriptor)},suggestionGroupHeading:function(descriptor){var elem=AJS.$("<h5 />").text(descriptor.label()).addClass(descriptor.styleClass()).data("descriptor",descriptor);if(descriptor.description()){AJS.$("<span class='aui-section-description' />").text(" ("+descriptor.description()+")").appendTo(elem)}return elem},suggestionsGroupFooter:function(text){return AJS.$("<li class='aui-list-section-footer' />").text(text)}},_acceptSuggestion:function(item){if(!item instanceof AJS.$){item=AJS.$(item)}var linkNode=this._getLinkFromItem(item);if(linkNode.length){var event=new jQuery.Event("click");linkNode.trigger(event,[linkNode]);if(!event.isDefaultPrevented()){window.location.href=linkNode.attr("href")}}},getAllItems:function(){return this.$container.find(this.options.itemSelector)},_acceptUserInput:function($field){$field.triggerHandler("blur")},_handleSectionByKeyboard:function(e){var $focusedItem=this.getFocused();var $field=AJS.$(e.target);if($focusedItem.length===0){return }if(this._latestQuery&&AJS.$.trim($field.val())!==this._latestQuery){var inputWords=$field.val().toLowerCase().match(/\S+/g);if(inputWords){var html=this.lastFocusedItemDescriptor&&this.lastFocusedItemDescriptor.html();var $item=html?AJS.$("<div>").html(html):$focusedItem;var matches=[];$item.find("em,b").each(function(){var $match=AJS.$(this),nextText=AJS.$($match.attr("nextSibling")).text().toLowerCase().match(/^\S*/)[0];AJS.$.each($match.text().toLowerCase().match(/\S+/g),function(i,match){matches.push(match+nextText)})});for(var i=0;i<inputWords.length;i++){var word=inputWords[i];var n=word.length;var hasMatch=false;for(var j=0;j<matches.length;j++){if(matches[j].slice(0,n)===word){hasMatch=true;break}}if(!hasMatch){this._acceptUserInput($field);return }}}}this.scrollActiveItemIntoView();if(this.options.selectionHandler&&!this.options.selectionHandler.call(this,e)){return }this._acceptSuggestion($focusedItem)},_isValidInput:function(){return !this.disabled&&this.$container.is(":visible")},keys:{"Down":function(event){this.moveToNext();event.preventDefault()},"Up":function(event){this.moveToPrevious();event.preventDefault()},"Return":function(event){this._handleSectionByKeyboard(event);event.preventDefault()}}});
/* module-key = 'jira.webresources:list', location = '/includes/ajs/list/ListWithMessages.js' */
AJS.ListWithMessages=AJS.List.extend({_filterOption:function(item,keywordsRegex,labelRegex){if(item instanceof AJS.MessageDescriptor){return item}else{return this._super(item,keywordsRegex,labelRegex)}},_computeVisibleItems:function(){return this.items.not(".hidden, .disabled, .nofocus")},_generateOption:function(item,query,labelRegex){if(item instanceof AJS.MessageDescriptor){return this._render((item.useAUI()?"AUImessage":"message"),item)}else{return this._super(item,query,labelRegex)}}});AJS.ListWithMessages.prototype._renders.message=function(descriptor){var rawItemId=descriptor.messageID()||descriptor.fieldText()||descriptor.label(),itemId=AJS.escapeHTML(AJS.$.trim(rawItemId).toLowerCase()).replace(/[\s\.]+/g,"-"),listElem=AJS.$('<li class="aui-list-item nofocus aui-list-item-li-'+itemId+'">'),messageElem=AJS.$('<span class="aui-list-item-message" />');if(descriptor.styleClass()){messageElem.addClass(descriptor.styleClass())}messageElem.text(descriptor.label());listElem.append(messageElem).data("descriptor",descriptor);return listElem};AJS.ListWithMessages.prototype._renders.AUImessage=function(descriptor){var rawItemId=descriptor.messageID()||descriptor.fieldText()||descriptor.label(),itemId=AJS.escapeHTML(AJS.$.trim(rawItemId).toLowerCase()).replace(/[\s\.]+/g,"-"),listElem=AJS.$('<li class="aui-list-item nofocus aui-list-item-li-'+itemId+'">'),messageElem=AJS.$('<div class="aui-list-item-aui-message aui-message" />'),iconElem=AJS.$('<span class="aui-icon"/>'),contentElem=AJS.$("<p />");if(descriptor.styleClass()){messageElem.addClass(descriptor.styleClass());iconElem.addClass("icon-"+descriptor.styleClass())}else{iconElem.addClass("icon-generic")}contentElem.text(descriptor.label());messageElem.append(iconElem).append(contentElem);listElem.append(messageElem).data("descriptor",descriptor);return listElem};
/* module-key = 'jira.webresources:dropdown', location = '/includes/ajs/dropdown/Dropdown.js' */
AJS.Dropdown=AJS.Control.extend({CLASS_SIGNATURE:"AJS_DROPDOWN",init:function(options){var layerProperties,instance=this;if(!(options instanceof AJS.Dropdown.OptionsDescriptor)){this.options=new AJS.Dropdown.OptionsDescriptor(options)}else{this.options=options}layerProperties=this.options.allProperties();if(!layerProperties.offsetTarget){layerProperties.offsetTarget=layerProperties.trigger}this.layerController=new AJS.InlineLayer(this.options.allProperties());this.layerController._validateClickToClose=function(e){if(e.target===this.offsetTarget()[0]){return false}else{if(e.target===this.layer()[0]){return false}else{if(this.offsetTarget().has(e.target).length>0){return false}}}return true};this.listController=this.options.listController();this.listEnabler=function(e){instance.listController._handleKeyEvent(e)};this.layerController.onhide(function(){instance.hide()});this.layerController.onerror(function(){if(AJS.$.isFunction(instance.options.properties.onerror)){instance.options.properties.onerror(instance)}});this.layerController.contentChange(function(){instance.listController.removeAllItems();instance.layerController.layer().find("div > ul > li:visible:has(a)").each(function(){instance.listController.addItem(new AJS.Dropdown.ListItem({element:this,autoScroll:instance.options.autoScroll()}))});if(instance.options.focusFirstItem()){instance.listController.shiftFocus(0)}else{instance.listController.prepareForInput()}});this.trigger(this.options.trigger());this._applyIdToLayer()},show:function(){var instance=this;this.trigger().addClass(AJS.ACTIVE_CLASS);jQuery(this).trigger("showLayer");this.layerController.show();if(this.options.focusFirstItem()){this.listController.shiftFocus(0)}else{this.listController.prepareForInput()}},hide:function(){jQuery(this).trigger("hideLayer");this.trigger().removeClass(AJS.ACTIVE_CLASS);this.layerController.hide();this.listController.trigger("blur")},toggle:function(){if(this.layerController.isVisible()){this.hide()}else{this.show()}},content:function(content){if(content){this.layerController.content(content)}else{return this.layerController.content()}},trigger:function(trigger){if(trigger){if(this.options.trigger()){this._unassignEvents("trigger",this.options.trigger())}this.options.trigger(AJS.$(trigger));if(!this.layerController.offsetTarget()){this.layerController.offsetTarget(this.options.trigger())}this._assignEvents("trigger",this.options.trigger())}else{return this.options.trigger()}},_applyIdToLayer:function(){if(this.trigger().attr("id")){this.layerController.layer().attr("id",this.trigger().attr("id")+"_drop")}},_events:{trigger:{click:function(e){e.preventDefault();this.toggle()}}}});AJS.Dropdown.TRIGGER_SELECTOR=".aui-dropdown-trigger";AJS.Dropdown.CONTENT_SELECTOR=".aui-dropdown-content";AJS.DropDown=AJS.Dropdown;AJS.Dropdown.create=function(options){var dropdowns=[];if(options.content&&!options.trigger){options.content=AJS.$(options.content);AJS.$.each(options.content,function(){var instanceOptions=AJS.copyObject(options);instanceOptions.content=AJS.$(this);dropdowns.push(new AJS.Dropdown(instanceOptions))})}else{if(!options.content&&options.trigger){options.trigger=AJS.$(options.trigger);AJS.$.each(options.trigger,function(){var instanceOptions=AJS.copyObject(options);instanceOptions.trigger=AJS.$(this);dropdowns.push(new AJS.Dropdown(instanceOptions))})}else{if(options.content&&options.trigger){options.content=AJS.$(options.content);options.trigger=AJS.$(options.trigger);if(options.content.length===options.trigger.length){options.trigger.each(function(i){var instanceOptions=AJS.copyObject(options);instanceOptions.trigger=AJS.$(this);instanceOptions.content=options.content.eq(i);dropdowns.push(new AJS.Dropdown(instanceOptions))})}else{throw new Error("AJS.Dropdown.create: Expected the same number of content elements as trigger elements")}}}}return dropdowns};
/* module-key = 'jira.webresources:dropdown', location = '/includes/ajs/dropdown/Dropdown.OptionsDescriptor.js' */
AJS.Dropdown.OptionsDescriptor=AJS.Descriptor.extend({init:function(properties){this._super(properties);if(!this.content()&&!this.trigger()){throw new Error("AJS.Dropdown.OptionsDescriptor: expected either [content] or [trigger] to be defined.")}if(this.trigger()&&!this.content()){this.content(this.trigger().next(AJS.Dropdown.CONTENT_SELECTOR))}else{if(this.content()&&!this.trigger()){this.content(this.trigger().next(AJS.Dropdown.TRIGGER_SELECTOR))}}if(this.trigger()&&!this.content()){if(!this.ajaxOptions()){if(this.trigger().attr("href")){this.ajaxOptions(this.trigger().attr("href"))}}else{if(!this.ajaxOptions().url){this.ajaxOptions().url=this.trigger().attr("href")}}this.contentRetriever(new AJS.AjaxContentRetriever(this.ajaxOptions()))}else{if(this.content()){if(AJS.$.isFunction(this.content())){this.contentRetriever(new AJS.DeferredContentRetriever(this.content()))}else{this.contentRetriever(new AJS.DOMContentRetriever(this.content()))}}}if(!this.listController()){this.listController(new AJS.Dropdown.ListItemGroup())}},_getDefaultOptions:function(){return{trigger:null,ajaxOptions:null,autoScroll:true}},content:function(content){if(content){content=AJS.$(content);if(content.length){this.properties.content=content}}else{return this.properties.content}},trigger:function(trigger){if(trigger){this.properties.trigger=trigger}else{return this.properties.trigger}},contentRetriever:function(contentRetriever){if(contentRetriever){this.properties.contentRetriever=contentRetriever}else{return this.properties.contentRetriever}},listController:function(listController){if(listController){this.properties.listController=listController}else{return this.properties.listController}},focusFirstItem:function(focusFirstItem){if(focusFirstItem){this.properties.focusFirstItem=focusFirstItem}else{return this.properties.focusFirstItem}},autoScroll:function(autoScroll){if(typeof autoScroll!=="undefined"){this.properties.autoScroll=!!autoScroll}return this.properties.autoScroll},ajaxOptions:function(ajaxOptions){if(ajaxOptions){this.properties.ajaxOptions=ajaxOptions}else{return this.properties.ajaxOptions}},loop:function(loop){if(typeof loop!=="undefined"){this.properties.loop=loop}else{return this.properties.loop}},alignment:function(alignment){if(alignment){this.properties.alignment=alignment}else{return this.properties.alignment}},eventDelegator:function(eventDelegator){if(typeof eventDelegator!=="undefined"){this.properties.eventDelegator=eventDelegator}else{return this.properties.eventDelegator}}});
/* module-key = 'jira.webresources:dropdown', location = '/includes/ajs/dropdown/Dropdown.ListItem.js' */
AJS.Dropdown.ListItem=AJS.Control.extend({init:function(options){this._setOptions(options);this.$element=AJS.$(this.options.element);this.hasFocus=false;this._assignEvents("instance",this);this._assignEvents("element",this.$element)},_getDefaultOptions:function(){return{element:null,autoScroll:true,focusClass:AJS.ACTIVE_CLASS}},_events:{"instance":{"focus":function(event){this.hasFocus=true;this.$element.addClass(this.options.focusClass);if(!event.noscrolling){AJS.Dropdown.ListItem.MOTION_DETECTOR.unbind();this.isWaitingForMove=true;if(this.options.autoScroll){this.$element.scrollIntoView(AJS.Dropdown.ListItem.SCROLL_INTO_VIEW_OPTIONS)}}},"blur":function(){this.hasFocus=false;this.$element.removeClass(this.options.focusClass)},"accept":function(){var event=new jQuery.Event("click");var $target=this.$element.is("a[href]")?this.$element:this.$element.find("a[href]");$target.trigger(event);if(!event.isDefaultPrevented()){window.top.location=$target.attr("href")}}},"element":{"mousemove":function(){if(((this.isWaitingForMove&&AJS.Dropdown.ListItem.MOTION_DETECTOR.moved)&&!this.hasFocus)||!this.hasFocus){this.isWaitingForMove=false;this.trigger({type:"focus",noscrolling:true})}}}}});AJS.Dropdown.ListItem.MOTION_DETECTOR=new JIRA.Mouse.MotionDetector();AJS.Dropdown.ListItem.SCROLL_INTO_VIEW_OPTIONS={duration:100,callback:function(){AJS.Dropdown.ListItem.MOTION_DETECTOR.wait()}};
/* module-key = 'jira.webresources:dropdown', location = '/includes/ajs/dropdown/Dropdown.ListItemGroup.js' */
AJS.Dropdown.ListItemGroup=AJS.Group.extend({keys:{"Up":function(event){this.shiftFocus(-1);event.preventDefault()},"Down":function(event){this.shiftFocus(1);event.preventDefault()},"Return":function(event){this.items[this.index].trigger("accept");event.preventDefault()}}});
/* module-key = 'jira.webresources:dropdown', location = '/includes/jira/dropdown/Dropdown.js' */
JIRA.Dropdown=function(){var instances=[];return{addInstance:function(){instances.push(this)},hideInstances:function(){var that=this;jQuery(instances).each(function(){if(that!==this){this.hideDropdown()}})},getHash:function(){if(!this.hash){this.hash={container:this.dropdown,hide:this.hideDropdown,show:this.displayDropdown}}return this.hash},displayDropdown:function(){if(JIRA.Dropdown.current===this){return }this.hideInstances();JIRA.Dropdown.current=this;this.dropdown.css({display:"block"});this.displayed=true;var dd=this.dropdown;if(window.top.JIRA&&!window.top.JIRA.Dialog.current){setTimeout(function(){var win=jQuery(window);var minScrollTop=dd.offset().top+dd.prop("offsetHeight")-win.height()+10;if(win.scrollTop()<minScrollTop){jQuery("html,body").animate({scrollTop:minScrollTop},300,"linear")}},100)}},hideDropdown:function(){if(this.displayed===false){return }JIRA.Dropdown.current=null;this.dropdown.css({display:"none"});this.displayed=false},init:function(trigger,dropdown){var that=this;this.addInstance(this);this.dropdown=jQuery(dropdown);this.dropdown.css({display:"none"});jQuery(document).keydown(function(e){if(e.keyCode===9){that.hideDropdown()}});if(trigger.target){jQuery.aop.before(trigger,function(){if(!that.displayed){that.displayDropdown()}})}else{that.dropdown.css("top",jQuery(trigger).outerHeight()+"px");trigger.click(function(e){if(!that.displayed){that.displayDropdown();e.stopPropagation()}else{that.hideDropdown()}e.preventDefault()})}jQuery(document.body).click(function(){if(that.displayed){that.hideDropdown()}})}}}();JIRA.Dropdown.Standard=function(trigger,dropdown){var that=begetObject(JIRA.Dropdown);that.init(trigger,dropdown);return that};JIRA.Dropdown.AutoComplete=function(trigger,dropdown){var that=begetObject(JIRA.Dropdown);that.init=function(trigger,dropdown){this.addInstance(this);this.dropdown=jQuery(dropdown).click(function(e){e.stopPropagation()});this.dropdown.css({display:"none"});if(trigger.target){jQuery.aop.before(trigger,function(){if(!that.displayed){that.displayDropdown()}})}else{trigger.click(function(e){if(!that.displayed){that.displayDropdown();e.stopPropagation()}})}jQuery(document.body).click(function(){if(that.displayed){that.hideDropdown()}})};that.init(trigger,dropdown);return that};AJS.namespace("jira.widget.dropdown",null,JIRA.Dropdown);
/* module-key = 'jira.webresources:dropdown', location = '/includes/jira/dropdown/containDropdown.js' */
JIRA.containDropdown=function(dropdown,containerSelector,dynamic){function getDropdownOffset(){return dropdown.$.offset().top-jQuery(containerSelector).offset().top}var container,ddOffset,availableArea,shadowOffset=25;if(dropdown.$.parents(containerSelector).length!==-1){container=jQuery(containerSelector),ddOffset=getDropdownOffset(),shadowOffset=30,availableArea=container.outerHeight()-ddOffset-shadowOffset;if(availableArea<=parseInt(dropdown.$.prop("scrollHeight"),10)){JIRA.containDropdown.containHeight(dropdown,availableArea)}else{if(dynamic){JIRA.containDropdown.releaseContainment(dropdown)}}dropdown.reset()}};JIRA.containDropdown.containHeight=function(dropdown,availableArea){dropdown.$.css({height:availableArea});if(dropdown.$.css("overflowY")!=="scroll"){dropdown.$.css({width:15+dropdown.$.prop("scrollWidth"),overflowY:"scroll",overflowX:"hidden"})}};JIRA.containDropdown.releaseContainment=function(dropdown){dropdown.$.css({height:"",width:"",overflowY:"",overflowX:""})};AJS.namespace("AJS.containDropdown",null,JIRA.containDropdown);
/* module-key = 'jira.webresources:dropdown', location = '/includes/jquery/plugins/linkedmenu/linkedMenu.js' */
AJS.$.deactivateLinkedMenu=function(){};AJS.$.linkedMenuInstances=[];AJS.$.fn.linkedMenu=function(opts){var idx,that=this,onDisable,enabled=false,focusElement=function(elem){elem=AJS.$(elem);that.blur();elem.trigger("click","focus","mousedown")},keyHandler=function(e){var targ;if(e.keyCode===37||e.keyCode===39||e.keyCode===27){if(e.keyCode===37){targ=idx-1;if(idx-1>=0){if(isNotActive(that[targ])){idx=targ;focusElement(that[idx])}}else{targ=that.length-1;if(isNotActive(that[targ])){idx=targ;focusElement(that[idx])}}}else{if(e.keyCode===39){targ=idx+1;if(targ<that.length){if(isNotActive(that[targ])){idx=targ;focusElement(that[idx])}}else{targ=0;if(isNotActive(that[targ])){idx=targ;focusElement(that[idx])}}}else{that.disableLinkedMenu(e)}}e.preventDefault()}},isNotActive=function(elem){if(elem!==that[idx]){return true}},focusBridge=function(){if(isNotActive(this)){idx=AJS.$.inArray(this,that);focusElement(this)}},reflectionBridge=function(){var targ=AJS.$.inArray(this,AJS.$(opts.reflectFocus));if(isNotActive(that[targ])){idx=targ;focusElement(that[idx])}},enable=function(){var elem,clss;if(!enabled){AJS.$.currentLinkedMenu=that;if(opts.onFocusRemoveClass){elem=AJS.$(opts.onFocusRemoveClass);clss=opts.onFocusRemoveClass.match(/\.([a-z]*)$/);if(clss&&clss[1]&&elem.length>0){AJS.$(opts.onFocusRemoveClass).removeClass(clss[1]);onDisable=function(){AJS.$(elem).addClass(clss[1])}}}enabled=true;idx=AJS.$.inArray(this,that);that.mouseover(focusBridge);if(AJS.$.browser.mozilla){AJS.$(document).keypress(keyHandler)}else{AJS.$(document).keydown(keyHandler)}AJS.$(document).mousedown(that.disableLinkedMenu);if(opts.reflectFocus){AJS.$(opts.reflectFocus).mouseover(reflectionBridge)}}};that.disableLinkedMenu=function(e){AJS.$(document).unbind("keypress",keyHandler);AJS.$(document).unbind("keydown",keyHandler);that.unbind("mouseover",focusBridge);AJS.$(document).unbind("mousedown",arguments.callee);if(opts.reflectFocus){AJS.$(opts.reflectFocus).unbind("mouseover",reflectionBridge)}if(onDisable){onDisable()}that.blur();delete AJS.$.currentLinkedMenu;window.setTimeout(function(){enabled=false},200)};opts=opts||{};focusElement=opts.focusElement||focusElement;that.click(enable);return that};
/* module-key = 'jira.webresources:dropdown', location = '/includes/jquery/plugins/scrollintoview/scrollIntoView.js' */
(function(){var jQuery=window.top.jQuery||window.jQuery;function getNewScrollTop(options){options=options||{};options.marginTop=options.marginTop||options.margin||0;options.marginBottom=options.marginBottom||options.margin||0;var $window=jQuery(window.top);var $stalker=jQuery("#stalker");var scrollTop=$window.scrollTop();var scrollHeight=$window.height();var offsetTop=Math.max(0,getPageY(this[0])-options.marginTop);var offsetHeight=options.marginTop+this.outerHeight()+options.marginBottom;var newScrollTop=scrollTop;if(newScrollTop+scrollHeight<offsetTop+offsetHeight){newScrollTop=offsetTop+offsetHeight-scrollHeight}if($stalker.length!==0){var offsetParent=this[0];var positionedParent=null;do{if(jQuery(offsetParent).css("position")==="absolute"){positionedParent=offsetParent}}while(offsetParent=offsetParent.offsetParent);if(positionedParent&&getPageY(positionedParent)>getPageY($stalker[0])){offsetTop-=$stalker.outerHeight()}}if(newScrollTop>offsetTop){newScrollTop=offsetTop}return newScrollTop}function getPageY(element){var currElement=element,offsetTop=0;do{offsetTop+=currElement.offsetTop}while(currElement=currElement.offsetParent);currElement=element;do{if(currElement&&currElement.scrollTop){offsetTop-=currElement.scrollTop}currElement=currElement.parentNode}while(currElement&&currElement!=document.body);return offsetTop}window.jQuery.fn.scrollIntoView=function(options){if(this.length===0){return this}var fixedParent=this.hasFixedParent();if(!fixedParent){options=options||{};if(!this.is(":visible")&&options.callback){options.callback();return this}var scrollTop=jQuery(window.top).scrollTop();var newScrollTop=getNewScrollTop.call(this,options);var $stalker=jQuery("#stalker");if(newScrollTop!==scrollTop){var $target=this;var $document=jQuery(window.top.document);$document.trigger("moveToStarted",$target);if(options.duration){$document.find("body, html").stop(true).animate({scrollTop:newScrollTop},options.duration,"swing",function(){if(options.callback){options.callback()}$document.trigger("moveToFinished",$target);$stalker.trigger("positionChanged")})}else{$document.find("body, html").prop("scrollTop",newScrollTop)}}else{if(options.callback){options.callback()}}}else{var $elementToScrollTo=jQuery(this),$fixedParent=jQuery(fixedParent),fixedParentHeight=$fixedParent.outerHeight(),fixedParentScrollTop=$fixedParent.scrollTop(),fixedParentScrollBottom=fixedParentScrollTop+fixedParentHeight,elementPosition=$elementToScrollTo.position(),elementPositionBottom=elementPosition.top+$elementToScrollTo.height();var below=elementPositionBottom+fixedParentScrollTop>fixedParentScrollBottom,above=elementPosition.top<0;if(below){$fixedParent.scrollTop(fixedParentScrollTop+elementPositionBottom-fixedParentHeight)}else{if(above){$fixedParent.scrollTop(fixedParentScrollTop+elementPosition.top)}}}return this};jQuery.fn.isInView=function(options){if(this.length>0&&!this.hasFixedParent()){options=options||{};var scrollTop=jQuery(window.top).scrollTop();var newScrollTop=getNewScrollTop.call(this,options);return newScrollTop===scrollTop}return this}})();
/* module-key = 'jira.webresources:issue-table', location = '/includes/jira/fragments/issueActionsFragment.js' */
AJS.namespace("JIRA.FRAGMENTS");JIRA.FRAGMENTS.issueActionsFragment=function(){function addIssueIdToReturnUrl(issueId){var matchSelectedIssueId=/selectedIssueId=[0-9]*/g;if(self!=top){return encodeURIComponent(window.top.location.href)}var url=window.location.href,newUrl=url;if(/selectedIssueId=[0-9]*/.test(url)){newUrl=url.replace(matchSelectedIssueId,"selectedIssueId="+issueId)}else{if(url.lastIndexOf("?")>=0){newUrl=url+"&"}else{newUrl=url+"?"}newUrl=newUrl+"selectedIssueId="+issueId}return encodeURIComponent(newUrl)}return function(json){var returnURL=addIssueIdToReturnUrl(json.id);var htmlParts=['<div class="aui-list"><ul class="aui-list-section"><li class="aui-list-item"><a class="aui-list-item-link issue-link" data-issue-key="',json.key,'" href="',contextPath,"/browse/",json.key,'">',htmlEscape(json.viewIssue),"</a></li></ul>"];var hasActions=json.actions&&json.actions.length>0;var hasOperations=json.operations&&json.operations.length>0;if(hasActions){htmlParts.push(hasOperations?'<ul class="aui-list-section">':'<ul class="aui-list-section aui-last">');var URL_A=contextPath+"/secure/WorkflowUIDispatcher.jspa?id="+json.id+"&amp;action=";var URL_B="&amp;atl_token="+json.atlToken+"&amp;returnUrl="+returnURL;AJS.$.each(json.actions,function(){htmlParts.push('<li class="aui-list-item"><a href="',URL_A,this.action,URL_B,'" rel="',this.action,'" class="aui-list-item-link issueaction-workflow-transition" data-issueId="'+json.id+'" data-issueKey="'+json.key+'">',htmlEscape(this.name),"</a></li>")});htmlParts.push("</ul>")}if(hasOperations){htmlParts.push('<ul class="aui-list-section aui-last">');URL_A="&amp;returnUrl="+returnURL;URL_B="&amp;atl_token="+json.atlToken;AJS.$.each(json.operations,function(){htmlParts.push('<li class="aui-list-item"><a href="',this.url,URL_A,URL_B,'" class="aui-list-item-link ',this.styleClass,'" data-issueId="'+json.id+'" data-issueKey="'+json.key+'">',htmlEscape(this.name),"</a></li>")});htmlParts.push("</ul>")}htmlParts.push("</div>");return AJS.$(htmlParts.join(""))}}();
/* module-key = 'jira.webresources:issue-table', location = '/includes/jquery/plugins/dragtable/jquery.dragtable.js' */
/*
 * dragtable
 *
 * @Version 2.0.4
 *
 * Copyright (c) 2010, Andres Koetter akottr@gmail.com
 * Dual licensed under the MIT (MIT-LICENSE.txt)
 * and GPL (GPL-LICENSE.txt) licenses.
 *
 * Inspired by the the dragtable from Dan Vanderkam (danvk.org/dragtable/)
 * Thanks to the jquery and jqueryui comitters
 *
 * Any comment, bug report, feature-request is welcome
 * Feel free to contact me.
 */
!function($){$.widget("akottr.dragtable",{options:{revert:true,dragHandle:".table-handle",maxMovingRows:40,excludeFooter:false,onlyHeaderThreshold:100,dragaccept:null,persistState:null,restoreState:null,clickDelay:10,containment:"parent",cursor:"move",cursorAt:false,distance:0,tolerance:"pointer",axis:"x",beforeStart:$.noop,beforeMoving:$.noop,beforeReorganize:$.noop,beforeStop:$.noop},originalTable:{el:null,selectedHandle:null,sortOrder:null,startIndex:0,endIndex:0},sortableTable:{el:$(),selectedHandle:$(),movingRow:$()},persistState:function(){var _this=this;this.originalTable.el.find("th").each(function(i){if(this.id!=""){_this.originalTable.sortOrder[this.id]=i}});$.ajax({url:this.options.persistState,data:this.originalTable.sortOrder})},_restoreState:function(persistObj){for(n in persistObj){this.originalTable.startIndex=$("#"+n).closest("th").prevAll().size()+1;this.originalTable.endIndex=parseInt(persistObj[n]+1);this._bubbleCols()}},_bubbleCols:function(){var from=this.originalTable.startIndex;var to=this.originalTable.endIndex;var thtb=this.originalTable.el.children();if(this.options.excludeFooter){var thtb=thtb.not("tfoot")}if(from<to){for(var i=from;i<to;i++){var row1=thtb.find("> tr > td:nth-child("+i+")").add(thtb.find("> tr > th:nth-child("+i+")"));var row2=thtb.find("> tr > td:nth-child("+(i+1)+")").add(thtb.find("> tr > th:nth-child("+(i+1)+")"));for(var j=0;j<row1.length;j++){swapNodes(row1[j],row2[j])}}}else{for(var i=from;i>to;i--){var row1=thtb.find("> tr > td:nth-child("+i+")").add(thtb.find("> tr > th:nth-child("+i+")"));var row2=thtb.find("> tr > td:nth-child("+(i-1)+")").add(thtb.find("> tr > th:nth-child("+(i-1)+")"));for(var j=0;j<row1.length;j++){swapNodes(row1[j],row2[j])}}}},_rearrangeTableBackroundProcessing:function(){var _this=this;return function(){_this._bubbleCols();_this.options.beforeStop(this.originalTable);_this.sortableTable.el.remove();restoreTextSelection();if(_this.options.persistState!==null){$.isFunction(_this.options.persistState)?_this.options.persistState(_this.originalTable):_this.persistState()}}},_rearrangeTable:function(){var _this=this;return function(){_this.originalTable.selectedHandle.removeClass("dragtable-handle-selected");_this.sortableTable.el.sortable("disable");_this.sortableTable.el.addClass("dragtable-disabled");_this.options.beforeReorganize(_this.originalTable,_this.sortableTable);_this.originalTable.endIndex=_this.sortableTable.movingRow.prevAll().size()+1;setTimeout(_this._rearrangeTableBackroundProcessing(),50)}},_generateSortable:function(e){!e.cancelBubble&&(e.cancelBubble=true);var _this=this;var attrs=this.originalTable.el[0].attributes;var attrsString="";for(var i=0;i<attrs.length;i++){if(attrs[i].nodeValue&&attrs[i].nodeName!="id"&&attrs[i].nodeName!="width"){attrsString+=attrs[i].nodeName+'="'+attrs[i].nodeValue+'" '}}var rowAttrsArr=[];var heightArr=[];this.originalTable.el.find("tr").slice(0,this.options.maxMovingRows).each(function(i,v){var attrs=this.attributes;var attrsString="";for(var j=0;j<attrs.length;j++){if(attrs[j].nodeValue&&attrs[j].nodeName!="id"){attrsString+=" "+attrs[j].nodeName+'="'+attrs[j].nodeValue+'"'}}rowAttrsArr.push(attrsString);heightArr.push($(this).height())});var widthArr=[];var totalWidth=0;var thtb=_this.originalTable.el.children();if(this.options.excludeFooter){var thtb=thtb.not("tfoot")}thtb.find("> tr > th").each(function(i,v){totalWidth+=$(this).outerWidth()+2;widthArr.push($(this).width())});var sortableHtml='<ul class="dragtable-sortable" style="position:absolute; width:'+totalWidth+'px;">';thtb.find("> tr > th").each(function(i,v){sortableHtml+="<li>";sortableHtml+='<table class="issue-table" '+attrsString+">";var row=thtb.find("> tr > th:nth-child("+(i+1)+")");if(_this.options.maxMovingRows>1){row=row.add(thtb.find("> tr > td:nth-child("+(i+1)+")").slice(0,_this.options.maxMovingRows-1))}row.each(function(j){var row_content=$(this).clone().wrap("<div></div>").parent().html();if(row_content.toLowerCase().indexOf("<th")===0){sortableHtml+="<thead>"}sortableHtml+="<tr "+rowAttrsArr[j]+'" style="height:'+heightArr[j]+'px;">';sortableHtml+=row_content;if(row_content.toLowerCase().indexOf("<th")===0){sortableHtml+="</thead>"}sortableHtml+="</tr>"});sortableHtml+="</table>";sortableHtml+="</li>"});sortableHtml+="</ul>";this.sortableTable.el=this.originalTable.el.before(sortableHtml).prev();this.sortableTable.el.find("th").each(function(i,v){var _this=$(this);if(widthArr[i]>_this.width()){_this.css({"width":widthArr[i]})}});this.sortableTable.selectedHandle=this.sortableTable.el.find("th .dragtable-handle-selected");var items=!this.options.dragaccept?"li":"li:has("+this.options.dragaccept+")";this.sortableTable.el.sortable({items:items,stop:this._rearrangeTable(),revert:this.options.revert,tolerance:this.options.tolerance,containment:this.options.containment,cursor:this.options.cursor,cursorAt:this.options.cursorAt,distance:this.options.distance,axis:this.options.axis});this.originalTable.startIndex=$(e.target).closest("th").prevAll().size()+1;this.options.beforeMoving(this.originalTable,this.sortableTable);this.sortableTable.movingRow=this.sortableTable.el.find("li:nth-child("+this.originalTable.startIndex+")");disableTextSelection();this.sortableTable.movingRow.trigger($.extend($.Event(e.type),{which:1,clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY,screenX:e.screenX,screenY:e.screenY}));this.sortableTable.el.find(".ui-sortable-placeholder").html('<div class="outer" style="height:100%;"><div class="inner" style="height:100%;"></div></div>')},bindTo:{},_create:function(){this.originalTable={el:this.element,selectedHandle:$(),sortOrder:{},startIndex:0,endIndex:0};this.bindTo=this.originalTable.el.find("th");if(this.options.dragaccept){this.bindTo=this.bindTo.filter(this.options.dragaccept)}if(this.bindTo.find(this.options.dragHandle).size()>0){this.bindTo=this.bindTo.find(this.options.dragHandle)}if(this.options.restoreState!==null){$.isFunction(this.options.restoreState)?this.options.restoreState(this.originalTable):this._restoreState(this.options.restoreState)}var _this=this;this.bindTo.mousedown(function(evt){clearTimeout(this.downTimer);this.downTimer=setTimeout(function(){_this.originalTable.selectedHandle=$(this);_this.originalTable.selectedHandle.addClass("dragtable-handle-selected");_this.options.beforeStart(this.originalTable);_this._generateSortable(evt)},_this.options.clickDelay)}).mouseup(function(evt){clearTimeout(this.downTimer)})},destroy:function(){this.bindTo.unbind("mousedown");$.Widget.prototype.destroy.apply(this,arguments)}});var body_onselectstart_save=$(document.body).attr("onselectstart"),body_unselectable_save=$(document.body).attr("unselectable");function disableTextSelection(){var $style=$('<style id="__dragtable_disable_text_selection__" type="text/css">body { -ms-user-select:none;-moz-user-select:-moz-none;-khtml-user-select:none;-webkit-user-select:none;user-select:none; }</style>');$(document.head).append($style);$(document.body).attr("onselectstart","return false;").attr("unselectable","on");if(window.getSelection){window.getSelection().removeAllRanges()}else{document.selection.empty()}}function restoreTextSelection(){$("#__dragtable_disable_text_selection__").remove();if(body_onselectstart_save){$(document.body).attr("onselectstart",body_onselectstart_save)}else{$(document.body).removeAttr("onselectstart")}if(body_unselectable_save){$(document.body).attr("unselectable",body_unselectable_save)}else{$(document.body).removeAttr("unselectable")}}function swapNodes(a,b){var aparent=a.parentNode;var asibling=a.nextSibling===b?a:a.nextSibling;b.parentNode.insertBefore(a,b);aparent.insertBefore(b,asibling)}}(jQuery);
/* module-key = 'jira.webresources:dropdown-select', location = '/includes/ajs/select/DropdownSelect.js' */
AJS.DropdownSelect=AJS.Control.extend({init:function(options){var instance=this;this.model=new AJS.SelectModel(options);this.model.$element.hide();this._createFurniture();this.dropdownController=AJS.InlineLayer.create({alignment:AJS.LEFT,width:200,hideOnScroll:".issue-container",content:AJS.$(".aui-list",this.$container)});this.dropdownController.layer().addClass("select-menu");this.listController=new AJS.List({containerSelector:AJS.$(".aui-list",this.$container),groupSelector:"ul.opt-group",itemSelector:"li:not(.no-suggestions)",selectionHandler:function(e){instance._selectionHandler(this.getFocused(),e);e.preventDefault()}});this._assignEventsToFurniture()},show:function(){this.listController.generateListFromJSON(this.model.getAllDescriptors());this.dropdownController.show();this.listController.index=0;this.listController.focus();this.listController.enable()},_assignEventsToFurniture:function(){this._assignEvents("trigger",this.$trigger)},_createFurniture:function(){var id=this.model.$element.attr("id");this.$container=this._render("container",id);this.$trigger=this.model.$element.prev("a").appendTo(this.$container);this.$container.append(this._render("suggestionsContainer",id));this.$container.insertBefore(this.model.$element)},_renders:{container:function(idPrefix){return AJS.$('<div class="select-menu" id="'+idPrefix+'-multi-select">')},suggestionsContainer:function(idPrefix){return AJS.$('<div class="aui-list aui-list-checked" id="'+idPrefix+'-suggestions" tabindex="-1"></div>')}},_selectionHandler:function(selected){var instance=this,intCount=0;this.model.setSelected(selected.data("descriptor"));this.dropdownController.content().find(".aui-checked").removeClass(".aui-checked");selected.addClass(".aui-checked");var myInterval=window.setInterval(function(){intCount++;selected.toggleClass(".aui-checking");if(intCount>2){clearInterval(myInterval);instance.dropdownController.hide()}},80)},_events:{trigger:{click:function(e){this.show();e.preventDefault();e.stopPropagation()}}}});AJS.namespace("AJS.SelectMenu",null,AJS.DropdownSelect);
/* module-key = 'jira.webresources:dropdown-select', location = '/includes/ajs/select/SecurityLevelSelect.js' */
AJS.SecurityLevelSelect=AJS.DropdownSelect.extend({_createFurniture:function(){AJS.populateParameters();this._super()},_selectionHandler:function(selected){var descriptor=selected.data("descriptor");if(descriptor&&!descriptor.value()){this.$trigger.find("span:first").removeClass("icon-locked").addClass("icon-unlocked");this.$container.parent().find(".current-level").text("Viewable by All Users")}else{this.$trigger.find("span:first").removeClass("icon-unlocked").addClass("icon-locked");var htmlEscapedLabel=AJS.$("<div/>").text(descriptor.label()).html();this.$container.parent().find(".current-level").html(AJS.format("Restricted to \u003cspan class=\'redText\'>{0}\u003c\/span>",htmlEscapedLabel))}this._super(selected)},_handleDownKey:function(e){if(e.keyCode===jQuery.ui.keyCode.DOWN&&!this.dropdownController.isVisible()){e.preventDefault();e.stopPropagation();this.show()}},_events:{trigger:{keydown:function(e){this._handleDownKey(e)},keypress:function(e){this._handleDownKey(e)}}}});AJS.namespace("AJS.SecurityLevel",null,AJS.SecurityLevelSelect);
/* module-key = 'jira.webresources:select-pickers', location = '/includes/ajs/select/QueryableSelect.soy' */
// This file was automatically generated from QueryableSelect.soy.
// Please don't edit this file by hand.

if (typeof AJS == 'undefined') { var AJS = {}; }
if (typeof AJS.Templates == 'undefined') { AJS.Templates = {}; }


AJS.Templates.queryableSelect = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<select ', (opt_data.name) ? 'name="' + soy.$$escapeHtml(opt_data.name) + '"' : '', ' ', (opt_data.id) ? 'id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' multiple="multiple">');
  var descriptorList16 = opt_data.descriptors;
  var descriptorListLen16 = descriptorList16.length;
  for (var descriptorIndex16 = 0; descriptorIndex16 < descriptorListLen16; descriptorIndex16++) {
    var descriptorData16 = descriptorList16[descriptorIndex16];
    if (descriptorData16.properties.items) {
      output.append('<optgroup label="', soy.$$escapeHtml(descriptorData16.properties.label), '">');
      var optionList22 = descriptorData16.properties.items;
      var optionListLen22 = optionList22.length;
      for (var optionIndex22 = 0; optionIndex22 < optionListLen22; optionIndex22++) {
        var optionData22 = optionList22[optionIndex22];
        AJS.Templates.option({option: optionData22}, output);
      }
      output.append('</optgroup>');
    } else {
      AJS.Templates.option({option: descriptorData16}, output);
    }
  }
  output.append('</select>');
  return opt_sb ? '' : output.toString();
};


AJS.Templates.option = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<option ', (opt_data.option.properties.title) ? 'title="' + soy.$$escapeHtml(opt_data.option.properties.title) + '"' : '', ' ', (opt_data.option.properties.meta) ? 'data-meta="' + soy.$$escapeHtml(opt_data.option.properties.meta) + '"' : '', ' ', (opt_data.option.properties.selected) ? 'selected="selected"' : '', ' value="', soy.$$escapeHtml(opt_data.option.properties.value), '">', soy.$$escapeHtml(opt_data.option.properties.label), '</option>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'jira.webresources:select-pickers', location = '/includes/ajs/select/SelectHelper.js' */
AJS.SelectHelper={updateFreeInputVal:function(){if(this.options.submitInputVal){this.model.updateFreeInput(this.$field.val())}},removeFreeInputVal:function(){if(this.options.submitInputVal){this.model.removeFreeInputVal()}}};
/* module-key = 'jira.webresources:select-pickers', location = '/includes/ajs/select/SelectModel.js' */
AJS.SelectModel=AJS.Control.extend({init:function(options){var instance=this;if(options.element){options.element=AJS.$(options.element)}else{options.element=AJS.$(options)}this._setOptions(options);this.$element=this.options.element.hide();this.type=this.$element.attr("multiple")?"multiple":"single";this.id=this.$element.attr("id")||this.$element.attr("name");if(this.type==="single"){this.$element.attr("multiple","multiple")}this.$element.bind("reset",function(){instance._parseDescriptors()});this._parseDescriptors()},_getFreeInputEl:function(){return this.$element.find(".free-input")},removeFreeInputVal:function(){this._getFreeInputEl().remove()},updateFreeInput:function(val){var $freeInput=this._getFreeInputEl();val=AJS.$.trim(val);if(val){if(!$freeInput.length){$freeInput=AJS.$("<option class='free-input' />").appendTo(this.$element)}$freeInput.attr({"value":val,"selected":"selected"})}else{$freeInput.remove()}},_getDefaultOptions:function(){return{}},getSelectedValues:function(){var selectedVals=[],selected=this.getDisplayableSelectedDescriptors();for(var i=0;i<selected.length;i++){selectedVals.push(selected[i].value())}return selectedVals},setSelected:function(descriptor){var instance=this,selectedItem=false,changed=false,$toSelect=this.$element.find("option").not(this._getExclusions()).filter(function(){return this.value===descriptor.value()});if(this.type==="single"){if(this.getValue()===descriptor.value()){return changed}$toSelect=$toSelect.first();this.$element.find("option:selected").not(this._getExclusions()).each(function(i,option){var currDescriptor=AJS.$(this).data("descriptor");if($toSelect[0]!==option){instance.setUnSelected(currDescriptor)}})}$toSelect.each(function(){var $this=AJS.$(this);selectedItem=true;changed=!$this.is(":selected");$this.attr("selected","selected").data("descriptor").selected(true)});if(!selectedItem){descriptor.selected(true);descriptor.removeOnUnSelect(true);var newOption=this._render("option",descriptor);newOption.attr("selected","selected");this.$element.append(newOption);changed=true}descriptor.highlighted(false);if(changed){this.$element.trigger("change",descriptor)}return changed},setAllSelected:function(){var instance=this;AJS.$(this.getDisplayableUnSelectedDescriptors()).each(function(){instance.setSelected(this)})},setAllUnSelected:function(){var instance=this;AJS.$(this.getDisplayableSelectedDescriptors()).each(function(){instance.setUnSelected(this)})},setUnSelected:function(descriptor){var instance=this,value=descriptor.value();this.$element.find("option:selected").not(this._getExclusions()).filter(function(){return AJS.$(this).attr("value")===value}).each(function(){var $this=AJS.$(this);$this.data("descriptor").selected(false);if(instance.options.removeOnUnSelect||$this.data("descriptor").removeOnUnSelect()){$this.remove()}else{$this.removeAttr("selected")}})},remove:function(descriptor){if(descriptor&&descriptor.model()){descriptor.model().remove()}},getDescriptor:function(value){var returnDescriptor;value=AJS.$.trim(value.toLowerCase());AJS.$.each(this.getAllDescriptors(false),function(e,descriptor){if(value===AJS.$.trim(descriptor.label().toLowerCase())||value===AJS.$.trim(descriptor.value().toLowerCase())){returnDescriptor=descriptor;return false}});return returnDescriptor},_parseOption:function(optionElem){var descriptor,icon,fallbackIcon;optionElem=AJS.$(optionElem);if(this.options.removeNullOptions&&this._hasNullValue(optionElem)){optionElem.remove();return null}icon=optionElem.attr("data-icon");fallbackIcon=optionElem.attr("data-fallback-icon");descriptor=new AJS.ItemDescriptor({styleClass:optionElem.prop("className"),value:optionElem.val(),invalid:optionElem.hasClass("invalid_sel"),fieldText:optionElem.attr("data-field-text"),title:optionElem.attr("title"),meta:optionElem.data("meta"),label:optionElem.attr("data-field-label")||AJS.$.trim(optionElem.text()),icon:icon?icon:optionElem.css("backgroundImage").replace(/url\(['"]?(.*?)['"]?\)/,"$1"),fallbackIcon:fallbackIcon?fallbackIcon:"none",selected:optionElem.prop("selected"),removeOnUnSelect:!!optionElem.data("remove-on-unselect"),model:optionElem});optionElem.data("descriptor",descriptor);return descriptor},_hasNullValue:function(optionElement){return optionElement.val()<0},_parseDescriptors:function(){var instance=this,items=this.$element.children();function parseOptGroup(optionGroup){var properties={label:optionGroup.attr("label"),placement:optionGroup.attr("data-placement"),footerText:optionGroup.attr("data-footer-text"),styleClass:optionGroup.prop("className"),model:optionGroup,items:retrieveAvailableOptions(optionGroup)};var weight=optionGroup.data("weight");if(weight){properties.weight=+weight}optionGroup.data("descriptor",new AJS.GroupDescriptor(properties))}function retrieveAvailableOptions(parent){var availableOptionElems=AJS.$("option",parent),arr=[];AJS.$.each(availableOptionElems,function(){arr.push(instance._parseOption(this))});return arr}items.each(function(i){var item=items.eq(i);if(item.is("optgroup")){parseOptGroup(item)}else{if(item.is("option")){if(item.attr("data-placeholder")){instance.placeholder=item.text();item.remove()}else{instance._parseOption(item)}}}})},getPlaceholder:function(){return this.placeholder},_getExclusions:function(){return".free-input"},getValue:function(){if(this.type==="single"){return this.$element.val()&&this.$element.val()[0]}else{return this.$element.val()}},getDisplayableSelectedDescriptors:function(){var descriptors=[];this.$element.find("option:selected").not(this._getExclusions()).each(function(){descriptors.push(AJS.$.data(this,"descriptor"))});return descriptors},getDisplayableUnSelectedDescriptors:function(){var descriptors=[];this.$element.find("option").not(":selected").not(this._getExclusions()).each(function(){descriptors.push(AJS.$.data(this,"descriptor"))});return descriptors},getAllDescriptors:function(showGroups){var properties,descriptors=[];this.$element.children().each(function(){var descriptor,elem=AJS.$(this);if(elem.is("option")){if(elem.data("descriptor")){descriptors.push(elem.data("descriptor"))}}else{if(elem.is("optgroup")){if(showGroups!==false){properties=AJS.copyObject(elem.data("descriptor").allProperties(),false);properties.items=[];descriptor=new AJS.GroupDescriptor(properties);descriptors.push(descriptor)}elem.children("option").each(function(){var elem=AJS.$(this);var itemDescriptor=elem.data("descriptor");if(itemDescriptor){if(showGroups!==false){descriptor.addItem(itemDescriptor)}else{descriptors.push(itemDescriptor)}}})}}});return descriptors},clearUnSelected:function(){this.$element.find("option:not(:selected)").not(this._getExclusions()).remove()},getUnSelectedDescriptors:function(){var instance=this,descriptors=[],selectedValues={},addedValues={};function isValid(descriptor){var descriptorVal=descriptor.value().toLowerCase();if(!selectedValues[descriptorVal]&&(!addedValues[descriptorVal]||descriptor.allowDuplicate()!==false)){addedValues[descriptorVal]=true;return true}return false}var selectedDescriptors=this.getDisplayableSelectedDescriptors();AJS.$.each(selectedDescriptors,function(i,descriptor){selectedValues[descriptor.value().toLowerCase()]=true});var selectChildren=this.$element.children();selectChildren.each(function(){var descriptor,properties,elem=AJS.$(this);if(elem.is("option")&&!this.selected){descriptor=AJS.$.data(this,"descriptor");if(isValid(descriptor)){descriptors.push(descriptor)}}else{if(elem.is("optgroup")){properties=AJS.copyObject(elem.data("descriptor").allProperties(),false);properties.items=[];descriptor=new AJS.GroupDescriptor(properties);descriptors.push(descriptor);elem.find("option").not(instance._getExclusions()).each(function(option){if(option.selected){return }var itemDescriptor=AJS.$.data(this,"descriptor");if(isValid(itemDescriptor)){descriptor.addItem(itemDescriptor)}})}}});return descriptors},_renders:{option:function(descriptor){var label=descriptor.label();var text=descriptor.fieldText()||label;var option=new Option(text,descriptor.value());var $option=AJS.$(option);var iconUrl=descriptor.icon();option.title=descriptor.title();if(text!=label){$option.data("field-label",label)}if(descriptor.selected()){$option.attr("selected","selected")}AJS.$.data(option,"descriptor",descriptor);descriptor.model($option);if(iconUrl){$option.css("backgroundImage","url("+iconUrl+")")}return $option},optgroup:function(descriptor){var elem=AJS.$("<optgroup />").addClass(descriptor.styleClass()).attr("label",descriptor.label());descriptor.model(elem);elem.data("descriptor",descriptor);if(descriptor.id()){elem.attr("id",descriptor.id())}return elem}}});
/* module-key = 'jira.webresources:select-pickers', location = '/includes/ajs/select/SuggestionHandlers.js' */
(function(){AJS.SuggestHelper={createDescriptorFetcher:function(options,model){if(options.ajaxOptions&&options.ajaxOptions.url){if(model&&options.content==="mixed"){return new AJS.MixedDescriptorFetcher(options,model)}else{return new AJS.AjaxDescriptorFetcher(options.ajaxOptions)}}else{if(options.suggestions){return new AJS.FuncDescriptorFetcher(options)}else{if(model){return new AJS.StaticDescriptorFetcher(options,model)}}}},extractItems:function(descriptors){return _.flatten(_.map(descriptors,function(descriptor){if(descriptor instanceof AJS.GroupDescriptor){return descriptor.items()}else{return[descriptor]}}))},mirrorQuery:function(query,label,uppercaseValue){var value=uppercaseValue?query.toUpperCase():query;return new AJS.GroupDescriptor({label:"user inputted option",showLabel:false,replace:true}).addItem(new AJS.ItemDescriptor({value:value,label:value,labelSuffix:" ("+label+")",title:value,allowDuplicate:false,noExactMatch:true}))},isSelected:function(itemDescriptor,selectedVals){return _.any(selectedVals,function(descriptor){return itemDescriptor.value()===descriptor.value()})},removeDuplicates:function(descriptors,vals){vals=vals||[];return _.filter(descriptors,_.bind(function(descriptor){if(descriptor instanceof AJS.GroupDescriptor){descriptor.items(this.removeDuplicates(descriptor.items(),vals));return true}else{if(!_.include(vals,descriptor.value())){if(descriptor.value()){vals.push(descriptor.value())}return true}}},this))},removeSelected:function(descriptors,selectedValues){return _.filter(descriptors,_.bind(function(descriptor){if((descriptor instanceof AJS.ItemDescriptor)&&this.isSelected(descriptor,selectedValues)){return false}if(descriptor instanceof AJS.GroupDescriptor){descriptor.items(this.removeSelected(descriptor.items(),selectedValues))}return true},this))}};AJS.DefaultSuggestHandler=Class.extend({init:function(options){this.options=options;this.descriptorFetcher=AJS.SuggestHelper.createDescriptorFetcher(options)},validateMirroring:function(query){return this.options.userEnteredOptionsMsg&&query.length>0},formatSuggestions:function(descriptors,query){if(this.validateMirroring(query)){descriptors.push(AJS.SuggestHelper.mirrorQuery(query,this.options.userEnteredOptionsMsg,this.options.uppercaseUserEnteredOnSelect))}return descriptors},execute:function(query,force){var deferred=jQuery.Deferred();var fetcherDef=this.descriptorFetcher.execute(query,force).done(_.bind(function(descriptors){if(descriptors){descriptors=this.formatSuggestions(descriptors,query)}deferred.resolve(descriptors,query)},this));deferred.fail(function(){fetcherDef.reject()});return deferred}});AJS.SelectSuggestHandler=AJS.DefaultSuggestHandler.extend({init:function(options,model){this.descriptorFetcher=AJS.SuggestHelper.createDescriptorFetcher(options,model);this.options=options;this.model=model},formatSuggestions:function(descriptors,query){var suggestions=this._super(descriptors,query);var selectedDescriptors=this.model.getDisplayableSelectedDescriptors();if(this.options.removeDuplicates){suggestions=AJS.SuggestHelper.removeDuplicates(descriptors)}return AJS.SuggestHelper.removeSelected(suggestions,selectedDescriptors)}});JIRA.AssigneeSuggestHandler=AJS.SelectSuggestHandler.extend({formatSuggestions:function(descriptors,query){var descriptors=this._super(descriptors,query);if(query.length===0){descriptors[0].footerText("Start Typing for Users")}return descriptors}});AJS.CheckboxMultiSelectSuggestHandler=AJS.SelectSuggestHandler.extend({createClearAll:function(){return"<li class='check-list-group-actions'><a class='clear-all' href='#'>"+"Clear selected items"+"</a></li>"},formatSuggestions:function(descriptors,query){var selectedItems=AJS.SuggestHelper.removeDuplicates(this.model.getDisplayableSelectedDescriptors());var selectedGroup=new AJS.GroupDescriptor({styleClass:"selected-group",items:selectedItems,actionBarHtml:selectedItems.length>1?this.createClearAll():null});descriptors.splice(0,0,selectedGroup);if(query.length>0){descriptors=AJS.SuggestHelper.removeDuplicates(descriptors);var items=AJS.SuggestHelper.extractItems(descriptors).sort(function(a,b){a=a.label().toLowerCase();b=b.label().toLowerCase();return a.localeCompare(b)});descriptors=[new AJS.GroupDescriptor({items:items})]}return descriptors}});AJS.UserListSuggestHandler=AJS.SelectSuggestHandler.extend({emailExpression:/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,validateMirroring:function(query){return this.options.freeEmailInput&&query.length>0&&this.emailExpression.test(query)}});AJS.StaticDescriptorFetcher=Class.extend({init:function(options,model){this.model=model;this.model.$element.data("static-suggestions",true)},execute:function(query){var deferred=jQuery.Deferred();deferred.resolve(this.model.getUnSelectedDescriptors(),query);return deferred}});AJS.AjaxDescriptorFetcher=Class.extend({init:function(options){this.options=_.extend({keyInputPeriod:75,minQueryLength:1,data:{},dataType:"json"},options)},makeRequest:function(deferred,ajaxOptions,query){ajaxOptions.complete=_.bind(function(){this.outstandingRequest=null},this);ajaxOptions.success=_.bind(function(data){if(ajaxOptions.query){deferred.resolve(ajaxOptions.formatResponse(data,query))}else{this.lastResponse=ajaxOptions.formatResponse(data,query);deferred.resolve(this.lastResponse)}},this);var originalError=ajaxOptions.error;ajaxOptions.error=function(xhr,textStatus,msg,smartAjaxResult){if(!smartAjaxResult.aborted){if(originalError){originalError.apply(this,arguments)}else{alert(JIRA.SmartAjax.buildSimpleErrorContent(smartAjaxResult,{alert:true}))}}};this.outstandingRequest=JIRA.SmartAjax.makeRequest(ajaxOptions)},incubateRequest:function(deferred,ajaxOptions,query,force){clearTimeout(this.queuedRequest);if(force&&this.outstandingRequest){this.outstandingRequest.abort();this.outstandingRequest=null}if(!ajaxOptions.query&&this.lastResponse){deferred.resolve(this.lastResponse)}else{if(!this.outstandingRequest){if(typeof ajaxOptions.data==="function"){ajaxOptions.data=ajaxOptions.data(query)}else{ajaxOptions.data.query=query}if(typeof ajaxOptions.url==="function"){ajaxOptions.url=ajaxOptions.url()}if((query.length>=parseInt(ajaxOptions.minQueryLength,10))||force){this.makeRequest(deferred,ajaxOptions,query)}else{deferred.resolve()}}else{this.queuedRequest=setTimeout(_.bind(function(){this.incubateRequest(deferred,ajaxOptions,query,true)},this),ajaxOptions.keyInputPeriod)}}return deferred},execute:function(query,force){var deferred=jQuery.Deferred();deferred.fail(_.bind(function(){clearTimeout(this.queuedRequest);if(this.outstandingRequest){this.outstandingRequest.abort()}},this));this.incubateRequest(deferred,_.extend({},this.options),query,force);return deferred}});AJS.MixedDescriptorFetcher=Class.extend({init:function(options,model){this.ajaxFetcher=new AJS.AjaxDescriptorFetcher(options.ajaxOptions);this.options=options;this.model=model},execute:function(query,force){var deferred=jQuery.Deferred();if(query.length>=1){var ajaxDeferred=this.ajaxFetcher.execute(query,force).done(_.bind(function(suggestions){var descriptors=[].concat(suggestions).concat(this.model.getAllDescriptors());deferred.resolve(descriptors,query)},this));deferred.fail(function(){ajaxDeferred.reject()})}else{deferred.resolve(this.model.getUnSelectedDescriptors(),query)}return deferred}});AJS.FuncDescriptorFetcher=Class.extend({init:function(options){this.options=options},execute:function(query){var deferred=jQuery.Deferred();deferred.resolve(this.options.suggestions(query),query);return deferred}})})();
/* module-key = 'jira.webresources:select-pickers', location = '/includes/ajs/select/QueryableDropdownSelect.js' */
AJS.QueryableDropdownSelect=AJS.Control.extend({INVALID_KEYS:{"Shift":true,"Esc":true,"Right":true},init:function(options){this.suggestionsVisible=false;this._setOptions(options);this._createFurniture();this._createDropdownController();this._createSuggestionsController();this._createListController();this._assignEventsToFurniture();if(this.options.width){this.setFieldWidth(this.options.width)}if(this.options.loadOnInit){this.requestSuggestions(true)}},_createDropdownController:function(){var instance=this;if(this.options.dropdownController){this.dropdownController=this.options.dropdownController}else{this.dropdownController=AJS.InlineLayer.create({offsetTarget:this.$field,width:this.$field.innerWidth(),content:this.options.element})}this.dropdownController.onhide(function(){instance.hideSuggestions()})},_createSuggestionsController:function(){this.suggestionsHandler=this.options.suggestionsHandler?new this.options.suggestionsHandler(this.options):new AJS.DefaultSuggestHandler(this.options)},_createListController:function(){var instance=this;this.listController=new AJS.List({containerSelector:this.options.element,groupSelector:"ul.aui-list-section",matchingStrategy:this.options.matchingStrategy,eventTarget:this.$field,selectionHandler:function(){instance.$field.val("Loading...").css("color","#999");instance.hideSuggestions();return true}})},setFieldWidth:function(width){this.$container.css({width:width,minWidth:width})},showErrorMessage:function(value){var $container=this.$container.parent(".field-group");this.hideErrorMessage();this.$errorMessage.text(AJS.format(this.options.errorMessage,value||this.getQueryVal()));if($container.length===1){$container.append(this.$errorMessage);return }if($container.length===0){$container=this.$container.parent(".frother-control-renderer")}if($container.length===1){this.$errorMessage.prependTo($container);return }if($container.length===0){this.$container.parent().append(this.$errorMessage)}},hideErrorMessage:function(){if(this.$errorMessage){this.$errorMessage.remove()}this.$container.parent().find(".error").remove()},_getDefaultOptions:function(){return{id:"default",keyInputPeriod:75,localListLiveUpdateLimit:25,localListLiveUpdateDelay:150}},_createFurniture:function(){this.$container=this._render("container").insertBefore(this.options.element);this.$field=this._render("field").appendTo(this.$container);this.$dropDownIcon=this._render("dropdownAndLoadingIcon",this._hasDropdownButton()).appendTo(this.$container);if(this.options.overlabel){this.$overlabel=this._render("overlabel").insertBefore(this.$field);this.$overlabel.overlabel()}},_hasDropdownButton:function(){return this.options.showDropdownButton||this.options.ajaxOptions&&this.options.ajaxOptions.minQueryLength===0},_assignEventsToFurniture:function(){var instance=this;this._assignEvents("ignoreBlurElement",this.dropdownController.$layer);this._assignEvents("container",this.$container);if(this._hasDropdownButton()){this._assignEvents("ignoreBlurElement",this.$dropDownIcon);this._assignEvents("dropdownAndLoadingIcon",this.$dropDownIcon)}setTimeout(function(){instance._assignEvents("field",instance.$field);instance._assignEvents("keys",instance.$field)},15)},requestSuggestions:function(force){var instance=this,deferred=jQuery.Deferred();this.outstandingRequest=this.suggestionsHandler.execute(this.getQueryVal(),force).done(function(descriptors,query){if(query===instance.getQueryVal()){deferred.resolve(descriptors,query)}});if(!this.outstandingRequest.isResolved()){window.clearTimeout(this.loadingWait);this.loadingWait=window.setTimeout(function(){if(!instance.outstandingRequest.isResolved()&&!instance.outstandingRequest.isRejected()){instance.showLoading()}},150);this.outstandingRequest.always(function(){instance.hideLoading()})}return deferred},showLoading:function(){this.$dropDownIcon.addClass("loading").removeClass("noloading");return this},hideLoading:function(){this.$dropDownIcon.removeClass("loading").addClass("noloading");return this},_setSuggestions:function(data){this.suggestionsVisible=true;if(data){this.dropdownController.show();this.dropdownController.setWidth(this.$field.innerWidth());this.dropdownController.setPosition();this.listController.generateListFromJSON(data,this.getQueryVal());this.listController.enable()}else{this.hideSuggestions()}this.$container.attr("data-query",this.getQueryVal())},disable:function(){if(!this.disabled){this.$container.addClass("aui-disabled");this.$disabledBlanket=this._render("disabledBlanket").appendTo(this.$container);this.$field.attr("disabled",true);this.dropdownController.hide();this.disabled=true}},enable:function(){if(this.disabled){this.$container.removeClass("aui-disabled");this.$disabledBlanket.remove();this.$field.attr("disabled",false);this.disabled=false}},getQueryVal:function(){return AJS.$.trim(this.$field.val())},_isValidInput:function(event){return this.$field.is(":visible")&&!(event.type==="aui:keydown"&&this.INVALID_KEYS[event.key])},_handleCharacterInput:function(force){var queryLength=this.getQueryVal().length;if(queryLength>=1||force){this.requestSuggestions(force).done(_.bind(function(suggestions){this._setSuggestions(suggestions)},this))}else{this.hideSuggestions()}},_handleDown:function(e){if(!this.suggestionsVisible){this.listController._latestQuery="";this._handleCharacterInput(true)}e.preventDefault()},_rejectPendingRequests:function(){if(this.outstandingRequest){this.outstandingRequest.reject()}},hideSuggestions:function(){if(!this.suggestionsVisible){return }this._rejectPendingRequests();this.suggestionsVisible=false;this.$dropDownIcon.addClass("noloading");this.dropdownController.hide();this.listController.disable()},_deactivate:function(){this.hideSuggestions()},_handleEscape:function(e){if(this.suggestionsVisible){e.stopPropagation();if(e.type==="keyup"){this.hideSuggestions();if(AJS.$.browser.msie){this.$field.focus()}}}},acceptFocusedSuggestion:function(){var focused=this.listController.getFocused();if(focused.length!==0&&focused.is(":visible")){this.listController._acceptSuggestion(focused)}},keys:{"Down":function(e){if(this._hasDropdownButton()){this._handleDown(e)}},"Up":function(e){e.preventDefault()},"Return":function(e){e.preventDefault()}},onEdit:function(){this._handleCharacterInput()},_events:{dropdownAndLoadingIcon:{click:function(e){if(this.suggestionsVisible){this.hideSuggestions()}else{this._handleDown(e);this.$field.focus()}e.stopPropagation()}},container:{disable:function(){this.disable()},enable:function(){this.enable()}},field:{blur:function(){if(!this.ignoreBlurEvent){this._deactivate()}else{this.ignoreBlurEvent=false}},click:function(e){e.stopPropagation()},"keydown keyup":function(e){if(e.keyCode===27){this._handleEscape(e)}}},keys:{"aui:keydown input":function(event){this._handleKeyEvent(event)}},ignoreBlurElement:{mousedown:function(e){if(jQuery.browser.msie){var targetIsDropdownController=(jQuery(e.target)[0]==jQuery(this.dropdownController.$layer)[0]);if(targetIsDropdownController){this.ignoreBlurEvent=true}if(typeof document.addEventListener==="undefined"){if(!targetIsDropdownController){var field=this.$field.get(0);function onbeforedeactivate(event){event.returnValue=false}field.attachEvent("onbeforedeactivate",onbeforedeactivate);setTimeout(function(){field.detachEvent("onbeforedeactivate",onbeforedeactivate)},0)}return }}e.preventDefault()}}},_renders:{disabledBlanket:function(){return AJS.$("<div class='aui-disabled-blanket' />").height(this.$field.outerHeight())},overlabel:function(){return AJS.$("<span id='"+this.options.id+"-overlabel' data-target='"+this.options.id+"-field' class='overlabel'>"+this.options.overlabel+"</span>")},field:function(){return jQuery("<input>").attr({"autocomplete":"off","class":"text","id":this.options.id+"-field","type":"text"})},container:function(){return AJS.$("<div class='queryable-select' id='"+this.options.id+"-queryable-container' />")},dropdownAndLoadingIcon:function(showDropdown){var $element=AJS.$('<span class="icon noloading"><span>More</span></span>');if(showDropdown){$element.addClass("drop-menu")}return $element},suggestionsContainer:function(){return AJS.$("<div class='aui-list' id='"+this.options.id+"' tabindex='-1'></div>")}}});AJS.namespace("AJS.QueryableDropdown",null,AJS.QueryableDropdownSelect);
/* module-key = 'jira.webresources:select-pickers', location = '/includes/ajs/select/MultiSelect.js' */
AJS.MultiSelect=AJS.QueryableDropdownSelect.extend({init:function(options){if(this._setOptions(options)===this.INVALID){return this.INVALID}jQuery.extend(this,AJS.SelectHelper);this.options.element=AJS.$(this.options.element);this.lozengeGroup=this.options.itemGroup;this._createSelectModel();if(this.options.disabled){this._createFurniture(true);return this}this._createFurniture();this._createSuggestionsController();this._createListController();this._createDropdownController();this._assignEventsToFurniture();this._setInitState();if(this.options.width){this.setFieldWidth(this.options.width)}this.model.$element.addClass("multi-select-select").trigger("initialized",[this])},_createSelectModel:function(){this.model=new AJS.SelectModel({element:this.options.element,removeOnUnSelect:this.options.removeOnUnSelect})},_setInitState:function(){this._restoreSelectedOptions();if(this.options.inputText){this.$field.val(this.options.inputText);this.updateFreeInputVal()}},_createListController:function(){var instance=this;this.listController=new AJS.List({containerSelector:AJS.$(".aui-list",this.$container),groupSelector:"ul.aui-list-section",matchingStrategy:this.options.matchingStrategy,maxInlineResultsDisplayed:this.options.maxInlineResultsDisplayed,selectionHandler:function(e){instance._selectionHandler(this.getFocused(),e);return false}})},_createDropdownController:function(){var instance=this;this.dropdownController=AJS.InlineLayer.create({alignment:AJS.LEFT,offsetTarget:this.$field,maxInlineResultsDisplayed:this.options.maxInlineResultsDisplayed,content:AJS.$(".aui-list",this.$container)});if(this.options.layerId){this.dropdownController.options.id=this.options.layerId}this.dropdownController.onhide(function(){instance.hideSuggestions()})},_createSuggestionsController:function(){this.suggestionsHandler=this.options.suggestionsHandler?new this.options.suggestionsHandler(this.options,this.model):new AJS.SelectSuggestHandler(this.options,this.model)},_getDefaultOptions:function(){return AJS.$.extend(true,this._super(),{minRoomForText:50,errorMessage:"The value {0} is invalid.",showDropdownButton:true,itemGroup:new AJS.MultiSelect.LozengeGroup(),suggestionsHandler:AJS.SelectSuggestHandler,itemBuilder:function(descriptor){return new AJS.MultiSelect.Lozenge({label:descriptor.label(),title:descriptor.title(),container:this.$selectedItemsContainer})}})},_createFurniture:function(disabled){var id=this.model.$element.attr("id");if(this.model.$element.prev().hasClass("ajs-multi-select-placeholder")){this.model.$element.prev().remove()}if(disabled){this.model.$element.replaceWith(this._render("disableSelectField",id))}else{this.$container=this._render("container",id);this.$field=this._render("field",id).appendTo(this.$container);this.$container.append(this._render("suggestionsContainer",id));this.$container.insertBefore(this.model.$element);this.$dropDownIcon=this._render("dropdownAndLoadingIcon",this._hasDropdownButton()).appendTo(this.$container);this.$errorMessage=this._render("errorMessage",id);this.$selectedItemsWrapper=this._render("selectedItemsWrapper").appendTo(this.$container);this.$selectedItemsContainer=this._render("selectedItemsContainer").appendTo(this.$selectedItemsWrapper)}},_assignEventsToFurniture:function(){var instance=this;this._super();this._assignEvents("body",document);this._assignEvents("selectedItemsContainer",this.$selectedItemsContainer);this._assignEvents("lozengeGroup",this.lozengeGroup);this.model.$element.bind("updateOptions",function(e){instance.options=jQuery.extend(true,instance.options,instance.model.$element.getOptionsFromAttributes());instance._createSuggestionsController()}).bind("selectOption",function(e,descriptor){instance.addItem(descriptor)}).bind("removeOption",function(e,descriptor){instance.removeItem(descriptor)}).bind("clearSelection",function(){instance.clearLozenges()}).bind("showSuggestions",function(e){instance._handleDown(e)}).bind("hideSuggestions",function(){instance.hideSuggestions()})},_getUserInputValue:function(){return this.options.uppercaseUserEnteredOnSelect?this.$field.val().toUpperCase():this.$field.val()},clear:function(){this.$field.val("");this.hideSuggestions();this.clearSelection()},clearSelection:function(){this.model.setAllUnSelected();this.updateItemsIndent();this.model.$element.trigger("unselect",[this])},clearLozenges:function(){this.lozengeGroup.removeAllItems();this.clear()},removeItem:function(descriptor){var instance=this;this.model.setUnSelected(descriptor);window.setTimeout(function(){instance.updateItemsIndent()},0);this.model.$element.trigger("unselect",[descriptor,this])},_restoreSelectedOptions:function(){var instance=this;AJS.$.each(this.model.getDisplayableSelectedDescriptors(),function(){instance.addItem(this,true)});this.updateItemsIndent()},_shouldEnableLozengeGroup:function(){return this.lozengeGroup.items.length>0&&this.lozengeGroup.index<0&&(this.$field.val().length===0||this.getCaret(this.$field[0])===0)},_handleBackSpace:function(){var instance=this;if(this._shouldEnableLozengeGroup()){setTimeout(function(){instance.lozengeGroup.shiftFocus(-1)},0)}},_handleLeft:function(){if(this._shouldEnableLozengeGroup()){var instance=this;setTimeout(function(){instance.lozengeGroup.shiftFocus(-1)},0)}},updateItemsIndent:function(){var lineHeight=20;var inputIndent=this._getInputIndent();var newHeight=inputIndent.top+lineHeight;if(this.$container&&this.$container.closest(".inline-edit-fields").size()){newHeight+=0}else{newHeight+=6}this.$field.css({paddingTop:inputIndent.top,paddingLeft:inputIndent.left});this.$field.css({height:newHeight});if(this.currentTopOffset&&this.currentTopOffset!==inputIndent.top){this.$container.trigger("multiSelectHeightUpdated",[this])}if(AJS.$.browser.msie){this.$field.val(this.$field.val()+" ");this.$field.val(this.$field.val().replace(/\s$/,""))}this.currentTopOffset=inputIndent.top},_isItemPresent:function(descriptor){var duplicate=false;var value=descriptor.value();AJS.$.each(this.lozengeGroup.items,function(){if(this.value===value){duplicate=true;return false}});return duplicate},addItem:function(descriptor,initialize){if(descriptor instanceof AJS.ItemDescriptor){descriptor=AJS.copyObject(descriptor.allProperties(),false)}descriptor.value=AJS.$.trim(descriptor.value);descriptor.label=AJS.$.trim(descriptor[this.options.itemAttrDisplayed])||descriptor.value;descriptor.title=AJS.$.trim(descriptor.title)||descriptor.label;descriptor=new AJS.ItemDescriptor(descriptor);if(this._isItemPresent(descriptor)){return }var lozenge=this.options.itemBuilder.call(this,descriptor);this.lozengeGroup.addItem(lozenge);this._assignEvents("lozenge",lozenge);this.model.setSelected(descriptor);this.updateItemsIndent();this.dropdownController.setPosition();lozenge.value=descriptor.value();if(!initialize){this.model.$element.trigger("selected",[descriptor,this])}},_addMultipleItems:function(items,removeOnUnSelect){var instance=this;AJS.$.each(items,function(i,descriptor){if(removeOnUnSelect){descriptor.removeOnUnSelect=true}instance.addItem(descriptor)})},_getInputIndent:function(){var top,left,indent,iconArea=21,paddingLeft=5,paddingTop=4,lastLozengeIndex=this.lozengeGroup.items.length-1,$last;indent={top:paddingTop,left:paddingLeft};if(lastLozengeIndex>=0){$last=this.lozengeGroup.items[lastLozengeIndex].$lozenge;top=$last.prop("offsetTop");left=$last.prop("offsetLeft")+$last.outerWidth();if(left>this.$container.width()-iconArea-this.options.minRoomForText){top+=$last.prop("offsetHeight");left=0}indent.top+=top;indent.left+=left}return indent},_selectionHandler:function(selected,e){var instance=this;selected.each(function(){instance.addItem(AJS.$.data(this,"descriptor"))});this.$field.val("").focus().scrollIntoView({margin:20});this.hideSuggestions();this.hideErrorMessage();this.updateFreeInputVal();this.model.$element.trigger("change");e.preventDefault()},isValidItem:function(itemValue){var suggestedItemDescriptor=this.listController.getFocused().data("descriptor");if(!suggestedItemDescriptor){return false}itemValue=itemValue.toLowerCase();return itemValue===AJS.$.trim(suggestedItemDescriptor.label.toLowerCase())||itemValue===AJS.$.trim(suggestedItemDescriptor.value.toLowerCase())},handleFreeInput:function(){var value=AJS.$.trim(this.$field.val()),descriptor;if(value){descriptor=this.model.getDescriptor(value);if(descriptor){this.addItem(descriptor);this.model.$element.trigger("change");this.$field.val("");this.hideErrorMessage()}else{if(!this.options.submitInputVal){this.showErrorMessage(value)}}}},submitForm:function(){if(this.$field.val().length===0&&!this.suggestionsVisible){AJS.$(this.$field[0].form).submit()}},_handleCharacterInput:function(ignoreBuffer,ignoreQueryLength){this._super(ignoreBuffer,ignoreQueryLength);this.updateFreeInputVal()},_deactivate:function(){this.handleFreeInput();this.lozengeGroup.trigger("blur");this.hideSuggestions()},keys:{"Left":function(){this._handleLeft()},"Backspace":function(){this._handleBackSpace()},"Return":function(e){this.submitForm();e.preventDefault()},"Tab":function(e){this.acceptFocusedSuggestion()}},_events:{body:{tabSelect:function(){if(this.$field.is(":visible")){this.updateItemsIndent()}},multiSelectRevealed:function(){if(this.$field.is(":visible")){this.updateItemsIndent()}}},field:{blur:function(){if(!this.ignoreBlurEvent){this._deactivate()}else{this.ignoreBlurEvent=false;this.$field.focus()}},"aui:keydown aui:keypress":function(event){if(this.lozengeGroup.index>=0){if(event.key in this.lozengeGroup.keys){event.preventDefault()}else{if(event.key==="Return"){this.submitForm();event.preventDefault()}else{this.onEdit(event);this.lozengeGroup.trigger("blur")}}}},click:function(){this.lozengeGroup.trigger("blur");this.$field.focus()}},lozengeGroup:{focus:function(){this.$field.focus();this.hideSuggestions();this._unassignEvents("keys",this.$field)},blur:function(){this._assignEvents("keys",this.$field);if(this.$field.val()){this._handleCharacterInput()}}},lozenge:{remove:function(event){this.removeItem(this.model.getDescriptor(event.target.value));this.$field.focus()}},selectedItemsContainer:{click:function(event){if(event.target===event.currentTarget){this.lozengeGroup.trigger("blur");this.$field.focus()}}}},_renders:{errorMessage:function(idPrefix){return AJS.$('<div class="error" />').attr("id",idPrefix+"-error")},selectedItemsWrapper:function(){return AJS.$('<div class="representation"></div>')},selectedItemsContainer:function(){return AJS.$('<ul class="items" />')},field:function(idPrefix){return AJS.$('<textarea autocomplete="off" id="'+idPrefix+'-textarea" class="text long-field" wrap="off"></textarea>')},disableSelectField:function(id){return AJS.$("<input type='text' class='long-field' name='"+id+"' id='"+id+"' />")},container:function(idPrefix){return AJS.$('<div class="jira-multi-select long-field" id="'+idPrefix+'-multi-select">')},suggestionsContainer:function(idPrefix){return AJS.$('<div class="aui-list" id="'+idPrefix+'-suggestions" tabindex="-1"></div>')}}});
/* module-key = 'jira.webresources:select-pickers', location = '/includes/ajs/select/MultiSelect.Lozenge.js' */
AJS.MultiSelect.Lozenge=AJS.Control.extend({init:function(options){this._setOptions(options);this.$lozenge=this._render("lozenge");this.$removeButton=this._render("removeButton");this._assignEvents("instance",this);this._assignEvents("lozenge",this.$lozenge);this._assignEvents("removeButton",this.$removeButton);this.$removeButton.appendTo(this.$lozenge);this.$lozenge.appendTo(this.options.container)},_getDefaultOptions:function(){return{label:null,title:null,container:null,focusClass:"focused"}},_renders:{"lozenge":function(){var label=AJS.escapeHtml(this.options.label);var title=AJS.escapeHtml(this.options.title)||"";return AJS.$('<li class="item-row" title="'+title+'"><button type="button" tabindex="-1" class="value-item"><span><span class="value-text">'+label+"</span></span></button></li>")},"removeButton":function(){return AJS.$('<em class="item-delete" title="'+AJS.escapeHtml("Remove")+'"></em>')}},_events:{"instance":{"focus":function(){this.$lozenge.addClass(this.options.focusClass)},"blur":function(){this.$lozenge.removeClass(this.options.focusClass)},"remove":function(){this.$lozenge.remove()}},"lozenge":{"click":function(){this.trigger("focus")}},"removeButton":{"click":function(){this.trigger("remove")}}}});
/* module-key = 'jira.webresources:select-pickers', location = '/includes/ajs/select/MultiSelect.LozengeGroup.js' */
AJS.MultiSelect.LozengeGroup=AJS.Group.extend({keys:{"Left":function(){if(this.index>0){this.shiftFocus(-1)}},"Right":function(){if(this.index===this.items.length-1){this.items[this.index].trigger("blur")}else{this.shiftFocus(1)}},"Backspace":function(){var index=this.index;if(index>0){this.shiftFocus(-1)}else{if(this.items.length>1){this.shiftFocus(1)}}this.items[index].trigger("remove")},"Del":function(){var index=this.index;if(index+1<this.items.length){this.shiftFocus(1)}this.items[index].trigger("remove")}}});
/* module-key = 'jira.webresources:select-pickers', location = '/includes/jira/field/IssuePicker.js' */
JIRA.IssuePicker=AJS.MultiSelect.extend({_formatResponse:function(response){var ret=[],canonicalBaseUrl=(function(){var uri=parseUri(window.location);return uri.protocol+"://"+uri.authority})();if(response&&response.sections){AJS.$(response.sections).each(function(i,section){var groupDescriptor=new AJS.GroupDescriptor({weight:i,label:section.label,description:section.sub});if(section.issues&&section.issues.length>0){AJS.$(section.issues).each(function(){groupDescriptor.addItem(new AJS.ItemDescriptor({highlighted:true,value:this.key,label:this.key+" - "+this.summaryText,icon:this.img?canonicalBaseUrl+contextPath+this.img:null,html:this.keyHtml+" - "+this.summary}))})}ret.push(groupDescriptor)})}return ret},_getDefaultOptions:function(){return AJS.$.extend(true,this._super(),{ajaxOptions:{formatResponse:this._formatResponse}})},_launchPopup:function(){function getWithDefault(value,def){if(typeof value=="undefined"||value==null){return def}else{return value}}var url,urlParam,vWinUsers,options,instance=this;JIRA.IssuePicker.callback=function(items){if(typeof items==="string"){items=JSON.parse(items)}instance._addMultipleItems(items,true);instance.$field.focus()};options=this.options.ajaxOptions.data;url=contextPath+"/secure/popups/IssuePicker.jspa?";urlParam={singleSelectOnly:"false",decorator:"popup",currentIssue:options.currentIssueKey||"",showSubTasks:getWithDefault(options.showSubTasks,false),showSubTasksParent:getWithDefault(options.showSubTaskParent,false)};if(options.currentProjectId){urlParam["currentProjectId"]=options.currentProjectId}url+=AJS.$.param(urlParam);vWinUsers=window.open(url,"IssueSelectorPopup","status=no,resizable=yes,top=100,left=200,width="+this.options.popupWidth+",height="+this.options.popupHeight+",scrollbars=yes,resizable");vWinUsers.opener=self;vWinUsers.focus()},_createFurniture:function(disabled){var $popupLink;this._super(disabled);$popupLink=this._render("popupLink");this._assignEvents("popupLink",$popupLink);this.$container.addClass("jira-issue-picker");this.$container.addClass("hasIcon");this.$container.after($popupLink)},handleFreeInput:function(){var values=this.$field.val().toUpperCase().match(/\S+/g);if(values){this._addMultipleItems(jQuery.map(values,function(value){return{value:value,label:value}}))}this.$field.val("")},_events:{popupLink:{click:function(e){this._launchPopup();e.preventDefault()}}},_renders:{popupLink:function(){return AJS.$("<a class='issue-picker-popup' />").attr({href:"#",title:this.options.popupLinkMessage}).text(""+this.options.popupLinkMessage+"")}}});AJS.namespace("jira.issuepicker",null,JIRA.IssuePicker);AJS.namespace("AJS.IssuePicker",null,JIRA.IssuePicker);
/* module-key = 'jira.webresources:select-pickers', location = '/includes/jira/field/LabelPicker.js' */
JIRA.LabelPicker=AJS.MultiSelect.extend({_getDefaultOptions:function(){return AJS.$.extend(true,this._super(),{ajaxOptions:{url:contextPath+"/includes/js/ajs/layer/labeldata.js",query:true,formatResponse:this._formatResponse},removeDuplicates:true,removeOnUnSelect:true,userEnteredOptionsMsg:"New Label"})},isValidItem:function(itemValue){return !/\s/.test(itemValue)},_handleServerSuggestions:function(data){if(data&&data.token){if(AJS.$.trim(this.$field.val())!==data.token){return }}this._super(data)},_handleSpace:function(){if(AJS.$.trim(this.$field.val())!==""){if(this.handleFreeInput()){this.hideSuggestions()}}},keys:{"Spacebar":function(event){this._handleSpace();event.preventDefault()}},_formatResponse:function(data){var optgroup=new AJS.GroupDescriptor({label:"Suggestions",type:"optgroup",styleClass:"labels-suggested"});if(data&&data.suggestions){AJS.$.each(data.suggestions,function(){optgroup.addItem(new AJS.ItemDescriptor({value:this.label,label:this.label,html:this.html,highlighted:true}))})}return[optgroup]},handleFreeInput:function(){var values=AJS.$.trim(this.$field.val()).match(/\S+/g);if(values){for(var value,i=0;value=values[i];i++){this.addItem({value:value,label:value})}this.model.$element.trigger("change")}this.$field.val("")}});AJS.namespace("AJS.LabelPicker",null,JIRA.LabelPicker);
/* module-key = 'jira.webresources:select-pickers', location = '/includes/ajs/select/SingleSelect.js' */
AJS.SingleSelect=AJS.QueryableDropdownSelect.extend({init:function(options){if(this._setOptions(options)===this.INVALID){return this.INVALID}this._createSelectModel();if(this.options.disabled){this._createFurniture(true);return this}jQuery.extend(this,AJS.SelectHelper);this._createFurniture();this._createSuggestionsController();this._createDropdownController();this._createListController();this._assignEventsToFurniture();this._setInitState();if(this.options.width){this.setFieldWidth(this.options.width)}if(this.$overlabel){this.$overlabel.overlabel(this.$field)}this.model.$element.addClass("aui-ss-select").trigger("initialized",[this])},_setInitState:function(){if(this.options.editValue){this._setEditingMode();this.$field.val(this.options.editValue)}else{if(this.getSelectedDescriptor()){this.setSelection(this.getSelectedDescriptor())}else{this._setEditingMode();if(this.options.inputText){this.$field.val(this.options.inputText)}}}},_createSelectModel:function(){this.model=new AJS.SelectModel({element:this.options.element,removeOnUnSelect:this.options.removeOnUnSelect})},_createDropdownController:function(){this.dropdownController=AJS.InlineLayer.create({alignment:AJS.LEFT,offsetTarget:this.$field,content:AJS.$(".aui-list",this.$container),setMaxHeightToWindow:this.options.setMaxHeightToWindow,minHeight:this.options.minHeight})},_createSuggestionsController:function(){this.suggestionsHandler=this.options.suggestionsHandler?new this.options.suggestionsHandler(this.options,this.model):new AJS.SelectSuggestHandler(this.options,this.model)},_assignEventsToFurniture:function(){var instance=this;this._super();this.model.$element.bind("reset",function(){var selectedDescriptor=instance.getSelectedDescriptor();if(selectedDescriptor){instance.setSelection(instance.getSelectedDescriptor())}}).bind("showSuggestions",function(e){instance._handleDown(e)}).bind("hideSuggestions",function(){instance.hideSuggestions()}).bind("set-selection-value",function(e,value){instance._setDescriptorWithValue(value)})},setFieldWidth:function(width){this.$container.css({maxWidth:width});this.$field.css({maxWidth:width})},_createListController:function(){var instance=this;this.listController=new AJS.List({containerSelector:AJS.$(".aui-list",this.$container),groupSelector:"ul.aui-list-section",matchingStrategy:this.options.matchingStrategy,maxInlineResultsDisplayed:this.options.maxInlineResultsDisplayed,matchItemText:this.options.matchItemText,hasLinks:this.options.hasLinks,selectionHandler:function(e){var selectedSuggestion=this.getFocused(),selectedDescriptor=selectedSuggestion.data("descriptor");instance.setSelection(selectedDescriptor);instance.$field.select();e.preventDefault();return false}})},getSelectedDescriptor:function(){return this.model.getDisplayableSelectedDescriptors()[0]},getDisplayVal:function(descriptor){return descriptor[this.options.itemAttrDisplayed||"label"]()},_getDefaultOptions:function(){return AJS.$.extend(true,this._super(),{errorMessage:"The value {0} is invalid.",revertOnInvalid:false,showDropdownButton:true})},_createFurniture:function(disabled){var id=this.model.$element.attr("id");this.model.$element.data("aui-ss",true);this.$container=this._render("container",this.model.id);var containerClass=this.model.$element.data("container-class");if(containerClass){this.$container.addClass(containerClass)}if(disabled){var value=this.model.$element.val()&&this.model.$element.val()[0];value=value||"";this.model.$element.replaceWith(this._render("disableSelectField",id,value))}else{var placeholder=this.model.getPlaceholder();this.$field=this._render("field",this.model.id,placeholder).appendTo(this.$container);this.$container.append(this._render("suggestionsContainer",this.model.id));this.$container.insertBefore(this.model.$element);this.$dropDownIcon=this._render("dropdownAndLoadingIcon",this._hasDropdownButton()).appendTo(this.$container);this.$errorMessage=this._render("errorMessage")}},getQueryVal:function(){if(this.$container.hasClass("aui-ss-editing")){return jQuery.trim(this.$field.val())}else{return""}},_setSuggestions:function(data,context){if(data){this._super(data,context);this.model.$element.trigger("suggestionsRefreshed",[this])}else{this.hideSuggestions()}},_setEditingMode:function(){this.$container.addClass("aui-ss-editing").removeClass("aui-ss-has-entity-icon");this.$field.css("paddingLeft")},_hasIcon:function(){var icon,selectedDescriptor=this.getSelectedDescriptor();if(selectedDescriptor){icon=selectedDescriptor.icon();return icon&&icon!=="none"}},_setReadOnlyMode:function(){this.$container.removeClass("aui-ss-editing");if(this._hasIcon()){this.$container.addClass("aui-ss-has-entity-icon");if(jQuery.browser.msie&&jQuery.browser.version>8){this.$container.append(this.$field.detach())}}},submitForm:function(){if(!this.suggestionsVisible){this.handleFreeInput();AJS.$(this.$field[0].form).submit()}},selectValue:function(value){this.listController.selectValue(value)},setSelection:function(descriptor){if(typeof descriptor==="string"){descriptor=new AJS.ItemDescriptor({value:descriptor,label:descriptor})}this.removeFreeInputVal();this.$field.val(descriptor.fieldText()||this.getDisplayVal(descriptor));if(this.model.setSelected(descriptor)){this.hideErrorMessage()}if(this._hasIcon()){if(this.$entityIcon){this.$entityIcon.remove()}this.$entityIcon=this._render("entityIcon",descriptor.icon()).appendTo(this.$container)}this._setReadOnlyMode();this.hideSuggestions();this.lastSelection=descriptor;this.model.$element.trigger("selected",[descriptor,this])},clear:function(){this.$field.val("");this.hideSuggestions();this.clearSelection()},clearSelection:function(){var instance=this;instance._setEditingMode();instance.model.setAllUnSelected();instance.model.$element.trigger("unselect",[this])},_handleServerSuggestions:function(data){this.cleanUpModel();this._super(data)},cleanUpModel:function(){if(this.options.ajaxOptions.query){this.model.clearUnSelected()}},onEdit:function(){if(this.getSelectedDescriptor()){this.clearSelection()}this._super();this.model.$element.trigger("query")},handleFreeInput:function(value){value=value||AJS.$.trim(this.$field.val());if(this.options.revertOnInvalid&&!this.model.getDescriptor(value)){this.setSelection(this.lastSelection)}else{if(this.$container.hasClass("aui-ss-editing")){if(this._setDescriptorWithValue(value)){this.hideErrorMessage()}else{if(!this.options.submitInputVal){this.showErrorMessage(value)}}}}},_setDescriptorWithValue:function(value){var descriptor=this.model.getDescriptor(value);if(descriptor){this.setSelection(descriptor);return true}return false},_handleCharacterInput:function(force){this._super(force);if(this.$container.hasClass("aui-ss-editing")){this.updateFreeInputVal()}},_deactivate:function(){this.handleFreeInput();this.hideSuggestions()},keys:{"Return":function(e){this.submitForm();e.preventDefault()},"Tab":function(){this.acceptFocusedSuggestion()}},_events:{field:{focus:function(){var instance=this;window.setTimeout(function(){if(instance.$field.is(":focus")){instance.$field.select()}},0)},click:function(){this._handleCharacterInput(true)}}},_renders:{label:function(label,id){return AJS.$("<label />").attr("for",id).text(label).addClass("overlabel")},errorMessage:function(){return AJS.$('<div class="error" />')},entityIcon:function(url){return AJS.$('<img class="aui-ss-entity-icon" src="'+url+'" alt=""/>')},field:function(idPrefix,placeholder){var $field=AJS.$("<input>").attr({"autocomplete":"off","class":"text aui-ss-field ajs-dirty-warning-exempt","id":idPrefix+"-field"});if(placeholder){$field.attr("placeholder",placeholder)}return $field},disableSelectField:function(id,value){return AJS.$("<input type='text' class='text long-field' value='"+value+"' name='"+id+"' id='"+id+"' />")},container:function(idPrefix){return AJS.$('<div class="aui-ss" id="'+idPrefix+'-single-select">')},suggestionsContainer:function(idPrefix){return AJS.$('<div class="aui-list" id="'+idPrefix+'-suggestions" tabindex="-1"></div>')},dropdownAndLoadingIcon:function(showDropdown){var $element=AJS.$('<span class="icon aui-ss-icon noloading"><span>More</span></span>');if(showDropdown){$element.addClass("drop-menu")}return $element}}});
/* module-key = 'jira.webresources:select-pickers', location = '/includes/ajs/select/CheckboxMultiSelect.js' */
AJS.CheckboxMultiSelect=AJS.QueryableDropdownSelect.extend({init:function(options){var instance=this;AJS.$.extend(this,AJS.SelectHelper);this._setOptions(options);var element=AJS.$(this.options.element);if(!element.attr("multiple")){throw"Cannot create CheckboxMultiSelect without multiple-select select element."}this.options.element=AJS.$(this.options.element).hide();this.model=new AJS.SelectModel({element:this.options.element,removeOnUnSelect:this.options.removeOnUnSelect});this.suggestionsHandler=this.options.suggestionsHandler?new this.options.suggestionsHandler(this.options,this.model):new AJS.CheckboxMultiSelectSuggestHandler(this.options,this.model);this.options.element.bind("updateOptions",function(){instance._setOptions(options)}).bind("selectOption",function(e,descriptor){instance.selectItem(descriptor)}).bind("removeOption",function(e,descriptor){instance.unselectItem(descriptor)}).bind("clear",function(){instance.clear()});this._createFurniture();this.dropdownController={show:AJS.$.noop,setWidth:AJS.$.noop,setPosition:AJS.$.noop,hide:AJS.$.noop};this.listController=new AJS.List({stallEventBind:this.options.stallEventBind,containerSelector:AJS.$(".aui-list",this.$container),scrollContainer:".aui-list-scroll",selectionEvent:"change",delegateTarget:this.$field,hasLinks:false,itemSelector:".check-list-item",groupSelector:"ul.aui-list-section",matchingStrategy:this.options.matchingStrategy,maxInlineResultsDisplayed:this.options.maxInlineResultsDisplayed,renderers:{suggestion:this._renders.suggestionItem},selectionHandler:function(e){var focusedItem;if(e.type==="change"){focusedItem=AJS.$(e.target).closest(this.options.itemSelector)}else{focusedItem=this.getFocused()}instance._selectionHandler(focusedItem,e);return false}});this._assignEventsToFurniture();this.render();this.model.$element.addClass("check-list-select-select").trigger("initialized",[this]);JIRA.trigger(JIRA.Events.CHECKBOXMULITSELECT_READY,[this.model.$element,this]);return this},_handleCharacterInput:function(force){AJS.$.each(this.listController.$container.find(".invalid-item"),function(){AJS.$(this).tipsy("hide")});this.requestSuggestions(force).done(_.bind(function(suggestions){this._setSuggestions(suggestions)},this));this.$dropDownIcon.toggleClass("clear-field",!!this.getQueryVal());this.listController.moveToFirst()},_getDefaultOptions:function(){return AJS.$.extend(true,this._super(),{errorMessage:"The value {0} is invalid.",stallEventBind:true})},_createFurniture:function(){var id=this.model.$element.attr("id");this.$container=this._render("container",id);this.$fieldContainer=this._render("fieldContainer").appendTo(this.$container);this.$field=this._render("field",id,this._getPlaceholderText()).appendTo(this.$fieldContainer);this.$container.append(this._render("suggestionsContainer",id));this.$container.insertBefore(this.model.$element);this.$dropDownIcon=this._render("dropdownAndLoadingIcon").appendTo(this.$fieldContainer)},_getPlaceholderText:function(){var placeholderText=AJS.$.trim(this.model.$element.data("placeholder-text"));return(placeholderText&&placeholderText!=="")?placeholderText:"Search"},_assignEventsToFurniture:function(){var instance=this;this._assignEvents("body",document);if(this.options.stallEventBind){window.setTimeout(function(){instance._assignEvents("field",instance.$field)._assignEvents("keys",instance.$field)._assignEvents("container",instance.$container)._assignEvents("fieldIcon",instance.$dropDownIcon)},0)}else{instance._assignEvents("field",instance.$field)._assignEvents("keys",instance.$field)._assignEvents("fieldIcon",instance.$dropDownIcon)}this.listController.$container.delegate(".clear-all","click",function(event){event.preventDefault();var $clearAll=jQuery(event.target);if($clearAll.hasClass("disabled")){return }$clearAll.parent().remove();instance.clear()})},clear:function(){var instance=this;var selectedDescriptors=this.model.getDisplayableSelectedDescriptors();this.model.setAllUnSelected();if(this.$field.val().length===0){this.$field.val("");this.listController.$container.find(":checkbox").removeAttr("checked")}else{this.clearQueryField();this.listController.moveToFirst()}this._toggleClearButton();jQuery.each(selectedDescriptors,function(){instance.model.$element.trigger("unselect",[this,instance,true])})},clearQueryField:function(){this.$field.val("");this._handleCharacterInput(true);this.$field.focus()},unselectItem:function(descriptor){this.model.setUnSelected(descriptor);this.model.$element.trigger("unselect",[descriptor,this,false]);this.$container.find(".aui-list input[type=checkbox]").each(function(){if(this.value===descriptor.value()){this.checked=false}})},_handleEscape:function(e){var $field=this.$field;if(e.type==="keydown"&&$field.val()!==""){e.stopPropagation();$field.val("");$field.on("keyup",handleEscKeyUp);this._handleCharacterInput(true)}function handleEscKeyUp(event){if(event.keyCode===27){event.stopPropagation();$field.off("keyup",handleEscKeyUp)}}},selectItem:function(descriptor,initialize){this.model.setSelected(descriptor);if(!initialize){this.model.$element.trigger("selected",[descriptor,this])}this.$container.find(".aui-list input[type=checkbox]").each(function(){if(this.value===descriptor.value()){this.checked=true}})},_selectionHandler:function(selected,event){var instance=this;selected.each(function(){var descriptor=AJS.$.data(this,"descriptor"),$input=AJS.$(this).find(":input");if(instance._directCheckboxClick||event.shiftKey){descriptor.properties.fromCheckbox=true}instance._setDescriptorSelection(descriptor,$input)});this._toggleClearButton()},_toggleClearButton:function(){var hasSelection=this.model.getSelectedValues().length>0;this.listController.$container.find(".clear-all").attr("tabindex",hasSelection?null:-1).closest(".check-list-group-actions").toggleClass("hidden",!hasSelection)},_setDescriptorSelection:function(descriptor,$input){if(!descriptor.selected()){this.selectItem(descriptor);$input.attr("checked","checked")}else{this.unselectItem(descriptor);$input.removeAttr("checked")}},render:function(){this._handleCharacterInput(true)},_events:{field:{"keydown":function(event){if(event.keyCode===13){event.preventDefault();var instance=this;this.model.$element.bind("unselect selected",handleSelected);setTimeout(function(){instance.model.$element.unbind("unselect selected",handleSelected)},0)}function handleSelected(){if(jQuery.trim(instance.$field.val())!==""){instance.$field.val("");instance._handleCharacterInput(true)}}}},container:{mousedown:function(event){var instance=this;function onmouseup(event){if(event.type==="mouseup"){instance._directCheckboxClick=true;setTimeout(function(){instance._directCheckboxClick=false},40)}jQuery(document).unbind("mouseup mouseleave",onmouseup)}if(jQuery(event.target).is("input[type=checkbox]")){jQuery(document).unbind("mouseup mouseleave",onmouseup).bind("mouseup mouseleave",onmouseup)}if(event.target!==this.$field.get(0)){event.preventDefault()}},click:function(){if(this.$field.get(0)!==document.activeElement){this.$field.focus()}}},fieldIcon:{click:function(e){if(AJS.$(e.target).hasClass("clear-field")){this.clearQueryField()}}}},_renders:{errorMessage:function(idPrefix){return AJS.$('<div class="error" />').attr("id",idPrefix+"-error")},fieldContainer:function(){return AJS.$("<div class='check-list-field-container' />")},field:function(idPrefix,placeholderText){return jQuery("<input>").attr({"autocomplete":"off","placeholder":placeholderText,"class":"aui-field check-list-field","id":idPrefix+"-input","wrap":"off"})},disableSelectField:function(id){return AJS.$("<input type='text' class='long-field' name='"+id+"' id='"+id+"' />")},container:function(idPrefix){return AJS.$('<div class="check-list-select" id="'+idPrefix+'-multi-select">')},suggestionsContainer:function(idPrefix){return AJS.$('<div class="aui-list" id="'+idPrefix+'-suggestions"></div>')},suggestionItem:function(descriptor,replacementText){var $checkbox=AJS.$("<input type='checkbox' tabindex='-1' />").val(descriptor.value()),$listElem=AJS.$('<li class="check-list-item">'),$label=AJS.$("<label class='item-label' />"),$tipsyTarget,$img;if(descriptor.styleClass()){$listElem.addClass(descriptor.styleClass())}if(replacementText){$label.html(replacementText)}else{if(descriptor.html()){$label.html(descriptor.html())}else{$label.text(descriptor.label())}}if(descriptor.selected()){$checkbox.attr("checked","checked")}if(descriptor.icon()&&descriptor.icon()!=="none"){$img=AJS.$("<img src='"+descriptor.icon()+"' height='16' width='16' align='absmiddle' />");if(descriptor.fallbackIcon()&&descriptor.fallbackIcon()!=="none"){$img.one("error",function(){this.src=descriptor.fallbackIcon()})}$label.prepend($img)}if(descriptor.title()){$label.attr("title",descriptor.title())}if(descriptor.disabled()){$listElem.addClass("disabled");$checkbox.attr("disabled","disabled")}$label.prepend($checkbox);if(descriptor.invalid()||descriptor.disabled()){$listElem.addClass("has-invalid-item");$label.append("<span class='invalid-item'></span>");$tipsyTarget=$label.find(".invalid-item");_.defer(function(){$listElem.attr("original-title",$listElem.attr("title"));$listElem.removeAttr("title")});var title;if(descriptor.title()){title=descriptor.title();$label.attr("original-title",title);$label.removeAttr("title")}else{title=AJS.format("{0} \'\'{1}\'\' is not valid for your current Project(s) and\/or Issue Type(s) selection","Value",descriptor.label())}$tipsyTarget.tipsy({title:function(){return title},className:"tipsy-front",trigger:"manual"});$tipsyTarget.hoverIntent({interval:200,over:function(){$tipsyTarget.tipsy("show")},out:function(){$tipsyTarget.tipsy("hide")}})}return $listElem.append($label).data("descriptor",descriptor)}},handleFreeInput:jQuery.noop,hideSuggestions:jQuery.noop,showErrorMessage:jQuery.noop,_deactivate:jQuery.noop});JIRA.Events.CHECKBOXMULITSELECT_READY="checkboxMultiSelectReady";
/* module-key = 'jira.webresources:general-configuration', location = '/includes/jira/general-configuration/Settings.js' */
JIRA.Settings={};JIRA.Settings.ApplicationTitle={get:function(){return AJS.Meta.get("app-title")}};
/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy/atlassian/atlassian.soy' */
// This file was automatically generated from atlassian.soy.
// Please don't edit this file by hand.

if (typeof aui == 'undefined') { var aui = {}; }


aui.renderExtraAttributes = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data != null && opt_data.extraAttributes) {
    if (Object.prototype.toString.call(opt_data.extraAttributes) === '[object Object]') {
      var attrList7 = soy.$$getMapKeys(opt_data.extraAttributes);
      var attrListLen7 = attrList7.length;
      for (var attrIndex7 = 0; attrIndex7 < attrListLen7; attrIndex7++) {
        var attrData7 = attrList7[attrIndex7];
        output.append(' ', soy.$$escapeHtml(attrData7), '="', soy.$$escapeHtml(opt_data.extraAttributes[attrData7]), '"');
      }
    } else {
      output.append(' ', opt_data.extraAttributes);
    }
  }
  return opt_sb ? '' : output.toString();
};


aui.renderExtraClasses = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data != null && opt_data.extraClasses) {
    if (opt_data.isFullAttr) {
      output.append(' class="');
      if ((opt_data.extraClasses) instanceof Array) {
        var classList26 = opt_data.extraClasses;
        var classListLen26 = classList26.length;
        for (var classIndex26 = 0; classIndex26 < classListLen26; classIndex26++) {
          var classData26 = classList26[classIndex26];
          output.append((! (classIndex26 == 0)) ? ' ' : '', soy.$$escapeHtml(classData26));
        }
      } else {
        output.append(soy.$$escapeHtml(opt_data.extraClasses));
      }
      output.append('"');
    } else {
      if ((opt_data.extraClasses) instanceof Array) {
        var classList38 = opt_data.extraClasses;
        var classListLen38 = classList38.length;
        for (var classIndex38 = 0; classIndex38 < classListLen38; classIndex38++) {
          var classData38 = classList38[classIndex38];
          output.append(' ', soy.$$escapeHtml(classData38));
        }
      } else {
        output.append(' ', soy.$$escapeHtml(opt_data.extraClasses));
      }
    }
  }
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy/atlassian/badges.soy' */
// This file was automatically generated from badges.soy.
// Please don't edit this file by hand.

if (typeof aui == 'undefined') { var aui = {}; }
if (typeof aui.badges == 'undefined') { aui.badges = {}; }


aui.badges.badge = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'span'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-badge');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', soy.$$escapeHtml(opt_data.text), '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'span'), '>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy/atlassian/buttons.soy' */
// This file was automatically generated from buttons.soy.
// Please don't edit this file by hand.

if (typeof aui == 'undefined') { var aui = {}; }
if (typeof aui.buttons == 'undefined') { aui.buttons = {}; }


aui.buttons.button = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.tagName == 'input') {
    output.append('<input type="', soy.$$escapeHtml(opt_data.inputType ? opt_data.inputType : 'button'), '" ');
    aui.buttons.buttonAttributes(opt_data, output);
    output.append(' value="', soy.$$escapeHtml(opt_data.text), '" />');
  } else {
    output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'button'), ' ');
    aui.buttons.buttonAttributes(opt_data, output);
    output.append('>');
    aui.buttons.buttonIcon(opt_data, output);
    output.append(soy.$$escapeHtml(opt_data.text), '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'button'), '>');
  }
  return opt_sb ? '' : output.toString();
};


aui.buttons.buttons = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-buttons');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</div>');
  return opt_sb ? '' : output.toString();
};


aui.buttons.buttonAttributes = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-button', (opt_data.splitButtonType == 'main') ? ' aui-button-split-main' : '', (opt_data.dropdown2Target) ? ' aui-dropdown2-trigger' + ((opt_data.splitButtonType == 'more') ? ' aui-button-split-more' : '') : '');
  switch (opt_data.type) {
    case 'primary':
      output.append(' aui-button-primary');
      break;
    case 'link':
      output.append(' aui-button-link');
      break;
    case 'subtle':
      output.append(' aui-button-subtle');
      break;
  }
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append((opt_data.isPressed) ? ' aria-pressed="' + soy.$$escapeHtml(opt_data.isPressed) + '"' : '', (opt_data.isDisabled) ? ' aria-disabled="' + soy.$$escapeHtml(opt_data.isDisabled) + '"' + ((opt_data.isDisabled == true) ? (opt_data.tagName == 'button' || opt_data.tagName == 'input') ? ' disabled="disabled" ' : '' : '') : '', (opt_data.dropdown2Target) ? ' aria-owns="' + soy.$$escapeHtml(opt_data.dropdown2Target) + '" aria-haspopup="true"' : '');
  return opt_sb ? '' : output.toString();
};


aui.buttons.buttonIcon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.iconType) ? '<span class="' + ((opt_data.iconType == 'aui') ? 'aui-icon' : '') + ((opt_data.iconClass) ? ' ' + soy.$$escapeHtml(opt_data.iconClass) : '') + '">' + ((opt_data.iconText) ? soy.$$escapeHtml(opt_data.iconText) + ' ' : '') + '</span>' : '');
  return opt_sb ? '' : output.toString();
};


aui.buttons.splitButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.buttons.button(soy.$$augmentData(opt_data.splitButtonMain, {splitButtonType: 'main'}), output);
  aui.buttons.button(soy.$$augmentData(opt_data.splitButtonMore, {splitButtonType: 'more'}), output);
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy/atlassian/dropdown.soy' */
// This file was automatically generated from dropdown.soy.
// Please don't edit this file by hand.

if (typeof aui == 'undefined') { var aui = {}; }
if (typeof aui.dropdown == 'undefined') { aui.dropdown = {}; }


aui.dropdown.trigger = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-dd-trigger');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('><span class="dropdown-text">', (opt_data.accessibilityText) ? soy.$$escapeHtml(opt_data.accessibilityText) : '', '</span>', (! (opt_data.showIcon == false)) ? '<span class="icon icon-dropdown"></span>' : '', '</a>');
  return opt_sb ? '' : output.toString();
};


aui.dropdown.menu = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'ul'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-dropdown hidden');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'ul'), '>');
  return opt_sb ? '' : output.toString();
};


aui.dropdown.parent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-dd-parent');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), '>');
  return opt_sb ? '' : output.toString();
};


aui.dropdown.item = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'li'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="dropdown-item');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('><a href="', soy.$$escapeHtml(opt_data.url ? opt_data.url : '#'), '">', soy.$$escapeHtml(opt_data.text), '</a></', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'li'), '>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy/atlassian/dropdown2.soy' */
// This file was automatically generated from dropdown2.soy.
// Please don't edit this file by hand.

if (typeof aui == 'undefined') { var aui = {}; }
if (typeof aui.dropdown2 == 'undefined') { aui.dropdown2 = {}; }


aui.dropdown2.dropdown2 = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.dropdown2.trigger(soy.$$augmentData(opt_data.trigger, {menu: opt_data.menu}), output);
  aui.dropdown2.contents(opt_data.menu, output);
  return opt_sb ? '' : output.toString();
};


aui.dropdown2.trigger = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'a'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-dropdown2-trigger');
  aui.renderExtraClasses(opt_data, output);
  output.append('" aria-owns="', soy.$$escapeHtml(opt_data.menu.id), '" aria-haspopup="true"', (opt_data.title) ? ' title="' + soy.$$escapeHtml(opt_data.title) + '"' : '', (opt_data.container) ? ' data-container="' + soy.$$escapeHtml(opt_data.container) + '"' : '', ((! opt_data.tagName || opt_data.tagName == 'a') && (! opt_data.extraAttributes || Object.prototype.toString.call(opt_data.extraAttributes) === '[object Object]' && ! opt_data.extraAttributes.href && ! opt_data.extraAttributes.tabindex)) ? ' tabindex="0"' : '');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', (opt_data.content) ? opt_data.content : '', (opt_data.text) ? soy.$$escapeHtml(opt_data.text) : '', (! (opt_data.showIcon == false)) ? '<span class="icon aui-icon-dropdown"></span>' : '', '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'a'), '>');
  return opt_sb ? '' : output.toString();
};


aui.dropdown2.contents = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="', soy.$$escapeHtml(opt_data.id), '" class="aui-dropdown2');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', (opt_data.content) ? opt_data.content : '', '</div>');
  return opt_sb ? '' : output.toString();
};


aui.dropdown2.section = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-dropdown2-section');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', (opt_data.label) ? '<strong>' + soy.$$escapeHtml(opt_data.label) + '</strong>' : '', opt_data.content, '</div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy/atlassian/form.soy' */
// This file was automatically generated from form.soy.
// Please don't edit this file by hand.

if (typeof aui == 'undefined') { var aui = {}; }
if (typeof aui.form == 'undefined') { aui.form = {}; }


aui.form.form = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui', (opt_data.isUnsectioned) ? ' unsectioned' : '', (opt_data.isLongLabels) ? ' long-label' : '', (opt_data.isTopLabels) ? ' top-label' : '');
  aui.renderExtraClasses(opt_data, output);
  output.append('" action="', soy.$$escapeHtml(opt_data.action), '" method="', soy.$$escapeHtml(opt_data.method ? opt_data.method : 'post'), '"', (opt_data.enctype) ? 'enctype="' + soy.$$escapeHtml(opt_data.enctype) + '"' : '');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</form>');
  return opt_sb ? '' : output.toString();
};


aui.form.formDescription = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="field-group');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</div>');
  return opt_sb ? '' : output.toString();
};


aui.form.fieldset = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var hasClass__soy51 = opt_data.isInline || opt_data.isDateSelect || opt_data.isGroup || opt_data.extraClasses;
  output.append('<fieldset', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '');
  if (hasClass__soy51) {
    output.append(' class="', soy.$$escapeHtml(opt_data.isInline ? 'inline' : opt_data.isDateSelect ? 'date-select' : opt_data.isGroup ? 'group' : ''));
    aui.renderExtraClasses(opt_data, output);
    output.append('"');
  }
  aui.renderExtraAttributes(opt_data, output);
  output.append('><legend><span>', opt_data.legendContent, '</span></legend>', opt_data.content, '</fieldset>');
  return opt_sb ? '' : output.toString();
};


aui.form.fieldGroup = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="field-group');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</div>');
  return opt_sb ? '' : output.toString();
};


aui.form.buttons = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="buttons-container', (opt_data.alignment) ? ' ' + soy.$$escapeHtml(opt_data.alignment) : '', '"><div class="buttons">', opt_data.content, '</div></div>');
  return opt_sb ? '' : output.toString();
};


aui.form.label = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<label', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' for="', soy.$$escapeHtml(opt_data.forField), '"');
  aui.renderExtraClasses(soy.$$augmentData(opt_data, {isFullAttr: true}), output);
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, (opt_data.isRequired) ? '<span class="aui-icon icon-required"></span>' : '', '</label>');
  return opt_sb ? '' : output.toString();
};


aui.form.input = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="', soy.$$escapeHtml(opt_data.type == 'password' ? 'text' : opt_data.type == 'submit' ? 'button' : opt_data.type));
  aui.renderExtraClasses(opt_data, output);
  output.append('" type="', soy.$$escapeHtml(opt_data.type), '" name="', (opt_data.name) ? soy.$$escapeHtml(opt_data.name) : soy.$$escapeHtml(opt_data.id), '"', (opt_data.value) ? ' value="' + soy.$$escapeHtml(opt_data.value) + '"' : '', ((opt_data.type == 'checkbox' || opt_data.type == 'radio') && opt_data.isChecked) ? ' checked="checked"' : '', (opt_data.type == 'text' && opt_data.maxLength) ? ' maxlength="' + soy.$$escapeHtml(opt_data.maxLength) + '"' : '', (opt_data.type == 'text' && opt_data.size) ? ' size="' + soy.$$escapeHtml(opt_data.size) + '"' : '', (opt_data.isDisabled) ? ' disabled' : '');
  aui.renderExtraAttributes(opt_data, output);
  output.append('/>');
  return opt_sb ? '' : output.toString();
};


aui.form.submit = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.form.input({id: opt_data.id, name: opt_data.name, type: 'submit', value: opt_data.text, isDisabled: opt_data.isDisabled, extraClasses: opt_data.extraClasses, extraAttributes: opt_data.extraAttributes}, output);
  return opt_sb ? '' : output.toString();
};


aui.form.button = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.form.input({id: opt_data.id, name: opt_data.name, type: 'button', value: opt_data.text, isDisabled: opt_data.isDisabled, extraClasses: opt_data.extraClasses, extraAttributes: opt_data.extraAttributes}, output);
  return opt_sb ? '' : output.toString();
};


aui.form.linkButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' name="', soy.$$escapeHtml(opt_data.name ? opt_data.name : opt_data.id), '" href="', soy.$$escapeHtml(opt_data.url ? opt_data.url : '#'), '" class="cancel');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', soy.$$escapeHtml(opt_data.text), '</a>');
  return opt_sb ? '' : output.toString();
};


aui.form.textarea = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<textarea', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' name="', (opt_data.name) ? soy.$$escapeHtml(opt_data.name) : soy.$$escapeHtml(opt_data.id), '" class="textarea');
  aui.renderExtraClasses(opt_data, output);
  output.append('"', (opt_data.rows) ? ' rows="' + soy.$$escapeHtml(opt_data.rows) + '"' : '', (opt_data.cols) ? ' cols="' + soy.$$escapeHtml(opt_data.cols) + '"' : '', (opt_data.isDisabled) ? ' disabled' : '');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', (opt_data.value) ? soy.$$escapeHtml(opt_data.value) : '', '</textarea>');
  return opt_sb ? '' : output.toString();
};


aui.form.select = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<select', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' name="', (opt_data.name) ? soy.$$escapeHtml(opt_data.name) : soy.$$escapeHtml(opt_data.id), '" class="', soy.$$escapeHtml(opt_data.isMultiple ? 'multi-select' : 'select'));
  aui.renderExtraClasses(opt_data, output);
  output.append('"', (opt_data.size) ? ' size="' + soy.$$escapeHtml(opt_data.size) + '"' : '', (opt_data.isDisabled) ? ' disabled' : '', (opt_data.isMultiple) ? ' multiple' : '');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>');
  var optionList260 = opt_data.options;
  var optionListLen260 = optionList260.length;
  for (var optionIndex260 = 0; optionIndex260 < optionListLen260; optionIndex260++) {
    var optionData260 = optionList260[optionIndex260];
    aui.form.optionOrOptgroup(optionData260, output);
  }
  output.append('</select>');
  return opt_sb ? '' : output.toString();
};


aui.form.optionOrOptgroup = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.options) {
    output.append('<optgroup label="', soy.$$escapeHtml(opt_data.text), '">');
    var optionList270 = opt_data.options;
    var optionListLen270 = optionList270.length;
    for (var optionIndex270 = 0; optionIndex270 < optionListLen270; optionIndex270++) {
      var optionData270 = optionList270[optionIndex270];
      aui.form.optionOrOptgroup(optionData270, output);
    }
    output.append('</optgroup>');
  } else {
    output.append('<option value="', soy.$$escapeHtml(opt_data.value), '" ', (opt_data.selected) ? 'selected' : '', '>', soy.$$escapeHtml(opt_data.text), '</option>');
  }
  return opt_sb ? '' : output.toString();
};


aui.form.value = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="field-value');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</span>');
  return opt_sb ? '' : output.toString();
};


aui.form.field = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var isCheckboxOrRadio__soy300 = opt_data.type == 'checkbox' || opt_data.type == 'radio';
  output.append('<div class="', (isCheckboxOrRadio__soy300) ? soy.$$escapeHtml(opt_data.type) : 'field-group');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>');
  if (opt_data.labelContent && ! isCheckboxOrRadio__soy300) {
    aui.form.label({forField: opt_data.id, isRequired: opt_data.isRequired, content: opt_data.labelContent}, output);
  }
  switch (opt_data.type) {
    case 'textarea':
      aui.form.textarea({id: opt_data.id, name: opt_data.name, value: opt_data.value, rows: opt_data.rows, cols: opt_data.cols, isDisabled: opt_data.isDisabled ? true : false}, output);
      break;
    case 'select':
      aui.form.select({id: opt_data.id, name: opt_data.name, options: opt_data.options, isMultiple: opt_data.isMultiple, size: opt_data.size, isDisabled: opt_data.isDisabled ? true : false}, output);
      break;
    case 'value':
      aui.form.value({id: opt_data.id, content: soy.$$escapeHtml(opt_data.value)}, output);
      break;
    case 'text':
    case 'password':
    case 'file':
    case 'radio':
    case 'checkbox':
    case 'button':
    case 'submit':
    case 'reset':
      aui.form.input({id: opt_data.id, name: opt_data.name, type: opt_data.type, value: opt_data.value, maxLength: opt_data.maxLength, size: opt_data.size, isChecked: opt_data.isChecked, isDisabled: opt_data.isDisabled ? true : false}, output);
      break;
  }
  if (opt_data.labelContent && isCheckboxOrRadio__soy300) {
    aui.form.label({forField: opt_data.id, isRequired: opt_data.isRequired, content: opt_data.labelContent}, output);
  }
  if (opt_data.descriptionText) {
    aui.form.fieldDescription({message: opt_data.descriptionText}, output);
  }
  if (opt_data.errorTexts) {
    var errorList362 = opt_data.errorTexts;
    var errorListLen362 = errorList362.length;
    for (var errorIndex362 = 0; errorIndex362 < errorListLen362; errorIndex362++) {
      var errorData362 = errorList362[errorIndex362];
      aui.form.fieldError({message: errorData362}, output);
    }
  }
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


aui.form.fieldError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="error');
  aui.renderExtraClasses(opt_data, output);
  output.append('">', soy.$$escapeHtml(opt_data.message), '</div>');
  return opt_sb ? '' : output.toString();
};


aui.form.fieldDescription = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="description');
  aui.renderExtraClasses(opt_data, output);
  output.append('">', soy.$$escapeHtml(opt_data.message), '</div>');
  return opt_sb ? '' : output.toString();
};


aui.form.textField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.form.field({id: opt_data.id, name: opt_data.name, type: 'text', labelContent: opt_data.labelContent, value: opt_data.value, maxLength: opt_data.maxLength, size: opt_data.size, isRequired: opt_data.isRequired, isDisabled: opt_data.isDisabled, descriptionText: opt_data.descriptionText, errorTexts: opt_data.errorTexts, extraClasses: opt_data.extraClasses, extraAttributes: opt_data.extraAttributes}, output);
  return opt_sb ? '' : output.toString();
};


aui.form.textareaField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.form.field({id: opt_data.id, name: opt_data.name, type: 'textarea', labelContent: opt_data.labelContent, value: opt_data.value, rows: opt_data.rows, cols: opt_data.cols, isRequired: opt_data.isRequired, isDisabled: opt_data.isDisabled, descriptionText: opt_data.descriptionText, errorTexts: opt_data.errorTexts, extraClasses: opt_data.extraClasses, extraAttributes: opt_data.extraAttributes}, output);
  return opt_sb ? '' : output.toString();
};


aui.form.passwordField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.form.field({id: opt_data.id, name: opt_data.name, type: 'password', labelContent: opt_data.labelContent, value: opt_data.value, isRequired: opt_data.isRequired, isDisabled: opt_data.isDisabled, descriptionText: opt_data.descriptionText, errorTexts: opt_data.errorTexts, extraClasses: opt_data.extraClasses, extraAttributes: opt_data.extraAttributes}, output);
  return opt_sb ? '' : output.toString();
};


aui.form.fileField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.form.field({id: opt_data.id, name: opt_data.name, type: 'file', labelContent: opt_data.labelContent, value: opt_data.value, isRequired: opt_data.isRequired, isDisabled: opt_data.isDisabled, descriptionText: opt_data.descriptionText, errorTexts: opt_data.errorTexts, extraClasses: opt_data.extraClasses, extraAttributes: opt_data.extraAttributes}, output);
  return opt_sb ? '' : output.toString();
};


aui.form.selectField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.form.field({id: opt_data.id, name: opt_data.name, type: 'select', labelContent: opt_data.labelContent, options: opt_data.options, isMultiple: opt_data.isMultiple, size: opt_data.size, isRequired: opt_data.isRequired, isDisabled: opt_data.isDisabled, descriptionText: opt_data.descriptionText, errorTexts: opt_data.errorTexts, extraClasses: opt_data.extraClasses, extraAttributes: opt_data.extraAttributes}, output);
  return opt_sb ? '' : output.toString();
};


aui.form.checkboxField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param456 = new soy.StringBuilder((opt_data.isMatrix) ? '<div class="matrix">' : '');
  var fieldList460 = opt_data.fields;
  var fieldListLen460 = fieldList460.length;
  for (var fieldIndex460 = 0; fieldIndex460 < fieldListLen460; fieldIndex460++) {
    var fieldData460 = fieldList460[fieldIndex460];
    aui.form.field(soy.$$augmentData(fieldData460, {type: 'checkbox', id: fieldData460.id, name: fieldData460.name, labelContent: soy.$$escapeHtml(fieldData460.labelText), isChecked: fieldData460.isChecked, isDisabled: fieldData460.isDisabled, descriptionText: fieldData460.descriptionText, errorTexts: fieldData460.errorTexts, extraClasses: fieldData460.extraClasses, extraAttributes: fieldData460.extraAttributes}), param456);
  }
  param456.append((opt_data.isMatrix) ? '</div>' : '');
  if (opt_data.descriptionText || opt_data.errorTexts && opt_data.errorTexts.length) {
    aui.form.field({descriptionText: opt_data.descriptionText, errorTexts: opt_data.errorTexts, isDisabled: false}, param456);
  }
  aui.form.fieldset({legendContent: opt_data.legendContent + (opt_data.isRequired ? '<span class="aui-icon icon-required"></span>' : ''), isGroup: true, id: opt_data.id, extraClasses: opt_data.extraClasses, extraAttributes: opt_data.extraAttributes, content: param456.toString()}, output);
  return opt_sb ? '' : output.toString();
};


aui.form.radioField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param490 = new soy.StringBuilder((opt_data.isMatrix) ? '<div class="matrix">' : '');
  var fieldList494 = opt_data.fields;
  var fieldListLen494 = fieldList494.length;
  for (var fieldIndex494 = 0; fieldIndex494 < fieldListLen494; fieldIndex494++) {
    var fieldData494 = fieldList494[fieldIndex494];
    aui.form.field(soy.$$augmentData(fieldData494, {type: 'radio', name: opt_data.name ? opt_data.name : opt_data.id, value: fieldData494.value, id: fieldData494.id, labelContent: soy.$$escapeHtml(fieldData494.labelText), isChecked: fieldData494.isChecked, isDisabled: fieldData494.isDisabled, descriptionText: fieldData494.descriptionText, errorTexts: fieldData494.errorTexts, extraClasses: fieldData494.extraClasses, extraAttributes: fieldData494.extraAttributes}), param490);
  }
  param490.append((opt_data.isMatrix) ? '</div>' : '');
  if (opt_data.descriptionText || opt_data.errorTexts && opt_data.errorTexts.length) {
    aui.form.field({descriptionText: opt_data.descriptionText, errorTexts: opt_data.errorTexts, isDisabled: false}, param490);
  }
  aui.form.fieldset({legendContent: opt_data.legendContent + (opt_data.isRequired ? '<span class="aui-icon icon-required"></span>' : ''), isGroup: true, id: opt_data.id, extraClasses: opt_data.extraClasses, extraAttributes: opt_data.extraAttributes, content: param490.toString()}, output);
  return opt_sb ? '' : output.toString();
};


aui.form.valueField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.form.field({id: opt_data.id, type: 'value', value: opt_data.value, labelContent: opt_data.labelContent, isRequired: opt_data.isRequired, descriptionText: opt_data.descriptionText, errorTexts: opt_data.errorTexts, extraClasses: opt_data.extraClasses, extraAttributes: opt_data.extraAttributes}, output);
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy/atlassian/group.soy' */
// This file was automatically generated from group.soy.
// Please don't edit this file by hand.

if (typeof aui == 'undefined') { var aui = {}; }
if (typeof aui.group == 'undefined') { aui.group = {}; }


aui.group.group = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-group', (opt_data.isSplit) ? ' aui-group-split' : '');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), '>');
  return opt_sb ? '' : output.toString();
};


aui.group.item = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-item');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), '>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy/atlassian/labels.soy' */
// This file was automatically generated from labels.soy.
// Please don't edit this file by hand.

if (typeof aui == 'undefined') { var aui = {}; }
if (typeof aui.labels == 'undefined') { aui.labels = {}; }


aui.labels.label = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.url && opt_data.isCloseable == true) {
    output.append('<span', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-label aui-label-closeable aui-label-split');
    aui.renderExtraClasses(opt_data, output);
    output.append('"');
    aui.renderExtraAttributes(opt_data, output);
    output.append('><a class="aui-label-split-main" href="', soy.$$escapeHtml(opt_data.url), '">', soy.$$escapeHtml(opt_data.text), '</a><span class="aui-label-split-close" >');
    aui.labels.closeIcon(opt_data, output);
    output.append('</span></span>');
  } else {
    output.append('<', soy.$$escapeHtml(opt_data.url ? 'a' : 'span'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-label', (opt_data.isCloseable) ? ' aui-label-closeable' : '');
    aui.renderExtraClasses(opt_data, output);
    output.append('"');
    aui.renderExtraAttributes(opt_data, output);
    output.append((opt_data.url) ? ' href="' + soy.$$escapeHtml(opt_data.url) + '"' : '', '>', soy.$$escapeHtml(opt_data.text));
    if (opt_data.isCloseable) {
      aui.labels.closeIcon(opt_data, output);
    }
    output.append('</', soy.$$escapeHtml(opt_data.url ? 'a' : 'span'), '>');
  }
  return opt_sb ? '' : output.toString();
};


aui.labels.closeIcon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span tabindex="0" class="aui-icon aui-icon-close"');
  if (opt_data.hasTitle != false) {
    output.append(' title="');
    aui.labels.closeIconText(opt_data, output);
    output.append('"');
  }
  output.append('>');
  aui.labels.closeIconText(opt_data, output);
  output.append('</span>');
  return opt_sb ? '' : output.toString();
};


aui.labels.closeIconText = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.closeIconText) ? soy.$$escapeHtml(opt_data.closeIconText) : '(' + soy.$$escapeHtml("Remove") + ' ' + soy.$$escapeHtml(opt_data.text) + ')');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy/atlassian/message.soy' */
// This file was automatically generated from message.soy.
// Please don't edit this file by hand.

if (typeof aui == 'undefined') { var aui = {}; }
if (typeof aui.message == 'undefined') { aui.message = {}; }


aui.message.info = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.message.message(soy.$$augmentData(opt_data, {type: 'info'}), output);
  return opt_sb ? '' : output.toString();
};


aui.message.warning = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.message.message(soy.$$augmentData(opt_data, {type: 'warning'}), output);
  return opt_sb ? '' : output.toString();
};


aui.message.error = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.message.message(soy.$$augmentData(opt_data, {type: 'error'}), output);
  return opt_sb ? '' : output.toString();
};


aui.message.success = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.message.message(soy.$$augmentData(opt_data, {type: 'success'}), output);
  return opt_sb ? '' : output.toString();
};


aui.message.hint = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.message.message(soy.$$augmentData(opt_data, {type: 'hint'}), output);
  return opt_sb ? '' : output.toString();
};


aui.message.generic = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.message.message(soy.$$augmentData(opt_data, {type: 'generic'}), output);
  return opt_sb ? '' : output.toString();
};


aui.message.message = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-message ', soy.$$escapeHtml(opt_data.type ? opt_data.type : 'generic'), (opt_data.isCloseable) ? ' closeable' : '', (opt_data.isShadowed) ? ' shadowed' : '');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', (opt_data.titleContent) ? '<p class="title"><strong>' + opt_data.titleContent + '</strong></p>' : '', opt_data.content, '<span class="aui-icon icon-', soy.$$escapeHtml(opt_data.type ? opt_data.type : 'generic'), '"></span>', (opt_data.isCloseable) ? '<span class="aui-icon icon-close" role="button" tabindex="0"></span>' : '', '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), '>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy/atlassian/page.soy' */
// This file was automatically generated from page.soy.
// Please don't edit this file by hand.

if (typeof aui == 'undefined') { var aui = {}; }
if (typeof aui.page == 'undefined') { aui.page = {}; }


aui.page.document = function(opt_data, opt_sb, opt_ijData) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<!DOCTYPE html><html lang="', soy.$$escapeHtml(opt_ijData.language ? opt_ijData.language : 'en'), '"><head><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=EDGE"><title>', soy.$$escapeHtml(opt_data.windowTitle), '</title>', (opt_data.headContent) ? opt_data.headContent : '', '</head><body');
  if (opt_data.pageType) {
    if (opt_data.pageType == 'generic') {
      output.append(' ');
      aui.renderExtraClasses(soy.$$augmentData(opt_data, {isFullAttr: true}), output, opt_ijData);
    } else if (opt_data.pageType == 'focused') {
      output.append(' class="aui-page-focused aui-page-focused-', soy.$$escapeHtml(opt_data.focusedPageSize ? opt_data.focusedPageSize : 'xlarge'));
      aui.renderExtraClasses(opt_data, output, opt_ijData);
      output.append('"');
    } else {
      output.append(' class="aui-page-', soy.$$escapeHtml(opt_data.pageType));
      aui.renderExtraClasses(opt_data, output, opt_ijData);
      output.append('"');
    }
  } else {
    output.append(' class="');
    aui.renderExtraClasses(opt_data, output, opt_ijData);
    output.append('"');
  }
  aui.renderExtraAttributes(opt_data, output, opt_ijData);
  output.append('>', opt_data.content, '</body></html>');
  return opt_sb ? '' : output.toString();
};


aui.page.page = function(opt_data, opt_sb, opt_ijData) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="page"><header id="header" role="banner">', opt_data.headerContent, '</header><!-- #header --><section id="content" role="main">', opt_data.contentContent, '</section><!-- #content --><footer id="footer" role="contentinfo">', opt_data.footerContent, '</footer><!-- #footer --></div><!-- #page -->');
  return opt_sb ? '' : output.toString();
};


aui.page.header = function(opt_data, opt_sb, opt_ijData) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<nav', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-header aui-dropdown2-trigger-group');
  aui.renderExtraClasses(opt_data, output, opt_ijData);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output, opt_ijData);
  output.append(' role="navigation"><div class="aui-header-inner">', (opt_data.headerBeforeContent) ? '<div class="aui-header-before">' + opt_data.headerBeforeContent + '</div>' : '', '<div class="aui-header-primary"><h1 id="logo" class="aui-header-logo', (opt_data.headerLogoImageUrl) ? ' aui-header-logo-custom' : (opt_data.logo) ? ' aui-header-logo-' + soy.$$escapeHtml(opt_data.logo) : '', '"><a href="', soy.$$escapeHtml(opt_data.headerLink ? opt_data.headerLink : '/'), '">', (opt_data.headerLogoImageUrl) ? '<img src="' + soy.$$escapeHtml(opt_data.headerLogoImageUrl) + '" alt="' + soy.$$escapeHtml(opt_data.headerLogoText) + '" />' : '<span class="aui-header-logo-device">' + soy.$$escapeHtml(opt_data.headerLogoText ? opt_data.headerLogoText : '') + '</span>', (opt_data.headerText) ? '<span class="aui-header-logo-text">' + soy.$$escapeHtml(opt_data.headerText) + '</span>' : '', '</a></h1>', (opt_data.primaryNavContent) ? opt_data.primaryNavContent : '', '</div>', (opt_data.secondaryNavContent) ? '<div class="aui-header-secondary">' + opt_data.secondaryNavContent + '</div>' : '', (opt_data.headerAfterContent) ? '<div class="aui-header-after">' + opt_data.headerAfterContent + '</div>' : '', '</div><!-- .aui-header-inner--></nav><!-- .aui-header -->');
  return opt_sb ? '' : output.toString();
};


aui.page.pagePanel = function(opt_data, opt_sb, opt_ijData) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), ' class="aui-page-panel');
  aui.renderExtraClasses(opt_data, output, opt_ijData);
  output.append('"', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '');
  aui.renderExtraAttributes(opt_data, output, opt_ijData);
  output.append('><div class="aui-page-panel-inner">', opt_data.content, '</div><!-- .aui-page-panel-inner --></', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), '><!-- .aui-page-panel -->');
  return opt_sb ? '' : output.toString();
};


aui.page.pagePanelNav = function(opt_data, opt_sb, opt_ijData) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), ' class="aui-page-panel-nav');
  aui.renderExtraClasses(opt_data, output, opt_ijData);
  output.append('"', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '');
  aui.renderExtraAttributes(opt_data, output, opt_ijData);
  output.append('>', opt_data.content, '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), '><!-- .aui-page-panel-nav -->');
  return opt_sb ? '' : output.toString();
};


aui.page.pagePanelContent = function(opt_data, opt_sb, opt_ijData) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'section'), ' class="aui-page-panel-content');
  aui.renderExtraClasses(opt_data, output, opt_ijData);
  output.append('"', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '');
  aui.renderExtraAttributes(opt_data, output, opt_ijData);
  output.append('>', opt_data.content, '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'section'), '><!-- .aui-page-panel-content -->');
  return opt_sb ? '' : output.toString();
};


aui.page.pagePanelSidebar = function(opt_data, opt_sb, opt_ijData) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'aside'), ' class="aui-page-panel-sidebar');
  aui.renderExtraClasses(opt_data, output, opt_ijData);
  output.append('"', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '');
  aui.renderExtraAttributes(opt_data, output, opt_ijData);
  output.append('>', opt_data.content, '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'aside'), '><!-- .aui-page-panel-sidebar -->');
  return opt_sb ? '' : output.toString();
};


aui.page.pagePanelItem = function(opt_data, opt_sb, opt_ijData) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'section'), ' class="aui-page-panel-item');
  aui.renderExtraClasses(opt_data, output, opt_ijData);
  output.append('"', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '');
  aui.renderExtraAttributes(opt_data, output, opt_ijData);
  output.append('>', opt_data.content, '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'section'), '><!-- .aui-page-panel-item -->');
  return opt_sb ? '' : output.toString();
};


aui.page.pageHeader = function(opt_data, opt_sb, opt_ijData) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<header class="aui-page-header');
  aui.renderExtraClasses(opt_data, output, opt_ijData);
  output.append('"', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '');
  aui.renderExtraAttributes(opt_data, output, opt_ijData);
  output.append('><div class="aui-page-header-inner">', opt_data.content, '</div><!-- .aui-page-header-inner --></header><!-- .aui-page-header -->');
  return opt_sb ? '' : output.toString();
};


aui.page.pageHeaderImage = function(opt_data, opt_sb, opt_ijData) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-page-header-image');
  aui.renderExtraClasses(opt_data, output, opt_ijData);
  output.append('"', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '');
  aui.renderExtraAttributes(opt_data, output, opt_ijData);
  output.append('>', opt_data.content, '</div><!-- .aui-page-header-image -->');
  return opt_sb ? '' : output.toString();
};


aui.page.pageHeaderMain = function(opt_data, opt_sb, opt_ijData) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-page-header-main');
  aui.renderExtraClasses(opt_data, output, opt_ijData);
  output.append('"', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '');
  aui.renderExtraAttributes(opt_data, output, opt_ijData);
  output.append('>', opt_data.content, '</div><!-- .aui-page-header-main -->');
  return opt_sb ? '' : output.toString();
};


aui.page.pageHeaderActions = function(opt_data, opt_sb, opt_ijData) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-page-header-actions');
  aui.renderExtraClasses(opt_data, output, opt_ijData);
  output.append('"', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '');
  aui.renderExtraAttributes(opt_data, output, opt_ijData);
  output.append('>', opt_data.content, '</div><!-- .aui-page-header-actions -->');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy/atlassian/panel.soy' */
// This file was automatically generated from panel.soy.
// Please don't edit this file by hand.

if (typeof aui == 'undefined') { var aui = {}; }


aui.panel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-panel');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), '>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy/atlassian/table.soy' */
// This file was automatically generated from table.soy.
// Please don't edit this file by hand.

if (typeof aui == 'undefined') { var aui = {}; }


aui.table = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<table', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', (opt_data.columnsContent) ? opt_data.columnsContent : '', (opt_data.captionContent) ? '<caption>' + opt_data.captionContent + '</caption>' : '', (opt_data.theadContent) ? '<thead>' + opt_data.theadContent + '</thead>' : '', (opt_data.tfootContent) ? '<tfoot>' + opt_data.tfootContent + '</tfoot>' : '', (! opt_data.contentIncludesTbody) ? '<tbody>' : '', opt_data.content, (! opt_data.contentIncludesTbody) ? '</tbody>' : '', '</table>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy/atlassian/tabs.soy' */
// This file was automatically generated from tabs.soy.
// Please don't edit this file by hand.

if (typeof aui == 'undefined') { var aui = {}; }


aui.tabs = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-tabs ', soy.$$escapeHtml(opt_data.isVertical ? 'vertical-tabs' : 'horizontal-tabs'), (opt_data.isDisabled) ? ' aui-tabs-disabled' : '');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('><ul class="tabs-menu">');
  var itemList19 = opt_data.menuItems;
  var itemListLen19 = itemList19.length;
  for (var itemIndex19 = 0; itemIndex19 < itemListLen19; itemIndex19++) {
    var itemData19 = itemList19[itemIndex19];
    aui.tabMenuItem(itemData19, output);
  }
  output.append('</ul>', opt_data.paneContent, '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), '>');
  return opt_sb ? '' : output.toString();
};


aui.tabMenuItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="menu-item', (opt_data.isActive) ? ' active-tab' : '');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('><a href="', soy.$$escapeHtml(opt_data.url), '"><strong>', soy.$$escapeHtml(opt_data.text), '</strong></a></li>');
  return opt_sb ? '' : output.toString();
};


aui.tabPane = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="tabs-pane', (opt_data.isActive) ? ' active-pane' : '');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), '>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy/atlassian/toolbar.soy' */
// This file was automatically generated from toolbar.soy.
// Please don't edit this file by hand.

if (typeof aui == 'undefined') { var aui = {}; }
if (typeof aui.toolbar == 'undefined') { aui.toolbar = {}; }


aui.toolbar.toolbar = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-toolbar');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), '>');
  return opt_sb ? '' : output.toString();
};


aui.toolbar.split = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="toolbar-split toolbar-split-', soy.$$escapeHtml(opt_data.split));
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), '>');
  return opt_sb ? '' : output.toString();
};


aui.toolbar.group = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="toolbar-group');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</ul>');
  return opt_sb ? '' : output.toString();
};


aui.toolbar.item = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li ', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="toolbar-item', (opt_data.isPrimary) ? ' primary' : '', (opt_data.isActive) ? ' active' : '');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</li>');
  return opt_sb ? '' : output.toString();
};


aui.toolbar.trigger = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="toolbar-trigger');
  aui.renderExtraClasses(opt_data, output);
  output.append('" href="', soy.$$escapeHtml(opt_data.url ? opt_data.url : '#'), '"', (opt_data.title) ? ' title="' + soy.$$escapeHtml(opt_data.title) + '"' : '');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</a>');
  return opt_sb ? '' : output.toString();
};


aui.toolbar.button = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (! (opt_data != null)) {
    output.append('Either $text or both $title and $iconClass must be provided.');
  } else {
    var param107 = new soy.StringBuilder();
    aui.toolbar.trigger({url: opt_data.url, title: opt_data.title, content: ((opt_data.iconClass) ? '<span class="icon ' + soy.$$escapeHtml(opt_data.iconClass) + '"></span>' : '') + ((opt_data.text) ? '<span class="trigger-text">' + soy.$$escapeHtml(opt_data.text) + '</span>' : '')}, param107);
    aui.toolbar.item({isActive: opt_data.isActive, isPrimary: opt_data.isPrimary, id: opt_data.id, extraClasses: opt_data.extraClasses, extraAttributes: opt_data.extraAttributes, content: param107.toString()}, output);
  }
  return opt_sb ? '' : output.toString();
};


aui.toolbar.link = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param125 = new soy.StringBuilder('toolbar-item-link');
  aui.renderExtraClasses(opt_data, param125);
  var param129 = new soy.StringBuilder();
  aui.toolbar.trigger({url: opt_data.url, content: soy.$$escapeHtml(opt_data.text)}, param129);
  aui.toolbar.item({id: opt_data.id, extraClasses: param125.toString(), extraAttributes: opt_data.extraAttributes, content: param129.toString()}, output);
  return opt_sb ? '' : output.toString();
};


aui.toolbar.dropdownInternal = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param138 = new soy.StringBuilder(opt_data.itemClass);
  aui.renderExtraClasses(opt_data, param138);
  var param143 = new soy.StringBuilder((opt_data.splitButtonContent) ? opt_data.splitButtonContent : '');
  var param148 = new soy.StringBuilder();
  aui.dropdown.trigger({extraClasses: 'toolbar-trigger', accessibilityText: opt_data.text}, param148);
  aui.dropdown.menu({content: opt_data.dropdownItemsContent}, param148);
  aui.dropdown.parent({content: param148.toString()}, param143);
  aui.toolbar.item({isPrimary: opt_data.isPrimary, id: opt_data.id, extraClasses: param138.toString(), extraAttributes: opt_data.extraAttributes, content: param143.toString()}, output);
  return opt_sb ? '' : output.toString();
};


aui.toolbar.dropdown = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.toolbar.dropdownInternal({isPrimary: opt_data.isPrimary, id: opt_data.id, itemClass: 'toolbar-dropdown', extraClasses: opt_data.extraClasses, extraAttributes: opt_data.extraAttributes, text: opt_data.text, dropdownItemsContent: opt_data.dropdownItemsContent}, output);
  return opt_sb ? '' : output.toString();
};


aui.toolbar.splitButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param172 = new soy.StringBuilder();
  aui.toolbar.trigger({url: opt_data.url, content: soy.$$escapeHtml(opt_data.text)}, param172);
  aui.toolbar.dropdownInternal({isPrimary: opt_data.isPrimary, id: opt_data.id, itemClass: 'toolbar-splitbutton', extraClasses: opt_data.extraClasses, extraAttributes: opt_data.extraAttributes, dropdownItemsContent: opt_data.dropdownItemsContent, splitButtonContent: param172.toString()}, output);
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy/atlassian/toolbar2.soy' */
// This file was automatically generated from toolbar2.soy.
// Please don't edit this file by hand.

if (typeof aui == 'undefined') { var aui = {}; }
if (typeof aui.toolbar2 == 'undefined') { aui.toolbar2 = {}; }


aui.toolbar2.toolbar2 = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-toolbar2');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append(' role="toolbar"><div class="aui-toolbar2-inner">', opt_data.content, '</div></div>');
  return opt_sb ? '' : output.toString();
};


aui.toolbar2.item = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-toolbar2-', soy.$$escapeHtml(opt_data.item));
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</div>');
  return opt_sb ? '' : output.toString();
};


aui.toolbar2.group = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-toolbar2-group');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy/atlassian/progress-tracker.soy' */
// This file was automatically generated from progress-tracker.soy.
// Please don't edit this file by hand.

if (typeof aui == 'undefined') { var aui = {}; }
if (typeof aui.progressTracker == 'undefined') { aui.progressTracker = {}; }


aui.progressTracker.progressTracker = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ol', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-progress-tracker', (opt_data.isInverted) ? ' aui-progress-tracker-inverted' : '');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>');
  var param18 = new soy.StringBuilder();
  var currentStepList19 = opt_data.steps;
  var currentStepListLen19 = currentStepList19.length;
  for (var currentStepIndex19 = 0; currentStepIndex19 < currentStepListLen19; currentStepIndex19++) {
    var currentStepData19 = currentStepList19[currentStepIndex19];
    if (currentStepData19['isCurrent']) {
      var stepList22 = opt_data.steps;
      var stepListLen22 = stepList22.length;
      for (var stepIndex22 = 0; stepIndex22 < stepListLen22; stepIndex22++) {
        var stepData22 = stepList22[stepIndex22];
        aui.progressTracker.step(soy.$$augmentData(stepData22, {width: Math.round(100 / opt_data.steps.length * 10000) / 10000, href: stepIndex22 < currentStepIndex19 ? stepData22['href'] : null}), param18);
      }
    }
  }
  aui.progressTracker.content({steps: opt_data.steps, content: param18.toString()}, output);
  output.append('</ol>');
  return opt_sb ? '' : output.toString();
};


aui.progressTracker.content = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.content != '') {
    output.append(opt_data.content);
  } else {
    var stepList36 = opt_data.steps;
    var stepListLen36 = stepList36.length;
    for (var stepIndex36 = 0; stepIndex36 < stepListLen36; stepIndex36++) {
      var stepData36 = stepList36[stepIndex36];
      aui.progressTracker.step(soy.$$augmentData(stepData36, {isCurrent: stepIndex36 == 0, width: Math.round(100 / opt_data.steps.length * 10000) / 10000, href: null}), output);
    }
  }
  return opt_sb ? '' : output.toString();
};


aui.progressTracker.step = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-progress-tracker-step', (opt_data.isCurrent) ? ' aui-progress-tracker-step-current' : '');
  aui.renderExtraClasses(opt_data, output);
  output.append('" style="width: ', soy.$$escapeHtml(opt_data.width), '%;"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('><', soy.$$escapeHtml(opt_data.href ? 'a' : 'span'), (opt_data.href) ? ' href="' + soy.$$escapeHtml(opt_data.href) + '"' : '', '>', soy.$$escapeHtml(opt_data.text), '</', soy.$$escapeHtml(opt_data.href ? 'a' : 'span'), '></li>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy/atlassian/expander.soy' */
// This file was automatically generated from expander.soy.
// Please don't edit this file by hand.

if (typeof aui == 'undefined') { var aui = {}; }
if (typeof aui.expander == 'undefined') { aui.expander = {}; }


aui.expander.content = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-expander-content');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append((opt_data.initiallyExpanded) ? ' aria-expanded="' + soy.$$escapeHtml(opt_data.initiallyExpanded) + '"' : '', '>', (opt_data.content) ? opt_data.content : '', '</div>');
  return opt_sb ? '' : output.toString();
};


aui.expander.trigger = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tag ? opt_data.tag : 'div'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', (opt_data.replaceText) ? ' data-replace-text="' + soy.$$escapeHtml(opt_data.replaceText) + '"' : '', (opt_data.replaceSelector) ? ' data-replace-selector="' + soy.$$escapeHtml(opt_data.replaceSelector) + '"' : '', ' class="aui-expander-trigger');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append(' aria-controls="', soy.$$escapeHtml(opt_data.contentId), '"', (opt_data.collapsible) ? ' data-collapsible="' + soy.$$escapeHtml(opt_data.collapsible) + '"' : '', '>', (opt_data.content) ? opt_data.content : '', '</', soy.$$escapeHtml(opt_data.tag ? opt_data.tag : 'div'), '>');
  return opt_sb ? '' : output.toString();
};


aui.expander.revealText = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param64 = new soy.StringBuilder(soy.$$escapeHtml(opt_data.contentContent));
  aui.expander.trigger({id: opt_data.triggerId, contentId: opt_data.contentId, tag: 'a', content: '<span class=\'reveal-text-trigger-text\'>Show more</span>', replaceSelector: '.reveal-text-trigger-text', replaceText: 'Show less', extraAttributes: opt_data.triggerExtraAttributes, extraClasses: ((opt_data.triggerExtraClasses) ? soy.$$escapeHtml(opt_data.triggerExtraClasses) + '  ' : '') + ' aui-expander-reveal-text'}, param64);
  aui.expander.content({id: opt_data.contentId, content: param64.toString(), extraAttributes: opt_data.contentExtraAttributes, extraClasses: opt_data.contentExtraClasses}, output);
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy/atlassian/avatar.soy' */
// This file was automatically generated from avatar.soy.
// Please don't edit this file by hand.

if (typeof aui == 'undefined') { var aui = {}; }
if (typeof aui.avatar == 'undefined') { aui.avatar = {}; }


aui.avatar.avatar = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'span'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-avatar aui-avatar-', soy.$$escapeHtml(opt_data.size), soy.$$escapeHtml(opt_data.isProject ? ' aui-avatar-project' : ''), soy.$$escapeHtml(opt_data.badgeContent ? ' aui-avatar-badged' : ''));
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('><span class="aui-avatar-inner"><img src="', soy.$$escapeHtml(opt_data.avatarImageUrl), '"', (opt_data.accessibilityText) ? ' alt="' + soy.$$escapeHtml(opt_data.accessibilityText) + '"' : '', (opt_data.title) ? ' title="' + soy.$$escapeHtml(opt_data.title) + '"' : '', (opt_data.imageClasses) ? ' class="' + soy.$$escapeHtml(opt_data.imageClasses) + '"' : '', ' /></span>', (opt_data.badgeContent) ? opt_data.badgeContent : '', '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'span'), '>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy/atlassian/icons.soy' */
// This file was automatically generated from icons.soy.
// Please don't edit this file by hand.

if (typeof aui == 'undefined') { var aui = {}; }
if (typeof aui.icons == 'undefined') { aui.icons = {}; }


aui.icons.icon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'span'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-icon', (opt_data.useIconFont) ? ' aui-icon-' + soy.$$escapeHtml(opt_data.size ? opt_data.size : 'small') : '', ' aui', soy.$$escapeHtml(opt_data.useIconFont ? '-iconfont' : '-icon'), soy.$$escapeHtml(opt_data.iconFontSet ? '-' + opt_data.iconFontSet : ''), '-', soy.$$escapeHtml(opt_data.icon));
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', (opt_data.accessibilityText) ? soy.$$escapeHtml(opt_data.accessibilityText) : '', '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'span'), '>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy-legacy1/atlassian.soy' */
// This file was automatically generated from atlassian.soy.
// Please don't edit this file by hand.

if (typeof atlassian == 'undefined') { var atlassian = {}; }


atlassian.renderExtraAttributes = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data != null && opt_data.extraAttributes) {
    if (Object.prototype.toString.call(opt_data.extraAttributes) === '[object Object]') {
      var attrList7 = soy.$$getMapKeys(opt_data.extraAttributes);
      var attrListLen7 = attrList7.length;
      for (var attrIndex7 = 0; attrIndex7 < attrListLen7; attrIndex7++) {
        var attrData7 = attrList7[attrIndex7];
        output.append(' ', soy.$$escapeHtml(attrData7), '="', soy.$$escapeHtml(opt_data.extraAttributes[attrData7]), '"');
      }
    } else {
      output.append(' ', opt_data.extraAttributes);
    }
  }
  return opt_sb ? '' : output.toString();
};


atlassian.renderExtraClasses = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data != null && opt_data.extraClasses) {
    if (opt_data.fullAttr) {
      output.append(' class="');
      if ((opt_data.extraClasses) instanceof Array) {
        var classList26 = opt_data.extraClasses;
        var classListLen26 = classList26.length;
        for (var classIndex26 = 0; classIndex26 < classListLen26; classIndex26++) {
          var classData26 = classList26[classIndex26];
          output.append((! (classIndex26 == 0)) ? ' ' : '', soy.$$escapeHtml(classData26));
        }
      } else {
        output.append(soy.$$escapeHtml(opt_data.extraClasses));
      }
      output.append('"');
    } else {
      if ((opt_data.extraClasses) instanceof Array) {
        var classList38 = opt_data.extraClasses;
        var classListLen38 = classList38.length;
        for (var classIndex38 = 0; classIndex38 < classListLen38; classIndex38++) {
          var classData38 = classList38[classIndex38];
          output.append(' ', soy.$$escapeHtml(classData38));
        }
      } else {
        output.append(' ', soy.$$escapeHtml(opt_data.extraClasses));
      }
    }
  }
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy-legacy1/badges.soy' */
// This file was automatically generated from badges.soy.
// Please don't edit this file by hand.

if (typeof atlassian == 'undefined') { var atlassian = {}; }
if (typeof atlassian.badges == 'undefined') { atlassian.badges = {}; }


atlassian.badges.badge = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'span'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-badge');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('"');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('>', soy.$$escapeHtml(opt_data.text), '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'span'), '>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy-legacy1/buttons.soy' */
// This file was automatically generated from buttons.soy.
// Please don't edit this file by hand.

if (typeof atlassian == 'undefined') { var atlassian = {}; }
if (typeof atlassian.buttons == 'undefined') { atlassian.buttons = {}; }


atlassian.buttons.button = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.tagName == 'input') {
    output.append('<input type="', soy.$$escapeHtml(opt_data.inputType ? opt_data.inputType : 'button'), '" ');
    atlassian.buttons.buttonAttributes(opt_data, output);
    output.append(' value="', soy.$$escapeHtml(opt_data.text), '" />');
  } else {
    output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'button'), ' ');
    atlassian.buttons.buttonAttributes(opt_data, output);
    output.append('>');
    atlassian.buttons.buttonIcon(opt_data, output);
    output.append(soy.$$escapeHtml(opt_data.text), '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'button'), '>');
  }
  return opt_sb ? '' : output.toString();
};


atlassian.buttons.buttons = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-buttons');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('"');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</div>');
  return opt_sb ? '' : output.toString();
};


atlassian.buttons.buttonAttributes = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-button', (opt_data.splitButtonType == 'main') ? ' aui-button-split-main' : '', (opt_data.dropdown2Target) ? ' aui-dropdown2-trigger' + ((opt_data.splitButtonType == 'more') ? ' aui-button-split-more' : '') : '', (opt_data.type == 'primary') ? ' aui-button-primary' : (opt_data.type == 'link') ? ' aui-button-link' : '');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('"');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append((opt_data.pressed) ? ' aria-pressed="' + soy.$$escapeHtml(opt_data.pressed) + '"' : '', (opt_data.disabled) ? ' aria-disabled="' + soy.$$escapeHtml(opt_data.disabled) + '"' + ((opt_data.disabled == true) ? (opt_data.tagName == 'button' || opt_data.tagName == 'input') ? ' disabled="disabled" ' : '' : '') : '', (opt_data.dropdown2Target) ? ' aria-owns="' + soy.$$escapeHtml(opt_data.dropdown2Target) + '" aria-haspopup="true"' : '');
  return opt_sb ? '' : output.toString();
};


atlassian.buttons.buttonIcon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.iconType) ? '<span class="' + ((opt_data.iconType == 'aui') ? 'aui-icon' : '') + ((opt_data.iconClass) ? ' ' + soy.$$escapeHtml(opt_data.iconClass) : '') + '">' + ((opt_data.iconText) ? soy.$$escapeHtml(opt_data.iconText) + ' ' : '') + '</span>' : '');
  return opt_sb ? '' : output.toString();
};


atlassian.buttons.splitButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  atlassian.buttons.button(soy.$$augmentData(opt_data.splitButtonMain, {splitButtonType: 'main'}), output);
  atlassian.buttons.button(soy.$$augmentData(opt_data.splitButtonMore, {splitButtonType: 'more'}), output);
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy-legacy1/dropdown.soy' */
// This file was automatically generated from dropdown.soy.
// Please don't edit this file by hand.

if (typeof atlassian == 'undefined') { var atlassian = {}; }
if (typeof atlassian.dropdown == 'undefined') { atlassian.dropdown = {}; }


atlassian.dropdown.trigger = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-dd-trigger');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('"');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('><span class="dropdown-text">', (opt_data.accessibilityText) ? soy.$$escapeHtml(opt_data.accessibilityText) : '', '</span>', (! (opt_data.showIcon == false)) ? '<span class="icon icon-dropdown"></span>' : '', '</a>');
  return opt_sb ? '' : output.toString();
};


atlassian.dropdown.menu = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'ul'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-dropdown hidden');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('"');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'ul'), '>');
  return opt_sb ? '' : output.toString();
};


atlassian.dropdown.parent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-dd-parent');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('"');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), '>');
  return opt_sb ? '' : output.toString();
};


atlassian.dropdown.item = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'li'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="dropdown-item');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('"');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('><a href="', soy.$$escapeHtml(opt_data.url ? opt_data.url : '#'), '">', soy.$$escapeHtml(opt_data.text), '</a></', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'li'), '>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy-legacy1/dropdown2.soy' */
// This file was automatically generated from dropdown2.soy.
// Please don't edit this file by hand.

if (typeof atlassian == 'undefined') { var atlassian = {}; }
if (typeof atlassian.dropdown2 == 'undefined') { atlassian.dropdown2 = {}; }


atlassian.dropdown2.dropdown2 = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  atlassian.dropdown2.trigger(soy.$$augmentData(opt_data.trigger, {menu: opt_data.menu}), output);
  atlassian.dropdown2.contents(opt_data.menu, output);
  return opt_sb ? '' : output.toString();
};


atlassian.dropdown2.trigger = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'a'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-dropdown2-trigger');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('" aria-owns="', soy.$$escapeHtml(opt_data.menu.id), '" aria-haspopup="true"', (opt_data.title) ? ' title="' + soy.$$escapeHtml(opt_data.title) + '"' : '', (opt_data.container) ? ' data-container="' + soy.$$escapeHtml(opt_data.container) + '"' : '');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('>', (opt_data.content) ? opt_data.content : '', (opt_data.text) ? soy.$$escapeHtml(opt_data.text) : '', (! (opt_data.showIcon == false)) ? '<span class="icon aui-icon-dropdown"></span>' : '', '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'a'), '>');
  return opt_sb ? '' : output.toString();
};


atlassian.dropdown2.contents = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="', soy.$$escapeHtml(opt_data.id), '" class="aui-dropdown2');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('"');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('>', (opt_data.content) ? opt_data.content : '', '</div>');
  return opt_sb ? '' : output.toString();
};


atlassian.dropdown2.section = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-dropdown2-section');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('"');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('>', (opt_data.label) ? '<strong>' + soy.$$escapeHtml(opt_data.label) + '</strong>' : '', opt_data.content, '</div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy-legacy1/form.soy' */
// This file was automatically generated from form.soy.
// Please don't edit this file by hand.

if (typeof atlassian == 'undefined') { var atlassian = {}; }
if (typeof atlassian.form == 'undefined') { atlassian.form = {}; }


atlassian.form.form = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui', (opt_data.isUnsectioned) ? ' unsectioned' : '', (opt_data.isLongLabels) ? ' long-label' : '', (opt_data.isTopLabels) ? ' top-label' : '');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('" action="', soy.$$escapeHtml(opt_data.action), '" method="', soy.$$escapeHtml(opt_data.method ? opt_data.method : 'post'), '"', (opt_data.enctype) ? 'enctype="' + soy.$$escapeHtml(opt_data.enctype) + '"' : '');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</form>');
  return opt_sb ? '' : output.toString();
};


atlassian.form.formDescription = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="field-group');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('"');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</div>');
  return opt_sb ? '' : output.toString();
};


atlassian.form.fieldset = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var hasClass__soy51 = opt_data.isInline || opt_data.isDateSelect || opt_data.isGroup || opt_data.extraClasses;
  output.append('<fieldset', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '');
  if (hasClass__soy51) {
    output.append(' class="', soy.$$escapeHtml(opt_data.isInline ? 'inline' : opt_data.isDateSelect ? 'date-select' : opt_data.isGroup ? 'group' : ''));
    atlassian.renderExtraClasses(opt_data, output);
    output.append('"');
  }
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('><legend><span>', opt_data.legendContent, '</span></legend>', opt_data.content, '</fieldset>');
  return opt_sb ? '' : output.toString();
};


atlassian.form.fieldGroup = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="field-group');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('"');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</div>');
  return opt_sb ? '' : output.toString();
};


atlassian.form.buttons = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="buttons-container', (opt_data.alignment) ? ' ' + soy.$$escapeHtml(opt_data.alignment) : '', '"><div class="buttons">', opt_data.content, '</div></div>');
  return opt_sb ? '' : output.toString();
};


atlassian.form.label = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<label', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' for="', soy.$$escapeHtml(opt_data.forField), '"');
  atlassian.renderExtraClasses(soy.$$augmentData(opt_data, {fullAttr: true}), output);
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, (opt_data.isRequired) ? '<span class="aui-icon icon-required"></span>' : '', '</label>');
  return opt_sb ? '' : output.toString();
};


atlassian.form.input = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="', soy.$$escapeHtml(opt_data.type == 'password' ? 'text' : opt_data.type == 'submit' ? 'button' : opt_data.type));
  atlassian.renderExtraClasses(opt_data, output);
  output.append('" type="', soy.$$escapeHtml(opt_data.type), '" name="', (opt_data.name) ? soy.$$escapeHtml(opt_data.name) : soy.$$escapeHtml(opt_data.id), '"', (opt_data.value) ? ' value="' + soy.$$escapeHtml(opt_data.value) + '"' : '', ((opt_data.type == 'checkbox' || opt_data.type == 'radio') && opt_data.isChecked) ? ' checked="checked"' : '', (opt_data.type == 'text' && opt_data.maxLength) ? ' maxlength="' + soy.$$escapeHtml(opt_data.maxLength) + '"' : '', (opt_data.type == 'text' && opt_data.size) ? ' size="' + soy.$$escapeHtml(opt_data.size) + '"' : '', (opt_data.isDisabled) ? ' disabled' : '');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('/>');
  return opt_sb ? '' : output.toString();
};


atlassian.form.submit = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  atlassian.form.input({id: opt_data.id, name: opt_data.name, type: 'submit', value: opt_data.text, isDisabled: opt_data.isDisabled, extraClasses: opt_data.extraClasses, extraAttributes: opt_data.extraAttributes}, output);
  return opt_sb ? '' : output.toString();
};


atlassian.form.button = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  atlassian.form.input({id: opt_data.id, name: opt_data.name, type: 'button', value: opt_data.text, isDisabled: opt_data.isDisabled, extraClasses: opt_data.extraClasses, extraAttributes: opt_data.extraAttributes}, output);
  return opt_sb ? '' : output.toString();
};


atlassian.form.linkButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' name="', soy.$$escapeHtml(opt_data.name ? opt_data.name : opt_data.id), '" href="', soy.$$escapeHtml(opt_data.url ? opt_data.url : '#'), '" class="cancel');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('"');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('>', soy.$$escapeHtml(opt_data.text), '</a>');
  return opt_sb ? '' : output.toString();
};


atlassian.form.textarea = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<textarea', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' name="', (opt_data.name) ? soy.$$escapeHtml(opt_data.name) : soy.$$escapeHtml(opt_data.id), '" class="textarea');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('"', (opt_data.rows) ? ' rows="' + soy.$$escapeHtml(opt_data.rows) + '"' : '', (opt_data.cols) ? ' cols="' + soy.$$escapeHtml(opt_data.cols) + '"' : '', (opt_data.isDisabled) ? ' disabled' : '');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('>', (opt_data.value) ? soy.$$escapeHtml(opt_data.value) : '', '</textarea>');
  return opt_sb ? '' : output.toString();
};


atlassian.form.select = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<select', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' name="', (opt_data.name) ? soy.$$escapeHtml(opt_data.name) : soy.$$escapeHtml(opt_data.id), '" class="', soy.$$escapeHtml(opt_data.isMultiple ? 'multi-select' : 'select'));
  atlassian.renderExtraClasses(opt_data, output);
  output.append('"', (opt_data.size) ? ' size="' + soy.$$escapeHtml(opt_data.size) + '"' : '', (opt_data.isDisabled) ? ' disabled' : '', (opt_data.isMultiple) ? ' multiple' : '');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('>');
  var optionList260 = opt_data.options;
  var optionListLen260 = optionList260.length;
  for (var optionIndex260 = 0; optionIndex260 < optionListLen260; optionIndex260++) {
    var optionData260 = optionList260[optionIndex260];
    atlassian.form.optionOrOptgroup(optionData260, output);
  }
  output.append('</select>');
  return opt_sb ? '' : output.toString();
};


atlassian.form.optionOrOptgroup = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.options) {
    output.append('<optgroup label="', soy.$$escapeHtml(opt_data.text), '">');
    var optionList270 = opt_data.options;
    var optionListLen270 = optionList270.length;
    for (var optionIndex270 = 0; optionIndex270 < optionListLen270; optionIndex270++) {
      var optionData270 = optionList270[optionIndex270];
      atlassian.form.optionOrOptgroup(optionData270, output);
    }
    output.append('</optgroup>');
  } else {
    output.append('<option value="', soy.$$escapeHtml(opt_data.value), '" ', (opt_data.selected) ? 'selected' : '', '>', soy.$$escapeHtml(opt_data.text), '</option>');
  }
  return opt_sb ? '' : output.toString();
};


atlassian.form.value = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="field-value');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('"');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</span>');
  return opt_sb ? '' : output.toString();
};


atlassian.form.field = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var isCheckboxOrRadio__soy300 = opt_data.type == 'checkbox' || opt_data.type == 'radio';
  output.append('<div class="', (isCheckboxOrRadio__soy300) ? soy.$$escapeHtml(opt_data.type) : 'field-group');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('"');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('>');
  if (opt_data.labelContent && ! isCheckboxOrRadio__soy300) {
    atlassian.form.label({forField: opt_data.id, isRequired: opt_data.isRequired, content: opt_data.labelContent}, output);
  }
  switch (opt_data.type) {
    case 'textarea':
      atlassian.form.textarea({id: opt_data.id, name: opt_data.name, value: opt_data.value, rows: opt_data.rows, cols: opt_data.cols, isDisabled: opt_data.isDisabled ? true : false}, output);
      break;
    case 'select':
      atlassian.form.select({id: opt_data.id, name: opt_data.name, options: opt_data.options, isMultiple: opt_data.isMultiple, size: opt_data.size, isDisabled: opt_data.isDisabled ? true : false}, output);
      break;
    case 'value':
      atlassian.form.value({id: opt_data.id, content: soy.$$escapeHtml(opt_data.value)}, output);
      break;
    case 'text':
    case 'password':
    case 'file':
    case 'radio':
    case 'checkbox':
    case 'button':
    case 'submit':
    case 'reset':
      atlassian.form.input({id: opt_data.id, name: opt_data.name, type: opt_data.type, value: opt_data.value, maxLength: opt_data.maxLength, size: opt_data.size, isChecked: opt_data.isChecked, isDisabled: opt_data.isDisabled ? true : false}, output);
      break;
  }
  if (opt_data.labelContent && isCheckboxOrRadio__soy300) {
    atlassian.form.label({forField: opt_data.id, isRequired: opt_data.isRequired, content: opt_data.labelContent}, output);
  }
  if (opt_data.descriptionText) {
    atlassian.form.fieldDescription({message: opt_data.descriptionText}, output);
  }
  if (opt_data.errorTexts) {
    var errorList362 = opt_data.errorTexts;
    var errorListLen362 = errorList362.length;
    for (var errorIndex362 = 0; errorIndex362 < errorListLen362; errorIndex362++) {
      var errorData362 = errorList362[errorIndex362];
      atlassian.form.fieldError({message: errorData362}, output);
    }
  }
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


atlassian.form.fieldError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="error');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('">', soy.$$escapeHtml(opt_data.message), '</div>');
  return opt_sb ? '' : output.toString();
};


atlassian.form.fieldDescription = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="description');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('">', soy.$$escapeHtml(opt_data.message), '</div>');
  return opt_sb ? '' : output.toString();
};


atlassian.form.textField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  atlassian.form.field({id: opt_data.id, name: opt_data.name, type: 'text', labelContent: opt_data.labelContent, value: opt_data.value, maxLength: opt_data.maxLength, size: opt_data.size, isRequired: opt_data.isRequired, isDisabled: opt_data.isDisabled, descriptionText: opt_data.descriptionText, errorTexts: opt_data.errorTexts, extraClasses: opt_data.extraClasses, extraAttributes: opt_data.extraAttributes}, output);
  return opt_sb ? '' : output.toString();
};


atlassian.form.textareaField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  atlassian.form.field({id: opt_data.id, name: opt_data.name, type: 'textarea', labelContent: opt_data.labelContent, value: opt_data.value, rows: opt_data.rows, cols: opt_data.cols, isRequired: opt_data.isRequired, isDisabled: opt_data.isDisabled, descriptionText: opt_data.descriptionText, errorTexts: opt_data.errorTexts, extraClasses: opt_data.extraClasses, extraAttributes: opt_data.extraAttributes}, output);
  return opt_sb ? '' : output.toString();
};


atlassian.form.passwordField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  atlassian.form.field({id: opt_data.id, name: opt_data.name, type: 'password', labelContent: opt_data.labelContent, value: opt_data.value, isRequired: opt_data.isRequired, isDisabled: opt_data.isDisabled, descriptionText: opt_data.descriptionText, errorTexts: opt_data.errorTexts, extraClasses: opt_data.extraClasses, extraAttributes: opt_data.extraAttributes}, output);
  return opt_sb ? '' : output.toString();
};


atlassian.form.fileField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  atlassian.form.field({id: opt_data.id, name: opt_data.name, type: 'file', labelContent: opt_data.labelContent, value: opt_data.value, isRequired: opt_data.isRequired, isDisabled: opt_data.isDisabled, descriptionText: opt_data.descriptionText, errorTexts: opt_data.errorTexts, extraClasses: opt_data.extraClasses, extraAttributes: opt_data.extraAttributes}, output);
  return opt_sb ? '' : output.toString();
};


atlassian.form.selectField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  atlassian.form.field({id: opt_data.id, name: opt_data.name, type: 'select', labelContent: opt_data.labelContent, options: opt_data.options, isMultiple: opt_data.isMultiple, size: opt_data.size, isRequired: opt_data.isRequired, isDisabled: opt_data.isDisabled, descriptionText: opt_data.descriptionText, errorTexts: opt_data.errorTexts, extraClasses: opt_data.extraClasses, extraAttributes: opt_data.extraAttributes}, output);
  return opt_sb ? '' : output.toString();
};


atlassian.form.checkboxField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param456 = new soy.StringBuilder((opt_data.isMatrix) ? '<div class="matrix">' : '');
  var fieldList460 = opt_data.fields;
  var fieldListLen460 = fieldList460.length;
  for (var fieldIndex460 = 0; fieldIndex460 < fieldListLen460; fieldIndex460++) {
    var fieldData460 = fieldList460[fieldIndex460];
    atlassian.form.field(soy.$$augmentData(fieldData460, {type: 'checkbox', id: fieldData460.id, name: fieldData460.name, labelContent: soy.$$escapeHtml(fieldData460.labelText), isChecked: fieldData460.isChecked, isDisabled: fieldData460.isDisabled, descriptionText: fieldData460.descriptionText, errorTexts: fieldData460.errorTexts, extraClasses: fieldData460.extraClasses, extraAttributes: fieldData460.extraAttributes}), param456);
  }
  param456.append((opt_data.isMatrix) ? '</div>' : '');
  if (opt_data.descriptionText || opt_data.errorTexts && opt_data.errorTexts.length) {
    atlassian.form.field({descriptionText: opt_data.descriptionText, errorTexts: opt_data.errorTexts, isDisabled: false}, param456);
  }
  atlassian.form.fieldset({legendContent: opt_data.legendContent + (opt_data.isRequired ? '<span class="aui-icon icon-required"></span>' : ''), isGroup: true, id: opt_data.id, extraClasses: opt_data.extraClasses, extraAttributes: opt_data.extraAttributes, content: param456.toString()}, output);
  return opt_sb ? '' : output.toString();
};


atlassian.form.radioField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param490 = new soy.StringBuilder((opt_data.isMatrix) ? '<div class="matrix">' : '');
  var fieldList494 = opt_data.fields;
  var fieldListLen494 = fieldList494.length;
  for (var fieldIndex494 = 0; fieldIndex494 < fieldListLen494; fieldIndex494++) {
    var fieldData494 = fieldList494[fieldIndex494];
    atlassian.form.field(soy.$$augmentData(fieldData494, {type: 'radio', name: opt_data.name ? opt_data.name : opt_data.id, value: fieldData494.value, id: fieldData494.id, labelContent: soy.$$escapeHtml(fieldData494.labelText), isChecked: fieldData494.isChecked, isDisabled: fieldData494.isDisabled, descriptionText: fieldData494.descriptionText, errorTexts: fieldData494.errorTexts, extraClasses: fieldData494.extraClasses, extraAttributes: fieldData494.extraAttributes}), param490);
  }
  param490.append((opt_data.isMatrix) ? '</div>' : '');
  if (opt_data.descriptionText || opt_data.errorTexts && opt_data.errorTexts.length) {
    atlassian.form.field({descriptionText: opt_data.descriptionText, errorTexts: opt_data.errorTexts, isDisabled: false}, param490);
  }
  atlassian.form.fieldset({legendContent: opt_data.legendContent + (opt_data.isRequired ? '<span class="aui-icon icon-required"></span>' : ''), isGroup: true, id: opt_data.id, extraClasses: opt_data.extraClasses, extraAttributes: opt_data.extraAttributes, content: param490.toString()}, output);
  return opt_sb ? '' : output.toString();
};


atlassian.form.valueField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  atlassian.form.field({id: opt_data.id, type: 'value', value: opt_data.value, labelContent: opt_data.labelContent, isRequired: opt_data.isRequired, descriptionText: opt_data.descriptionText, errorTexts: opt_data.errorTexts, extraClasses: opt_data.extraClasses, extraAttributes: opt_data.extraAttributes}, output);
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy-legacy1/group.soy' */
// This file was automatically generated from group.soy.
// Please don't edit this file by hand.

if (typeof atlassian == 'undefined') { var atlassian = {}; }
if (typeof atlassian.group == 'undefined') { atlassian.group = {}; }


atlassian.group.group = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-group', (opt_data.isSplit) ? ' aui-group-split' : '');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('"');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), '>');
  return opt_sb ? '' : output.toString();
};


atlassian.group.item = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-item');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('"');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), '>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy-legacy1/labels.soy' */
// This file was automatically generated from labels.soy.
// Please don't edit this file by hand.

if (typeof atlassian == 'undefined') { var atlassian = {}; }
if (typeof atlassian.labels == 'undefined') { atlassian.labels = {}; }


atlassian.labels.label = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.url && opt_data.isCloseable == true) {
    output.append('<span', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-label aui-label-closeable aui-label-split');
    atlassian.renderExtraClasses(opt_data, output);
    output.append('"');
    atlassian.renderExtraAttributes(opt_data, output);
    output.append('><a class="aui-label-split-main" href="', soy.$$escapeHtml(opt_data.url), '">', soy.$$escapeHtml(opt_data.text), '</a><span class="aui-label-split-close" >');
    atlassian.labels.closeIcon(opt_data, output);
    output.append('</span></span>');
  } else {
    output.append('<', soy.$$escapeHtml(opt_data.url ? 'a' : 'span'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-label', (opt_data.isCloseable) ? ' aui-label-closeable' : '');
    atlassian.renderExtraClasses(opt_data, output);
    output.append('"');
    atlassian.renderExtraAttributes(opt_data, output);
    output.append((opt_data.url) ? ' href="' + soy.$$escapeHtml(opt_data.url) + '"' : '', '>', soy.$$escapeHtml(opt_data.text));
    if (opt_data.isCloseable) {
      atlassian.labels.closeIcon(opt_data, output);
    }
    output.append('</', soy.$$escapeHtml(opt_data.url ? 'a' : 'span'), '>');
  }
  return opt_sb ? '' : output.toString();
};


atlassian.labels.closeIcon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span tabindex="0" class="aui-icon aui-icon-close"');
  if (opt_data.hasTitle != false) {
    output.append(' title="');
    atlassian.labels.closeIconText(opt_data, output);
    output.append('"');
  }
  output.append('>');
  atlassian.labels.closeIconText(opt_data, output);
  output.append('</span>');
  return opt_sb ? '' : output.toString();
};


atlassian.labels.closeIconText = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.closeIconText) ? soy.$$escapeHtml(opt_data.closeIconText) : '(' + soy.$$escapeHtml("Remove") + ' ' + soy.$$escapeHtml(opt_data.text) + ')');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy-legacy1/message.soy' */
// This file was automatically generated from message.soy.
// Please don't edit this file by hand.

if (typeof atlassian == 'undefined') { var atlassian = {}; }
if (typeof atlassian.message == 'undefined') { atlassian.message = {}; }


atlassian.message.info = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  atlassian.message.message(soy.$$augmentData(opt_data, {type: 'info'}), output);
  return opt_sb ? '' : output.toString();
};


atlassian.message.warning = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  atlassian.message.message(soy.$$augmentData(opt_data, {type: 'warning'}), output);
  return opt_sb ? '' : output.toString();
};


atlassian.message.error = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  atlassian.message.message(soy.$$augmentData(opt_data, {type: 'error'}), output);
  return opt_sb ? '' : output.toString();
};


atlassian.message.success = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  atlassian.message.message(soy.$$augmentData(opt_data, {type: 'success'}), output);
  return opt_sb ? '' : output.toString();
};


atlassian.message.hint = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  atlassian.message.message(soy.$$augmentData(opt_data, {type: 'hint'}), output);
  return opt_sb ? '' : output.toString();
};


atlassian.message.generic = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  atlassian.message.message(soy.$$augmentData(opt_data, {type: 'generic'}), output);
  return opt_sb ? '' : output.toString();
};


atlassian.message.message = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-message ', soy.$$escapeHtml(opt_data.type ? opt_data.type : 'generic'), (opt_data.isCloseable) ? ' closeable' : '', (opt_data.isShadowed) ? ' shadowed' : '');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('"');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('>', (opt_data.title) ? '<p class="title"><strong>' + soy.$$escapeHtml(opt_data.title) + '</strong></p>' : '', opt_data.content, '<span class="aui-icon icon-', soy.$$escapeHtml(opt_data.type ? opt_data.type : 'generic'), '"></span>', (opt_data.isCloseable) ? '<span class="aui-icon icon-close" role="button" tabindex="0"></span>' : '', '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), '>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy-legacy1/page.soy' */
// This file was automatically generated from page.soy.
// Please don't edit this file by hand.

if (typeof atlassian == 'undefined') { var atlassian = {}; }
if (typeof atlassian.page == 'undefined') { atlassian.page = {}; }


atlassian.page.document = function(opt_data, opt_sb, opt_ijData) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<!DOCTYPE html><html lang="', soy.$$escapeHtml(opt_ijData.language ? opt_ijData.language : 'en'), '"><head><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=EDGE"><title>', soy.$$escapeHtml(opt_data.windowTitle), '</title>', (opt_data.headContent) ? opt_data.headContent : '', '</head><body');
  atlassian.renderExtraClasses(soy.$$augmentData(opt_data, {fullAttr: true}), output, opt_ijData);
  atlassian.renderExtraAttributes(opt_data, output, opt_ijData);
  output.append('>', opt_data.content, '</body></html>');
  return opt_sb ? '' : output.toString();
};


atlassian.page.page = function(opt_data, opt_sb, opt_ijData) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="page"><header id="header" role="banner">', opt_data.headerContent, '</header><!-- #header --><section id="content" role="main">', opt_data.contentContent, '</section><!-- #content --><footer id="footer" role="contentinfo">', opt_data.footerContent, '</footer><!-- #footer --></div><!-- #page -->');
  return opt_sb ? '' : output.toString();
};


atlassian.page.header = function(opt_data, opt_sb, opt_ijData) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<nav', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-header aui-dropdown2-trigger-group');
  atlassian.renderExtraClasses(opt_data, output, opt_ijData);
  output.append('"');
  atlassian.renderExtraAttributes(opt_data, output, opt_ijData);
  output.append(' role="navigation"><div class="aui-header-inner">', (opt_data.headerBeforeContent) ? '<div class="aui-header-before">' + opt_data.headerBeforeContent + '</div>' : '', '<div class="aui-header-primary"><h1 id="logo" class="aui-header-logo', (opt_data.headerLogoImageUrl) ? ' aui-header-logo-custom' : (opt_data.logo) ? ' aui-header-logo-' + soy.$$escapeHtml(opt_data.logo) : '', '"><a href="', soy.$$escapeHtml(opt_data.headerLink ? opt_data.headerLink : '/'), '">', (opt_data.headerLogoImageUrl) ? '<img src="' + soy.$$escapeHtml(opt_data.headerLogoImageUrl) + '" alt="' + soy.$$escapeHtml(opt_data.headerLogoText) + '" />' : '<span class="aui-header-logo-device">' + soy.$$escapeHtml(opt_data.headerLogoText ? opt_data.headerLogoText : '') + '</span>', (opt_data.headerText) ? '<span class="aui-header-logo-text">' + soy.$$escapeHtml(opt_data.headerText) + '</span>' : '', '</a></h1>', (opt_data.primaryNavContents) ? opt_data.primaryNavContents : '', '</div>', (opt_data.secondaryNavContents) ? '<div class="aui-header-secondary">' + opt_data.secondaryNavContents + '</div>' : '', (opt_data.headerAfterContent) ? '<div class="aui-header-after">' + opt_data.headerAfterContent + '</div>' : '', '</div><!-- .aui-header-inner--></nav><!-- .aui-header -->');
  return opt_sb ? '' : output.toString();
};


atlassian.page.pagePanel = function(opt_data, opt_sb, opt_ijData) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), ' class="aui-page-panel');
  atlassian.renderExtraClasses(opt_data, output, opt_ijData);
  output.append('"', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '');
  atlassian.renderExtraAttributes(opt_data, output, opt_ijData);
  output.append('><div class="aui-page-panel-inner">', opt_data.content, '</div><!-- .aui-page-panel-inner --></', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), '><!-- .aui-page-panel -->');
  return opt_sb ? '' : output.toString();
};


atlassian.page.pagePanelNav = function(opt_data, opt_sb, opt_ijData) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), ' class="aui-page-panel-nav');
  atlassian.renderExtraClasses(opt_data, output, opt_ijData);
  output.append('"', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '');
  atlassian.renderExtraAttributes(opt_data, output, opt_ijData);
  output.append('>', opt_data.content, '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), '><!-- .aui-page-panel-nav -->');
  return opt_sb ? '' : output.toString();
};


atlassian.page.pagePanelContent = function(opt_data, opt_sb, opt_ijData) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'section'), ' class="aui-page-panel-content');
  atlassian.renderExtraClasses(opt_data, output, opt_ijData);
  output.append('"', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '');
  atlassian.renderExtraAttributes(opt_data, output, opt_ijData);
  output.append('>', opt_data.content, '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'section'), '><!-- .aui-page-panel-content -->');
  return opt_sb ? '' : output.toString();
};


atlassian.page.pagePanelSidebar = function(opt_data, opt_sb, opt_ijData) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'aside'), ' class="aui-page-panel-sidebar');
  atlassian.renderExtraClasses(opt_data, output, opt_ijData);
  output.append('"', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '');
  atlassian.renderExtraAttributes(opt_data, output, opt_ijData);
  output.append('>', opt_data.content, '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'aside'), '><!-- .aui-page-panel-sidebar -->');
  return opt_sb ? '' : output.toString();
};


atlassian.page.pagePanelItem = function(opt_data, opt_sb, opt_ijData) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'section'), ' class="aui-page-panel-item');
  atlassian.renderExtraClasses(opt_data, output, opt_ijData);
  output.append('"', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '');
  atlassian.renderExtraAttributes(opt_data, output, opt_ijData);
  output.append('>', opt_data.content, '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'section'), '><!-- .aui-page-panel-item -->');
  return opt_sb ? '' : output.toString();
};


atlassian.page.pageHeader = function(opt_data, opt_sb, opt_ijData) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<header class="aui-page-header');
  atlassian.renderExtraClasses(opt_data, output, opt_ijData);
  output.append('"', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '');
  atlassian.renderExtraAttributes(opt_data, output, opt_ijData);
  output.append('><div class="aui-page-header-inner">', opt_data.content, '</div><!-- .aui-page-header-inner --></header><!-- .aui-page-header -->');
  return opt_sb ? '' : output.toString();
};


atlassian.page.pageHeaderImage = function(opt_data, opt_sb, opt_ijData) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-page-header-image');
  atlassian.renderExtraClasses(opt_data, output, opt_ijData);
  output.append('"', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '');
  atlassian.renderExtraAttributes(opt_data, output, opt_ijData);
  output.append('>', opt_data.content, '</div><!-- .aui-page-header-image -->');
  return opt_sb ? '' : output.toString();
};


atlassian.page.pageHeaderMain = function(opt_data, opt_sb, opt_ijData) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-page-header-main');
  atlassian.renderExtraClasses(opt_data, output, opt_ijData);
  output.append('"', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '');
  atlassian.renderExtraAttributes(opt_data, output, opt_ijData);
  output.append('>', opt_data.content, '</div><!-- .aui-page-header-main -->');
  return opt_sb ? '' : output.toString();
};


atlassian.page.pageHeaderActions = function(opt_data, opt_sb, opt_ijData) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-page-header-actions');
  atlassian.renderExtraClasses(opt_data, output, opt_ijData);
  output.append('"', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '');
  atlassian.renderExtraAttributes(opt_data, output, opt_ijData);
  output.append('>', opt_data.content, '</div><!-- .aui-page-header-actions -->');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy-legacy1/panel.soy' */
// This file was automatically generated from panel.soy.
// Please don't edit this file by hand.

if (typeof atlassian == 'undefined') { var atlassian = {}; }


atlassian.panel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-panel');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('"');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), '>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy-legacy1/table.soy' */
// This file was automatically generated from table.soy.
// Please don't edit this file by hand.

if (typeof atlassian == 'undefined') { var atlassian = {}; }


atlassian.table = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<table', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('"');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('>', (opt_data.columnsContent) ? opt_data.columnsContent : '', (opt_data.captionContent) ? '<caption>' + opt_data.captionContent + '</caption>' : '', (opt_data.theadContent) ? '<thead>' + opt_data.theadContent + '</thead>' : '', (opt_data.tfootContent) ? '<tfoot>' + opt_data.tfootContent + '</tfoot>' : '', (! opt_data.contentIncludesTbody) ? '<tbody>' : '', opt_data.content, (! opt_data.contentIncludesTbody) ? '</tbody>' : '', '</table>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy-legacy1/tabs.soy' */
// This file was automatically generated from tabs.soy.
// Please don't edit this file by hand.

if (typeof atlassian == 'undefined') { var atlassian = {}; }


atlassian.tabs = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-tabs ', soy.$$escapeHtml(opt_data.isVertical ? 'vertical-tabs' : 'horizontal-tabs'), (opt_data.isDisabled) ? ' aui-tabs-disabled' : '');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('"');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('><ul class="tabs-menu">');
  var itemList19 = opt_data.menuItems;
  var itemListLen19 = itemList19.length;
  for (var itemIndex19 = 0; itemIndex19 < itemListLen19; itemIndex19++) {
    var itemData19 = itemList19[itemIndex19];
    atlassian.tabMenuItem(itemData19, output);
  }
  output.append('</ul>', opt_data.paneContent, '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), '>');
  return opt_sb ? '' : output.toString();
};


atlassian.tabMenuItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="menu-item', (opt_data.isActive) ? ' active-tab' : '');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('"');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('><a href="', soy.$$escapeHtml(opt_data.url), '"><strong>', soy.$$escapeHtml(opt_data.text), '</strong></a></li>');
  return opt_sb ? '' : output.toString();
};


atlassian.tabPane = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="tabs-pane', (opt_data.isActive) ? ' active-pane' : '');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('"');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), '>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy-legacy1/toolbar.soy' */
// This file was automatically generated from toolbar.soy.
// Please don't edit this file by hand.

if (typeof atlassian == 'undefined') { var atlassian = {}; }
if (typeof atlassian.toolbar == 'undefined') { atlassian.toolbar = {}; }


atlassian.toolbar.toolbar = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-toolbar');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('"');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), '>');
  return opt_sb ? '' : output.toString();
};


atlassian.toolbar.split = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="toolbar-split toolbar-split-', soy.$$escapeHtml(opt_data.split));
  atlassian.renderExtraClasses(opt_data, output);
  output.append('"');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'div'), '>');
  return opt_sb ? '' : output.toString();
};


atlassian.toolbar.group = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="toolbar-group');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('"');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</ul>');
  return opt_sb ? '' : output.toString();
};


atlassian.toolbar.item = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li ', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="toolbar-item', (opt_data.isPrimary) ? ' primary' : '', (opt_data.isActive) ? ' active' : '');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('"');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</li>');
  return opt_sb ? '' : output.toString();
};


atlassian.toolbar.trigger = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="toolbar-trigger');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('" href="', soy.$$escapeHtml(opt_data.url ? opt_data.url : '#'), '"', (opt_data.title) ? ' title="' + soy.$$escapeHtml(opt_data.title) + '"' : '');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</a>');
  return opt_sb ? '' : output.toString();
};


atlassian.toolbar.button = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (! (opt_data != null)) {
    output.append('Either $text or both $title and $iconClass must be provided.');
  } else {
    var param107 = new soy.StringBuilder();
    atlassian.toolbar.trigger({url: opt_data.url, title: opt_data.title, content: ((opt_data.iconClass) ? '<span class="icon ' + soy.$$escapeHtml(opt_data.iconClass) + '"></span>' : '') + ((opt_data.text) ? '<span class="trigger-text">' + soy.$$escapeHtml(opt_data.text) + '</span>' : '')}, param107);
    atlassian.toolbar.item({isActive: opt_data.isActive, isPrimary: opt_data.isPrimary, id: opt_data.id, extraClasses: opt_data.extraClasses, extraAttributes: opt_data.extraAttributes, content: param107.toString()}, output);
  }
  return opt_sb ? '' : output.toString();
};


atlassian.toolbar.link = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param125 = new soy.StringBuilder('toolbar-item-link');
  atlassian.renderExtraClasses(opt_data, param125);
  var param129 = new soy.StringBuilder();
  atlassian.toolbar.trigger({url: opt_data.url, content: soy.$$escapeHtml(opt_data.text)}, param129);
  atlassian.toolbar.item({id: opt_data.id, extraClasses: param125.toString(), extraAttributes: opt_data.extraAttributes, content: param129.toString()}, output);
  return opt_sb ? '' : output.toString();
};


atlassian.toolbar.dropdownInternal = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param138 = new soy.StringBuilder(opt_data.itemClass);
  atlassian.renderExtraClasses(opt_data, param138);
  var param143 = new soy.StringBuilder((opt_data.splitButtonContent) ? opt_data.splitButtonContent : '');
  var param148 = new soy.StringBuilder();
  atlassian.dropdown.trigger({extraClasses: 'toolbar-trigger', accessibilityText: opt_data.text}, param148);
  atlassian.dropdown.menu({content: opt_data.dropdownItemsContent}, param148);
  atlassian.dropdown.parent({content: param148.toString()}, param143);
  atlassian.toolbar.item({isPrimary: opt_data.isPrimary, id: opt_data.id, extraClasses: param138.toString(), extraAttributes: opt_data.extraAttributes, content: param143.toString()}, output);
  return opt_sb ? '' : output.toString();
};


atlassian.toolbar.dropdown = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  atlassian.toolbar.dropdownInternal({isPrimary: opt_data.isPrimary, id: opt_data.id, itemClass: 'toolbar-dropdown', extraClasses: opt_data.extraClasses, extraAttributes: opt_data.extraAttributes, text: opt_data.text, dropdownItemsContent: opt_data.dropdownItemsContent}, output);
  return opt_sb ? '' : output.toString();
};


atlassian.toolbar.splitButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param172 = new soy.StringBuilder();
  atlassian.toolbar.trigger({url: opt_data.url, content: soy.$$escapeHtml(opt_data.text)}, param172);
  atlassian.toolbar.dropdownInternal({isPrimary: opt_data.isPrimary, id: opt_data.id, itemClass: 'toolbar-splitbutton', extraClasses: opt_data.extraClasses, extraAttributes: opt_data.extraAttributes, dropdownItemsContent: opt_data.dropdownItemsContent, splitButtonContent: param172.toString()}, output);
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.auiplugin:aui-experimental-soy-templates', location = 'soy-legacy1/toolbar2.soy' */
// This file was automatically generated from toolbar2.soy.
// Please don't edit this file by hand.

if (typeof atlassian == 'undefined') { var atlassian = {}; }
if (typeof atlassian.toolbar2 == 'undefined') { atlassian.toolbar2 = {}; }


atlassian.toolbar2.toolbar2 = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-toolbar2');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('"');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append(' role="toolbar"><div class="aui-toolbar2-inner">', opt_data.content, '</div></div>');
  return opt_sb ? '' : output.toString();
};


atlassian.toolbar2.item = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-toolbar2-', soy.$$escapeHtml(opt_data.item));
  atlassian.renderExtraClasses(opt_data, output);
  output.append('"');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</div>');
  return opt_sb ? '' : output.toString();
};


atlassian.toolbar2.group = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-toolbar2-group');
  atlassian.renderExtraClasses(opt_data, output);
  output.append('"');
  atlassian.renderExtraAttributes(opt_data, output);
  output.append('>', opt_data.content, '</div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'jira.webresources:js-soy-templates', location = '/includes/templates/jira/links.soy' */
// This file was automatically generated from links.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Links == 'undefined') { JIRA.Templates.Links = {}; }


JIRA.Templates.Links.helpLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="help-lnk');
  if (opt_data.extraClasses) {
    aui.renderExtraClasses(opt_data, output);
  }
  output.append('"', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' href="', soy.$$escapeHtml(opt_data.url), (opt_data.fragmentIdentifier) ? soy.$$escapeHtml(opt_data.fragmentIdentifier) : '', '" title="', (opt_data.isLocal) ? AJS.format("Get local help about {0}",opt_data.title) : AJS.format("Get online help about {0}",opt_data.title), '" data-helplink="', (opt_data.isLocal) ? 'local' : 'online', '"', (! opt_data.isLocal) ? ' target="_jirahelp"' : '');
  aui.renderExtraAttributes(opt_data, output);
  output.append('><span class="aui-icon aui-icon-small aui-iconfont-help">', (opt_data.description) ? soy.$$escapeHtml(opt_data.description) : '', '</span></a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Links.button = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.buttons.button(soy.$$augmentData(opt_data, {tagName: 'a', extraAttributes: 'href="' + soy.$$escapeHtml(opt_data.url) + '"'}), output);
  return opt_sb ? '' : output.toString();
};

/* module-key = 'jira.webresources:js-soy-templates', location = '/includes/templates/jira/header/pageHeader.soy' */
// This file was automatically generated from pageHeader.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Headers == 'undefined') { JIRA.Templates.Headers = {}; }


JIRA.Templates.Headers.pageHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'header'), ' class="aui-page-header"', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', '><div class="aui-page-header-inner">', (opt_data.imageContent) ? '<div class="aui-page-header-image">' + opt_data.imageContent + '</div>' : '', '<div class="aui-page-header-main">', opt_data.mainContent, '</div>', (opt_data.actionsContent || opt_data.helpContent) ? '<div class="aui-page-header-actions">' + ((opt_data.actionsContent) ? opt_data.actionsContent : '') + ((opt_data.helpContent) ? opt_data.helpContent : '') + '</div>' : '', '</div></', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'header'), '>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Headers.projectAvatar = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-avatar aui-avatar-large aui-avatar-project', (opt_data.isSystemAvatar) ? ' jira-system-avatar' : '', (opt_data.hasProjectShortcut) ? ' project-shortcut-dialog-trigger' : '');
  aui.renderExtraClasses(opt_data, output);
  output.append('"', (opt_data.hasProjectShortcut) ? ' data-key="' + soy.$$escapeHtml(opt_data.projectKey) + '" data-name="' + soy.$$escapeHtml(opt_data.projectName) + '" data-desc="" data-entity-type="jira.project"' : '');
  aui.renderExtraAttributes(opt_data, output);
  output.append('><span class="aui-avatar-inner"><img id="project-avatar" alt="', soy.$$escapeHtml(opt_data.avatarAlt), '" src="', opt_data.avatarUrl, '" /></span></span>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'jira.webresources:js-soy-templates', location = '/includes/templates/jira/jiraDialogs.soy' */
// This file was automatically generated from jiraDialogs.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.JiraDialog == 'undefined') { JIRA.Templates.JiraDialog = {}; }


JIRA.Templates.JiraDialog.dialogChrome = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.JiraDialog.abstractDialogChrome(opt_data, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.JiraDialog.formDialogChrome = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.JiraDialog.abstractDialogChrome(opt_data, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.JiraDialog.abstractDialogChrome = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.titleText) ? '<div class="jira-dialog-heading"><h2>' + soy.$$escapeHtml(opt_data.titleText) + '</h2></div>' : '', '<div class="jira-dialog-content">', (opt_data.formActionUrl) ? '<form class="aui" action="' + soy.$$escapeHtml(opt_data.formActionUrl) + '" method="' + ((opt_data.formMethod) ? soy.$$escapeHtml(opt_data.formMethod) : 'POST') + '"><div class="form-body">' + opt_data.bodyContent + '</div><div class="form-footer buttons-container">' + opt_data.footerContent + '</div></form>' : opt_data.bodyContent + ((opt_data.footerContent) ? '<div class="buttons-container">' + opt_data.footerContent + '</div>' : ''), '</div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'jira.webresources:page-loading-indicator', location = '/includes/jira/loading/Loading.js' */
(function($){var showTimer,animationTimer,_isVisible=false,_element;function getElement(){if(!_element){_element=$("<div />").addClass("jira-page-loading-indicator").css("zIndex",9999).appendTo("body")}return _element}function show(){var heightOfSprite=440,currentOffsetOfSprite=0;clearInterval(animationTimer);getElement().show();_isVisible=true;animationTimer=window.setInterval(function(){if(currentOffsetOfSprite===heightOfSprite){currentOffsetOfSprite=0}currentOffsetOfSprite=currentOffsetOfSprite+40;getElement().css("backgroundPosition","0 -"+currentOffsetOfSprite+"px")},50)}function hide(){getElement().hide();_isVisible=false}JIRA.Loading={showLoadingIndicator:function(options){options||(options={});clearTimeout(showTimer);if(options.delay){showTimer=window.setTimeout(show,options.delay|0)}else{show()}},hideLoadingIndicator:function(){clearTimeout(showTimer);clearInterval(animationTimer);hide()},isVisible:function(){return _isVisible}}})(AJS.$);
/* module-key = 'jira.webresources:shifter', location = '/includes/jira/shifter/shifter.soy' */
// This file was automatically generated from shifter.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Shifter == 'undefined') { JIRA.Templates.Shifter = {}; }


JIRA.Templates.Shifter.dialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="shifter-dialog" id="', soy.$$escapeHtml(opt_data.id), '"><form class="aui ajs-dirty-warning-exempt"><div id="', soy.$$escapeHtml(opt_data.id), '-suggestions" class="aui-list"></div></form><div class="hint-container overflow-ellipsis" title="', soy.$$escapeHtml("Pressing period (.) opens this dialog box"), '">', "Pressing period (\x3ckbd\x3e.\x3c/kbd\x3e) opens this dialog box", '</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Shifter.groupHeading = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="shifter-group-heading"><h5>', soy.$$escapeHtml(opt_data.groupName), '</h5>', (opt_data.groupContext) ? '<span class="shifter-group-context">' + soy.$$escapeHtml(opt_data.groupContext) + '</span>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'jira.webresources:shifter', location = '/includes/jira/shifter/ShifterController.js' */
AJS.namespace("JIRA.ShifterComponent.ShifterController",window,Class.extend({MAX_RESULTS_PER_GROUP:5,init:function(id){this.id=id;this.groupFactories=[]},register:function(groupFactory){this.groupFactories.push(groupFactory);return groupFactory},unregister:function(groupFactory){this.groupFactories=_.without(this.groupFactories,groupFactory);return groupFactory},show:function(){if(!this.dialog||this.dialog.destroyed()){var groups=_.chain(this.groupFactories).map(function(factory){return factory()}).compact().flatten().value().sort(function(a,b){return a.weight-b.weight});this.dialog=new JIRA.ShifterComponent.ShifterDialog(this.id,groups,{maxResultsDisplayedPerGroup:this.MAX_RESULTS_PER_GROUP})}this.dialog.focus()},hide:function(){this.dialog&&this.dialog.destroy()}}));
/* module-key = 'jira.webresources:shifter', location = '/includes/jira/shifter/ShifterDialog.js' */
AJS.namespace("JIRA.ShifterComponent.ShifterDialog",window,Class.extend({BLUR_DELAY:50,init:function(id,groups,options){this.id=id;this.groups=groups;this.options=options;this._render();this._destroyOnBlur();this._preventFocusOnNonInputElements();jQuery(document).on("mousedown.shifterdialog."+id,_.bind(this._destroyOnMousedownOutside,this))},focus:function(){if(this.$dialog){this.$dialog.find("input").focus()}},destroy:function(){var $dialog=this.$dialog;if($dialog){$dialog.stop().animate({top:-1*$dialog.height()},100,function(){$dialog.remove()});this.$dialog=null;jQuery(document).off("mousedown.shifterdialog."+this.id)}},destroyed:function(){return !this.$dialog},saveLastQuery:function(query){sessionStorage.setItem("JIRA.Shifter.lastQuery",query)},getLastQuery:function(){return sessionStorage.getItem("JIRA.Shifter.lastQuery")},enterLoadingState:function(){var $dialog=this.$dialog;$dialog.addClass("loading-action");$dialog.find(".aui-list").slideUp(200)},_render:function(){var html=JIRA.Templates.Shifter.dialog({id:this.id});var $dialog=this.$dialog=jQuery(html).appendTo("body");var shifterSelect=this.shifterSelect=new JIRA.ShifterComponent.ShifterSelect({id:this.id,element:$dialog.find(".aui-list"),groups:this.groups,suggestionsHandler:this._makeSuggestionsHandler(),onSelection:_.bind(this._onSelection,this),maxResultsDisplayedPerGroup:this.options.maxResultsDisplayedPerGroup});if(this.getLastQuery()){shifterSelect.$field.val(this.getLastQuery()).select();shifterSelect.onEdit()}shifterSelect.$field.on("keyup",_.bind(function(e){if(e.which===jQuery.ui.keyCode.ESCAPE){e.stopPropagation();this.destroy()}},this));if(AJS.currentLayerItem&&AJS.currentLayerItem.hide){AJS.currentLayerItem.hide()}$dialog.css("top",-1*$dialog.height()).animate({top:0},100)},_destroyOnBlur:function(){this.$dialog.find("input").blur(_.bind(function(){setTimeout(_.bind(function(){if(this.$dialog&&!jQuery.contains(this.$dialog[0],document.activeElement)){this.destroy()}},this),this.BLUR_DELAY)},this))},_destroyOnMousedownOutside:function(e){if(this.$dialog.find(e.target).length===0&&e.target!==this.$dialog){this.destroy()}},_preventFocusOnNonInputElements:function(){var $inputs=this.$dialog.find("input");this.$dialog.mousedown(function(e){if(jQuery.inArray(e.target,$inputs)===-1){e.preventDefault()}})},_makeSuggestionsHandler:function(){var groups=this.groups;return Class.extend({execute:function(query){var suggestions=[];var masterDeferred=jQuery.Deferred();var deferredsRemaining=groups.length;_.map(groups,function(group,groupIndex){return group.getSuggestions(query).done(function(groupSuggestions){if(!_.isArray(groupSuggestions)){return }suggestions.push(new AJS.GroupDescriptor({label:group.name,description:group.context,weight:group.weight,items:_.map(groupSuggestions,function(suggestion){return AJS.ItemDescriptor.create(suggestion,groupIndex)})}));suggestions.sort(function(a,b){return a.weight()-b.weight()})}).always(function(){deferredsRemaining--;if(deferredsRemaining===0){masterDeferred.resolve(suggestions,query)}})});return masterDeferred}})},_onSelection:function(group,value,label){this.saveLastQuery(label);var ret=group.onSelection(value);if(ret&&_.isFunction(ret.always)){this.enterLoadingState();ret.always(_.bind(this.destroy,this))}else{this.destroy()}}}));
/* module-key = 'jira.webresources:shifter', location = '/includes/jira/shifter/ShifterSelect.js' */
AJS.namespace("JIRA.ShifterComponent.ShifterSelect",window,AJS.QueryableDropdownSelect.extend({init:function(options){_.extend(options,{dropdownController:{setWidth:jQuery.noop,setPosition:jQuery.noop,onhide:jQuery.noop,hide:jQuery.noop,show:jQuery.noop}});this._super(options);this.$field.attr("placeholder","Find Actions...");this.$dropDownIcon.click(_.bind(this.clear,this));this._handleCharacterInput()},onEdit:function(){this.toggleClearButton();this._handleCharacterInput()},clear:function(){this.$field.val("").focus();this.onEdit()},toggleClearButton:function(){this.$dropDownIcon.toggleClass("aui-iconfont-remove",!!this.$field.val())},showLoading:function(){this._super();this.$dropDownIcon.removeClass("aui-iconfont-remove")},hideLoading:function(){this._super();this.toggleClearButton()},_handleCharacterInput:function(){this._super(true);if(this.getQueryVal().length===0){this.listController.moveToFirst()}},_createListController:function(){var instance=this;this.listController=new AJS.ListWithMessages({containerSelector:this.options.element,groupSelector:"ul.aui-list-section",scrollContainer:".aui-list-scroll",matchingStrategy:this.options.matchingStrategy,maxResultsDisplayedPerGroup:this.options.maxResultsDisplayedPerGroup,eventTarget:this.$field,hasLinks:false,renderers:{suggestionGroupHeading:this._renders.suggestionGroupHeading},selectionHandler:function(e){var targetData=jQuery(e.currentTarget).data();if(targetData&&targetData.descriptor instanceof AJS.MessageDescriptor){return false}var selectedDescriptor=this.getFocused().data("descriptor");var groupIndex=selectedDescriptor.meta().groupIndex;var group=instance.options.groups[groupIndex];var value=selectedDescriptor.value();var label=selectedDescriptor.label();instance.$dropDownIcon.removeClass("aui-iconfont-remove");instance.$field.val("Loading...").prop("disabled",true);instance.options.onSelection(group,value,label)}})},hideSuggestions:jQuery.noop,_renders:{suggestionGroupHeading:function(descriptor){return jQuery(JIRA.Templates.Shifter.groupHeading({groupName:descriptor.label(),groupContext:descriptor.description()})).data("descriptor",descriptor)},dropdownAndLoadingIcon:function(showDropdown){return jQuery('<span class="icon noloading aui-icon aui-icon-small"><span>More</span></span>')}}}));
/* module-key = 'jira.webresources:shifter', location = '/includes/jira/shifter/shifter.js' */
JIRA.Shifter=new JIRA.ShifterComponent.ShifterController("shifter-dialog");
/* module-key = 'jira.webresources:jquery-plugin-textoverflow', location = '/includes/jquery/plugins/textoverflow/textOverflow.js' */
(function($){var style=document.documentElement.style,hasTextOverflow=("textOverflow" in style||"OTextOverflow" in style),rtrim=function(str){return str.replace(/\s+$/g,"")},domSplit=function(root,maxIndex,options){var index=0,result=[],domSplitAux=function(nodes){var i=0,tmp,clipIndex=0;if(index>maxIndex){return }for(i=0;i<nodes.length;i+=1){if(nodes[i].nodeType===1){tmp=nodes[i].cloneNode(false);result[result.length-1].appendChild(tmp);result.push(tmp);domSplitAux(nodes[i].childNodes);result.pop()}else{if(nodes[i].nodeType===3){if(index+nodes[i].length<maxIndex){result[result.length-1].appendChild(nodes[i].cloneNode(false))}else{tmp=nodes[i].cloneNode(false);clipIndex=maxIndex-index;if(options.wholeWord){clipIndex=Math.min(maxIndex-index,tmp.textContent.substring(0,maxIndex-index).lastIndexOf(" "))}tmp.textContent=options.trim?rtrim(tmp.textContent.substring(0,clipIndex)):tmp.textContent.substring(0,clipIndex);result[result.length-1].appendChild(tmp)}index+=nodes[i].length}else{result.appendChild(nodes[i].cloneNode(false))}}}};result.push(root.cloneNode(false));domSplitAux(root.childNodes);return $(result.pop().childNodes)};$.extend($.fn,{textOverflow:function(options){var o=$.extend({str:"&#x2026;",autoUpdate:false,trim:true,title:false,className:undefined,wholeWord:false},options);if(!hasTextOverflow){return this.each(function(){var element=$(this),clone=element.clone(),originalElement=element.clone(),originalText=element.text(),originalWidth=element.width(),low=0,mid=0,high=originalText.length,reflow=function(){if(originalWidth!==element.width()){element.replaceWith(originalElement);element=originalElement;originalElement=element.clone();element.textOverflow($.extend({},o,{autoUpdate:false}));originalWidth=element.width()}};element.after(clone.hide().css({"position":"absolute","width":"auto","overflow":"visible","max-width":"inherit","min-width":"inherit"}));if(clone.width()>originalWidth){while(low<high){mid=Math.floor(low+((high-low)/2));clone.empty().append(domSplit(originalElement.get(0),mid,o)).append(o.str);if(clone.width()<originalWidth){low=mid+1}else{high=mid}}if(low<originalText.length){element.empty().append(domSplit(originalElement.get(0),low-1,o)).append(o.str);if(o.title){element.attr("title",originalText)}if(o.className){element.addClass(o.className)}}}clone.remove();if(o.autoUpdate){setInterval(reflow,200)}})}else{return this}}})}(jQuery));
/* module-key = 'jira.webresources:dialogs', location = '/includes/jira/dialog/Dialog.js' */
JIRA.Dialog=AJS.Control.extend({_getDefaultOptions:function(){return{height:"auto",cached:false,widthClass:"medium",ajaxOptions:{data:{inline:true,decorator:"dialog"}}}},init:function(options){if(typeof options==="string"||options instanceof jQuery){options={trigger:options}}else{if(options&&options.width){options.widthClass="custom"}}this.classNames=JIRA.Dialog.ClassNames;this.OPEN_DIALOG_SELECTOR="."+this.classNames.DIALOG+"."+this.classNames.DIALOG_OPEN;this.options=jQuery.extend(true,this._getDefaultOptions(),options);this.options.width=JIRA.Dialog.WIDTH_PRESETS[this.options.widthClass]||options.width;if(typeof this.options.content==="function"){this.options.type="builder"}else{if(this.options.content instanceof jQuery||(typeof this.options.content==="object"&&this.options.nodeName)){this.options.type="element"}else{if(!this.options.type&&!this.options.content||(typeof this.options.content==="object"&&this.options.content.url)){this.options.type="ajax"}}}if(this.options.trigger){var triggerArray=AJS.$.makeArray(this.options.trigger);var instance=this;AJS.$.each(triggerArray,function(index,trigger){instance._assignEvents("trigger",trigger)})}this.onContentReadyCallbacks=[];this._assignEvents("container",document)},_runContentReadyCallbacks:function(){var that=this;AJS.$.each(this.onContentReadyCallbacks,function(){this.call(that)})},_setContent:function(content,decorate){var node;if(!content){this._contentRetrievers[this.options.type].call(this,this._setContent)}else{if(JIRA.Dialog.current===this){this.get$popup().show().css("visibility","hidden").addClass("popup-width-"+this.options.widthClass);this.$content=content;this.get$popupContent().html(content);if(decorate!==false){if(this.decorateContent){this.decorateContent()}}if((node=this.get$popupContent().find("."+this.classNames.HEADING_AREA)).size()>0){this.get$popupHeading().replaceWith(node)}if((node=this.get$popupContent().find("."+this.classNames.CONTENT_AREA)).size()>0){node.contents().insertAfter(node);node.remove()}this._positionInCenter();if(decorate!==false){AJS.$(document).trigger("dialogContentReady",[this]);this._runContentReadyCallbacks()}this.get$popup().css("visibility","");if(decorate!==false){if(AJS.$.isFunction(this.options.onContentRefresh)){this.options.onContentRefresh.call(this)}}this._onShowContent()}else{if(this.options.cached===false){delete this.$content}}}},_ellipsify:function(context){if(!(context instanceof AJS.$)){context=this.get$popup()}AJS.$(".overflow-ellipsis",context).textOverflow({className:"ellipsified"})},_handleInitialDoneResponse:function(data,xhr,smartAjaxResult){},getRequestUrlFromTrigger:function(){if(this.$activeTrigger&&this.$activeTrigger.length){return this.$activeTrigger.attr("href")||this.$activeTrigger.data("url")}},_getRequestOptions:function(){var options={};if(this._getAjaxOptionsObject()===false){return false}options=AJS.$.extend(true,options,this._getAjaxOptionsObject());if(!options.url){options.url=this.getRequestUrlFromTrigger()}return options},_getAjaxOptionsObject:function(){var ajaxOpts=this.options.ajaxOptions;if(AJS.$.isFunction(ajaxOpts)){return ajaxOpts.call(this)}else{return ajaxOpts}},_contentRetrievers:{"element":function(callback){if(!this.$content){this.$content=jQuery(this.options.content).clone(true)}callback.call(this,this.$content)},"builder":function(callback){var instance=this;if(!this.$content){this._showloadingIndicator();this.options.content.call(this,function(content){instance.$content=AJS.$(content);callback.call(instance,instance.$content)})}},"ajax":function(callback){var instance=this,ajaxOptions;if(!this.$content){ajaxOptions=this._getRequestOptions();this._showloadingIndicator();this.serverIsDone=false;ajaxOptions.complete=function(xhr,textStatus,smartAjaxResult){if(smartAjaxResult.successful){var instructions=instance._detectRedirectInstructions(xhr);instance.serverIsDone=instructions.serverIsDone;if(instructions.redirectUrl){instance._performRedirect(instructions.redirectUrl)}else{if(ajaxOptions.dataType&&ajaxOptions.dataType.toLowerCase()==="json"&&instance._buildContentFromJSON){instance.$content=instance._buildContentFromJSON(smartAjaxResult.data)}else{instance.$content=smartAjaxResult.data}if(instance.serverIsDone){instance._handleInitialDoneResponse(smartAjaxResult.data,xhr,smartAjaxResult)}else{callback.call(instance,instance.$content)}}}else{var errorContent=JIRA.SmartAjax.buildDialogErrorContent(smartAjaxResult);callback.call(instance,errorContent)}};JIRA.SmartAjax.makeRequest(ajaxOptions)}}},_detectRedirectInstructions:function(xhr){var instructions={serverIsDone:false,redirectUrl:""};var doneHeader=xhr.getResponseHeader("X-Atlassian-Dialog-Control");if(doneHeader){instructions.serverIsDone=true;var idx=doneHeader.indexOf("redirect:");if(idx==0){instructions.redirectUrl=doneHeader.substr("redirect:".length)}else{if(doneHeader=="permissionviolation"){instructions.redirectUrl=window.location.href}}}return instructions},_performRedirect:function(url){AJS.reloadViaWindowLocation(url)},_renders:{popupHeading:function(){var $el=jQuery("<div />");return $el.addClass(this.classNames.HEADING_AREA)},popupContent:function(){return jQuery("<div />").addClass(this.classNames.CONTENT_AREA)},popup:function(){return jQuery("<div />").attr("id",this.options.id||"").addClass(this.classNames.DIALOG).hide()}},_events:{"trigger":{simpleClick:function(e,item){this.$activeTrigger=item;if(!this.$activeTrigger.is("a")){this.$activeTrigger=item.find("a")}this.show();e.preventDefault()}},"container":{"keydown":function(e){if(e.which===jQuery.ui.keyCode.ESCAPE){var aborted=this.handleCancel();if(AJS.$.browser.msie&&aborted===false){e.preventDefault()}}}}},handleCancel:function(){return this.hide(true,{reason:JIRA.Dialog.HIDE_REASON.escape})},_showloadingIndicator:function(){JIRA.Loading.showLoadingIndicator()},_hideloadingIndicator:function(){JIRA.Loading.hideLoadingIndicator()},_positionInCenter:function(){var $window=AJS.$(window),$popup=this.get$popup(),$container=this.getContentContainer(),$contentArea=this.getContentArea(),cushion=40,windowHeight=$window.height();if(typeof this.options.width==="number"){$popup.width(this.options.width)}$popup.css({marginLeft:-$popup.outerWidth()/2,marginTop:Math.max(-$popup.outerHeight()/2,cushion-windowHeight/2)});var top=0;var el=$popup[0];while(el){top+=el.offsetTop;el=el.offsetParent}var popupMaxHeight=windowHeight-top-cushion;var padding=parseInt($contentArea.css("padding-top"),10)+parseInt($contentArea.css("padding-bottom"),10);$contentArea.css("maxHeight","");var contentMaxHeight=popupMaxHeight-($popup.outerHeight()-$container.outerHeight())-padding;$contentArea.css("maxHeight",contentMaxHeight);AJS.$(this).trigger("contentMaxHeightChanged",[contentMaxHeight])},getContentArea:function(){return this.$popup.find(".form-body")},getContentContainer:function(){var $container=this.$popup.find(".content-area-container");if($container.length===1){return $container}else{return this.$popup.find(".form-body")}},get$popup:function(){if(!this.$popup){this.$popup=this._render("popup").appendTo("body");this.$popup.addClass("box-shadow")}return this.$popup},bindAnchorsToDialog:function($anchors){var instance=this;$anchors.click(function(e){instance.$activeTrigger=AJS.$(this);delete instance.$content;instance._setContent();e.preventDefault()})},get$popupContent:function(){if(!this.$popupContent){this.$popupContent=this._render("popupContent").appendTo(this.get$popup())}return this.$popupContent},get$popupHeading:function(){if(!this.$popupHeading){this.$popupHeading=this._render("popupHeading").prependTo(this.get$popup())}return this.$popupHeading},getLoadingIndicator:function(){return this.get$popupContent().find(".throbber:last")},showFooterLoadingIndicator:function(){var $throbber=this.getLoadingIndicator();if($throbber.length){$throbber.addClass("loading")}},hideFooterLoadingIndicator:function(){var $throbber=this.getLoadingIndicator();if($throbber.length){$throbber.removeClass("loading")}},_watchTab:function(e){var $dialog_selectable,$first_selectable,$last_selectable;if(AJS.$(e.target).parents(this.get$popupContent()).length>0){if(AJS.$("html").hasClass("safari")){$dialog_selectable=AJS.$(":input:visible:enabled, :checkbox:visible:enabled, :radio:visible:enabled",this.OPEN_DIALOG_SELECTOR)}else{$dialog_selectable=AJS.$("a:visible, :input:visible:enabled, :checkbox:visible:enabled, :radio:visible:enabled",this.OPEN_DIALOG_SELECTOR)}$first_selectable=$dialog_selectable.first();$last_selectable=$dialog_selectable.last();if((e.target==$first_selectable[0]&&e.shiftKey)||(e.target==$last_selectable[0]&&!e.shiftKey)){if(e.shiftKey){$last_selectable.focus()}else{$first_selectable.focus()}e.preventDefault()}}},_show:function(forceReload){if(AJS.InlineLayer.current){AJS.InlineLayer.current.hide()}if(AJS.dropDown.current){AJS.dropDown.current.hide()}if(JIRA.Dialog.current){var prev;if(JIRA.Dialog.current.options.stacked){prev=JIRA.Dialog.current;prev.stacked=true;prev.hide(false);this.prev=prev}else{JIRA.Dialog.stackroot=this;var current=JIRA.Dialog.current;prev=current._removeStackState();current.hide(false);while(prev){current=prev;prev=current._removeStackState();current._destroyIfNecessary()}}}else{if(this.stacked!==true){JIRA.Dialog.stackroot=this;JIRA.Dialog.originalWindowTitle=document.title;AJS.dim(false)}}JIRA.Dialog.current=this;var $popup=this.get$popup().addClass(this.classNames.DIALOG_OPEN);if(forceReload||(this.options.type!=="blank"&&!this.$content&&this.stacked!==true)){delete this.$content;this._setContent()}else{$popup.show();this._positionInCenter();this._onShowContent()}this.tabWatcher=function(e){if(e.keyCode==9){JIRA.Dialog.current._watchTab(e)}};AJS.$(document).bind("keydown",this.tabWatcher);AJS.$(this).trigger("Dialog.show",[this.$popup,this,this.id]);AJS.$(AJS).trigger("Dialog.show",[this.$popup,this,this.id]);AJS.disableKeyboardScrolling();this.stacked=false},show:function(forceReload){var delayShow=this.options.delayShowUntil,instance=this;if(JIRA.Dialog.current===this){return false}var myEvent=new AJS.$.Event("beforeShow");AJS.$(this).trigger(myEvent);JIRA.trigger(myEvent,[this.options.id]);if(myEvent.isDefaultPrevented()){return false}if(delayShow){var promise=delayShow();if(promise.isResolved()){instance._show(forceReload)}else{AJS.dim(false);this._showloadingIndicator();promise.done(function(){instance._show(forceReload)})}}else{instance._show(forceReload)}},_setWindowTitle:function(){var titleOption=this.options.windowTitle,$container=this.get$popup(),dialogTitle,$heading;if(titleOption===false){return }else{if(typeof titleOption==="string"){dialogTitle=titleOption}else{if(typeof titleOption==="function"){dialogTitle=titleOption.call(this)}else{$heading=$container.find("."+this.classNames.HEADING_AREA);if($heading.length){dialogTitle=$heading.text()}}}}if(!dialogTitle){return }var jiraTitle=JIRA.Settings.ApplicationTitle.get();var newTitle=[dialogTitle];if(jiraTitle){newTitle.push(jiraTitle)}document.title=newTitle.join(" - ")},_onShowContent:function(){this._setWindowTitle();this._hideloadingIndicator();this._ellipsify();this.get$popup().addClass(this.classNames.CONTENT_READY)},_resetWindowTitle:function(){if(this.stacked!==true&&JIRA.Dialog.stackroot===this){if(JIRA.Dialog.originalWindowTitle){if(document.title!==JIRA.Dialog.originalWindowTitle){document.title=JIRA.Dialog.originalWindowTitle}delete JIRA.Dialog.originalWindowTitle}}},notifyOfNewContent:function(){if(this.$content){this.decorateContent();this._positionInCenter();this._onShowContent();jQuery(document).trigger("dialogContentReady",[this])}},destroy:function(){this.$popup&&this.$popup.remove();delete this.$popup;delete this.$popupContent;delete this.$popupHeading;delete this.$content},_destroyIfNecessary:function(){!this.options.cached&&this.destroy()},_removeStackState:function(){var prev=this.prev;delete this.prev;delete this.stacked;return prev},isCurrent:function(){return JIRA.Dialog.current===this},hide:function(undim,options){if(JIRA.Dialog.current!==this){return }var beforeHideEvent=new jQuery.Event("Dialog.beforeHide");options=options||{};JIRA.trigger(beforeHideEvent,[this.$popup,options.reason,this.options.id]);AJS.$(this).trigger(beforeHideEvent,[this.$popup,options.reason,this.options.id]);if(beforeHideEvent.isDefaultPrevented()){return false}var atlToken=AJS.$("input[name=atl_token]",this.OPEN_DIALOG_SELECTOR).attr("value");if(atlToken!==undefined){JIRA.XSRF.updateTokenOnPage(atlToken)}if(undim!==false&&!this.prev){AJS.undim()}this.get$popup().removeClass(this.classNames.DIALOG_OPEN).removeClass(this.classNames.CONTENT_READY).hide();this._hideloadingIndicator();this._resetWindowTitle();JIRA.Dialog.current=null;AJS.$(document).trigger("hideAllLayers",[this.$popup,options.reason,this.options.id]);AJS.$(this).trigger("Dialog.hide",[this.$popup,options.reason,this.options.id]);JIRA.trigger("Dialog.hide",[this.$popup,options.reason,this.options.id]);if(this.options.cached===false&&this.stacked!==true){this.destroy()}AJS.enableKeyboardScrolling();if(this.tabWatcher){AJS.$(document).unbind("keydown",this.tabWatcher)}if(this.stacked!==true){if(this.prev){this.prev.show(!!this.prev.options.reloadOnPop);delete this.prev}else{if(JIRA.Dialog.stackroot===this){delete JIRA.Dialog.stackroot}}}},addHeading:function(heading){var $pieces=AJS.$("<div/>").html(heading).contents();var $title=AJS.$("<h2/>");var contents=[];$pieces.each(function(i){if(this.nodeName.toLowerCase()=="div"){contents.push(this)}else{$title.append(this)}});this.get$popupHeading().html(contents).append($title);$title.attr("title",AJS.$.trim($title.text()))},onContentReady:function(func){if(AJS.$.isFunction(func)){this.onContentReadyCallbacks.push(func)}}});JIRA.Dialog.ClassNames={DIALOG:"jira-dialog",HEADING_AREA:"jira-dialog-heading",CONTENT_AREA:"jira-dialog-content",DIALOG_OPEN:"jira-dialog-open",CONTENT_READY:"jira-dialog-content-ready"};JIRA.Dialog.WIDTH_PRESETS={small:360,medium:540,large:810};JIRA.Dialog.HIDE_REASON={cancel:"cancel",escape:"esc",submit:"submit"};AJS.namespace("AJS.FlexiPopup",null,JIRA.Dialog);
/* module-key = 'jira.webresources:dialogs', location = '/includes/jira/dialog/plugins/dirtyFormWarning.js' */
JIRA.Dialog.fn.dirtyFormWarning=function(){var handler=function(e,popup,hideReason){var dirtyMessage;if(!e.isDefaultPrevented()&&hideReason===JIRA.Dialog.HIDE_REASON.escape){dirtyMessage=JIRA.DirtyForm.getDirtyWarning();if(dirtyMessage&&!confirm(dirtyMessage)){e.preventDefault()}}};return function(){return this.bind("Dialog.beforeHide",handler)}}();
/* module-key = 'jira.webresources:dialogs', location = '/includes/jira/focus/setFocus.js' */
JIRA.setFocus=(function(){var _defaultExcludeParentSelector="form.dont-default-focus",_defaultFocusElementSelector="input:not(#issue-filter-submit), select, textarea, button, a.cancel",_defaultParentElementSelectors=["."+JIRA.Dialog.ClassNames.CONTENT_AREA,"form.aui","form"],_configurationStack=[];var _focusIn=function(context,parentSelector,excludeParentSelector,elementSelector){var found=false;AJS.$(parentSelector,context).not(excludeParentSelector).find(elementSelector).each(function(){var elem=AJS.$(this);if(elem.is(":enabled, a")&&elem.is(":visible")){elem.focus();if(elem.is(":text, :password, textarea")){if(elem.is(".focus-select-end")){elem.setCaretToPosition(elem[0].value.length)}else{elem.setSelectionRange(0,elem[0].value.length)}}found=true;return false}});return found},_defaultFocusNow=function(){var i=0,currentConfig=_configurationStack[_configurationStack.length-1];while(!_focusIn(currentConfig.context,currentConfig.parentElementSelectors[i],currentConfig.excludeParentSelector,currentConfig.focusElementSelector)&&i<currentConfig.parentElementSelectors.length){i++}};return{FocusConfiguration:function(){this.context=document;this.excludeParentSelector=_defaultExcludeParentSelector;this.focusElementSelector=_defaultFocusElementSelector;this.parentElementSelectors=_defaultParentElementSelectors.slice(0);this.focusNow=_defaultFocusNow},triggerFocus:function(){if(_configurationStack.length==0){_configurationStack.push(new this.FocusConfiguration())}_configurationStack[_configurationStack.length-1].focusNow()},pushConfiguration:function(configuration){_configurationStack.push(configuration)},popConfiguration:function(){_configurationStack.pop()}}})();jQuery(function(){JIRA.setFocus.triggerFocus()});
/* module-key = 'jira.webresources:dialogs', location = '/includes/jira/dialog/FormDialog.js' */
JIRA.FormDialog=JIRA.Dialog.extend({_getDefaultOptions:function(){return AJS.$.extend(this._super(),{autoClose:false,targetUrl:"",handleRedirect:false,onUnSuccessfulSubmit:function(){},onSuccessfulSubmit:function(){},onDialogFinished:function(){var targetUrl=this._getTargetUrlValue();this.hide();if(targetUrl){AJS.$(AJS).trigger("page-unload.location-change.from-dialog",[this.$popup]);window.location.href=targetUrl}else{AJS.$(AJS).trigger("page-unload.refresh.from-dialog",[this.$popup]);AJS.reloadViaWindowLocation()}},submitAjaxOptions:{type:"post",data:{inline:true,decorator:"dialog"},dataType:"html"},isIssueDialog:false})},_getFormDataAsObject:function(){var fieldValues={};AJS.$(this.$form.serializeArray()).each(function(){var fieldVal=fieldValues[this.name];if(!fieldVal){fieldVal=this.value}else{if(AJS.$.isArray(fieldVal)){fieldVal.push(this.value)}else{fieldVal=[fieldVal,this.value]}}fieldValues[this.name]=fieldVal});return fieldValues},_getRelativePath:function(){var ajaxOptions=this._getRequestOptions();return parseUri(ajaxOptions.url).directory},_getPath:function(action){var relPath=this._getRelativePath();if(action.indexOf(relPath)==0){return action}else{return relPath+action}},_submitForm:function(e){this.cancelled=false;this.xhr=null;this.redirected=false;this.serverIsDone=false;var instance=this,defaultRequestOptions=AJS.$.extend(true,{},this.options.submitAjaxOptions),requestOptions=AJS.$.extend(true,defaultRequestOptions,{url:this._getPath(this.$form.attr("action")),data:this._getFormDataAsObject(),complete:function(xhr,textStatus,smartAjaxResult){instance.hideFooterLoadingIndicator();if(!instance.cancelled){if(smartAjaxResult.successful){instance.$form.trigger("fakesubmit");instance._handleServerSuccess(smartAjaxResult.data,xhr,textStatus,smartAjaxResult);if(!instance.redirected){instance._handleSubmitResponse(smartAjaxResult.data,xhr,smartAjaxResult)}}else{instance._handleServerError(xhr,textStatus,smartAjaxResult.errorThrown,smartAjaxResult)}}instance.$form.removeClass("submitting")}});this.showFooterLoadingIndicator();this.xhr=JIRA.SmartAjax.makeRequest(requestOptions);e.preventDefault()},_handleServerError:function(xhr,textStatus,errorThrown,smartAjaxResult){if(this.options.onUnSuccessfulSubmit){this.options.onUnSuccessfulSubmit.call(xhr,textStatus,errorThrown,smartAjaxResult)}var errorContent=JIRA.SmartAjax.buildDialogErrorContent(smartAjaxResult,true);var content$=this.get$popupContent().find(".form-body");if(content$.length!==1){content$=this.get$popupContent()}var insertErrMsg=content$.length===1&&!smartAjaxResult.hasData;if(insertErrMsg){content$.prepend(errorContent)}else{this.setSubmitResponseContent(errorContent)}},setSubmitResponseContent:function(content){if(this.options.formatSubmitResponseContent){content=this.options.formatSubmitResponseContent.call(this,content)}this._setContent(content)},isIssueDialog:function(){return !!this.options.isIssueDialog},_handleServerSuccess:function(data,xhr,textStatus,smartAjaxResult){var msgInstructions=this._detectMsgInstructions(xhr);if(msgInstructions){JIRA.Messages.showMsgOnReload(msgInstructions.msg,{type:msgInstructions.type,closeable:msgInstructions.closeable,target:msgInstructions.target})}var instructions=this._detectRedirectInstructions(xhr);this.serverIsDone=instructions.serverIsDone;if(instructions.redirectUrl){if(this.options.onSuccessfulSubmit){this.options.onSuccessfulSubmit.call(this,data,xhr,textStatus,smartAjaxResult)}this._performRedirect(instructions.redirectUrl)}else{if(!this.serverIsDone){this.setSubmitResponseContent(data)}}},_detectMsgInstructions:function(xhr){var instructions={msg:xhr.getResponseHeader("X-Atlassian-Dialog-Msg-Html")};if(instructions.msg){instructions.type=xhr.getResponseHeader("X-Atlassian-Dialog-Msg-Type").toUpperCase();instructions.closeable=(xhr.getResponseHeader("X-Atlassian-Dialog-Msg-Closeable")==="true");instructions.target=xhr.getResponseHeader("X-Atlassian-Dialog-Msg-Target");return instructions}},_handleInitialDoneResponse:function(data,xhr,smartAjaxResult){this._handleSubmitResponse(data,xhr,smartAjaxResult)},_handleSubmitResponse:function(data,xhr,smartAjaxResult){if(this.serverIsDone){if(this.options.onSuccessfulSubmit){this.options.onSuccessfulSubmit.call(this,data,xhr,smartAjaxResult)}if(this.options.autoClose){this.hide()}if(this.options.onDialogFinished){this.options.onDialogFinished.call(this,data,xhr,smartAjaxResult)}}},_performRedirect:function(url){if(!this.options.stayVisibleOnRedirect){this.hide()}this.redirected=true;this._super(url)},_hasTargetUrl:function(){return this._getTargetUrlHolder().length>0},_getTargetUrlHolder:function(){return AJS.$(this.options.targetUrl)},_getTargetUrlValue:function(){return this._getTargetUrlHolder().val()},decorateContent:function(){var instance=this,$buttons,$cancel,$buttonContainer,$footerContainer,$closeLink;this.$form=AJS.$("form",this.get$popupContent());this._constructHeading();this.$form.submit(function(e){var event=new jQuery.Event("before-submit");instance.$form.trigger(event,[e,instance]);if(!event.isDefaultPrevented()){instance.$form.addClass("submitting");var submitButtons=AJS.$(":submit",instance.$form);submitButtons.attr("disabled","disabled");if(instance.options.submitHandler){instance.showFooterLoadingIndicator();instance.options.submitHandler.call(instance,e,function(){if(instance.isCurrent()){instance.hideFooterLoadingIndicator();instance.$form.removeClass("submitting")}})}else{instance._submitForm(e)}}else{e.preventDefault()}});$cancel=AJS.$(".cancel",this.get$popupContent());$cancel.click(function(e){if(instance.xhr){instance.xhr.abort()}instance.xhr=null;instance.cancelled=true;instance.hide(true,{reason:JIRA.Dialog.HIDE_REASON.cancel});e.preventDefault()});if(AJS.$.browser.msie){$cancel.focus(function(e){if(e.altKey){$cancel.click()}})}$buttons=this.get$popupContent().find(".button, .aui-button");$buttonContainer=this.get$popupContent().find("div.buttons");if($cancel.length===0&&$buttons.length===0){if($buttonContainer.length===0){$footerContainer=AJS.$('<div class="buttons-container form-footer"><div class="buttons"/></div>').appendTo(this.get$popupContent());$buttonContainer=$footerContainer.find(".buttons")}AJS.populateParameters();$closeLink=AJS.$("<button class='aui-button aui-button-link cancel' id='aui-dialog-close'>"+"Close"+"</button>");$buttonContainer.append($closeLink);$closeLink=AJS.$(".cancel",this.get$popupContent());$closeLink.click(function(e){instance.hide(true,{reason:JIRA.Dialog.HIDE_REASON.cancel});e.preventDefault()})}$buttonContainer.prepend(AJS.$("<span class='icon throbber'/>"));this.get$popupContent().on("click",".shortcut-tip-trigger",function(e){e.preventDefault();if(!instance.get$popupContent().isDirty()||confirm("You have entered new data in this dialog. If you navigate away from this dialog without first saving your data, the changes will be lost. Click cancel to return to the dialog.")){instance.hide();AJS.$("#keyshortscuthelp").click()}});if(!($footerContainer instanceof jQuery)){$footerContainer=$buttonContainer.closest(".buttons-container, .form-footer");if(!$footerContainer.size()){$footerContainer=$buttonContainer}}this.$buttonContainer=$footerContainer},getButtonsContainer:function(){return this.$buttonContainer},_constructHeading:function(){var $formHeading,$formHeadingContainer;$formHeading=AJS.$(":header:first",this.get$popupContent());if($formHeading.length>0){this.addHeading($formHeading.contents());$formHeadingContainer=$formHeading.parent();$formHeading.remove();while($formHeadingContainer.is(":empty")){$formHeading=$formHeadingContainer.parent();$formHeadingContainer.remove();$formHeadingContainer=$formHeading}}},_setContent:function(content,decorate){this._super(content,decorate);if(content&&JIRA.Dialog.current===this){if(AJS.$.browser.msie){this.$form.bind("keypress",function(e){if(e.keyCode===13&&AJS.$(e.target).is("input")){e.preventDefault();AJS.$(this).submit()}})}if(JIRA.Dialog.current===this){this._focusFirstField()}}},_focusFirstField:function(focusElementSelector){var triggerConfig=new JIRA.setFocus.FocusConfiguration();if(focusElementSelector){triggerConfig.focusElementSelector=focusElementSelector}else{if(this.$activeTrigger&&this.$activeTrigger.attr("data-field")){triggerConfig.focusElementSelector="[name='"+this.$activeTrigger.attr("data-field")+"']"}}triggerConfig.parentElementSelectors.unshift(".aui-dialog-content");triggerConfig.context=this.get$popup()[0];if(AJS.$.browser.msie){var $focusHack=AJS.$(".trigger-hack",triggerConfig.context);if($focusHack.length===0){$focusHack=AJS.$("<input Class='trigger-hack' type='text' value=''/>").css({position:"absolute",left:-9000,top:-9000}).appendTo(triggerConfig.context)}$focusHack.focus()}JIRA.setFocus.pushConfiguration(triggerConfig);JIRA.setFocus.triggerFocus();JIRA.setFocus.triggerFocus()},hide:function(undim,options){if(this._super(undim,options)===false){return false}JIRA.setFocus.popConfiguration()}});AJS.namespace("AJS.FormPopup",null,JIRA.FormDialog);
/* module-key = 'jira.webresources:dialogs', location = '/includes/ajs/ajax/SmartAjaxWebSudo.js' */
(function($){JIRA.SmartAjax.showWebSudoDialog=function(options){var context=options.context||this;var dialog=new JIRA.FormDialog({id:"smart-websudo",type:"ajax",ajaxOptions:{url:contextPath+"/secure/admin/WebSudoAuthenticate!default.jspa?close=true"},submitHandler:function(e,closeCallback){e.preventDefault();var form=$(e.target);JIRA.SmartAjax.makeRequest({url:form.attr("action"),data:form.serialize(),type:"POST",complete:function(xhr){if(xhr.getResponseHeader("X-Atlassian-WebSudo")==="Has-Authentication"){if($.isFunction(options.success)){options.success.call(context,function(){closeCallback();dialog.hide()})}else{closeCallback();dialog.hide()}}else{dialog._setContent(xhr.responseText,true)}}})}});if($.isFunction(options.cancel)){$(dialog).one("Dialog.hide",function(e,el,reason){if(reason==JIRA.Dialog.HIDE_REASON.cancel||reason==JIRA.Dialog.HIDE_REASON.escape){e=$.Event();(options.cancel.call(context,e)===false||!e.isDefaultPrevented())&&AJS.reloadViaWindowLocation(el.find(".cancel").attr("href"))}})}if($.isFunction(options.beforeShow)){options.beforeShow.call(context)}dialog.show();if($.isFunction(options.show)){options.show.call(context)}};JIRA.SmartAjax.handleWebSudoError=function(ajaxOptions,dialogOptions,xhr,statusText,smartAjaxResult){var newOptions={success:function(closeFunction){if(dialogOptions&&$.isFunction(dialogOptions.success)){dialogOptions.success.apply(this,arguments)}else{closeFunction()}JIRA.SmartAjax.makeRequest(ajaxOptions)},cancel:function(){$.isFunction(ajaxOptions.complete)&&ajaxOptions.complete.call(this,xhr,statusText,smartAjaxResult);dialogOptions&&$.isFunction(dialogOptions.cancel)&&dialogOptions.cancel.apply(this,arguments)},beforeShow:function(){if(dialogOptions&&$.isFunction(dialogOptions.beforeShow)){dialogOptions.beforeShow.apply(this,arguments)}},show:function(){if(dialogOptions&&$.isFunction(dialogOptions.show)){dialogOptions.show.apply(this,arguments)}},context:this};JIRA.SmartAjax.showWebSudoDialog(newOptions)};JIRA.SmartAjax.makeWebSudoRequest=function(ajaxOptions,dialogOptions){var ourAjaxOptions=$.extend({},ajaxOptions);var suppressComplete=false;var deferred=$.Deferred();var errorHandler=function(xhr,statusText,errorThrown,smartAjaxResult){if(xhr.status===401&&xhr.responseText.match(/websudo/i)){suppressComplete=true;JIRA.SmartAjax.handleWebSudoError(ourAjaxOptions,dialogOptions,xhr,statusText,smartAjaxResult)}else{deferred.rejectWith(this,arguments);$.isFunction(ajaxOptions.error)&&ajaxOptions.error.apply(this,arguments)}};var completeHandler=function(){!suppressComplete&&$.isFunction(ajaxOptions.complete)&&ajaxOptions.complete.apply(this,arguments);suppressComplete=false};var successHandler=function(){$.isFunction(ajaxOptions.success)&&ajaxOptions.success.apply(this,arguments);deferred.resolveWith(this,arguments)};ourAjaxOptions.error=errorHandler;ourAjaxOptions.complete=completeHandler;ourAjaxOptions.success=successHandler;JIRA.SmartAjax.makeRequest(ourAjaxOptions);return deferred.promise()}})(AJS.$);
/* module-key = 'jira.webresources:dialogs', location = '/includes/jira/dialog/IssueDialogUtil.js' */
JIRA.Dialogs={};JIRA.Dialogs.getDefaultAjaxOptions=function(){var $focusRow=JIRA.IssueNavigator.get$focusedRow();var linkIssueURI=this.options.url||this.getRequestUrlFromTrigger();if(/id=\{0\}/.test(linkIssueURI)){if(!$focusRow.length){return false}else{linkIssueURI=linkIssueURI.replace(/(id=\{0\})/,"id="+$focusRow.attr("rel"))}}if(JIRA.IssueNavigator.isNavigator()){var result=/[?&]id=([0-9]+)/.exec(linkIssueURI);this.issueId=result&&result.length==2?result[1]:null;if(this.issueId!==$focusRow.attr("rel")){JIRA.IssueNavigator.Shortcuts.focusRow(this.issueId);$focusRow=JIRA.IssueNavigator.get$focusedRow()}this.issueKey=JIRA.IssueNavigator.getSelectedIssueKey()}return{data:{decorator:"dialog",inline:"true"},url:linkIssueURI}};JIRA.Dialogs.BeforeShowIssueDialogHandler=function(){var deferreds=[];return{add:function(deferred){deferreds.push(deferred);return this},execute:function(){var invokedDeferreds=[];if(deferreds.length===0){return jQuery.Deferred().resolve()}else{_.each(deferreds,function(deferred){invokedDeferreds.push(deferred())});return jQuery.when.apply(jQuery,invokedDeferreds)}}}}();JIRA.Dialogs.storeCurrentIssueIdOnSucessfulSubmit=function(){if(JIRA.IssueNavigator.isNavigator()){JIRA.IssueNavigator.setIssueUpdatedMsg({issueMsg:this.options.issueMsg,issueId:this.issueId,issueKey:this.issueKey})}};
/* module-key = 'jira.webresources:dialogs', location = '/includes/jira/dialog/IssueActionsDialog.js' */
JIRA.Shifter.register(function(){var actionDeferred=jQuery.Deferred();var workflowDeferred=jQuery.Deferred();function tryGetting(fns){for(var i=0;i<fns.length;i++){var func=_.reduce(fns[i].split("."),function(obj,prop){return obj!==undefined?obj[prop]:undefined},window);if(_.isFunction(func)){var value=func();if(value!=null){return value}}}return undefined}var issueKey=tryGetting(["JIRA.Issues.getSelectedIssueKey","JIRA.Issue.getIssueKey","JIRA.IssueNavigator.getSelectedIssueKey"]);var issueId=tryGetting(["JIRA.Issues.getSelectedIssueKey","JIRA.Issue.getIssueId","JIRA.IssueNavigator.getSelectedIssueId"]);if(issueId==null){return null}var url=AJS.format(AJS.contextPath()+"/rest/api/1.0/issues/{0}/ActionsAndOperations?atl_token={1}",issueId,atl_token());JIRA.SmartAjax.makeRequest({dataType:"json",url:url}).done(function(response){var actionSuggestions=_.map(response.operations,function(operation){return{label:operation.name,value:{styleClass:operation.styleClass,url:operation.url}}});var workflowSuggestions=_.map(response.actions,function(workflow){var url=AJS.contextPath()+"/secure/WorkflowUIDispatcher.jspa?id="+response.id+"&action="+workflow.action+"&atl_token="+response.atlToken;return{label:workflow.name,value:{styleClass:"issueaction-workflow-transition",url:url}}});actionDeferred.resolve(actionSuggestions);workflowDeferred.resolve(workflowSuggestions)}).fail(function(jqXHR,textStatus){var errorMsg;if(JIRA&&JIRA.Templates&&JIRA.Templates.ViewIssue&&JIRA.Templates.ViewIssue.Body&&JIRA.Templates.ViewIssue.Body.errorsLoading){errorMsg=JIRA.Templates.ViewIssue.Body.errorsLoading({isTimeout:textStatus=="timeout"})}else{errorMsg="Unable to retrieve issue."}actionDeferred.resolve([{label:errorMsg,messageID:"error-loading-issue",useAUI:false,isMessage:true}]);workflowDeferred.reject()});var onSelection=function(value){var $dialogTrigger=AJS.$("<a>",{"class":value.styleClass,href:value.url,css:{display:"none"}});$dialogTrigger.appendTo("body").get(0).click();$dialogTrigger.remove()};return[{id:"issue-actions",name:"Issue Actions",context:issueKey,weight:200,getSuggestions:function(){return actionDeferred},onSelection:onSelection},{id:"issue-transitions",name:"Workflow",context:issueKey,weight:220,getSuggestions:function(){return workflowDeferred},onSelection:onSelection}]});
/* module-key = 'jira.webresources:dialogs', location = '/includes/jira/dialog/LabelsDialog.js' */
JIRA.LabelsDialog=JIRA.FormDialog.extend((function(){var impl={};impl.init=function(options){this._super(options);this.issueId=null;this.customFieldId=null;this.labelsProvider=this.initLabelsProvider();this.labelPicker=null},impl.initLabelsProvider=function(){if(this.options.labelsProvider&&AJS.$.isFunction(this.options.labelsProvider)){return this.options.labelsProvider}else{if(this.options.labels){return this._getLabelsFromOptions}else{return this._getLabelsFromTrigger}}},impl._getLabelsFromOptions=function(){return AJS.$(this.options.labels)},impl._getLabelsFromTrigger=function(){return this.$activeTrigger.closest(".labels-wrap")},impl.decorateContent=function(){this._super();var $content=this.get$popupContent();this.issueId=$content.find("input[name=id]").val();var $customFieldId=$content.find("input[name=customFieldId]");if($customFieldId.length===1){this.customFieldId=$customFieldId.val()}else{this.customFieldId=null}};impl.focusLabelPicker=function(){this.get$popupContent().find("textarea").focus()};impl.show=function(){if(this._super()){this.focusLabelPicker()}};impl._handleSubmitResponse=function(data,xhr,smartAjaxResult){if(this.serverIsDone){if(this.options.onSuccessfulSubmit){this.options.onSuccessfulSubmit.call(this,data,xhr,smartAjaxResult)}var issueIdVal=this.get$popupContent().find("input[name=id]").val(),noLinkVal=this.get$popupContent().find("input[name=noLink]").val();if(this.options.autoClose){this.hide()}JIRA.IssueNavigator.Shortcuts.flashIssueRow(this.issueId);var jsonpData={id:issueIdVal,decorator:"none",noLink:noLinkVal};if(this.customFieldId){jsonpData.customFieldId=this.customFieldId}var instance=this;var $labelsWrap=instance.labelsProvider(this);jQuery(jQuery.ajax({url:contextPath+"/secure/EditLabels!viewLinks.jspa",data:jsonpData,success:function(html){var $newLabelsWrap=jQuery("<div>").html(html).find(".labels-wrap");if(JIRA.IssueNavigator.isNavigator()){$newLabelsWrap.find("a.edit-labels").remove()}$labelsWrap.html($newLabelsWrap.html());if(JIRA.Events.REFRESH_ISSUE_PAGE){JIRA.trigger(JIRA.Events.REFRESH_ISSUE_PAGE,[JIRA.Issue.getIssueId()])}}})).throbber({target:$labelsWrap})}};impl.handleCancel=function(){this._super();this.$content=null};return impl})());AJS.namespace("AJS.LabelsPopup",null,JIRA.LabelsDialog);
/* module-key = 'jira.webresources:dialogs', location = '/includes/jira/dialog/ScreenshotDialog.js' */
JIRA.ScreenshotDialog=function(options){this.$trigger=jQuery(options.trigger);AJS.$(document).delegate(options.trigger,"click",function(e){e.preventDefault();if(JIRA.Dialog.current){JIRA.Dialog.current.hide()}if(AJS.InlineLayer.current){AJS.InlineLayer.current.hide()}window.open(AJS.$(this).attr("href")+"&decorator=popup","screenshot","width=800,height=700,scrollbars=yes,status=yes")})};AJS.namespace("jira.app.attachments.screenshot.ScreenshotWindow",null,JIRA.ScreenshotDialog);
/* module-key = 'jira.webresources:dialogs', location = '/includes/jira/dialog/userhover.js' */
jQuery(document).delegate(".user-hover[rel]",{"mousemove":function(){JIRA.userhover.show(this)},"mouseleave":function(){JIRA.userhover.hide(this)},"click":function(){JIRA.userhover.hide(this,-1)}});JIRA.userhover=function(){};JIRA.userhover.INLINE_DIALOG_OPTIONS={urlPrefix:contextPath+"/secure/ViewUserHover!default.jspa?decorator=none&username=",showDelay:400,closeOthers:false,noBind:true,hideCallback:function(){this.popup.remove()}};JIRA.userhover.show=function(trigger){clearTimeout(AJS.$.data(trigger,"AJS.InlineDialog.delayId")||0);AJS.$.data(trigger,"AJS.InlineDialog.hasUserAttention",true);if(AJS.$.data(trigger,"AJS.InlineDialog")||JIRA.userhover._locked){return }AJS.$.data(trigger,"AJS.InlineDialog.delayId",setTimeout(function(){if(AJS.$(trigger).closest("html").length===0){JIRA.userhover.hide(trigger);return }AJS.$.data(trigger,"AJS.InlineDialog",AJS.InlineDialog(AJS.$(trigger),"user-hover-dialog-"+new Date().getTime(),function($contents,_,showPopup){JIRA.userhover._fetchDialogContents($contents,trigger,showPopup)},JIRA.userhover.INLINE_DIALOG_OPTIONS)).show()},JIRA.userhover.INLINE_DIALOG_OPTIONS.showDelay))};JIRA.userhover.hide=function(trigger,showDelay){clearTimeout(AJS.$.data(trigger,"AJS.InlineDialog.delayId")||0);AJS.$.data(trigger,"AJS.InlineDialog.hasUserAttention",false);var dialog=AJS.$.data(trigger,"AJS.InlineDialog");if(dialog&&!JIRA.userhover._locked){if(typeof showDelay!=="number"){showDelay=JIRA.userhover.INLINE_DIALOG_OPTIONS.showDelay}if(showDelay>=0){AJS.$.data(trigger,"AJS.InlineDialog.delayId",setTimeout(function(){dialog.hide();AJS.$.data(trigger,"AJS.InlineDialog",null)},showDelay))}else{dialog.hide();AJS.$.data(trigger,"AJS.InlineDialog",null)}}};JIRA.userhover._locked=false;JIRA.userhover._fetchDialogContents=function($contents,trigger,showPopup){AJS.$.get(JIRA.userhover.INLINE_DIALOG_OPTIONS.urlPrefix+encodeURIComponent(trigger.getAttribute("rel")),function(html){if(AJS.$.data(trigger,"AJS.InlineDialog.hasUserAttention")){$contents.html(html);$contents.css("overflow","visible");AJS.$(AJS.Dropdown.create({trigger:$contents.find(".aui-dd-link"),content:$contents.find(".aui-list")})).bind({"showLayer":function(){JIRA.userhover._locked=true},"hideLayer":function(){JIRA.userhover._locked=false;if(!AJS.$.data(trigger,"AJS.InlineDialog.hasUserAttention")){JIRA.userhover.hide(trigger)}}});showPopup();AJS.$.data(trigger,"AJS.InlineDialog.delayId",setTimeout(function(){$contents.bind({"mousemove":function(){JIRA.userhover.show(trigger)},"mouseleave":function(){JIRA.userhover.hide(trigger)}})},JIRA.userhover.INLINE_DIALOG_OPTIONS.showDelay))}})};AJS.namespace("jira.app.userhover",null,JIRA.userhover);
/* module-key = 'jira.webresources:dialogs', location = '/includes/ajs/attachment/InlineAttach.js' */
AJS.InlineAttach=Class.extend({init:function(element){var $element=AJS.$(element);if(AJS.InlineAttach.AjaxPresenter.isSupported($element)){new AJS.InlineAttach.AjaxPresenter($element)}else{new AJS.InlineAttach.FormPresenter($element)}}});AJS.$.extend(AJS.InlineAttach,{MAX_UPLOADS:2,DISPLAY_WAIT:600,rescope:function(fn,scope){if(fn){if(scope){return AJS.$.proxy(fn,scope)}else{return fn}}else{return AJS.$.noop}},copyArrayLike:function(array){return AJS.$.makeArray(array)},Renderers:{container:function(){return AJS.$("<div class='field-group'/>")}}});AJS.InlineAttach.Presenter=Class.extend({init:function(){this.cancelled=false;this.running=[];this.waiting=[]},_addUpload:function(upload){if(!this.cancelled){if(this.running.length>=AJS.InlineAttach.MAX_UPLOADS){this.waiting.push(upload)}else{this.running.push(upload);upload.upload()}}return this.running.length>0},_finishUpload:function(upload){if(!this.cancelled){AJS.InlineAttach.Presenter.removeFromArray(this.waiting,upload);if(AJS.InlineAttach.Presenter.removeFromArray(this.running,upload)){if(this.waiting.length>0){var next=this.waiting.shift();this.running.push(next);next.upload()}}}return this.running.length>0},_cancel:function(){this.cancelled=true;var i;var wait=AJS.InlineAttach.copyArrayLike(this.waiting);for(i=0;i<wait.length;i++){wait[i].abort()}var run=AJS.InlineAttach.copyArrayLike(this.running);for(i=0;i<run.length;i++){run[i].abort()}this.waiting=[];this.running=[]}});AJS.$.extend(AJS.InlineAttach.Presenter,{removeFromArray:function(array,element){var index=AJS.$.inArray(element,array);if(index>=0){return array.splice(index,1)}else{return null}}});AJS.InlineAttach.FormPresenter=AJS.InlineAttach.Presenter.extend({init:function($element){this._super();this.form=new AJS.InlineAttach.Form(new AJS.InlineAttach.FileInput($element,false));this.form.fileSelector.onChange(AJS.$.proxy(this._attach,this));this.form.onCancel(AJS.$.proxy(this._cancel,this))},_attach:function(fileName){this.form.clearErrors();if(this.cancelled){return }var form=this.form,data=this._createSubmitData();var $oldInput=form.cloneFileInput();form.fileSelector.clear();var progress=form.addStaticProgress(fileName);var timer=new AJS.InlineAttach.Timer(function(){!this.cancelled&&progress.show()},this);var upload=new AJS.InlineAttach.FormUpload({$input:$oldInput,url:AJS.InlineAttach.FormPresenter.DEFAULT_URL,params:data,scope:this,before:function(){!this.cancelled&&progress.start()},success:function(val){if(this.cancelled){return }if(val.id&&val.name){form.addTemporaryFileCheckbox(val.id,val.name,progress)}else{if(val.errorMsg){form.addErrorWithFileName(val.errorMsg,fileName,progress)}else{form.addError(AJS.InlineAttach.Text.tr("upload.error.bad.response",fileName),progress)}}},error:function(text){if(this.cancelled){return }if(text.indexOf("SecurityTokenMissing")>=0){form.addError(AJS.InlineAttach.Text.tr("upload.xsrf.timeout",fileName),progress)}else{form.addError(AJS.InlineAttach.Text.tr("upload.error.unknown",fileName),progress)}},after:function(){timer.cancel();progress.remove();if(!this.cancelled&&!this._finishUpload(upload)){form.enable()}}});progress.onCancel(function(){upload.abort()});if(this._addUpload(upload)){timer.schedule(AJS.InlineAttach.DISPLAY_WAIT);form.disable()}form.fileSelector.focus()},_cancel:function(){this._super();this.form.enable()},_createSubmitData:function(){var data={atl_token:this.form.getAtlToken()};if(this.form.issueId){data.id=this.form.issueId}else{if(this.form.projectId){data.create=true;data.projectId=this.form.projectId}else{throw"Unable to find either an issueId or projectId to submit the attachment to."}}return data}});AJS.InlineAttach.FormPresenter.DEFAULT_URL=contextPath+"/secure/AttachTemporaryFile.jspa?decorator=none";AJS.InlineAttach.AjaxPresenter=AJS.InlineAttach.Presenter.extend({init:function($element){this._super();this.form=new AJS.InlineAttach.Form(new AJS.InlineAttach.FileInput($element,true));this.form.fileSelector.onChange(AJS.$.proxy(this._attach,this));this.form.onCancel(AJS.$.proxy(this._cancel,this))},_attach:function(files){this.form.clearErrors();if(this.cancelled){return }if(files&&files.length>0){files=this._checkAndFilterFiles(files);if(files){this._uploadFiles(files)}}this.form.fileSelector.clear().focus()},_checkAndFilterFiles:function(files){if(files.length>AJS.InlineAttach.AjaxPresenter.MAX_SELECTED_FILES){this.form.addError(AJS.InlineAttach.Text.tr("upload.error.too.many.files",files.length,AJS.InlineAttach.AjaxPresenter.MAX_SELECTED_FILES));return null}var maxSize=this.form.maxSize;var newFiles=[];for(var i=0;i<files.length;i++){try{var file=files[i];if(file.size==0){this.form.addError(AJS.InlineAttach.Text.tr("upload.empty.file",file.name))}else{if(maxSize>0&&file.size>maxSize){var sizes=AJS.InlineAttach.Text.fileSize(maxSize,file.size);this.form.addError(AJS.InlineAttach.Text.tr("upload.too.big",file.name,sizes[1],sizes[0]))}else{newFiles.push({name:file.name,size:file.size,file:file})}}}catch(e){this.form.addError(AJS.InlineAttach.AjaxUpload.getClientErrorMessage(e,file))}}return newFiles.length==0?null:newFiles},_createSubmitData:function(){var data={atl_token:this.form.getAtlToken()};if(this.form.issueId){data.issueId=this.form.issueId}else{if(this.form.projectId){data.projectId=this.form.projectId}else{throw"Unable to find either an issueId or projectId to submit the attachment to."}}return data},_uploadFiles:function(files){var form=this.form,data=this._createSubmitData(),that=this,running=false;AJS.$.each(files,function(){var progress=form.addProgress(this),file=this;var timer=new AJS.InlineAttach.Timer(function(){if(!that.cancelled){progress.show()}});var upload=new AJS.InlineAttach.AjaxUpload({file:file.file,params:AJS.$.extend({filename:file.name,size:file.size},data),scope:that,url:AJS.InlineAttach.AjaxPresenter.DEFAULT_URL,before:function(){!this.cancelled&&progress.start()},progress:function(val){!this.cancelled&&progress.update(val)},success:function(val,status){if(this.cancelled){return }if(status===201){if(val.id!==undefined&&val.name!==undefined){form.addTemporaryFileCheckbox(val.id,val.name,progress,file.file)}else{form.addError(AJS.InlineAttach.Text.tr("upload.error.bad.response",file.name),progress)}}else{if(val.token){form.setAtlToken(val.token)}if(val.errorMessage){form.addErrorWithFileName(val.errorMessage,file.name,progress)}else{form.addError(this._getErrorFromStatus(status,file),progress)}}},error:function(text,status){if(this.cancelled){return }if(status<0){form.addError(text,progress)}else{var statusError=this._getErrorFromStatus(status,file);if(statusError){form.addError(statusError,progress)}else{form.addError(AJS.InlineAttach.Text.tr("upload.error.unknown",file.name),progress)}}},after:function(){timer.cancel();progress.finish().remove();if(!this.cancelled&&!this._finishUpload(upload)){form.enable()}}});progress.onCancel(function(){upload.abort()});if(that._addUpload(upload)){running=true;timer.schedule(AJS.InlineAttach.DISPLAY_WAIT)}});if(running){this.form.disable()}},_getErrorFromStatus:function(status,file){var error;if(status===0){error=AJS.InlineAttach.Text.tr("upload.error.server.no.reply",file.name)}else{if(status===400){error=AJS.InlineAttach.Text.tr("upload.error.badrequest",file.name)}else{if(status===401){error=AJS.InlineAttach.Text.tr("upload.error.auth",file.name)}else{error=AJS.InlineAttach.Text.tr("upload.error.unknown.status",file.name,status)}}}return error},_cancel:function(){this._super();this.form.enable()}});AJS.$.extend(AJS.InlineAttach.AjaxPresenter,{DEFAULT_URL:contextPath+"/rest/internal/1.0/AttachTemporaryFile",MAX_SELECTED_FILES:100,isSupported:function($element){if(!$element||!$element[0]||!$element[0].files){return false}else{return AJS.InlineAttach.AjaxUpload.isSupported()}}});AJS.InlineAttach.FileInput=Class.extend({init:function($fileInput,testMultiple){this.$element=$fileInput;this.$container=$fileInput.parent();if(testMultiple&&this.$element[0].files!==undefined){this.$element.attr("multiple","multiple");this.multiple=true}else{this.multiple=false}},clear:function(){this.$element.val("");return this},getFiles:function(){return this.$element[0].files},hasFiles:function(){return this.getFiles().length>0},onChange:function(callback){var that=this;this.$element.change(function(){if(that.multiple){callback.call(that,this.files)}else{callback.call(that,that.getFileName())}});return this},focus:function(){if(this._isIE()){var $e=this.$element;setTimeout(function(){$e.focus()},0)}else{this.$element.focus()}return this},cloneInput:function(){var oldElement=this.$element;oldElement.replaceWith(this.$element=oldElement.clone(true));oldElement.unbind();return oldElement},getFileName:(function(){var fakepath=/^c:\\fakepath\\(?!$)/i;return function(){var fileName=this.$element.val();fileName=fileName.replace(fakepath,"");if(this._isIE()&&fileName.indexOf("\\")>=0){fileName=fileName.substring(fileName.lastIndexOf("\\")+1)}return fileName}})(),_isIE:function(){return AJS.$.browser.msie},before:function(el){if(el){if(el.$element){el=el.$element}this.$container.before(el)}}});AJS.InlineAttach.ProgressBar=(function(){var options={showPercentage:false,height:"2px"},count=0;return Class.extend({init:function(){var $container=this.$element=this._renderers.container();this.$progress=this._renderers.progress().appendTo($container);this.$progress.progressBar(0,options);this.hidden=true;this.old=0},value:function(value){if(value>100){value=100}else{if(value<0){value=0}}if(this.hidden){this.$progress.show();this.hidden=false}if(this.old!==value){this.$progress.progressBar(value,options);if(value>=100){this.$progress.fadeOut()}this.old=value}},_renderers:{container:function(){return AJS.$("<div>").addClass("file-progress")},progress:function(){return AJS.$("<div>").attr("id","upload-progress-"+(count++)).hide()}}})})();AJS.InlineAttach.UploadProgress=Class.extend({init:function(file){var $container=this.$element=AJS.InlineAttach.Renderers.container().hide();var progress=this.progress=new AJS.InlineAttach.ProgressBar();var content=this._renders.content(file.name);this.$content=content.$content;this.$cancel=content.$cancel;$container.append(content.$element).append(progress.$element);this.total=file.size;this.current=0;this.name=file.name;this.timer=new AJS.InlineAttach.Timer(this._update,this);this.rateNumerator=0;this.rateDenominator=0;this._title(AJS.InlineAttach.Text.tr("upload.progress.title.waiting"))},start:function(){this.started=this._now();this.startedSize=0;return this},update:function(current){this.timer.cancel();return this._update(current)},_update:function(current){var now=this._now();if(current===undefined){current=this.current}else{if(current!==this.current){this.lastUpdate=now;this.current=current}}var text=AJS.InlineAttach.Text;var percentage=Math.min(100,Math.round(current/this.total*100));var partSize=text.currentOutOfTotalSize(current,this.total);var rateDisplay,remainingDisplay;this.progress.value(percentage);var timeDiff=(now-this.started)/1000;if(timeDiff>=2){if(this.startedSize>0){this._addRate((current-this.startedSize)/timeDiff)}this.started=now;this.startedSize=current}var rate=this._calcRate();if(current>=AJS.InlineAttach.UploadProgress.DATA_MIN&&rate>0){var remaining=Math.max(1,(this.total-current)/rate);rateDisplay=text.rate(rate);remainingDisplay=text.time(remaining)}if(now-this.lastUpdate>=AJS.InlineAttach.UploadProgress.STALLED_TIMEOUT){this._content(text.tr("upload.file.stalled",this.name));if(rateDisplay){this._title(text.tr("upload.progress.title.known.stalled",rateDisplay,partSize))}else{this._title(text.tr("upload.progress.title.unknown.stalled",partSize))}}else{if(rateDisplay){this._title(text.tr("upload.progress.title.known",rateDisplay,partSize,remainingDisplay));this._content(text.tr("upload.file.remaining",this.name,remainingDisplay))}else{this._title(partSize);this._content(this.name)}}if(current<this.total){this.timer.schedule(AJS.InlineAttach.UploadProgress.UPLOAD_REFRESH)}return this},finish:function(){this.progress.value(100);this.timer.cancel();return this},onCancel:function(callback){var that=this;this.$cancel.click(function(e){e.preventDefault();callback.call(that)});return this},remove:function(){this.$element.remove();return this},hide:function(){this.$element.hide();return this},show:function(){this.$element.fadeIn();return this},_title:function(title){this.$element.attr("title",title);return this},_content:function(rem){this.$content.text(rem);return this},_addRate:function(rate){var weight=AJS.InlineAttach.UploadProgress.WEIGHT;this.rateNumerator=this.rateNumerator*weight+rate;this.rateDenominator=this.rateDenominator*weight+1},_calcRate:function(){if(this.rateDenominator==0){return 0}var value=this.rateNumerator/this.rateDenominator;if(Math.abs(value)<0.005){return 0}else{return value}},_now:function(){return new Date().getTime()},_renders:{content:function(fileName){var text=AJS.InlineAttach.Text.tr("upload.file.waiting",fileName);var $container=AJS.$("<div class='loading file'>");var $content=AJS.$("<span>").text(text);var $cancel=AJS.$("<a href='#'/>").text(AJS.InlineAttach.Text.tr("upload.cancel"));$container.append($content).append(" ").append($cancel);return{$element:$container,$content:$content,$cancel:$cancel}}}});AJS.$.extend(AJS.InlineAttach.UploadProgress,{STALLED_TIMEOUT:10000,UPLOAD_REFRESH:2000,DATA_MIN:20*1024,WEIGHT:0.7});AJS.InlineAttach.UnknownProgress=Class.extend({init:function(fileName){var content=this._renders.content(fileName);this.$element=content.$element;this.$cancel=content.$cancel;this.$content=content.$content;this.fileName=fileName;this._title(AJS.InlineAttach.Text.tr("upload.progress.title.waiting"))},remove:function(){this.$element.remove();return this},hide:function(){this.$element.hide();return this},show:function(){this.$element.fadeIn();return this},start:function(){this._title(AJS.InlineAttach.Text.tr("upload.progress.title.running"));this._content(this.fileName);return this},onCancel:function(callback){var that=this;this.$cancel.click(function(e){e.preventDefault();callback.call(that)});return this},_title:function(title){this.$element.attr("title",title);return this},_content:function(text){this.$content.text(text);return this},_renders:{content:function(fileName){var text=AJS.InlineAttach.Text.tr("upload.file.waiting",fileName);var $cancel=AJS.$("<a href='#'/>").text(AJS.InlineAttach.Text.tr("upload.cancel"));var $loading=AJS.$("<div class='loading file'>");var $content=AJS.$("<span>").text(text);$loading.append($content).append(" ").append($cancel);var $container=AJS.InlineAttach.Renderers.container().append($loading);return{$element:$container,$cancel:$cancel,$content:$content}}}});AJS.InlineAttach.Form=Class.extend({init:function(fileInput){this.fileSelector=fileInput;this.$form=fileInput.$element.closest("form");this.maxSize=parseInt(this.$form.find("#attach-max-size").text()||AJS.$("#attach-max-size").text());if(isNaN(this.maxSize)){throw"Unable to find maximum upload size on form."}var assigned=false;var val=parseInt(this.$form.find(":input[name=id]").val());if(!isNaN(val)){assigned=true;this.issueId=val}val=parseInt(this.$form.find(":input[name=pid]").val());if(!isNaN(val)){assigned=true;this.projectId=val}if(!assigned){throw"Unable to find either an issueId or projectId to submit the attachment to."}},getAtlToken:function(){var $atlToken=this.$form.find("input[name='atl_token']");if($atlToken.length>0){return $atlToken.val()}else{return atl_token()}},setAtlToken:function(token){var $token=this.$form.find("input[name='atl_token']");if($token.length>0){$token.val(token)}else{JIRA.XSRF.updateTokenOnPage(token)}return this},disable:function(){this._getFormSubmits().attr("disabled","disabled");return this},enable:function(){this._getFormSubmits().removeAttr("disabled");return this},addProgress:function(file){var prog=new AJS.InlineAttach.UploadProgress(file);this._addElement(prog.$element);return prog},addStaticProgress:function(fileName){var prog=new AJS.InlineAttach.UnknownProgress(fileName);this._addElement(prog.$element);return prog},addTemporaryFileCheckbox:function(value,name,replaceObj,file){var $thumbNail=this.addLocalThumbnailImage(name,file);var $element=AJS.InlineAttach.Renderers.container();var $label=AJS.$("<label>").attr("for","filetoconvert-"+value).text(name);var $check=AJS.$("<input type='checkbox' class='checkbox' name='filetoconvert' checked='checked'>").attr({"id":"filetoconvert-"+value,"value":value,"title":AJS.InlineAttach.Text.tr("upload.checkbox.title")});$element.append($check).append($label);if($thumbNail){$element.append(AJS.$("<br/>")).append($thumbNail)}$element.hide();this._replaceElement($element,replaceObj);return this},addLocalThumbnailImage:function(name,file){var $thumbNail=null;window.URL=window.webkitURL||window.URL;if(file&&window.URL&&window.URL.createObjectURL){var imageType=/image.*/;if(file.type.match(imageType)){var that=this;var title=name+" - "+AJS.InlineAttach.Text.fileSize(file.size)+" - "+file.type;var img=document.createElement("img");img.title=title;img.alt=title;img.onload=function(e){var aspectRatio=that.getAspectRatio(100,100,img.width,img.height);img.width=Math.round(img.width/aspectRatio);img.height=Math.round(img.height/aspectRatio);$thumbNail.show();window.URL.revokeObjectURL(img.src)};img.src=window.URL.createObjectURL(file);$thumbNail=jQuery(img).hide()}}return $thumbNail},getAspectRatio:function(maxWidth,maxHeight,origWidth,origHeight){if(origWidth>maxWidth){return Math.round(origWidth/maxWidth)}else{if(origHeight>maxHeight){return Math.round(origHeight/maxHeight)}else{return 1}}},addErrorWithFileName:function(error,fileName,replaceObj){if(error.indexOf(fileName)==-1){error=AJS.InlineAttach.Text.tr("upload.error.server",fileName,error)}return this.addError(error,replaceObj)},addError:function(error,replaceObj){var $element=AJS.InlineAttach.Renderers.container();$element.addClass("error").append(AJS.$("<div>").text(error)).hide();this._replaceElement($element,replaceObj);return $element},clearErrors:function(){this.$form.find("div.error").remove();return this},cloneFileInput:function(){return this.fileSelector.cloneInput()},onCancel:function(callback){var $cancel=this.$form.find("a.cancel");$cancel.click(AJS.$.proxy(callback,this));return this},_getFormSubmits:function(){return this.$form.find("input[type=submit]")},_addElement:function(el){this.fileSelector.before(el)},_replaceElement:function($element,replaceObj){if(replaceObj&&replaceObj.$element){replaceObj.$element.replaceWith($element)}else{this._addElement($element)}$element.fadeIn()}});AJS.InlineAttach.FormUpload=Class.extend({init:function(options){var scope=options.scope||null;var rescope=AJS.InlineAttach.rescope;this.$input=options.$input;this.url=options.url;this.params=options.params||{};this.successcb=rescope(options.success,scope);this.errorcb=rescope(options.error,scope);this.before=rescope(options.before,scope);this.after=rescope(options.after,scope);this.abortcb=rescope(options.abort,scope);this.aborted=false;this.$form=null;this.xhr=null},upload:function(){if(this.aborted){return }var url=this.url;var params=AJS.$.param(this.params);if(params){url=url+"?"+params}var $attachForm=this.$form=this._renders.form(url),that=this;this._addToBody($attachForm.append(this.$input));$attachForm.ajaxForm({dataType:"json",data:this.params,timeout:0,beforeSend:function(xhr){that.xhr=xhr},beforeSubmit:function(){that.before()},error:function(xhr){if(that.aborted){that.abortcb()}else{var text=(xhr&&xhr.responseText)||"";that.errorcb(text)}},success:function(data){that.successcb(data||{})},complete:function(){if(that.$form){that.$form.remove();that.$form=null}that.after()}});$attachForm.submit()},abort:function(){if(!this.aborted){this.aborted=true;if(this.xhr){this.xhr.abort();this.xhr=null}else{this.abortcb();this.after()}}},_addToBody:function($form){AJS.$("body").append($form)},_renders:{form:function(postUrl){return AJS.$("<form method='post' enctype='multipart/form-data'/>").attr("action",postUrl).hide()}}});AJS.InlineAttach.AjaxUpload=Class.extend({init:function(options){var scope=options.scope||null;var rescope=AJS.InlineAttach.rescope;this.file=options.file;this.url=options.url;this.params=options.params||{};this.beforecb=rescope(options.before,scope);this.progresscb=rescope(options.progress,scope);this.errorcb=rescope(options.error,scope);this.successcb=rescope(options.success,scope);this.abortcb=rescope(options.abort,scope);this.finalcb=rescope(options.after,scope);this.aborted=false},upload:function(){if(this.aborted||this.xhr){return }var xhr=this.xhr=AJS.InlineAttach.AjaxUpload.xhr();xhr.upload.onprogress=AJS.$.proxy(this._upload,this);xhr.onreadystatechange=AJS.$.proxy(this._statechange,this);var url=this.url;var params=AJS.$.param(this.params);if(params){url=url+"?"+params}this.beforecb();try{xhr.open("POST",url,true);xhr.setRequestHeader("Content-Type",this.file.type||"application/octet-stream");xhr.send(this.file)}catch(e){this._clienterror(e,this.file)}},abort:function(){if(!this.aborted){this.aborted=true;if(this.xhr){this.xhr.abort()}else{this.abortcb();this.finalcb()}}},_statechange:function(){if(this.xhr.readyState===4){if(this.aborted){this.abortcb()}else{try{this.successcb(JSON.parse(this.xhr.responseText),this.xhr.status,this.xhr)}catch(e){this.errorcb(this.xhr.responseText,this.xhr.status,this.xhr)}this.xhr.upload.onprogress=this.xhr.statechange=null}this.finalcb()}},_clienterror:function(e,file){this.errorcb(AJS.InlineAttach.AjaxUpload.getClientErrorMessage(e,file),-1,this.xhr);this.finalcb()},_upload:function(event){if(event.lengthComputable){this.progresscb(event.loaded)}}});AJS.$.extend(AJS.InlineAttach.AjaxUpload,{isSupported:function(){return AJS.InlineAttach.AjaxUpload._fileApiSupport(window)&&AJS.InlineAttach.AjaxUpload._xhrSupport()},xhr:function(){var fn=AJS.InlineAttach.AjaxUpload._xhrJquery();if(!fn){fn=AJS.InlineAttach.AjaxUpload._xhrDirect}AJS.InlineAttach.AjaxUpload.xhr=fn;return fn()},getClientErrorMessage:function(e,file){var safeName;try{safeName=file.name}catch(ignored){safeName="<unknown>"}if(e.name==="NS_ERROR_FILE_ACCESS_DENIED"){return AJS.InlineAttach.Text.tr("upload.error.no.access",safeName)}else{if(e.name==="NS_ERROR_FILE_NOT_FOUND"||e.name==="NS_ERROR_FILE_TARGET_DOES_NOT_EXIST"){return AJS.InlineAttach.Text.tr("upload.error.does.not.exist",safeName)}else{return AJS.InlineAttach.Text.tr("upload.error.client.unknown",safeName,e.message||e)}}},_xhrJquery:function(){var settings=AJS.$.ajaxSettings;return(settings&&settings.xhr)||null},_xhrDirect:function(){try{return new XMLHttpRequest()}catch(e){return null}},_xhrSupport:function(){try{var xhr=AJS.InlineAttach.AjaxUpload.xhr();if(xhr&&xhr.upload){return true}}catch(e){}return false},_fileApiSupport:function(window){return window.File&&window.FileList&&(!AJS.$.browser.mozilla||window.FileReader)}});AJS.InlineAttach.Timer=Class.extend({init:function(callback,scope){this.callback=AJS.InlineAttach.rescope(callback,scope||this);this._callback=AJS.$.proxy(this._callback,this);this.timeoutId=null},cancel:function(){if(this.timeoutId!==null){this._endTimeout(this.timeoutId);this.timeoutId=null}return this},schedule:function(timeout){this.cancel();this.timeoutId=this._startTimeout(this._callback,timeout);return this},_callback:function(){this.timeoutId=null;this.callback()},_startTimeout:function(fn,timeout){return window.setTimeout(fn,timeout)},_endTimeout:function(id){window.clearTimeout(id)}});AJS.InlineAttach.Text=(function(){var kB=1024;var MB=1024*kB;var GB=1024*MB;var bMax=Math.floor(kB*0.995);var kBMax=Math.floor(MB*0.995);var MBMax=Math.floor(GB*0.995);return{"upload.empty.file":"Cannot attach empty file {0}.","upload.too.big":"{0} is too large to attach. Attachment is {1} but the largest allowed attachment is {2}.","upload.error.bad.response":"Cannot attach file {0}: Unexpected server response.","upload.error.unknown.status":"Cannot attach file {0}: Unknown server error ({1}).","upload.error.auth":"Cannot attach file {0}: You do not have permission to attach a file to the issue.","upload.error.badrequest":"Cannot attach file {0}. Browser made bad request to the server.","upload.error.server":"Cannot attach file {0}: {1}","upload.cancel":"Cancel","upload.file.remaining":"{0} - {1} left.","upload.file.waiting":"{0} - waiting.","upload.file.stalled":"{0} - stalled.","upload.checkbox.title":"Clear check box to prevent file being attached","upload.xsrf.timeout":"Cannot attach file {0}: Your session has timed out or you were logged out. Please save your work and reload the page.","upload.error.unknown":"Cannot attach file {0}: Unknown server error.","upload.progress.title.waiting":"Waiting for other uploads to complete.","upload.progress.title.running":"Uploading.","upload.progress.title.unknown.stalled":"{0}, stalled.","upload.progress.title.known":"{0} - {1}, {2} left.","upload.progress.title.known.stalled":"{0} - {1}, stalled.","upload.kilobyte":"{0} kB","upload.kilobyte.part":"{0}\/{1} kB","upload.megabyte":"{0} MB","upload.megabyte.part":"{0}\/{1} MB","upload.gigabyte":"{0} GB","upload.gigabyte.part":"{0}\/{1} GB","upload.seconds":"{0} sec","upload.minutes":"{0} min","upload.hours":"{0} hr","upload.hours.minutes":"{0} hr {1} min","upload.bytes.per.second":"{0} B\/sec","upload.kilobytes.per.second":"{0} kB\/sec","upload.megabytes.per.second":"{0} MB\/sec","upload.error.no.access":"Browser does not have permission to access {0}.","upload.error.does.not.exist":"{0} does not exist.","upload.error.client.unknown":"An unknown error occured on the browser while trying to attach {0}: {1}.","upload.error.too.many.files":"You are trying to attach {0} files. Only {1} files can be attached at a time.","upload.error.server.no.reply":"Cannot attach file {0}: Unable to communicate with JIRA.",tr:function(key){if(arguments.length==0){return undefined}else{if(arguments.length==1){return this[key]||key}else{if(this[key]){var args=AJS.InlineAttach.copyArrayLike(arguments);args[0]=this[key];return AJS.format.apply(AJS,args)}else{return key}}}},fileSize:function(){if(arguments.length==0){return undefined}else{var key,b=AJS.InlineAttach.Text._classifySize(arguments[0]);if(b.unit===kB){key="upload.kilobyte"}else{if(b.unit===MB){key="upload.megabyte"}else{key="upload.gigabyte"}}if(arguments.length==1){return this.tr(key,b.convert(arguments[0]))}else{var result=new Array(arguments.length);for(var i=0;i<arguments.length;i++){result[i]=this.tr(key,b.convert(arguments[i]))}return result}}},currentOutOfTotalSize:function(current,total){var b=this._classifySize(total),key;if(b.unit===kB){key="upload.kilobyte.part"}else{if(b.unit===MB){key="upload.megabyte.part"}else{key="upload.gigabyte.part"}}return this.tr(key,b.convert(current),b.convert(total))},_classifySize:function(size){var base;if(size<=kBMax){base=kB}else{if(size<=MBMax){base=MB}else{base=GB}}return{unit:base,convert:function(s){return AJS.InlineAttach.Text._toDisplay(s/base)}}},time:function(seconds){if(seconds<60){return this.tr("upload.seconds",Math.floor(seconds))}else{var minutes=seconds/60;if(minutes<60){return this.tr("upload.minutes",Math.floor(minutes))}else{var hours=Math.floor(minutes/60);minutes=Math.floor(minutes%60);if(minutes>0){return this.tr("upload.hours.minutes",hours,minutes)}else{return this.tr("upload.hours",hours)}}}},rate:function(bytesPerSecond){if(bytesPerSecond<=bMax){return this.tr("upload.bytes.per.second",AJS.InlineAttach.Text._toDisplay(bytesPerSecond))}else{if(bytesPerSecond<=kBMax){return this.tr("upload.kilobytes.per.second",AJS.InlineAttach.Text._toDisplay(bytesPerSecond/kB))}else{return this.tr("upload.megabytes.per.second",AJS.InlineAttach.Text._toDisplay(bytesPerSecond/MB))}}},_toDisplay:function(number){if(number<0.005){return"0"}else{return(Math.round(number*100)/100).toFixed(2)}}}})();jQuery.fn.inlineAttach=function(){var res=[];this.each(function(){res.push(new AJS.InlineAttach(this))});return res};
/* module-key = 'jira.webresources:dialogs', location = '/includes/jira/dialog/LinkIssueDialog.js' */
JIRA.Dialogs.createLinkIssueDialog=function(){function markSelectedLinkType(activeId,linkTypes){var hasSelected=false;jQuery.each(linkTypes,function(i,linkType){if(linkType.id===activeId){linkType.isSelected=true;hasSelected=true;return false}});if(!hasSelected){linkTypes[0].isSelected=true}return linkTypes}function getRemoteIssueLinks(issueId){var deferred=jQuery.Deferred();JIRA.SmartAjax.makeRequest({url:contextPath+"/rest/viewIssue/1/remoteIssueLink/linkType?issueId="+issueId,complete:function(xhr,textStatus,smartAjaxResult){if(smartAjaxResult.successful){deferred.resolve(smartAjaxResult.data)}else{deferred.reject(JIRA.SmartAjax.buildDialogErrorContent(smartAjaxResult))}}});return deferred.promise()}function getTabContent(dialog){var deferred=jQuery.Deferred(),ajaxOptions=JIRA.Dialogs.getDefaultAjaxOptions.call(dialog);ajaxOptions.complete=function(xhr,textStatus,smartAjaxResult){if(smartAjaxResult.successful){deferred.resolve(smartAjaxResult.data)}else{deferred.reject(JIRA.SmartAjax.buildDialogErrorContent(smartAjaxResult))}};JIRA.SmartAjax.makeRequest(ajaxOptions);return deferred.promise()}function getActiveTabId(dialog){return dialog.$activeTrigger.attr("id")}return function(trigger){return new JIRA.FormDialog({id:"link-issue-dialog",isIssueDialog:true,trigger:trigger,onSuccessfulSubmit:function(data,smartAjaxResponse){if(smartAjaxResponse.getResponseHeader("X-Atlassian-Dialog-Msg-Type")!=="warning"){JIRA.Dialogs.storeCurrentIssueIdOnSucessfulSubmit.apply(this,arguments)}},issueMsg:"thanks_issue_linked",widthClass:"large",stacked:true,content:function(ready){var dialog=this,issueId=JIRA.Issue.getIssueId()||JIRA.IssueNavigator.getSelectedIssueId();getTabContent(dialog).done(function(tabContent){getRemoteIssueLinks(issueId).done(function(linkTypes){linkTypes=markSelectedLinkType(getActiveTabId(dialog),linkTypes);ready(JIRA.Templates.LinkIssue.dialog({linkTypes:linkTypes,tabContent:tabContent}));jQuery.each(linkTypes,function(i,linkType){var focusElementSelector;if(linkType.isSelected===true){focusElementSelector="[name='"+linkType.focusedFieldName+"']";if(jQuery(focusElementSelector).length===0){focusElementSelector="#"+linkType.id}dialog._focusFirstField(focusElementSelector)}})}).fail(function(errorContent){ready(errorContent)})}).fail(function(errorContent){ready(errorContent)})},formatSubmitResponseContent:function(content){this.get$popupContent().find(".dialog-pane").html(content);return this.get$popupContent().html()},onContentRefresh:function(){this.bindAnchorsToDialog(this.get$popupContent().find(".dialog-menu-item "))}})}}();
/* module-key = 'jira.webresources:dialogs', location = '/includes/jira/dialog/linkissue.soy' */
// This file was automatically generated from linkissue.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.LinkIssue == 'undefined') { JIRA.Templates.LinkIssue = {}; }


JIRA.Templates.LinkIssue.dialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-group"><div class="aui-item dialog-menu-group"><ul class="dialog-menu">');
  var linkTypeList4 = opt_data.linkTypes;
  var linkTypeListLen4 = linkTypeList4.length;
  for (var linkTypeIndex4 = 0; linkTypeIndex4 < linkTypeListLen4; linkTypeIndex4++) {
    var linkTypeData4 = linkTypeList4[linkTypeIndex4];
    output.append('<li><button id="', soy.$$escapeHtml(linkTypeData4.id), '" data-url="', soy.$$escapeHtml(linkTypeData4.url), '" class="dialog-menu-item ', (linkTypeData4.isSelected) ? 'selected' : '', '">', soy.$$escapeHtml(linkTypeData4.label), '</button></li>');
  }
  output.append('</ul></div><div class="aui-item dialog-pane">', opt_data.tabContent, '</div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'jira.webresources:user-management', location = '/includes/jira/common/Users.js' */
JIRA.Users={};JIRA.Users.LoggedInUser={};JIRA.Users.LoggedInUser.userName=function(){return AJS.Meta.get("remote-user")};JIRA.Users.LoggedInUser.isAnonymous=function(){return AJS.Meta.get("remote-user")===""};
/* module-key = 'jira.webresources:data-sets', location = '/includes/ajs/contentretriever/ProgressiveDataSet.js' */
JIRA.ProgressiveDataSet=Backbone.Collection.extend({initialize:function(models,options){options||(options={});if(options.matcher){this.matcher=options.matcher}if(options.model){this.model=options.model}this._idAttribute=(new this.model()).idAttribute;this._maxResults=options.maxResults||5;this._queryData=options.queryData||{};this._queryParamKey=options.queryParamKey||"q";this._queryEndpoint=options.queryEndpoint||"";this.value=null;this.queryCache={};this.activeQueryCount=0;_.bindAll(this,"query","respond")},url:function(){return this._queryEndpoint},query:function(query){var remote,results;this.value=query;results=this.getFilteredResults(query);this.respond(query,results);if(!query||!this._queryEndpoint||this.hasQueryCache(query)||!this.shouldGetMoreResults(results)){return }remote=this.fetch(query);this.activeQueryCount++;this.trigger("activity",{activity:true});remote.always(_.bind(function(){this.activeQueryCount--;this.trigger("activity",{activity:!!this.activeQueryCount})},this));remote.done(_.bind(function(resp,succ,xhr){this.addQueryCache(query,resp,xhr)},this));remote.done(_.bind(function(){query=this.value;results=this.getFilteredResults(query);this.respond(query,results)},this))},getQueryData:function(query){var params=_.isFunction(this._queryData)?this._queryData(query):this._queryData;var data=_.extend({},params);data[this._queryParamKey]=query;return data},fetch:function(query){var data=this.getQueryData(query);var params={add:true,data:data};var remote=Backbone.Collection.prototype.fetch.call(this,params);return remote},respond:function(query,results){this.trigger("respond",{query:query,results:results});return results},matcher:function(item,query){},getFilteredResults:function(query){var results=[];if(!query){return results}results=this.filter(function(item){return(true==this.matcher(item,query))},this);if(this._maxResults){results=_.first(results,this._maxResults)}return results},addQueryCache:function(query,response,xhr){var cache=this.queryCache;var results=this.parse(response,xhr);cache[query]=_.pluck(results,this._idAttribute)},hasQueryCache:function(query){return this.queryCache.hasOwnProperty(query)},findQueryCache:function(query){return this.queryCache[query]},shouldGetMoreResults:function(results){return results.length<this._maxResults},setMaxResults:function(number){this._maxResults=number;this.value&&this.respond(this.value,this.getFilteredResults(this.value))}});
/* module-key = 'jira.webresources:mentions', location = '/includes/jira/mention/UncomplicatedInlineLayer.js' */
AJS.UncomplicatedInlineLayer=AJS.InlineLayer.extend({init:function(options){options||(options={});options.contentRetriever=new AJS.ContentRetriever();AJS.InlineLayer.prototype.init.call(this,options)},content:function(){if(arguments.length){this.$content=arguments[0]}return this.$content},refreshContent:function(callback){this.layer().empty().append(this.content());if(AJS.$.isFunction(callback)){callback.call(this)}this.contentChange();this.setPosition()}});
/* module-key = 'jira.webresources:mentions', location = '/includes/jira/mention/Mention.Group.js' */
AJS.MentionGroup=AJS.Group.extend({_makeSelection:function(e){if(this.items&&this.items[this.index]){this.items[this.index].trigger("accept");e.preventDefault()}},keys:{"Up":function(e){this.shiftFocus(-1);e.preventDefault()},"Down":function(e){this.shiftFocus(1);e.preventDefault()},"Return":function(e){this._makeSelection(e)},"Tab":function(e){this._makeSelection(e)}}});
/* module-key = 'jira.webresources:mentions', location = '/includes/jira/mention/Mention.js' */
JIRA.MentionUserModel=Backbone.Model.extend({idAttribute:"name"});JIRA.Mention=AJS.Control.extend({CLASS_SIGNATURE:"AJS_MENTION",lastInvalidUsername:"",lastRequestMatch:true,lastValidUsername:"",init:function(){var instance=this;this.listController=new AJS.MentionGroup();this.dataSource=new JIRA.ProgressiveDataSet([],{model:JIRA.MentionUserModel,queryEndpoint:contextPath+"/rest/api/2/user/viewissue/search",queryParamKey:"username",queryData:_.bind(this._getQueryParams,this)});this.dataSource.matcher=function(model,query){var matches=false;matches=matches||instance._stringPartStartsWith(model.get("name"),query);matches=matches||instance._stringPartStartsWith(model.get("displayName"),query);return matches};this.dataSource.bind("respond",function(response){var results=response.results;var username=response.query;if(!username){return }if(!results.length){if(username){if(instance.dataSource.hasQueryCache(username)){if(!instance.lastInvalidUsername||username.length<=instance.lastInvalidUsername.length){instance.lastInvalidUsername=username}}}instance.lastRequestMatch=false}else{instance.lastInvalidUsername="";instance.lastValidUsername=username;instance.lastRequestMatch=true}var $suggestions=instance.generateSuggestions(results,username);instance.updateSuggestions($suggestions)});this.dataSource.bind("activity",function(response){if(response.activity){instance.layerController._showLoading()}else{instance.layerController._hideLoading()}})},updateSuggestions:function($suggestions){if(this.layerController){this.layerController.content($suggestions);this.layerController.show();this.layerController.refreshContent()}},_getQueryParams:function(){return this.restParams},_setQueryParams:function(){var params={issueKey:this.$textarea.attr("data-issuekey"),projectKey:this.$textarea.attr("data-projectkey"),maxResults:10};if(JIRA.Dialog.current&&JIRA.Dialog.current.options.id==="create-issue-dialog"){delete params.issueKey}this.restParams=params},_composeCustomEventForFollowScroll:function(customEvents){customEvents=customEvents||{};var followScroll=this.$textarea.attr("follow-scroll");if(followScroll&&followScroll.length){customEvents[followScroll]={"scroll":function(){this.setPosition()}}}return customEvents},textarea:function(textarea){var instance=this;if(textarea){this.$textarea=AJS.$(textarea);AJS.$("#mentionDropDown").remove();if(this.$textarea.attr("push-scroll")){var positioningController=new AJS.InlineLayer.StandardPositioning();var scrollPusher=JIRA.Mention.ScrollPusher(this.$textarea,10)}this.layerController=new AJS.UncomplicatedInlineLayer({offsetTarget:this.textarea(),allowDownsize:true,positioningController:positioningController,customEvents:this._composeCustomEventForFollowScroll(),width:function(){return instance.$textarea.width()}});this.layerController.bind("showLayer",function(){instance.listController.trigger("focus");instance._assignEvents("win",window)}).bind("hideLayer",function(){instance.listController.trigger("blur");instance._unassignEvents("win",window);if(scrollPusher){scrollPusher.reset()}}).bind("contentChanged",function(){if(!instance.layerController.$content){return }instance.listController.removeAllItems();instance.layerController.$content.find("li").each(function(){var li=AJS.$(this);li.click(function(event){instance._acceptSuggestion(li);event.preventDefault()});instance.listController.addItem(new AJS.Dropdown.ListItem({element:li,autoScroll:true}))});instance.listController.prepareForInput();instance.listController.shiftFocus(0)}).bind("setLayerPosition",function(event,positioning,inlineLayer){if(JIRA.Dialog.current&&JIRA.Dialog.current.$form){var buttonRow=JIRA.Dialog.current.$popup.find(".buttons-container:visible");if(buttonRow.length&&positioning.top>buttonRow.offset().top){positioning.top=buttonRow.offset().top}}if(scrollPusher){scrollPusher.push(positioning.top+inlineLayer.layer().outerHeight(true))}});this.layerController.layer().attr("id","mentionDropDown");this._assignEvents("inlineLayer",instance.layerController.layer());this._assignEvents("textarea",instance.$textarea);this._setQueryParams()}else{return this.$textarea}},generateSuggestions:function(data,username){var regex=new RegExp("(^|.*?(\\s+|\\())("+RegExp.escape(username)+")(.*)","i");function highlight(text){var result={text:text};if(text&&text.length&&text.toLowerCase().indexOf(username.toLowerCase())>-1){text.replace(regex,function(_,prefix,spaceOrParenthesis,match,suffix){result={prefix:prefix,match:match,suffix:suffix}})}return result}var filteredData=_.map(data,function(model){var user=model.toJSON();user.username=user.name;user.emailAddress=highlight(user.emailAddress);user.displayName=highlight(user.displayName);user.name=highlight(user.name);return user});return AJS.$(JIRA.Templates.mentionsSuggestions({suggestions:filteredData,query:username,activity:(this.dataSource.activeQueryCount>0)}))},_acceptSuggestion:function(li){this._hide();this._replaceCurrentUserName(li.find("a").attr("rel"));this.listController.removeAllItems()},_replaceCurrentUserName:function(selectedUserName){var raw=this._rawInputValue(),caretPos=this._getCaretPosition(),beforeCaret=raw.substr(0,caretPos),wordStartIndex=JIRA.Mention.Matcher.getLastWordBoundaryIndex(beforeCaret,true);var before=raw.substr(0,wordStartIndex+1).replace(/\r\n/g,"\n");var username="[~"+selectedUserName+"]";var after=raw.substr(caretPos);this._rawInputValue([before,username,after].join(""));this._setCursorPosition(before.length+username.length)},_setCursorPosition:function(index){var input=this.$textarea.get(0);if(input.setSelectionRange){input.focus();input.setSelectionRange(index,index)}else{if(input.createTextRange){var range=input.createTextRange();range.collapse(true);range.moveEnd("character",index);range.moveStart("character",index);range.select()}}},_getCaretPosition:function(){var element=this.$textarea.get(0);var rawElementValue=this._rawInputValue();var caretPosition,range,offset,normalizedElementValue,elementRange;if(typeof element.selectionStart==="number"){return element.selectionStart}if(document.selection&&element.createTextRange){range=document.selection.createRange();if(range){elementRange=element.createTextRange();elementRange.moveToBookmark(range.getBookmark());if(elementRange.compareEndPoints("StartToEnd",element.createTextRange())>=0){return rawElementValue.length}else{normalizedElementValue=rawElementValue.replace(/\r\n/g,"\n");offset=elementRange.moveStart("character",-rawElementValue.length);caretPosition=normalizedElementValue.slice(0,-offset).split("\n").length-1;return caretPosition-offset}}else{return rawElementValue.length}}return 0},_rawInputValue:function(){var el=this.$textarea.get(0);if(typeof arguments[0]=="string"){el.value=arguments[0]}return el.value},fetchUserNames:function(username){this.dataSource.query(username)},_getCurrentUserName:function(){return this.currentUserName},_hide:function(){this.layerController.hide()},_show:function(){this.layerController.show()},_keyUp:function(){var caret=this._getCaretPosition();var username=this._getUserNameFromInput(caret);username=jQuery.trim(username||"");if(this._isNewRequestRequired(username)){this.fetchUserNames(username)}else{if(!this._keepSuggestWindowOpen(username)){this._hide()}}this.lastQuery=username;delete this.willCheck},_keepSuggestWindowOpen:function(username){if(!username){return false}if(this.layerController.isVisible()){return this.dataSource.activeQueryCount||this.lastRequestMatch}return false},_isNewRequestRequired:function(username){if(!username){return false}username=jQuery.trim(username);if(username===this.lastQuery){return false}else{if(this.lastInvalidUsername){if(username.indexOf(this.lastInvalidUsername)===0&&(this.lastInvalidUsername.length<username.length)){return false}}else{if(!this.lastRequestMatch&&username===this.lastValidUsername){return true}}}return true},_stringPartStartsWith:function(text,startsWith){text=jQuery.trim(text||"").toLowerCase();startsWith=(startsWith||"").toLowerCase();var nameParts=text.split(/\s+/);if(!text||!startsWith){return false}if(text.indexOf(startsWith)===0){return true}return _.any(nameParts,function(word){return word.indexOf(startsWith)===0})},_getUserNameFromInput:function(caret){if(typeof caret!="number"){caret=this._getCaretPosition()}return this.currentUserName=JIRA.Mention.Matcher.getUserNameFromCurrentWord(this._rawInputValue(),caret)},_events:{win:{resize:function(){this.layerController.setWidth(this.$textarea.width())}},textarea:{"keydown":function(e){if(e.keyCode===jQuery.ui.keyCode.ESCAPE){if(this.layerController.isVisible()){if(JIRA.Dialog.current){jQuery(AJS).one("Dialog.beforeHide",function(e){e.preventDefault()})}this.$textarea.one("keyup",function(keyUpEvent){if(keyUpEvent.keyCode===jQuery.ui.keyCode.ESCAPE){keyUpEvent.stopPropagation();JIRA.trigger("Mention.afterHide")}})}if(AJS.$.browser.msie){e.preventDefault()}}else{if(!this.willCheck){this.willCheck=_.defer(_.bind(this._keyUp,this))}}},"focus":function(){this._keyUp()},"mouseup":function(){this._keyUp()},"blur":function(){this.listController.removeAllItems();this.lastQuery=this.lastValidUsername=this.lastInvalidUsername=""}},inlineLayer:{mousedown:function(e){e.preventDefault()}}}});JIRA.Mention.Matcher={AT_USERNAME_START_REGEX:/^@(.*)/i,AT_USERNAME_REGEX:/[^\[]@(.*)/i,WIKI_MARKUP_REGEX:/\[[~@]+([^~@]*)/i,ACCEPTED_USER_REGEX:/\[~[^~\]]*\]/i,WORD_LIMIT:3,getUserNameFromCurrentWord:function(text,caretPosition){var before=text.substr(0,caretPosition);var lastWordStartIndex=this.getLastWordBoundaryIndex(before,false);var prevChar=before.charAt(lastWordStartIndex-1);var currentWord;var foundMatch=null;if(!prevChar||!/\w/i.test(prevChar)){currentWord=this._removeAcceptedUsernames(before.substr(lastWordStartIndex));if(/[\r\n]/.test(currentWord)){return null}jQuery.each([this.AT_USERNAME_START_REGEX,this.AT_USERNAME_REGEX,this.WIKI_MARKUP_REGEX],function(i,regex){var match=regex.exec(currentWord);if(match){foundMatch=match[1];return false}})}return(foundMatch!=null&&this.lengthWithinLimit(foundMatch,this.WORD_LIMIT))?foundMatch:null},lengthWithinLimit:function(input,length){var parts=jQuery.trim(input).split(/\s+/);return parts.length<=~~length},getLastWordBoundaryIndex:function(text,strip){var lastAt=text.lastIndexOf("@"),lastWiki=text.lastIndexOf("[~");if(strip){lastAt=lastAt-1;lastWiki=lastWiki-1}return(lastAt>lastWiki)?lastAt:lastWiki},_removeAcceptedUsernames:function(phrase){var match=this.ACCEPTED_USER_REGEX.exec(phrase);if(match){return phrase.split(match)[1]}else{return phrase}}};JIRA.Mention.ScrollPusher=function($el,defaultMargin){defaultMargin=defaultMargin||0;var $scroll=AJS.$($el.attr("push-scroll")),originalScrollHeight;function push(layerBottom,margin){if(typeof margin=="undefined"){margin=defaultMargin}var scrollBottom=$scroll.offset().top+$scroll.outerHeight();var overflow=layerBottom-scrollBottom;if(overflow+margin>0){if(!originalScrollHeight){originalScrollHeight=$scroll.height()}$scroll.height($scroll.height()+overflow+margin)}}function reset(){if(originalScrollHeight){$scroll.height(originalScrollHeight)}}return{push:push,reset:reset}};
/* module-key = 'jira.webresources:mentions', location = '/includes/jira/mention/Mention.soy' */
// This file was automatically generated from Mention.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }


JIRA.Templates.mentionsSuggestions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-list">');
  if (opt_data.suggestions.length > 0) {
    output.append('<ul>');
    var suggestionList7 = opt_data.suggestions;
    var suggestionListLen7 = suggestionList7.length;
    for (var suggestionIndex7 = 0; suggestionIndex7 < suggestionListLen7; suggestionIndex7++) {
      var suggestionData7 = suggestionList7[suggestionIndex7];
      output.append('<li class="aui-list-item"><a class="aui-list-item-link aui-iconised-link" style="background-image: url(', soy.$$escapeHtml(suggestionData7.avatarUrls['16x16']), '); overflow:hidden; text-overflow: ellipsis" rel="', soy.$$escapeHtml(suggestionData7.username), '" href="#">');
      JIRA.Templates.highlitEntry({displayName: suggestionData7.displayName, emailAddress: suggestionData7.emailAddress, name: suggestionData7.name}, output);
      output.append('</a></li>');
    }
    output.append('<ul>');
  } else {
    JIRA.Templates.noSuggestions({activity: opt_data.activity, query: soy.$$escapeHtml(opt_data.query)}, output);
  }
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.noSuggestions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.query.length == 0) ? '<div class="no-suggestions">' + soy.$$escapeHtml("Type to start searching.") + '</div>' : (opt_data.activity) ? '<div class="no-suggestions searching">' + AJS.format("Searching for {0}{1}{2}...",'<strong>',opt_data.query,'</strong>') + '</div>' : '<div class="no-suggestions">' + AJS.format("Found no matching users for {0}{1}{2}.",'<strong>',opt_data.query,'</strong>') + '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.highlitEntry = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.highlightMention({match: opt_data.displayName}, output);
  JIRA.Templates.highlightMention({prefix: ' - ', match: opt_data.emailAddress}, output);
  JIRA.Templates.highlightMention({prefix: ' (', match: opt_data.name, suffix: ')'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.highlightMention = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.match.text || opt_data.match.match) ? ((opt_data.prefix) ? soy.$$escapeHtml(opt_data.prefix) : '') + ((opt_data.match.match) ? soy.$$escapeHtml(opt_data.match.prefix) + '<em>' + soy.$$escapeHtml(opt_data.match.match) + '</em>' + soy.$$escapeHtml(opt_data.match.suffix) : soy.$$escapeHtml(opt_data.match.text)) + ((opt_data.suffix) ? soy.$$escapeHtml(opt_data.suffix) : '') : '');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'jira.webresources:mentions', location = '/includes/jira/mention/initMentions.js' */
AJS.$(function(){var mentionsCtr=JIRA.Mention;var mentionsController;function initMentions(){if(!mentionsController){mentionsController=new mentionsCtr()}mentionsController.textarea(this)}AJS.$(document).delegate(".mentionable","focus",initMentions);AJS.$(".mentionable").each(initMentions)});
/* module-key = 'com.atlassian.auiplugin:aui-experimental-tooltips', location = 'js/external/jquery/jquery.tipsy.js' */
(function(E){function D(H,G){return(typeof H=="function")?(H.call(G)):H}function F(G){while(G=G.parentNode){if(G==document){return true}}return false}var A=0;function B(){var G=A++;return"tipsyuid"+G}function C(H,G){this.$element=E(H);this.options=G;this.enabled=true;this.fixTitle()}C.prototype={show:function(){var P=this.getTitle();if(P&&this.enabled){var I=this.tip();I.find(".tipsy-inner")[this.options.html?"html":"text"](P);I[0].className="tipsy";I.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).prependTo(document.body);var L=this;function H(){L.hoverTooltip=true}function M(){if(L.hoverState=="in"){return }L.hoverTooltip=false;if(L.options.trigger!="manual"){var R=L.options.trigger=="hover"?"mouseleave.tipsy":"blur.tipsy";L.$element.trigger(R)}}if(this.options.hoverable){I.hover(H,M)}var N=E.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight});var G=I[0].offsetWidth,K=I[0].offsetHeight,Q=D(this.options.gravity,this.$element[0]);var O;switch(Q.charAt(0)){case"n":O={top:N.top+N.height+this.options.offset,left:N.left+N.width/2-G/2};break;case"s":O={top:N.top-K-this.options.offset,left:N.left+N.width/2-G/2};break;case"e":O={top:N.top+N.height/2-K/2,left:N.left-G-this.options.offset};break;case"w":O={top:N.top+N.height/2-K/2,left:N.left+N.width+this.options.offset};break}if(Q.length==2){if(Q.charAt(1)=="w"){O.left=N.left+N.width/2-15}else{O.left=N.left+N.width/2-G+15}}I.css(O).addClass("tipsy-"+Q);I.find(".tipsy-arrow")[0].className="tipsy-arrow tipsy-arrow-"+Q.charAt(0);if(this.options.className){I.addClass(D(this.options.className,this.$element[0]))}if(this.options.fade){I.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:this.options.opacity})}else{I.css({visibility:"visible",opacity:this.options.opacity})}if(this.options.aria){var J=B();I.attr("id",J);this.$element.attr("aria-describedby",J)}}},hide:function(){if(this.options.fade){this.tip().stop().fadeOut(function(){E(this).remove()})}else{this.tip().remove()}if(this.options.aria){this.$element.removeAttr("aria-describedby")}},fixTitle:function(){var G=this.$element;if(G.attr("title")||typeof (G.attr("original-title"))!="string"){G.attr("original-title",G.attr("title")||"").removeAttr("title")}},getTitle:function(){var I,G=this.$element,H=this.options;this.fixTitle();var I,H=this.options;if(typeof H.title=="string"){I=G.attr(H.title=="title"?"original-title":H.title)}else{if(typeof H.title=="function"){I=H.title.call(G[0])}}I=(""+I).replace(/(^\s*|\s*$)/,"");return I||H.fallback},tip:function(){if(!this.$tip){this.$tip=E('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-inner"></div>').attr("role","tooltip");this.$tip.data("tipsy-pointee",this.$element[0])}return this.$tip},validate:function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled}};E.fn.tipsy=function(J){if(J===true){return this.data("tipsy")}else{if(typeof J=="string"){var L=this.data("tipsy");if(L){L[J]()}return this}}J=E.extend({},E.fn.tipsy.defaults,J);if(J.hoverable){J.delayOut=J.delayOut||20}function I(N){var O=E.data(N,"tipsy");if(!O){O=new C(N,E.fn.tipsy.elementOptions(N,J));E.data(N,"tipsy",O)}return O}function M(){var N=I(this);N.hoverState="in";if(J.delayIn==0){N.show()}else{N.fixTitle();setTimeout(function(){if(N.hoverState=="in"){N.show()}},J.delayIn)}}function H(){var N=I(this);N.hoverState="out";if(J.delayOut==0){N.hide()}else{setTimeout(function(){if(N.hoverState=="out"&&!N.hoverTooltip){N.hide()}},J.delayOut)}}if(!J.live){this.each(function(){I(this)})}if(J.trigger!="manual"){var K=J.trigger=="hover"?"mouseenter.tipsy":"focus.tipsy",G=J.trigger=="hover"?"mouseleave.tipsy":"blur.tipsy";if(J.live){E(this.context).on(K,this.selector,M).on(G,this.selector,H)}else{this.bind(K,M).bind(G,H)}}return this};E.fn.tipsy.defaults={aria:false,className:null,delayIn:0,delayOut:0,fade:false,fallback:"",gravity:"n",html:false,live:false,hoverable:false,offset:0,opacity:0.8,title:"title",trigger:"hover"};E.fn.tipsy.revalidate=function(){E(".tipsy").each(function(){var G=E.data(this,"tipsy-pointee");if(!G||!F(G)){E(this).remove()}})};E.fn.tipsy.elementOptions=function(H,G){return E.metadata?E.extend({},G,E(H).metadata()):G};E.fn.tipsy.autoNS=function(){return E(this).offset().top>(E(document).scrollTop()+E(window).height()/2)?"s":"n"};E.fn.tipsy.autoWE=function(){return E(this).offset().left>(E(document).scrollLeft()+E(window).width()/2)?"e":"w"};E.fn.tipsy.autoBounds=function(H,G){return function(){var I={ns:G[0],ew:(G.length>1?G[1]:false)},L=E(document).scrollTop()+H,J=E(document).scrollLeft()+H,K=E(this);if(K.offset().top<L){I.ns="n"}if(K.offset().left<J){I.ew="w"}if(E(window).width()+E(document).scrollLeft()-K.offset().left<H){I.ew="e"}if(E(window).height()+E(document).scrollTop()-K.offset().top<H){I.ns="s"}return I.ns+(I.ew?I.ew:"")}}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:aui-experimental-tooltips', location = 'js/atlassian/aui-experimental-tooltip.js' */
(function(A){A.fn.tooltip=function(B){var E=A.extend({},A.fn.tooltip.defaults,B),C=this.tipsy(E);if(E.hideOnClick&&(E.trigger=="hover"||!E.trigger&&this.tipsy.defaults.trigger=="hover")){var D=function(){A(this).tipsy("hide")};if(E.live){A(this.context).on("click.tipsy",this.selector,D)}else{this.bind("click.tipsy",D)}}return C};A.fn.tooltip.defaults={opacity:1,offset:1,delayIn:500,hoverable:true,hideOnClick:true}}(AJS.$));
/* module-key = 'jira.webresources:jira-global', location = '/includes/ajs/dark-features.js' */
(function($){function readHtmlMetaTag(){try{var ajsMeta=JSON.parse(AJS.Meta.get("enabled-dark-features"));if(typeof ajsMeta==="object"){return ajsMeta}}catch(err){}return[]}var featuresArray=readHtmlMetaTag();var features={};$.each(featuresArray,function(){features[this]=true});AJS.DarkFeatures={isEnabled:function(key){return !!features[key]},enable:function(key){if(key&&!features[key]){features[key]=true}},disable:function(key){if(key&&features[key]){delete features[key]}}}})(AJS.$);
/* module-key = 'jira.webresources:jira-global', location = '/includes/jira/common/messages.soy' */
// This file was automatically generated from messages.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }


JIRA.Templates.warningMsg = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message warning ', (opt_data.closeable) ? 'closeable' : '', '"><span class="aui-icon icon-warning"></span>', opt_data.msg, (opt_data.closeable) ? '<span class="aui-icon icon-close"></span>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.successMsg = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message success ', (opt_data.closeable) ? 'closeable' : '', '"><span class="aui-icon icon-success"></span>', opt_data.msg, (opt_data.closeable) ? '<span class="aui-icon icon-close"></span>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.errorMsg = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message error ', (opt_data.closeable) ? 'closeable' : '', '"><span class="aui-icon icon-error"></span>', opt_data.msg, (opt_data.closeable) ? '<span class="aui-icon icon-close"></span>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.infoMsg = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message info ', (opt_data.closeable) ? 'closeable' : '', '"><span class="aui-icon icon-info"></span>', opt_data.msg, (opt_data.closeable) ? '<span class="aui-icon icon-close"></span>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'jira.webresources:jira-global', location = '/includes/jira/common/messages.js' */
jQuery.namespace("JIRA.Messages");JIRA.Messages.Types={WARNING:JIRA.Templates.warningMsg,ERROR:JIRA.Templates.errorMsg,SUCCESS:JIRA.Templates.successMsg};JIRA.Messages.DefaultTimeout=10;JIRA.Messages.buildMsg=function(msg,options){options=options||{};var html=options.type({msg:msg,closeable:options.closeable});var $container=jQuery("<div>").html(html);var timeout=options.timeout!=null?options.timeout:JIRA.Messages.DefaultTimeout;var timer;if(options.closeable){$container.find(".icon-close").click(function(e){e.preventDefault();if(timer!=null){window.clearTimeout(timer)}$container.remove()})}if(timeout>0){timer=window.setTimeout(function(){$container.fadeOut(function(){$container.remove()})},timeout*1000)}return $container};JIRA.Messages.showMsg=function(msg,options){options=options||{};var $container,top;jQuery(".global-msg").remove();if(!options.type){console.warn("JIRA.Messages.showMsg: Message not shown, invalid type.");return jQuery()}$container=JIRA.Messages.buildMsg(msg,options);top=20;$container.addClass("global-msg").appendTo("body").css({marginLeft:-$container.outerWidth()/2,top:top});if(options.id){$container.attr("id",options.id)}return $container};JIRA.Messages.showMessageAtTarget=function(msg,options){options=options||{};var $msg=JIRA.Messages.buildMsg(msg,options);return $msg.prependTo(options.target)};JIRA.Messages.showMsgOnReload=function(){var SESSION_MSG_KEY="jira.messages.reloadMessageMsg",SESSION_MSG_TYPE_KEY="jira.messages.reloadMessageType",SESSION_MSG_CLOSEABLE_KEY="jira.messages.reloadMessageCloseable",SESSION_MSG_TARGET_KEY="jira.messages.reloadMessageTarget";jQuery(function(){var msg=JIRA.SessionStorage.getItem(SESSION_MSG_KEY),type,closeable,target;if(msg){type=JIRA.SessionStorage.getItem(SESSION_MSG_TYPE_KEY);closeable=(JIRA.SessionStorage.getItem(SESSION_MSG_CLOSEABLE_KEY)==="true");target=JIRA.SessionStorage.getItem(SESSION_MSG_TARGET_KEY);JIRA.SessionStorage.removeItem(SESSION_MSG_KEY);JIRA.SessionStorage.removeItem(SESSION_MSG_TYPE_KEY);JIRA.SessionStorage.removeItem(SESSION_MSG_CLOSEABLE_KEY);JIRA.SessionStorage.removeItem(SESSION_MSG_TARGET_KEY);if(!target||jQuery(target).is(document.body)){JIRA.Messages.showMsg(msg,{type:JIRA.Messages.Types[type],closeable:closeable})}else{JIRA.Messages.showMessageAtTarget(msg,{type:JIRA.Messages.Types[type],closeable:closeable,target:jQuery(target)})}}});return function(msg,options){JIRA.SessionStorage.setItem(SESSION_MSG_KEY,msg);JIRA.SessionStorage.setItem(SESSION_MSG_TYPE_KEY,options.type);if(options.closeable){JIRA.SessionStorage.setItem(SESSION_MSG_CLOSEABLE_KEY,options.closeable)}if(options.target){JIRA.SessionStorage.setItem(SESSION_MSG_TARGET_KEY,options.target)}}}();JIRA.Messages.fadeInBackground=function(target,options){var $target=jQuery(target);options=options||{};$target.css("backgroundColor","#fff").animate({backgroundColor:options.backgroundColor||"#ffd"});window.setTimeout(function(){$target.animate({backgroundColor:"#fff"},"slow",function(){$target.css("backgroundColor","")})},3000)};jQuery.fn.fadeInBackground=function(options){JIRA.Messages.fadeInBackground(this,options);return this};JIRA.Messages.fadeInBackgroundOnReload=function(){var BACKGROUND_COLOR_KEY="jira.messages.fadeInBackground.color",TARGET_KEY="jira.messages.fadeInBackground.target";jQuery(function(){var backgroundColor=JIRA.SessionStorage.getItem(BACKGROUND_COLOR_KEY),target=JIRA.SessionStorage.getItem(TARGET_KEY);JIRA.SessionStorage.removeItem(BACKGROUND_COLOR_KEY);JIRA.SessionStorage.removeItem(TARGET_KEY);JIRA.Messages.fadeInBackground(target,{backgroundColor:backgroundColor})});return function(target,options){options=options||{};var targets=JIRA.SessionStorage.getItem(TARGET_KEY);if(targets){targets=targets.split(",");targets.push(target);targets=targets.join(",")}else{targets=target}JIRA.SessionStorage.setItem(TARGET_KEY,targets);JIRA.SessionStorage.setItem(BACKGROUND_COLOR_KEY,"#ffd")}}();jQuery.fn.showErrorMsg=function(msg,options){options=options||{};options.target=this;options.type=JIRA.Messages.Types.ERROR;return JIRA.Messages.showMessageAtTarget(msg,options)};jQuery.fn.showWarningMsg=function(msg,options){options=options||{};options.target=this;options.type=JIRA.Messages.Types.WARNING;return JIRA.Messages.showMessageAtTarget(msg,options)};jQuery.fn.showSuccessMsg=function(msg,options){options=options||{};options.target=this;options.type=JIRA.Messages.Types.SUCCESS;return JIRA.Messages.showMessageAtTarget(msg,options)};JIRA.Messages.showSuccessMsg=function(msg,options){options=options||{};options.type=JIRA.Messages.Types.SUCCESS;return JIRA.Messages.showMsg(msg,options)};JIRA.Messages.showWarningMsg=function(msg,options){options=options||{};options.type=JIRA.Messages.Types.WARNING;return JIRA.Messages.showMsg(msg,options)};JIRA.Messages.showErrorMsg=function(msg,options){options=options||{};options.type=JIRA.Messages.Types.ERROR;return JIRA.Messages.showMsg(msg,options)};JIRA.Messages.showReloadWarningMsg=function(msg,options){options=options||{};options.type="WARNING";return JIRA.Messages.showMsgOnReload(msg,options)};JIRA.Messages.showReloadSuccessMsg=function(msg,options){options=options||{};options.type="SUCCESS";return JIRA.Messages.showMsgOnReload(msg,options)};JIRA.Messages.showReloadErrorMsg=function(msg,options){options=options||{};options.type="ERROR";return JIRA.Messages.showMsgOnReload(msg,options)};
/* module-key = 'jira.webresources:jira-global', location = '/includes/jquery/plugins/color/color.js' */
(function(jQuery){jQuery.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","color","outlineColor"],function(i,attr){jQuery.fx.step[attr]=function(fx){if(fx.state==0){fx.start=getColor(fx.elem,attr);fx.end=getRGB(fx.end)}if(!fx.start){return }fx.elem.style[attr]="rgb("+[Math.max(Math.min(parseInt((fx.pos*(fx.end[0]-fx.start[0]))+fx.start[0]),255),0),Math.max(Math.min(parseInt((fx.pos*(fx.end[1]-fx.start[1]))+fx.start[1]),255),0),Math.max(Math.min(parseInt((fx.pos*(fx.end[2]-fx.start[2]))+fx.start[2]),255),0)].join(",")+")"}});function getRGB(color){var result;if(color&&color.constructor==Array&&color.length==3){return color}if(result=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(color)){return[parseInt(result[1]),parseInt(result[2]),parseInt(result[3])]}if(result=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(color)){return[parseFloat(result[1])*2.55,parseFloat(result[2])*2.55,parseFloat(result[3])*2.55]}if(result=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(color)){return[parseInt(result[1],16),parseInt(result[2],16),parseInt(result[3],16)]}if(result=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(color)){return[parseInt(result[1]+result[1],16),parseInt(result[2]+result[2],16),parseInt(result[3]+result[3],16)]}return colors[jQuery.trim(color).toLowerCase()]}function getColor(elem,attr){var color;do{color=jQuery.curCSS(elem,attr);if(color!=""&&color!="transparent"||jQuery.nodeName(elem,"body")){break}attr="backgroundColor"}while(elem=elem.parentNode);return getRGB(color)}var colors={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery);
/* module-key = 'jira.webresources:jira-global', location = '/includes/jquery/plugins/expandoninput/expandOnInput.js' */
(function($){var eventsToListenTo="input keyup";$.fn.expandOnInput=function(maxHeight){var $textareas=this.filter("textarea");$textareas.unbind(eventsToListenTo,setHeight).bind(eventsToListenTo,setHeight);if($.browser.mozilla||$.browser.msie){$textareas.unbind("paste",triggerKeyup).bind("paste",triggerKeyup)}$textareas.unbind("refreshInputHeight").bind("refreshInputHeight",function(){$(this).css("height","");setHeight.call(this)});$textareas.data("expandOnInput_maxHeight",maxHeight);$textareas.each(function(){var $this=$(this);$this.each(function(){var $this=$(this);$this.data("hasFixedParent",!!$this.hasFixedParent())});if($this.val()!==""){setHeight.call(this)}});return this};function triggerKeyup(){var $textarea=$(this),textarea=this;setTimeout(function(){$textarea.keyup();textarea.scrollTop=textarea.scrollHeight},0)}function setHeight(){var $textarea=$(this),borderBox=($textarea.css("boxSizing")||$textarea.css("-mozBoxSizing")||$textarea.css("-webkitBoxSizing")||$textarea.css("-msBoxSizing"))==="border-box";this.scrollHeight;var maxHeight=parseInt($textarea.css("maxHeight"),10)||$textarea.data("expandOnInput_maxHeight")||$(window).height()-160,newHeight;if(borderBox){var outerHeight=$textarea.outerHeight();newHeight=Math.max(outerHeight+this.scrollHeight-this.clientHeight,outerHeight)}else{var height=$textarea.height();newHeight=Math.max(this.scrollHeight-($textarea.innerHeight()-height),height)}if(newHeight<maxHeight){$textarea.css({"overflow":"hidden","height":newHeight+"px"})}else{var cursorPosition=this.selectionStart;$textarea.css({"overflow-y":"auto","height":maxHeight+"px"});$textarea.unbind(eventsToListenTo,setHeight);$textarea.unbind("paste",triggerKeyup);if(this.selectionStart!==cursorPosition){this.selectionStart=cursorPosition;this.selectionEnd=cursorPosition}newHeight=maxHeight}$textarea.trigger("expandedOnInput");if(!$textarea.data("hasFixedParent")){var $window=$(window),scrollTop=$window.scrollTop(),minScrollTop=$textarea.offset().top+newHeight-$window.height()+29;if(scrollTop<minScrollTop){$window.scrollTop(minScrollTop)}}$textarea.trigger("stalkerHeightUpdated")}})(AJS.$);
/* module-key = 'jira.webresources:jira-global', location = '/includes/jquery/plugins/isdirty/isDirty.js' */
(function($){var DIRTY_WARNING_EXEMPT="ajs-dirty-warning-exempt";var DIRTY_WARNING_SANCTIONED="ajs-dirty-warning-whitelist";var activeForm=null;var defaultDirtyMessage="You have entered new data on this page. If you navigate away from this page without first saving your data, the changes will be lost.";var dirtyMessage=defaultDirtyMessage;$.fn.isDirty=function(){var $fields=this.find("*").andSelf().filter(":input");for(var i=0;i<$fields.length;i++){if(isElementDirty($fields[i])){return true}}return false};$.fn.removeDirtyWarning=function(){$(this.form||this).closest("form").addClass(DIRTY_WARNING_EXEMPT);return this};$(AJS).bind("page-unload.location-change.from-dialog",function(){window.onbeforeunload=function(){}});$(AJS).bind("page-unload.refresh.from-dialog",function(){dirtyMessage="The data in the dialog box was successfully submitted, although this page requires a refresh to display the results.\n\nYou had entered new data on the page before you opened the dialog box. If you continue, your page data will be lost."});function getDirtyMessage(){var msg=dirtyMessage;dirtyMessage=defaultDirtyMessage;return"***\n\n"+msg+"\n\n***"}JIRA.DirtyForm={getInputsToCheck:function(){return $("input[type='text'], textarea[name], ."+DIRTY_WARNING_SANCTIONED)},getDirtyWarning:function(){var $inputs=JIRA.DirtyForm.getInputsToCheck();for(var i=0,ii=$inputs.size();i<ii;i++){if($inputs[i].form!==activeForm&&isElementDirty($inputs[i])){return getDirtyMessage()}}},ClassNames:{SANCTIONED:DIRTY_WARNING_SANCTIONED,EXEMPT:DIRTY_WARNING_EXEMPT}};if(!AJS.isSelenium()){window.onbeforeunload=JIRA.DirtyForm.getDirtyWarning}function isElementDirty(element){var $element=$(element),$form=$(element.form),type=element.type;if($form.hasClass(DIRTY_WARNING_EXEMPT)||$element.hasClass(DIRTY_WARNING_EXEMPT)){return false}if($element.is(":hidden")&&!$element.hasClass(DIRTY_WARNING_SANCTIONED)){return false}if(!$element.parent().length){return false}if((type==="hidden"||type==="submit"||type==="button")&&!$element.hasClass(DIRTY_WARNING_SANCTIONED)){return false}if(type==="select-one"||type==="select-multiple"){var options=element.options;for(var i=0;i<options.length;i++){var option=options[i];if(option.selected!==option.defaultSelected){return true}}return false}if(type==="checkbox"||type==="radio"){return element.checked!==element.defaultChecked}return element.value!==element.defaultValue}$(document).delegate("form","submit cancel",function(){activeForm=this});$(document).delegate(".cancel","click",cancelForm);$(function(){$("#cancelButton").bind("mousedown keydown click",cancelForm)});function cancelForm(){$(this.form||this).closest("form").trigger("cancel")}})(AJS.$);
/* module-key = 'jira.webresources:jira-global', location = '/includes/jquery/plugins/overlabel/overlabel.js' */
jQuery.fn.overlabel=function(targField){this.each(function(){var label=AJS.$(this),field=targField||AJS.$("#"+(label.data("target")||label.attr("for")));label.removeClass("overlabel").addClass("overlabel-apply").width(field.width()).click(function(e){if(!field.attr("disabled")){field.focus()}e.preventDefault()});field.focus(function(){label.addClass("hidden")}).blur(function(){if(AJS.$(this).val()===""){label.removeClass("hidden")}});if(field.val()&&field.val()!==""){label.addClass("hidden")}});return this};
/* module-key = 'jira.webresources:jira-global', location = '/includes/jira/toggleblock/ToggleBlock.js' */
(function(){JIRA.Events.REFRESH_TOGGLE_BLOCKS="refreshToggleBlocks";function expand(e){var instance=e.data.instance;if(AJS.$(this).hasClass(instance.options.collapsedClass)){instance.expand(this)}}function toggle(e){var instance=e.data.instance;if(!(instance.options.originalTargetIgnoreSelector&&jQuery(e.originalTarget).is(instance.options.originalTargetIgnoreSelector))){instance.toggle(e.target);e.preventDefault()}}function refreshToggleBlocks(e){e.data.instance._collapseTwiciBlocksFromStorage()}JIRA.ToggleBlock=Class.extend({getDefautOptions:function(){return{blockSelector:".twixi-block",triggerSelector:".twixi",eventType:"click",collapsedClass:"collapsed",expandedClass:"expanded",storageCollectionName:"twixi-blocks",autoFocusTrigger:true}},_collapseTwiciBlocksFromStorage:function(){var block,val=localStorage.getItem(this.options.storageCollectionName)||"";val=val.replace(/\./g,"\\.");if(/#\w+/.test(val)){block=AJS.$(val);if(block.is(this.options.blockSelector)){if(!this.isPermlink()){block.removeClass(this.options.expandedClass).addClass(this.options.collapsedClass)}}}return this},_updateTwixiBlockIdInStorage:function(blockId){if(!this.isPermlink()){if(!/#\w+/.test(blockId)){return this}var val=localStorage.getItem(this.options.storageCollectionName)||"",blockLength=(","+val+",").indexOf(","+blockId+",")+1;if(blockLength){if(val.indexOf(","+blockId)+1){val=val.replace(","+blockId,"")}else{val=val.replace(blockId,"")}}else{val=val.length?val+","+blockId:blockId}localStorage.setItem(this.options.storageCollectionName,val)}return this},contract:function(block){block=jQuery(block);if(block.is(this.options.blockSelector)){block.removeClass(this.options.expandedClass).addClass(this.options.collapsedClass);if(this.options.persist!==false){this._updateTwixiBlockIdInStorage("#"+block.attr("id"))}}AJS.$(block).trigger("contractBlock");return this},expand:function(block){block=jQuery(block);if(block.is(this.options.blockSelector)){block.removeClass(this.options.collapsedClass).addClass(this.options.expandedClass);if(this.options.persist!==false){this._updateTwixiBlockIdInStorage("#"+block.attr("id"))}}AJS.$(block).trigger("expandBlock");return this},toggle:function(twikiBlockChild){var block=AJS.$(twikiBlockChild).closest(this.options.blockSelector);if(!block.hasClass(this.options.collapsedClass)){this.contract(block)}else{this.expand(block)}if(this.options.autoFocusTrigger){block.find(this.options.triggerSelector+":visible").focus()}return this},isPermlink:function(){return this.checkIsPermlink(location.href)},checkIsPermlink:function(url){var query=parseUri(url).queryKey;return(query.hasOwnProperty("focusedCommentId")||query.hasOwnProperty("focusedWorklogId"))},addTrigger:function(triggerSelector,eventType){var thisInstance=this,lastMousedown=0;if(triggerSelector){eventType=eventType||"click";if(eventType==="dblclick"){if(document.selection){AJS.$(document).delegate(triggerSelector,"dblclick",function(){document.selection.empty()})}else{AJS.$(document).delegate(triggerSelector,"mousedown",function(){var now=new Date().getTime(),allowSelection=now-lastMousedown>750;lastMousedown=now;return allowSelection})}}AJS.$(document).delegate(triggerSelector,eventType,function(){thisInstance.toggle(this)})}return this},addCallback:function(methodName,callback){jQuery.aop.after({target:this,method:methodName},callback);return this},isUnique:function(uid){var uids=AJS.$(document).data("toggleBlockUids")||[];return AJS.$.inArray(uid,uids)===-1},setUid:function(uid){var uids=AJS.$(document).data("toggleBlockUids")||[];uids.push(uid);AJS.$(document).data("toggleBlockUids",uids)},init:function(options){var instance=this;options=options||{};this.options=jQuery.extend(this.getDefautOptions(),options);var uid=this.options.triggerSelector;if(!this.isUnique(uid)){if(typeof console!=="undefined"&&console.warn){console.warn("Your are trying to create a ToggleBlock with selector '"+this.options.triggerSelector+"'."+"One already exists with this trigger so has been ignored.")}return }this.setUid(uid);AJS.$(document).delegate(this.options.blockSelector,"reveal",{instance:this},expand);AJS.$(document).delegate(this.options.triggerSelector,this.options.eventType,{instance:this},toggle);JIRA.bind(JIRA.Events.REFRESH_TOGGLE_BLOCKS,{instance:this},refreshToggleBlocks);if(this.options.persist!==false){jQuery(function(){instance._collapseTwiciBlocksFromStorage()})}}})})();
/* module-key = 'jira.webresources:jira-global', location = '/includes/jira/togglelist/ToggleList.js' */
(function(){JIRA.ToggleList=Class.extend({init:function(options){var more=options.more,showMoreContainer=options.showMoreContainer||options.showMoreLink,showLessContainer=options.showLessContainer||options.showLessLink,showMoreLink=options.showMoreLink,showLessLink=options.showLessLink;if(!more||!more.length){showMoreContainer.hide();showLessContainer.hide();return }more.hide();showMoreContainer.show();showLessContainer.hide();var toggle=function(e){e.preventDefault();more.toggle();showMoreContainer.toggle();showLessContainer.toggle()};showMoreLink.click(toggle);showLessLink.click(toggle)}})})();
/* module-key = 'jira.webresources:jira-global', location = '/includes/jira/wikipreview/wikiPreview.js' */
JIRA.wikiPreview=function(prefs,ctx){var field,editField,trigger,inPreviewMode=false,origText,setFields=function(){field=AJS.$("#"+prefs.fieldId,ctx),editField=AJS.$("#"+prefs.fieldId+"-wiki-edit",ctx),trigger=AJS.$("#"+prefs.trigger,ctx)},scrollSaver=function(){var elem;return{show:function(){if(!elem){elem=AJS.$("<div>").html("&nbsp;").css({height:"300px"}).insertBefore(editField)}elem.css({display:"block"})},hide:function(){elem.css({display:"none"})}}}(),toggleRenderPreview=function(){if(!inPreviewMode){editField.find(".content-inner").css({maxHeight:field.css("maxHeight")});this.showPreview()}else{editField.find(".content-inner").css({maxHeight:""});this.showInput()}},renderData=function(data){editField.originalHeight=editField.height();scrollSaver.show();editField.addClass("previewClass");origText=field.val();field.hide();trigger.removeClass("loading").addClass("selected");editField.find(".content-inner").html(data);scrollSaver.hide();inPreviewMode=true;AJS.$(document).trigger("showWikiPreview",[editField]);setTimeout(function(){trigger.focus()},0)},handleError=function(previewer){return function(XMLHttpRequest,textStatus,errorThrown){trigger.removeClass("loading");origText=field.val();if(textStatus){alert(textStatus)}if(errorThrown){alert(errorThrown)}previewer.showInput()}};return{showPreview:function(){var that=this;var pid=AJS.$("#pid",ctx).val(),issueType=AJS.$("#issuetype",ctx).val();if(AJS.$.isArray(pid)){pid=pid[0]}if(AJS.$.isArray(issueType)){issueType=issueType[0]}AJS.$("#"+prefs.trigger,ctx).addClass("loading");AJS.$.ajax({url:contextPath+"/rest/api/1.0/render",contentType:"application/json",type:"POST",data:JSON.stringify({rendererType:prefs.rendererType,unrenderedMarkup:field.val(),issueKey:prefs.issueKey,projectId:pid,issueType:issueType}),dataType:"html",success:renderData,error:handleError(that)})},showInput:function(e){if(editField){scrollSaver.show();editField.css({height:""});editField.removeClass("previewClass").find(".content-inner").empty();field=AJS.$("#"+prefs.fieldId,ctx);field.val(origText);field.show();field.focus();trigger.removeClass("selected");scrollSaver.hide();inPreviewMode=false;AJS.$(document).trigger("showWikiInput",[editField])}},init:function(){var that=this,$trigger;prefs=AJS.$.readData(prefs);$trigger=AJS.$("#"+prefs.trigger,ctx);$trigger.click(function(e){if(!$trigger.hasClass("loading")){setFields();toggleRenderPreview.call(that)}e.preventDefault()})}}};AJS.namespace("jira.app.wikiPreview",null,JIRA.wikiPreview);
/* module-key = 'jira.webresources:jira-global', location = '/includes/jira/issue/Issue.js' */
AJS.namespace("JIRA.Issue");(function(){var $keyVal;function getKeyVal(){if(!$keyVal){$keyVal=jQuery("#key-val")}return $keyVal}JIRA.Issue.getStalker=function(){return jQuery("#stalker")};JIRA.Issue.getSubtaskContent=function(){return JIRA.Issue.getSubtaskModule().find(".mod-content")};JIRA.Issue.getSubtaskModule=function(){return jQuery("#view-subtasks")};JIRA.Issue.reload=function(){window.location.reload()};JIRA.Issue.refreshSubtasks=function(){var deferred=jQuery.Deferred(),$subtasks=JIRA.Issue.getSubtaskContent();if($subtasks.length===0){AJS.reloadViaWindowLocation(window.location.href+"#view-subtasks");return deferred.promise()}else{return jQuery.ajax({url:contextPath+"/secure/ViewSubtasks.jspa?id="+JIRA.Issue.getIssueId(),success:function(html){$subtasks.replaceWith(html);JIRA.trigger("Issue.subtasksRefreshed",[JIRA.Issue.getSubtaskContent()])}})}};JIRA.Issue.highlightSubtasks=function(issues){jQuery.each(issues,function(i,issue){jQuery(".issuerow[data-issuekey='"+issue.issueKey+"']").fadeInBackground()})};JIRA.Issue.getIssueId=function(){var $keyVal=getKeyVal();if($keyVal.length!==0){return $keyVal.attr("rel")}return undefined};JIRA.Issue.getIssueKey=function(){var $keyVal=getKeyVal();if($keyVal.length!==0){return $keyVal.text()}return undefined};JIRA.Issue.issueCreatedMessage=function(issue,isSubtask){var issueText=isSubtask?"Subtask":"Issue";var link='<a class="issue-created-key issue-link" data-issue-key="'+issue.issueKey+'" href="'+AJS.contextPath()+"/browse/"+issue.issueKey+'">'+issue.issueKey+" - "+AJS.escapeHTML(issue.summary)+"</a>";return AJS.format("{0} {1} has been successfully created.",issueText,link)}})(AJS.$);AJS.namespace("jira.app.issue",null,JIRA.Issue);
/* module-key = 'jira.webresources:jira-global', location = '/includes/jira/issuenavigator/IssueNavigator.js' */
JIRA.IssueNavigator={isNavigator:function(){return jQuery("#isNavigator").length===1},setIssueUpdatedMsg:function(options){options=options||{};var sessionStorge=JIRA.SessionStorage,issueMsg=options.issueMsg,issueId=options.issueId,issueKey=options.issueKey;if(!issueId){issueId=JIRA.IssueNavigator.getSelectedIssueId();issueKey=JIRA.IssueNavigator.getSelectedIssueKey()}if(issueId){sessionStorge.setItem("selectedIssueId",issueId)}if(issueKey){sessionStorge.setItem("selectedIssueKey",issueKey)}if(issueMsg){sessionStorge.setItem("selectedIssueMsg",issueMsg)}},reload:function(){AJS.reloadViaWindowLocation()},isRowSelected:function(){return JIRA.IssueNavigator.get$focusedRow().length!==0},get$focusedRow:function(){return jQuery("#issuetable tr.issuerow.focused")},getFocsuedIssueIndex:function(){var rowIndex=jQuery("#issuetable").find("tr.issuerow").index(JIRA.IssueNavigator.get$focusedRow());var searchOffset=parseInt(jQuery(".results-count-start").first().text(),10)-1;return rowIndex+searchOffset},getSelectedIssueKey:function(){var $focusedRow=JIRA.IssueNavigator.get$focusedRow();if($focusedRow.length!==0){return $focusedRow.attr("data-issuekey")}return undefined},getSelectedIssueId:function(){return JIRA.IssueNavigator.get$focusedRow().attr("rel")},getNextIssueId:function(){return JIRA.IssueNavigator.get$focusedRow().next("tr.issuerow").attr("rel")}};AJS.namespace("jira.app.issuenavigator",null,JIRA.IssueNavigator);
/* module-key = 'jira.webresources:jira-global', location = '/includes/jira/issuenavigator/IssueNavigator.Shortcuts.js' */
(function($){JIRA.IssueNavigator.Shortcuts={};var $rows,index,$nextPage,$previousPage,helpText,isLoadingNewPage=false;var issueIdToRowIndex={};$(document).ready(function(){if(JIRA.IssueNavigator.isNavigator()){var $focusedRow;var focusedClassName=/(?:^|\s)focused(?!\S)/;var preventFocus=function(){$(this).attr("tabIndex",-1)};$rows=$("#issuetable").find("tr.issuerow");$rows.each(function(i){var $row=$(this);$("a.hidden-link",this).blur(preventFocus);if(!$focusedRow&&focusedClassName.test(this.className)){$focusedRow=$row;index=i}issueIdToRowIndex[$row.attr("rel")]=i});if(!$focusedRow){$focusedRow=$rows.first().addClass("focused")}var jqlHasFocus=jQuery("#jqltext").hasClass("focused");if(!jqlHasFocus){var triggerConfig=new JIRA.setFocus.FocusConfiguration();triggerConfig.focusNow=function(){focusRow(index)};JIRA.setFocus.pushConfiguration(triggerConfig)}$(document).keypress(function(e){if(e.keyCode=="13"&&$("div.aui-blanket").length==0){var target=e.target;if(target===undefined||target.nodeName==="HTML"||target.nodeName==="BODY"||target==document){if(hasResults()&&$rows[index]){window.location=contextPath+"/browse/"+$rows.eq(index).data("issuekey")}}}});var $pager=$("div.pagination").first(),shouldFocusSearch=$("#focusSearch").attr("content")==="true";$nextPage=$pager.find("a.icon-next");$previousPage=$pager.find("a.icon-previous");if(!shouldFocusSearch){var activeElement=AJS.$(document.activeElement);if(activeElement.is(":input")){activeElement.blur()}}if(hasResults()&&!$(document.activeElement).is(":input")){setTimeout(function(){$rows.eq(index).scrollIntoView()},0)}if(hasResults()){JIRA.IssueNavigator.Shortcuts.flashIssueRow()}$(".issue-actions-trigger").click(function(){var $row=$(this).closest("tr");var issueId=$row.attr("rel");if(issueId){JIRA.IssueNavigator.Shortcuts.focusRow(issueId,0,true)}});JIRA.bind("QuickCreateSubtask.sessionComplete",function(e,issues){var lastIssue=issues[issues.length-1],msg=JIRA.Issue.issueCreatedMessage(lastIssue,true);JIRA.IssueNavigator.setIssueUpdatedMsg({issueMsg:msg});JIRA.IssueNavigator.reload()});JIRA.bind("QuickEdit.sessionComplete",function(e,issues){JIRA.IssueNavigator.setIssueUpdatedMsg();JIRA.IssueNavigator.reload()});$(document).bind("dialogContentReady",function(){if(setSelectedIssueAjax.callback){setSelectedIssueAjax.callback()}})}});var inDuration=1200;var flashLifeSpan=10000;var flashTimerId=null;var $flashedIssueRow=null;function clearFlashTimeout(){if(flashTimerId){window.clearTimeout(flashTimerId)}}function removeIssueRowFlash(outDuration){clearFlashTimeout();if($flashedIssueRow){$flashedIssueRow.addClass("issueactioneddissapearing").removeClass("issueactioned");$("td:first-child",$flashedIssueRow).removeClass("issueactioned");$flashedIssueRow.animate({backgroundColor:"#fff"},outDuration,function(){$(this).removeAttr("style");$(this).removeClass("issueactioneddissapearing")})}$flashedIssueRow=null}function flashIssueRowWithId(issueId,selectedIssueMsg,selectedIssueKey){if($flashedIssueRow){removeIssueRowFlash("fast")}$flashedIssueRow=$("#issuerow"+issueId);$flashedIssueRow.animate({backgroundColor:"#ffd"},inDuration,function(){$(this).css({backgroundColor:null});$(this).addClass("issueactioned")});clearFlashTimeout();flashTimerId=window.setTimeout(function(){removeIssueRowFlash("slow");$("#affectedIssueMsg").fadeOut(inDuration)},flashLifeSpan);if(!selectedIssueKey){selectedIssueKey=$flashedIssueRow.data("issuekey")}if(!selectedIssueMsg){selectedIssueMsg="thanks_issue_updated"}var allMsgTexts={"thanks_issue_updated":"{0} has been updated.","thanks_issue_transitioned":"{0} has been updated.","thanks_issue_assigned":"{0} has been assigned.","thanks_issue_commented":"{0} has been updated with your comment.","thanks_issue_worklogged":"Work has been logged on {0}.","thanks_issue_voted":"Your vote on {0} has been updated.","thanks_issue_watched":"Your watcher status on {0} has been updated.","thanks_issue_moved":"{0} has been moved.","thanks_issue_linked":"The links on {0} have been updated.","thanks_issue_cloned":"{0} has been cloned.","thanks_issue_labelled":"The labels on {0} have been updated.","thanks_issue_deleted":"{0} has been deleted.","thanks_issue_attached":"The file(s) have been attached to {0}."};var msgText=allMsgTexts[selectedIssueMsg]||selectedIssueMsg;if(msgText&&selectedIssueKey){msgText=AJS.format(msgText,selectedIssueKey);JIRA.Messages.showSuccessMsg(msgText,{id:"affectedIssueMsg"})}}JIRA.IssueNavigator.Shortcuts.flashIssueRow=function(issueId){var sessionstorage=JIRA.SessionStorage;var selectedIssueMsg=null;var selectedIssueKey=null;if(!issueId){if(!issueId){issueId=sessionstorage.getItem("selectedIssueId")}if(!issueId){var result=/[?&]selectedIssueId=([0-9]+)/.exec(window.location);issueId=result&&result.length==2?result[1]:null}}if(issueId){selectedIssueKey=sessionstorage.getItem("selectedIssueKey");selectedIssueMsg=sessionstorage.getItem("selectedIssueMsg");flashIssueRowWithId(issueId,selectedIssueMsg,selectedIssueKey)}sessionstorage.removeItem("selectedIssueId");sessionstorage.removeItem("selectedIssueKey");sessionstorage.removeItem("selectedIssueMsg")};JIRA.IssueNavigator.Shortcuts.selectNextIssue=function(){if(hasResults()&&!isLoadingNewPage){if(index===$rows.length-1){followLink($nextPage)}else{unselectRow(index++);selectRow(index)}}};JIRA.IssueNavigator.Shortcuts.selectPreviousIssue=function(){if(hasResults()&&!isLoadingNewPage){if(index===0){followLink($previousPage)}else{unselectRow(index--);selectRow(index)}}};JIRA.IssueNavigator.Shortcuts.viewSelectedIssue=function(){if(hasResults()&&$($rows[index]).length){try{window.location=contextPath+"/browse/"+$($rows[index]).data("issuekey")}catch(err){}}};JIRA.IssueNavigator.Shortcuts.focusRow=function(issueId,delay,supressLinkFocus){if(hasResults()){if(issueId){selectRowViaIssueId(issueId,delay,supressLinkFocus)}else{if(!supressLinkFocus){$($rows[index]).find("a:first").focus()}}}};JIRA.IssueNavigator.Shortcuts.focusSearch=function(){var $jqlTextArea=$("#jqltext");$("#jira").scrollIntoView();if($jqlTextArea.length>0){$jqlTextArea.focus()}else{var $issuenav=$("#issuenav");if($issuenav.hasClass("lhc-collapsed")){$(".toggle-lhc").click()}var $textSection=$("#navigator-filter-subheading-textsearch-group");if($textSection.hasClass("collapsed")){$("#searcher-pid").focus()}else{$("#searcher-query").focus()}}};function updateActionTemplateWithIssueId(){if(/id=\{0\}/.test(this.href)){var issueId=JIRA.IssueNavigator.getSelectedIssueId();var url=this.href;url=url.replace(/(id=\{0\})/g,"id="+issueId);url+="?selectedIssueId="+issueId;this.href=url}}function hasResults(){return $rows&&$rows.length>0}function followLink($a){var href=$a.attr("href");if(href){isLoadingNewPage=true;AJS.nextPage("blurSearch",true);window.location=href;setTimeout(function(){isLoadingNewPage=false},5000)}}function unselectRow(i){var $td=$($rows[i]).find("td:first");$($rows[i]).removeClass("focused");helpText=$td.attr("title");$td.removeAttr("title")}function selectRow(i,delay,supressLinkFocus){var $selected=$($rows[i]).addClass("focused").scrollIntoView();$selected.find("td").first().attr("title",helpText);if(!supressLinkFocus){focusRow(i)}setSelectedIssueAjax(delay||250)}function selectRowViaIssueId(issueId,delay,supressLinkFocus){var newIndex=issueIdToRowIndex[issueId];if(newIndex||newIndex===0){unselectRow(index);selectRow(index=newIndex,delay,supressLinkFocus)}}function focusRow(i){var $selected=$($rows[i]);$selected.find(".hidden-link").removeAttr("tabIndex").focus()}function setSelectedIssueAjax(delay){delay=typeof delay==="number"?delay:1000;clearDelayedTimeout();setSelectedIssueAjax.timeout=setTimeout(setSelectedIssueAjax.callback=function(){$.get(contextPath+"/secure/SetSelectedIssue.jspa",{atl_token:atl_token(),selectedIssueId:JIRA.IssueNavigator.getSelectedIssueId(),selectedIssueIndex:JIRA.IssueNavigator.getFocsuedIssueIndex(),nextIssueId:JIRA.IssueNavigator.getNextIssueId()});clearDelayedTimeout()},delay)}setSelectedIssueAjax.callback=null;setSelectedIssueAjax.timeout=null;function clearDelayedTimeout(){clearTimeout(setSelectedIssueAjax.timeout);setSelectedIssueAjax.callback=null;setSelectedIssueAjax.timeout=null}})(AJS.$);AJS.namespace("jira.app.issuenavigator.shortcuts",null,JIRA.IssueNavigator.Shortcuts);
/* module-key = 'jira.webresources:jira-global', location = '/includes/jira/common/app.js' */
(function($){function initOverlabels(){$("label.overlabel").overlabel()}function initIssueNavContainment(){var $issueNav=$("div.results"),$issueNavWrapWidth=$issueNav.width();$issueNav.bind("resultsWidthChanged",function(){var $issueNavWrap=$(this);$issueNavWrap.css("width",100/$issueNavWrapWidth*($issueNavWrapWidth-(parseInt($(document.documentElement).prop("scrollWidth"),10)-$(window).width()))+"%")});$(window).resize(function(){$issueNav.trigger("resultsWidthChanged")});$issueNav.trigger("resultsWidthChanged");$("#issuenav").bind("contractBlock expandBlock",function(){$(".results").trigger("resultsWidthChanged")})}function initFieldTabs(){$(".fieldTabs li").click(function(e){e.preventDefault();e.stopPropagation();var $this=$(this);if(!$this.hasClass("active")){$(".fieldTabs li.active").removeClass("active");$this.addClass("active");$(".fieldTabArea.active").removeClass("active");$("#"+$this.attr("rel")).addClass("active")}})}function initHandleAccessKeys(){$("form").handleAccessKeys();$(document).bind("dialogContentReady",function(){$("form",this.$content).handleAccessKeys({selective:false})})}function initHandleInlineLayerHide(){$(document).keydown(function(e){if(AJS.InlineDialog.current&&e.which==27&&!$(e.target).is(":input")){AJS.InlineDialog.current.hide()}})}function initToggleBlocks(){new JIRA.ToggleBlock({blockSelector:".twixi-block",storageCollectionName:"twixi"}).addCallback("toggle",function(){$("#stalker").trigger("stalkerHeightUpdated")}).addTrigger(".action-head .action-details","click");new JIRA.ToggleBlock({blockSelector:".twixi-block-inverted",collapsedClass:"expanded",expandedClass:"collapsed",storageCollectionName:"inverted-twixi"}).addCallback("toggle",function(){$("#stalker").trigger("stalkerHeightUpdated")});new JIRA.ToggleBlock({blockSelector:"#issue-filter .toggle-wrap:not(#navigator-filter-subheading-textsearch-group)",triggerSelector:".toggle-trigger",collapsedClass:"expanded",expandedClass:"collapsed",storageCollectionName:"navSimpleSearch"});new JIRA.ToggleBlock({blockSelector:"#navigator-filter-subheading-textsearch-group",triggerSelector:".toggle-trigger",storageCollectionName:"navSimpleSearchText"});new JIRA.ToggleBlock({blockSelector:"#queryBoxTable.toggle-wrap",triggerSelector:".toggle-trigger",storageCollectionName:"navAdvanced"});new JIRA.ToggleBlock({blockSelector:".twixi-block",triggerSelector:".twixi-trigger",storageCollectionName:"twixi"});new JIRA.ToggleBlock({blockSelector:"#issuenav",triggerSelector:"a.toggle-lhc",collapsedClass:"lhc-collapsed",storageCollectionName:"lhc-state",autoFocusTrigger:false});$("#issue-filter .error").parents(".toggle-wrap").removeClass("collapsed").addClass("expanded");$("fieldset.content-toggle input[type='radio']").live("change",function(){var $this=$(this);$this.closest(".content-toggle").find("input[type='radio']").each(function(){var $this=$(this);$("#"+$this.attr("name")+"-"+$this.val()+"-content").addClass("hidden")});$("#"+$this.attr("name")+"-"+$this.val()+"-content").removeClass("hidden")})}function initLogWork(){$("#log-work-adjust-estimate-new-value,#log-work-adjust-estimate-manual-value").attr("disabled","disabled");$("#log-work-adjust-estimate-"+$("input[name=worklog_adjustEstimate]:checked,input[name=adjustEstimate]:checked").val()+"-value").removeAttr("disabled");$("input[name=worklog_adjustEstimate],input[name=adjustEstimate]").change(function(){$("#log-work-adjust-estimate-new-value,#log-work-adjust-estimate-manual-value").attr("disabled","disabled");$("#log-work-adjust-estimate-"+$(this).val()+"-value").removeAttr("disabled")})}function initLogin(){var radio=$("input:checked");if(radio.length!==0){if(radio.attr("id")==="forgot-login-rb-forgot-password"){$("#username,#password").addClass("hidden");$("#password").removeClass("hidden")}else{if(radio.attr("id")==="forgot-login-rb-forgot-username"){$("#username,#password").addClass("hidden");$("#username").removeClass("hidden")}}}$("#forgot-login-rb-forgot-password").change(function(){$("#username,#password").addClass("hidden");$("#password").removeClass("hidden")});$("#forgot-login-rb-forgot-username").change(function(){$("#username,#password").addClass("hidden");$("#username").removeClass("hidden")})}function initFileRadio(){$("input.upfile").each(function(){var input=$(this),container=input.closest(".field-group");input.change(function(){if(input.val().length>0){container.next(".field-group").removeClass("hidden")}})})}function initHandleEnterInTextarea(){$(document).on("keypress","textarea",submitOnCtrlEnter);$("#jqltext").keypress(submitOnEnter)}function initUnsupportedBrowserWarning(){var $warning=$("#browser-warning");$(".icon-close",$warning).click(function(){$warning.slideUp("fast");saveCookie("UNSUPPORTED_BROWSER_WARNING","handled")})}function initHandleFormSubmit(){$("form").submit(function(e){var event=new $.Event("before-submit");$(this).trigger(event);if(event.isDefaultPrevented()){e.preventDefault()}})}function initExpandOnInput(){var $document=$(document),selector="#comment, #environment, #description",maxTextareaHeight=200;$document.bind("tabSelect",function(e,data){data.pane.find(selector).expandOnInput()});$(selector).expandOnInput(maxTextareaHeight);$document.bind("dialogContentReady",function(e,dialog){dialog.get$popupContent().bind("tabSelect",function(e,data){data.pane.find(selector).expandOnInput(maxTextareaHeight)}).find(selector).expandOnInput(maxTextareaHeight)});$document.bind("showWikiInput",function(e,$container){$container.find(selector).expandOnInput()})}function initAuiTabHandling(){JIRA.bind("dialogContentReady",function(){AJS.tabs.setup()})}function initCancelFormHandling(){var $auiForm=$("form.aui");var $cancel=$("a.cancel",$auiForm);if($.browser.msie&&$cancel.attr("accessKey")){$cancel.focus(function(e){if(e.altKey){$(this).mousedown();window.location.href=$cancel.attr("href")}})}}function initBulkEditCheckboxes(){var checkRow=function(input){$(input).closest(".availableActionRow").find("td:first :checkbox").attr("checked",true)};var $rows=$("#availableActionsTable tr.availableActionRow");$rows.children("td:last-child").find(":input").change(function(e){checkRow(this)})}function initPerformanceMonitor(){if(AJS.params.showmonitor){var $div=$("<div class='perf-monitor'/>");var slowRequest=AJS.params["jira.request.server.time"]>2000,tooManySql=AJS.params.jiraSQLstatements>50;if(slowRequest){$div.addClass("tooslow")}if(tooManySql){$div.addClass("toomanysql")}$("#header-top").append($div);AJS.InlineDialog($div,"perf-monitor-dialog",function($contents,control,show){var timingInfo="<div>Page render time <strong>"+AJS.params["jira.request.server.time"]+" ms</strong>";if(AJS.params.jiraSQLstatements){timingInfo+=" / SQL <strong>"+AJS.params.jiraSQLstatements+"@"+AJS.params.jiraSQLtime+" ms</strong></br>";timingInfo+='<a target="_blank" href='+contextPath+"/sqldata.jsp?requestId="+AJS.params["jira.request.id"]+">More...</a>"}else{timingInfo+=" / No SQL statments"}timingInfo+="</div>";$contents.empty().append(timingInfo);show()})}}function initShareItem($ctx){$(".shared-item-trigger",$ctx).each(function(){var target=$(this).attr("href");AJS.InlineDialog(this,target.substring(1),function(contents,trigger,showPopup){contents.html($(target).html());contentLoaded=true;showPopup()},{width:240})})}function initClickables(){$(".clickable").click(function(){window.location.href=$(this).find("a").attr("href")})}function initProjectsList($ctx){$(".projects-list-trigger",$ctx).each(function(){var $trigger=$(this);$trigger.click(false);var target=$trigger.attr("href");AJS.InlineDialog(this,target.substring(1),function(contents,trigger,showPopup){contents.html($(target).html());showPopup()},{onHover:true,hideDelay:500,width:240})})}function initHelpLinks(){$(document).on("click","[data-helplink=local]",function(e){var url=this.getAttribute("href");var child=window.open(url,"jiraLocalHelp","resizable, scrollbars=yes");child.focus();e.preventDefault();return false})}$(function(){initToggleBlocks();initOverlabels();initIssueNavContainment();initFieldTabs();initHandleAccessKeys();initLogWork();initLogin();initFileRadio();initHandleEnterInTextarea();initUnsupportedBrowserWarning();initHandleFormSubmit();initExpandOnInput();initCancelFormHandling();initBulkEditCheckboxes();initHandleInlineLayerHide();initPerformanceMonitor();initClickables();initHelpLinks();initProjectsList()});AJS.describeBrowser();initAuiTabHandling();JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,$ctx){initShareItem($ctx)});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(event,$context){$context.find("#filter-edit").on("submit",function(event){if(!event.isDefaultPrevented()){var filterName=AJS.escapeHtml(this.elements.filterName.value);JIRA.Messages.showMsgOnReload(AJS.format("Changes to {0} have been saved.",filterName),{type:"SUCCESS",closeable:true,target:"body:not(:has(#filter-edit))"})}});$context.find("#filter-subscription").on("submit",function(event){if(!event.isDefaultPrevented()){var recipient=jQuery('select[name="groupName"]').val()||AJS.Meta.get("remote-user-fullname");JIRA.Messages.showMsgOnReload(AJS.format("A subscription has been added for \u003cstrong>{0}\u003c\/strong>.",AJS.escapeHtml(recipient)),{type:"SUCCESS",closeable:true,target:"body:not(:has(#filter-subscription))"})}})})})(AJS.$);
/* module-key = 'jira.webresources:jira-global', location = '/includes/jira/common/page.js' */
(function($){var legacyPage={relatedContentCssSelector:".content-container > .content-related",mainContentCssSelector:".content-container > .content-body"};var auiPage={relatedContentCssSelector:".aui-page-panel > .aui-page-panel-inner > .aui-page-panel-nav",mainContentCssSelector:".aui-page-panel > .aui-page-panel-inner > .aui-page-panel-content"};var findEl=function(prop){var $el=$(legacyPage[prop]);if($el.size()){AJS.log("This page is using a deprecated page layout markup pattern. It should be updated to use AUI page layout.")}else{$el=$(auiPage[prop])}return $el};JIRA.Page=$.extend({},JIRA.Page,legacyPage,auiPage,{relatedContentElement:function(){return findEl("relatedContentCssSelector")},mainContentElement:function(){return findEl("mainContentCssSelector")}})})(AJS.$);
/* module-key = 'jira.webresources:jira-global', location = '/includes/jira/dialog/initDialogs.js' */
AJS.$(function(){JIRA.Dialogs.keyboardShortcuts=new JIRA.FormDialog({id:"keyboard-shortcuts-dialog",trigger:"#keyshortscuthelp",widthClass:"large",onContentRefresh:function(){var context=this.get$popupContent();AJS.$("a.submit-link",context).click(function(e){e.preventDefault();AJS.$("form",context).submit()})},onSuccessfulSubmit:function(){AJS.keyboardShortcutsDisabled=!AJS.keyboardShortcutsDisabled}});JIRA.Dialogs.deleteIssueLink=new JIRA.FormDialog({type:"ajax",id:"delete-issue-link-dialog",trigger:"#linkingmodule a.icon-delete",ajaxOptions:JIRA.Dialogs.getDefaultAjaxOptions,isIssueDialog:true});if(document.getElementById("dashboard")){JIRA.Dialogs.deleteDashboard=new JIRA.FormDialog({type:"ajax"});AJS.$(document).delegate("#delete_dashboard","click",function(e){e.stopPropagation();e.preventDefault();JIRA.Dialogs.deleteDashboard.$activeTrigger=AJS.$("#delete_dashboard");JIRA.Dialogs.deleteDashboard.init({type:"ajax",id:"delete-dshboard",ajaxOptions:{url:JIRA.Dialogs.deleteDashboard.$activeTrigger.attr("href")},targetUrl:"input[name=targetUrl]"});JIRA.Dialogs.deleteDashboard.show()})}else{JIRA.Dialogs.linkIssue=JIRA.Dialogs.createLinkIssueDialog("a.issueaction-link-issue");JIRA.Dialogs.deleteIssue=new JIRA.FormDialog({id:"delete-issue-dialog",trigger:"a.issueaction-delete-issue",targetUrl:"#delete-issue-return-url",ajaxOptions:JIRA.Dialogs.getDefaultAjaxOptions,onSuccessfulSubmit:JIRA.Dialogs.storeCurrentIssueIdOnSucessfulSubmit,issueMsg:"thanks_issue_deleted",delayShowUntil:JIRA.Dialogs.BeforeShowIssueDialogHandler.execute,isIssueDialog:true});JIRA.Dialogs.cloneIssue=new JIRA.FormDialog({id:"clone-issue-dialog",trigger:"a.issueaction-clone-issue",handleRedirect:true,ajaxOptions:JIRA.Dialogs.getDefaultAjaxOptions,onSuccessfulSubmit:JIRA.Dialogs.storeCurrentIssueIdOnSucessfulSubmit,issueMsg:"thanks_issue_cloned",delayShowUntil:JIRA.Dialogs.BeforeShowIssueDialogHandler.execute,isIssueDialog:true});JIRA.Dialogs.assignIssue=new JIRA.FormDialog({id:"assign-dialog",trigger:"a.issueaction-assign-issue",ajaxOptions:JIRA.Dialogs.getDefaultAjaxOptions,onSuccessfulSubmit:JIRA.Dialogs.storeCurrentIssueIdOnSucessfulSubmit,issueMsg:"thanks_issue_assigned",delayShowUntil:JIRA.Dialogs.BeforeShowIssueDialogHandler.execute,isIssueDialog:true,widthClass:"large"});JIRA.Dialogs.assignIssueToMe=new JIRA.FormDialog({id:"assign-dialog",trigger:"a.issueaction-assign-to-me",ajaxOptions:JIRA.Dialogs.getDefaultAjaxOptions,onSuccessfulSubmit:JIRA.Dialogs.storeCurrentIssueIdOnSucessfulSubmit,issueMsg:"thanks_issue_assigned",delayShowUntil:JIRA.Dialogs.BeforeShowIssueDialogHandler.execute,isIssueDialog:true});JIRA.Dialogs.logWork=new JIRA.FormDialog({id:"log-work-dialog",trigger:"a.issueaction-log-work",handleRedirect:true,ajaxOptions:JIRA.Dialogs.getDefaultAjaxOptions,onSuccessfulSubmit:JIRA.Dialogs.storeCurrentIssueIdOnSucessfulSubmit,issueMsg:"thanks_issue_worklogged",delayShowUntil:JIRA.Dialogs.BeforeShowIssueDialogHandler.execute,isIssueDialog:true,widthClass:"large"});JIRA.Dialogs.attachFile=new JIRA.FormDialog({id:"attach-file-dialog",trigger:"a.issueaction-attach-file",handleRedirect:true,ajaxOptions:JIRA.Dialogs.getDefaultAjaxOptions,onSuccessfulSubmit:JIRA.Dialogs.storeCurrentIssueIdOnSucessfulSubmit,issueMsg:"thanks_issue_attached",isIssueDialog:true,widthClass:"large"});JIRA.Dialogs.attachScreenshot=new JIRA.ScreenshotDialog({id:"attach-screenshot-window",trigger:"a.issueaction-attach-screenshot"});JIRA.Dialogs.manageAttachment=new JIRA.FormDialog({id:"manage-attachment-dialog",trigger:"#manage-attachment-link",stacked:true,reloadOnPop:true,isIssueDialog:true,widthClass:"large"});JIRA.Dialogs.comment=new JIRA.FormDialog({id:"comment-add-dialog",trigger:"a.issueaction-comment-issue:not(.inline-comment)",handleRedirect:true,ajaxOptions:JIRA.Dialogs.getDefaultAjaxOptions,onSuccessfulSubmit:JIRA.Dialogs.storeCurrentIssueIdOnSucessfulSubmit,issueMsg:"thanks_issue_commented",isIssueDialog:true,widthClass:"large"});JIRA.Dialogs.editLabels=new JIRA.LabelsDialog({id:"edit-labels-dialog",trigger:"a.issueaction-edit-labels,a.edit-labels",autoClose:true,ajaxOptions:JIRA.Dialogs.getDefaultAjaxOptions,onSuccessfulSubmit:JIRA.Dialogs.storeCurrentIssueIdOnSucessfulSubmit,issueMsg:"thanks_issue_labelled",delayShowUntil:JIRA.Dialogs.BeforeShowIssueDialogHandler.execute,labelsProvider:labelsProvider,isIssueDialog:true});JIRA.Dialogs.editComment=new JIRA.FormDialog({type:"ajax",id:"edit-comment",trigger:".action-links .edit-comment",delayShowUntil:JIRA.Dialogs.BeforeShowIssueDialogHandler.execute,isIssueDialog:true,widthClass:"large"}).dirtyFormWarning();JIRA.Dialogs.deleteComment=new JIRA.FormDialog({type:"ajax",id:"delete-comment-dialog",trigger:".action-links [id^='delete_comment']",delayShowUntil:JIRA.Dialogs.BeforeShowIssueDialogHandler.execute,isIssueDialog:true,widthClass:"large"}).dirtyFormWarning();JIRA.Dialogs.watchIssue=new JIRA.FormDialog({ajaxOptions:JIRA.Dialogs.getDefaultAjaxOptions,onSuccessfulSubmit:JIRA.Dialogs.storeCurrentIssueIdOnSucessfulSubmit,delayShowUntil:JIRA.Dialogs.BeforeShowIssueDialogHandler.execute,trigger:".issueaction-watch-issue",isIssueDialog:true});JIRA.Dialogs.stopWatchingIssue=new JIRA.FormDialog({ajaxOptions:JIRA.Dialogs.getDefaultAjaxOptions,onSuccessfulSubmit:JIRA.Dialogs.storeCurrentIssueIdOnSucessfulSubmit,delayShowUntil:JIRA.Dialogs.BeforeShowIssueDialogHandler.execute,trigger:".issueaction-unwatch-issue",isIssueDialog:true});new JIRA.FormDialog({type:"ajax",id:"delete-attachment-dialog",trigger:"#attachmentmodule .attachment-delete a, #issue-attachments-table a.delete",isIssueDialog:true});var workflowLinkSelector="a.issueaction-workflow-transition";AJS.$(document).delegate(workflowLinkSelector,"click",function(event){event.preventDefault();var link=AJS.$(event.target).closest(workflowLinkSelector);var action=parseUri(link.attr("href")).queryKey.action;if(action){var id="workflow-transition-"+action+"-dialog";var $trigger=AJS.$(this);if(!JIRA.Dialogs[id]){JIRA.Dialogs[id]=new JIRA.FormDialog({id:id,trigger:['a[href*="action='+action+'&"].issueaction-workflow-transition','a[href$="action='+action+'"].issueaction-workflow-transition'],widthClass:"large",handleRedirect:true,ajaxOptions:JIRA.Dialogs.getDefaultAjaxOptions,onSuccessfulSubmit:JIRA.Dialogs.storeCurrentIssueIdOnSucessfulSubmit,delayShowUntil:JIRA.Dialogs.BeforeShowIssueDialogHandler.execute,issueMsg:"thanks_issue_transitioned",onContentRefresh:function(){AJS.tabs.setup()},isIssueDialog:true});JIRA.Dialogs[id].$activeTrigger=$trigger;JIRA.Dialogs[id].show()}}});AJS.$.each(JIRA.Dialogs,function(name,dialog){if(dialog instanceof JIRA.Dialog){AJS.$(dialog).bind("beforeShow",function(){if(name!=="keyboardShortcuts"){return JIRA.IssueNavigator.isRowSelected()||JIRA.Issue.getIssueId()!==undefined}})}})}jQuery(window).resize(_.debounce(function(){JIRA.Dialog.current&&JIRA.Dialog.current._positionInCenter()},200));new JIRA.FormDialog({id:"credits-dialog",trigger:"#view_credits",widthClass:"creditsContainer",onContentRefresh:function(){if(!jQuery("html").hasClass("safari")){function center(){jQuery.each(arguments,function(){this.show().css({marginLeft:-this.outerWidth()/2,marginTop:-this.outerHeight()/2}).hide()})}}}});new JIRA.FormDialog({id:"about-dialog",trigger:"#view_about",ajaxOptions:{url:this.href,data:{decorator:"dialog",inline:"true"}},widthClass:"large"});jQuery("a.trigger-dialog").each(function(){new JIRA.FormDialog({trigger:this,id:this.id+"-dialog",ajaxOptions:{url:this.href,data:{decorator:"dialog",inline:"true"}}})});function labelsProvider(labelsPopup){var $trigger=labelsPopup.$activeTrigger,$labelsContainer=$trigger.closest(".labels-wrap"),isSubtaskForm=$trigger.parents("#view-subtasks").length!==0;if(isSubtaskForm){$labelsContainer=$trigger.parents("tr").find(".labels-wrap")}else{if($trigger.hasClass("issueaction-edit-labels")){if(JIRA.IssueNavigator.isNavigator()){$labelsContainer=jQuery("#issuetable tr.issuerow.focused td.labels .labels-wrap")}else{$labelsContainer=jQuery("#wrap-labels .labels-wrap")}}}if($labelsContainer.length>0){return $labelsContainer}return false}});
/* module-key = 'jira.webresources:jira-global', location = '/includes/jira/dropdown/initDropdowns.js' */
JIRA.Dropdowns={};JIRA.Dropdowns.bindGenericDropdowns=function(ctx){AJS.$(".js-default-dropdown",ctx).each(function(){var $trigger=AJS.$(this),$content=$trigger.next(".aui-list"),alignment=$trigger.attr("data-alignment")||AJS.RIGHT,hasDropdown=!!$trigger.data("hasDropdown");if($content.length==0){console.warn("Dropdown init failied. Could not find content. Printing culprit...");console.log($trigger)}if(!hasDropdown){$trigger.data("hasDropdown",true);new AJS.Dropdown({trigger:$trigger,content:$content,alignment:alignment,setMaxHeightToWindow:$trigger.attr("data-contain-to-window"),hideOnScroll:$trigger.attr("data-hide-on-scroll")||".issue-container"})}})};JIRA.Dropdowns.bindIssueActionsDds=function(ctx){var trigger=AJS.$(".issue-actions-trigger",ctx);trigger.each(function(){new AJS.Dropdown({hideOnScroll:".issue-container",trigger:jQuery(this),ajaxOptions:{formatError:function(){JIRA.Issues.Api.showInlineIssueLoadError()},dataType:"json",cache:false,formatSuccess:JIRA.FRAGMENTS.issueActionsFragment},onerror:function(instance){instance.layerController.initialized=true;instance.hide()}});jQuery(this).addClass("trigger-happy")})};JIRA.Dropdowns.bindNavigatorOptionsDds=function(){var $navigatorOptions=AJS.$("#navigator-options");AJS.Dropdown.create({trigger:$navigatorOptions.find(".aui-dd-link"),content:$navigatorOptions.find(".aui-list"),alignment:AJS.RIGHT});$navigatorOptions.find("a.aui-dd-link").linkedMenu()};JIRA.Dropdowns.bindConfigDashboardDds=function(){AJS.$("#dashboard").find(".aui-dd-parent").dropDown("Standard",{trigger:"a.aui-dd-link"})};JIRA.Dropdowns.bindHeaderDds=function(){AJS.$("#main-nav li").each(function(){var $this=AJS.$(this),trigger=$this.hasClass("admin-menu-link")?$this:AJS.$(".drop",this);if($this.hasClass("lazy")){AJS.Dropdown.create({alignment:AJS.LEFT,offsetTarget:$this,trigger:trigger,styleClass:"main-nav-dropdown",ajaxOptions:{url:contextPath+"/rest/api/1.0/menus/"+trigger.attr("rel"),dataType:"json",cache:false,formatSuccess:JIRA.FRAGMENTS.menuFragment}})}else{if($this.hasClass("nonlazy")){AJS.Dropdown.create({alignment:AJS.LEFT,offsetTarget:$this,styleClass:"main-nav-dropdown",trigger:trigger,content:$this.find(".aui-list")})}}});AJS.Dropdown.create({alignment:AJS.RIGHT,trigger:AJS.$("#header-details-user .drop"),content:AJS.$("#user-options-list")});AJS.$("#main-nav.admin-menu-bar").find("li.admin-menu-link").linkedMenu({onFocusRemoveClass:"#main-nav .selected"});AJS.$("#main-nav.standard-menu-bar").find("a.aui-dd-link").linkedMenu({reflectFocus:"#main-nav .lnk",onFocusRemoveClass:"#main-nav .selected"})};AJS.$(function(){JIRA.Dropdowns.bindNavigatorOptionsDds();JIRA.Dropdowns.bindConfigDashboardDds()});JIRA.bind("Issue.subtasksRefreshed",function(e,ctx){JIRA.Dropdowns.bindIssueActionsDds(ctx)});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,ctx){JIRA.Dropdowns.bindIssueActionsDds(ctx);JIRA.Dropdowns.bindGenericDropdowns(ctx)});
/* module-key = 'jira.webresources:jira-global', location = '/includes/jira/field/AssigneePicker.js' */
JIRA.AssigneePicker=AJS.SingleSelect.extend({init:function(options){var element=options.element;function data(query){AJS.params.actionDescriptorId=undefined;AJS.populateParameters();return{username:query,projectKeys:AJS.params.projectKeys,issueKey:AJS.params.assigneeEditIssueKey,actionDescriptorId:AJS.params.actionDescriptorId,maxResults:1000}}function formatResponse(response){var ret=[];if(response.length){var groupDescriptor=new AJS.GroupDescriptor({weight:1,id:"assignee-group-search",uniqueItemScope:"container",replace:true,label:"All Users"});for(var i=0,len=response.length;i<len;i++){var user=response[i];var username=user.name;var displayName=user.displayName;var emailAddress=user.emailAddress;var label=displayName+" - "+emailAddress+" ("+username+")";groupDescriptor.addItem(new AJS.ItemDescriptor({value:username,fieldText:displayName,label:label,allowDuplicate:false,icon:user.avatarUrls["16x16"]}))}ret.push(groupDescriptor)}return ret}AJS.$.extend(options,{submitInputVal:true,showDropdownButton:!!element.data("show-dropdown-button"),errorMessage:"User \'\'{0}\'\' cannot be assigned this issue",localDataGroupId:"assignee-group-suggested",content:"mixed",removeDuplicates:true,ajaxOptions:{url:function(){AJS.params.assigneeEditIssueKey=undefined;AJS.populateParameters();var path=AJS.params.assigneeEditIssueKey?"search":"multiProjectSearch";return contextPath+"/rest/api/latest/user/assignable/"+path},query:true,data:data,formatResponse:formatResponse}});this._super(options);this.suggestionsHandler=new JIRA.AssigneeSuggestHandler(this.options,this.model)},handleFreeInput:function(value){if(""===AJS.$.trim(value||this.$field.val())){this.setSelection(this.model.getDescriptor("-1"))}else{this._super(value)}},cleanUpModel:function(){}});
/* module-key = 'jira.webresources:jira-global', location = '/includes/jira/field/initAssigneePickers.js' */
(function($){function getHashedLinkTarget(url){var hashIndex=url.indexOf("#");return(hashIndex!=-1)?url.substring(hashIndex):url}function wireAssignToMeLink(context){$("#assign-to-me-trigger",context).click(function(e){e.preventDefault();var assigneeId=getHashedLinkTarget(jQuery(this).attr("href"));var loggedInUser=JIRA.Meta.getLoggedInUser();var assigneeSelect=$(assigneeId,context);if($(assigneeId+"-single-select",context).length){assigneeSelect.trigger("set-selection-value",loggedInUser.name)}else{assigneeSelect.val(loggedInUser.name).change()}})}function wireAssigneeEditGroup(context){$(".assignee-edit-group",context).each(function(){var $this=$(this);var assigneeFieldId=$this.attr("rel");$("#assignee_userpicker_dummy_"+assigneeFieldId+"_container",context).click(function(){$("#assignee_radio_picker_"+assigneeFieldId,context).attr("checked","checked")});$this.parents("form[name=jiraform]").submit(function(){$this.find("input[name=assignee_radio]:checked").each(function(){if(this.id=="assignee_radio_picker_"+assigneeFieldId){$("#"+assigneeFieldId,context).val($("#assignee_userpicker_dummy_"+assigneeFieldId,context).val())}else{$("#"+assigneeFieldId,context).val($(this).val())}})})})}function createAssigneePicker(ctx){$(".js-assignee-picker",ctx).each(function(){var $this=$(this),editValue=$this.data("editValue");var control=new JIRA.AssigneePicker({element:$this,editValue:editValue});$(document).trigger("ready.single-select.assignee",control)})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createAssigneePicker(context);wireAssignToMeLink(context);wireAssigneeEditGroup(context)}})})(AJS.$);
/* module-key = 'jira.webresources:jira-global', location = '/includes/jira/websudo/webSudo.js' */
AJS.$(function(){function dropWebSudo(successCallback){AJS.$.ajax({type:"DELETE",url:contextPath+"/rest/auth/1/websudo",contentType:"application/json",success:successCallback})}AJS.$("#websudo-drop-from-protected-page").click(function(event){dropWebSudo(function(){window.location=contextPath+"/secure/MyJiraHome.jspa"});event.preventDefault()});AJS.$("#websudo-drop-from-normal-page").click(function(event){dropWebSudo(function(){AJS.$("#websudo-banner").slideUp();AJS.$("#websudo-banner").addClass("dropped")});event.preventDefault()})});
/* module-key = 'jira.webresources:jira-global', location = '/includes/jquery/plugins/togglefield/toggleField.js' */
jQuery.fn.toggleField=function(field){var that=this,field=jQuery(field),setFieldAttr=function(){field.prop("disabled",function(){if(that.prop("checked")===false){that.parent().addClass("disabled");return true}else{that.parent().removeClass("disabled");return false}}());return arguments.callee}();jQuery(document[this.attr("name")]).click(setFieldAttr).change(setFieldAttr);return this};
/* module-key = 'jira.webresources:jira-global', location = '/includes/jira/project/ProjectKeyGenerator.js' */
(function(){var IGNORED_WORDS=["THE","A","AN","AS","AND","OF","OR"];var CHARACTER_MAP={};CHARACTER_MAP[199]="C";CHARACTER_MAP[231]="c";CHARACTER_MAP[252]="u";CHARACTER_MAP[251]="u";CHARACTER_MAP[250]="u";CHARACTER_MAP[249]="u";CHARACTER_MAP[233]="e";CHARACTER_MAP[234]="e";CHARACTER_MAP[235]="e";CHARACTER_MAP[232]="e";CHARACTER_MAP[226]="a";CHARACTER_MAP[228]="a";CHARACTER_MAP[224]="a";CHARACTER_MAP[229]="a";CHARACTER_MAP[225]="a";CHARACTER_MAP[239]="i";CHARACTER_MAP[238]="i";CHARACTER_MAP[236]="i";CHARACTER_MAP[237]="i";CHARACTER_MAP[196]="A";CHARACTER_MAP[197]="A";CHARACTER_MAP[201]="E";CHARACTER_MAP[230]="ae";CHARACTER_MAP[198]="Ae";CHARACTER_MAP[244]="o";CHARACTER_MAP[246]="o";CHARACTER_MAP[242]="o";CHARACTER_MAP[243]="o";CHARACTER_MAP[220]="U";CHARACTER_MAP[255]="Y";CHARACTER_MAP[214]="O";CHARACTER_MAP[241]="n";CHARACTER_MAP[209]="N";function getTotalLength(words){return words.join("").length}function removeIgnoredWords(words){return _.reject(words,function(word){return AJS.$.inArray(word,IGNORED_WORDS)!==-1})}function createAcronym(words){var result="";AJS.$.each(words,function(i,word){result+=word.charAt(0)});return result}function getFirstSyllable(word){var pastVowel=false;var i;for(i=0;i<word.length;i++){if(isVowelOrY(word[i])){pastVowel=true}else{if(pastVowel){return word.substring(0,i+1)}}}return word}function isVowelOrY(c){return c&&c.length===1&&c.search("[AEIOUY]")!==-1}JIRA.ProjectKeyGenerator=Class.extend({init:function(options){options=jQuery.extend({},options);this.desiredKeyLength=(typeof options.desiredKeyLength=="number")?options.desiredKeyLength:4;this.maxKeyLength=(typeof options.maxKeyLength=="number")?options.maxKeyLength:0},generateKey:function(name){name=AJS.$.trim(name);if(!name){return""}var filtered=[];for(var i=0,ii=name.length;i<ii;i++){var sub=CHARACTER_MAP[name.charCodeAt(i)];filtered.push(sub?sub:name[i])}name=filtered.join("");var words=[];AJS.$.each(name.split(/\s+/),function(i,word){if(word){word=word.replace(/[^a-zA-Z]/g,"");word=word.toUpperCase();word.length&&words.push(word)}});if(this.desiredKeyLength&&getTotalLength(words)>this.desiredKeyLength){words=removeIgnoredWords(words)}var key;if(words.length==0){key=""}else{if(words.length==1){var word=words[0];if(this.desiredKeyLength&&word.length>this.desiredKeyLength){key=getFirstSyllable(word)}else{key=word}}else{key=createAcronym(words)}}if(this.maxKeyLength&&key.length>this.maxKeyLength){key=key.substr(0,this.maxKeyLength)}return key}})})();
/* module-key = 'jira.webresources:jira-global', location = '/includes/jira/project/ProjectSample.js' */
JIRA.ProjectSample=Class.extend({init:function(options){this.defaultName="My Project";this.defaultKey="MP";this.defaultAvatarSrc="";this.nameValue="";this.keyValue="";this.avatarSrc="";this.$container=options.element;this.$container.html(JIRA.Templates.CreateProject.projectSample({projectName:this.defaultName,projectKey:this.defaultKey,issueName:options.issueName}));this.$sampleElement=this.$container.find(".sample-project");this.$sampleElementName=this.$sampleElement.find("#project-name-val");this.$sampleElementKey=this.$sampleElement.find("#key-val");this.$sampleElementAvatar=this.$sampleElement.find("#project-avatar");this.events=options.events;this.events.bind("updated.Name",AJS.$.proxy(function(){this.updateSampleName(arguments[1])},this));this.events.bind("updated.Key",AJS.$.proxy(function(){this.updateSampleKey(arguments[1])},this));this.events.bind("updated.Avatar",AJS.$.proxy(function(){this.updateSampleAvatar(arguments[1])},this))},_render:function(){var name=this.nameValue||this.defaultName;var key=this.keyValue||this.defaultKey;var avatar=this.avatarSrc||this.defaultAvatarSrc;key=(key||"")+"-1";key=key.toUpperCase();this.$sampleElementName.text(name);this.$sampleElementKey.text(key);this.$sampleElementAvatar.attr("src",avatar)},updateSampleName:function(name){this.nameValue=jQuery.trim(name);this._render()},updateSampleKey:function(key){this.keyValue=jQuery.trim(key);this._render()},updateSampleAvatar:function(src){this.avatarSrc=src;this._render()}});
/* module-key = 'jira.webresources:jira-global', location = '/includes/jira/field/CreateProjectField.js' */
JIRA.CreateProjectField=Class.extend({TIMEOUT_MS:100,projectNames:[],maxNameLength:80,init:function(options){this.$element=options.element;this.$nameElement=this.$element.find("input.text[name='name']");this.$keyElement=this.$element.find("input.text[name='key']");this.$keyEditedElement=this.$element.find("input[name='keyEdited']");this.$avatarElement=this.$element.find(".jira-inline-avatar-picker-trigger");this.eventBus={src:AJS.$(this),trigger:function(name,args){this.src.trigger(name,args)},bind:function(name,func){this.src.bind(name,func)}};var maxKeyLength=this.$keyElement.attr("maxlength");if(!maxKeyLength){maxKeyLength=10}this.keygen=new JIRA.ProjectKeyGenerator({desiredKeyLength:4,maxKeyLength:maxKeyLength});this.lastKeyValidated="";if(AJS.DarkFeatures.isEnabled("addproject.project.sample")){this.sample=new JIRA.ProjectSample({element:this.$element.find("#sample-project-container"),events:this.eventBus})}this.$keyElement.attr("style","text-transform: uppercase");this.initialName=this.$nameElement.val();this.initialKey=this.$keyElement.val();this.$element.find(".error").addClass("description initial-error");this.showInitialError(this.$nameElement);this.showInitialError(this.$keyElement);this.$nameElement.focus(AJS.$.proxy(this._bindNameHook,this));this.$nameElement.blur(AJS.$.proxy(this._unbindHook,this));this.$keyElement.focus(AJS.$.proxy(this._bindKeyHook,this));this.$keyElement.blur(AJS.$.proxy(this._unbindHook,this));this.$keyElement.blur(AJS.$.proxy(this.autofillKeyIfNeeded,this));var $keyHelpElement=this.$keyElement.parent().find("#add-project-key-icon").removeAttr("target data-helplink");if($keyHelpElement.length){new AJS.InlineDialog($keyHelpElement,"project-key-help-popup",function(contents,trigger,show){contents.html(JIRA.Templates.CreateProject.keyHelp());show()},{width:330,offsetX:-30})}if(this.$avatarElement.size()){this.eventBus.trigger("updated.Avatar",this.$avatarElement.attr("src"));this.$avatarElement.bind("AvatarSelected",AJS.$.proxy(function(){this.eventBus.trigger("updated.Avatar",this.$avatarElement.attr("src"))},this))}this._loadExistingProjects()},_loadExistingProjects:function(){var instance=this;AJS.$.ajax({url:contextPath+"/rest/api/latest/project",success:function(projects){for(var x in projects){instance.projectNames.push(projects[x].name.toUpperCase())}}})},_bindNameHook:function(e){this._bindHook(e,this.onNameTimeout)},_bindKeyHook:function(e){var el=AJS.$(e.target);el.data("lastValue",el.val());this._bindHook(e,this.onKeyTimeout)},_bindHook:function(e,func){var instance=this,el=AJS.$(e.target),hook;hook=function(){instance._unbindHook(e);func.apply(instance);if(el.is(":visible")){el.data("checkHook",setTimeout(hook,instance.TIMEOUT_MS))}};if(!el.data("checkHook")){el.data("checkHook",setTimeout(hook,0))}},_unbindHook:function(e){var el=AJS.$(e.target);clearTimeout(el.data("checkHook"));el.removeData("checkHook")},shouldUpdateKey:function(){return(this.$keyEditedElement.val()!="true")},setKeyEdited:function(key){if(this.$keyElement.data("lastValue")!==key){this.$keyEditedElement.val((key)?"true":"false")}this.$keyElement.data("lastValue",key)},updateKey:function(key){this.$keyElement.val(key);this.validateKey(key);this.eventBus.trigger("updated.Key",key)},autofillKeyIfNeeded:function(){if(this.shouldUpdateKey()){var key=this.keygen.generateKey(this.$nameElement.val());if(key.length>1){this.updateKey(key)}else{this.$keyElement.val("")}}},onNameTimeout:function(){var name=this.$nameElement.val();this.validateName(name);this.eventBus.trigger("updated.Name",name);this.autofillKeyIfNeeded()},onKeyTimeout:function(){var key=this.$keyElement.val();this.setKeyEdited(key);this.validateKey(key);this.eventBus.trigger("updated.Key",key)},validateName:function(name){if(name==this.initialName&&this.$nameElement.parent().find(".error").size()){return }else{if(name.length>this.maxNameLength){this.showInlineError(this.$nameElement,this.initialName,AJS.format("The project name must not exceed {0} characters in length.",this.maxNameLength));return }var x;for(x in this.projectNames){if(name.toUpperCase()==this.projectNames[x]){this.showInlineError(this.$nameElement,this.initialName,"A project with that name already exists.");return }}}this.hideInlineError(this.$nameElement)},validateKey:function(key){var instance=this;var changed=(instance.lastKeyValidated!==key);this.lastKeyValidated=key;if(!changed){return }if(key){AJS.$.ajax({url:contextPath+"/rest/api/latest/projectvalidate/key?key="+key.toUpperCase(),success:function(errors){if(errors.errors&&errors.errors["projectKey"]){instance.showInlineError(instance.$keyElement,instance.initialKey,errors.errors["projectKey"])}else{instance.hideInlineError(instance.$keyElement)}}})}else{instance.hideInlineError(instance.$keyElement)}},showInlineError:function($element,initialVal,msg){var $initialErrorElement=$element.parent().find(".initial-error");if($element.val()===initialVal&&$initialErrorElement.length){this.showInitialError($element)}else{var $errorElement=$element.parent().find(".error.description");if(!$errorElement.length){$errorElement=AJS.$("<div class='error description'></div>");$element.parent().append($errorElement)}$errorElement.text(msg);$element.parent().find(".description").hide();$initialErrorElement.hide();$errorElement.show()}},hideInlineError:function($element){$element.parent().find(".description").show();$element.parent().find(".error.description").hide()},showInitialError:function($element){var $initialErrorElement=$element.parent().find(".initial-error");if($initialErrorElement.length){$element.parent().find(".description").hide();$element.parent().find(".error.description").hide();$initialErrorElement.show()}}});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){context.find("#add-project-fields").each(function(){new JIRA.CreateProjectField({element:AJS.$(this)})})}});
/* module-key = 'jira.webresources:jira-global', location = '/includes/jira/project/ProjectEditKey.js' */
var ProjectEditKey=Class.extend({init:function($form){this.editKeyText="edit key";this.revertText="revert";this.$link=$form.find("#edit-project-key-toggle");this.$input=$form.find("#project-edit-key");this.initialKey=$form.find("#edit-project-original-key").val();this.$keyEdited=$form.find("#edit-project-key-edited");this.$warning=$form.find("#edit-project-warning-message");if(this.$keyEdited.val()==="true"){this.$warning.show()}},toggle:function(){if(this.$keyEdited.val()==="true"){this.$keyEdited.val("false");this.$link.html(this.editKeyText);this.$input.attr("disabled","disabled");this.$warning.hide();this.$input.val(this.initialKey);this.$input.siblings(".error").remove()}else{this.$keyEdited.val("true");this.$link.html(this.revertText);this.$input.removeAttr("disabled");this.$warning.show()}}});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){context.find("#edit-project-fields").each(function(index,form){var projectEditKey=new ProjectEditKey(AJS.$(form));var $link=AJS.$(form).find("#edit-project-key-toggle");$link.bind("click",function(){projectEditKey.toggle()})})}});
/* module-key = 'jira.webresources:jira-global', location = '/includes/jira/field/templates/createProject.soy' */
// This file was automatically generated from createProject.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.CreateProject == 'undefined') { JIRA.Templates.CreateProject = {}; }


JIRA.Templates.CreateProject.keyHelp = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="project-key-help"><p><b>', soy.$$escapeHtml("What\x27s a project key?"), '</b></p><ul><li>', soy.$$escapeHtml("It prefixes each issue in the project"), '</li><li>', soy.$$escapeHtml("It can be changed, but this is not a trivial task"), '</li></ul></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'jira.webresources:jira-global', location = '/includes/jira/project/templates/projectSample.soy' */
// This file was automatically generated from projectSample.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.CreateProject == 'undefined') { JIRA.Templates.CreateProject = {}; }


JIRA.Templates.CreateProject.projectSample = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message hint sample-project-container"><span class="aui-icon icon-hint"></span><p class="title">', soy.$$escapeHtml("Project preview"), '</p><p>', soy.$$escapeHtml("With the values you\x27ve set, an issue in your project might look like this:"), '</p><div class="aui-panel sample-project"><div class="item-header"><div class="avatar"><img id="project-avatar" alt="" class="project-avatar-48" height="48" src="', soy.$$escapeHtml(opt_data.avatarUrl), '" width="48"/></div><ul class="breadcrumbs"><li><a id="project-name-val">', soy.$$escapeHtml(opt_data.projectName), '</a></li><li><a id="key-val">', soy.$$escapeHtml(opt_data.projectKey), '</a></li></ul><h1 class="item-summary"><a>', (opt_data.issueTitle) ? soy.$$escapeHtml(opt_data.issueTitle) : soy.$$escapeHtml("Example"), '</a></h1><div class="command-bar"></div></div></div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'jira.webresources:jira-global', location = '/includes/jira/dialog/createEditProjectDialog.js' */
JIRA.createEditProjectDialog=function(trigger){return new JIRA.FormDialog({type:"ajax",id:"project-config-project-edit-dialog",trigger:trigger,autoClose:true,stacked:true,width:560})};
/* module-key = 'jira.webresources:key-commands', location = '/includes/jquery/plugins/keyevents/keyevents.js' */
(function(){var NONCHARACTER_KEYS={8:"Backspace",9:"Tab",13:"Return",16:"Shift",17:"Control",18:"Alt",27:"Esc",32:"Spacebar",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",46:"Del"};var MODIFIER_KEYS={16:"Shift",17:"Control",18:"Alt"};var lastModifierKey=0;pipe("keydown",function(event){if(event.which in MODIFIER_KEYS){if(event.which===lastModifierKey){return null}lastModifierKey=event.which}else{lastModifierKey=0}return NONCHARACTER_KEYS[event.which]||null},"aui:keydown");pipe("keypress",function(event){var altGr=(event.altKey&&event.ctrlKey);lastModifierKey=0;switch(event.which){case 0:case 8:case 9:case 27:break;default:if(altGr||(!event.ctrlKey&&!event.metaKey)){return String.fromCharCode(event.which)}}return null},"aui:keypress");pipe("keyup",function(event){if(event.which===lastModifierKey){lastModifierKey=0}return NONCHARACTER_KEYS[event.which]||null},"aui:keyup");function pipe(inType,getKey,outType){var listenerCount=0;jQuery.event.special[outType]={setup:function(){if(listenerCount===0){jQuery(document).bind(inType,dispatchKeyEvent)}listenerCount++},teardown:function(){listenerCount--;if(listenerCount===0){jQuery(document).unbind(inType,dispatchKeyEvent)}}};function dispatchKeyEvent(event){var key=getKey(event);if(key){var $event=new jQuery.Event(outType);$event.key=key;if(outType!=="aui:keypress"){$event.shiftKey=event.shiftKey;$event.ctrlKey=event.ctrlKey;$event.altKey=event.altKey}var target=event.target;var ownerDocument=(target.nodeType===9)?target:target.ownerDocument;if(ownerDocument!==document){$event.target=target;arguments[0]=$event;jQuery.event.trigger($event,arguments,document,true)}else{jQuery(target).trigger($event)}if($event.isDefaultPrevented()){event.preventDefault()}}}}})();
/* module-key = 'jira.webresources:key-commands', location = '/includes/jquery/plugins/shortcuts/shortcuts.js' */
(function(){var SHORTCUTS={};var KEY_STREAM=[];var MAX_LENGTH=0;var resetTimerId=0;var nonCharacterKeyPressed=false;var $document=jQuery(document);jQuery.event.special.shortcut={setup:function(){$document.bind("keydown",keydown);$document.bind("aui:keypress",keypress);$document.bind("keyup",keyup)},teardown:function(){$document.unbind("keydown",keydown);$document.unbind("aui:keypress",keypress);$document.unbind("keyup",keyup)},add:function(config){if(this!==document){throw new TypeError('"shortcut" event handlers must be bound at the document')}if(config.data===undefined){throw new Error('No data argument supplied in call to jQuery.fn.bind("shortcut", '+(config.handler.name||"function")+")")}if(typeof config.data!=="string"){throw new TypeError("Object "+config.data+" is not a string")}if(config.data.length===0){throw new Error("Shortcut sequence must not be empty")}for(var shortcut in SHORTCUTS){if(hasConflict(shortcut,config.data)){console.log('Cannot bind new shortcut "'+config.data+'" due to conflict with existing shortcut "'+shortcut+'"');return }}if(config.data.length>MAX_LENGTH){MAX_LENGTH=config.data.length}SHORTCUTS[config.data]=config.handler},remove:function(config){if(this!==document){throw new TypeError('"shortcut" event handlers must be bound at the document')}delete SHORTCUTS[config.data]}};function keydown(event){if(nonCharacterKeyPressed){resetKeyStream()}nonCharacterKeyPressed=(event.which!==16)}function keypress(event){if(jQuery(event.target).is(":input:not(button[type=button])")){resetKeyStream();return }KEY_STREAM.push(event.key);clearTimeout(resetTimerId);resetTimerId=setTimeout(resetKeyStream,2000);if(KEY_STREAM.length>MAX_LENGTH){KEY_STREAM.shift()}var keyStream=KEY_STREAM.join("");for(var i=0;i<keyStream.length;i++){var shortcut=keyStream.slice(i);if(shortcut in SHORTCUTS){event.preventDefault();event=new jQuery.Event("shortcut");event.data=shortcut;SHORTCUTS[shortcut].call(document,event);KEY_STREAM.length=0;break}}nonCharacterKeyPressed=false}function keyup(){if(nonCharacterKeyPressed){resetKeyStream()}}function resetKeyStream(){KEY_STREAM.length=0}function hasConflict(shortcut1,shortcut2){var len1=shortcut1.length;var len2=shortcut2.length;if(len1===len2){return shortcut1===shortcut2}var i,d;if(len1<len2){i=shortcut2.indexOf(shortcut1);d=len2-len1}else{i=shortcut1.indexOf(shortcut2);d=len1-len2}return i>=0&&i<d}})();
/* module-key = 'jira.webresources:key-commands', location = '/includes/ajs/keyboardshortcut/KeyboardShortcut.js' */
AJS.whenIType=function(shortcut,ctx){return new AJS.KeyboardShortcut(shortcut,ctx)};AJS.disableKeyboardShortcuts=function(){AJS.keyboardShortcutsDisabled=true};AJS.enableKeyboardShortcuts=function(){AJS.keyboardShortcutsDisabled=false};AJS.KeyboardShortcut=function(shortcut,ctx){this._executer=null;this.shortcuts=[shortcut];this._bindShortcut(shortcut,ctx)};AJS.KeyboardShortcut.prototype._bindShortcut=function(shortcut,ctx){if(typeof shortcut!=="string"){throw new TypeError("AJS.KeyboardShortcut expects string; received "+typeof shortcut)}if(/^(?:ctrl|alt|shift|meta)+/i.test(shortcut)){throw new SyntaxError('AJS.KeyboardShortcut cannot bind the shortcut "'+shortcut+'" because it uses a modifier')}var self=this;jQuery(document).bind("shortcut",shortcut,function(event){if(self._executer&&!self._ignoreShortcut(event,shortcut,ctx)){if(AJS.InlineDialog.current){AJS.InlineDialog.current.hide()}self._executer(event);event.preventDefault()}})};AJS.KeyboardShortcut.prototype._ignoreShortcut=function(event,shortcut,ctx){var ignore=false;_.each(AJS.KeyboardShortcut._ignoreConditions,function(condition){if(condition(event,shortcut,ctx)){ignore=true}});return ignore};AJS.KeyboardShortcut.prototype._addShortcutTitle=function(selector){var elem=jQuery(selector);var title=elem.attr("title")||"";var typeStr="Type";var thenStr="then";var orStr="OR";var shortcuts=jQuery.map(this.shortcuts,function(shortcut){return" '"+shortcut.split("").join("' "+thenStr+" '")+"'"});title+=" ( "+typeStr+shortcuts.join(" "+orStr+" ")+" )";elem.attr("title",title)};AJS.KeyboardShortcut.prototype.moveToNextItem=function(selector){this._executer=function(){var index,items=jQuery(selector),focusedElem=jQuery(selector+".focused");if(!this._executer.blurHandler){jQuery(document).one("keypress",function(e){if(e.keyCode===27&&focusedElem){focusedElem.removeClass("focused")}})}if(focusedElem.length===0){focusedElem=jQuery(selector).eq(0)}else{focusedElem.removeClass("focused");index=jQuery.inArray(focusedElem.get(0),items);if(index<items.length-1){index=index+1;focusedElem=items.eq(index)}else{focusedElem.removeClass("focused");focusedElem=jQuery(selector).eq(0)}}if(focusedElem&&focusedElem.length>0){focusedElem.addClass("focused");focusedElem.scrollIntoView();focusedElem.find("a:first").focus()}}};AJS.KeyboardShortcut.prototype.moveToPrevItem=function(selector){this._executer=function(){var index,items=jQuery(selector),focusedElem=jQuery(selector+".focused");if(!this._executer.blurHandler){jQuery(document).one("keypress",function(e){if(e.keyCode===27&&focusedElem){focusedElem.removeClass("focused")}})}if(focusedElem.length===0){focusedElem=jQuery(selector+":last")}else{focusedElem.removeClass("focused");index=jQuery.inArray(focusedElem.get(0),items);if(index>0){index=index-1;focusedElem=items.eq(index)}else{focusedElem.removeClass("focused");focusedElem=jQuery(selector+":last")}}if(focusedElem&&focusedElem.length>0){focusedElem.addClass("focused");focusedElem.scrollIntoView();focusedElem.find("a:first").focus()}}};AJS.KeyboardShortcut.prototype.click=function(selector){this._addShortcutTitle(selector);this._executer=function(){var elem=jQuery(selector).eq(0);if(elem.length>0){elem.click()}}};AJS.KeyboardShortcut.prototype.goTo=function(location){this._executer=function(){window.location.href=contextPath+location}};AJS.KeyboardShortcut.prototype.followLink=function(selector){this._addShortcutTitle(selector);this._executer=function(){var elem=jQuery(selector).eq(0);if(elem.length>0&&(elem.prop("nodeName").toLowerCase()==="a"||elem.prop("nodeName").toLowerCase()==="link")){elem.click();window.location.href=elem.attr("href")}}};AJS.KeyboardShortcut.prototype.moveToAndClick=function(selector){this._addShortcutTitle(selector);this._executer=function(){var elem=jQuery(selector).eq(0);if(elem.length>0){elem.click();elem.scrollIntoView()}}};AJS.KeyboardShortcut.prototype.moveToAndFocus=function(selector){this._addShortcutTitle(selector);this._executer=function(e){var $elem=jQuery(selector).eq(0);if($elem.length>0){$elem.focus();$elem.scrollIntoView();if($elem.is(":input")){e.preventDefault()}}}};AJS.KeyboardShortcut.prototype.evaluate=function(command){if(typeof command!=="function"){command=new Function(command)}command.call(this)};AJS.KeyboardShortcut.prototype.execute=function(func){var self=this;this._executer=function(){if(typeof func!=="function"){func=new Function(func)}func.call(self)}};AJS.KeyboardShortcut.prototype.or=function(shortcut){this.shortcuts.push(shortcut);this._bindShortcut(shortcut);return this};AJS.KeyboardShortcut._ignoreConditions=[];AJS.KeyboardShortcut.addIgnoreCondition=function(func){AJS.KeyboardShortcut._ignoreConditions.push(func)};AJS.KeyboardShortcut.addIgnoreCondition(function(){return AJS.popup.current||AJS.dropDown.current||JIRA.Dialog.current||AJS.keyboardShortcutsDisabled});AJS.KeyboardShortcut.getKeyboardShortcutKeys=function(moduleKey){for(var index in AJS.keys.shortcuts){var shortcut=AJS.keys.shortcuts[index];if(shortcut.moduleKey===moduleKey){return shortcut.keys.toString()}}return null};AJS.$(function(){AJS.keyboardShortcutsDisabled=!AJS.Meta.get("keyboard-shortcuts-enabled")});
/* module-key = 'jira.webresources:key-commands', location = '/includes/jira/keyboardshortcut/initKeyboardShortcuts.js' */
AJS.whenIType.fromJSON=function(json){var activeShortcuts;if(json){activeShortcuts={};jQuery(document).bind("aui:keyup",function(event){var $target=jQuery(event.target);if(event.key==="Esc"&&$target.is(":input:not(button[type='button'])")){var beforeBlurInput=new jQuery.Event("beforeBlurInput");AJS.$(event.target).trigger(beforeBlurInput,[{reason:"escPressed"}]);if(!beforeBlurInput.isDefaultPrevented()){$target.blur()}}});jQuery.each(json,function(){var keys=Function.prototype.call.apply(Array.prototype.concat,this.keys);var shortcut=keys.join("");if(keys.length<shortcut.length){throw new Error("Shortcut sequence ["+keys.join(",")+"] contains invalid keys")}var kbShorctut=activeShortcuts[shortcut]=AJS.whenIType(shortcut,this.context);kbShorctut[this.op](this.param)})}return activeShortcuts};jQuery(function(){if(AJS.keys){AJS.activeShortcuts=AJS.whenIType.fromJSON(AJS.keys.shortcuts)}});
/* module-key = 'jira.webresources:header', location = '/includes/jira/common/header.js' */
JIRA.bind("QuickCreateIssue.sessionComplete",function(e,issues){var html;if(issues&&issues.length===1){html=JIRA.Issue.issueCreatedMessage(issues[0]);JIRA.Messages.showSuccessMsg(html,{closeable:true})}else{html=JIRA.Issue.issueCreatedMessage(issues[issues.length-1]);JIRA.Messages.showSuccessMsg(html,{closeable:true})}});
/* module-key = 'jira.webresources:header', location = '/includes/jira/fragments/menuFragment.js' */
JIRA.FRAGMENTS.menuFragment=function(response){var html=AJS.$("<div class='aui-list' />");var isFirst=true;var listNode;AJS.$(response.sections).each(function(){listNode=AJS.$("<ul class='aui-list-section' />");var listItemNode,linkNode;if(this.id){listNode.attr("id",this.id)}if(this.style){listNode.addClass(this.style)}if(this.items&&this.items.length!=0){if(isFirst){listNode.addClass("first");isFirst=false}if(this.label){html.append(AJS.$("<h5/>").text(this.label))}AJS.$(this.items).each(function(){listItemNode=AJS.$("<li class='aui-list-item' />");if(this.id){listItemNode.attr("id",this.id)}if(this.style){listItemNode.addClass(this.style)}linkNode=AJS.$("<a class='aui-list-item-link' />").attr("href",this.url);if(this.id){linkNode.attr("id",this.id+"_lnk")}if(this.title){linkNode.attr("title",this.title)}if(this.iconUrl){linkNode.addClass("aui-iconised-link").prepend('<img class="icon" src="'+this.iconUrl+'" alt="" />')}if(this.label){linkNode.text(this.label)}listItemNode.append(linkNode);listNode.append(listItemNode)});html.append(listNode)}});listNode.addClass("aui-last");return html};




/* module-key = 'jira.webresources:calendar', location = '/includes/lib/calendar/Calendar.js' */
Calendar=function(firstDayOfWeek,dateStr,onSelected,onClose){this.activeDiv=null;this.currentDateEl=null;this.getDateStatus=null;this.getDateToolTip=null;this.getDateText=null;this.timeout=null;this.onSelected=onSelected||null;this.onClose=onClose||null;this.dragging=false;this.hidden=false;this.minYear=1970;this.maxYear=2050;this.dateFormat=Calendar._TT["DEF_DATE_FORMAT"];this.ttDateFormat=Calendar._TT["TT_DATE_FORMAT"];this.isPopup=true;this.weekNumbers=true;this.firstDayOfWeek=typeof firstDayOfWeek=="number"?firstDayOfWeek:Calendar._FD;this.showsOtherMonths=false;this.dateStr=dateStr;this.ar_days=null;this.showsTime=false;this.time24=true;this.yearStep=2;this.hiliteToday=true;this.multiple=null;this.table=null;this.element=null;this.tbody=null;this.firstdayname=null;this.monthsCombo=null;this.yearsCombo=null;this.hilitedMonth=null;this.activeMonth=null;this.hilitedYear=null;this.activeYear=null;this.dateClicked=false;if(typeof Calendar._SDN=="undefined"){if(typeof Calendar._SDN_len=="undefined"){Calendar._SDN_len=3}var ar=new Array();for(var i=8;i>0;){ar[--i]=Calendar._DN[i].substr(0,Calendar._SDN_len)}Calendar._SDN=ar;if(typeof Calendar._SMN_len=="undefined"){Calendar._SMN_len=3}ar=new Array();for(var i=12;i>0;){ar[--i]=Calendar._MN[i].substr(0,Calendar._SMN_len)}Calendar._SMN=ar}};Calendar._C=null;Calendar.is_ie=(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent));Calendar.is_ie5=(Calendar.is_ie&&/msie 5\.0/i.test(navigator.userAgent));Calendar.is_ie6=(Calendar.is_ie&&/msie 6\.0/i.test(navigator.userAgent));Calendar.is_opera=/opera/i.test(navigator.userAgent);Calendar.is_khtml=/Konqueror|Safari|KHTML/i.test(navigator.userAgent);Calendar.getAbsolutePos=function(el){var coords=jQuery(el).offset();coords.x=coords.left;coords.y=coords.top;return coords};Calendar.isRelated=function(el,evt){var related=evt.relatedTarget;if(!related){var type=evt.type;if(type=="mouseover"){related=evt.fromElement}else{if(type=="mouseout"){related=evt.toElement}}}while(related){if(related==el){return true}related=related.parentNode}return false};Calendar.removeClass=function(el,className){if(!(el&&el.className)){return }var cls=el.className.split(" ");var ar=new Array();for(var i=cls.length;i>0;){if(cls[--i]!=className){ar[ar.length]=cls[i]}}el.className=ar.join(" ")};Calendar.addClass=function(el,className){Calendar.removeClass(el,className);el.className+=" "+className};Calendar.getElement=function(ev){var f=Calendar.is_ie?window.event.srcElement:ev.currentTarget;while(f.nodeType!=1||/^div$/i.test(f.tagName)){f=f.parentNode}return f};Calendar.getTargetElement=function(ev){var f=Calendar.is_ie?window.event.srcElement:ev.target;while(f.nodeType!=1){f=f.parentNode}return f};Calendar.stopEvent=function(ev){if(!ev){ev=window.event}if(ev.stopPropagation){ev.preventDefault();ev.stopPropagation()}else{ev.cancelBubble=true;ev.returnValue=false}return false};Calendar.addEvent=function(el,evname,func){if(el.attachEvent){el.attachEvent("on"+evname,func)}else{if(el.addEventListener){el.addEventListener(evname,func,true)}else{el["on"+evname]=func}}};Calendar.removeEvent=function(el,evname,func){if(el.detachEvent){el.detachEvent("on"+evname,func)}else{if(el.removeEventListener){el.removeEventListener(evname,func,true)}else{el["on"+evname]=null}}};Calendar.createElement=function(type,parent){var el=null;if(document.createElementNS){el=document.createElementNS("http://www.w3.org/1999/xhtml",type)}else{el=document.createElement(type)}if(typeof parent!="undefined"){parent.appendChild(el)}return el};Calendar._add_evs=function(el){with(Calendar){addEvent(el,"mouseover",dayMouseOver);addEvent(el,"mousedown",dayMouseDown);addEvent(el,"mouseout",dayMouseOut);if(is_ie){addEvent(el,"dblclick",dayMouseDblClick);el.setAttribute("unselectable",true)}}};Calendar.findMonth=function(el){if(typeof el.month!="undefined"){return el}else{if(typeof el.parentNode.month!="undefined"){return el.parentNode}}return null};Calendar.findYear=function(el){if(typeof el.year!="undefined"){return el}else{if(typeof el.parentNode.year!="undefined"){return el.parentNode}}return null};Calendar.showMonthsCombo=function(){var cal=Calendar._C;if(!cal){return false}var cal=cal;var cd=cal.activeDiv;var mc=cal.monthsCombo;if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite")}if(cal.activeMonth){Calendar.removeClass(cal.activeMonth,"active")}var mon=cal.monthsCombo.getElementsByTagName("div")[cal.date.getMonth()];Calendar.addClass(mon,"active");cal.activeMonth=mon;var s=mc.style;s.display="block";if(cd.navtype<0){s.left=cd.offsetLeft+"px"}else{var mcw=mc.offsetWidth;if(typeof mcw=="undefined"){mcw=50}s.left=(cd.offsetLeft+cd.offsetWidth-mcw)+"px"}s.top=(cd.offsetTop+cd.offsetHeight)+"px"};Calendar.showYearsCombo=function(fwd){var cal=Calendar._C;if(!cal){return false}var cal=cal;var cd=cal.activeDiv;var yc=cal.yearsCombo;if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite")}if(cal.activeYear){Calendar.removeClass(cal.activeYear,"active")}cal.activeYear=null;var Y=cal.date.getFullYear()+(fwd?1:-1);var yr=yc.firstChild;var show=false;for(var i=12;i>0;--i){if(Y>=cal.minYear&&Y<=cal.maxYear){yr.innerHTML=Y;yr.year=Y;yr.style.display="block";show=true}else{yr.style.display="none"}yr=yr.nextSibling;Y+=fwd?cal.yearStep:-cal.yearStep}if(show){var s=yc.style;s.display="block";if(cd.navtype<0){s.left=cd.offsetLeft+"px"}else{var ycw=yc.offsetWidth;if(typeof ycw=="undefined"){ycw=50}s.left=(cd.offsetLeft+cd.offsetWidth-ycw)+"px"}s.top=(cd.offsetTop+cd.offsetHeight)+"px"}};Calendar.tableMouseUp=function(ev){var cal=Calendar._C;if(!cal){return false}if(cal.timeout){clearTimeout(cal.timeout)}var el=cal.activeDiv;if(!el){return false}var target=Calendar.getTargetElement(ev);ev||(ev=window.event);Calendar.removeClass(el,"active");if(target==el||target.parentNode==el){Calendar.cellClick(el,ev)}var mon=Calendar.findMonth(target);var date=null;if(mon){date=new Date(cal.date);if(mon.month!=date.getMonth()){date.setMonth(mon.month);cal.setDate(date);cal.dateClicked=false;cal.callHandler()}}else{var year=Calendar.findYear(target);if(year){date=new Date(cal.date);if(year.year!=date.getFullYear()){date.setFullYear(year.year);cal.setDate(date);cal.dateClicked=false;cal.callHandler()}}}with(Calendar){removeEvent(document,"mouseup",tableMouseUp);removeEvent(document,"mouseover",tableMouseOver);removeEvent(document,"mousemove",tableMouseOver);cal._hideCombos();_C=null;return stopEvent(ev)}};Calendar.tableMouseOver=function(ev){var cal=Calendar._C;if(!cal){return }var el=cal.activeDiv;var target=Calendar.getTargetElement(ev);if(target==el||target.parentNode==el){Calendar.addClass(el,"hilite active");Calendar.addClass(el.parentNode,"rowhilite")}else{if(typeof el.navtype=="undefined"||(el.navtype!=50&&(el.navtype==0||Math.abs(el.navtype)>2))){Calendar.removeClass(el,"active")}Calendar.removeClass(el,"hilite");Calendar.removeClass(el.parentNode,"rowhilite")}ev||(ev=window.event);if(el.navtype==50&&target!=el){var pos=Calendar.getAbsolutePos(el);var w=el.offsetWidth;var x=ev.clientX;var dx;var decrease=true;if(x>pos.x+w){dx=x-pos.x-w;decrease=false}else{dx=pos.x-x}if(dx<0){dx=0}var range=el._range;var current=el._current;var count=Math.floor(dx/10)%range.length;for(var i=range.length;--i>=0;){if(range[i]==current){break}}while(count-->0){if(decrease){if(--i<0){i=range.length-1}}else{if(++i>=range.length){i=0}}}var newval=range[i];el.innerHTML=newval;cal.onUpdateTime()}var mon=Calendar.findMonth(target);if(mon){if(mon.month!=cal.date.getMonth()){if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite")}Calendar.addClass(mon,"hilite");cal.hilitedMonth=mon}else{if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite")}}}else{if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite")}var year=Calendar.findYear(target);if(year){if(year.year!=cal.date.getFullYear()){if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite")}Calendar.addClass(year,"hilite");cal.hilitedYear=year}else{if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite")}}}else{if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite")}}}return Calendar.stopEvent(ev)};Calendar.tableMouseDown=function(ev){if(Calendar.getTargetElement(ev)==Calendar.getElement(ev)){return Calendar.stopEvent(ev)}};Calendar.calDragIt=function(ev){var cal=Calendar._C;if(!(cal&&cal.dragging)){return false}var posX;var posY;if(Calendar.is_ie){posY=window.event.clientY+document.body.scrollTop;posX=window.event.clientX+document.body.scrollLeft}else{posX=ev.pageX;posY=ev.pageY}var st=cal.element.style;st.left=(posX-cal.xOffs)+"px";st.top=(posY-cal.yOffs)+"px";return Calendar.stopEvent(ev)};Calendar.calDragEnd=function(ev){var cal=Calendar._C;if(!cal){return false}cal.dragging=false;with(Calendar){removeEvent(document,"mousemove",calDragIt);removeEvent(document,"mouseup",calDragEnd);tableMouseUp(ev)}};Calendar.dayMouseDown=function(ev){var el=Calendar.getElement(ev);if(el.disabled){return false}var cal=el.calendar;cal.activeDiv=el;Calendar._C=cal;if(el.navtype!=300){with(Calendar){if(el.navtype==50){el._current=el.innerHTML;addEvent(document,"mousemove",tableMouseOver)}else{addEvent(document,Calendar.is_ie5?"mousemove":"mouseover",tableMouseOver)}addClass(el,"hilite active");addEvent(document,"mouseup",tableMouseUp)}}else{if(cal.isPopup){cal._dragStart(ev)}}if(el.navtype==-1||el.navtype==1){if(cal.timeout){clearTimeout(cal.timeout)}cal.timeout=setTimeout("Calendar.showMonthsCombo()",250)}else{if(el.navtype==-2||el.navtype==2){if(cal.timeout){clearTimeout(cal.timeout)}cal.timeout=setTimeout((el.navtype>0)?"Calendar.showYearsCombo(true)":"Calendar.showYearsCombo(false)",250)}else{cal.timeout=null}}return Calendar.stopEvent(ev)};Calendar.dayMouseDblClick=function(ev){Calendar.cellClick(Calendar.getElement(ev),ev||window.event);if(Calendar.is_ie){document.selection.empty()}};Calendar.dayMouseOver=function(ev){var el=Calendar.getElement(ev);if(Calendar.isRelated(el,ev)||Calendar._C||el.disabled){return false}if(el.ttip){if(el.ttip.substr(0,1)=="_"){el.ttip=el.caldate.print(el.calendar.ttDateFormat)+el.ttip.substr(1)}el.calendar.tooltips.innerHTML=el.ttip}if(el.navtype!=300){Calendar.addClass(el,"hilite");if(el.caldate){Calendar.addClass(el.parentNode,"rowhilite")}}return Calendar.stopEvent(ev)};Calendar.dayMouseOut=function(ev){with(Calendar){var el=getElement(ev);if(isRelated(el,ev)||_C||el.disabled){return false}removeClass(el,"hilite");if(el.caldate){removeClass(el.parentNode,"rowhilite")}if(el.calendar){el.calendar.tooltips.innerHTML=_TT["SEL_DATE"]}return stopEvent(ev)}};Calendar.cellClick=function(el,ev){var cal=el.calendar;var closing=false;var newdate=false;var date=null;if(typeof el.navtype=="undefined"){if(cal.currentDateEl){Calendar.removeClass(cal.currentDateEl,"selected");Calendar.addClass(el,"selected");closing=(cal.currentDateEl==el);if(!closing){cal.currentDateEl=el}}cal.date.setDateOnly(el.caldate);date=cal.date;var other_month=!(cal.dateClicked=!el.otherMonth);if(!other_month&&!cal.currentDateEl){cal._toggleMultipleDate(new Date(date))}else{newdate=!el.disabled}if(other_month){cal._init(cal.firstDayOfWeek,date)}}else{if(el.navtype==200){Calendar.removeClass(el,"hilite");cal.callCloseHandler();return }date=new Date(cal.date);if(el.navtype==0){date.setDateOnly(new Date())}cal.dateClicked=false;var year=date.getFullYear();var mon=date.getMonth();function setMonth(m){var day=date.getDate();var max=date.getMonthDays(m);if(day>max){date.setDate(max)}date.setMonth(m)}switch(el.navtype){case 400:Calendar.removeClass(el,"hilite");var text=Calendar._TT["ABOUT"];if(typeof text!="undefined"){text+=cal.showsTime?Calendar._TT["ABOUT_TIME"]:""}else{text="Help and about box text is not translated into this language.\n"+"If you know this language and you feel generous please update\n"+'the corresponding file in "lang" subdir to match calendar-en.js\n'+"and send it back to <mihai_bazon@yahoo.com> to get it into the distribution  ;-)\n\n"+"Thank you!\n"+"http://dynarch.com/mishoo/calendar.epl\n"}alert(text);return ;case -2:if(year>cal.minYear){date.setFullYear(year-1)}break;case -1:if(mon>0){setMonth(mon-1)}else{if(year-->cal.minYear){date.setFullYear(year);setMonth(11)}}break;case 1:if(mon<11){setMonth(mon+1)}else{if(year<cal.maxYear){date.setFullYear(year+1);setMonth(0)}}break;case 2:if(year<cal.maxYear){date.setFullYear(year+1)}break;case 100:cal.setFirstDayOfWeek(el.fdow);return ;case 50:var range=el._range;var current=el.innerHTML;for(var i=range.length;--i>=0;){if(range[i]==current){break}}if(ev&&ev.shiftKey){if(--i<0){i=range.length-1}}else{if(++i>=range.length){i=0}}var newval=range[i];el.innerHTML=newval;cal.onUpdateTime();return ;case 0:if((typeof cal.getDateStatus=="function")&&cal.getDateStatus(date,date.getFullYear(),date.getMonth(),date.getDate())){return false}break}if(!date.equalsTo(cal.date)){cal.setDate(date);newdate=true}else{if(el.navtype==0){newdate=closing=true}}}if(newdate){ev&&cal.callHandler()}if(closing){Calendar.removeClass(el,"hilite");ev&&cal.callCloseHandler()}};Calendar.prototype.create=function(_par){var parent=null;if(!_par){parent=document.getElementsByTagName("body")[0];this.isPopup=true}else{parent=_par;this.isPopup=false}if(this.dateStr){this.date=new Date(this.dateStr)}if(!this.date||isNaN(this.date)){this.date=new Date()}var table=Calendar.createElement("table");this.table=table;table.cellSpacing=0;table.cellPadding=0;table.calendar=this;Calendar.addEvent(table,"mousedown",Calendar.tableMouseDown);var div=Calendar.createElement("div");this.element=div;div.className="calendar";if(this.isPopup){div.style.position="absolute";div.style.display="none"}div.appendChild(table);var thead=Calendar.createElement("thead",table);var cell=null;var row=null;var cal=this;var hh=function(text,cs,navtype){cell=Calendar.createElement("td",row);cell.colSpan=cs;cell.className="button";if(navtype!=0&&Math.abs(navtype)<=2){cell.className+=" nav"}Calendar._add_evs(cell);cell.calendar=cal;cell.navtype=navtype;cell.innerHTML="<div unselectable='on'>"+text+"</div>";return cell};row=Calendar.createElement("tr",thead);var title_length=6;(this.isPopup)&&--title_length;(this.weekNumbers)&&++title_length;hh("?",1,400).ttip=Calendar._TT["INFO"];this.title=hh("",title_length,300);this.title.className="title";if(this.isPopup){this.title.ttip=Calendar._TT["DRAG_TO_MOVE"];this.title.style.cursor="move";hh("&#x00d7;",1,200).ttip=Calendar._TT["CLOSE"]}row=Calendar.createElement("tr",thead);row.className="headrow";this._nav_py=hh("&#x00ab;",1,-2);this._nav_py.ttip=Calendar._TT["PREV_YEAR"];this._nav_pm=hh("&#x2039;",1,-1);this._nav_pm.ttip=Calendar._TT["PREV_MONTH"];this._nav_now=hh(Calendar._TT["TODAY"],this.weekNumbers?4:3,0);this._nav_now.ttip=Calendar._TT["GO_TODAY"];this._nav_nm=hh("&#x203a;",1,1);this._nav_nm.ttip=Calendar._TT["NEXT_MONTH"];this._nav_ny=hh("&#x00bb;",1,2);this._nav_ny.ttip=Calendar._TT["NEXT_YEAR"];row=Calendar.createElement("tr",thead);row.className="daynames";if(this.weekNumbers){cell=Calendar.createElement("td",row);cell.className="name wn";cell.innerHTML=Calendar._TT["WK"]}for(var i=7;i>0;--i){cell=Calendar.createElement("td",row);if(!i){cell.navtype=100;cell.calendar=this;Calendar._add_evs(cell)}}this.firstdayname=(this.weekNumbers)?row.firstChild.nextSibling:row.firstChild;this._displayWeekdays();var tbody=Calendar.createElement("tbody",table);this.tbody=tbody;for(i=6;i>0;--i){row=Calendar.createElement("tr",tbody);if(this.weekNumbers){cell=Calendar.createElement("td",row)}for(var j=7;j>0;--j){cell=Calendar.createElement("td",row);cell.calendar=this;Calendar._add_evs(cell)}}if(this.showsTime){row=Calendar.createElement("tr",tbody);row.className="time";cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=2;cell.innerHTML=Calendar._TT["TIME"]||"&nbsp;";cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=this.weekNumbers?4:3;(function(){function makeTimePart(className,init,range_start,range_end){var part=Calendar.createElement("span",cell);part.className=className;part.innerHTML=init;part.calendar=cal;part.ttip=Calendar._TT["TIME_PART"];part.navtype=50;part._range=[];if(typeof range_start!="number"){part._range=range_start}else{for(var i=range_start;i<=range_end;++i){var txt;if(i<10&&range_end>=10){txt="0"+i}else{txt=""+i}part._range[part._range.length]=txt}}Calendar._add_evs(part);return part}var hrs=cal.date.getHours();var mins=cal.date.getMinutes();var t12=!cal.time24;var pm=(hrs>12);if(t12&&pm){hrs-=12}var H=makeTimePart("hour",hrs,t12?1:0,t12?12:23);var span=Calendar.createElement("span",cell);span.innerHTML=":";span.className="colon";var M=makeTimePart("minute",mins,0,59);var AP=null;cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=2;if(t12){AP=makeTimePart("ampm",pm?Calendar._TT["PM"]:Calendar._TT["AM"],[Calendar._TT["am"],Calendar._TT["pm"]])}else{cell.innerHTML="&nbsp;"}cal.onSetTime=function(){var pm,hrs=this.date.getHours(),mins=this.date.getMinutes();if(t12){pm=(hrs>=12);if(pm){hrs-=12}if(hrs==0){hrs=12}AP.innerHTML=pm?Calendar._TT["pm"]:Calendar._TT["am"]}H.innerHTML=(hrs<10)?("0"+hrs):hrs;M.innerHTML=(mins<10)?("0"+mins):mins};cal.onUpdateTime=function(){var date=this.date;var h=parseInt(H.innerHTML,10);if(t12){if(new RegExp(Calendar._TT["pm"],"i").test(AP.innerHTML)&&h<12){h+=12}else{if(new RegExp(Calendar._TT["am"],"i").test(AP.innerHTML)&&h==12){h=0}}}var d=date.getDate();var m=date.getMonth();var y=date.getFullYear();date.setHours(h);date.setMinutes(parseInt(M.innerHTML,10));date.setFullYear(y);date.setMonth(m);date.setDate(d);this.dateClicked=false;this.callHandler()}})()}else{this.onSetTime=this.onUpdateTime=function(){}}var tfoot=Calendar.createElement("tfoot",table);row=Calendar.createElement("tr",tfoot);row.className="footrow";cell=hh(Calendar._TT["SEL_DATE"],this.weekNumbers?8:7,300);cell.className="ttip";if(this.isPopup){cell.ttip=Calendar._TT["DRAG_TO_MOVE"];cell.style.cursor="move"}this.tooltips=cell;div=Calendar.createElement("div",this.element);this.monthsCombo=div;div.className="combo";for(i=0;i<Calendar._MN.length;++i){var mn=Calendar.createElement("div");mn.className=Calendar.is_ie?"label-IEfix":"label";mn.month=i;mn.innerHTML=Calendar._SMN[i];div.appendChild(mn)}div=Calendar.createElement("div",this.element);this.yearsCombo=div;div.className="combo";for(i=12;i>0;--i){var yr=Calendar.createElement("div");yr.className=Calendar.is_ie?"label-IEfix":"label";div.appendChild(yr)}this._init(this.firstDayOfWeek,this.date);parent.appendChild(this.element);Calendar.addEvent(this.element,"mousedown",function(ev){ev.preventDefault?ev.preventDefault():ev.returnValue=false})};Calendar._upkeyEvent=function(e){if(e.keyCode===27){window.setTimeout(function(){var cal=window._dynarch_popupCalendar;if(!cal||cal.multiple){return false}else{cal.callCloseHandler()}},0)}};Calendar._keyEvent=function(ev){var cal=window._dynarch_popupCalendar;if(!cal||cal.multiple){return false}var act=(Calendar.is_ie||ev.type=="keydown"),K=ev.keyCode;if(ev.ctrlKey){switch(K){case 37:act&&Calendar.cellClick(cal._nav_pm);break;case 38:act&&Calendar.cellClick(cal._nav_py);break;case 39:act&&Calendar.cellClick(cal._nav_nm);break;case 40:act&&Calendar.cellClick(cal._nav_ny);break}}else{switch(K){case 32:Calendar.cellClick(cal._nav_now);break;case 37:case 38:case 39:case 40:if(act){var prev,x,y,ne,el,step;prev=K==37||K==38;step=(K==37||K==39)?1:7;function setVars(){el=cal.currentDateEl;var p=el.pos;x=p&15;y=p>>4;ne=cal.ar_days[y][x]}setVars();function prevMonth(){var date=new Date(cal.date);date.setDate(date.getDate()-step);cal.setDate(date)}function nextMonth(){var date=new Date(cal.date);date.setDate(date.getDate()+step);cal.setDate(date)}while(1){switch(K){case 37:if(--x>=0){ne=cal.ar_days[y][x]}else{x=6;K=38;continue}break;case 38:if(--y>=0){ne=cal.ar_days[y][x]}else{prevMonth();setVars()}break;case 39:if(++x<7){ne=cal.ar_days[y][x]}else{x=0;K=40;continue}break;case 40:if(++y<cal.ar_days.length){ne=cal.ar_days[y][x]}else{nextMonth();setVars()}break}break}if(ne){if(!ne.disabled){Calendar.cellClick(ne)}else{if(prev){prevMonth()}else{nextMonth()}}}}break;case 13:if(act){Calendar.cellClick(cal.currentDateEl,ev)}break}}return Calendar.stopEvent(ev)};Calendar.prototype._init=function(firstDayOfWeek,date){var today=new Date(),TY=today.getFullYear(),TM=today.getMonth(),TD=today.getDate();this.table.style.visibility="hidden";var year=date.getFullYear();if(year<this.minYear){year=this.minYear;date.setFullYear(year)}else{if(year>this.maxYear){year=this.maxYear;date.setFullYear(year)}}this.firstDayOfWeek=firstDayOfWeek;this.date=new Date(date);var month=date.getMonth();var mday=date.getDate();var no_days=date.getMonthDays();date.setDate(1);var day1=(date.getDay()-this.firstDayOfWeek)%7;if(day1<0){day1+=7}date.setDate(-day1);date.setDate(date.getDate()+1);var row=this.tbody.firstChild;var MN=Calendar._SMN[month];var ar_days=this.ar_days=new Array();var weekend=Calendar._TT["WEEKEND"];var dates=this.multiple?(this.datesCells={}):null;for(var i=0;i<6;++i,row=row.nextSibling){var cell=row.firstChild;if(this.weekNumbers){cell.className="day wn";var monthStartDate=date;if(month==0&&i==0&&Date.useISO8601WeekNumbers==false){monthStartDate=new Date(year,month,1)}cell.innerHTML=monthStartDate.getWeekNumber(this.firstDayOfWeek);cell=cell.nextSibling}row.className="daysrow";var hasdays=false,iday,dpos=ar_days[i]=[];for(var j=0;j<7;++j,cell=cell.nextSibling,date.setDate(iday+1)){iday=date.getDate();var wday=date.getDay();cell.className="day day-"+iday;cell.pos=i<<4|j;dpos[j]=cell;var current_month=(date.getMonth()==month);if(!current_month){if(this.showsOtherMonths){cell.className+=" othermonth";cell.otherMonth=true}else{cell.className="emptycell";cell.innerHTML="&nbsp;";cell.disabled=true;continue}}else{cell.otherMonth=false;hasdays=true}cell.disabled=false;cell.innerHTML=this.getDateText?this.getDateText(date,iday):iday;if(dates){dates[date.print("%Y%m%d")]=cell}if(this.getDateStatus){var status=this.getDateStatus(date,year,month,iday);if(this.getDateToolTip){var toolTip=this.getDateToolTip(date,year,month,iday);if(toolTip){cell.title=toolTip}}if(status===true){cell.className+=" disabled";cell.disabled=true}else{if(/disabled/i.test(status)){cell.disabled=true}cell.className+=" "+status}}if(!cell.disabled){cell.caldate=new Date(date);cell.ttip="_";if(!this.multiple&&current_month&&iday==mday&&this.hiliteToday){cell.className+=" selected";this.currentDateEl=cell}if(date.getFullYear()==TY&&date.getMonth()==TM&&iday==TD){cell.className+=" today";cell.ttip+=Calendar._TT["PART_TODAY"]}if(weekend.indexOf(wday.toString())!=-1){cell.className+=cell.otherMonth?" oweekend":" weekend"}}}if(!(hasdays||this.showsOtherMonths)){row.className="emptyrow"}}this.title.innerHTML=Calendar._MN[month]+", "+year;this.onSetTime();this.table.style.visibility="visible";this._initMultipleDates()};Calendar.prototype._initMultipleDates=function(){if(this.multiple){for(var i in this.multiple){var cell=this.datesCells[i];var d=this.multiple[i];if(!d){continue}if(cell){cell.className+=" selected"}}}};Calendar.prototype._toggleMultipleDate=function(date){if(this.multiple){var ds=date.print("%Y%m%d");var cell=this.datesCells[ds];if(cell){var d=this.multiple[ds];if(!d){Calendar.addClass(cell,"selected");this.multiple[ds]=date}else{Calendar.removeClass(cell,"selected");delete this.multiple[ds]}}}};Calendar.prototype.setDateToolTipHandler=function(unaryFunction){this.getDateToolTip=unaryFunction};Calendar.prototype.setDate=function(date){if(!date.equalsTo(this.date)){this._init(this.firstDayOfWeek,date)}};Calendar.prototype.refresh=function(){this._init(this.firstDayOfWeek,this.date)};Calendar.prototype.setFirstDayOfWeek=function(firstDayOfWeek){this._init(firstDayOfWeek,this.date);this._displayWeekdays()};Calendar.prototype.setDateStatusHandler=Calendar.prototype.setDisabledHandler=function(unaryFunction){this.getDateStatus=unaryFunction};Calendar.prototype.setRange=function(a,z){this.minYear=a;this.maxYear=z};Calendar.prototype.callHandler=function(){if(this.onSelected){this.onSelected(this,this.date.print(this.dateFormat))}};Calendar.prototype.callCloseHandler=function(){if(this.onClose){this.onClose(this)}};Calendar.prototype.destroy=function(){var el=this.element.parentNode;el.removeChild(this.element);Calendar._C=null;window._dynarch_popupCalendar=null};Calendar.prototype.reparent=function(new_parent){var el=this.element;el.parentNode.removeChild(el);new_parent.appendChild(el)};Calendar._checkCalendar=function(ev){var calendar=window._dynarch_popupCalendar;if(!calendar){return false}var el=Calendar.is_ie?Calendar.getElement(ev):Calendar.getTargetElement(ev);for(;el!=null&&el!=calendar.element;el=el.parentNode){}if(el==null){window._dynarch_popupCalendar.callCloseHandler();return Calendar.stopEvent(ev)}};Calendar.prototype.show=function(){if(this.params.inputField.disabled){return }var rows=this.table.getElementsByTagName("tr");for(var i=rows.length;i>0;){var row=rows[--i];Calendar.removeClass(row,"rowhilite");var cells=row.getElementsByTagName("td");for(var j=cells.length;j>0;){var cell=cells[--j];Calendar.removeClass(cell,"hilite");Calendar.removeClass(cell,"active")}}Calendar.current=this;this.element.style.display="block";this.element.className+=" active";this.hidden=false;if(this.isPopup){window._dynarch_popupCalendar=this;Calendar.addEvent(document,"keyup",Calendar._upkeyEvent);Calendar.addEvent(document,"keydown",Calendar._keyEvent);Calendar.addEvent(document,"mousedown",Calendar._checkCalendar)}};Calendar.prototype.hide=function(){if(this.isPopup){Calendar.removeEvent(document,"keyup",Calendar._upkeyEvent);Calendar.removeEvent(document,"keydown",Calendar._keyEvent);Calendar.removeEvent(document,"mousedown",Calendar._checkCalendar)}Calendar.current=null;this.element.style.display="none";this.element.className=this.element.className.replace(/active/gi,"");this.hidden=true};Calendar.prototype.showAt=function(x,y){var s=this.element.style;s.left=x+"px";s.top=y+"px";this.show()};Calendar.prototype.showAtElement=function(el,opts){var self=this;var p=Calendar.getAbsolutePos(el);if(!opts||typeof opts!="string"){this.showAt(p.x,p.y+el.offsetHeight);return true}function fixPosition(box){if(box.x<0){box.x=0}if(box.y<0){box.y=0}var cp=document.createElement("div");var s=cp.style;s.position="absolute";s.right=s.bottom=s.width=s.height="0px";document.body.appendChild(cp);var br=Calendar.getAbsolutePos(cp);document.body.removeChild(cp);br.y+=jQuery(window).scrollTop();br.x+=jQuery(window).scrollLeft();var tmp=box.x+box.width-br.x;if(tmp>0){box.x-=tmp}tmp=box.y+box.height-br.y;if(tmp>0){box.y-=tmp}}this.element.style.display="block";Calendar.continuation_for_the_khtml_browser=function(){var w=jQuery(self.element).outerWidth();var h=jQuery(self.element).outerHeight();self.element.style.display="none";var valign=opts.substr(0,1);var halign="l";if(opts.length>1){halign=opts.substr(1,1)}switch(valign){case"T":p.y-=h;break;case"B":p.y+=jQuery(el).outerHeight();break;case"C":p.y+=(jQuery(el).outerHeight()-h)/2;break;case"t":p.y+=jQuery(el).outerHeight()-h;break;case"b":break}switch(halign){case"L":p.x-=w;break;case"R":p.x+=jQuery(el).outerWidth();break;case"C":p.x+=(jQuery(el).outerWidth()-w)/2;break;case"l":p.x+=jQuery(el).outerWidth()-w;break;case"r":break}p.width=w;p.height=h+40;self.monthsCombo.style.display="none";fixPosition(p);self.showAt(p.x,p.y)};Calendar.continuation_for_the_khtml_browser()};Calendar.prototype.setDateFormat=function(str){this.dateFormat=str};Calendar.prototype.setTtDateFormat=function(str){this.ttDateFormat=str};Calendar.prototype.parseDate=function(str,fmt){if(!fmt){fmt=this.dateFormat}this.setDate(Date.parseDate(str,fmt))};Calendar.prototype._displayWeekdays=function(){var fdow=this.firstDayOfWeek;var cell=this.firstdayname;var weekend=Calendar._TT["WEEKEND"];for(var i=0;i<7;++i){cell.className="day name";var realday=(i+fdow)%7;if(i){cell.ttip=Calendar._TT["DAY_FIRST"].replace("%s",Calendar._DN[realday]);cell.navtype=100;cell.calendar=this;cell.fdow=realday;Calendar._add_evs(cell)}if(weekend.indexOf(realday.toString())!=-1){Calendar.addClass(cell,"weekend")}cell.innerHTML=Calendar._SDN[(i+fdow)%7];cell=cell.nextSibling}};Calendar.prototype._hideCombos=function(){this.monthsCombo.style.display="none";this.yearsCombo.style.display="none"};Calendar.prototype._dragStart=function(ev){if(this.dragging){return }this.dragging=true;var posX;var posY;if(Calendar.is_ie){posY=window.event.clientY+document.body.scrollTop;posX=window.event.clientX+document.body.scrollLeft}else{posY=ev.clientY+window.scrollY;posX=ev.clientX+window.scrollX}var st=this.element.style;this.xOffs=posX-parseInt(st.left);this.yOffs=posY-parseInt(st.top);with(Calendar){addEvent(document,"mousemove",calDragIt);addEvent(document,"mouseup",calDragEnd)}};Date._MD=new Array(31,28,31,30,31,30,31,31,30,31,30,31);Date.SECOND=1000;Date.MINUTE=60*Date.SECOND;Date.HOUR=60*Date.MINUTE;Date.DAY=24*Date.HOUR;Date.WEEK=7*Date.DAY;Date._multisplit=function(s,seps){if(s==null){return null}if(seps==null){seps=""}var arr=[];var len=s.length;var token="";var inWord=false;for(i=0;i<len;i++){var c=s.charAt(i);if(seps.indexOf(c)==-1){inWord=true;token+=c}else{if(inWord){arr[arr.length]=token;token="";inWord=false}}}if(token.length>0){arr[arr.length]=token}if(arr.length==0){arr[arr.length]=""}return arr};Date._parseNonDateFormatChars=function(s){var magicChars="aAbBCdeHIJklmMnpPRSstUWVuwyY%";var nonMagicChars="";var len=s.length;var inMagic=false;for(i=0;i<len;i++){var c=s.charAt(i);if(c=="%"){var peekc="";if(i+1<len){peekc=s.charAt(i+1)}i=i+1;if(peekc.length>0&&magicChars.indexOf(peekc)!=-1){continue}else{if(nonMagicChars.indexOf(c)==-1){nonMagicChars+=c}if(peekc.length>0&&nonMagicChars.indexOf(peekc)==-1){nonMagicChars+=peekc}}}else{if(nonMagicChars.indexOf(c)==-1){nonMagicChars+=c}}}return nonMagicChars};Date.parseDate=function(str,fmt){var today=new Date();var y=0;var m=-1;var d=0;var seps=Date._parseNonDateFormatChars(fmt);var a=Date._multisplit(str,seps);var b=fmt.match(/%./g);var i=0,j=0;var hr=0;var min=0;for(i=0;i<a.length;++i){if(!a[i]){continue}switch(b[i]){case"%d":case"%e":d=parseInt(a[i],10);break;case"%m":m=parseInt(a[i],10)-1;break;case"%Y":case"%y":y=parseInt(a[i],10);(y<100)&&(y+=(y>29)?1900:2000);break;case"%b":case"%B":var monthName=a[i].toLowerCase();var found=false;if(b[i]=="%b"){for(j=0;j<12;++j){if(Calendar._SMN[j].substr(0,monthName.length).toLowerCase()==monthName){m=j;found=true;break}}}if(!found){for(j=0;j<12;++j){if(Calendar._MN[j].substr(0,monthName.length).toLowerCase()==monthName){m=j;break}}}break;case"%H":case"%I":case"%k":case"%l":hr=parseInt(a[i],10);break;case"%P":case"%p":if(/pm/i.test(a[i])&&hr<12){hr+=12}else{if(/am/i.test(a[i])&&hr>=12){hr-=12}}break;case"%M":min=parseInt(a[i],10);break;case"%R":var hrMinString=a[i];var hrMinSeparator=hrMinString.indexOf(":");var hrString=hrMinString.substring(0,hrMinSeparator);var minString=hrMinSeparator==-1?0:hrMinString.substring(hrMinSeparator+1);hr=parseInt(hrString,10);min=parseInt(minString,10);break}}if(isNaN(y)){y=today.getFullYear()}if(isNaN(m)){m=today.getMonth()}if(isNaN(d)){d=today.getDate()}if(isNaN(hr)){hr=today.getHours()}if(isNaN(min)){min=today.getMinutes()}if(y!=0&&m!=-1&&d!=0){return new Date(y,m,d,hr,min,0)}y=0;m=-1;d=0;for(i=0;i<a.length;++i){if(a[i].search(/[a-zA-Z]+/)!=-1){var t=-1;for(j=0;j<12;++j){if(Calendar._MN[j].substr(0,a[i].length).toLowerCase()==a[i].toLowerCase()){t=j;break}}if(t!=-1){if(m!=-1){d=m+1}m=t}}else{if(parseInt(a[i],10)<=12&&m==-1){m=a[i]-1}else{if(parseInt(a[i],10)>31&&y==0){y=parseInt(a[i],10);(y<100)&&(y+=(y>29)?1900:2000)}else{if(d==0){d=a[i]}}}}}if(y==0){y=today.getFullYear()}if(m!=-1&&d!=0){return new Date(y,m,d,hr,min,0)}return today};Date.prototype.getMonthDays=function(month){var year=this.getFullYear();if(typeof month=="undefined"){month=this.getMonth()}if(((0==(year%4))&&((0!=(year%100))||(0==(year%400))))&&month==1){return 29}else{return Date._MD[month]}};Date.prototype.getDayOfYear=function(){var now=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0);var then=new Date(this.getFullYear(),0,0,0,0,0);var time=now-then;return Math.floor(time/Date.DAY)};Date.prototype.getWeekNumber=function(startOfWeek){if(Date.useISO8601WeekNumbers){return this.getISO8601WeekNumber()}else{return this.getSimpleWeekNumber(startOfWeek)}};Date.prototype.getISO8601WeekNumber=function(){function gregdaynumber(year,month,day){y=year;m=month;if(month<3){y=y-1}if(month<3){m=m+12}return Math.floor(365.25*y)-Math.floor(y/100)+Math.floor(y/400)+Math.floor(30.6*(m+1))+day-62}function isocalendar1(date){year=date.getFullYear();month=date.getMonth();day=date.getDate();wday=date.getDay();weekday=((wday+6)%7)+1;isoyear=year;d0=gregdaynumber(year,1,0);weekday0=((d0+4)%7)+1;d=gregdaynumber(year,month+1,day);isoweeknr=Math.floor((d-d0+weekday0+6)/7)-Math.floor((weekday0+3)/7);if((month==11)&&((day-weekday)>27)){isoweeknr=1;isoyear=isoyear+1}if((month==0)&&((weekday-day)>3)){d0=gregdaynumber(year-1,1,0);weekday0=((d0+4)%7)+1;isoweeknr=Math.floor((d-d0+weekday0+6)/7)-Math.floor((weekday0+3)/7);isoyear=isoyear-1}return isoweeknr}return isocalendar1(this)};Date.prototype.getSimpleWeekNumber=function(startOfWeek){function OddWkNo1(D,d1,d2){var Yr=D.getFullYear(),Jan1=new Date(Yr,0,1),Q;Q=Math.round((D-Jan1)/86400000);if(d1!=null){Q-=(7+d1-Jan1.getDay())%7}if(d2!=null){Q+=d2}return[Yr,1+Q/7|0,1+(7+Q)%7]}return OddWkNo1(this,startOfWeek?startOfWeek:6,6)[1]};Date.prototype.equalsTo=function(date){return((this.getFullYear()==date.getFullYear())&&(this.getMonth()==date.getMonth())&&(this.getDate()==date.getDate())&&(this.getHours()==date.getHours())&&(this.getMinutes()==date.getMinutes()))};Date.prototype.setDateOnly=function(date){var tmp=new Date(date);this.setDate(1);this.setFullYear(tmp.getFullYear());this.setMonth(tmp.getMonth());this.setDate(tmp.getDate())};Date.prototype.print=function(str){var m=this.getMonth();var d=this.getDate();var y=this.getFullYear();var wn=this.getWeekNumber();var w=this.getDay();var s={};var hr=this.getHours();var pm=(hr>=12);var ir=(pm)?(hr-12):hr;var dy=this.getDayOfYear();if(ir==0){ir=12}var min=this.getMinutes();var sec=this.getSeconds();s["%a"]=Calendar._SDN[w];s["%A"]=Calendar._DN[w];s["%b"]=Calendar._SMN[m];s["%B"]=Calendar._MN[m];s["%C"]=1+Math.floor(y/100);s["%d"]=(d<10)?("0"+d):d;s["%e"]=d;s["%H"]=(hr<10)?("0"+hr):hr;s["%I"]=(ir<10)?("0"+ir):ir;s["%j"]=(dy<100)?((dy<10)?("00"+dy):("0"+dy)):dy;s["%k"]=hr;s["%l"]=ir;s["%m"]=(m<9)?("0"+(1+m)):(1+m);s["%M"]=(min<10)?("0"+min):min;s["%n"]="\n";s["%p"]=pm?Calendar._TT["PM"]:Calendar._TT["AM"];s["%P"]=pm?Calendar._TT["PM"]:Calendar._TT["AM"];s["%R"]=s["%k"]+":"+s["%M"];s["%s"]=Math.floor(this.getTime()/1000);s["%S"]=(sec<10)?("0"+sec):sec;s["%t"]="\t";s["%U"]=s["%W"]=s["%V"]=(wn<10)?("0"+wn):wn;s["%u"]=w+1;s["%w"]=w;s["%y"]=(""+y).slice(-2);s["%Y"]=y;s["%%"]="%";var re=/%./g;if(!Calendar.is_ie5&&!Calendar.is_khtml){return str.replace(re,function(par){return s[par]||par})}var a=str.match(re);for(var i=0;i<a.length;i++){var tmp=s[a[i]];if(tmp){re=new RegExp(a[i],"g");str=str.replace(re,tmp)}}return str};Date.prototype.__msh_oldSetFullYear=Date.prototype.setFullYear;Date.prototype.setFullYear=function(y){var d=new Date(this);d.__msh_oldSetFullYear(y);if(d.getMonth()!=this.getMonth()){this.setDate(28)}this.__msh_oldSetFullYear(y)};window._dynarch_popupCalendar=null;
/* module-key = 'jira.webresources:calendar', location = '/includes/lib/calendar/Calendar.setup.js' */
Calendar.setup=function(params){function param_default(pname,def){if(typeof params[pname]=="undefined"){params[pname]=def}}param_default("inputField",null);param_default("context",null);param_default("displayArea",null);param_default("button",null);param_default("eventName","click");param_default("ifFormat","%Y/%m/%d");param_default("daFormat","%Y/%m/%d");param_default("singleClick",true);param_default("disableFunc",null);param_default("dateStatusFunc",params["disableFunc"]);param_default("dateText",null);param_default("firstDay",null);param_default("align","Br");param_default("range",[1900,2999]);param_default("weekNumbers",true);param_default("useISO8601WeekNumbers",false);param_default("flat",null);param_default("flatCallback",null);param_default("onSelect",null);param_default("onClose",null);param_default("onUpdate",null);param_default("date",null);param_default("showsTime",false);param_default("timeFormat","24");param_default("electric",true);param_default("step",1);param_default("position",null);param_default("cache",false);param_default("showOthers",false);param_default("multiple",null);var tmp=["inputField","displayArea","button"];for(var i in tmp){if(typeof params[tmp[i]]=="string"){var id="#"+params[tmp[i]].escapejQuerySelector();if(params.context){params[tmp[i]]=AJS.$(params.context).find(id).get(0)}else{params[tmp[i]]=AJS.$(id).get(0)}}}if(!(params.flat||params.multiple||params.inputField||params.displayArea||params.button)){AJS.log("Calendar.setup:\n  Nothing to setup (no fields found).  Please check your code");return false}if(params.firstDay&&params.firstDay!==null){params.firstDay=+params.firstDay}function onSelect(cal){var p=cal.params;var update=(cal.dateClicked||p.electric);if(update&&p.inputField){p.inputField.value=cal.date.print(p.ifFormat);jQuery(p.inputField).change()}if(update&&p.displayArea){p.displayArea.innerHTML=cal.date.print(p.daFormat)}if(update&&typeof p.onUpdate=="function"){p.onUpdate(cal)}if(update&&p.flat){if(typeof p.flatCallback=="function"){p.flatCallback(cal)}}if(p.singleClick==="true"){p.singleClick=true}else{if(p.singleClick==="false"){p.singleClick=false}}if(update&&p.singleClick&&cal.dateClicked){cal.callCloseHandler()}}if(params.flat!=null){if(typeof params.flat=="string"){params.flat=document.getElementById(params.flat)}if(!params.flat){AJS.log("Calendar.setup:\n  Flat specified but can't find parent.");return false}var cal=new Calendar(params.firstDay,params.date,params.onSelect||onSelect);cal.showsOtherMonths=params.showOthers;cal.showsTime=params.showsTime;cal.time24=(params.timeFormat=="24");cal.params=params;cal.weekNumbers=params.weekNumbers;cal.setRange(params.range[0],params.range[1]);cal.setDateStatusHandler(params.dateStatusFunc);cal.getDateText=params.dateText;if(params.ifFormat){cal.setDateFormat(params.ifFormat)}if(params.inputField&&typeof params.inputField.value=="string"){cal.parseDate(params.inputField.value)}cal.create(params.flat);cal.show();return false}var triggerEl=params.button||params.displayArea||params.inputField;jQuery(triggerEl).bind(params.eventName,function(e){e.preventDefault();createCalendar()});if(params.inputField){enhanceInputField()}function createCalendar(){if(Calendar._UNSUPPORTED===true){alert("The JIRA Calendar does not currently support your language.");return }var dateEl=params.inputField||params.displayArea;var dateFmt=params.inputField?params.ifFormat:params.daFormat;var mustCreate=false;var cal=window.calendar;if(cal){cal.hide()}if(dateEl){if(dateEl.value||dateEl.innerHTML){params.date=Date.parseDate(dateEl.value||dateEl.innerHTML,dateFmt)}}if(!(cal&&params.cache)){window.calendar=cal=new Calendar(params.firstDay,params.date,params.onSelect||onSelect,params.onClose||function(cal){cal.hide()});cal.showsTime=params.showsTime;cal.time24=(params.timeFormat=="24");cal.weekNumbers=params.weekNumbers;Date.useISO8601WeekNumbers=params.useISO8601WeekNumbers;if(params.useISO8601WeekNumbers){cal.firstDayOfWeek=1}mustCreate=true}else{if(params.date){cal.setDate(params.date)}cal.hide()}if(params.multiple){cal.multiple={};for(var i=params.multiple.length;--i>=0;){var d=params.multiple[i];var ds=d.print("%Y%m%d");cal.multiple[ds]=d}}cal.showsOtherMonths=params.showOthers;cal.yearStep=params.step;cal.setRange(params.range[0],params.range[1]);cal.params=params;cal.setDateStatusHandler(params.dateStatusFunc);cal.getDateText=params.dateText;cal.setDateFormat(dateFmt);if(mustCreate){cal.create()}cal.refresh();if(!params.position){cal.showAtElement(params.button||params.displayArea||params.inputField,params.align)}else{cal.showAt(params.position[0],params.position[1])}return false}function enhanceInputField(){var $inputField=jQuery(params.inputField);if(params.button){jQuery(params.button).mousedown(function(e){e.preventDefault();if(!$inputField.is(":focus")&&$inputField.is(":enabled")){$inputField.focus()}})}$inputField.keydown(function(e){var cal=window.calendar;if(e.keyCode===40){if(!cal||cal.hidden){setTimeout(function(){createCalendar()},1)}}})}return cal};
/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/dropdown/Dropdown.js' */
JIRA.Dropdown=function(){var instances=[];return{addInstance:function(){instances.push(this)},hideInstances:function(){var that=this;jQuery(instances).each(function(){if(that!==this){this.hideDropdown()}})},getHash:function(){if(!this.hash){this.hash={container:this.dropdown,hide:this.hideDropdown,show:this.displayDropdown}}return this.hash},displayDropdown:function(){if(JIRA.Dropdown.current===this){return }this.hideInstances();JIRA.Dropdown.current=this;this.dropdown.css({display:"block"});this.displayed=true;var dd=this.dropdown;if(window.top.JIRA&&!window.top.JIRA.Dialog.current){setTimeout(function(){var win=jQuery(window);var minScrollTop=dd.offset().top+dd.prop("offsetHeight")-win.height()+10;if(win.scrollTop()<minScrollTop){jQuery("html,body").animate({scrollTop:minScrollTop},300,"linear")}},100)}},hideDropdown:function(){if(this.displayed===false){return }JIRA.Dropdown.current=null;this.dropdown.css({display:"none"});this.displayed=false},init:function(trigger,dropdown){var that=this;this.addInstance(this);this.dropdown=jQuery(dropdown);this.dropdown.css({display:"none"});jQuery(document).keydown(function(e){if(e.keyCode===9){that.hideDropdown()}});if(trigger.target){jQuery.aop.before(trigger,function(){if(!that.displayed){that.displayDropdown()}})}else{that.dropdown.css("top",jQuery(trigger).outerHeight()+"px");trigger.click(function(e){if(!that.displayed){that.displayDropdown();e.stopPropagation()}else{that.hideDropdown()}e.preventDefault()})}jQuery(document.body).click(function(){if(that.displayed){that.hideDropdown()}})}}}();JIRA.Dropdown.Standard=function(trigger,dropdown){var that=begetObject(JIRA.Dropdown);that.init(trigger,dropdown);return that};JIRA.Dropdown.AutoComplete=function(trigger,dropdown){var that=begetObject(JIRA.Dropdown);that.init=function(trigger,dropdown){this.addInstance(this);this.dropdown=jQuery(dropdown).click(function(e){e.stopPropagation()});this.dropdown.css({display:"none"});if(trigger.target){jQuery.aop.before(trigger,function(){if(!that.displayed){that.displayDropdown()}})}else{trigger.click(function(e){if(!that.displayed){that.displayDropdown();e.stopPropagation()}})}jQuery(document.body).click(function(){if(that.displayed){that.hideDropdown()}})};that.init(trigger,dropdown);return that};AJS.namespace("jira.widget.dropdown",null,JIRA.Dropdown);
/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/AutoComplete.js' */
JIRA.AutoComplete=function(){var inFocus;var delay=function(callback,l){if(delay.t){clearTimeout(delay.t);delay.t=undefined}delay.t=setTimeout(callback,l*1000)};var INVALID_KEYS={9:true,13:true,14:true,25:true,27:true,38:true,40:true,224:true};return{dispatcher:function(){},getSavedResponse:function(){},saveResponse:function(){},renderSuggestions:function(){},disable:function(){this.disabled=true},enable:function(){this.disabled=false},set:function(options){for(var name in options){if(options.hasOwnProperty(name)){this[name]=options[name]}}},completeField:function(value){if(value){this.field.val(value).focus();this.field.trigger("change")}},textToSuggestionCursorPosition:function(){return this.field.val()},_makeRequest:function(options){var that=this,requestParams=AJS.copyObject(options);if(this.pendingRequest){this.pendingRequest.abort()}requestParams.complete=function(){that.pendingRequest=null};requestParams.error=function(xhr){if(!xhr.aborted&&xhr.status!==0&&options.error){options.error.apply(this,arguments)}};return this.pendingRequest=JIRA.SmartAjax.makeRequest(requestParams)},addSuggestionControls:function(suggestionNodes){var that=this;var evaluateIndex=function(idx,max){var minBoundary=(that.autoSelectFirst===false)?-1:0;if(that.allowArrowCarousel){if(idx>max){return minBoundary}else{if(idx<minBoundary){return max}else{return idx}}}else{if(idx>max){return max}else{if(idx<minBoundary){that.responseContainer.scrollTop(0);return minBoundary}else{return idx}}}};var setActive=function(idx){if(that.selectedIndex!==undefined&&that.selectedIndex>-1){that.suggestionNodes[that.selectedIndex][0].removeClass("active")}that.selectedIndex=evaluateIndex(idx,that.suggestionNodes.length-1);if(that.selectedIndex>-1){that.suggestionNodes[that.selectedIndex][0].addClass("active")}};var evaluateIfActive=function(){return that.suggestionNodes&&that.suggestionNodes[that.selectedIndex]&&that.suggestionNodes[that.selectedIndex][0].hasClass("active")};var keyPressHandler=function(e){if(that.responseContainer.is(":visible")){if(e.keyCode===13){if(evaluateIfActive()&&!that.pendingRequest){that.completeField(that.suggestionNodes[that.selectedIndex][1])}e.preventDefault();e.stopPropagation()}}};var keyboardNavigateHandler=function(e){if(that.responseContainer.is(":visible")){if(that.field[0]!==document.activeElement){that.field.focus()}if(e.keyCode===40){setActive(that.selectedIndex+1);if(that.selectedIndex>=0){var containerHeight=that.responseContainer.height();var bottom=that.suggestionNodes[that.selectedIndex][0].position().top+that.suggestionNodes[that.selectedIndex][0].outerHeight();if(bottom-containerHeight>0){that.responseContainer.scrollTop(that.responseContainer.scrollTop()+bottom-containerHeight+2)}}else{that.responseContainer.scrollTop(0)}e.preventDefault()}else{if(e.keyCode===38){setActive(that.selectedIndex-1);if(that.selectedIndex>=0){var top=that.suggestionNodes[that.selectedIndex][0].position().top;if(top<0){that.responseContainer.scrollTop(that.responseContainer.scrollTop()+top-2)}}e.preventDefault()}else{if(e.keyCode===9){if(evaluateIfActive()){that.completeField(that.suggestionNodes[that.selectedIndex][1]);e.preventDefault()}else{that.dropdownController.hideDropdown()}}}}}};if(suggestionNodes.length){this.selectedIndex=0;this.suggestionNodes=suggestionNodes;for(var i=0;i<that.suggestionNodes.length;i++){var eventData={instance:this,index:i};this.suggestionNodes[i][0].bind("mouseover",eventData,activate).bind("mouseout",eventData,deactivate).bind("click",eventData,complete)}if(!this.keyboardHandlerBinded){jQuery(this.field).keypress(keyPressHandler);if(jQuery.browser.mozilla){jQuery(this.field).keypress(keyboardNavigateHandler)}else{jQuery(this.field).keydown(keyboardNavigateHandler)}this.keyboardHandlerBinded=true}if(that.autoSelectFirst===false){setActive(-1)}else{setActive(0)}inFocus=this}function activate(event){if(that.dropdownController.displayed){setActive(event.data.index)}}function deactivate(event){if(event.data.index===0){that.selectedIndex=-1}jQuery(this).removeClass("active")}function complete(event){that.completeField(that.suggestionNodes[event.data.index][1])}},clearResponseContainer:function(){this.responseContainer.empty();this.suggestionNodes=undefined},delay:delay,buildResponseContainer:function(){var inputParent=this.field.parent().addClass("atlassian-autocomplete");this.responseContainer=jQuery(document.createElement("div"));this.responseContainer.addClass("suggestions");this.positionResponseContainer();this.responseContainer.appendTo(inputParent)},positionResponseContainer:function(){this.responseContainer.css({top:this.field.outerHeight()})},keyUpHandler:(function(){var isIe8=jQuery.browser.msie&&jQuery.browser.version==8;function callback(){if(!this.responseContainer){this.buildResponseContainer()}this.dispatcher(this.field.val())}return function(e){if(this.field.val().length>=this.minQueryLength){if(!(e.keyCode in INVALID_KEYS)||(this.responseContainer&&!this.responseContainer.is(":visible")&&(e.keyCode==38||e.keyCode==40))){if(isIe8){delay(jQuery.proxy(callback,this),0.2)}else{callback.call(this)}}}return e}})(),addMultiSelectAdvice:function(delim){var that=this;var alertUserValueAlreadyExists=function(val){if(!alertUserValueAlreadyExists.isAlerting){alertUserValueAlreadyExists.isAlerting=true;var userAlert=jQuery(document.createElement("div")).css({"float":"left",display:"none"}).addClass("warningBox").html("Oops! You have already entered the value <em>"+val+"</em>").appendTo(that.field.parent()).show("fast",function(){that.delay(function(){userAlert.hide("fast",function(){userAlert.remove();alertUserValueAlreadyExists.isAlerting=false})},4)})}};jQuery.aop.before({target:this,method:"dispatcher"},function(innvocation){var val=this.field.val();innvocation[0]=jQuery.trim(val.slice(val.lastIndexOf(delim)+1));return innvocation});jQuery.aop.before({target:this,method:"completeField"},function(args){var valueToAdd=args[0],untrimmedVals=this.field.val().split(delim);var trimmedVals=jQuery(untrimmedVals).map(function(){return jQuery.trim(this)}).get();if(!this.allowDuplicates&&new RegExp("(?:^|[\\s"+delim+"])"+valueToAdd+"\\s*"+delim).test(this.field.val())){alertUserValueAlreadyExists(valueToAdd);trimmedVals[trimmedVals.length-1]=""}else{trimmedVals[trimmedVals.length-1]=valueToAdd;trimmedVals[trimmedVals.length]=""}args[0]=trimmedVals.join(delim.replace(/([^\s]$)/,"$1 "));return args})},addDropdownAdvice:function(){var that=this;jQuery.aop.after({target:this,method:"buildResponseContainer"},function(args){this.dropdownController=JIRA.Dropdown.AutoComplete({target:this,method:"renderSuggestions"},this.responseContainer);jQuery.aop.after({target:this.dropdownController,method:"hideDropdown"},function(){this.dropdown.removeClass("dropdown-ready")});return args});jQuery.aop.after({target:this,method:"renderSuggestions"},function(args){if(args&&args.length>0){this.dropdownController.displayDropdown();if(this.maxHeight&&this.dropdownController.dropdown.prop("scrollHeight")>this.maxHeight){this.dropdownController.dropdown.css({height:this.maxHeight,overflowX:"visible",overflowY:"scroll"})}else{if(this.maxHeight){this.dropdownController.dropdown.css({height:"",overflowX:"",overflowY:""})}}this.dropdownController.dropdown.addClass("dropdown-ready")}else{this.dropdownController.hideDropdown()}return args});jQuery.aop.after({target:this,method:"completeField"},function(args){this.dropdownController.hideDropdown();return args});jQuery.aop.after({target:this,method:"keyUpHandler"},function(e){if((!(this.field.val().length>=this.minQueryLength)||e.keyCode===27)&&this.dropdownController&&this.dropdownController.displayed){this.dropdownController.hideDropdown();if(e.keyCode===27){e.stopPropagation()}}return e})},init:function(options){var that=this;this.set(options);this.field=this.field||jQuery("#"+this.fieldID);this.field.attr("autocomplete","off").keyup(function(e){if(!that.disabled){that.keyUpHandler(e)}}).keydown(function(e){var ESC_KEY=27;if(e.keyCode===ESC_KEY&&that.responseContainer&&that.responseContainer.is(":visible")){e.preventDefault()}}).click(function(e){if(inFocus===that){e.stopPropagation()}}).blur(function(){if(that.pendingRequest){that.pendingRequest.abort()}});this.addDropdownAdvice();if(options.delimChar){this.addMultiSelectAdvice(options.delimChar)}}}}();AJS.namespace("jira.widget.autocomplete",null,JIRA.AutoComplete);
/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/RESTAutoComplete.js' */
JIRA.RESTAutoComplete=function(){var that=begetObject(JIRA.AutoComplete);that.dispatcher=function(reqFieldVal){var that=this;if(reqFieldVal.length<this.minQueryLength){return }if(!this.getSavedResponse(reqFieldVal)){this.delay(function(){var params=that.getAjaxParams();params.data.query=reqFieldVal;params.success=function(data){that.saveResponse(reqFieldVal,data);that.responseContainer.scrollTop(0);that.renderSuggestions(data)};that._makeRequest(params)},that.queryDelay)}else{that.renderSuggestions(that.getSavedResponse(reqFieldVal));that.responseContainer.scrollTop(0)}};that.getAjaxParams=function(){};that.getSavedResponse=function(val){if(!this.requested){this.requested={}}return this.requested[val]};that.saveResponse=function(val,response){if(typeof val==="string"&&typeof response==="object"){if(!this.requested){this.requested={}}this.requested[val]=response}};return that}();AJS.namespace("jira.widget.autocomplete.REST",null,JIRA.RESTAutoComplete);
/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/IssueAutoComplete.js' */
JIRA.IssueAutoComplete=function(options){var that=begetObject(JIRA.RESTAutoComplete);that.getAjaxParams=function(){return{url:contextPath+"/rest/api/1.0/issues/picker",data:options.ajaxData,dataType:"json",type:"GET"}};that.renderSuggestions=function(response){var resultsContainer,suggestionNodes=[];this.clearResponseContainer();if(response&&response.sections&&response.sections.length>0){resultsContainer=AJS.$("<ul/>").appendTo(this.responseContainer);AJS.$(response.sections).each(function(){var section=this;var subSection=AJS.$("<div/>").attr("id",options.fieldID+"_s_"+section.id).addClass("yag").text(section.label);if(section.sub){subSection.append(AJS.$("<span/>").addClass("yagt").text("("+section.sub+")"))}resultsContainer.append(AJS.$("<li/>").append(subSection).mouseover(function(){AJS.$(this).addClass("active")}).mouseout(function(){AJS.$(this).removeClass("active")}));if(section.msg){var msg=AJS.$("<div/>").attr("id",options.fieldID+"_i_"+section.id+"_n").addClass("yad").text(section.msg);resultsContainer.append(AJS.$("<li/>").append(msg).mouseover(function(){AJS.$(this).addClass("active")}).mouseout(function(){AJS.$(this).removeClass("active")}))}if(section.issues&&section.issues.length>0){AJS.$(section.issues).each(function(){var imgUrl;if(/^http/.test(this.img)){imgUrl=this.img}else{imgUrl=contextPath+this.img}var issueNode=AJS.$("<li/>").append(AJS.$("<div/>").attr("id",options.fieldID+"_i_"+section.id+"_"+this.key).addClass("yad").append(AJS.$("<table/>").addClass("yat").attr({cellpadding:"0",cellspacing:"0"}).append(AJS.$("<tr/>").append(AJS.$("<td/>").append(AJS.$("<img/>").attr("src",imgUrl))).append(AJS.$("<td/>").append(AJS.$("<div/>").addClass("yak").html(this.keyHtml))).append(AJS.$("<td/>").css("width","100%").html(this.summary)))));resultsContainer.append(issueNode);suggestionNodes.push([issueNode,this.key])})}});that.addSuggestionControls(suggestionNodes);return suggestionNodes}};options.minQueryLength=1;options.queryDelay=0.25;that.init(options);return that};JIRA.IssueAutoComplete.init=function(){AJS.$("fieldset.issue-picker-params").each(function(){var params=JIRA.parseOptionsFromFieldset(AJS.$(this)),$container=AJS.$("#"+params.fieldId+"-container").add("#"+params.fieldName+"_container");$container.find("a.popup-trigger").click(function(e){var url=contextPath+"/secure/popups/IssuePicker.jspa?";url+="currentIssue="+params.currentIssueKey+"&";url+="singleSelectOnly="+params.singleSelectOnly+"&";url+="showSubTasks="+params.showSubTasks+"&";url+="showSubTasksParent="+params.showSubTaskParent;if(params.currentProjectId&&params.currentProjectId!=""){url+="&selectedProjectId="+params.currentProjectId}JIRA.IssuePicker.callback=function(keysMap){var $formElement,keys=[];keysMap=JSON.parse(keysMap);if(params.fieldId&&keys){$formElement=AJS.$("#"+params.fieldId);if($formElement){AJS.$.each(keysMap,function(){keys.push(this.value)});$formElement.val(keys.join(", "))}}};var vWinUsers=window.open(url,"IssueSelectorPopup","status=no,resizable=yes,top=100,left=200,width=620,height=500,scrollbars=yes,resizable");vWinUsers.opener=self;vWinUsers.focus();e.preventDefault()});if(!params.fieldId){params.fieldId=params.fieldName}if(params.issuePickerEnabled===true){JIRA.IssueAutoComplete({fieldID:params.fieldId,delimChar:params.singleSelectOnly===true?undefined:",",ajaxData:params})}})};AJS.namespace("jira.widget.autocomplete.Issues",null,JIRA.IssueAutoComplete);
/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/UserAutoComplete.js' */
JIRA.UserAutoComplete=function(options){var that=begetObject(JIRA.RESTAutoComplete);that.getAjaxParams=function(){return{url:contextPath+"/rest/api/1.0/users/picker",data:{fieldName:options.fieldID},dataType:"json",type:"GET"}};function fieldsFormHasBeenSubmitted(field){var submitting=false,form=field.closest("form");if(form.length&&form.hasClass("submitting")){submitting=true}return submitting}that.renderSuggestions=function(response){if(fieldsFormHasBeenSubmitted(this.field)||!AJS.isSelenium()&&!AJS.elementIsFocused(this.field)){return false}var resultsContainer,suggestionNodes=[];this.clearResponseContainer();if(response&&response.users&&response.users.length>0){resultsContainer=jQuery("<ul/>").appendTo(this.responseContainer);jQuery(response.users).each(function(){suggestionNodes.push([jQuery("<li/>").html(this.html).appendTo(resultsContainer),this.name])})}if(response.footer){this.responseContainer.append(jQuery("<div/>").addClass("yui-ac-ft").html(response.footer).css("display","block"))}if(suggestionNodes.length>0){that.addSuggestionControls(suggestionNodes);AJS.$(".atlassian-autocomplete div.yad, .atlassian-autocomplete .labels li").textOverflow({autoUpdate:true})}return suggestionNodes};options.minQueryLength=2;options.queryDelay=0.25;that.init(options);return that};JIRA.UserAutoComplete.init=function(parent){AJS.$("fieldset.user-picker-params",parent).each(function(){var params=JIRA.parseOptionsFromFieldset(AJS.$(this)),field=(params.fieldId||params.fieldName),$container=AJS.$("#"+field+"_container");$container.find("a.popup-trigger").click(function(e){var url=contextPath,vWinUsers;e.preventDefault();if(!params.formName){params.formName=$container.find("#"+field).parents("form").attr("name")}if(params.actionToOpen){url=url+params.actionToOpen}else{url=url+"/secure/popups/UserPickerBrowser.jspa"}url+="?formName="+params.formName+"&";url+="multiSelect="+params.multiSelect+"&";url+="decorator=popup&";url+="element="+field;vWinUsers=window.open(url,"UserPicker","status=yes,resizable=yes,top=100,left=100,width=800,height=750,scrollbars=yes");vWinUsers.opener=self;vWinUsers.focus()});if(params.userPickerEnabled===true){JIRA.UserAutoComplete({field:parent?parent.find("#"+field):null,fieldID:field,delimChar:params.multiSelect===false?undefined:",",ajaxData:{fieldName:params.fieldName}})}})};AJS.namespace("jira.widget.autocomplete.Users",null,JIRA.UserAutoComplete);
/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/initAutoCompleteFields.js' */
JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){JIRA.UserAutoComplete.init(context);JIRA.IssueAutoComplete.init(context)}});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){AJS.$("fieldset.user-searcher-params",context).each(function(){var params=JIRA.parseOptionsFromFieldset(AJS.$(this)),$container=AJS.$("#"+params.fieldId+"_container",context);if(params.userPickerEnabled===true){var autocompleter=JIRA.UserAutoComplete({fieldID:params.fieldId,delimChar:params.multiSelect===true?",":undefined,ajaxData:{fieldName:params.fieldName}})}var setupFields=function(related){var field=AJS.$("#"+params.fieldId,context);var userImage=AJS.$("#"+params.fieldId+"Image",context);var groupImage=AJS.$("#"+params.fieldId+"GroupImage",context);var fieldDesc=AJS.$("#"+params.fieldId+"_desc",context);if(related==="select.list.none"){field.val("").attr("disabled","true");userImage.hide();groupImage.hide();fieldDesc.hide()}else{field.removeAttr("disabled");if(related==="select.list.group"){userImage.hide();groupImage.show();if(params.userPickerEnabled===true){autocompleter.disable();fieldDesc.hide()}}else{userImage.show();groupImage.hide();if(params.userPickerEnabled===true){autocompleter.enable();fieldDesc.show()}}}};AJS.$("#"+params.userSelect,context).change(function(){var related=AJS.$(this).find("option:selected").attr("rel");setupFields(related)}).find("option:selected").each(function(){setupFields(AJS.$(this).attr("rel"))});$container.find("a.user-popup-trigger").click(function(e){var url=contextPath+"/secure/popups/UserPickerBrowser.jspa?";url+="formName="+params.formName+"&";url+="multiSelect="+params.multiSelect+"&";url+="decorator=popup&";url+="element="+params.fieldId;var vWinUsers=window.open(url,"UserPicker","status=yes,resizable=yes,top=100,left=100,width=800,height=750,scrollbars=yes");vWinUsers.opener=self;vWinUsers.focus();e.preventDefault()});$container.find("a.group-popup-trigger").click(function(e){var url=contextPath+"/secure/popups/GroupPickerBrowser.jspa?";url+="formName="+params.formName+"&";url+="multiSelect="+params.multiSelect+"&";url+="decorator=popup&";url+="element="+params.fieldId;var vWinUsers=window.open(url,"GroupPicker","status=yes,resizable=yes,top=100,left=100,width=800,height=750,scrollbars=yes");vWinUsers.opener=self;vWinUsers.focus();e.preventDefault()})})}});
/* module-key = 'jira.webresources:group-pickers', location = '/includes/jira/field/groupPickerUtil.js' */
JIRA.GroupPickerUtil={formatResponse:function(data){var ret=[];AJS.$(data).each(function(i,suggestions){var groupDescriptor=new AJS.GroupDescriptor({weight:i,label:suggestions.header});AJS.$(suggestions.groups).each(function(){groupDescriptor.addItem(new AJS.ItemDescriptor({value:this.name,label:this.name,html:this.html,highlighted:true}))});ret.push(groupDescriptor)});return ret}};
/* module-key = 'jira.webresources:group-pickers', location = '/includes/jira/field/initMultiGroupPickers.js' */
(function(){function initMultiGroupPickers(ctx){ctx.find(".js-default-multi-group-picker").each(function(){var $el=jQuery(this);new AJS.MultiSelect({element:this,itemAttrDisplayed:"label",showDropdownButton:false,ajaxOptions:{data:function(query){return{query:query,exclude:$el.val()}},url:JIRA.REST_BASE_URL+"/groups/picker",query:true,formatResponse:JIRA.GroupPickerUtil.formatResponse}})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initMultiGroupPickers(context)}})})();
/* module-key = 'jira.webresources:user-pickers', location = '/includes/jira/field/userPickerUtil.js' */
(function($){JIRA.UserPickerUtil={formatResponse:function(data){var ret=[];$(data).each(function(i,suggestions){var groupDescriptor=new AJS.GroupDescriptor({weight:i,label:suggestions.footer});$(suggestions.users).each(function(){groupDescriptor.addItem(new AJS.ItemDescriptor({value:this.name,label:this.displayName,html:this.html,icon:this.avatarUrl,allowDuplicate:false,highlighted:true}))});ret.push(groupDescriptor)});return ret}}})(AJS.$);
/* module-key = 'jira.webresources:user-pickers', location = '/includes/jira/field/initSingleUserPickers.js' */
(function($){function createSingleUserPickers(ctx){var restPath="/rest/api/1.0/users/picker";$(".js-default-user-picker",ctx).each(function(){var $this=$(this);if($this.data("aui-ss")){return }var data={showAvatar:true},inputText=$this.data("inputValue");new AJS.SingleSelect({element:$this,submitInputVal:true,showDropdownButton:!!$this.data("show-dropdown-button"),errorMessage:AJS.format("There is no user \'\'{0}\'\'.","'{0}'"),ajaxOptions:{url:contextPath+restPath,query:true,data:data,formatResponse:JIRA.UserPickerUtil.formatResponse},inputText:inputText})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createSingleUserPickers(context)}})})(AJS.$);
/* module-key = 'jira.webresources:user-pickers', location = '/includes/jira/field/NoBrowseUserNamePicker.js' */
AJS.NoBrowseUserNamePicker=AJS.MultiSelect.extend({_getDefaultOptions:function(){return AJS.$.extend(true,this._super(),{errorMessage:"The requested user does not exist.",showDropdownButton:false,removeOnUnSelect:true,itemAttrDisplayed:"label"})},_handleCharacterInput:function(){},_setSuggestions:function(){},_handleServerError:function(smartAjaxResult){if(smartAjaxResult.status===404){this.showErrorMessage()}else{this._super()}},_deactivate:function(){this.validateAndAdd()},validateAndAdd:function(){var instance=this;if(AJS.$.trim(this.$field.val())===""){this.hideErrorMessage()}else{jQuery.ajax({url:contextPath+"/rest/api/2/user",data:{username:AJS.$.trim(instance.getQueryVal())},success:function(user){instance.hideErrorMessage();instance.$field.val("");instance.addItem(new AJS.ItemDescriptor({label:user.displayName,value:user.name}))},error:function(){instance.showErrorMessage()}})}},_handleSpace:function(){this.validate()},_handleServerSuggestions:function(){this.hideErrorMessage();this.handleFreeInput()},handleFreeInput:function(){var value=AJS.$.trim(this.$field.val());if(value!==""){this.addItem({value:value,label:value});this.model.$element.trigger("change")}this.$field.val("")},keys:{"Return":function(event){event.preventDefault();this.validateAndAdd()},"Spacebar":function(event){event.preventDefault();this.validateAndAdd()}}});
/* module-key = 'jira.webresources:user-pickers', location = '/includes/jira/field/initMultiUserPickers.js' */
(function(){function initMultiUserPicker(ctx){ctx.find(".js-default-multi-user-picker").each(function(){var $el=jQuery(this);if(AJS.params.currentUserCanBrowseUsers){new AJS.MultiSelect({element:this,itemAttrDisplayed:"label",showDropdownButton:false,removeOnUnSelect:true,submitInputVal:true,ajaxOptions:{url:contextPath+"/rest/api/1.0/users/picker",query:true,data:function(query){return{showAvatar:true,query:query,exclude:$el.val()}},formatResponse:JIRA.UserPickerUtil.formatResponse}})}else{new AJS.NoBrowseUserNamePicker({element:this})}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initMultiUserPicker(context)}})})();
/* module-key = 'jira.webresources:ie-imitation-placeholder', location = '/includes/jira/field/IEImitationPlaceholder.js' */
(function($){$.fn.ieImitationPlaceholder=function(){if($.browser.msie){var form=this,fields=form.find("[placeholder]");fields.focus(clearTextIfUnchanged);fields.blur(setTextFromPlaceholder);form.submit(clearAllIfUnchanged);fields.each(setTextFromPlaceholder);function setTextFromPlaceholder(){var field=$(this);if(field.val()===""){field.val(field.attr("placeholder"));field.addClass("input-placeholder")}}function clearTextIfUnchanged(){var field=$(this);if(field.val()===field.attr("placeholder")){field.val("");field.removeClass("input-placeholder")}}function clearAllIfUnchanged(){fields.each(clearTextIfUnchanged)}}}})(AJS.$);
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/field-templates.soy' */
// This file was automatically generated from field-templates.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Fields == 'undefined') { JIRA.Templates.Fields = {}; }


JIRA.Templates.Fields.username = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.escape) ? soy.$$escapeHtml(opt_data.displayName) : opt_data.displayName);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Fields.recipientUsername = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li data-username="', soy.$$escapeHtml(opt_data.username), '" title=', soy.$$escapeHtml(opt_data.username), '><span><span class="user-hover" rel="', soy.$$escapeHtml(opt_data.username), '"><img src="', soy.$$escapeHtml(opt_data.icon), '" title="');
  JIRA.Templates.Fields.username(opt_data, output);
  output.append('"><span title="');
  JIRA.Templates.Fields.username(opt_data, output);
  output.append('">');
  JIRA.Templates.Fields.username(opt_data, output);
  output.append('</span></span>', (! opt_data.readOnly) ? '<span class="remove-recipient item-delete"/>' : '', '</span></li>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Fields.recipientEmail = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li data-email="', soy.$$escapeHtml(opt_data.email), '" title=', soy.$$escapeHtml(opt_data.email), '><span><img src="', soy.$$escapeHtml(opt_data.icon), '" title="', soy.$$escapeHtml(opt_data.email), '"><span title="', soy.$$escapeHtml(opt_data.email), '">', soy.$$escapeHtml(opt_data.email), '</span><span class="remove-recipient item-delete"/></span></li>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/IssuePicker.js' */
JIRA.IssuePicker=AJS.MultiSelect.extend({_formatResponse:function(response){var ret=[],canonicalBaseUrl=(function(){var uri=parseUri(window.location);return uri.protocol+"://"+uri.authority})();if(response&&response.sections){AJS.$(response.sections).each(function(i,section){var groupDescriptor=new AJS.GroupDescriptor({weight:i,label:section.label,description:section.sub});if(section.issues&&section.issues.length>0){AJS.$(section.issues).each(function(){groupDescriptor.addItem(new AJS.ItemDescriptor({highlighted:true,value:this.key,label:this.key+" - "+this.summaryText,icon:this.img?canonicalBaseUrl+contextPath+this.img:null,html:this.keyHtml+" - "+this.summary}))})}ret.push(groupDescriptor)})}return ret},_getDefaultOptions:function(){return AJS.$.extend(true,this._super(),{ajaxOptions:{formatResponse:this._formatResponse}})},_launchPopup:function(){function getWithDefault(value,def){if(typeof value=="undefined"||value==null){return def}else{return value}}var url,urlParam,vWinUsers,options,instance=this;JIRA.IssuePicker.callback=function(items){if(typeof items==="string"){items=JSON.parse(items)}instance._addMultipleItems(items,true);instance.$field.focus()};options=this.options.ajaxOptions.data;url=contextPath+"/secure/popups/IssuePicker.jspa?";urlParam={singleSelectOnly:"false",decorator:"popup",currentIssue:options.currentIssueKey||"",showSubTasks:getWithDefault(options.showSubTasks,false),showSubTasksParent:getWithDefault(options.showSubTaskParent,false)};if(options.currentProjectId){urlParam["currentProjectId"]=options.currentProjectId}url+=AJS.$.param(urlParam);vWinUsers=window.open(url,"IssueSelectorPopup","status=no,resizable=yes,top=100,left=200,width="+this.options.popupWidth+",height="+this.options.popupHeight+",scrollbars=yes,resizable");vWinUsers.opener=self;vWinUsers.focus()},_createFurniture:function(disabled){var $popupLink;this._super(disabled);$popupLink=this._render("popupLink");this._assignEvents("popupLink",$popupLink);this.$container.addClass("jira-issue-picker");this.$container.addClass("hasIcon");this.$container.after($popupLink)},handleFreeInput:function(){var values=this.$field.val().toUpperCase().match(/\S+/g);if(values){this._addMultipleItems(jQuery.map(values,function(value){return{value:value,label:value}}))}this.$field.val("")},_events:{popupLink:{click:function(e){this._launchPopup();e.preventDefault()}}},_renders:{popupLink:function(){return AJS.$("<a class='issue-picker-popup' />").attr({href:"#",title:this.options.popupLinkMessage}).text(""+this.options.popupLinkMessage+"")}}});AJS.namespace("jira.issuepicker",null,JIRA.IssuePicker);AJS.namespace("AJS.IssuePicker",null,JIRA.IssuePicker);
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/LabelPicker.js' */
JIRA.LabelPicker=AJS.MultiSelect.extend({_getDefaultOptions:function(){return AJS.$.extend(true,this._super(),{ajaxOptions:{url:contextPath+"/includes/js/ajs/layer/labeldata.js",query:true,formatResponse:this._formatResponse},removeDuplicates:true,removeOnUnSelect:true,userEnteredOptionsMsg:"New Label"})},isValidItem:function(itemValue){return !/\s/.test(itemValue)},_handleServerSuggestions:function(data){if(data&&data.token){if(AJS.$.trim(this.$field.val())!==data.token){return }}this._super(data)},_handleSpace:function(){if(AJS.$.trim(this.$field.val())!==""){if(this.handleFreeInput()){this.hideSuggestions()}}},keys:{"Spacebar":function(event){this._handleSpace();event.preventDefault()}},_formatResponse:function(data){var optgroup=new AJS.GroupDescriptor({label:"Suggestions",type:"optgroup",styleClass:"labels-suggested"});if(data&&data.suggestions){AJS.$.each(data.suggestions,function(){optgroup.addItem(new AJS.ItemDescriptor({value:this.label,label:this.label,html:this.html,highlighted:true}))})}return[optgroup]},handleFreeInput:function(){var values=AJS.$.trim(this.$field.val()).match(/\S+/g);if(values){for(var value,i=0;value=values[i];i++){this.addItem({value:value,label:value})}this.model.$element.trigger("change")}this.$field.val("")}});AJS.namespace("AJS.LabelPicker",null,JIRA.LabelPicker);
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/MultiUserListPicker.js' */
(function($){JIRA.MultiUserListPicker=AJS.MultiSelect.extend({init:function(options){var restPath="/rest/api/1.0/users/picker";function formatResponse(response){var ret=[];$(response).each(function(i,suggestions){var groupDescriptor=new AJS.GroupDescriptor({weight:i,label:suggestions.footer});$(suggestions.users).each(function(){groupDescriptor.addItem(new AJS.ItemDescriptor({value:this.name,label:this.displayName,html:this.html,icon:this.avatarUrl,allowDuplicate:false,highlighted:true}))});ret.push(groupDescriptor)});return ret}$.extend(options,{itemAttrDisplayed:"label",userEnteredOptionsMsg:"Email address",showDropdownButton:false,removeOnUnSelect:true,ajaxOptions:{url:contextPath+restPath,query:true,data:{showAvatar:true},formatResponse:formatResponse},suggestionsHandler:AJS.UserListSuggestHandler,itemGroup:new AJS.Group(),itemBuilder:function(descriptor){return new JIRA.MultiUserListPicker.Item({descriptor:descriptor,container:this.$selectedItemsContainer})}});this._super(options)},_createFurniture:function(disabled){this._super(disabled);if(this.options.description){this._render("description",this.options.description).insertAfter(this.$field)}},updateItemsIndent:$.noop,_renders:{selectedItemsWrapper:function(){return $('<div class="recipients"></div>')},selectedItemsContainer:function(){return $("<ol />")},description:function(description){return $("<div />").addClass("description").text(description)}}})}(AJS.$));
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/MultiUserListPicker.Item.js' */
JIRA.MultiUserListPicker.Item=AJS.Control.extend({init:function(options){this._setOptions(options);this.$lozenge=this._render("item");this.$removeButton=this.$lozenge.find(".remove-recipient");this._assignEvents("instance",this);this._assignEvents("lozenge",this.$lozenge);this._assignEvents("removeButton",this.$removeButton);this.$lozenge.prependTo(this.options.container)},_getDefaultOptions:function(){return{label:null,title:null,container:null,focusClass:"focused"}},_renders:{"item":function(){var descriptor=this.options.descriptor;var data;if(descriptor.noExactMatch()!==true){data={escape:false,username:descriptor.value(),icon:descriptor.icon(),displayName:AJS.escapeHtml(descriptor.label())};return AJS.$(JIRA.Templates.Fields.recipientUsername(data))}else{data={email:descriptor.value(),icon:AJS.Meta.get("default-avatar-url")};return AJS.$(JIRA.Templates.Fields.recipientEmail(data))}}},_events:{"instance":{"remove":function(){this.$lozenge.remove()}},"removeButton":{"click":function(e){e.stopPropagation();this.trigger("remove")}}}});
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initCascadingSelects.js' */
(function(){function initCascadingSelect(el){AJS.$(el||document.body).find("div.aui-field-cascadingselect").add("tr.aui-field-cascadingselect").add("td.aui-field-cascadingselect").each(function(){var $container=AJS.$(this),parent=$container.find(".cascadingselect-parent"),parentOptions=parent.find("option"),oldClass="",child=$container.find(".cascadingselect-child"),childOptions=child.find("option"),selectedChild=child.find(":selected");function update(){var placeholder,currentClass=parent.find("option:selected").attr("class");if(currentClass!==oldClass){placeholder=jQuery("<span />").insertAfter(child);child.detach();child.find("option").each(function(i,elem){elem.parentNode.removeChild(this)});child.insertAfter(placeholder);placeholder.remove();childOptions.filter("."+parent.find("option:selected").attr("class")).appendTo(child);if(selectedChild.hasClass(parent.find("option:selected").attr("class"))){child.val(selectedChild.val())}else{child.val(child.find("option:first").val())}oldClass=currentClass}}parent.bind("cascadingSelectChanged",update).change(function(){AJS.$(this).trigger("cascadingSelectChanged")}).trigger("cascadingSelectChanged")})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initCascadingSelect(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initComponentPickers.js' */
(function(){function createPicker($selectField){new AJS.MultiSelect({element:$selectField,itemAttrDisplayed:"label",errorMessage:"{0} is not a valid component.",maxInlineResultsDisplayed:15})}function locateSelect(parent){var $parent=AJS.$(parent),$selectField;if($parent.is("select")){$selectField=$parent}else{$selectField=$parent.find("select")}return $selectField}var DEFAULT_SELECTORS=["div.aui-field-componentspicker.frother-control-renderer","td.aui-field-componentspicker.frother-control-renderer","tr.aui-field-componentspicker.frother-control-renderer"];function findComponentSelectAndConvertToPicker(context,selector){selector=selector||DEFAULT_SELECTORS.join(", ");AJS.$(selector,context).each(function(){var $selectField=locateSelect(this);if($selectField.length){createPicker($selectField)}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){findComponentSelectAndConvertToPicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initMultiselectPickers.js' */
(function(){function createPicker($selectField){new AJS.MultiSelect({element:$selectField,itemAttrDisplayed:"label",errorMessage:"{0} is not a valid value.",maxInlineResultsDisplayed:15,submitInputVal:true})}function locateSelect(parent){var $parent=AJS.$(parent),$selectField;if($parent.is("select")){$selectField=$parent}else{$selectField=$parent.find("select")}return $selectField}var DEFAULT_SELECTORS=["div.aui-field-multiselectpicker.frother-control-renderer"];function findComponentSelectAndConvertToPicker(context,selector){selector=selector||DEFAULT_SELECTORS.join(", ");AJS.$(selector,context).each(function(){var $selectField=locateSelect(this);if($selectField.length){createPicker($selectField)}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){findComponentSelectAndConvertToPicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initDatePickers.js' */
(function(){function initDatePicker(el){AJS.$(el||document.body).find("div.aui-field-datepicker").add("tr.aui-field-datepicker").add("td.aui-field-datepicker").each(function(){var $container=AJS.$(this),field=$container.find("input:text"),defaultCheckbox=$container.find("#useCurrentDate"),params=JIRA.parseOptionsFromFieldset($container.find("fieldset.datepicker-params"));params.context=el;Calendar.setup(params);function toggleField(){field.prop("disabled",defaultCheckbox.is(":checked"))}if(defaultCheckbox.length){toggleField();defaultCheckbox.click(toggleField)}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initDatePicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initLegacyGroupPickers.js' */
(function(){function initLegacyGroupPicker(el){AJS.$(el||document.body).find("div.aui-field-grouppicker").add("tr.aui-field-grouppicker").add("td.aui-field-grouppicker").each(function(){var $container=AJS.$(this),trigger=$container.find("a.grouppicker-trigger"),url=trigger.attr("href");function openGroupPickerWindow(e){e.preventDefault();window.open(url,"GroupPicker","status=yes,resizable=yes,top=100,left=100,width=800,height=750,scrollbars=yes")}trigger.click(openGroupPickerWindow)})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initLegacyGroupPicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initIssuePickers.js' */
(function(){function initIssuePicker(el){AJS.$(el||document.body).find(".aui-field-issuepicker").each(function(){new JIRA.IssuePicker({element:AJS.$(this),userEnteredOptionsMsg:"Enter issue key",uppercaseUserEnteredOnSelect:true})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initIssuePicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initLabelPickers.js' */
(function(){function createPicker($fieldset,context){var opts=JIRA.parseOptionsFromFieldset($fieldset),$select=AJS.$("#"+opts.id,context),issueId=opts.issueId,data={};if(/customfield_\d/.test(opts.id)){data.customFieldId=parseInt(opts.id.replace("customfield_",""),10)}new JIRA.LabelPicker({element:$select,ajaxOptions:{url:contextPath+"/rest/api/1.0/labels"+(issueId?"/"+issueId:"")+"/suggest",data:data}})}function locateFieldset(parent){var $parent=AJS.$(parent),$fieldset;if($parent.is(FIELDSET_SELECTOR)){$fieldset=$parent}else{$fieldset=$parent.find(FIELDSET_SELECTOR)}return $fieldset}var FIELDSET_SELECTOR="fieldset.labelpicker-params";function findLabelsFieldsetAndConvertToPicker(context,selector){selector=selector||".aui-field-labelpicker";AJS.$(selector,context).each(function(){var $fieldset=locateFieldset(this);if($fieldset.length>0){createPicker($fieldset,context)}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){findLabelsFieldsetAndConvertToPicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initVersionPickers.js' */
(function(){function createPicker($selectField){new AJS.MultiSelect({element:$selectField,itemAttrDisplayed:"label",removeOnUnSelect:false,submitInputVal:true,errorMessage:"{0} is not a valid version.",maxInlineResultsDisplayed:15})}function locateSelect(parent){var $parent=AJS.$(parent),$selectField;if($parent.is("select")){$selectField=$parent}else{$selectField=$parent.find("select")}return $selectField}function findVersionSelectAndConvertToPicker(context,selector){selector=selector||".aui-field-versionspicker.frother-control-renderer";AJS.$(selector,context).each(function(){var $selectField=locateSelect(this);if($selectField.length){createPicker($selectField)}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){findVersionSelectAndConvertToPicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initCommentControls.js' */
(function($){function applyCommentControls($contexts){if($contexts.attr("id")==="addcomment"){$contexts=$contexts.find("#issue-comment-add")}$contexts.each(function(){var $context=$(this);var $commentLevel=$context.find("#commentLevel");if($commentLevel.length>0){new AJS.SecurityLevelSelect($commentLevel)}$context.find(".wiki-js-prefs").each(function(){JIRA.wikiPreview(this,$context).init()})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context){applyCommentControls(context)})})(AJS.$);
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/ProjectIssueTypeSelect.js' */
JIRA.ProjectIssueTypeSelect=Class.extend({init:function(options){var val,instance=this;this.$project=options.project;this.backgroundImages=this.removeBackgroundImages(options.issueTypeSelect);this.$refIssueTypeSelect=jQuery(options.issueTypeSelect).clone(true,true);this.$issueTypeSelect=options.issueTypeSelect;this.$projectIssueTypesSchemes=options.projectIssueTypesSchemes;this.$issueTypeSchemeIssueDefaults=options.issueTypeSchemeIssueDefaults;this.projectIssueTypeSchemes=this.getProjectIssueTypeSchemesFromDom();this.issueTypesSchemeDefaults=this.getIssueTypeSchemeIssueDefaults();if(instance.$project.length>0){val=instance.$project.val();instance.setIssueTypeScheme(instance.getIssueTypeSchemeForProject(val));if(this.$project.is("select")){this.$project.change(function(){var val=instance.$project.val();instance.lastIssueType=instance.$issueTypeSelect.find(":selected:first").val();instance.$refIssueTypeSelect.val("");instance.setIssueTypeScheme(instance.getIssueTypeSchemeForProject(val));instance.$issueTypeSelect.trigger("reset")})}}},getIssueTypeSchemeForProject:function(projectId){return this.projectIssueTypeSchemes[projectId]},getDefaultIssueTypeForScheme:function(issueTypeSchemeId){return this.issueTypesSchemeDefaults[issueTypeSchemeId]},removeBackgroundImages:function(issueTypeSelect){var map={};jQuery(issueTypeSelect).find("option[style]").each(function(){map[jQuery(this).attr("id")]=jQuery(this).css("background-image");jQuery(this).attr("style","");jQuery(this).removeAttr("style")});return map},addBackgroundImages:function(){var that=this;this.$issueTypeSelect.find("option").each(function(){jQuery(this).css("background-image",that.backgroundImages[jQuery(this).attr("id")])})},setIssueTypeScheme:function(issueTypeSchemeId){var selectedIssueType,instance=this,$toSelect,$placeholder=jQuery("<span class='hidden' />"),$optgroups=this.$refIssueTypeSelect.find("optgroup");$placeholder.insertAfter(this.$issueTypeSelect);this.$issueTypeSelect.detach().empty();if($optgroups.length){$optgroups.each(function(){var $optgroup=jQuery(this);if($optgroup.is("[data-scheme-id='"+issueTypeSchemeId+"']")){instance.$issueTypeSelect.append($optgroup.clone(true).children());return false}})}else{this.$issueTypeSelect.append(this.$refIssueTypeSelect.children())}selectedIssueType=this.$issueTypeSelect.find("option[data-selected]").val()||"";if(instance.lastIssueType){$toSelect=this.$issueTypeSelect.find("option[value='"+instance.lastIssueType+"']")}else{if(selectedIssueType){$toSelect=this.$issueTypeSelect.find("option[value='"+selectedIssueType+"']")}}if($toSelect&&$toSelect.length!==0){$toSelect.attr("selected","selected");this.$issueTypeSelect.val($toSelect.val())}else{this.setDefaultIssueType(issueTypeSchemeId)}this.$issueTypeSelect.insertAfter($placeholder);this.addBackgroundImages();this.$issueTypeSelect.attr("data-project",this.$project.val());$placeholder.remove()},setDefaultIssueType:function(issueTypeSchemeId){var defaultIssueType=this.getDefaultIssueTypeForScheme(issueTypeSchemeId);if(defaultIssueType!==""){this.$issueTypeSelect.find("option[value='"+defaultIssueType+"']").attr("selected","selected")}else{this.$issueTypeSelect.find("option").each(function(i,option){if(this.value&&this.value!==""){jQuery(option).attr("selected","selected");return false}})}},getProjectIssueTypeSchemesFromDom:function(){var projectIssueTypes={};this.$projectIssueTypesSchemes.find("input").each(function(i,input){var $input=jQuery(input),project=$input.attr("title"),issueTypes=$input.val();projectIssueTypes[project]=issueTypes});return projectIssueTypes},getIssueTypeSchemeIssueDefaults:function(){var issueTypesSchemeDefaults={};this.$issueTypeSchemeIssueDefaults.find("input").each(function(i,input){var $input=jQuery(input),issueTypeScheme=$input.attr("title"),defaultIssueType=$input.val();issueTypesSchemeDefaults[issueTypeScheme]=defaultIssueType});return issueTypesSchemeDefaults}});
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initProjectIssueTypeSelect.js' */
(function(){function findProjectAndIssueTypeSelectAndConvertToPicker(ctx){var $ctx=ctx||jQuery("body"),$project=$ctx.find(".project-field, .project-field-readonly"),$issueTypeSelect=$ctx.find(".issuetype-field"),$projectIssueTypes=$ctx.find(".project-issue-types"),$defaultProjectIssueTypes=$ctx.find(".default-project-issue-type");$project.each(function(i){new JIRA.ProjectIssueTypeSelect({project:jQuery(this),issueTypeSelect:$issueTypeSelect.eq(i),projectIssueTypesSchemes:$projectIssueTypes.eq(i),issueTypeSchemeIssueDefaults:$defaultProjectIssueTypes.eq(i)})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){findProjectAndIssueTypeSelectAndConvertToPicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initIssueTypePickers.js' */
(function(){function createissueTypePicker(context){context.find(".issuetype-field").each(function(){var $select=jQuery(this);$select.bind("reset",function(){$select.find("option[value='']").remove()}).trigger("reset");new AJS.SingleSelect({element:this,revertOnInvalid:true})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createissueTypePicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initProjectPickers.js' */
(function(){function createProjectPicker(context){context.find(".project-field").each(function(){new AJS.SingleSelect({element:this,revertOnInvalid:true})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createProjectPicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initLogWorkControls.js' */
(function($){JIRA.Events.VALIDATE_TIMETRACKING="validateTimeTracking";function toggleTimeTrackingContainer(context,activate){var $logWorkContainer=$(context).find("#worklog-logworkcontainer"),$timeTrackingContainer=$(context).find("#worklog-timetrackingcontainer"),$logWorkCheckbox=$(context).find("#log-work-activate");if(activate){$logWorkContainer.removeClass("hidden");$timeTrackingContainer.addClass("hidden");$logWorkCheckbox.prop("checked",true)}else{$logWorkContainer.addClass("hidden");$timeTrackingContainer.removeClass("hidden");$logWorkCheckbox.prop("checked",false)}}function applyLogworkControls(context){$("#log-work-adjust-estimate-new-value, #log-work-adjust-estimate-manual-value",context).attr("disabled","disabled");$("#log-work-adjust-estimate-"+$("input[name=worklog_adjustEstimate]:checked,input[name=adjustEstimate]:checked",context).val()+"-value",context).removeAttr("disabled");$("input[name=worklog_adjustEstimate],input[name=adjustEstimate]",context).change(function(){$("#log-work-adjust-estimate-new-value,#log-work-adjust-estimate-manual-value",context).attr("disabled","disabled");$("#log-work-adjust-estimate-"+$(this).val()+"-value",context).removeAttr("disabled")});$(context).find("#log-work-activate").change(function(){toggleTimeTrackingContainer(context,$(this).is(":checked"))})}JIRA.bind(JIRA.Events.VALIDATE_TIMETRACKING,function(e,context){toggleTimeTrackingContainer(context,true)});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){applyLogworkControls(context)}})})(AJS.$);
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initPriorityPickers.js' */
(function($){function createPriorityPicker(context){context.find("select#priority").each(function(i,el){new AJS.SingleSelect({element:el,revertOnInvalid:true})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createPriorityPicker(context)}})})(AJS.$);
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initInlineAttach.js' */
(function(){function createInlineAttach(context){context.find("input[type=file]:not('.ignore-inline-attach')").inlineAttach()}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createInlineAttach(context)}})})();
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/namespace.js' */
jQuery.namespace("JIRA.Forms");
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/util.js' */
Class.prototype.triggerEvent=function(C,A,B){jQuery(this).trigger(C,A);
if(B&&this.globalEventNamespaces){jQuery.each(this.globalEventNamespaces,function(E,D){jQuery(AJS).trigger(D+"."+C,A)
})
}return this
};
Class.prototype.bind=function(A,B){jQuery(this).bind(A,B);
return this
};
JIRA.makePropertyFunc=function(A){if(jQuery.isFunction(A)){return A
}else{return function(){return A
}
}};
JIRA.Dialog.getAttrFromActiveTrigger=function(B){var C=JIRA.Dialog.current,A=C.$activeTrigger;
if(A){return A.attr(B)
}};
JIRA.Dialog.getIssueActionTitle=function(B){var A=JIRA.Dialog.getActionIssueKey();
if(!A){return B
}return B+" : "+A
};
JIRA.Dialog.getActionIssueKey=function(){var A=JIRA.Dialog.getAttrFromActiveTrigger("data-issueKey");
if(!A&&JIRA.Issue){A=JIRA.Issue.getIssueKey()
}if(!A&&JIRA.IssueNavigator){A=JIRA.IssueNavigator.getSelectedIssueKey()
}if(!A&&JIRA.Issues){A=JIRA.Issues.Api.getSelectedIssueKey()
}return A
};
JIRA.activateTabWithChild=function(E){var C,B,A,D=E.closest(".tabs-pane");
if(D.length){B=D.closest(".aui-tabs");
C=D.attr("id");
A=B.find("a[href='#"+C+"']");
A.click()
}};
JIRA.applyErrorsToForm=function(C,D){var B,A=[];
jQuery.each(D,function(F,I){var H,E,G=C.find(":input[name='"+F+"']").last();
if(G.length===1){if(!B){B=G
}E=jQuery("<div class='error' />").attr("data-field",F).text(I);
H=G.closest(".field-group, .group");
H.find(".error").remove();
H.append(E)
}else{if(G.length===0){A.push(I)
}}});
if(A.length>0){JIRA.applyErrorMessageToForm(C,JIRA.Templates.Issue.undealtErrors({errors:A}))
}JIRA.activateTabWithChild(C.find(".error:first"));
if(B){B.focus()
}};
JIRA.extractScripts=function(B){var A=jQuery(B);
return{html:A.not("script"),scripts:A.filter("script")}
};
JIRA.applyMessageToForm=function(A,C,B,E){var D=C.find(".aui-message-context");
if(!D.length){D=jQuery("<div class='aui-message-context' />");
if(JIRA.useLegacyDecorator()){D.prependTo(C.find(".content-body"))
}else{D.prependTo(C.find(".form-body"))
}}D.empty();
AJS.messages[A](D,{shadowed:false,closeable:E,body:B})
};
JIRA.useLegacyDecorator=function(){return !JIRA.Version.isGreaterThanOrEqualTo("5.0")
};
JIRA.applyErrorMessageToForm=function(B,A){return JIRA.applyMessageToForm("error",B,A,false)
};
JIRA.applySuccessMessageToForm=function(B,A){return JIRA.applyMessageToForm("success",B,A,true)
};
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/model.js' */
JIRA.Forms.Model=Class.extend({init:function(A){this.userFieldsResource=A.userFieldsResource;
this.fieldsResource=A.fieldsResource;
this.retainedFields=[];
this._hasRetainFeature=false;
this._hasVisibilityFeature=true
},getFieldsResource:function(){return this.fieldsResource
},getAtlToken:function(){return this.atlToken
},getActiveFieldIds:function(){return this.getUserFields()
},addFieldToRetainValue:function(A){if(this._hasRetainFeature){this.removeFieldToRetainValue(A);
this.retainedFields.push(A)
}else{throw new Error("getFieldsWithRetainedValues: cannot be called. Must enable retain feature first by specifiying [_hasRetainFeature=true]")
}},clearRetainedFields:function(){this.retainedFields=[]
},removeFieldToRetainValue:function(B){if(this._hasRetainFeature){var A=jQuery.inArray(B,this.retainedFields);
if(A!=-1){this.retainedFields.splice(A,1)
}}else{throw new Error("getFieldsWithRetainedValues: cannot be called. Must enable retain feature first by specifiying [_hasRetainFeature=true]")
}},getFieldsWithRetainedValues:function(){if(this._hasRetainFeature){return this.retainedFields
}else{throw new Error("getFieldsWithRetainedValues: cannot be called. Must enable retain feature first by specifiying [_hasRetainFeature=true]")
}},hasRetainedValue:function(A){if(this._hasRetainFeature){return jQuery.inArray(A.id,this.retainedFields)!==-1
}else{throw new Error("HasRetainedValue: cannot be called. Must enable retain feature first by specifiying [_hasRetainFeature=true]")
}},refresh:function(C){var A=this,B=jQuery.Deferred(),D;
if(C){D=C+"&retainValues=true"
}JIRA.SmartAjax.makeRequest({url:this.getFieldsResource(),type:"POST",data:D,success:function(E){A.atlToken=E.atl_token;
A.fields=E.fields;
A.sortedTabs=E.sortedTabs;
A.userPreferences=E.userPreferences
},complete:function(F,G,E){if(E.successful){B.resolveWith(A,arguments)
}else{A.triggerEvent("serverError",[E]);
B.rejectWith(A,[E])
}}});
return B.promise()
},setFields:function(A){this.fields=A
},getConfigurableFields:function(){return this.getFields()
},getFields:function(){var A=this,B=jQuery.Deferred();
if(!this.fields){this.refresh().done(function(){B.resolve(A.fields)
})
}else{B.resolve(A.fields)
}return B.promise()
},_mungeTabs:function(B){var A=0,C=[];
jQuery.each(B,function(D,E){A++;
if(E.tab){if(!C[E.tab.position]){C[E.tab.position]=AJS.copyObject(E.tab)
}if(E.tab.position===0){C[E.tab.position].isFirst=true
}if(!C[E.tab.position].fields){C[E.tab.position].fields=[]
}C[E.tab.position].fields.push(AJS.copyObject(E))
}});
return C
},getTabs:function(){var A=this,B=jQuery.Deferred();
this.getFields().done(function(C){var D=A._mungeTabs(C);
B.resolve(D)
});
return B.promise()
},getSortedTabs:function(){var A=jQuery.Deferred();
if(!this.sortedTabs){this.refresh().done(function(){A.resolve(this.sortedTabs)
})
}else{A.resolve(this.sortedTabs)
}return A.promise()
},getUserFields:function(){var A=this,B=jQuery.Deferred();
if(!this.userPreferences){this.refresh().done(function(){B.resolve(A.userPreferences.fields)
})
}else{B.resolve(A.userPreferences.fields)
}return B.promise()
},setUserFields:function(A){var B={};
B.fields=A;
return this.updateUserPrefs(B)
},hasRetainFeature:function(){return !!this._hasRetainFeature
},hasVisibilityFeature:function(){return !!this._hasVisibilityFeature
},getUseConfigurableForm:function(){var A=this,B=jQuery.Deferred();
if(!this.userPreferences){this.refresh().done(function(){B.resolve(A.userPreferences.useQuickForm)
}).fail(function(){B.reject()
})
}else{B.resolve(A.userPreferences.useQuickForm)
}return B.promise()
},setUseConfigurableForm:function(A){var B={};
B.useQuickForm=A;
return this.updateUserPrefs(B)
},updateUserPrefs:function(C){var B=jQuery.Deferred(),A=this;
if(AJS.Meta.get("remote-user")===""){B.done();
return B.promise()
}if(!this.userPreferences){console.log("JIRA.Forms.Model: Cannot update user preferences if there are none to update");
B.reject();
return B.promise()
}if(!C.fields){C.fields=this.userPreferences.fields
}if(typeof C.showWelcomeScreen==="undefined"){C.showWelcomeScreen=this.userPreferences.showWelcomeScreen
}if(typeof C.useQuickForm==="undefined"){C.useQuickForm=this.userPreferences.useQuickForm
}return JIRA.SmartAjax.makeRequest({url:this.userFieldsResource,type:"POST",data:JSON.stringify(C),dataType:"json",contentType:"application/json",complete:function(E,F,D){if(D.successful){A.userPreferences=C
}else{A.triggerEvent("serverError",[D])
}}})
}});
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/quickform.soy' */
// This file was automatically generated from quickform.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.QuickForm == 'undefined') { JIRA.Templates.QuickForm = {}; }


JIRA.Templates.QuickForm.field = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(opt_data.editHtml);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.QuickForm.fieldPicker = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="qf-picker"><div class="qf-picker-header"><dl><dt>', soy.$$escapeHtml("Show Fields:"), '</dt>', (opt_data.isConfigurable) ? '<dd><a class="qf-unconfigurable" href="#">' + soy.$$escapeHtml("All") + '</a></dd><dd>' + soy.$$escapeHtml("Custom") + '</dd>' : '<dd>' + soy.$$escapeHtml("All") + '</dd><dd><a class="qf-configurable" href="#">' + soy.$$escapeHtml("Custom") + '</a></dd>', '</dl></div><div class="qf-picker-content ', (! opt_data.isConfigurable) ? 'qf-picker-unconfigurable' : '', '"></div><div class="qf-picker-footer"></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.QuickForm.configurablePickerButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a title="', soy.$$escapeHtml(opt_data.label), '" data-field-id="', soy.$$escapeHtml(opt_data.fieldId), '" class="qf-picker-button', (opt_data.isActive) ? ' qf-active' : '', '" href="#">', soy.$$escapeHtml(opt_data.label), (opt_data.required) ? '<span class="aui-icon icon-required"></span>' : '', '</a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.QuickForm.unconfigurablePickerButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span title="', soy.$$escapeHtml(opt_data.label), '" data-field-id="', soy.$$escapeHtml(opt_data.fieldId), '" class="qf-picker-button', (opt_data.isActive) ? ' qf-active' : '', '" href="#">', soy.$$escapeHtml(opt_data.label), (opt_data.required) ? '<span class="aui-icon icon-required"></span>' : '', '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.QuickForm.errorMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message error"><span class="aui-icon icon-error"></span>', soy.$$escapeHtml(opt_data.message), '</div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/field.js' */
JIRA.Forms.ConfigurableField=AJS.Control.extend({init:function(A){this.descriptor=A;
this.$element=jQuery("<div />").attr("id","qf-field-"+this.getId())
},focus:function(){this.$element.find(":input:first").focus()
},highlight:function(){var A=this;
this.$element.css("backgroundColor","#fff").animate({backgroundColor:"lightyellow"},function(){A.$element.animate({backgroundColor:"#fff"},function(){A.$element.css("backgroundColor","")
})
})
},getLabel:function(){return this.descriptor.label
},getId:function(){return this.descriptor.id
},activate:function(B){var A;
this.active=true;
this.$element.addClass("qf-field-active").show();
this.$element.find("textarea").trigger("refreshInputHeight");
if(!B){A=this.render();
this.$element.append(A.scripts);
this.focus();
JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$element]);
this.$element.scrollIntoView();
this.triggerEvent("activated")
}},hasVisibilityFeature:function(){return !!this.descriptor.hasVisibilityFeature
},hasRetainFeature:function(){return !!this.descriptor.hasRetainFeature
},isActive:function(){return this.active
},disable:function(A){this.render();
this.active=false;
this.$element.removeClass("qf-field-active").hide();
if(!A){this.triggerEvent("disabled")
}},render:function(){var B=JIRA.Templates.QuickForm.field(this.descriptor),A=JIRA.extractScripts(B);
this.$element.html(A.html).addClass("qf-field").data("model",this);
return{element:this.$element,scripts:A.scripts}
}});
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/picker.js' */
JIRA.Forms.FieldPicker=AJS.Control.extend({INLINE_DIALOG_ID:"field_picker_popup",init:function(){this.buttons=[]
},switchToAll:function(A){this.isConfigurable=false;
if(A!==true){this.hideCallback=function(){this.remove()
};
this.inlineDialog.hide();
this.triggerEvent("switchedToAll")
}},setForm:function(A){this.form=A
},switchToCustom:function(A){this.isConfigurable=true;
if(A!==true){this.hideCallback=function(){this.remove()
};
this.inlineDialog.hide();
this.triggerEvent("switchedToCustom")
}},hideCallback:function(){},bindInlineDialog:function(){var B=this,A=this.getInlineDialogTrigger();
function C(F,D,E){B.render().done(function(G){if(F.find(".qf-picker").length===0){F.html(G);
F.click(function(K){K.stopPropagation()
})
}var J=jQuery("#qf-field-picker-trigger:visible").offset().top-jQuery(window).scrollTop(),I=jQuery(window).height(),H=I-J-110;
F.find(".qf-picker-content").css("maxHeight",H);
E()
})
}if(this.inlineDialog){this.inlineDialog.remove()
}this.inlineDialog=AJS.InlineDialog(A,this.INLINE_DIALOG_ID,C,{width:400,upfrontCallback:function(){A.parent().addClass("active")
},hideCallback:function(){A.parent().removeClass("active")
},nobind:true});
A.click(function(D){if(jQuery("#inline-dialog-"+B.INLINE_DIALOG_ID).is(":visible")){B.inlineDialog.hide()
}else{B.inlineDialog.show()
}});
return this.inlineDialog
},getInlineDialogTrigger:function(){return this.form.$element.find("#qf-field-picker-trigger")
},renderButtons:function(B){var A=this,C=jQuery('<ul class="qf-picker-buttons" />').appendTo(this.$content);
jQuery.each(B,function(E,F){var G,D;
if(A.isConfigurable){A.form.getFieldById(F.id).done(function(I){if(I&&I.hasVisibilityFeature()){var J=jQuery("<li />").appendTo(C);
var H=new JIRA.Forms.FieldPicker.ConfigurableButton({field:I});
H.render().appendTo(J);
A.buttons.push(H)
}})
}else{D=new JIRA.Forms.FieldPicker.UnconfigurableButton(F);
G=jQuery("<li />").appendTo(C);
D.render().appendTo(G)
}});
if(C.children().length===0){C.addClass("qf-no-fields").append("<li><em>"+"No fields can be configured for this tab"+"</em></li>")
}},renderContents:function(){var A=this,B=jQuery.Deferred();
this.form.model.getSortedTabs().done(function(C){if(C.length===1){A.renderButtons(C[0].fields)
}else{jQuery.each(C,function(D,E){if(E.fields.length>0){jQuery("<h4><span></span></h4>").appendTo(A.$content).find("span").text(E.label);
A.renderButtons(E.fields)
}})
}B.resolveWith(A,[A.$element])
});
return B.promise()
},show:function(){this.inlineDialog.show()
},render:function(){this.$element=jQuery(JIRA.Templates.QuickForm.fieldPicker({isConfigurable:this.isConfigurable}));
this.$content=this.$element.find(".qf-picker-content");
this._assignEvents("switchToCustom",this.$element.find(".qf-configurable"));
this._assignEvents("switchToAll",this.$element.find(".qf-unconfigurable"));
return this.renderContents()
},_events:{switchToCustom:{click:function(A){this.switchToCustom();
A.preventDefault()
}},switchToAll:{click:function(A){this.switchToAll();
A.preventDefault()
}}}});
JIRA.Forms.FieldPicker.UnconfigurableButton=AJS.Control.extend({init:function(A){this.descriptor=A
},render:function(){this.$element=jQuery(JIRA.Templates.QuickForm.unconfigurablePickerButton({required:this.descriptor.required,label:this.descriptor.label,fieldId:this.descriptor.id,isActive:true}));
return this.$element
}});
JIRA.Forms.FieldPicker.ConfigurableButton=AJS.Control.extend({init:function(B){var A=this;
this.field=B.field;
this.field.bind("disabled",function(){A.$element.removeClass("qf-active")
}).bind("activated",function(){A.$element.addClass("qf-active")
})
},toggle:function(){if(this.field.isActive()){this.field.disable()
}else{this.field.activate()
}},getId:function(){return this.field.getId()
},render:function(){this.$element=jQuery(JIRA.Templates.QuickForm.configurablePickerButton({required:this.field.descriptor.required,label:this.field.getLabel(),fieldId:this.field.getId(),isActive:this.field.isActive()}));
this._assignEvents("button",this.$element);
return this.$element
},_events:{button:{click:function(A){this.toggle();
A.preventDefault()
}}}});
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/form.js' */
JIRA.Forms.AbstractForm=AJS.Control.extend({submit:function(){var A=this;
A.getForm().addClass("submitting");
return JIRA.SmartAjax.makeRequest({url:this.getAction(),type:"POST",beforeSend:function(){A.disable()
},data:this.serialize(),complete:function(G,H,C){var E=C.data;
A.getForm().find(".aui-message-context").remove();
A.enable();
A.getForm().find(".error").remove();
if(C.successful){A.performAnalytics();
if(E&&E.fields){A.invalidateFieldsCache();
A.model.setFields(E.fields)
}if(typeof E==="string"){var F=AJS.$(AJS.extractBodyFromResponse(E));
var D=F.find("#atl_token").val();
if(D){A.model.atlToken=D;
A.getForm().find('input[name="atl_token"]').val(D)
}var B=new JIRA.FormDialog({offsetTarget:"body",content:F});
B._handleServerSuccess=function(){if(B.prev){B.prev._removeStackState();
B.prev._resetWindowTitle();
B._removeStackState()
}B.hide();
A.triggerEvent("sessionComplete",[],true);
A.handleSubmitSuccess()
};
B._handleServerError=function(I){B.hide();
A.handleSubmitError(I)
};
B.show()
}else{A.handleSubmitSuccess(C.data)
}}else{A.handleSubmitError(G)
}A.getForm().removeClass("submitting")
}})
},disable:function(){this.getForm().find(":input").attr("disabled","disabled").trigger("disable");
this.getForm().find(":submit").attr("disabled","disabled")
},enable:function(){this.getForm().find(":input").removeAttr("disabled").trigger("enable");
this.getForm().find(":submit").removeAttr("disabled")
},getActiveFieldIds:function(){throw new Error("getActiveFieldIds: Abstract, must be implemented by sub class")
},serialize:function(C){var A=this,B=this.getForm().serialize();
if(this.model.isInMultipleMode&&this.model.isInMultipleMode()){B=B+"&multipleMode=true"
}if(this.model.hasRetainFeature()){this.model.clearRetainedFields();
jQuery.each(this.getActiveFieldIds(),function(E,D){A.model.addFieldToRetainValue(D,C)
});
jQuery.each(this.model.getFieldsWithRetainedValues(),function(D,E){B=B+"&fieldsToRetain="+E
})
}return B
},invalidateFieldsCache:function(){delete this.fields
},setInitialFocus:function(){this.getFormContent().find(":input:first").focus()
},handleSubmitSuccess:function(){this.triggerEvent("submitted");
AJS.reloadViaWindowLocation()
},performAnalytics:function(){var A=function(D,E){var C="***** Analytics log ["+D+"]";
if(E){C+="["+JSON.stringify(E)+"]"
}AJS.log(C);
if(AJS.EventQueue){AJS.EventQueue.push({name:D,properties:E||{}})
}};
var B=function(E){var C={};
var F=_.filter(E,function(G){return !_.contains(["isCreateIssue","isEditIssue","atl_token","hasWorkStarted"],G.name)
});
var D=_.filter(F,function(G){return G.value!=""
});
_.each(D,function(H){var G=H.name;
if(!_.has(C,G)){C[G]=[]
}C[G].push(H.value)
});
return C
};
this.previousAnalytics=(function(K,O){var F=B(K);
var M=_.keys(F);
var G=_.keys(O.data);
var J=_.difference(M,G);
var N=_.difference(G,M);
var L=_.intersection(G,M);
var D=_.filter(L,function(P){return _.isEqual(O.data[P],F[P])
});
var C=_.difference(L,D);
var I=O.count+1;
var H=(JIRA.Dialog.current.options.id==="edit-issue-dialog");
var E={"atlassian.numCreates":I,"edit.form":H};
_.each(J,function(P){E[P]="added"
});
_.each(N,function(P){E[P]="removed"
});
_.each(D,function(P){E[P]="same"
});
_.each(C,function(P){E[P]="changed"
});
A("quick.create.fields",E);
return{data:F,count:I}
})(this.getForm().serializeArray(),this.previousAnalytics||{data:{},count:0})
},handleSubmitError:function(C){var A=this;
var D;
try{D=JSON.parse(C.responseText)
}catch(B){}if(D){if(D.errorMessages&&D.errorMessages.length){JIRA.applyErrorMessageToForm(this.getForm(),D.errorMessages[0])
}if(D&&D.errors&&C.status===400){if(this.getFieldById){jQuery.each(D.errors,function(E){if(/^timetracking/.test(E)){A.getFieldById("timetracking").done(function(F){JIRA.trigger(JIRA.Events.VALIDATE_TIMETRACKING,[A.$element]);
F.activate(true)
})
}else{if(/^worklog/.test(E)){A.getFieldById("worklog").done(function(F){JIRA.trigger(JIRA.Events.VALIDATE_TIMETRACKING,[A.$element]);
F.activate(true)
})
}else{A.getFieldById(E).done(function(F){F.activate(true)
})
}}})
}JIRA.applyErrorsToForm(this.getForm(),D.errors);
this.triggerEvent("validationError",[this,D.errors],true)
}}},getAction:function(){return this.action
},getFormContent:function(){return this.$element.find("div.content")
},getForm:function(){return this.$element.find("form")
},createField:function(){throw new Error("JIRA.Forms.AbstractForm: You must implement [createField] method in subclass.")
},render:function(C){var B=jQuery.Deferred(),A=this;
if(C){this.invalidateFieldsCache();
this.model.refresh(C).done(function(){A._render().done(function(E,D){A.triggerEvent("rendered",[A.$element]);
B.resolveWith(A,[A.$element,D])
})
})
}else{A._render().done(function(E,D){A.triggerEvent("rendered",[A.$element]);
B.resolveWith(A,[A.$element,D])
})
}return B.promise()
}});
JIRA.Forms.AbstractConfigurableForm=JIRA.Forms.AbstractForm.extend({getFields:function(){var B=jQuery.Deferred(),A=this;
if(!this.fields){this.fields=[];
this.model.getConfigurableFields().done(function(C){jQuery.each(C,function(D,F){var E=A.createField(F);
A.fields.push(E)
});
B.resolveWith(A,[A.fields])
})
}else{B.resolveWith(this,[this.fields])
}return B.promise()
},getActiveFieldIds:function(){var B=[],A=this.$element.find(".qf-field.qf-field-active:not(.qf-required)");
jQuery.each(A,function(D,E){var C=jQuery(E);
var F=C.data("model").getId();
B.push(F);
if(F==="attachment"){C.find(":checked").each(function(){B.push(this.id)
})
}});
return B
},createField:function(C){C.hasVisibilityFeature=this.model.hasVisibilityFeature(C);
if(this.model.hasRetainFeature(C)){C.hasRetainFeature=true;
C.retainValue=this.model.hasRetainedValue(C)
}var A=this,B=new JIRA.Forms.ConfigurableField(C);
if(C.hasVisibilityFeature){B.bind("activated",function(){A.model.setUserFields(A.getActiveFieldIds());
B.highlight();
A.triggerEvent("QuickForm.fieldAdded",[B])
}).bind("disabled",function(){A.model.setUserFields(A.getActiveFieldIds());
A.triggerEvent("QuickForm.fieldRemoved",[B])
})
}return B
},getFieldById:function(C){var A=this,B=jQuery.Deferred();
this.getFields().done(function(D){jQuery.each(D,function(E,F){if(F.getId()===C){B.resolveWith(A,[F])
}});
B.rejectWith(A,[])
});
return B.promise()
},hasNoVisibleFields:function(){var A=jQuery.Deferred();
A.resolve(this.getActiveFieldIds().length===0);
return A.promise()
},renderFormContents:function(){var C=jQuery.Deferred(),B=jQuery(),A=this;
A.getFields().done(function(D){A.model.getActiveFieldIds().done(function(E){jQuery.each(D,function(){var F=this.render();
B=B.add(F.scripts);
A.getFormContent().append(F.element)
});
jQuery.each(E,function(G,F){jQuery.each(D,function(){if(this.getId()===F){this.activate(true)
}})
});
jQuery.each(D,function(){if(!this.isActive()){this.disable(true)
}});
A.hasNoVisibleFields().done(function(G){if(G===true){for(var F=0;
F<3;
F++){if(D[F]){D[F].activate(true)
}}}C.resolveWith(this,[A.$element,B])
})
})
});
return C.promise()
}});
JIRA.Forms.AbstractUnconfigurableForm=JIRA.Forms.AbstractForm.extend({getFieldsHtml:function(){var A=this,B=jQuery.Deferred(),C={};
this.model.getTabs().done(function(D){if(D.length===1){C.fields=D[0].fields
}else{C.tabs=D;
C.hasTabs=true
}B.resolveWith(A,[JIRA.Templates.Issue.issueFields(C)])
});
return B.promise()
},getActiveFieldIds:function(){var A=[];
this.model.getFields().done(function(B){jQuery.each(B,function(C,D){A.push(D.id)
})
});
return A
},getFields:function(){var B=jQuery.Deferred(),A=this;
if(!this.fields){this.fields=[];
this.model.getFields().done(function(C){jQuery.each(C,function(D,F){var E=A.createField(F);
A.fields.push(E)
});
B.resolveWith(A,[A.fields])
})
}else{B.resolveWith(this,[this.fields])
}return B.promise()
}});
JIRA.Forms.Error=AJS.Control.extend({getErrorMessageFromSmartAjax:function(A){var B,C;
if(A.hasData&&A.status!==401){try{C=JSON.parse(A.data);
if(C.errorMessages&&C.errorMessages.length>0){B=JIRA.Templates.QuickForm.errorMessage({message:C.errorMessages[0]})
}else{B=JIRA.SmartAjax.buildDialogErrorContent(A,true).html()
}}catch(D){B=JIRA.SmartAjax.buildDialogErrorContent(A,true).html()
}}else{B=JIRA.SmartAjax.buildDialogErrorContent(A,true).html()
}return B
},render:function(B){var A=this.getErrorMessageFromSmartAjax(B);
return this._render(A)
}});
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/container.js' */
JIRA.Forms.Container=AJS.Control.extend({init:function(A){this.$element=jQuery("<div />").addClass("qf-container");
this.options=JIRA.makePropertyFunc(A);
this.fieldPicker=new JIRA.Forms.FieldPicker();
this.successData=[]
},decorateRenderers:function(){var A=this;
if(!this.fieldPicker.decorated){this.fieldPicker.bind("switchedToAll",function(){A.unconfigurableForm.render(A.currentView.serialize(true)).done(function(){A.fieldPicker.show()
})
});
this.fieldPicker.bind("switchedToCustom",function(){A.configurableForm.render(A.currentView.serialize(true)).done(function(){A.fieldPicker.show()
})
});
this.fieldPicker.decorated=true
}if(!this.configurableForm.decorated){this.configurableForm.bind("rendered",function(C,B){A.currentView=A.configurableForm;
A.fieldPicker.switchToCustom(true);
A.fieldPicker.setForm(A.configurableForm);
A.fieldPicker.bindInlineDialog();
A.applyGlobalDecorator(B);
A.model.setUseConfigurableForm(true);
A.triggerEvent("configurableFormRendered")
});
this.configurableForm.bind("submitted",function(C,B){A.successData.push(B);
A.triggerEvent("configurableFormSubmitted")
});
this.configurableForm.decorated=true
}if(!this.unconfigurableForm.decorated){this.unconfigurableForm.bind("rendered",function(C,B){A.fieldPicker.switchToAll(true);
A.fieldPicker.setForm(A.unconfigurableForm);
A.fieldPicker.bindInlineDialog();
A.currentView=A.unconfigurableForm;
A.applyGlobalDecorator(B);
A.model.setUseConfigurableForm(false);
A.triggerEvent("unconfigurableFormRendered")
});
this.unconfigurableForm.bind("submitted",function(C,B){A.successData.push(B);
A.triggerEvent("unconfigurableFormSubmitted")
});
this.unconfigurableForm.decorated=true
}},applyGlobalDecorator:function(C){function B(){if(A.currentView.setInitialFocus){A.currentView.setInitialFocus()
}}var A=this;
C.detach();
this.$element.html(C);
this.triggerEvent("contentRefreshed",[this.$element]);
if(jQuery.browser.msie){window.setTimeout(B,0)
}else{B()
}},asDialog:function(B){var A=this,C;
this.dialog=C=new JIRA.FormDialog({id:B.id,trigger:B.trigger,windowTitle:B.windowTitle,width:JIRA.Dialog.WIDTH_PRESETS.large,delayShowUntil:JIRA.Dialogs.waitForSavesToComplete,content:function(D){A.render().done(function(){D(A.$element)
});
A.triggerEvent("dialogShown")
},submitHandler:function(E,D){E.preventDefault();
A.currentView.submit().then(D,D)
},stacked:true});
if(B.id==="edit-issue-dialog"){jQuery(this.dialog).on("beforeShow",function(D){if(!jira.app.issue.getIssueKey()&&!jira.app.issuenavigator.isRowSelected()){D.preventDefault()
}})
}this.dialog._focusFirstField=function(){JIRA.FormDialog.prototype._focusFirstField.apply(this,["div.content :input:visible:first"])
};
this.bind("initialized",function(){this.unconfigurableForm.bind("sessionComplete",function(){C.hide()
});
this.configurableForm.bind("sessionComplete",function(){C.hide()
})
}).bind("contentRefreshed",function(){C.notifyOfNewContent()
});
C.bind("Dialog.hide",function(){if(A.successData.length){A.triggerEvent("sessionComplete",[A.successData],true);
A.successData=[]
}});
A.$element.ajaxStart(function(){C.showFooterLoadingIndicator()
}).ajaxStop(function(){C.hideFooterLoadingIndicator()
});
C.getQuickForm=function(){return A
};
C.dirtyFormWarning();
return C
},lazyInit:function(){var A=this,B=this.options.call(this);
this.model=B.model;
this.errorHandler=B.errorHandler;
this.globalEventNamespaces=B.globalEventNamespaces;
this.configurableForm=B.configurableForm;
this.unconfigurableForm=B.unconfigurableForm;
this.sessionComplete=B.sessionComplete;
this.model.clearRetainedFields();
this.configurableForm.invalidateFieldsCache();
this.model.bind("serverError",function(D,C){A.$element.html(A.errorHandler.render(C));
A.triggerEvent("contentRefreshed",[this.$element])
});
this.triggerEvent("initialized");
this.decorateRenderers()
},render:function(){var A=this,B=jQuery.Deferred();
this.lazyInit();
A.model.getUseConfigurableForm().done(function(C){if(C===true){A.configurableForm.render().done(function(E,D){B.resolveWith(A,[A.$element]);
A.$element.append(D)
})
}else{A.unconfigurableForm.render().done(function(E,D){B.resolveWith(A,[A.$element,D]);
A.$element.append(D)
})
}}).fail(function(){B.resolveWith(A,[A.$element])
});
return B.promise()
}});
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-edit-issue', location = 'js/Issue/edit.js' */
JIRA.Forms.EditIssueModel=JIRA.Forms.Model.extend({getUnconfigurableTabs:function(){var A=this,B=jQuery.Deferred();
A.getTabs().done(function(D){var C=D.slice(0);
C[0].fields=C[0].fields.slice(0);
jQuery.each(C[0].fields,function(E,F){if(F.id==="comment"){C[0].fields.splice(E,1);
return false
}});
B.resolve(C)
});
return B.promise()
},getCommentField:function(){var A=jQuery.Deferred();
this.getFields().done(function(B){jQuery.each(B,function(C,D){if(D.id==="comment"){A.resolve(D)
}});
A.reject()
});
return A.promise()
}});
JIRA.Forms.EditIssueError=JIRA.Forms.Error.extend({_render:function(A){return jQuery(JIRA.Templates.Issue.editIssueError({errorHtml:A,useLegacyDecorator:JIRA.useLegacyDecorator()}))
}});
JIRA.Forms.UnconfigurableEditIssueForm=JIRA.Forms.AbstractUnconfigurableForm.extend({init:function(A){this.globalEventNamespaces=A.globalEventNamespaces||[];
this.model=A.model;
this.issueId=A.issueId;
this.title=A.title;
this.action=contextPath+"/secure/QuickEditIssue.jspa?issueId="+A.issueId+"&decorator=none";
this.$element=jQuery("<div class='qf-unconfigurable-form' />")
},getFieldsHtml:function(){var A=this,B=jQuery.Deferred(),C={};
this.model.getUnconfigurableTabs().done(function(D){if(D.length===1){C.fields=D[0].fields
}else{C.tabs=D;
C.hasTabs=true
}B.resolveWith(A,[JIRA.Templates.Issue.issueFields(C)])
});
return B.promise()
},handleSubmitSuccess:function(A){this.triggerEvent("submitted",[A]);
this.triggerEvent("issueEdited",[A]);
this.triggerEvent("sessionComplete")
},_render:function(){var B=jQuery.Deferred(),A=this;
this.getFieldsHtml().done(function(C){var D={fieldsHtml:C,title:A.title,issueId:A.issueId,atlToken:A.model.getAtlToken(),useLegacyDecorator:JIRA.useLegacyDecorator(),modifierKey:AJS.Navigator.modifierKey(),showFieldConfigurationToolBar:!JIRA.Users.LoggedInUser.isAnonymous()};
this.model.getCommentField().then(function(G){var F,E;
D.commentField=G;
F=JIRA.Templates.Issue.editIssueForm(D);
E=JIRA.extractScripts(F);
A.$element.html(E.html);
B.resolveWith(A,[A.$element,E.scripts])
},function(){var F=JIRA.Templates.Issue.editIssueForm(D),E=JIRA.extractScripts(F);
A.$element.html(E.html);
B.resolveWith(A,[A.$element,E.scripts])
})
});
return B.promise()
}});
JIRA.Forms.ConfigurableEditIssueForm=JIRA.Forms.AbstractConfigurableForm.extend({init:function(A){this.model=A.model;
this.globalEventNamespaces=A.globalEventNamespaces||[];
this.issueId=A.issueId;
this.title=A.title;
this.action=contextPath+"/secure/QuickEditIssue.jspa?issueId="+A.issueId+"&decorator=none";
this.$element=jQuery("<div />").addClass("qf-form qf-configurable-form")
},handleSubmitSuccess:function(A){this.triggerEvent("submitted",[A]);
this.triggerEvent("issueEdited",[A]);
this.triggerEvent("sessionComplete")
},hasNoVisibleFields:function(){var A=jQuery.Deferred(),B=this.getActiveFieldIds();
this.model.getUserFields().done(function(C){if(C.length===1&&C[0]==="comment"){A.resolve(false)
}else{if(B.length===0||(B.length===1&&B[0]==="comment")){A.resolve(true)
}else{A.resolve(false)
}}});
return A.promise()
},_render:function(){var B=jQuery.Deferred(),A=this,C=JIRA.Templates.Issue.editIssueForm({issueId:this.issueId,title:this.title,atlToken:A.model.getAtlToken(),isConfigurable:true,useLegacyDecorator:JIRA.useLegacyDecorator(),modifierKey:AJS.Navigator.modifierKey(),showFieldConfigurationToolBar:!JIRA.Users.LoggedInUser.isAnonymous()});
this.$element.html(C);
A.renderFormContents().done(function(E,D){A.getFieldById("comment").done(function(F){A.getFormContent().append(F.$element)
});
B.resolveWith(A,[A.$element,D])
});
return B.promise()
}});
JIRA.Forms.Model.createQuickEditIssueModel=function(A){return new JIRA.Forms.EditIssueModel({fieldsResource:contextPath+"/secure/QuickEditIssue!default.jspa?issueId="+A+"&decorator=none",userFieldsResource:contextPath+"/rest/quickedit/1.0/userpreferences/edit"})
};
JIRA.Dialog.shouldShowIssueKeyInTitle=function(){return JIRA.Issues||JIRA.IssueNavigator.isNavigator()||JIRA.Dialog.getAttrFromActiveTrigger("data-issueKey")
};
JIRA.Forms.createEditIssueForm=function(){function A(C){var D=JIRA.Dialog.getAttrFromActiveTrigger("data-issueId");
if(jQuery.isFunction(C.issueId)){return C.issueId(C)
}else{if(C.issueId){return C.issueId
}else{if(D){return D
}else{return JIRA.Issue.getIssueId()||JIRA.IssueNavigator.getSelectedIssueId()
}}}}function B(){var C="Edit Issue";
if(JIRA.Dialog.shouldShowIssueKeyInTitle()){return JIRA.Dialog.getIssueActionTitle(C)
}else{return C
}}return function(C){C=C||{};
return new JIRA.Forms.Container(function(){var H=A(C),G=B(),D=JIRA.Forms.Model.createQuickEditIssueModel(H),F=new JIRA.Forms.ConfigurableEditIssueForm({title:G,model:D,issueId:H,globalEventNamespaces:["QuickEdit"]}),E=new JIRA.Forms.UnconfigurableEditIssueForm({title:G,model:D,issueId:H,globalEventNamespaces:["QuickEdit"]});
return{globalEventNamespaces:["QuickEdit"],model:D,errorHandler:new JIRA.Forms.EditIssueError(),configurableForm:F,unconfigurableForm:E}
})
}
}();
jQuery(function(){JIRA.Forms.createEditIssueForm().asDialog({windowTitle:function(){return JIRA.Dialog.getIssueActionTitle("Edit Issue")
},trigger:".issueaction-edit-issue",id:"edit-issue-dialog"});
jQuery(document).bind("dialogContentReady",function(){AJS.tabs.setup()
})
});
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-edit-issue', location = 'js/Issue/issue.soy' */
// This file was automatically generated from issue.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Issue == 'undefined') { JIRA.Templates.Issue = {}; }


JIRA.Templates.Issue.editIssueError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Edit Issue"), '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-body', '">', opt_data.errorHtml, '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.editIssueForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" name="jiraform" class="aui"><h2>', (opt_data.showFieldConfigurationToolBar) ? '<div class="qf-form-operations aui-toolbar"><div class="toolbar-split toolbar-split-right"><div class="toolbar-group"><span class="toolbar-item"><a href="#" class="toolbar-trigger" id="qf-field-picker-trigger"><span class="icon icon-tools"></span>' + soy.$$escapeHtml("Configure Fields") + '<span class="icon drop-menu"></span></a></span></div></div></div>' : '', opt_data.title, '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-body', '"><input type="hidden" name="id" value="', soy.$$escapeHtml(opt_data.issueId), '" /><input type="hidden" name="atl_token" value="', soy.$$escapeHtml(opt_data.atlToken), '" /><div class="content">', (opt_data.fieldsHtml) ? opt_data.fieldsHtml : '', (opt_data.commentField) ? opt_data.commentField.editHtml : '', '<!-- fields inserted here via javascript --></div></div><div class="buttons-container ', (opt_data.useLegacyDecorator) ? 'content-footer' : 'form-footer', '"><div class="buttons"><input accesskey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="button" id="edit-issue-submit" name="Edit" type="submit" value="', soy.$$escapeHtml("Update"), '" /><a href="#" accesskey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="cancel">', soy.$$escapeHtml("Cancel"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.issueFields = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.hasTabs) {
    output.append('<div class="aui-tabs horizontal-tabs" id="horizontal"><ul class="tabs-menu">');
    var tabList66 = opt_data.tabs;
    var tabListLen66 = tabList66.length;
    for (var tabIndex66 = 0; tabIndex66 < tabListLen66; tabIndex66++) {
      var tabData66 = tabList66[tabIndex66];
      output.append((tabData66) ? '<li class="menu-item ' + ((tabData66.isFirst) ? 'first active-tab' : '') + ' "><a href="#tab-' + soy.$$escapeHtml(tabData66.position) + '" ><strong>' + soy.$$escapeHtml(tabData66.label) + '</strong></a></li>' : '');
    }
    output.append('</ul>');
    var tabList80 = opt_data.tabs;
    var tabListLen80 = tabList80.length;
    for (var tabIndex80 = 0; tabIndex80 < tabListLen80; tabIndex80++) {
      var tabData80 = tabList80[tabIndex80];
      if (tabData80) {
        output.append('<div class="tabs-pane ', (tabData80.isFirst) ? 'active-pane' : '', '" id="tab-', soy.$$escapeHtml(tabData80.position), '">');
        var fieldList90 = tabData80.fields;
        var fieldListLen90 = fieldList90.length;
        for (var fieldIndex90 = 0; fieldIndex90 < fieldListLen90; fieldIndex90++) {
          var fieldData90 = fieldList90[fieldIndex90];
          output.append((fieldData90.editHtml) ? fieldData90.editHtml : '');
        }
        output.append('</div>');
      }
    }
    output.append('</div>');
  } else {
    var fieldList100 = opt_data.fields;
    var fieldListLen100 = fieldList100.length;
    for (var fieldIndex100 = 0; fieldIndex100 < fieldListLen100; fieldIndex100++) {
      var fieldData100 = fieldList100[fieldIndex100];
      output.append((fieldData100.editHtml) ? fieldData100.editHtml : '');
    }
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.createIssueForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form name="jiraform" action="#" class="aui"><h2>', (opt_data.showFieldConfigurationToolBar) ? '<div class="qf-form-operations aui-toolbar"><div class="toolbar-split toolbar-split-right"><div class="toolbar-group"><span class="toolbar-item"><a href="#" class="toolbar-trigger" id="qf-field-picker-trigger"><span class="icon icon-tools"></span>' + soy.$$escapeHtml("Configure Fields") + '<span class="icon drop-menu"></span></a></span></div></div></div>' : '', soy.$$escapeHtml(opt_data.title), '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-body', '">');
  if (opt_data.issueSetupFields) {
    output.append('<div class="issue-setup-fields">');
    var fieldList124 = opt_data.issueSetupFields;
    var fieldListLen124 = fieldList124.length;
    for (var fieldIndex124 = 0; fieldIndex124 < fieldListLen124; fieldIndex124++) {
      var fieldData124 = fieldList124[fieldIndex124];
      output.append('<div class="qf-field qf-field-', soy.$$escapeHtml(fieldData124.id), ' qf-required">', fieldData124.editHtml, '</div>');
    }
    output.append('</div>');
  }
  output.append((opt_data.parentIssueId) ? '<input type="hidden" name="parentIssueId" value="' + soy.$$escapeHtml(opt_data.parentIssueId) + '" />' : '', '<input type="hidden" name="atl_token" value="', soy.$$escapeHtml(opt_data.atlToken), '" /><div class="content">', (opt_data.fieldsHtml) ? opt_data.fieldsHtml : '', '<!-- fields inserted here via javascript --></div></div><div class="buttons-container ', (opt_data.useLegacyDecorator) ? 'content-footer' : 'form-footer', '"><div class="buttons"><label for="qf-create-another" class="qf-create-another"><input id="qf-create-another" type="checkbox" ', (opt_data.multipleMode) ? 'checked="checked"' : '', ' />', soy.$$escapeHtml("Create another"), '</label><input accesskey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="button" id="create-issue-submit" name="Edit" type="submit" value="', soy.$$escapeHtml("Create"), '" /><a href="#" accesskey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="cancel">', soy.$$escapeHtml("Cancel"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.createIssueError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Create Issue"), '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-footer', '">', opt_data.errorHtml, '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.undealtErrors = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div>', soy.$$escapeHtml("There were some errors when trying to create this issue"), '</div><ul>');
  var errorList187 = opt_data.errors;
  var errorListLen187 = errorList187.length;
  for (var errorIndex187 = 0; errorIndex187 < errorListLen187; errorIndex187++) {
    var errorData187 = errorList187[errorIndex187];
    output.append('<li>', soy.$$escapeHtml(errorData187), '</li>');
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'is.origo.jira.tempo-plugin:tempo-global', location = 'com/tempoplugin/js/tempo.global.js' */
var tempo=(function(x){var E="%e/%b/%y";var s="%e/%b/%y %H:%M";var n="Period is invalid";var d="You must be logged in to JIRA to perform this action. Session might have timed out!";var f="(|.*?(\\s+|\\())({0})(.*)";x.extend(x.expr[":"],{focus:function(M){return M==document.activeElement}});x.fn.fixDirtyForm=function(){x(this).addClass("ajs-dirty-warning-exempt");if(AJS.DIRTY_FORM_VALUE){return this.data(AJS.DIRTY_FORM_VALUE,null)}return this};x.fn.cleanFormValidation=function(){var M=x(this);var N=M.find("ul.error-list");M.find(":input:visible").removeClass("error-field").removeClass("valid");N.empty();return this};x.fn.resetFormFields=function(){var M=x(this);M.find(".resetable :checkbox").attr("checked",false);M.find(".resetable select, .resetable textarea, .resetable input[type=text]").val("");M.find(".enddate").hide();M.find("select.tempoDynamicDropDown").empty();M.find("select.tempoDynamicDropDown").attr("selectedValue","");return this};var C=AJS.SingleSelect.extend({submitForm:function(){if(!this.suggestionsVisible){this.handleFreeInput();if(this.options.submitHandler){this.options.submitHandler()}}},setFieldWidth:function(N,M){M=M||N;this.$container.css({width:N,minWidth:N});this.$field.width(N);this.dropdownController.$layer.css({width:M,minWidth:M})},setDropdownWidthForTimesheet:function(M){if(M&&M.timesheet&&this.$container){var P=JIRA.Version.isGreaterThanOrEqualTo("6");var O=500;var N=P?205:250;this.setFieldWidth(N,O)}}});x.fn.tempoFormatAccountPicker=function(M){var N=[];x(M).each(function(P,O){x(O.group).each(function(R,Q){var S=new AJS.GroupDescriptor({weight:R,id:"tempo-report-account-search-"+R,replace:true,label:Q.title});x(Q.item).each(function(){S.addItem(new AJS.ItemDescriptor({value:this.type+"-"+this.key,label:this.name,html:this.html,allowDuplicate:false}))});N.push(S)})});return N};x.fn.tempoAccountPicker=function(N){var P=x(this);var O={};var M=new C({element:P,showDropdownButton:true,removeOnUnSelect:false,matchingStrategy:f,submitInputVal:true,noQueryNoRequest:false,ajaxOptions:{url:contextPath+"/rest/tempo-rest/2.0/accounts/picker",query:true,minQueryLength:1,data:O,formatResponse:x.fn.tempoFormatAccountPicker}});M.setDropdownWidthForTimesheet(N)};x.fn.tempoFilterPicker=function(N){var P=x(this);var O={};var M=new C({element:P,showDropdownButton:true,removeOnUnSelect:false,matchingStrategy:f,submitInputVal:true,noQueryNoRequest:false,ajaxOptions:{url:contextPath+"/rest/tempo-rest/2.0/filters/picker",query:true,minQueryLength:1,data:O,formatResponse:function(R){var S=[];if(N&&N.timesheet){M.setDropdownWidthForTimesheet(N);var Q=new AJS.GroupDescriptor({weight:0,id:"tempo-default-suggested",replace:true});Q.addItem(new AJS.ItemDescriptor({value:"-1001",label:"User Timesheet",allowDuplicate:false}))}x(R).each(function(U,T){var V=new AJS.GroupDescriptor({weight:U+1,id:"tempo-report-filter-suggested-"+1,replace:true,label:"Filters"});x(T.filters).each(function(){var W=this.name;if(this.description){W+=" ("+this.description+")"}V.addItem(new AJS.ItemDescriptor({value:""+this.id,label:W,allowDuplicate:false}))});S.push(Q);S.push(V)});return S}}})};x.fn.tempoFormatAdvancedSearchResponse=function(M){var N=[];x(M).each(function(O,P){x(P.group).each(function(R,Q){var S=new AJS.GroupDescriptor({weight:R,id:"tempo-report-search-"+R,replace:true,label:Q.title});x(Q.item).each(function(){var T=new AJS.ItemDescriptor({value:""+this.id,label:this.name,html:this.html,allowDuplicate:false});S.addItem(T)});N.push(S)})});return N};x.fn.tempoAdvancedTimesheetPicker=function(N){var P=x(this);var O={};var M=new C({element:P,showDropdownButton:true,matchingStrategy:f,removeOnUnSelect:false,submitInputVal:true,noQueryNoRequest:false,ajaxOptions:{url:contextPath+"/rest/tempo-rest/2.0/search/picker",query:true,minQueryLength:1,data:O,formatResponse:x.fn.tempoFormatAdvancedSearchResponse}});M.setDropdownWidthForTimesheet(N)};x.fn.tempoFormatIssueResponse=function(M){var N=[];x(M).each(function(P,O){x(O.group).each(function(R,Q){var S=new AJS.GroupDescriptor({weight:R,id:"tempo-report-issue-search-"+R,replace:true,label:Q.title});x(Q.item).each(function(){S.addItem(new AJS.ItemDescriptor({value:this.key,label:this.key+" - "+this.name,allowDuplicate:false,title:this.name,icon:contextPath+this.icon}))});N.push(S)})});return N};x.fn.tempoIssuePicker=function(O){var M;if(O!=null&&O.type!=null){M=O.type}else{M=""}var Q=x(this);var P={};var N=new C({submitHandler:O?O.submitHandler:null,element:Q,showDropdownButton:true,removeOnUnSelect:false,submitInputVal:true,noQueryNoRequest:false,ajaxOptions:{url:contextPath+"/rest/tempo-rest/2.0/issues/picker/"+M,query:true,minQueryLength:1,data:P,formatResponse:x.fn.tempoFormatIssueResponse}});N.setDropdownWidthForTimesheet(O)};x.fn.tempoFormatProjectResponse=function(M){var N=[];x(M).each(function(P,O){x(O.group).each(function(R,Q){var S=new AJS.GroupDescriptor({weight:R,id:"tempo-report-project-search-"+R,replace:true,label:Q.title});x(Q.item).each(function(){S.addItem(new AJS.ItemDescriptor({value:this.id+"",label:this.name+" ("+this.key+")",html:this.html,icon:contextPath+this.icon,title:this.name,allowDuplicate:false}))});N.push(S)})});return N};x.fn.tempoSingleProjectPicker=function(N){var P=x(this);var O={};var M=new C({element:P,matchingStrategy:f,showDropdownButton:true,removeOnUnSelect:false,submitInputVal:true,noQueryNoRequest:false,ajaxOptions:{url:contextPath+"/rest/tempo-rest/2.0/projects/picker",query:true,minQueryLength:1,data:O,formatResponse:x.fn.tempoFormatProjectResponse}});M.setDropdownWidthForTimesheet(N)};x.fn.tempoFormatUserResponse=function(M){return[new AJS.GroupDescriptor({items:_.map(_.sortBy(M.users,"label"),function(N){return new AJS.ItemDescriptor({highlighted:true,html:N.html,label:N.displayName,value:""+N.name,title:N.displayName,icon:N.avatarUrl})})})]};x.fn.tempoSingleUserPicker=function(M){var N;if(M!=null&&M.type!=null){N=M.type}else{N=""}x(this).each(function(R){var Q=x(this);var P={showAvatar:true};var O=new C({submitHandler:M?M.submitHandler:null,element:Q,showDropdownButton:true,matchingStrategy:f,removeOnUnSelect:false,submitInputVal:true,noQueryNoRequest:true,ajaxOptions:{url:contextPath+"/rest/tempo-rest/2.0/users/picker/"+N,query:true,minQueryLength:1,data:P,formatResponse:x.fn.tempoFormatUserResponse}});O.setDropdownWidthForTimesheet(M);Q.data("userPicker",O);Q.bind("change",function(){var T=Q.closest("form");var S=T.find(":input[name=user]").val();var V=T.find("input[name=date]");var U=T.find("input[name=enddate]");g(T,S,V,U)})})};x.fn.tempoFormatTeamResponse=function(M){var N=[];x(M).each(function(P,O){var Q=new AJS.GroupDescriptor({weight:P,id:"tempo-report-team-search",replace:true});x(O.teams).each(function(){Q.addItem(new AJS.ItemDescriptor({value:""+this.id,label:this.name,html:this.html,allowDuplicate:false}))});N.push(Q)});return N};x.fn.tempoSingleTeamPicker=function(N){var P=x(this);var O={};var M=new C({element:P,matchingStrategy:f,showDropdownButton:true,removeOnUnSelect:false,submitInputVal:true,noQueryNoRequest:true,ajaxOptions:{url:contextPath+"/rest/tempo-rest/2.0/teams/picker",query:true,minQueryLength:1,data:O,formatResponse:x.fn.tempoFormatTeamResponse}})};x.fn.tempoSingleActivityPicker=function(N){var P=x(this);var O={projectId:function(){return x("#tempo-report-project").val()}};var M=new C({element:P,showDropdownButton:true,removeOnUnSelect:false,matchingStrategy:f,submitInputVal:true,noQueryNoRequest:false,ajaxOptions:{url:contextPath+"/rest/tempo-rest/2.0/activities/picker",query:true,minQueryLength:1,data:O,formatResponse:function(Q){var R=[];x(Q).each(function(S,T){x(T.group).each(function(V,U){var W=new AJS.GroupDescriptor({weight:V,id:"tempo-report-activity-search"+V,replace:true,label:U.title});x(U.item).each(function(){var X=new AJS.ItemDescriptor({value:this.type+"-"+this.id,label:this.name,html:this.html,allowDuplicate:false});W.addItem(X)});R.push(W);M.setDropdownWidthForTimesheet(N)})});return R}}})};x.fn.tempoMultiUserPicker=function(M){var N;if(M!=null){N=M.type}else{N=""}x(this).each(function(R){var Q=x(this);var P={showAvatar:true};var O=new AJS.MultiSelect({element:Q,showDropdownButton:true,removeOnUnSelect:false,submitInputVal:true,noQueryNoRequest:true,ajaxOptions:{url:contextPath+"/rest/api/1.0/users/picker"+N,query:true,minQueryLength:3,data:P,formatResponse:function(T){var S=[];x(T).each(function(V,U){var W=new AJS.GroupDescriptor({weight:V,label:U.footer});x(U.users).each(function(){W.addItem(new AJS.ItemDescriptor({value:this.name,label:this.displayName,html:this.html,icon:this.avatarUrl,allowDuplicate:false,highlighted:true}))});S.push(W)});return S}}});Q.data("userPicker",O);Q.bind("change",function(){var T=Q.closest("form");var S=T.find(":input[name=user]").val();var V=T.find("input[name=date]");var U=T.find("input[name=enddate]");g(T,S,V,U)})})};x.fn.tempoDatePicker=function(M){x(this).each(function(){var W=x(this);var S=W.find("input");var Q=W.find("img,span.icon-date");var V=S.attr("id");var R=Q.attr("id");var T=W.hasClass("ISO8061WeekNumbers");var U=W.hasClass("showStartTime");var O=E;if(U){O=s}Calendar.setup({context:W,firstDay:0,inputField:V,button:R,align:"Tl",singleClick:true,ifFormat:O,daFormat:O,showsTime:U,timeFormat:"24",useISO8601WeekNumbers:T,electric:false});if(M.validate){var N=S.closest(".tempo-datepicker");var P=N.closest("form");Q.bind("click",function(){Q.data("cal",window.calendar)}).closest("a").bind("keyup",function(X){if(X.keyCode==32){Q.trigger("click")}});S.bind("blur",function(){var X=Q.data("cal");if(X){X.callCloseHandler()}}).bind("change",function(){P.cleanFormValidation();var Y=P.find("input[name=planning]").val()=="true";var X=P.find(":input[name=user]").val();if(!X){X=P.find("select.dialog-user-picker").val()}var Z=i(S,X,Y);var ab=N.find(":checkbox").is(":checked");if(Z){var ad=N.find("input[name=date]");var ac=N.find("input[name=enddate]");var aa=P.find("input.availability");if(ab){if(this.name=="date"){if(ac.val()==""){return}Z=i(ac,X,Y)}else{Z=i(ad,X,Y)}if(Z){Z=u(ad.val(),ac.val(),P.find("input[name=startTimeEnabled]").val()==="true");if(!Z){P.find("ul.error-list").append(x("<li/>").text(n))}else{P.find("input[name=time]").trigger("change");g(P,X,ad,ac)}}}else{g(P,X,ad,ac)}}return true})}});return this};function g(O,M,S,R){if(!M){return}var Q=O.find("input.availability");if(Q.length===1){var N=contextPath+"/rest/tempo-rest/2.0/user/getUser";if(!O.find(".showperiod").is(":checked")||R.val()==""){R=S}var P={from:S.val(),to:R.val(),username:M};x.ajax({url:N,cache:false,data:P,success:function(T){O.find("input.availability").val(T.availableString);O.find("input.workingdays").val(T.workDaysString)},error:function(U,T,V){alert(T)}})}}function j(O,S,P){if(P!=""){var M=O.find(":input[name=issue]");if(M.val()!=""){var R=O.find("input[name=date]");var Q=O.find("input[name=enddate]");var N=O.find("input[name=user]").val();if(!N){N=O.find("select.dialog-user-picker").val()}if(!Q.is(":visible")){Q=R}x.ajax({data:{username:N},async:false,url:contextPath+"/rest/tempo-rest/1.0/worklogs/remainingEstimate/calculate/"+M.val()+"/"+J(R.val())+"/"+J(Q.val())+"/"+P,cache:false,success:function(T){S.val(T);if(S.is(":focus")){S.select()}},error:function(U,T,V){if(V=="Unauthorized"){alert(d)}else{alert(T)}}})}}}x.fn.tempoTimePicker=function(){x.each(x(this),function(){var M=x(this);var P=M.closest("form");var N=P.find(":input[name=issue]");var Q=M.find(":input[name=time]");var S=M.find("input[name=remainingEstimate]");var R=M.find("input[name=billedTime]");var O=P.find("div.tempo-datepicker");Q.bind("blur",function(U){if(N.find("option").val()&&N.val()==null){var T=N.find("option").val();N.val(T);x("select.tempo-issue-picker").trigger("change")}if(S.length>0||R.length>0){if(R.length>0){R.val(this.value)}if(S.length>0){j(P,S,this.value)}}});O.bind("change",function(){if(O.find("div.enddate").is(":visible")){Q.trigger("blur")}})});return this};function p(Q,P,M){if(P.error!=undefined&&P.error!=null&&P.error!=""){alert("Error in TDD query: "+P.error);return}Q.empty();var N=Q.attr("selectedValue");var O=N;x.each(P.values,function(R,S){x("<option/>").val(S.key).text(S.value).appendTo(Q);if(S.key==N&&S.key!=""){O=S.value}});if(N){Q.val(N)}if(N&&Q.val()!=N){O=N+" - "+"Unknown account";x("<option/>").val(N).text(O).appendTo(Q);Q.val(N)}if(O!=""){Q.siblings("span.edit-select").text(O)}}var w={};var B={};function m(P,N){var O=B[N];if(O==null){var M=!tempo.isEmptyString(P.attr("issueKey"));O=x.ajax({async:M,url:encodeURI(N),dataType:"jsonp",success:function(Q){w[N]=Q},error:function(R,Q,S){alert("Got error in TDD query: "+R+", status: "+Q+", error: "+S+", element: "+P.attr("id")+", URL:"+N)}});B[N]=O}return O}function G(M,P){var N=w[M];if(N==null){var O=m(P,M);O.done(function(Q){p(P,Q,M)})}else{p(P,N,M)}}var b={};var h={};function o(M,P){var N=M+":"+P;var O=h[N];if(O==null){O=x.ajax({async:true,cache:false,url:contextPath+"/rest/tempo-rest/1.0/worklogs/customFieldValue/"+M+"/"+P,success:function(Q){b[N]=Q}});h[N]=O}return O}function D(N,O,M){return N.replace("{"+O+"}",M)}function a(N,R,M,Q){var O=b[N];if(O==null){var P=o(M,Q);P.done(function(S){if(!tempo.isEmptyString(S)){G(D(N,Q,S),R)}})}else{if(!tempo.isEmptyString(O)){G(D(N,Q,O),R)}}}x.fn.populateDynamicDropdown=function(M){x(this).each(function(){var W=x(this);var P=M;if(P==null){P=W.attr("issueKey")}var O=W.attr("externalURL");if(tempo.isEmptyString(O)){return}if(O.indexOf("{")>0){if(tempo.isEmptyString(P)){return}var T=O.indexOf("{")+1;var R=O.indexOf("}");var N=O.substr(T,(R-T));var S=W.attr("id");var V=S.substr(0,S.indexOf("_"));var U=P;var Q=x("#"+V+N);if(Q.length>0){U=Q.val()}else{if(N!="IssueKey"){a(O,W,P,N);return}}if(tempo.isEmptyString(U)){return}O=D(O,N,U)}G(O,W)});return this};function J(M){return M.replace(/\//g,"-")}var F={};function i(N,M,O){var P=false;var Q=M+"_"+N.val()+"_"+O;if(F[Q]){P=F[Q]}else{x.ajax({type:"POST",url:contextPath+"/rest/tempo-rest/1.0/worklogs/validation/date/full",async:false,data:{date:N.val(),formFieldId:N.attr("name"),user:M,planning:O},success:function(R){P=H(R,N.closest("form"))}});F[Q]=P}return P}function u(O,N,M){var Q=Date.parseDate(O,E);if(M){Q=Date.parseDate(O,s)}var P=Date.parseDate(N,E);return Q.getTime()<=P.getTime()}function H(M,N){var P=N.find("ul.error-list");var O=true;x(M).find("submit-result").each(function(){var Q=x(this);if(Q.attr("valid")=="false"){Q.find("errors").each(function(){var R=x(this);P.append(x("<li/>").text(R.find("errorMessage").text()))});O=false}});return O}function v(N,M){tb_show(this.innerHTML,"#TB_inline?height="+M+"&amp;width=780&amp;inlineId="+N+"&amp;modal=true")}var L={dirty:false,locked:false,popup_title:{}};var c=x('<div id="tempo-blanket"/>').css("z-index","2000").css("height","100%").hide();var z={show:function(M){c.addClass("aui-blanket").css("z-index",M||"2000").show();if(x.fancybox){x.fancybox.showActivity()}else{x("div.aui-loading").show()}},hide:function(){c.removeClass("aui-blanket").css("z-index","2000").hide();x("div.aui-loading").hide();if(x.fancybox){x.fancybox.hideActivity()}}};var K=function(M){z.show();if(M){window.location=M}else{window.location.reload()}return this};function q(){x("#submitSearch").addClass("refresh-required")}function r(P){if(tempo.state.locked){return}tempo.spinner.show("9000");tempo.state.locked=true;x(":button").attr("disabled",true);var O=x(this).find("form");var R=O.find("ul.error-list");var M=O.find("input[name=user]").val();if(!M){M=x(O.find("select.dialog-user-picker").val()).get(0)}var Q=O.serialize();var N=O.attr("action");N=N.replace("{issueKey}",O.find(":input[name=issue]").val());N=N.replace("{id}",O.find("input[name=id]").val());N=N.replace("{type}",O.find("input[name=type]").val());x.ajax({async:true,type:"POST",url:N,data:Q,success:function(S){O.cleanFormValidation();x(S).find("submit-result").each(function(){var T=x(this);if(T.attr("valid")=="false"){T.find("errors").each(function(){var W=x(this);var X=W.find("formFieldId").text();x('[name="'+X+'"]',O).addClass("error-field");R.append(x("<li/>").text(W.find("errorMessage").text()))})}else{tempo.state.dirty=true;O.fixDirtyForm();if(O.find("input[name=tracker]").val()=="true"){tempobar.stopTracker()}if(P.type=="add-close"||P.type=="update"||P.type=="move"||P.type=="split"){tempo.reload();return}else{O.resetFormFields();if(O.find(":input[name=planning]").val()=="true"){var V=O.find("input[name=date]");var U=O.find("input[name=enddate]");g(O,M,V,U)}else{tempo.issue.get(O.find(":input[name=issue]").val(),O)}O.find("select.tempoDynamicDropDown").populateDynamicDropdown(O.find(":input[name=issue]").val())}}});x(":button").attr("disabled",false);tempo.spinner.hide();tempo.state.locked=false},error:function(S,U,T){if(T=="Unauthorized"){alert(d)}else{if(U=="timeout"){alert("Add hours failed - Service timed out - Please try again")}else{alert(tempo.extractErrorMessage(S.responseText))}}x(":button").attr("disabled",false);tempo.spinner.hide();tempo.state.locked=false},dataType:"xml"})}function k(M){return M==undefined||M==null||M.length==0}function t(M){return M.match(/(.*)\((.*)\).*/)}var I=function(){};var y=AJS||JIRA?{Dropdown:AJS.Dropdown?AJS.Dropdown:AJS.DropDown,formatSuccess:jira.app.fragments?jira.app.fragments.issueActionsFragment:JIRA.FRAGMENTS.issueActionsFragment,FormPopup:AJS.FormPopup||(JIRA?JIRA.FormDialog:I),containDropdown:AJS.containDropdown||(JIRA?JIRA.containDropdown:I),sessionStorage:(jira.app.session?jira.app.session.storage:JIRA.SessionStorage)}:{};function A(N){var M=AJS.$(N).find("message").text();if(M){return M}return N}function l(){var P=x(this).closest("form");P.find(".enddate").toggle(this.checked);P.find("input[name=date]").trigger("change");var N=P.find("label.timepicker-label");var O=N.attr("tmp");var M=N.text();N.attr("tmp",M);N.text(O)}function e(O){var Q=x("#timesheet-mlink");if(Q.length>0){if(jira.app.issue.getIssueKey()){var M=(O.planning==true)?"TempoAllocateTime!default.jspa?type=issue&id=":"TempoAddHours!default.jspa?id=";var N=contextPath+"/secure/"+M+jira.app.issue.getIssueId();var R=x("<a>").attr("href",N).addClass("issueaction-tempo-add-hours-on-issue hidden");x("header").first().append(R);R.click().remove()}else{var P=(O.planning==true)?x("#tempo-plan-button"):x("#tempo-add-button");if(P.length===1){P.click()}else{window.location=Q.attr("href")}}}}return{$:x,DATE_FORMAT:E,DATE_TIME_FORMAT:s,MATCHING_STRATEGY:f,spinner:z,reload:K,requireReload:q,state:L,submit:r,changeDateFormatForRest:J,calculateRemainingEstimate:j,widget:y,isEmptyString:k,extractUser:t,blanket:c,extractErrorMessage:A,processValidationResult:H,thickbox:{open:v,close:function(){tb_removeNoRefresh()}},shortcutOpenDialog:e,showHoursLabel:l}})(AJS.$);tempo.$(function(h){h("a#log-work-link").bind("click",function(m){j(m)});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(n,m){h(m).find("a#log-work-link").bind("click",function(o){j(o)})});function j(o){var m=h("a#issue-view-tempo-panel-log-work");if(m.length===1){o.preventDefault();o.stopPropagation();var n=contextPath+"/secure/TempoAddHours!default.jspa?id="+jira.app.issue.getIssueId();h(this).attr("href",n).addClass("issueaction-tempo-add-hours-on-issue");m.trigger("click")}}f();function f(){var n=h("span.more-license-details").last();var m=n.parent().find("ul.license-details");m.hide();n.bind("click",function(){m.toggle();n.toggleClass("active")})}var d=new tempo.widget.FormPopup({id:"tempo-medium-form",trigger:"a.tempoaction-open-medium-form",ajaxOptions:{data:{inline:true,decorator:"dialog"}},initCallback:function(){hideFunction=this.hide},widthClass:"medium",onContentRefresh:function(){var m=this.get$popupContent()}});var a=new tempo.widget.FormPopup({id:"tempo-small-form",trigger:"a.tempoaction-open-small-form",ajaxOptions:{data:{inline:true,decorator:"dialog"}},initCallback:function(){hideFunction=this.hide},widthClass:"small",onContentRefresh:function(){var m=this.get$popupContent()}});var b=new tempo.widget.FormPopup({id:"tempo-large-form",trigger:"a.tempoaction-open-large-form",ajaxOptions:{data:{inline:true,decorator:"dialog"}},initCallback:function(){hideFunction=this.hide},width:750,onContentRefresh:function(){var m=this.get$popupContent();f()}});var l=new tempo.widget.FormPopup({id:"tempo-add-hours-issue-dialog",trigger:"a.issueaction-tempo-add-hours-on-issue",ajaxOptions:{data:{inline:true,decorator:"dialog"}},widthClass:"medium",onContentRefresh:function(){var n=this.get$popupContent();var m=n.find("form").attr("data-form-type");h(n).siblings().first().addClass(m);i(h(n[0]));this._focusFirstField=function(){h(":input[name=time]",n).trigger("focus")}}});new tempo.widget.FormPopup({id:"tempo-grace-form",trigger:"a.tempoaction-open-dialog-form",ajaxOptions:{data:{inline:true,decorator:"dialog"}},initCallback:function(){hideFunction=this.hide},widthClass:"medium",onContentRefresh:function(){var m=this.get$popupContent();h("div.datepicker",m).tempoDatePicker({validate:true})}});new tempo.widget.FormPopup({id:"tempo-planning-create-team",trigger:"a.tempo-planning-create-team",ajaxOptions:{data:{inline:true,decorator:"dialog"}},widthClass:"medium",onContentRefresh:function(){var n=this.get$popupContent();var m=this;h("div.datepicker",n).tempoDatePicker({validate:false});h("input.button",n).bind("click",function(){var o=h(this).closest("form");h("form",n).each(function(){if(this.id!=o.attr("id")){h(this).find("input:hidden").remove()}})});this._focusFirstField=function(){h(":input[name=time]",n).trigger("focus")};i(h(n[0]))}});function i(o){h("select.tempoDynamicDropDown",o).bind("change",function(){});h("select.tempo-tracker-picker",o).tempoIssuePicker();h("select.plan-user-picker",o).tempoSingleUserPicker();h("div.datepicker",o).tempoDatePicker({validate:true});h("div.tempo-timepicker",o).tempoTimePicker();h("#tempo-logwork-issue-cancel",o).bind("click",function(){if(tempo.state.dirty){tempo.reload()}});h("div.dialog-panel-form",o).attr("title","");var n=h("input.tempo-show-period",o);if(n.attr("checked")){tempo.showHoursLabel.apply(n[0])}n.bind("click",tempo.showHoursLabel);h(o).bind("add-close",tempo.submit).bind("add",tempo.submit);h("#issue-add-button",o).bind("click",function(q){var p=h(o).find("form *:input#issue-add-another");if(p.attr("checked")){h(o).trigger("add");h(o).find("form:first *:input[type!=hidden]:first").focus()}else{h(o).trigger("add-close")}return false});var m=h("#tempo-log-work input.tempoIssueKey",o).val();if(m){h("#tempo-log-work form select.tempoDynamicDropDown",o).populateDynamicDropdown(m)}}var g=h('#gh_column_contents a.item-link[href*="/TempoAllocateTime!default.jspa"]');if(g.length>0){var k=h("<a/>").addClass("issueaction-tempo-add-hours-on-issue");k.appendTo("body");g.bind("click",function(m){k.attr("href",this.href);k.trigger("click");return false})}var c=h("<a/>").addClass("tempo-planning-create-team");c.appendTo("body");var e=h('#gh_column_contents a.item-link[href*="/AllocateTeam!default.jspa"]');e.bind("click",function(m){c.attr("href",this.href);c.trigger("click");return false});h("select.tempo-user-picker-admin").tempoSingleUserPicker({type:"admins"});h("select.tempo-user-picker-user").tempoSingleUserPicker();h("select.tempo-worklog-validation-picker").tempoIssuePicker();AJS.$("select.tempoDynamicDropDown").bind("change",function(){});AJS.$("select.issue-select").bind("change",function(){});tempo.blanket.appendTo("body")});
/* module-key = 'is.origo.jira.tempo-plugin:tempo-global', location = 'com/tempoplugin/js/tempo.issue.js' */
tempo.issue=(function(f){function g(h,j,m){j.cleanFormValidation();var l=j.find("input[name=user]").val();if(j.find("select.dialog-user-picker").val()){l=f(j.find("select.dialog-user-picker").val()).get(0)}var k=j.find("ul.error-list");if(l!=""){var i=contextPath+"/rest/tempo-rest/2.0/issue/"+h+"/"+true;f.ajax({url:i,data:{username:l},cache:false,success:function(n){f(n).find("issue").each(function(){var o=f(this);if(o.attr("issue-valid")=="false"){var p=f(this).find("error");k.append(f("<li/>").text(p.attr("message")))}else{if(!m){a(j,h,o)}}})}})}}function a(k,h,i){k.find("select.tempoDynamicDropDown").populateDynamicDropdown(h);var m=i.attr("issue-internal")=="true";if(m){k.find("div.remaining-and-billed-hours-container").hide()}else{k.find("div.remaining-and-billed-hours-container").show();var j=k.find("input.remaining");j.val(i.attr("remaining-estimate"));k.find("span.originalEstimate").text(i.attr("original-estimate"));k.find("span.remainingEstimate").text(i.attr("remaining-estimate"));k.find("span.totalSpent").text(i.attr("hours-spent"));var l=k.find(":input[name=time]");if(l.length>0&&l.val()!=""){tempo.calculateRemainingEstimate(k,j,l.val())}}}function d(i,l){var m=l.find(".tempo-subtask-container");var h=l.find("select.tempo-subtask-picker");m.addClass("hidden");h.empty();h.append(f("<option>",{value:i}).text("Select Sub-task"));var k=contextPath+"/rest/tempo-rest/2.0/issues/picker/subTasks/"+i;var j=l.find("select.tempo-subtask-picker").attr("data-counter");f.ajax({url:k,cache:false,success:function(n){f(n).find("item").each(function(p){var o=f(this);h.append(f("<option>",{value:o.attr("key")}).text(o.attr("key")+" "+o.attr("name")))});if(f(n).find("item").size()==0){m.addClass("hidden");l.find(".tempo-issue-container").removeClass("highlighted")}else{if(j==3){m.removeClass("hidden");l.find(".tempo-issue-container").addClass("highlighted");l.find(".tempo-subtask-container").removeClass("highlighted")}}}})}function c(h){return h!=null&&h!=""&&h.match(/^\w+-\d+$/)}function b(j){var i=f(this).closest("form").cleanFormValidation();var h;if(i.find("select.tempo-issue-picker").val()!=null){h=f(i.find("select.tempo-issue-picker").val()).get(0)}var k=f(j.currentTarget).hasClass("dialog-user-picker");if(c(h)){if(i.find("select.tempo-subtask-picker").length!=0&&!k){d(h,i);f("select.tempo-subtask-picker").trigger("change")}else{g(h,i,k)}}}function e(k){var j=f(this).closest("form").cleanFormValidation();var h=f(j.find("select.tempo-issue-picker").val()).get(0);var i=j.find("select.tempo-subtask-picker").attr("data-counter");if(f(this).children().length>1){if(i==3&&(this.value==j.find("select.tempo-issue-picker").val())){j.find(".tempo-issue-container").addClass("highlighted");j.find(".tempo-subtask-container").removeClass("highlighted")}else{j.find(".tempo-issue-container").removeClass("highlighted");j.find(".tempo-subtask-container").addClass("highlighted");h=j.find("select.tempo-subtask-picker").val()}}var l=f(k.currentTarget).hasClass("dialog-user-picker");if(c(h)){g(h,j,l)}}f("select.tempo-issue-picker").live("change",b);f("select.sub-issue-select").live("change",e);f("select.dialog-user-picker").live("change",b);f("select.tempo-filter-dropdown").live("change",function(i){var h=i.target.value;f(this).closest("form").find("select.tempo-issue-picker-filter").parent().html("<label for='tempo-issue-picker-filter'>"+"Issue"+"</label><select id='tempo-issue-picker' class='tempo-issue-picker tempo-issue-picker-filter' name='issue'/>");f("select.tempo-issue-picker-filter").tempoIssuePicker({type:"filter/"+h})});return{get:g,select:b,valid:c}})(AJS.$);
/* module-key = 'com.atlassian.cps.sumUp:js-issue-navigator-module', location = '/js/sumUp.js' */
var result="";function getRestPath(){return AJS.params.baseURL+"/rest/sumup/1.0/"}function showSumLine(){var b=document.getElementById("issuetable").rows[0].cells.length;var f=AJS.$("#issuetable >thead >tr >th");var d="";for(var c=0;c<=b-1;c++){if(typeof f[c]["attributes"]["data-id"]!="undefined"){d+=f[c]["attributes"]["data-id"]["nodeValue"]+";"}else{if(typeof f[c]["attributes"]["class"]!="undefined"){d+=((f[c]["attributes"]["class"]["nodeValue"]).replace("colHeaderLink headerrow-",""))+";"}}}var e=getURLParameter("filter");if(e=="null"){e=""}var a=getURLParameter("jql");if(a=="null"){a=""}var g=getRestPath()+"sumRow?cscolumns="+d+"&jql="+a+"&filterId="+e;AJS.$.ajax({url:g,type:"get",dataType:"json",async:false,success:function(h){result=h},error:function(j,i,h){console.log(h)}});console.log(result);if(result!=""){if(result.sumRow!=""&&result.checkbox=="true"){addSumRow(result.sumRow);addCheckbox(result.sum_up_aui_i18nkey_sumrow);setCheckboxValue(true)}else{if(result.sumRow!=""&&result.checkbox=="false"){addSumRow(result.sumRow)}else{if(result.sumRow==""&&result.checkbox=="true"){addCheckbox(result.sum_up_aui_i18nkey_sumrow);setCheckboxValue(false)}else{if(result.sumRow==""&&result.checkbox=="false"){}}}}}}function getURLParameter(a){return decodeURI((RegExp(a+"=(.+?)(&|$)").exec(location.search)||[,null])[1])}function addCheckbox(a){AJS.$(".filter-options").append('<li id="sumUoCheckboxSpan"><input id="sumUpCheckbox" type="checkbox" checked onclick="toggleSumRow();"/>&nbsp;'+a+"</li>")}function setCheckboxValue(a){AJS.$("#sumUpCheckbox").attr("checked",a)}function deleteCheckbox(){AJS.$("#sumUoCheckboxSpan").remove()}function addSumRow(a){AJS.$("#issuetable > tbody:last").append(a)}function deleteSumRow(){AJS.$("#sumRow").remove()}function toggleSumRow(){var a=getURLParameter("filter");if(a!="null"&&a>0){AJS.$.post(getRestPath()+"sumRowVisibillity",{status:AJS.$("#sumUpCheckbox").is(":checked"),filterid:a});deleteCheckbox();deleteSumRow();showSumLine()}else{AJS.$("#sumRow").toggle()}}AJS.$(window).load(function(a){if((typeof(document.getElementById("issuetable"))!=="undefined")&&(document.getElementById("issuetable")!==null)){showSumLine()}AJS.$(function(){JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(d,b,c){console.log(c);if(c=="issueTableRefreshed"){if((typeof(document.getElementById("issuetable"))!=="undefined")&&(document.getElementById("issuetable")!==null)){deleteCheckbox();showSumLine()}}})})});
/* module-key = 'com.atlassian.jira.jira-share-plugin:share-resources', location = 'templates/share-dialog.soy' */
// This file was automatically generated from share-dialog.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Dialogs == 'undefined') { JIRA.Templates.Dialogs = {}; }
if (typeof JIRA.Templates.Dialogs.Share == 'undefined') { JIRA.Templates.Dialogs.Share = {}; }


JIRA.Templates.Dialogs.Share.contentPopup = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" method="post" class="aui recipients-form share-content-popup ', (opt_data.shareData.issue) ? ' viewissue ' : (opt_data.shareData.filter) ? ' issuenav ' : '', '">');
  JIRA.Templates.Dialogs.Share.shareLink(opt_data, output);
  output.append('<fieldset class="padding">');
  if (opt_data.showForm) {
    JIRA.Templates.Dialogs.Share.shareForm(opt_data, output);
  } else {
    JIRA.Templates.Dialogs.Share.disabledMailMessage(null, output);
  }
  output.append('</fieldset></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.Share.shareForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<label for="sharenames-multi-select">', soy.$$escapeHtml("User name or email"), '</label><div class="autocomplete-user-target"><select id="sharenames" name="sharenames" class="share-user-picker hidden" multiple="multiple"></select></div><ol class="recipients"></ol><div><label for="note">', soy.$$escapeHtml("Note"), '</label></div><textarea class="textarea long-field" id="note" placeholder="', soy.$$escapeHtml("Add an optional note"), '"/><div class="button-panel"><div class="status"><div class="icon"></div><div class="progress-messages"></div></div><div class="buttons"><input accesskey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="button submit" type="submit" value="', soy.$$escapeHtml("Share"), '" disabled/> <a accesskey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="close-dialog" href="javascript:">', soy.$$escapeHtml("Cancel"), '</a></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.Share.disabledMailMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.message.generic({content: '<p>' + soy.$$escapeHtml("Outgoing mail is not configured. Please contact your JIRA administrator to enable sharing.") + '</p>', extraClasses: 'disabled-mail-message'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.Share.shareLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.shareData.permlink) ? '<div class="issuenav-permalink padding"><label>' + ((opt_data.shareData.issue) ? soy.$$escapeHtml("Link to Issue") : (opt_data.shareData.filter) ? soy.$$escapeHtml("Link to Filter") : '') + '</label><input class="permalink text long-field" value="' + soy.$$escapeHtml(opt_data.shareData.permlink) + '" readonly></div>' : '');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-share-plugin:share-resources', location = 'js/share-user-multi-select.js' */
(function($){function createShareUserPicker(ctx){$(".share-user-picker",ctx).each(function(){var control=new JIRA.MultiUserListPicker({layerId:$(this).attr("id")+"-layer",element:$(this),freeEmailInput:true});$(document).trigger("ready.multi-select.share-user",control)})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createShareUserPicker(context)}})}(AJS.$));
/* module-key = 'com.atlassian.jira.jira-share-plugin:share-resources', location = 'js/share-dialog.js' */
(function($){var currentDialog;function _initShareDialog(dialogId,context){var shareDialog,$contents,currentShareLink;function hideDialog(reset){if(reset){$(document).one("hideLayer",function(e,type,dialog){if(type==="inlineDialog"&&dialog.popup===shareDialog){$(document).unbind(".share-dialog");$contents.empty();$contents=undefined;currentShareLink=undefined}})}shareDialog.hide();return false}function getUsernameValue(){return AJS.$(this).attr("data-username")}function getEmailValue(){return AJS.$(this).attr("data-email")}function sendShare(data,options){$("button,input,textarea",this).attr("disabled","disabled");var icon=$contents.find(".button-panel .icon");icon.addClass("throbber loading");var messages=$contents.find(".progress-messages");messages.text("Sending");var url=AJS.contextPath()+"/rest/share/1.0";if(options.issue){url+="/issue/"+options.issueKey}else{if(options.filter){if(options.filterId){url+="/filter/"+options.filterId}else{data.jql=options.jql;url+="/search"}}}JIRA.trace("jira.plugins.share.send",_.defaults({url:url},data));JIRA.SmartAjax.makeRequest({type:"POST",contentType:"application/json",dataType:"json",url:url,data:JSON.stringify(data),success:function(){icon.removeClass("throbber loading");icon.addClass("icon-tick");messages.text("Sent");setTimeout(function(){hideDialog(true)},1000)},error:function(){icon.removeClass("throbber loading");icon.addClass("icon-cross");messages.text("Error while sending")}})}function submit(shareData){var recipients=$contents.find(".recipients");var users=recipients.find("li[data-username]").map(getUsernameValue).toArray();var emails=recipients.find("li[data-email]").map(getEmailValue).toArray();if(!(users.length||emails.length)){return false}var message=$contents.find("#note").val();var data={usernames:users,emails:emails,message:message};sendShare(data,shareData);return false}function enableSubmit(enabled){$contents.find(".submit").prop("disabled",!enabled)}function enableAccessKeys(shareDialogForm){AJS.$(shareDialogForm).handleAccessKeys({selective:false})}function getShareData(trigger){var $trigger=jQuery(trigger),shareTarget,permlinkFull;if($trigger.hasClass("viewissue-share")){shareTarget="issue";permlinkFull=AJS.Meta.get("viewissue-permlink")}else{if($trigger.hasClass("issuenav-share")){shareTarget="filter";permlinkFull=AJS.Meta.get("issuenav-permlink")}}var shareData={issueKey:JIRA.Meta.getIssueKey(),filterId:AJS.Meta.get("filter-id"),jql:AJS.Meta.get("filter-jql"),permlink:permlinkFull};shareData[shareTarget]=true;return shareData}function generatePopup(contents,trigger,doShowPopup){var shareData=getShareData(trigger);if($contents&&currentShareLink===shareData.permlink){$contents=contents;doShowPopup();return }currentShareLink=shareData.permlink;$contents=contents;$contents.html(JIRA.Templates.Dialogs.Share.contentPopup({shareData:shareData,modifierKey:AJS.Navigator.modifierKey(),showForm:AJS.Meta.get("outgoing-mail-enabled")}));if(AJS.$.browser.msie){$contents.find("form").ieImitationPlaceholder()}enableSubmit(false);$contents.find("#sharenames").bind("change unselect",function(){var val=$(this).val();enableSubmit(val&&val.length)});$contents.find(".close-dialog").click(function(){hideDialog(true)});$contents.find("form").submit(function(){submit(shareData);return false});$contents.find(".issuenav-permalink .text").click(function(e){e.target.select();return false});$(document).bind("keyup.share-dialog",function(e){if(e.keyCode===$.ui.keyCode.ESCAPE){return hideDialog(false)}return true});$(document).bind("showLayer.share-dialog",function(e,type,dialog){if(type==="inlineDialog"&&dialog.popup===shareDialog){$contents.find("#sharenames-textarea").focus()}});enableAccessKeys(AJS.$("form",$contents));doShowPopup();JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[$contents,JIRA.CONTENT_ADDED_REASON.shareDialogOpened])}AJS.toInit(function($){var allowDialogHide=true;JIRA.bind(AJS.InlineLayer.EVENTS.beforeShow,function(e,layer,id){if(id==="sharenames-layer"){allowDialogHide=false}});JIRA.bind(AJS.InlineLayer.EVENTS.hide,function(e,layer,reason,id){if(id==="sharenames-layer"){setTimeout(function(){allowDialogHide=true},0)}});var offsetX=(dialogId.indexOf("issuenav")!==-1)?-110:-170;var dialogOptions={preHideCallback:function(){return allowDialogHide},hideCallback:function(){$(".dashboard-actions .explanation").hide()},offsetY:17,offsetX:offsetX,hideDelay:3600000,useLiveEvents:true,initCallback:function(){$(context).scrollIntoViewForAuto({complete:function(){var scrollers=$(this).add(window);_.delay(function(){scrollers.one("scroll",function(){AJS.$(document.activeElement).blur();hideDialog(false)})})}})}};shareDialog=AJS.InlineDialog($(context),dialogId,generatePopup,dialogOptions);shareDialog[0].popup._validateClickToClose=function(event){return shareDialog.has(event.target).length===0};$(context).live("click",function(){if(shareDialog.find(".contents:visible").length){shareDialog.find("a.close-dialog").click()}});AJS.$(document).bind("keydown",function(e){if(e.keyCode===$.ui.keyCode.ESCAPE&&AJS.InlineDialog.current!==shareDialog&&shareDialog.is(":visible")){if(AJS.InlineDialog.current){AJS.InlineDialog.current.hide()}shareDialog.hide()}})})}_initShareDialog("share-entity-popup-viewissue","#jira-share-trigger.viewissue-share");_initShareDialog("share-entity-popup-issuenav","#jira-share-trigger.issuenav-share")})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/lib/backbone/backbone.js' */
(function(){var root=this;var previousBackbone=root.Backbone;var array=[];var push=array.push;var slice=array.slice;var splice=array.splice;var Backbone;if(typeof exports!=="undefined"){Backbone=exports}else{Backbone=root.Backbone={}}Backbone.VERSION="1.0.0";var _=root._;if(!_&&(typeof require!=="undefined")){_=require("underscore")}Backbone.$=root.jQuery||root.Zepto||root.ender||root.$;Backbone.noConflict=function(){root.Backbone=previousBackbone;return this};Backbone.emulateHTTP=false;Backbone.emulateJSON=false;var Events=Backbone.Events={on:function(name,callback,context){if(!eventsApi(this,"on",name,[callback,context])||!callback){return this}this._events||(this._events={});var events=this._events[name]||(this._events[name]=[]);events.push({callback:callback,context:context,ctx:context||this});return this},once:function(name,callback,context){if(!eventsApi(this,"once",name,[callback,context])||!callback){return this}var self=this;var once=_.once(function(){self.off(name,once);callback.apply(this,arguments)});once._callback=callback;return this.on(name,once,context)},off:function(name,callback,context){var retain,ev,events,names,i,l,j,k;if(!this._events||!eventsApi(this,"off",name,[callback,context])){return this}if(!name&&!callback&&!context){this._events={};return this}names=name?[name]:_.keys(this._events);for(i=0,l=names.length;i<l;i++){name=names[i];if(events=this._events[name]){this._events[name]=retain=[];if(callback||context){for(j=0,k=events.length;j<k;j++){ev=events[j];if((callback&&callback!==ev.callback&&callback!==ev.callback._callback)||(context&&context!==ev.context)){retain.push(ev)}}}if(!retain.length){delete this._events[name]}}}return this},trigger:function(name){if(!this._events){return this}var args=slice.call(arguments,1);if(!eventsApi(this,"trigger",name,args)){return this}var events=this._events[name];var allEvents=this._events.all;if(events){triggerEvents(events,args)}if(allEvents){triggerEvents(allEvents,arguments)}return this},stopListening:function(obj,name,callback){var listeners=this._listeners;if(!listeners){return this}var deleteListener=!name&&!callback;if(typeof name==="object"){callback=this}if(obj){(listeners={})[obj._listenerId]=obj}for(var id in listeners){listeners[id].off(name,callback,this);if(deleteListener){delete this._listeners[id]}}return this}};var eventSplitter=/\s+/;var eventsApi=function(obj,action,name,rest){if(!name){return true}if(typeof name==="object"){for(var key in name){obj[action].apply(obj,[key,name[key]].concat(rest))}return false}if(eventSplitter.test(name)){var names=name.split(eventSplitter);for(var i=0,l=names.length;i<l;i++){obj[action].apply(obj,[names[i]].concat(rest))}return false}return true};var triggerEvents=function(events,args){var ev,i=-1,l=events.length,a1=args[0],a2=args[1],a3=args[2];switch(args.length){case 0:while(++i<l){(ev=events[i]).callback.call(ev.ctx)}return ;case 1:while(++i<l){(ev=events[i]).callback.call(ev.ctx,a1)}return ;case 2:while(++i<l){(ev=events[i]).callback.call(ev.ctx,a1,a2)}return ;case 3:while(++i<l){(ev=events[i]).callback.call(ev.ctx,a1,a2,a3)}return ;default:while(++i<l){(ev=events[i]).callback.apply(ev.ctx,args)}}};var listenMethods={listenTo:"on",listenToOnce:"once"};_.each(listenMethods,function(implementation,method){Events[method]=function(obj,name,callback){var listeners=this._listeners||(this._listeners={});var id=obj._listenerId||(obj._listenerId=_.uniqueId("l"));listeners[id]=obj;if(typeof name==="object"){callback=this}obj[implementation](name,callback,this);return this}});Events.bind=Events.on;Events.unbind=Events.off;_.extend(Backbone,Events);var Model=Backbone.Model=function(attributes,options){var defaults;var attrs=attributes||{};options||(options={});this.cid=_.uniqueId("c");this.attributes={};_.extend(this,_.pick(options,modelOptions));if(options.parse){attrs=this.parse(attrs,options)||{}}if(defaults=_.result(this,"defaults")){attrs=_.defaults({},attrs,defaults)}this.set(attrs,options);this.changed={};this.initialize.apply(this,arguments)};var modelOptions=["url","urlRoot","collection"];_.extend(Model.prototype,Events,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(options){return _.clone(this.attributes)},sync:function(){return Backbone.sync.apply(this,arguments)},get:function(attr){return this.attributes[attr]},escape:function(attr){return _.escape(this.get(attr))},has:function(attr){return this.get(attr)!=null},set:function(key,val,options){var attr,attrs,unset,changes,silent,changing,prev,current;if(key==null){return this}if(typeof key==="object"){attrs=key;options=val}else{(attrs={})[key]=val}options||(options={});if(!this._validate(attrs,options)){return false}unset=options.unset;silent=options.silent;changes=[];changing=this._changing;this._changing=true;if(!changing){this._previousAttributes=_.clone(this.attributes);this.changed={}}current=this.attributes,prev=this._previousAttributes;if(this.idAttribute in attrs){this.id=attrs[this.idAttribute]}for(attr in attrs){val=attrs[attr];if(!_.isEqual(current[attr],val)){changes.push(attr)}if(!_.isEqual(prev[attr],val)){this.changed[attr]=val}else{delete this.changed[attr]}unset?delete current[attr]:current[attr]=val}if(!silent){if(changes.length){this._pending=true}for(var i=0,l=changes.length;i<l;i++){this.trigger("change:"+changes[i],this,current[changes[i]],options)}}if(changing){return this}if(!silent){while(this._pending){this._pending=false;this.trigger("change",this,options)}}this._pending=false;this._changing=false;return this},unset:function(attr,options){return this.set(attr,void 0,_.extend({},options,{unset:true}))},clear:function(options){var attrs={};for(var key in this.attributes){attrs[key]=void 0}return this.set(attrs,_.extend({},options,{unset:true}))},hasChanged:function(attr){if(attr==null){return !_.isEmpty(this.changed)}return _.has(this.changed,attr)},changedAttributes:function(diff){if(!diff){return this.hasChanged()?_.clone(this.changed):false}var val,changed=false;var old=this._changing?this._previousAttributes:this.attributes;for(var attr in diff){if(_.isEqual(old[attr],(val=diff[attr]))){continue}(changed||(changed={}))[attr]=val}return changed},previous:function(attr){if(attr==null||!this._previousAttributes){return null}return this._previousAttributes[attr]},previousAttributes:function(){return _.clone(this._previousAttributes)},fetch:function(options){options=options?_.clone(options):{};if(options.parse===void 0){options.parse=true}var model=this;var success=options.success;options.success=function(resp){if(!model.set(model.parse(resp,options),options)){return false}if(success){success(model,resp,options)}model.trigger("sync",model,resp,options)};wrapError(this,options);return this.sync("read",this,options)},save:function(key,val,options){var attrs,method,xhr,attributes=this.attributes;if(key==null||typeof key==="object"){attrs=key;options=val}else{(attrs={})[key]=val}if(attrs&&(!options||!options.wait)&&!this.set(attrs,options)){return false}options=_.extend({validate:true},options);if(!this._validate(attrs,options)){return false}if(attrs&&options.wait){this.attributes=_.extend({},attributes,attrs)}if(options.parse===void 0){options.parse=true}var model=this;var success=options.success;options.success=function(resp){model.attributes=attributes;var serverAttrs=model.parse(resp,options);if(options.wait){serverAttrs=_.extend(attrs||{},serverAttrs)}if(_.isObject(serverAttrs)&&!model.set(serverAttrs,options)){return false}if(success){success(model,resp,options)}model.trigger("sync",model,resp,options)};wrapError(this,options);method=this.isNew()?"create":(options.patch?"patch":"update");if(method==="patch"){options.attrs=attrs}xhr=this.sync(method,this,options);if(attrs&&options.wait){this.attributes=attributes}return xhr},destroy:function(options){options=options?_.clone(options):{};var model=this;var success=options.success;var destroy=function(){model.trigger("destroy",model,model.collection,options)};options.success=function(resp){if(options.wait||model.isNew()){destroy()}if(success){success(model,resp,options)}if(!model.isNew()){model.trigger("sync",model,resp,options)}};if(this.isNew()){options.success();return false}wrapError(this,options);var xhr=this.sync("delete",this,options);if(!options.wait){destroy()}return xhr},url:function(){var base=_.result(this,"urlRoot")||_.result(this.collection,"url")||urlError();if(this.isNew()){return base}return base+(base.charAt(base.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(resp,options){return resp},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(options){return this._validate({},_.extend(options||{},{validate:true}))},_validate:function(attrs,options){if(!options.validate||!this.validate){return true}attrs=_.extend({},this.attributes,attrs);var error=this.validationError=this.validate(attrs,options)||null;if(!error){return true}this.trigger("invalid",this,error,_.extend(options||{},{validationError:error}));return false}});var modelMethods=["keys","values","pairs","invert","pick","omit"];_.each(modelMethods,function(method){Model.prototype[method]=function(){var args=slice.call(arguments);args.unshift(this.attributes);return _[method].apply(_,args)}});var Collection=Backbone.Collection=function(models,options){options||(options={});if(options.url){this.url=options.url}if(options.model){this.model=options.model}if(options.comparator!==void 0){this.comparator=options.comparator}this._reset();this.initialize.apply(this,arguments);if(models){this.reset(models,_.extend({silent:true},options))}};var setOptions={add:true,remove:true,merge:true};var addOptions={add:true,merge:false,remove:false};_.extend(Collection.prototype,Events,{model:Model,initialize:function(){},toJSON:function(options){return this.map(function(model){return model.toJSON(options)})},sync:function(){return Backbone.sync.apply(this,arguments)},add:function(models,options){return this.set(models,_.defaults(options||{},addOptions))},remove:function(models,options){models=_.isArray(models)?models.slice():[models];options||(options={});var i,l,index,model;for(i=0,l=models.length;i<l;i++){model=this.get(models[i]);if(!model){continue}delete this._byId[model.id];delete this._byId[model.cid];index=this.indexOf(model);this.models.splice(index,1);this.length--;if(!options.silent){options.index=index;model.trigger("remove",model,this,options)}this._removeReference(model)}return this},set:function(models,options){options=_.defaults(options||{},setOptions);if(options.parse){models=this.parse(models,options)}if(!_.isArray(models)){models=models?[models]:[]}var i,l,model,attrs,existing,sort;var at=options.at;var sortable=this.comparator&&(at==null)&&options.sort!==false;var sortAttr=_.isString(this.comparator)?this.comparator:null;var toAdd=[],toRemove=[],modelMap={};for(i=0,l=models.length;i<l;i++){if(!(model=this._prepareModel(models[i],options))){continue}if(existing=this.get(model)){if(options.remove){modelMap[existing.cid]=true}if(options.merge){existing.set(model.attributes,options);if(sortable&&!sort&&existing.hasChanged(sortAttr)){sort=true}}}else{if(options.add){toAdd.push(model);model.on("all",this._onModelEvent,this);this._byId[model.cid]=model;if(model.id!=null){this._byId[model.id]=model}}}}if(options.remove){for(i=0,l=this.length;i<l;++i){if(!modelMap[(model=this.models[i]).cid]){toRemove.push(model)}}if(toRemove.length){this.remove(toRemove,options)}}if(toAdd.length){if(sortable){sort=true}this.length+=toAdd.length;if(at!=null){splice.apply(this.models,[at,0].concat(toAdd))}else{push.apply(this.models,toAdd)}}if(sort){this.sort({silent:true})}if(options.silent){return this}for(i=0,l=toAdd.length;i<l;i++){(model=toAdd[i]).trigger("add",model,this,options)}if(sort){this.trigger("sort",this,options)}return this},reset:function(models,options){options||(options={});for(var i=0,l=this.models.length;i<l;i++){this._removeReference(this.models[i])}options.previousModels=this.models;this._reset();this.add(models,_.extend({silent:true},options));if(!options.silent){this.trigger("reset",this,options)}return this},push:function(model,options){model=this._prepareModel(model,options);this.add(model,_.extend({at:this.length},options));return model},pop:function(options){var model=this.at(this.length-1);this.remove(model,options);return model},unshift:function(model,options){model=this._prepareModel(model,options);this.add(model,_.extend({at:0},options));return model},shift:function(options){var model=this.at(0);this.remove(model,options);return model},slice:function(begin,end){return this.models.slice(begin,end)},get:function(obj){if(obj==null){return void 0}return this._byId[obj.id!=null?obj.id:obj.cid||obj]},at:function(index){return this.models[index]},where:function(attrs,first){if(_.isEmpty(attrs)){return first?void 0:[]}return this[first?"find":"filter"](function(model){for(var key in attrs){if(attrs[key]!==model.get(key)){return false}}return true})},findWhere:function(attrs){return this.where(attrs,true)},sort:function(options){if(!this.comparator){throw new Error("Cannot sort a set without a comparator")}options||(options={});if(_.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this)}else{this.models.sort(_.bind(this.comparator,this))}if(!options.silent){this.trigger("sort",this,options)}return this},sortedIndex:function(model,value,context){value||(value=this.comparator);var iterator=_.isFunction(value)?value:function(model){return model.get(value)};return _.sortedIndex(this.models,model,iterator,context)},pluck:function(attr){return _.invoke(this.models,"get",attr)},fetch:function(options){options=options?_.clone(options):{};if(options.parse===void 0){options.parse=true}var success=options.success;var collection=this;options.success=function(resp){var method=options.reset?"reset":"set";collection[method](resp,options);if(success){success(collection,resp,options)}collection.trigger("sync",collection,resp,options)};wrapError(this,options);return this.sync("read",this,options)},create:function(model,options){options=options?_.clone(options):{};if(!(model=this._prepareModel(model,options))){return false}if(!options.wait){this.add(model,options)}var collection=this;var success=options.success;options.success=function(resp){if(options.wait){collection.add(model,options)}if(success){success(model,resp,options)}};model.save(null,options);return model},parse:function(resp,options){return resp},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(attrs,options){if(attrs instanceof Model){if(!attrs.collection){attrs.collection=this}return attrs}options||(options={});options.collection=this;var model=new this.model(attrs,options);if(!model._validate(attrs,options)){this.trigger("invalid",this,attrs,options);return false}return model},_removeReference:function(model){if(this===model.collection){delete model.collection}model.off("all",this._onModelEvent,this)},_onModelEvent:function(event,model,collection,options){if((event==="add"||event==="remove")&&collection!==this){return }if(event==="destroy"){this.remove(model,options)}if(model&&event==="change:"+model.idAttribute){delete this._byId[model.previous(model.idAttribute)];if(model.id!=null){this._byId[model.id]=model}}this.trigger.apply(this,arguments)}});var methods=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];_.each(methods,function(method){Collection.prototype[method]=function(){var args=slice.call(arguments);args.unshift(this.models);return _[method].apply(_,args)}});var attributeMethods=["groupBy","countBy","sortBy"];_.each(attributeMethods,function(method){Collection.prototype[method]=function(value,context){var iterator=_.isFunction(value)?value:function(model){return model.get(value)};return _[method](this.models,iterator,context)}});var View=Backbone.View=function(options){this.cid=_.uniqueId("view");this._configure(options||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var delegateEventSplitter=/^(\S+)\s*(.*)$/;var viewOptions=["model","collection","el","id","attributes","className","tagName","events"];_.extend(View.prototype,Events,{tagName:"div",$:function(selector){return this.$el.find(selector)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},setElement:function(element,delegate){if(this.$el){this.undelegateEvents()}this.$el=element instanceof Backbone.$?element:Backbone.$(element);this.el=this.$el[0];if(delegate!==false){this.delegateEvents()}return this},delegateEvents:function(events){if(!(events||(events=_.result(this,"events")))){return this}this.undelegateEvents();for(var key in events){var method=events[key];if(!_.isFunction(method)){method=this[events[key]]}if(!method){continue}var match=key.match(delegateEventSplitter);var eventName=match[1],selector=match[2];method=_.bind(method,this);eventName+=".delegateEvents"+this.cid;if(selector===""){this.$el.on(eventName,method)}else{this.$el.on(eventName,selector,method)}}return this},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid);return this},_configure:function(options){if(this.options){options=_.extend({},_.result(this,"options"),options)}_.extend(this,_.pick(options,viewOptions));this.options=options},_ensureElement:function(){if(!this.el){var attrs=_.extend({},_.result(this,"attributes"));if(this.id){attrs.id=_.result(this,"id")}if(this.className){attrs["class"]=_.result(this,"className")}var $el=Backbone.$("<"+_.result(this,"tagName")+">").attr(attrs);this.setElement($el,false)}else{this.setElement(_.result(this,"el"),false)}}});Backbone.sync=function(method,model,options){var type=methodMap[method];_.defaults(options||(options={}),{emulateHTTP:Backbone.emulateHTTP,emulateJSON:Backbone.emulateJSON});var params={type:type,dataType:"json"};if(!options.url){params.url=_.result(model,"url")||urlError()}if(options.data==null&&model&&(method==="create"||method==="update"||method==="patch")){params.contentType="application/json";params.data=JSON.stringify(options.attrs||model.toJSON(options))}if(options.emulateJSON){params.contentType="application/x-www-form-urlencoded";params.data=params.data?{model:params.data}:{}}if(options.emulateHTTP&&(type==="PUT"||type==="DELETE"||type==="PATCH")){params.type="POST";if(options.emulateJSON){params.data._method=type}var beforeSend=options.beforeSend;options.beforeSend=function(xhr){xhr.setRequestHeader("X-HTTP-Method-Override",type);if(beforeSend){return beforeSend.apply(this,arguments)}}}if(params.type!=="GET"&&!options.emulateJSON){params.processData=false}if(params.type==="PATCH"&&window.ActiveXObject&&!(window.external&&window.external.msActiveXFilteringEnabled)){params.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")}}var xhr=options.xhr=Backbone.ajax(_.extend(params,options));model.trigger("request",model,xhr,options);return xhr};var methodMap={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};Backbone.ajax=function(){return Backbone.$.ajax.apply(Backbone.$,arguments)};var Router=Backbone.Router=function(options){options||(options={});if(options.routes){this.routes=options.routes}this._bindRoutes();this.initialize.apply(this,arguments)};var optionalParam=/\((.*?)\)/g;var namedParam=/(\(\?)?:\w+/g;var splatParam=/\*\w+/g;var escapeRegExp=/[\-{}\[\]+?.,\\\^$|#\s]/g;_.extend(Router.prototype,Events,{initialize:function(){},route:function(route,name,callback){if(!_.isRegExp(route)){route=this._routeToRegExp(route)}if(_.isFunction(name)){callback=name;name=""}if(!callback){callback=this[name]}var router=this;Backbone.history.route(route,function(fragment){var args=router._extractParameters(route,fragment);callback&&callback.apply(router,args);router.trigger.apply(router,["route:"+name].concat(args));router.trigger("route",name,args);Backbone.history.trigger("route",router,name,args)});return this},navigate:function(fragment,options){Backbone.history.navigate(fragment,options);return this},_bindRoutes:function(){if(!this.routes){return }this.routes=_.result(this,"routes");var route,routes=_.keys(this.routes);while((route=routes.pop())!=null){this.route(route,this.routes[route])}},_routeToRegExp:function(route){route=route.replace(escapeRegExp,"\\$&").replace(optionalParam,"(?:$1)?").replace(namedParam,function(match,optional){return optional?match:"([^/]+)"}).replace(splatParam,"(.*?)");return new RegExp("^"+route+"$")},_extractParameters:function(route,fragment){var params=route.exec(fragment).slice(1);return _.map(params,function(param){return param?decodeURIComponent(param):null})}});var History=Backbone.History=function(){this.handlers=[];_.bindAll(this,"checkUrl");if(typeof window!=="undefined"){this.location=window.location;this.history=window.history}};var routeStripper=/^[#\/]|\s+$/g;var rootStripper=/^\/+|\/+$/g;var isExplorer=/msie [\w.]+/;var trailingSlash=/\/$/;History.started=false;_.extend(History.prototype,Events,{interval:50,getHash:function(window){var match=(window||this).location.href.match(/#(.*)$/);return match?match[1]:""},getFragment:function(fragment,forcePushState){if(fragment==null){if(this._hasPushState||!this._wantsHashChange||forcePushState){fragment=this.location.pathname;var root=this.root.replace(trailingSlash,"");if(!fragment.indexOf(root)){fragment=fragment.substr(root.length)}}else{fragment=this.getHash()}}return fragment.replace(routeStripper,"")},start:function(options){if(History.started){throw new Error("Backbone.history has already been started")}History.started=true;this.options=_.extend({},{root:"/"},this.options,options);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var fragment=this.getFragment();var docMode=document.documentMode;var oldIE=(isExplorer.exec(navigator.userAgent.toLowerCase())&&(!docMode||docMode<=7));this.root=("/"+this.root+"/").replace(rootStripper,"/");if(oldIE&&this._wantsHashChange){this.iframe=Backbone.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(fragment)}if(this._hasPushState){Backbone.$(window).on("popstate",this.checkUrl)}else{if(this._wantsHashChange&&("onhashchange" in window)&&!oldIE){Backbone.$(window).on("hashchange",this.checkUrl)}else{if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}}}this.fragment=fragment;var loc=this.location;var atRoot=loc.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!atRoot){this.fragment=this.getFragment(null,true);this.location.replace(this.root+this.location.search+"#"+this.fragment);return true}else{if(this._wantsPushState&&this._hasPushState&&atRoot&&loc.hash){this.fragment=this.getHash().replace(routeStripper,"");this.history.replaceState({},document.title,this.root+this.fragment+loc.search)}}if(!this.options.silent){return this.loadUrl()}},stop:function(){Backbone.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);History.started=false},route:function(route,callback){this.handlers.unshift({route:route,callback:callback})},checkUrl:function(e){var current=this.getFragment();if(current===this.fragment&&this.iframe){current=this.getFragment(this.getHash(this.iframe))}if(current===this.fragment){return false}if(this.iframe){this.navigate(current)}this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(fragmentOverride){var fragment=this.fragment=this.getFragment(fragmentOverride);var matched=_.any(this.handlers,function(handler){if(handler.route.test(fragment)){handler.callback(fragment);return true}});return matched},navigate:function(fragment,options){if(!History.started){return false}if(!options||options===true){options={trigger:options}}fragment=this.getFragment(fragment||"");if(this.fragment===fragment){return }this.fragment=fragment;var url=this.root+fragment;if(this._hasPushState){this.history[options.replace?"replaceState":"pushState"]({},document.title,url)}else{if(this._wantsHashChange){this._updateHash(this.location,fragment,options.replace);if(this.iframe&&(fragment!==this.getFragment(this.getHash(this.iframe)))){if(!options.replace){this.iframe.document.open().close()}this._updateHash(this.iframe.location,fragment,options.replace)}}else{return this.location.assign(url)}}if(options.trigger){this.loadUrl(fragment)}},_updateHash:function(location,fragment,replace){if(replace){var href=location.href.replace(/(javascript:|#).*$/,"");location.replace(href+"#"+fragment)}else{location.hash="#"+fragment}}});Backbone.history=new History;var extend=function(protoProps,staticProps){var parent=this;var child;if(protoProps&&_.has(protoProps,"constructor")){child=protoProps.constructor}else{child=function(){return parent.apply(this,arguments)}}_.extend(child,parent,staticProps);var Surrogate=function(){this.constructor=child};Surrogate.prototype=parent.prototype;child.prototype=new Surrogate;if(protoProps){_.extend(child.prototype,protoProps)}child.__super__=parent.prototype;return child};Model.extend=Collection.extend=Router.extend=View.extend=History.extend=extend;var urlError=function(){throw new Error('A "url" property or function must be specified')};var wrapError=function(model,options){var error=options.error;options.error=function(resp){if(error){error(model,resp,options)}model.trigger("error",model,resp,options)}}}).call(this);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/lib/marionettejs/backbone.marionette-1.0.3.js' */
/*
 * Includes BabySitter
 * https://github.com/marionettejs/backbone.babysitter/
 *
 * Includes Wreqr
 * https://github.com/marionettejs/backbone.wreqr/
 */
Backbone.ChildViewContainer=(function(Backbone,_){var Container=function(initialViews){this._views={};this._indexByModel={};this._indexByCollection={};this._indexByCustom={};this._updateLength();this._addInitialViews(initialViews)};_.extend(Container.prototype,{add:function(view,customIndex){var viewCid=view.cid;this._views[viewCid]=view;if(view.model){this._indexByModel[view.model.cid]=viewCid}if(view.collection){this._indexByCollection[view.collection.cid]=viewCid}if(customIndex){this._indexByCustom[customIndex]=viewCid}this._updateLength()},findByModel:function(model){var viewCid=this._indexByModel[model.cid];return this.findByCid(viewCid)},findByCollection:function(col){var viewCid=this._indexByCollection[col.cid];return this.findByCid(viewCid)},findByCustom:function(index){var viewCid=this._indexByCustom[index];return this.findByCid(viewCid)},findByIndex:function(index){return _.values(this._views)[index]},findByCid:function(cid){return this._views[cid]},remove:function(view){var viewCid=view.cid;if(view.model){delete this._indexByModel[view.model.cid]}if(view.collection){delete this._indexByCollection[view.collection.cid]}var cust;for(var key in this._indexByCustom){if(this._indexByCustom.hasOwnProperty(key)){if(this._indexByCustom[key]===viewCid){cust=key;break}}}if(cust){delete this._indexByCustom[cust]}delete this._views[viewCid];this._updateLength()},call:function(method,args){args=Array.prototype.slice.call(arguments,1);this.apply(method,args)},apply:function(method,args){var view;args=args||[];_.each(this._views,function(view,key){if(_.isFunction(view[method])){view[method].apply(view,args)}})},_updateLength:function(){this.length=_.size(this._views)},_addInitialViews:function(views){if(!views){return }var view,i,length=views.length;for(i=0;i<length;i++){view=views[i];this.add(view)}}});var methods=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];_.each(methods,function(method){Container.prototype[method]=function(){var views=_.values(this._views);var args=[views].concat(_.toArray(arguments));return _[method].apply(_,args)}});return Container})(Backbone,_);Backbone.Wreqr=(function(Backbone,Marionette,_){var Wreqr={};Wreqr.Handlers=(function(Backbone,_){var Handlers=function(options){this.options=options;this._wreqrHandlers={};if(_.isFunction(this.initialize)){this.initialize(options)}};Handlers.extend=Backbone.Model.extend;_.extend(Handlers.prototype,Backbone.Events,{setHandlers:function(handlers){_.each(handlers,function(handler,name){var context=null;if(_.isObject(handler)&&!_.isFunction(handler)){context=handler.context;handler=handler.callback}this.setHandler(name,handler,context)},this)},setHandler:function(name,handler,context){var config={callback:handler,context:context};this._wreqrHandlers[name]=config;this.trigger("handler:add",name,handler,context)},hasHandler:function(name){return !!this._wreqrHandlers[name]},getHandler:function(name){var config=this._wreqrHandlers[name];if(!config){throw new Error("Handler not found for '"+name+"'")}return function(){var args=Array.prototype.slice.apply(arguments);return config.callback.apply(config.context,args)}},removeHandler:function(name){delete this._wreqrHandlers[name]},removeAllHandlers:function(){this._wreqrHandlers={}}});return Handlers})(Backbone,_);Wreqr.CommandStorage=(function(){var CommandStorage=function(options){this.options=options;this._commands={};if(_.isFunction(this.initialize)){this.initialize(options)}};_.extend(CommandStorage.prototype,Backbone.Events,{getCommands:function(commandName){var commands=this._commands[commandName];if(!commands){commands={command:commandName,instances:[]};this._commands[commandName]=commands}return commands},addCommand:function(commandName,args){var command=this.getCommands(commandName);command.instances.push(args)},clearCommands:function(commandName){var command=this.getCommands(commandName);command.instances=[]}});return CommandStorage})();Wreqr.Commands=(function(Wreqr){return Wreqr.Handlers.extend({storageType:Wreqr.CommandStorage,constructor:function(options){this.options=options||{};this._initializeStorage(this.options);this.on("handler:add",this._executeCommands,this);var args=Array.prototype.slice.call(arguments);Wreqr.Handlers.prototype.constructor.apply(this,args)},execute:function(name,args){name=arguments[0];args=Array.prototype.slice.call(arguments,1);if(this.hasHandler(name)){this.getHandler(name).apply(this,args)}else{this.storage.addCommand(name,args)}},_executeCommands:function(name,handler,context){var command=this.storage.getCommands(name);_.each(command.instances,function(args){handler.apply(context,args)});this.storage.clearCommands(name)},_initializeStorage:function(options){var storage;var StorageType=options.storageType||this.storageType;if(_.isFunction(StorageType)){storage=new StorageType()}else{storage=StorageType}this.storage=storage}})})(Wreqr);Wreqr.RequestResponse=(function(Wreqr){return Wreqr.Handlers.extend({request:function(){var name=arguments[0];var args=Array.prototype.slice.call(arguments,1);return this.getHandler(name).apply(this,args)}})})(Wreqr);Wreqr.EventAggregator=(function(Backbone,_){var EA=function(){};EA.extend=Backbone.Model.extend;_.extend(EA.prototype,Backbone.Events);return EA})(Backbone,_);return Wreqr})(Backbone,Backbone.Marionette,_);var Marionette=(function(global,Backbone,_){var Marionette={};Backbone.Marionette=Marionette;Marionette.$=Backbone.$;var protoSlice=Array.prototype.slice;function slice(args){return protoSlice.call(args)}function throwError(message,name){var error=new Error(message);error.name=name||"Error";throw error}Marionette.extend=Backbone.Model.extend;Marionette.getOption=function(target,optionName){if(!target||!optionName){return }var value;if(target.options&&(optionName in target.options)&&(target.options[optionName]!==undefined)){value=target.options[optionName]}else{value=target[optionName]}return value};Marionette.triggerMethod=(function(){var splitter=/(^|:)(\w)/gi;function getEventName(match,prefix,eventName){return eventName.toUpperCase()}var triggerMethod=function(event){var methodName="on"+event.replace(splitter,getEventName);var method=this[methodName];this.trigger.apply(this,arguments);if(_.isFunction(method)){return method.apply(this,_.tail(arguments))}};return triggerMethod})();Marionette.MonitorDOMRefresh=(function(){function handleShow(view){view._isShown=true;triggerDOMRefresh(view)}function handleRender(view){view._isRendered=true;triggerDOMRefresh(view)}function triggerDOMRefresh(view){if(view._isShown&&view._isRendered){if(_.isFunction(view.triggerMethod)){view.triggerMethod("dom:refresh")}}}return function(view){view.listenTo(view,"show",function(){handleShow(view)});view.listenTo(view,"render",function(){handleRender(view)})}})();(function(Marionette){function bindFromStrings(target,entity,evt,methods){var methodNames=methods.split(/\s+/);_.each(methodNames,function(methodName){var method=target[methodName];if(!method){throwError("Method '"+methodName+"' was configured as an event handler, but does not exist.")}target.listenTo(entity,evt,method,target)})}function bindToFunction(target,entity,evt,method){target.listenTo(entity,evt,method,target)}function unbindFromStrings(target,entity,evt,methods){var methodNames=methods.split(/\s+/);_.each(methodNames,function(methodName){var method=target[methodName];target.stopListening(entity,evt,method,target)})}function unbindToFunction(target,entity,evt,method){target.stopListening(entity,evt,method,target)}function iterateEvents(target,entity,bindings,functionCallback,stringCallback){if(!entity||!bindings){return }if(_.isFunction(bindings)){bindings=bindings.call(target)}_.each(bindings,function(methods,evt){if(_.isFunction(methods)){functionCallback(target,entity,evt,methods)}else{stringCallback(target,entity,evt,methods)}})}Marionette.bindEntityEvents=function(target,entity,bindings){iterateEvents(target,entity,bindings,bindToFunction,bindFromStrings)};Marionette.unbindEntityEvents=function(target,entity,bindings){iterateEvents(target,entity,bindings,unbindToFunction,unbindFromStrings)}})(Marionette);Marionette.Callbacks=function(){this._deferred=Marionette.$.Deferred();this._callbacks=[]};_.extend(Marionette.Callbacks.prototype,{add:function(callback,contextOverride){this._callbacks.push({cb:callback,ctx:contextOverride});this._deferred.done(function(context,options){if(contextOverride){context=contextOverride}callback.call(context,options)})},run:function(options,context){this._deferred.resolve(context,options)},reset:function(){var callbacks=this._callbacks;this._deferred=Marionette.$.Deferred();this._callbacks=[];_.each(callbacks,function(cb){this.add(cb.cb,cb.ctx)},this)}});Marionette.Controller=function(options){this.triggerMethod=Marionette.triggerMethod;this.options=options||{};if(_.isFunction(this.initialize)){this.initialize(this.options)}};Marionette.Controller.extend=Marionette.extend;_.extend(Marionette.Controller.prototype,Backbone.Events,{close:function(){this.stopListening();this.triggerMethod("close");this.unbind()}});Marionette.Region=function(options){this.options=options||{};this.el=Marionette.getOption(this,"el");if(!this.el){var err=new Error("An 'el' must be specified for a region.");err.name="NoElError";throw err}if(this.initialize){var args=Array.prototype.slice.apply(arguments);this.initialize.apply(this,args)}};_.extend(Marionette.Region,{buildRegion:function(regionConfig,defaultRegionType){var regionIsString=(typeof regionConfig==="string");var regionSelectorIsString=(typeof regionConfig.selector==="string");var regionTypeIsUndefined=(typeof regionConfig.regionType==="undefined");var regionIsType=(typeof regionConfig==="function");if(!regionIsType&&!regionIsString&&!regionSelectorIsString){throw new Error("Region must be specified as a Region type, a selector string or an object with selector property")}var selector,RegionType;if(regionIsString){selector=regionConfig}if(regionConfig.selector){selector=regionConfig.selector}if(regionIsType){RegionType=regionConfig}if(!regionIsType&&regionTypeIsUndefined){RegionType=defaultRegionType}if(regionConfig.regionType){RegionType=regionConfig.regionType}var region=new RegionType({el:selector});if(regionConfig.parentEl){region.getEl=function(selector){var parentEl=regionConfig.parentEl;if(_.isFunction(parentEl)){parentEl=parentEl()}return parentEl.find(selector)}}return region}});_.extend(Marionette.Region.prototype,Backbone.Events,{show:function(view){this.ensureEl();var isViewClosed=view.isClosed||_.isUndefined(view.$el);var isDifferentView=view!==this.currentView;if(isDifferentView){this.close()}view.render();if(isDifferentView||isViewClosed){this.open(view)}this.currentView=view;Marionette.triggerMethod.call(this,"show",view);Marionette.triggerMethod.call(view,"show")},ensureEl:function(){if(!this.$el||this.$el.length===0){this.$el=this.getEl(this.el)}},getEl:function(selector){return Marionette.$(selector)},open:function(view){this.$el.empty().append(view.el)},close:function(){var view=this.currentView;if(!view||view.isClosed){return }if(view.close){view.close()}else{if(view.remove){view.remove()}}Marionette.triggerMethod.call(this,"close");delete this.currentView},attachView:function(view){this.currentView=view},reset:function(){this.close();delete this.$el}});Marionette.Region.extend=Marionette.extend;Marionette.RegionManager=(function(Marionette){var RegionManager=Marionette.Controller.extend({constructor:function(options){this._regions={};Marionette.Controller.prototype.constructor.call(this,options)},addRegions:function(regionDefinitions,defaults){var regions={};_.each(regionDefinitions,function(definition,name){if(typeof definition==="string"){definition={selector:definition}}if(definition.selector){definition=_.defaults({},definition,defaults)}var region=this.addRegion(name,definition);regions[name]=region},this);return regions},addRegion:function(name,definition){var region;var isObject=_.isObject(definition);var isString=_.isString(definition);var hasSelector=!!definition.selector;if(isString||(isObject&&hasSelector)){region=Marionette.Region.buildRegion(definition,Marionette.Region)}else{if(_.isFunction(definition)){region=Marionette.Region.buildRegion(definition,Marionette.Region)}else{region=definition}}this._store(name,region);this.triggerMethod("region:add",name,region);return region},get:function(name){return this._regions[name]},removeRegion:function(name){var region=this._regions[name];this._remove(name,region)},removeRegions:function(){_.each(this._regions,function(region,name){this._remove(name,region)},this)},closeRegions:function(){_.each(this._regions,function(region,name){region.close()},this)},close:function(){this.removeRegions();var args=Array.prototype.slice.call(arguments);Marionette.Controller.prototype.close.apply(this,args)},_store:function(name,region){this._regions[name]=region;this._setLength()},_remove:function(name,region){region.close();delete this._regions[name];this._setLength();this.triggerMethod("region:remove",name,region)},_setLength:function(){this.length=_.size(this._regions)}});var methods=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];_.each(methods,function(method){RegionManager.prototype[method]=function(){var regions=_.values(this._regions);var args=[regions].concat(_.toArray(arguments));return _[method].apply(_,args)}});return RegionManager})(Marionette);Marionette.TemplateCache=function(templateId){this.templateId=templateId};_.extend(Marionette.TemplateCache,{templateCaches:{},get:function(templateId){var cachedTemplate=this.templateCaches[templateId];if(!cachedTemplate){cachedTemplate=new Marionette.TemplateCache(templateId);this.templateCaches[templateId]=cachedTemplate}return cachedTemplate.load()},clear:function(){var i;var args=slice(arguments);var length=args.length;if(length>0){for(i=0;i<length;i++){delete this.templateCaches[args[i]]}}else{this.templateCaches={}}}});_.extend(Marionette.TemplateCache.prototype,{load:function(){if(this.compiledTemplate){return this.compiledTemplate}var template=this.loadTemplate(this.templateId);this.compiledTemplate=this.compileTemplate(template);return this.compiledTemplate},loadTemplate:function(templateId){var template=Marionette.$(templateId).html();if(!template||template.length===0){throwError("Could not find template: '"+templateId+"'","NoTemplateError")}return template},compileTemplate:function(rawTemplate){return _.template(rawTemplate)}});Marionette.Renderer={render:function(template,data){if(!template){var error=new Error("Cannot render the template since it's false, null or undefined.");error.name="TemplateNotFoundError";throw error}var templateFunc;if(typeof template==="function"){templateFunc=template}else{templateFunc=Marionette.TemplateCache.get(template)}return templateFunc(data)}};Marionette.View=Backbone.View.extend({constructor:function(){_.bindAll(this,"render");var args=Array.prototype.slice.apply(arguments);Backbone.View.prototype.constructor.apply(this,args);Marionette.MonitorDOMRefresh(this);this.listenTo(this,"show",this.onShowCalled,this)},triggerMethod:Marionette.triggerMethod,getTemplate:function(){return Marionette.getOption(this,"template")},mixinTemplateHelpers:function(target){target=target||{};var templateHelpers=this.templateHelpers;if(_.isFunction(templateHelpers)){templateHelpers=templateHelpers.call(this)}return _.extend(target,templateHelpers)},configureTriggers:function(){if(!this.triggers){return }var triggerEvents={};var triggers=_.result(this,"triggers");_.each(triggers,function(value,key){triggerEvents[key]=function(e){if(e&&e.preventDefault){e.preventDefault()}if(e&&e.stopPropagation){e.stopPropagation()}var args={view:this,model:this.model,collection:this.collection};this.triggerMethod(value,args)}},this);return triggerEvents},delegateEvents:function(events){this._delegateDOMEvents(events);Marionette.bindEntityEvents(this,this.model,Marionette.getOption(this,"modelEvents"));Marionette.bindEntityEvents(this,this.collection,Marionette.getOption(this,"collectionEvents"))},_delegateDOMEvents:function(events){events=events||this.events;if(_.isFunction(events)){events=events.call(this)}var combinedEvents={};var triggers=this.configureTriggers();_.extend(combinedEvents,events,triggers);Backbone.View.prototype.delegateEvents.call(this,combinedEvents)},undelegateEvents:function(){var args=Array.prototype.slice.call(arguments);Backbone.View.prototype.undelegateEvents.apply(this,args);Marionette.unbindEntityEvents(this,this.model,Marionette.getOption(this,"modelEvents"));Marionette.unbindEntityEvents(this,this.collection,Marionette.getOption(this,"collectionEvents"))},onShowCalled:function(){},close:function(){if(this.isClosed){return }var shouldClose=this.triggerMethod("before:close");if(shouldClose===false){return }this.isClosed=true;this.triggerMethod("close");this.unbindUIElements();this.remove()},bindUIElements:function(){if(!this.ui){return }if(!this._uiBindings){this._uiBindings=this.ui}var bindings=_.result(this,"_uiBindings");this.ui={};_.each(_.keys(bindings),function(key){var selector=bindings[key];this.ui[key]=this.$(selector)},this)},unbindUIElements:function(){if(!this.ui){return }_.each(this.ui,function($el,name){delete this.ui[name]},this);this.ui=this._uiBindings;delete this._uiBindings}});Marionette.ItemView=Marionette.View.extend({serializeData:function(){var data={};if(this.model){data=this.model.toJSON()}else{if(this.collection){data={items:this.collection.toJSON()}}}return data},render:function(){this.isClosed=false;this.triggerMethod("before:render",this);this.triggerMethod("item:before:render",this);var data=this.serializeData();data=this.mixinTemplateHelpers(data);var template=this.getTemplate();var html=Marionette.Renderer.render(template,data);this.$el.html(html);this.bindUIElements();this.triggerMethod("render",this);this.triggerMethod("item:rendered",this);return this},close:function(){if(this.isClosed){return }this.triggerMethod("item:before:close");Marionette.View.prototype.close.apply(this,slice(arguments));this.triggerMethod("item:closed")}});Marionette.CollectionView=Marionette.View.extend({itemViewEventPrefix:"itemview",constructor:function(options){this._initChildViewStorage();Marionette.View.prototype.constructor.apply(this,slice(arguments));this._initialEvents()},_initialEvents:function(){if(this.collection){this.listenTo(this.collection,"add",this.addChildView,this);this.listenTo(this.collection,"remove",this.removeItemView,this);this.listenTo(this.collection,"reset",this.render,this)}},addChildView:function(item,collection,options){this.closeEmptyView();var ItemView=this.getItemView(item);var index=this.collection.indexOf(item);this.addItemView(item,ItemView,index)},onShowCalled:function(){this.children.each(function(child){Marionette.triggerMethod.call(child,"show")})},triggerBeforeRender:function(){this.triggerMethod("before:render",this);this.triggerMethod("collection:before:render",this)},triggerRendered:function(){this.triggerMethod("render",this);this.triggerMethod("collection:rendered",this)},render:function(){this.isClosed=false;this.triggerBeforeRender();this._renderChildren();this.triggerRendered();return this},_renderChildren:function(){this.closeEmptyView();this.closeChildren();if(this.collection&&this.collection.length>0){this.showCollection()}else{this.showEmptyView()}},showCollection:function(){var ItemView;this.collection.each(function(item,index){ItemView=this.getItemView(item);this.addItemView(item,ItemView,index)},this)},showEmptyView:function(){var EmptyView=Marionette.getOption(this,"emptyView");if(EmptyView&&!this._showingEmptyView){this._showingEmptyView=true;var model=new Backbone.Model();this.addItemView(model,EmptyView,0)}},closeEmptyView:function(){if(this._showingEmptyView){this.closeChildren();delete this._showingEmptyView}},getItemView:function(item){var itemView=Marionette.getOption(this,"itemView");if(!itemView){throwError("An `itemView` must be specified","NoItemViewError")}return itemView},addItemView:function(item,ItemView,index){var itemViewOptions=Marionette.getOption(this,"itemViewOptions");if(_.isFunction(itemViewOptions)){itemViewOptions=itemViewOptions.call(this,item,index)}var view=this.buildItemView(item,ItemView,itemViewOptions);this.addChildViewEventForwarding(view);this.triggerMethod("before:item:added",view);this.children.add(view);this.renderItemView(view,index);if(this._isShown){Marionette.triggerMethod.call(view,"show")}this.triggerMethod("after:item:added",view)},addChildViewEventForwarding:function(view){var prefix=Marionette.getOption(this,"itemViewEventPrefix");this.listenTo(view,"all",function(){var args=slice(arguments);args[0]=prefix+":"+args[0];args.splice(1,0,view);Marionette.triggerMethod.apply(this,args)},this)},renderItemView:function(view,index){view.render();this.appendHtml(this,view,index)},buildItemView:function(item,ItemViewType,itemViewOptions){var options=_.extend({model:item},itemViewOptions);return new ItemViewType(options)},removeItemView:function(item){var view=this.children.findByModel(item);this.removeChildView(view);this.checkEmpty()},removeChildView:function(view){if(view){this.stopListening(view);if(view.close){view.close()}else{if(view.remove){view.remove()}}this.children.remove(view)}this.triggerMethod("item:removed",view)},checkEmpty:function(){if(!this.collection||this.collection.length===0){this.showEmptyView()}},appendHtml:function(collectionView,itemView,index){collectionView.$el.append(itemView.el)},_initChildViewStorage:function(){this.children=new Backbone.ChildViewContainer()},close:function(){if(this.isClosed){return }this.triggerMethod("collection:before:close");this.closeChildren();this.triggerMethod("collection:closed");Marionette.View.prototype.close.apply(this,slice(arguments))},closeChildren:function(){this.children.each(function(child){this.removeChildView(child)},this);this.checkEmpty()}});Marionette.CompositeView=Marionette.CollectionView.extend({_initialEvents:function(){if(this.collection){this.listenTo(this.collection,"add",this.addChildView,this);this.listenTo(this.collection,"remove",this.removeItemView,this);this.listenTo(this.collection,"reset",this._renderChildren,this)}},getItemView:function(item){var itemView=Marionette.getOption(this,"itemView")||this.constructor;if(!itemView){throwError("An `itemView` must be specified","NoItemViewError")}return itemView},serializeData:function(){var data={};if(this.model){data=this.model.toJSON()}return data},render:function(){this.isRendered=true;this.isClosed=false;this.resetItemViewContainer();this.triggerBeforeRender();var html=this.renderModel();this.$el.html(html);this.bindUIElements();this.triggerMethod("composite:model:rendered");this._renderChildren();this.triggerMethod("composite:rendered");this.triggerRendered();return this},_renderChildren:function(){if(this.isRendered){Marionette.CollectionView.prototype._renderChildren.call(this);this.triggerMethod("composite:collection:rendered")}},renderModel:function(){var data={};data=this.serializeData();data=this.mixinTemplateHelpers(data);var template=this.getTemplate();return Marionette.Renderer.render(template,data)},appendHtml:function(cv,iv,index){var $container=this.getItemViewContainer(cv);$container.append(iv.el)},getItemViewContainer:function(containerView){if("$itemViewContainer" in containerView){return containerView.$itemViewContainer}var container;if(containerView.itemViewContainer){var selector=_.result(containerView,"itemViewContainer");container=containerView.$(selector);if(container.length<=0){throwError("The specified `itemViewContainer` was not found: "+containerView.itemViewContainer,"ItemViewContainerMissingError")}}else{container=containerView.$el}containerView.$itemViewContainer=container;return container},resetItemViewContainer:function(){if(this.$itemViewContainer){delete this.$itemViewContainer}}});Marionette.Layout=Marionette.ItemView.extend({regionType:Marionette.Region,constructor:function(options){options=options||{};this._firstRender=true;this._initializeRegions(options);Marionette.ItemView.call(this,options)},render:function(){if(this._firstRender){this._firstRender=false}else{if(this.isClosed){this._initializeRegions()}else{this._reInitializeRegions()}}var args=Array.prototype.slice.apply(arguments);var result=Marionette.ItemView.prototype.render.apply(this,args);return result},close:function(){if(this.isClosed){return }this.regionManager.close();var args=Array.prototype.slice.apply(arguments);Marionette.ItemView.prototype.close.apply(this,args)},addRegion:function(name,definition){var regions={};regions[name]=definition;return this.addRegions(regions)[name]},addRegions:function(regions){this.regions=_.extend(this.regions||{},regions);return this._buildRegions(regions)},removeRegion:function(name){return this.regionManager.removeRegion(name)},_buildRegions:function(regions){var that=this;var defaults={parentEl:function(){return that.$el}};return this.regionManager.addRegions(regions,defaults)},_initializeRegions:function(options){var regions;this._initRegionManager();if(_.isFunction(this.regions)){regions=this.regions(options)}else{regions=this.regions||{}}this.addRegions(regions)},_reInitializeRegions:function(){this.regionManager.closeRegions();this.regionManager.each(function(region){region.reset()})},_initRegionManager:function(){this.regionManager=new Marionette.RegionManager();this.listenTo(this.regionManager,"region:add",function(name,region){this[name]=region;this.trigger("region:add",name,region)});this.listenTo(this.regionManager,"region:remove",function(name,region){delete this[name];this.trigger("region:remove",name,region)})}});Marionette.AppRouter=Backbone.Router.extend({constructor:function(options){Backbone.Router.prototype.constructor.apply(this,slice(arguments));this.options=options;if(this.appRoutes){var controller=Marionette.getOption(this,"controller");this.processAppRoutes(controller,this.appRoutes)}},processAppRoutes:function(controller,appRoutes){var routeNames=_.keys(appRoutes).reverse();_.each(routeNames,function(route){var methodName=appRoutes[route];var method=controller[methodName];if(!method){throw new Error("Method '"+methodName+"' was not found on the controller")}this.route(route,methodName,_.bind(method,controller))},this)}});Marionette.Application=function(options){this._initRegionManager();this._initCallbacks=new Marionette.Callbacks();this.vent=new Backbone.Wreqr.EventAggregator();this.commands=new Backbone.Wreqr.Commands();this.reqres=new Backbone.Wreqr.RequestResponse();this.submodules={};_.extend(this,options);this.triggerMethod=Marionette.triggerMethod};_.extend(Marionette.Application.prototype,Backbone.Events,{execute:function(){var args=Array.prototype.slice.apply(arguments);this.commands.execute.apply(this.commands,args)},request:function(){var args=Array.prototype.slice.apply(arguments);return this.reqres.request.apply(this.reqres,args)},addInitializer:function(initializer){this._initCallbacks.add(initializer)},start:function(options){this.triggerMethod("initialize:before",options);this._initCallbacks.run(options,this);this.triggerMethod("initialize:after",options);this.triggerMethod("start",options)},addRegions:function(regions){return this._regionManager.addRegions(regions)},removeRegion:function(region){this._regionManager.removeRegion(region)},module:function(moduleNames,moduleDefinition){var args=slice(arguments);args.unshift(this);return Marionette.Module.create.apply(Marionette.Module,args)},_initRegionManager:function(){this._regionManager=new Marionette.RegionManager();this.listenTo(this._regionManager,"region:add",function(name,region){this[name]=region});this.listenTo(this._regionManager,"region:remove",function(name,region){delete this[name]})}});Marionette.Application.extend=Marionette.extend;Marionette.Module=function(moduleName,app){this.moduleName=moduleName;this.submodules={};this._setupInitializersAndFinalizers();this.app=app;this.startWithParent=true;this.triggerMethod=Marionette.triggerMethod};_.extend(Marionette.Module.prototype,Backbone.Events,{addInitializer:function(callback){this._initializerCallbacks.add(callback)},addFinalizer:function(callback){this._finalizerCallbacks.add(callback)},start:function(options){if(this._isInitialized){return }_.each(this.submodules,function(mod){if(mod.startWithParent){mod.start(options)}});this.triggerMethod("before:start",options);this._initializerCallbacks.run(options,this);this._isInitialized=true;this.triggerMethod("start",options)},stop:function(){if(!this._isInitialized){return }this._isInitialized=false;Marionette.triggerMethod.call(this,"before:stop");_.each(this.submodules,function(mod){mod.stop()});this._finalizerCallbacks.run(undefined,this);this._initializerCallbacks.reset();this._finalizerCallbacks.reset();Marionette.triggerMethod.call(this,"stop")},addDefinition:function(moduleDefinition,customArgs){this._runModuleDefinition(moduleDefinition,customArgs)},_runModuleDefinition:function(definition,customArgs){if(!definition){return }var args=_.flatten([this,this.app,Backbone,Marionette,Marionette.$,_,customArgs]);definition.apply(this,args)},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new Marionette.Callbacks();this._finalizerCallbacks=new Marionette.Callbacks()}});_.extend(Marionette.Module,{create:function(app,moduleNames,moduleDefinition){var module=app;var customArgs=slice(arguments);customArgs.splice(0,3);moduleNames=moduleNames.split(".");var length=moduleNames.length;var moduleDefinitions=[];moduleDefinitions[length-1]=moduleDefinition;_.each(moduleNames,function(moduleName,i){var parentModule=module;module=this._getModule(parentModule,moduleName,app);this._addModuleDefinition(parentModule,module,moduleDefinitions[i],customArgs)},this);return module},_getModule:function(parentModule,moduleName,app,def,args){var module=parentModule[moduleName];if(!module){module=new Marionette.Module(moduleName,app);parentModule[moduleName]=module;parentModule.submodules[moduleName]=module}return module},_addModuleDefinition:function(parentModule,module,def,args){var fn;var startWithParent;if(_.isFunction(def)){fn=def;startWithParent=true}else{if(_.isObject(def)){fn=def.define;startWithParent=def.startWithParent}else{startWithParent=true}}if(fn){module.addDefinition(fn,args)}module.startWithParent=module.startWithParent&&startWithParent;if(module.startWithParent&&!module.startWithParentIsConfigured){module.startWithParentIsConfigured=true;parentModule.addInitializer(function(options){if(module.startWithParent){module.start(options)}})}}});return Marionette})(this,Backbone,_);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/lib/jquery-scrollintoview/jquery.scrollintoview.js' */
/*
 * jQuery scrollintoview() plugin and :scrollable selector filter
 *
 * Version 1.8 (14 Jul 2011)
 * Requires jQuery 1.4 or newer
 *
 * Copyright (c) 2011 Robert Koritnik
 * Licensed under the terms of the MIT license
 * http://www.opensource.org/licenses/mit-license.php
 */
(function($){var converter={vertical:{x:false,y:true},horizontal:{x:true,y:false},both:{x:true,y:true},x:{x:true,y:false},y:{x:false,y:true}};var settings={duration:0,direction:"y"};var rootrx=/^(?:html)$/i;var borders=function(domElement,styles){styles=styles||(document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(domElement,null):domElement.currentStyle);var px=document.defaultView&&document.defaultView.getComputedStyle?true:false;var b={top:(parseFloat(px?styles.borderTopWidth:$.css(domElement,"borderTopWidth"))||0),left:(parseFloat(px?styles.borderLeftWidth:$.css(domElement,"borderLeftWidth"))||0),bottom:(parseFloat(px?styles.borderBottomWidth:$.css(domElement,"borderBottomWidth"))||0),right:(parseFloat(px?styles.borderRightWidth:$.css(domElement,"borderRightWidth"))||0)};return{top:b.top,left:b.left,bottom:b.bottom,right:b.right,vertical:b.top+b.bottom,horizontal:b.left+b.right}};var dimensions=function($element){var win=$(window);var isRoot=rootrx.test($element[0].nodeName);return{border:isRoot?{top:0,left:0,bottom:0,right:0}:borders($element[0]),scroll:{top:(isRoot?win:$element).scrollTop(),left:(isRoot?win:$element).scrollLeft()},scrollbar:{right:isRoot?0:$element.innerWidth()-$element[0].clientWidth,bottom:isRoot?0:$element.innerHeight()-$element[0].clientHeight},rect:(function(){var r=$element[0].getBoundingClientRect();return{top:isRoot?0:r.top,left:isRoot?0:r.left,bottom:isRoot?$element[0].clientHeight:r.bottom,right:isRoot?$element[0].clientWidth:r.right}})()}};$.fn.extend({scrollIntoViewForAuto:function(options){options=$.extend({},settings,options);options.direction=converter[typeof (options.direction)==="string"&&options.direction.toLowerCase()]||converter.both;var dirStr="";if(options.direction.x===true){dirStr="horizontal"}if(options.direction.y===true){dirStr=dirStr?"both":"vertical"}var el=this.eq(0);var scroller=el.closest(":scrollable("+dirStr+")");if(scroller.length>0){scroller=scroller.eq(0);var dim={e:dimensions(el),s:dimensions(scroller)};var rel={top:dim.e.rect.top-(dim.s.rect.top+dim.s.border.top),bottom:dim.s.rect.bottom-dim.s.border.bottom-dim.s.scrollbar.bottom-dim.e.rect.bottom,left:dim.e.rect.left-(dim.s.rect.left+dim.s.border.left),right:dim.s.rect.right-dim.s.border.right-dim.s.scrollbar.right-dim.e.rect.right};var animOptions={};if(options.direction.y===true){if(rel.top<0){animOptions.scrollTop=dim.s.scroll.top+rel.top-30}else{if(rel.top>0&&rel.bottom<0){animOptions.scrollTop=dim.s.scroll.top+Math.min(rel.top,-rel.bottom)+30}}}if(options.direction.x===true){if(rel.left<0){animOptions.scrollLeft=dim.s.scroll.left+rel.left}else{if(rel.left>0&&rel.right<0){animOptions.scrollLeft=dim.s.scroll.left+Math.min(rel.left,-rel.right)}}}if(!$.isEmptyObject(animOptions)){if(rootrx.test(scroller[0].nodeName)){scroller=$("html,body")}scroller.animate(animOptions,options.duration).eq(0).queue(function(next){$.isFunction(options.complete)&&options.complete.call(scroller[0]);next()})}else{$.isFunction(options.complete)&&options.complete.call(scroller[0])}}return this}});var scrollValue={auto:true,scroll:true,visible:false,hidden:false};$.extend($.expr[":"],{scrollable:function(element,index,meta,stack){var direction=converter[typeof (meta[3])==="string"&&meta[3].toLowerCase()]||converter.both;var styles=(document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(element,null):element.currentStyle);var overflow={x:scrollValue[styles.overflowX.toLowerCase()]||false,y:scrollValue[styles.overflowY.toLowerCase()]||false,isRoot:rootrx.test(element.nodeName)};if(!overflow.x&&!overflow.y&&!overflow.isRoot){return false}var size={height:{scroll:element.scrollHeight,client:element.clientHeight},width:{scroll:element.scrollWidth,client:element.clientWidth},scrollableX:function(){return(overflow.x||overflow.isRoot)&&this.width.scroll>this.width.client},scrollableY:function(){return(overflow.y||overflow.isRoot)&&this.height.scroll>this.height.client}};return direction.y&&size.scrollableY()||direction.x&&size.scrollableX()}})})(jQuery);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/namespace.js' */
AJS.namespace("JIRA.Admin.CustomFields");JIRA.Admin.CustomFields.Backbone=Backbone.noConflict();
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/ErrorDialog/ErrorDialog.soy' */
// This file was automatically generated from ErrorDialog.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.CustomFields == 'undefined') { JIRA.Templates.CustomFields = {}; }
if (typeof JIRA.Templates.CustomFields.ErrorDialog == 'undefined') { JIRA.Templates.CustomFields.ErrorDialog = {}; }


JIRA.Templates.CustomFields.ErrorDialog.header = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml(opt_data.text), '</h2>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.ErrorDialog.content = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.Messages.errorMessage({message: opt_data.text}, output);
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/ErrorDialog/ErrorDialog.js' */
(function(namespace,_,$,AJS,Backbone){namespace.ErrorDialog=function(options){var content,dialog,header;options||(options={});_.defaults(options,{heading:"",message:""});content=new Backbone.Marionette.View({el:$(JIRA.Templates.CustomFields.ErrorDialog.content({text:options.message}))});dialog=this.dialog=new namespace.Dialog();this.$el=dialog.$el;header=JIRA.Templates.CustomFields.ErrorDialog.header({text:options.heading});dialog.addHeaderMain(header);dialog.addPanel("",content);dialog.addLink({label:"Cancel",click:_.bind(this.close,this)});this.listenTo(dialog,"close",this.close)};_.extend(namespace.ErrorDialog.prototype,Backbone.Events,{show:function(){this.dialog.show()},hide:function(){if(this.dialog){this.dialog.destroy();delete this.dialog}},close:function(){this.hide();this.trigger("close")},hideLoading:function(){return this},showLoading:function(){return this},isDirty:function(){return false}})})(JIRA.Admin.CustomFields,_,AJS.$,AJS,JIRA.Admin.CustomFields.Backbone);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'global/templates/messages.soy' */
// This file was automatically generated from messages.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Messages == 'undefined') { JIRA.Templates.Messages = {}; }


JIRA.Templates.Messages.msg = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message ', soy.$$escapeHtml(opt_data.type), '"><p class="title"><span class="aui-icon icon-', soy.$$escapeHtml(opt_data.type), '"></span>', (opt_data.title) ? '<strong>' + soy.$$escapeHtml(opt_data.title) + '</strong></p>' : '', '</p>', soy.$$escapeHtml(opt_data.message), '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Messages.errorMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.Messages.msg(soy.$$augmentData(opt_data, {type: 'error'}), output);
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/templates/customfields.soy' */
// This file was automatically generated from customfields.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.CustomFields == 'undefined') { JIRA.Templates.CustomFields = {}; }


JIRA.Templates.CustomFields.types = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ol class="customfields-types"></ol>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.type = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.type.previewImageUrl) ? '<img class="field-preview" src="' + soy.$$escapeHtml(opt_data.type.previewImageUrl) + '" alt="' + soy.$$escapeHtml(opt_data.type.name) + '" width="120" height="60" />' : '<span class="field-preview-empty"><span class="field-preview-empty-message">' + soy.$$escapeHtml("No field preview") + '</span></span>', (opt_data.type.isManaged) ? '<span class="aui-lozenge aui-lozenge-subtle field-is-managed" title="' + soy.$$escapeHtml(opt_data.type.managedDescription) + '">' + soy.$$escapeHtml("Managed") + '</span>' : '', '<h3 class="field-name">', soy.$$escapeHtml(opt_data.type.name), '</h3>', (opt_data.type.description) ? '<p class="field-description">' + soy.$$escapeHtml(opt_data.type.description) + '</p>' : '');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.emptyType = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.message.info({content: "Your search did not match any custom field types."}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.emptyTypeMarketplace = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var open__soy35 = new soy.StringBuilder('<a href="', soy.$$escapeHtml(opt_data.contextPath), '/plugins/servlet/upm/marketplace/popular?category=Custom+Fields&amp;source=custom_fields_create">');
  open__soy35 = open__soy35.toString();
  var close__soy39 = new soy.StringBuilder('</a>');
  close__soy39 = close__soy39.toString();
  aui.message.info({titleContent: "Your search did not match any custom field types.", content: AJS.format("Try searching the {0}Atlassian Marketplace{1} for other custom field types.",open__soy35,close__soy39)}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.emptyTypeOtherTab = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.message.info({titleContent: "Your search did not match any custom field types.", content: AJS.format("{0}Custom field types{1} have been found in other categories.",'<a href="#" class="customfields-all-category-link">','</a>')}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.quickSearch = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input class="jira-field-search" type="text" title="', soy.$$escapeHtml("Search"), '" placeholder="', soy.$$escapeHtml("Search"), '">');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.dialogNotification = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="jira-dialog-notification"></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.dialogNotificationWarning = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.warningMsg({msg: '<div class="jira-dialog-notification-content"></div>'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.dialogHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class=\'dialog-title\'><div class=\'jira-dialog-title-actions\'></div><div class=\'jira-dialog-title-main\'></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.errorDialogTitle = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml(opt_data.text), '</h2>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.singleSelectOptionsComponent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input type="text" class="text custom-field-options-input" id="custom-field-options-input" maxlength="255"/><button type="button" class="aui-button custom-field-options-add" id="custom-field-options-add">', soy.$$escapeHtml("Add"), '</button><div id="custom-field-options-list-container" class="custom-field-options"></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.singleSelectOptionsItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="aui-icon aui-icon-small aui-iconfont-remove-label custom-field-options-delete" href="#"></a><div class="icon-draghandle custom-field-option-handle"></div><div title="', soy.$$escapeHtml(opt_data.name), '" class="custom-field-option-value">', soy.$$escapeHtml(opt_data.name), '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.submitHack = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input tabIndex="-1" type="submit" class="custom-field-trigger" value="submit"/>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.addCompleteError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(soy.$$escapeHtml(opt_data.message));
  if (opt_data.failedSteps.length > 0) {
    output.append('<ul>');
    var failList85 = opt_data.failedSteps;
    var failListLen85 = failList85.length;
    for (var failIndex85 = 0; failIndex85 < failListLen85; failIndex85++) {
      var failData85 = failList85[failIndex85];
      output.append('<li>', soy.$$escapeHtml(failData85), '</li>');
    }
    output.append('</ul>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.sharedByCreate = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var open__soy92 = new soy.StringBuilder('<a>');
  open__soy92 = open__soy92.toString();
  var close__soy94 = new soy.StringBuilder('</a>');
  close__soy94 = close__soy94.toString();
  output.append((opt_data.projects.length > 1) ? '<span>' + AJS.format("This custom field will also be visible in {0}{1} other projects{2}.",open__soy92,opt_data.projects.length,close__soy94) + '</span>' : '<span>' + AJS.format("This custom field will also be visible in {0}1 other project{1}.",open__soy92,close__soy94) + '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.shareByInline = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="shared-item-content"><h3>', soy.$$escapeHtml("Other projects where the field will be visible"), ':</h3><ul class="shared-project-list">');
  var projectList111 = opt_data.projects;
  var projectListLen111 = projectList111.length;
  for (var projectIndex111 = 0; projectIndex111 < projectListLen111; projectIndex111++) {
    var projectData111 = projectList111[projectIndex111];
    output.append('<li><a class="shared-project-name" href="', soy.$$escapeHtml(contextPath), '/plugins/servlet/project-config/', soy.$$escapeHtml(projectData111.key), '"><img class="shared-project-icon" width="16" height="16" alt="" src="', soy.$$escapeHtml(contextPath), '/secure/projectavatar?size=small&amp;pid=', soy.$$escapeHtml(projectData111.id), '" /> ', soy.$$escapeHtml(projectData111.name), '</a></li>');
  }
  output.append('</ul></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/util.js' */
(function(namespace,$,_){function isEmpty(value){return value===undefined||value===null}namespace.lowerCaseLocaleComparator=function(attr){return function(a,b){var a_attr=a.get(attr),b_attr=b.get(attr);if(isEmpty(a_attr)&&isEmpty(b_attr)){return 0}else{if(isEmpty(a_attr)){return -1}else{if(isEmpty(b_attr)){return 1}}}return a_attr.toLocaleLowerCase().localeCompare(b_attr.toLocaleLowerCase())}};namespace.url=function(path,params){if(_.isArray(path)){var realPath="";for(var i=0;i<path.length;i++){realPath=realPath+"/"+encodeURIComponent(""+path[i])}path=realPath}var querystring="";if(params){querystring="?"+$.param(params,true)}return AJS.contextPath()+path+querystring}})(JIRA.Admin.CustomFields,AJS.$,_);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/FilteredCollection.js' */
(function(namespace,Backbone){namespace.FilteredCollection=Backbone.Collection.extend({initialize:function(){this.filteredModels=[]},filter:function(query){var instance=this,state={};var partition=_.groupBy(this.filteredModels,function(model){return instance.matcher(model,query,state)?"show":"hide"});this.filteredModels=partition.hide||[];_.each(partition.show,function(model){instance.add(model)});_.chain(this.models).filter(function(model){return !instance.matcher(model,query,state)}).each(function(model){instance.remove(model);instance.filteredModels.push(model)})}})})(JIRA.Admin.CustomFields,JIRA.Admin.CustomFields.Backbone);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/Dialog.js' */
(function(namespace,AJS,_,$){var Backbone=namespace.Backbone;var Marionette=Backbone.Marionette;namespace.Dialog=function(options){options||(options={});_.defaults(options,{width:840,height:530});options.keypressListener=_.bind(this.onKeydown,this);this._dialog=new AJS.Dialog(options);this._page=this._dialog.getPage(0);this._currentPanel=null;this._notification=null;this._isShown=false;this.$el=this._dialog.popup.element;this._page.header=JIRA.Templates.CustomFields.dialogHeader();this.$el.prepend(this._page.header);this.$el.addClass("jira-customfields-wizard")};_.extend(namespace.Dialog.prototype,Backbone.Events,{_recalcPageSize:function(){if(this.$notification){var panel=this._page.panel[0];if(panel){var height=panel.body.outerHeight()-this.$notification.outerHeight();for(var i=0;i<this._page.panel.length;i++){var body=this._page.panel[i].body;body.css("height",height)}this._page.menu.css("height",height)}}return this},onKeydown:function(event){if(event.keyCode===$.ui.keyCode.ESCAPE){this.trigger("close")}},triggerMethod:Marionette.triggerMethod,_lastButtonElement:function(){var button=_.last(this._page.button);return button.item},_setNotification:function(html,view){if(this._notification&&this._isShown){this._notification._triggerHide()}if(!this.$notification){this.$notification=$(JIRA.Templates.CustomFields.dialogNotification());this.$notification.append(html);this.$el.find(".dialog-components").prepend(this.$notification)}else{this.$notification.html(html)}this._recalcPageSize();this._notification=new Notification(view);if(this._isShown){this._notification._triggerShow()}return this},setWarningNotification:function(view){var el=$(JIRA.Templates.CustomFields.dialogNotificationWarning());el.find(".jira-dialog-notification-content").html(view.render().$el);return this._setNotification(el,view)},addHeaderMain:function(html){this.$el.find(".jira-dialog-title-main").append(html);this._page.recalcSize();return this},addHeaderMainText:function(text){return this.addHeaderMain($("<h2 class='jira-dialog-title-text'/>").text(text))},addHeaderAction:function(view){var $actions=this.$el.find(".jira-dialog-title-actions");$actions.append(view.render().$el);this._page.recalcSize();return this},showLoading:function(){if(!this.$loading){var $before=this.$el.find(".dialog-button-panel button").eq(0);this.$loading=$("<span>").addClass("icon dialog-spinner");this.$loading.insertBefore($before)}this.$loading.spin()},hideLoading:function(){if(this.$loading){this.$loading.spin(false)}},addButton:function(options){this._dialog.addButton(options.label,options.click,"aui-button aui-button-primary");var element=this._lastButtonElement();element.removeClass("button-panel-button");options.id&&element.attr("id",options.id);if(options.submitAccessKey){this._addSubmitKey(element)}return new namespace.Dialog.Button(element)},addLeftLink:function(options){var element;this._dialog.addLink(options.label,options.click,"secondary",options.url);element=this._lastButtonElement();element=element.removeClass("button-panel-button");if(options.iconClass){$('<span class="icon"/>').addClass(options.iconClass).prependTo(element)}return this},addLink:function(options){this._dialog.addLink(options.label,options.click);var element=this._lastButtonElement();if(options.cancelAccessKey){this._addCancelKey(element)}return this},addPanel:function(name,view){this._dialog.addPanel(name,view.render().el);var dialogPanel=this._page.getCurrentPanel();var panel=new namespace.Dialog.Panel(this,name,view,dialogPanel);dialogPanel.button.click(_.bind(function(){this._onShowPanel(panel)},this));this._onShowPanel(panel);return panel},show:function(){if(!this._isShown){this._dialog.show();this._recalcPageSize();this._isShown=true;this._currentPanel&&this._currentPanel._triggerShow();this._notification&&this._notification._triggerShow()}return this},destroy:function(){this.hideLoading();if(this._isShown){this._currentPanel&&this._currentPanel._triggerHide();this._notification&&this._notification._triggerHide();this._dialog.remove();this._isShown=false}},_addSubmitKey:function(el){var key="s";el.prop("accessKey",key);el.attr("title",AJS.format("Press {1}+{0} to submit this form",key,AJS.Navigator.modifierKey()));return this},_addCancelKey:function(el){var key="`";el.prop("accessKey",key);el.attr("title",AJS.format("Press {1}+{0} to cancel",key,AJS.Navigator.modifierKey()));return this},_onShowPanel:function(panel){if(!this._isShown){this._currentPanel=panel;return }if(this._currentPanel){if(!this._currentPanel!==panel){this._currentPanel._triggerHide();this._currentPanel=panel;this._currentPanel._triggerShow()}}else{this._currentPanel=panel;this._currentPanel._triggerShow()}},currentPanel:function(){return this._currentPanel},showErrors:function(errors){if(errors&&errors.length){var newError=$(JIRA.Templates.Messages.errorMessage({message:errors.join(" ")}));if(this.$error){this.$error.replaceWith(newError)}else{var $before=this.$el.find(".dialog-panel-body").filter(":visible");var $form=$before.find("form").filter(":first");if($form.length){$before=$form}$before.prepend(newError)}this.$error=newError}else{if(this.$error){this.$error.remove();delete this.$error}}return this}});namespace.Dialog.Panel=function(dialog,name,view,panel){this.dialog=dialog;this.name=name;this.view=view;this.panel=panel};_.extend(namespace.Dialog.Panel.prototype,Backbone.Events,{_triggerHide:function(){return this.triggerMethod("dialog:panel:hide")},_triggerShow:function(){return this.triggerMethod("dialog:panel:show")},triggerMethod:function(event){Marionette.triggerMethod.call(this,event);this.view.triggerMethod(event);return this},show:function(){this.panel.select();return this}});namespace.Dialog.Button=function(element){this.element=element};_.extend(namespace.Dialog.Button.prototype,{disable:function(){this.element.prop("disabled",true);return this},enable:function(){this.element.prop("disabled",false);return this},click:function(){this.element.click.apply(this.element,arguments);return this},setLabel:function(text){this.element.text(text);return this}});var Notification=function(view){this.view=view};_.extend(Notification.prototype,{_triggerHide:function(){return this.triggerMethod("dialog:notification:hide")},_triggerShow:function(){return this.triggerMethod("dialog:notification:show")},triggerMethod:function(event){this.view.triggerMethod(event);return this}})})(JIRA.Admin.CustomFields,AJS,_,AJS.$);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/Forms.js' */
(function(namespace,Backbone,$,_,Dirty){var Form=namespace.Form=Backbone.View.extend({initialize:function(options){var $el=this.$form=$(aui.form.form(_.defaults(_.pick(options,"id","action"),{action:"",content:"",extraClasses:Dirty.ClassNames.EXEMPT})));this.setElement($el);this.fields={};this.fieldOrder=[];_.each(options.fields,function(field){this.addField(field)},this);this.$form.submit(_.bind(this._submit,this));if($.browser.msie){this.$form.bind("keypress",function(e){if(e.keyCode===$.ui.keyCode.ENTER&&$(e.target).is("input")){e.preventDefault();$(this).submit()}})}},addField:function(field){if(field.content){var content=field.content;if(_.isFunction(content)){content=content.call(this)}this.$form.append(content)}else{var label="";if(field.label){label=aui.form.label({forField:field.id,isRequired:!!field.required,content:field.label})}var fieldGroup=$(aui.form.fieldGroup({content:label}));var newField=new this._getField(field);var name=field.name||field.id;if(name){this.fields[name]=newField}this.fieldOrder.push(newField);this.$form.append(fieldGroup.append(newField.render().$el))}return this},_getField:function(field){if(field.field){return field.field}else{var Type=field.type;if(_.isString(Type)){Type=Form.DEFAULT_TYPES[Type]}var options=_.extend({},field,{form:this});return new Type(options)}},focus:function(){return this._focusFirstField(this.fieldOrder)},blur:function(){_.each(this.fieldOrder,function(field){field.blur()});return this},submit:function(){this.$form.submit();return this},validate:function(){var errors=_.reduce(this.fieldOrder,function(errors,field){if(!field.validate()){errors.push(field)}return errors},[],this);if(errors.length){this._focusFirstField(errors);return false}else{return true}},showErrors:function(fieldErrors,globalErrors){fieldErrors=fieldErrors||{};globalErrors=globalErrors||[];var errors=_.reduce(this.fieldOrder,function(errors,field){if(field.showRelevantErrors(fieldErrors,globalErrors)){errors.push(field)}return errors},[],this);if(errors.length){this._focusFirstField(errors);return true}else{return false}},enable:function(){_.each(this.fieldOrder,function(item){item.enable()});return this},disable:function(){_.each(this.fieldOrder,function(item){item.disable()});return this},isDirty:function(){for(var i=0;i<this.fieldOrder.length;i++){if(this.fieldOrder[i].isDirty()){return true}}return false},toJSON:function(){return _.reduce(this.fieldOrder,function(data,field){field.addValueToData(data);return data},{},this)},_submit:function(e){e.preventDefault();if(!this._interceptSubmit()){if(this.validate()){this.trigger(Form.EVENTS.submit)}}},_interceptSubmit:function(){return _.reduce(this.fieldOrder,function(data,field){return field.handleSubmit()||data},false,this)},_focusFirstField:function(fields){for(var i=0;i<fields.length;i++){if(fields[i].focus()){break}}return this}});Form.Fields={};var FormField=Form.Fields.FormField=Backbone.View.extend({initialize:function(options){},focus:function(){return true},blur:function(){return true},validate:function(){return true},showRelevantErrors:function(fieldErrors,messages){return false},addValueToData:function(data){},setError:function(error){return this},clearError:function(){return this},value:function(value){return this},disable:function(){return this},enable:function(){return this},handleSubmit:function(){return false},isDirty:function(){return false}});Form.Fields.FormField.extend=function(object){if(object.mixin){var initializeCalls=[];object.initialize&&initializeCalls.push(object.initialize);_.each(object.mixin,function(mixin){_.each(mixin,function(value,key){if(key==="initialize"){initializeCalls.push(value)}else{object[key]=value}})});object=_.omit(object,"mixin");if(initializeCalls.length>1){object.initialize=function(){var args=_.toArray(arguments);_.each(initializeCalls,function(func){func.apply(this,args)},this)}}else{if(initializeCalls.length===1){object.initialize=initializeCalls[0]}}}return Backbone.View.extend.call(this,object)};Form.Fields.NamedFieldMixin={initialize:function(options){this.name=options.name||options.id},showRelevantErrors:function(fields){var error=fields[this.name];if(error){this.setError(error);delete fields[this.name];return true}else{this.clearError();return false}},addValueToData:function(data){var val=this.value();if(!_.isUndefined(val)&&!_.isNull(val)&&val!=""){data[this.name]=val}return this}};Form.Fields.ValidatorMixin={initialize:function(options){this.validator=options.validator||Validators.always()},validate:function(){return this.validator.call(this)}};var AbstractTextField=FormField.extend({mixin:[Form.Fields.ValidatorMixin,Form.Fields.NamedFieldMixin],initialize:function(options){this.parent=FormField.prototype;this.parent.initialize.apply(this,arguments)},isDirty:function(){var el=this.$el[0];return el.value!==el.defaultValue},setError:function(text){if(this.$error){this.$error.text(text)}else{this.$error=$(aui.form.fieldError({message:text}));this.$el.after(this.$error)}return this},clearError:function(){if(this.$error){this.$error.remove();delete this.$error}return this},value:function(value){if(_.isUndefined(value)){return $.trim(this.$el.val())||""}else{this.$el.val(""+value);return this}},focus:function(){if(!this.isDisabled()){this.$el.focus();return true}else{return false}},blur:function(){if(this.$el.is(":focus")){this.$el.blur();return true}else{return false}},disable:function(){this.$el.prop("disabled",true);return this},enable:function(){this.$el.prop("disabled",false);return this},isDisabled:function(){return this.$el.prop("disabled")},_getStyle:function(size){switch(size){case FormField.SIZE.large:return"long-field";default:return""}},_getTemplateOptions:function(options,pick,extra){var templateOptions=_.extend(_.pick(options,pick),extra);var size=this._getStyle(options.size);if(size){templateOptions.extraClasses=[size]}return templateOptions}});var TextField=AbstractTextField.extend({initialize:function(options){this.parent=AbstractTextField.prototype;this.parent.initialize.apply(this,arguments);var templateOptions=this._getTemplateOptions(options,["id","maxLength","value"],{type:"text"});this.setElement($(aui.form.input(templateOptions)))}});var TextArea=AbstractTextField.extend({initialize:function(options){this.parent=AbstractTextField.prototype;this.parent.initialize.apply(this,arguments);var templateOptions=this._getTemplateOptions(options,["id","cols"]);this.setElement($(aui.form.textarea(templateOptions)))}});Form.DEFAULT_TYPES={text:TextField,textarea:TextArea};Form.EVENTS={submit:"submit"};FormField.SIZE={large:"large"};var trueFunc=function(){return true};var Validators=Form.Validators={notEmpty:function(error){return function(){if(!this.value()){this.setError(error);return false}else{this.clearError();return true}}},always:function(){return trueFunc}}}(JIRA.Admin.CustomFields,JIRA.Admin.CustomFields.Backbone,AJS.$,_,JIRA.DirtyForm));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/OptionsView.js' */
(function(namespace,_,$,Backbone,AJS,Form){var Bus=function(){};_.extend(Bus.prototype,Backbone.Events);namespace.OptionsField=Form.Fields.FormField.extend({mixin:[Form.Fields.NamedFieldMixin],initialize:function(){this.bus=new Bus();this.options=new Options.Models.Options();this.view=new Options({collection:this.options,bus:this.bus});this.enabled=true;this.listenTo(this.bus,"removeOption",this._removeOption);this.listenTo(this.bus,"moveOption",this._moveOption)},focus:function(){return this.view.focus()},blur:function(){return this.view.blur()},validate:function(){if(!this.options.length){this.setError("Your custom field must have some options.");return false}else{this.clearError();return true}},setError:function(error){this.view.setError(error);return this},clearError:function(){this.view.clearError();return this},value:function(value){if(_.isUndefined(value)){return this.options.map(function(input){return input.pick("name")})}else{return this}},disable:function(){this.enabled=false;this.view.disable();return this},enable:function(){this.enabled=true;this.view.enable();return this},render:function(){this.setElement(this.view.render().$el);return this},handleSubmit:function(){return this.view.handleSubmit()},isDirty:function(){return this.view.isDirty()},_removeOption:function(option){if(this.enabled){this.options.remove(option);this.focus()}},_moveOption:function(options){if(this.enabled){var option=options.option;this.options.remove(option,{silent:true});this.options.add(option,{silent:true,at:options.newIndex});this.focus()}}});var Options=Backbone.Marionette.ItemView.extend({initialize:function(options){this.bus=options.bus;this.options=options.collection;this.optionsView=new Options.Views.OptionViews({collection:this.options,bus:this.bus})},ui:{input:"#custom-field-options-input",addBtn:"#custom-field-options-add",listContainer:"#custom-field-options-list-container"},template:JIRA.Templates.CustomFields.singleSelectOptionsComponent,onRender:function(){this.ui.listContainer.append(this.optionsView.render().$el);var add=_.bind(this._addOptionFromUi,this);this.ui.addBtn.click(add);this.ui.input.keydown(function(e){if(e.keyCode==$.ui.keyCode.ENTER){e.preventDefault();add()}})},_addOptionFromUi:function(){var errors=[];if(!this.addOption(this.input(),errors)){this.setError(errors[0])}else{this.clearError().clearInput()}this.focus();return this},handleSubmit:function(){return false},getOptions:function(){return this.options.pick("name")},addOption:function(optionName,errors){errors=errors||[];optionName=$.trim(optionName);if(!optionName.length){errors.push("Option must have a name.");return false}else{var id=this._nameToId(optionName);if(this.options.get(id)){errors.push("This value already exists in the list.");return false}else{this.options.add({name:optionName,id:id});return true}}},_getFocus:function(){return this.$(":focus")},focus:function(){if(!this.ui.input.prop("disabled")){this.ui.input.focus();return true}else{return false}},blur:function(){var focusEl=this._getFocus();if(focusEl.length){focusEl.blur();return true}else{return false}},clearInput:function(){this.ui.input.val("");return this},input:function(value){if(_.isUndefined(value)){return this.ui.input.val()}else{this.ui.input.val(value);return this}},setError:function(text){if(this.$error){this.$error.text(text)}else{this.$error=$(aui.form.fieldError({message:text}));this.ui.addBtn.after(this.$error)}return this},clearError:function(){if(this.$error){this.$error.remove();delete this.$error}return this},_nameToId:function(name){return name.toLowerCase()},enable:function(){this.ui.listContainer.removeClass("disabled");this._setInputState(true)},disable:function(){this.ui.listContainer.addClass("disabled");this._setInputState(false)},_setInputState:function(enabled){this.ui.input.prop("disabled",!enabled);this.ui.addBtn.prop("disabled",!enabled)},isDirty:function(){return this.ui.input.val()||this.options.length}});Options.Models={};Options.Models.Option=Backbone.Model.extend({});Options.Models.Options=Backbone.Collection.extend({model:Options.Models.Option});Options.Views={};Options.Views.OptionView=Backbone.Marionette.ItemView.extend({events:{"click .custom-field-options-delete":"_delete",moveOption:"_moveOption"},tagName:"li",template:JIRA.Templates.CustomFields.singleSelectOptionsItem,initialize:function(options){this.bus=options.bus},_delete:function(e){e.preventDefault();this.bus.trigger("removeOption",this.model)},_moveOption:function(e,newIndex){this.bus.trigger("moveOption",{option:this.model,newIndex:newIndex})}});Options.Views.OptionViews=Backbone.Marionette.CollectionView.extend({itemView:Options.Views.OptionView,tagName:"ul",id:"custom-field-options-list",initialize:function(options){this.bus=options.bus;this.$el.sortable({axis:"y",containment:".dialog-page-body",tolerance:"pointer",cursor:"move",handle:".custom-field-option-handle",update:this._handleReorder})},itemViewOptions:function(){return{bus:this.bus}},_handleReorder:function(e,ui){ui.item.trigger("moveOption",ui.item.index())}})}(JIRA.Admin.CustomFields,_,AJS.$,JIRA.Admin.CustomFields.Backbone,AJS,JIRA.Admin.CustomFields.Form));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/SharedByNotification.js' */
(function(namespace,$,Backbone,AJS){namespace.SharedByView=Backbone.Marionette.ItemView.extend({initialize:function(options){this.projects=options.projects},template:JIRA.Templates.CustomFields.sharedByCreate,serializeData:function(){return{projects:this.projects}},onDialogNotificationHide:function(){if(this.popup){this.popup.hide();this.popup.remove();delete this.popup}},onDialogNotificationShow:function(){var projects=this.projects;this.popup=AJS.InlineDialog(this.$el.find("a"),"customfield-project-list",function(contents,trigger,showPopup){contents.html(JIRA.Templates.CustomFields.shareByInline({projects:projects}));showPopup()},{width:240,onHover:true,hideDelay:500})}})}(JIRA.Admin.CustomFields,AJS.$,JIRA.Admin.CustomFields.Backbone,AJS));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/TypeItemView.js' */
(function(namespace,Backbone){namespace.TypeItemView=Backbone.Marionette.ItemView.extend({className:"item",submit:function(){this.select();this.triggerMethod("submit",this.getKey())},events:{click:"onClick",dblclick:"onDoubleClick"},onClick:function(event){this.triggerMethod("select");event.preventDefault()},onDoubleClick:function(event){this.submit();event.preventDefault()},reveal:function(){var padding=40;this.$el.scrollIntoViewForAuto({direction:"vertical",marginBottom:padding,marginTop:padding})},select:function(){this.$el.toggleClass("selected",true);this.reveal()},deselect:function(){this.$el.toggleClass("selected",false)},tagName:"li",template:function(serialized_model){return JIRA.Templates.CustomFields.type({type:serialized_model})},getKey:function(){return this.model.get("key")}})})(JIRA.Admin.CustomFields,JIRA.Admin.CustomFields.Backbone);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/EmptyTypeItemView.js' */
(function(namespace,Backbone){namespace.EmptyTypeItemView=Backbone.Marionette.ItemView.extend({tagName:"li",className:"empty",triggers:{"click .customfields-all-category-link":"ongotoall"},setEmptyState:function(state){this.emptyState=state;this.render()},serializeData:function(){return this.emptyState},template:function(serializedData){var html;switch(serializedData){case namespace.EmptyTypeItemView.CHANGE_TAB:html=JIRA.Templates.CustomFields.emptyTypeOtherTab();break;case namespace.EmptyTypeItemView.MARKETPLACE:html=JIRA.Templates.CustomFields.emptyTypeMarketplace({contextPath:AJS.contextPath()});break;default:html=JIRA.Templates.CustomFields.emptyType()}return html}});_.extend(namespace.EmptyTypeItemView,{CHANGE_TAB:"otherTab",MARKETPLACE:"marketplace",EMPTY:"empty"})}(JIRA.Admin.CustomFields,JIRA.Admin.CustomFields.Backbone));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/FieldTypeCollectionView.js' */
(function(namespace,$,Backbone,KeyCode){namespace.FieldTypeCollectionView=Backbone.Marionette.CompositeView.extend({itemView:namespace.TypeItemView,emptyView:namespace.EmptyTypeItemView,itemViewContainer:".customfields-types",indexOf:function(item){if(!item){return -1}return this.collection.indexOf(item.model)},attach:function(){if(this.placeholder){this.placeholder.replaceWith(this.$el);delete this.placeholder}},detach:function(){this.placeholder=$("<div/>").insertBefore(this.$el);this.$el.detach()},initialize:function(){this.selectedView=null;_.bindAll(this)},onItemviewSelect:function(view){this.select(view)},onItemRemoved:function(){this.selectByIndex(0)},onAfterItemAdded:function(){this.selectByIndex(0)},onItemviewSubmit:function(view,key){this.triggerMethod("submit",key)},onItemviewOngotoall:function(){this.triggerMethod("changeToAll")},isEmpty:function(){return !this.collection.length},_getEmptyView:function(){return this.isEmpty()&&this.children.findByIndex(0)},setHasMatches:function(hasMatches){var emptyView=this._getEmptyView(),state;if(!emptyView){return }if(hasMatches){state=namespace.EmptyTypeItemView.CHANGE_TAB}else{if(JIRA.isSysadmin()){state=namespace.EmptyTypeItemView.MARKETPLACE}else{state=namespace.EmptyTypeItemView.EMPTY}}emptyView.setEmptyState(state)},onKeydown:function(event){switch(event.keyCode){case KeyCode.UP:this.collection.length&&this.moveSelect(-1);break;case KeyCode.DOWN:this.collection.length&&this.moveSelect(1);break;case KeyCode.ENTER:this.collection.length&&this.triggerMethod("submit",this.getSelectedKey());break;default:return }event.preventDefault()},moveSelect:function(offset){var index=this.indexOf(this.selectedView);if(index>=0){index=Math.min(this.children.length-1,Math.max(0,index+offset));this.selectByIndex(index)}},select:function(view){if(this.selectedView){this.selectedView.deselect()}this.selectedView=view;view&&this.selectedView.select();this.triggerMethod("changedSelection",{key:this.getSelectedKey()})},selectByIndex:function(index){var view=this._viewAtIndex(index);this.select(view)},_viewAtIndex:function(index){var model=this.collection.at(index);return model&&this.children.findByModel(model)},template:function(){return JIRA.Templates.CustomFields.types()},onDialogPanelHide:function(){this.detach();$(document).unbind("keydown",this.onKeydown)},onDialogPanelShow:function(){this.attach();$(document).bind("keydown",this.onKeydown);this.selectByIndex(0)},getSelectedKey:function(){if(this.selectedView){return this.selectedView.getKey()}else{return null}},getSelectedModel:function(){return this.selectedView&&this.selectedView.model},appendHtml:function(cv,iv,index){var $container=this.getItemViewContainer(cv);if(index===0){$container.prepend(iv.el)}else{$container.children().eq(index-1).after(iv.el)}}})})(JIRA.Admin.CustomFields,AJS.$,JIRA.Admin.CustomFields.Backbone,AJS.$.ui.keyCode);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/QuickSearch.js' */
(function(namespace,Backbone,_){namespace.QuickSearch=Backbone.Marionette.ItemView.extend({className:"search",ui:{input:"input"},initialize:function(options){options=options||{};if(options.delay){this.onInputInput=_.debounce(this.onInputInput,options.delay)}},focus:function(){this.ui.input.focus();return this},onInputInput:function(){this.triggerMethod("change",{value:this.value()})},template:function(){return JIRA.Templates.CustomFields.quickSearch()},value:function(){return this.ui.input.val()},render:function(){Backbone.Marionette.ItemView.prototype.render.apply(this,arguments);this.ui.input.on("input",_.bind(this.onInputInput,this));return this}})}(JIRA.Admin.CustomFields,JIRA.Admin.CustomFields.Backbone,_));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Wizard.js' */
(function(namespace,_,Backbone,Marionette,$){var LoadingStates={initial:function(){return{show:function(){AJS.dim(false);JIRA.Loading.showLoadingIndicator()},hide:function(){JIRA.Loading.hideLoadingIndicator()}}},websudo:function(hide){return{show:function(){},hide:hide}},noop:function(){return{show:function(){},hide:function(){}}},step:function(step){return{show:function(){step.showLoading()},hide:function(){step.hideLoading()}}}};var EVENTS={fail:"fail",error:"error",ready:"ready",next:"next",complete:"complete",websudoBeforeShow:"websudo:before:show",websudoSuccess:"websudo:success",cancel:"cancel",success:"success"};namespace.Wizard=function(options){this.steps=options.steps;this.completeHandler=options.completeHandler;this.loadingTimer=null;this.result=$.Deferred();this.dirtyMessage=options.dirtyMessage||false;this.autoClose=_.isUndefined(options.autoClose)&&true||options.autoClose};_.extend(namespace.Wizard.prototype,Backbone.Events,{start:function(){this.stepId=0;this.step=this.steps[this.stepId];this.loading=LoadingStates.initial();this._complete=false;this._bindToStep(this.step);this._showLoadingDelayed();this.step.show({});if(this.dirtyMessage){this._addDirty()}return this.result},close:function(){this._stopListening();this._hide()},isDirty:function(){for(var i=0;i<this.steps.length;i++){if(this.steps[i].isDirty()){return true}}return false},_stopListening:function(){this._removeDirty();this.stopListening()},_hide:function(){this._hideLoading();this.step&&this.step.hide()},_removeDirty:function(){if(this._unload){if(_.isFunction(this._unload)){window.onbeforeunload=this._unload}else{window.onbeforeunload=null}delete this._unload}},_addDirty:function(){if(!this._unload){this._unload=window.onbeforeunload||true;var instance=this;window.onbeforeunload=function(){if(!instance._complete&&instance.dirtyMessage&&instance.isDirty()){return instance.dirtyMessage}else{if(_.isFunction(instance._unload)){return instance._unload.apply(this,arguments)}else{return void 0}}}}},_onCompleteError:function(fieldErrors,generalErrors){this._hideLoading();this.step.showErrors(fieldErrors,generalErrors)},_onFailure:function(){this.result.rejectWith(this.result,_.toArray(arguments));this.close()},_onCompleteSuccess:function(creation){this._complete=true;this.result.resolve(creation);if(this.autoClose){this.close()}else{this._stopListening()}},_onStepNext:function(object){var nextStep=this.stepId+1;if(nextStep<this.steps.length){var oldStep=this.step;this.stopListening(oldStep);this.step=this.steps[this.stepId=nextStep];this._bindToStep(this.step,oldStep);this._showLoadingDelayed();this.step.show(object)}},_onStepCancel:function(check){if(check&&!this._complete&&this.dirtyMessage&&this.isDirty()){if(!window.confirm(this.dirtyMessage)){return }}this.result.reject(namespace.Wizard.FAIL_REASON.cancel);this.close()},_onStepComplete:function(){var data={},step;for(var i=0;i<this.steps.length;i++){step=this.steps[i];if(step.getCompleteData){data=step.getCompleteData(data)}}if(this.completeHandler){this._showLoadingDelayed(50);this.listenTo(this.completeHandler,EVENTS.websudoBeforeShow,function(){this._hideLoading();this.step.hide();this.loading=LoadingStates.noop()});this.listenTo(this.completeHandler,EVENTS.websudoSuccess,function(closeFunction){this.loading=LoadingStates.websudo(closeFunction)});this.listenToOnce(this.completeHandler,EVENTS.fail,function(){this.stopListening(this.completeHandler);this._onFailure.apply(this,arguments)});this.listenToOnce(this.completeHandler,EVENTS.error,function(){this.stopListening(this.completeHandler);this._onCompleteError.apply(this,arguments)});this.listenToOnce(this.completeHandler,EVENTS.success,function(){this.stopListening(this.completeHandler);this._onCompleteSuccess.apply(this,arguments)});this.completeHandler.execute(data)}else{this._onCompleteSuccess(data)}},_bindToStep:function(step,previousStep){this.listenTo(step,EVENTS.websudoBeforeShow,function(){this._hideLoading();previousStep&&previousStep.hide();this.loading=LoadingStates.noop()},this);this.listenTo(step,EVENTS.ready,function(){this._hideLoading();previousStep&&previousStep.hide();this.loading=LoadingStates.step(step)},this);this.listenTo(step,EVENTS.websudoSuccess,function(closeFunction){this.loading=LoadingStates.websudo(closeFunction)},this);this.listenTo(step,EVENTS.next,this._onStepNext);this.listenTo(step,EVENTS.complete,this._onStepComplete);this.listenTo(step,EVENTS.cancel,this._onStepCancel)},_showLoadingDelayed:function(timeout){this._cancelTimer();this.loadingTimer=window.setTimeout(_.bind(function(){this.loadingTimer=null;this.loading.show()},this),timeout||500)},_showLoading:function(){this._cancelTimer();this.loading.show()},_hideLoading:function(){this._cancelTimer();this.loading&&this.loading.hide()},_cancelTimer:function(){if(this.loadingTimer!==null){window.clearTimeout(this.loadingTimer)}this.loadingTimer=null}});var helper=_.extend({},Backbone.Events,{triggerMethod:Marionette.triggerMethod,ready:function(){this.triggerMethod(EVENTS.ready)},bindToProgress:function(promise){var instance=this;promise.progress(function(name){if(name===namespace.IssueCustomFields.PROGRESS.SHOW){instance.triggerMethod(EVENTS.websudoBeforeShow)}else{if(name===namespace.IssueCustomFields.PROGRESS.SUCCESS){var closeFunction=arguments[1];instance.triggerMethod(EVENTS.websudoSuccess,closeFunction)}}});return promise}});namespace.Wizard.Step=_.extend({},helper,{show:function(){},hide:function(){},next:function(state){this.triggerMethod.apply(this,[EVENTS.next,state])},cancel:function(confirm){this.triggerMethod(EVENTS.cancel,confirm||false)},complete:function(){this.triggerMethod(EVENTS.complete)},showErrors:function(fieldErrors,generalErrors){},isDirty:function(){return false}});namespace.Wizard.Complete=_.extend({},helper,{execute:function(data){this.success(data)},error:function(fieldErrors,generalErrors){this.triggerMethod(EVENTS.error,fieldErrors,generalErrors)},fail:function(){this.triggerMethod.apply(this,[EVENTS.fail].concat(_.toArray(arguments)))},success:function(creation,dirty){this.triggerMethod.apply(this,[EVENTS.success].concat(_.toArray(arguments)))},description:function(){return null}});namespace.Wizard.compositeComplete=function(){return new Composite(_.flatten(_.toArray(arguments)))};var Composite=function(completes){this.completes=completes;_.each(this.completes,function(item){this.listenTo(item,"all",_.bind(this._eventHandler,this,item))},this)};_.extend(Composite.prototype,namespace.Wizard.Complete,{execute:function(data){this.currentPos=0;this.dirty=false;this._runComplete(data)},_runComplete:function(data){this.lastData=data;if(this.currentPos>=this.completes.length){this.success(data)}else{this.currentComplete=this.completes[this.currentPos];this.currentComplete.execute(data)}},_eventHandler:function(complete,name){if(this.currentComplete!==complete){return }if(name===EVENTS.success){this.currentPos++;var data=arguments[2];this.dirty=this.dirty||!!arguments[3];this._runComplete(data)}else{if(name===EVENTS.fail){var errorArgs=_.toArray(arguments).slice(2);var errorComplete=[];for(var i=this.currentPos;i<this.completes.length;i++){var description=this.completes[i].description();description&&errorComplete.push(description)}errorArgs.push({fails:errorComplete,dirty:this.dirty,data:this.lastData});this.fail.apply(this,errorArgs)}else{this.trigger.apply(this,_.toArray(arguments).slice(1))}}},description:function(){return _.map(this.complete,function(item){return item.description()}).join(", ")}});namespace.Wizard.FAIL_REASON={cancel:"cancel",abort:"abort",error:"error"}}(JIRA.Admin.CustomFields,_,JIRA.Admin.CustomFields.Backbone,JIRA.Admin.CustomFields.Backbone.Marionette,AJS.$));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/TypeChoiceStep.js' */
(function(namespace,_,$,AJS,Backbone){var text={heading:"Select a Field Type",panel:"",cancel:"Cancel",next:"Next",marketPlace:"Find More Custom Fields"};var urls={marketplace:AJS.contextPath()+"/plugins/servlet/upm/marketplace/popular?category=Custom+Fields&source=custom_fields_create"};var TypeStep=namespace.TypeChoiceStep=function(options){this.options=_.extend({initialCategory:"STANDARD",view:TypeStep.Views.TypeChoice},options);this.api=options.api;this.categories=null;this.selectedType=null};_.extend(namespace.TypeChoiceStep.prototype,namespace.Wizard.Step,{showLoading:function(){this.view&&this.view.showLoading()},hideLoading:function(){this.view&&this.view.hideLoading()},getCompleteData:function(data){if(this.selectedType){data.type=this.selectedType.get("key");var searchers=this.selectedType.get("searchers");if(searchers&&searchers.length>0){data.searcherKey=searchers[0]}}return data},show:function(field){var view;var def=this._getCategories();def.done(function(categories,sharedBy){var sharedView=sharedBy&&sharedBy.length&&new namespace.SharedByView({projects:sharedBy});view=this.view=new this.options.view(categories,200,sharedView);this.listenTo(view,"submit",function(model){this.selectedType=model;var nextData={};nextData.type=model.pick("name","options","cascading");if(field){nextData.field=field}this.next(nextData)});this.listenTo(view,"cancel",function(check){this.cancel(check)});this.ready();view.show()});def.fail(function(reason,error){if(namespace.Wizard.FAIL_REASON.abort===reason){this.cancel()}else{view=this.view=new namespace.ErrorDialog({heading:text.heading,message:error});this.listenTo(view,"close",this.cancel);this.ready();view.show()}})},hide:function(){if(this.view){this.stopListening(this.view);this.view.hide();delete this.view}},_getCategories:function(){var deferred=$.Deferred(),instance=this;var getting=this.api.getSharedBy(this.api.getCustomFieldTypes());this.bindToProgress(getting);getting.done(function(data){var categories=[];_.each(data.categories,function(cat){var matchedTypes=_.filter(data.types,function(type){return _.contains(type.categories,cat.id)});var types=new TypeStep.Models.Types(matchedTypes,{parse:true});categories.push({initial:cat.id===instance.options.initialCategory,id:cat.id,name:cat.name,types:types})});deferred.resolveWith(instance,[categories,data.sharedBy])});getting.fail(function(statusText,error){if(statusText===namespace.IssueCustomFields.STATUS.abort){deferred.rejectWith(instance,[namespace.Wizard.FAIL_REASON.abort])}else{deferred.rejectWith(instance,[namespace.Wizard.FAIL_REASON.error,error])}});return deferred.promise()}});TypeStep.Models={};TypeStep.Models.Type=Backbone.Model.extend({initialize:function(){this.get("name")||this.set("name",this.get("key"))},parse:function(data){return _.omit(data,"categories")}});TypeStep.Models.Types=namespace.FilteredCollection.extend({model:TypeStep.Models.Type,comparator:namespace.lowerCaseLocaleComparator("name"),matcher:function(model,query,state){var haystack=model.get("name").toLowerCase(),needles=state.needles;if(!needles){state.needles=needles=_.filter(query.toLowerCase().split(/\s+/),function(needle){return needle})}return _.all(needles,function(needle){return haystack.indexOf(needle)!==-1})}});TypeStep.Views={};TypeStep.Views.TypeChoice=function(categories,searchDelay,sharedBy){this.categories=categories;this.searchDelay=searchDelay||0;this.sharedBy=sharedBy};_.extend(TypeStep.Views.TypeChoice.prototype,Backbone.Events,{hide:function(){this.dialog&&this.dialog.destroy()},show:function(){var allPanel,analyticsInits=[],collectionViews=[],defaultPanel=null,dialog=new namespace.Dialog({id:"customfields-select-type",focusSelector:".dialog-title input"}),instance=this,nextButton,quickSearch=new namespace.QuickSearch({delay:this.searchDelay});this.listenTo(quickSearch,"change",function(query){_.each(instance.categories,function(category){category.types.filter(query.value)});var anyMatches=_.any(_.pluck(instance.categories,"types"),function(types){return types.length});_.each(collectionViews,function(collectionView){collectionView.setHasMatches(anyMatches)})});dialog.addHeaderMainText(text.heading);dialog.addHeaderAction(quickSearch);if(this.sharedBy){dialog.setWarningNotification(this.sharedBy)}if(JIRA.isSysadmin()){dialog.addLeftLink({label:text.marketPlace,url:urls.marketplace,iconClass:"jira-icon-marketplace"})}nextButton=dialog.addButton({label:text.next,submitAccessKey:true,click:function(){instance._fireSubmit(dialog.currentPanel().view.getSelectedModel())},id:"customfields-next"});this.listenTo(dialog,"close",_.bind(this._fireCancel,this,true));dialog.addLink({label:text.cancel,click:_.bind(this._fireCancel,this,false),cancelAccessKey:true});_.each(this.categories,function(cat,index){var collectionView=new namespace.FieldTypeCollectionView({collection:cat.types});collectionViews.push(collectionView);instance.listenTo(collectionView,"submit",function(){instance._fireSubmit(collectionView.getSelectedModel())});instance.listenTo(collectionView,"dialog:panel:show",function(){quickSearch.focus();var changedSelectionHandler=function(event){event.key?nextButton.enable():nextButton.disable()};instance.listenTo(collectionView,"changedSelection",changedSelectionHandler);collectionView.once("dialog:panel:hide",function(){instance.stopListening(collectionView,"changedSelection",changedSelectionHandler)},instance);changedSelectionHandler({key:collectionView.getSelectedKey()})});instance.listenTo(collectionView,"changeToAll",function(){allPanel&&allPanel.show()});analyticsInits.push(function(){instance._initAnalytics(cat,collectionView)});var panel=dialog.addPanel(cat.name,collectionView);if(cat.initial){defaultPanel=panel;instance.__currentCategory=cat}if(index===0){allPanel=panel}});defaultPanel&&defaultPanel.show();dialog.show();_.each(analyticsInits,function(init){init()});this.dialog=dialog},_initAnalytics:function(category,view){var instance=this;this.listenTo(view,"dialog:panel:show",function(){instance.__currentCategory=category;AJS.trigger("analytics",{name:"administration.customfields.addwizard.changecategory",data:{id:category.id,name:category.name}})})},_fireSubmit:function(model){AJS.trigger("analytics",{name:"administration.customfields.addwizard.submittype",data:{key:model.get("key"),category:this.__currentCategory.id}});this.trigger("submit",model)},_fireCancel:function(confirm){this.trigger("cancel",confirm)},showLoading:function(){this.dialog&&this.dialog.showLoading()},hideLoading:function(){this.dialog&&this.dialog.hideLoading()}})})(JIRA.Admin.CustomFields,_,AJS.$,AJS,JIRA.Admin.CustomFields.Backbone);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/CreateFieldStep.js' */
(function(namespace,Backbone,$,_,AJS,Form){var FormField=Form.Fields.FormField;var CreateFieldStep=namespace.CreateFieldStep=function(options){this.options=_.extend({view:CreateFieldStep.Views.CreateDialog},options);this.api=options.api};_.extend(namespace.CreateFieldStep.prototype,namespace.Wizard.Step,{show:function(data){var type=data.type||{};var viewOptions=_.extend(_.pick(this.options,["nextLabel"]),{configureOptions:!!type.options&&!type.cascading});var view=this.view=new this.options.view(viewOptions);this.listenTo(view,"submit",function(data){this.data=data;this.view.disable();this.complete()},this);this.listenTo(view,"cancel",function(check){this.cancel(check)},this);this.ready();view.show(data);return this},hide:function(){if(this.view){this.stopListening(this.view);this.view.hide();delete this.view}},getCompleteData:function(data){if(this.data){return _.extend(data,this.data)}else{return data}},showErrors:function(fieldErrors,generalErrors){this.view.enable();this.view.showErrors(fieldErrors,generalErrors)},showLoading:function(){this.view&&this.view.showLoading()},hideLoading:function(){this.view&&this.view.hideLoading()},isDirty:function(){if(this.view){return this.view.isDirty()}else{return false}}});CreateFieldStep.Views={};CreateFieldStep.Views.CreateDialog=function(options){this.options=_.defaults({},options,{nextLabel:"Next",cancelLabel:"Cancel",panel:CreateFieldStep.Views.CreatePanel,fieldName:""});this.enabled=true};_.extend(CreateFieldStep.Views.CreateDialog.prototype,Backbone.Events,{initialize:function(options){this.options=options},show:function(data){var dialog=this.dialog=new namespace.Dialog({id:"customfields-configure-field",focusSelector:"#custom-field-name"});var type=data.type||{};var field=data.field||{};dialog.addHeaderMainText(AJS.format("Configure \'\'{0}\'\' Field",type.name));var panelOptions=_.defaults({},_.pick(this.options,"configureOptions"),{fieldName:field.name});var panel=this.panel=dialog.addPanel("",new this.options.panel(panelOptions));this.listenTo(panel.view,"submit",_.bind(this._submit,this));this.nextButton=dialog.addButton({label:this.options.nextLabel,id:"customfields-next",submitAccessKey:true,click:function(){panel.view.triggerSubmit()}});dialog.addLink({label:this.options.cancelLabel,click:_.bind(this._cancel,this,false),cancelAccessKey:true});this.listenTo(dialog,"close",_.bind(this._cancel,this,true));dialog.show();return this},_submit:function(){var view=this.panel.view;if(this.enabled){this.trigger("submit",view.getData())}},hide:function(){this.stopListening(this.panel);if(this.dialog){this.dialog.destroy();delete this.dialog}return this},showErrors:function(fieldErrors,generalErrors){if(!this.panel.view.showErrors(fieldErrors,generalErrors)){this.panel.view.focus()}var allErrors=_.union(generalErrors,_.values(fieldErrors));this.dialog.showErrors(allErrors)},showLoading:function(){this.dialog&&this.dialog.showLoading()},hideLoading:function(){this.dialog&&this.dialog.hideLoading()},disable:function(){this.enabled=false;this.panel.view.disable();this.nextButton.disable()},enable:function(){this.enabled=true;this.panel.view.enable();this.nextButton.enable()},isDirty:function(){return this.panel.view.isDirty()},_cancel:function(check){this.enabled&&this.trigger("cancel",check)}});CreateFieldStep.Views.CreatePanel=Backbone.Marionette.ItemView.extend({initialize:function(options){options=options||{};this.template=_.bind(this.template,this);this.form=options.form||this._createForm(options);this.listenTo(this.form,Form.EVENTS.submit,this._submit)},template:function(){return this.form.render().$el},_submit:function(){this.triggerMethod("submit")},triggerSubmit:function(){this.form.submit();return this},getData:function(){return this.form.toJSON()},onDialogPanelShow:function(){this.form.blur().focus()},showErrors:function(fieldErrors,generalErrors){return this.form.showErrors(fieldErrors,generalErrors)},focus:function(){this.form.focus();return this},disable:function(){this.form.disable();return this},enable:function(){this.form.enable();return this},isDirty:function(){return this.form.isDirty()},_createForm:function(options){return new Form(this._createFormParams(options))},_createFormParams:function(options){var fields=[{content:JIRA.Templates.CustomFields.submitHack},{id:"custom-field-name",label:"Name",name:"name",type:"text",maxLength:255,required:true,size:FormField.SIZE.large,validator:Form.Validators.notEmpty("You must specify a name for this custom field."),value:options.fieldName},{id:"custom-field-description",label:"Description",name:"description",type:"textarea",rows:2,size:FormField.SIZE.large}];if(options.configureOptions){fields.push({required:true,label:"Options",field:new namespace.OptionsField({name:"options"}),id:"custom-field-options-input"})}return{fields:fields}}});var CreateFieldComplete=namespace.CreateFieldComplete=function(options){this.api=options.api};_.extend(CreateFieldComplete.prototype,namespace.Wizard.Complete,{execute:function(data){if(_.isUndefined(data.id)||data.createField){var instance=this,adding=this.api.addField(data);this.bindToProgress(adding);adding.done(function(field){data.newFieldId=data.id=field.id;instance.success(data,true)});adding.fail(function(errors){instance.error(errors.fields,errors.general)})}else{this.success(data,false)}},description:function(){return "Create field."}});var errorHandler=function(statusText,message){if(statusText===namespace.IssueCustomFields.STATUS.abort){this.fail(namespace.Wizard.FAIL_REASON.abort,message)}else{this.fail(namespace.Wizard.FAIL_REASON.error,message)}};var AddOptionsComplete=namespace.AddOptionsComplete=function(options){this.api=options.api};_.extend(AddOptionsComplete.prototype,namespace.Wizard.Complete,{execute:function(data){if(data.options){var instance=this,configuring=this.api.setOptions(data.id,data.options);this.bindToProgress(configuring);configuring.done(function(){instance.success(data,true)});configuring.fail(_.bind(errorHandler,this))}else{this.success(data,false)}},description:function(){return "Set field options."}});namespace.PutFieldOnIssueComplete=function(options){_.extend(this,_.pick(options,"issue","api"))};_.extend(namespace.PutFieldOnIssueComplete.prototype,namespace.Wizard.Complete,{execute:function(data){var instance=this;var adding=this.api.addFieldToScreen(data.id);this.bindToProgress(adding);adding.done(function(){instance.success(data,true)});adding.fail(_.bind(errorHandler,this))},description:function(){return "Add field to issue."}});namespace.RefreshIssueComplete=function(){};_.extend(namespace.RefreshIssueComplete.prototype,namespace.Wizard.Complete,{execute:function(){var instance=this,args=_.toArray(arguments);JIRA.Issues.Api.refreshSelectedIssue().done(function(){instance.success.apply(instance,args)}).fail(function(){instance.fail(namespace.Wizard.FAIL_REASON.error,"The field was created, but an error occurred while refreshing the issue.")})},description:function(){return "Refresh issue."}})}(JIRA.Admin.CustomFields,JIRA.Admin.CustomFields.Backbone,AJS.$,_,AJS,JIRA.Admin.CustomFields.Form));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/FieldWisherStep/FieldWisherStep.soy' */
// This file was automatically generated from FieldWisherStep.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.CustomFields == 'undefined') { JIRA.Templates.CustomFields = {}; }
if (typeof JIRA.Templates.CustomFields.FieldWisherStep == 'undefined') { JIRA.Templates.CustomFields.FieldWisherStep = {}; }


JIRA.Templates.CustomFields.FieldWisherStep.form = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form class="aui"><div class="field-group"><label for="field-name">', soy.$$escapeHtml("Name"), ' <span class="aui-icon icon-required">', soy.$$escapeHtml("(required)"), '</span></label><select name="field-name" id="field-name"><option data-placeholder="empty"></option>');
  var fieldList8 = opt_data.fields;
  var fieldListLen8 = fieldList8.length;
  for (var fieldIndex8 = 0; fieldIndex8 < fieldListLen8; fieldIndex8++) {
    var fieldData8 = fieldList8[fieldIndex8];
    output.append('<option value="', soy.$$escapeHtml(fieldData8.id), '">', soy.$$escapeHtml(fieldData8.name), '</option>');
  }
  output.append('</select><div class="description">', soy.$$escapeHtml("Search for an existing field, or name a new one."), '</div></div></form>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/FieldWisherStep/FieldWisherStep.js' */
(function(namespace,Backbone,$,_){var FieldWisherStep=namespace.FieldWisherStep=function(options){this.api=options.api};_.extend(FieldWisherStep.prototype,namespace.Wizard.Step,{showLoading:function(){this.dialog&&this.dialog.showLoading()},hideLoading:function(){this.dialog&&this.dialog.hideLoading()},getCompleteData:function(data){return _.extend(data,this.completeData)},show:function(){var self=this,fieldsPromise=this._getFields();fieldsPromise.done(function(fields){var dialog=self.dialog=new FieldWisherStep.Dialog({fields:fields});self.listenTo(dialog,"cancel",function(checkDirty){this.cancel(checkDirty)});self.listenTo(dialog,"submit",function(wish){var cd=this.completeData=_.clone(wish);if(wish.id){cd.createField=false;this.complete()}else{cd.createField=true;this.next(wish)}});self.ready();dialog.show()});fieldsPromise.fail(function(kind,message){if(namespace.Wizard.FAIL_REASON.abort===kind){self.cancel()}else{var dialog=self.dialog=new namespace.ErrorDialog({heading:FieldWisherStep.Dialog.prototype.text.heading,message:message});self.listenTo(dialog,"close",self.cancel);self.ready();dialog.show()}})},isDirty:function(){if(this.dialog){return this.dialog.isDirty()}else{return !!this.completeData}},hide:function(){if(this.dialog){this.stopListening(this.dialog);this.dialog.hide();delete this.dialog}},_getFields:function(){var fields=$.Deferred(),instance=this;var getting=this.api.addableFields();this.bindToProgress(getting);getting.done(fields.resolve);getting.fail(function(statusText,error){if(statusText===namespace.IssueCustomFields.STATUS.abort){fields.rejectWith(instance,[namespace.Wizard.FAIL_REASON.abort])}else{fields.rejectWith(instance,[namespace.Wizard.FAIL_REASON.error,error])}});return fields.promise()}})}(JIRA.Admin.CustomFields,JIRA.Admin.CustomFields.Backbone,AJS.$,_));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/FieldWisherStep/Dialog.js' */
(function(namespace,Backbone,$,_,AJS){namespace.FieldWisherStep.Dialog=function(options){_.bindAll(this,"submit");this.text=_.clone(this.text);this.text.nextButton=_.bind(this.text.nextButton,this);this.model=new Backbone.Model({fieldId:undefined,fieldName:undefined,canSubmit:undefined,isSubmitted:undefined,isValid:undefined});this.dialog=new namespace.Dialog({id:"customfields-field-wisher",height:220,width:520});this.$el=this.dialog.$el;this.panel=new namespace.FieldWisherStep.Panel({fields:options.fields});this.dialog.addPanel("",this.panel);this.dialog.addHeaderMainText(this.text.heading);this.nextButton=this.dialog.addButton({label:this.text.nextButton(),id:"customfields-next",submitAccessKey:true,click:this.submit});this.dialog.addLink({label:this.text.cancel,click:_.bind(this.cancel,this,false),cancelAccessKey:true});this.listenTo(this.model,"change:fieldId change:fieldName",this.calculateIsValid);this.listenTo(this.model,"change:isValid change:isSubmitted",this.calculateCanSubmit);this.listenTo(this.model,"change:fieldId",this.onChangeFieldId);this.listenTo(this.model,"change:canSubmit",this.onChangeCanSubmit);this.listenTo(this.model,"change:isSubmitted",this.onChangeIsSubmitted);this.listenTo(this.panel,"change:field",this.onPanelChangeField);this.listenTo(this.panel,"request:submit",this.onPanelRequestSubmit);this.listenTo(this.dialog,"close",_.bind(this.cancel,this,true));this.calculateIsValid(this.model);this.calculateCanSubmit(this.model)};_.extend(namespace.FieldWisherStep.Dialog.prototype,Backbone.Events,{text:{cancel:"Cancel",create:"Create",add:"Add",heading:"Add Field",nextButton:function(){return !!this.model.get("fieldId")?this.text.add:this.text.create}},triggerMethod:Backbone.Marionette.triggerMethod,show:function(){this.dialog.show();return this},hide:function(){this.stopListening(this.panel);this.dialog.destroy();return this},showLoading:function(){this.dialog&&this.dialog.showLoading()},hideLoading:function(){this.dialog&&this.dialog.hideLoading()},submit:function(){var result={id:this.model.get("fieldId"),name:this.model.get("fieldName")};if(!result.id){delete result.id}this.model.set("isSubmitted",true);this.triggerMethod("submit",result)},cancel:function(check){this.triggerMethod("cancel",check||false)},onPanelChangeField:function(field){this.model.set({fieldId:field.id,fieldName:field.name})},onPanelRequestSubmit:function(){if(this.model.get("canSubmit")){this.submit()}},onChangeFieldId:function(){this.nextButton.setLabel(this.text.nextButton())},onChangeCanSubmit:function(model){if(model.get("canSubmit")){this.nextButton.enable()}else{this.nextButton.disable()}},onChangeIsSubmitted:function(){this.panel.disable();this.showLoading()},calculateIsValid:function(model){model.set("isValid",!!model.get("fieldName"))},calculateCanSubmit:function(model){model.set("canSubmit",model.get("isValid")&&!model.get("isSubmitted"))},isDirty:function(){return !!this.model.get("fieldName")||this.panel.isDirty()}})}(JIRA.Admin.CustomFields,JIRA.Admin.CustomFields.Backbone,AJS.$,_,AJS));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/FieldWisherStep/Panel.js' */
(function(namespace,Backbone,$,_,AJS){namespace.FieldWisherStep.Panel=Backbone.Marionette.ItemView.extend({ui:{select:"select"},initialize:function(options){this.template=_.bind(this.template,this);this.model=new Backbone.Model({fieldId:null,fieldName:null,fields:options.fields})},template:function(){return JIRA.Templates.CustomFields.FieldWisherStep.form({fields:this.model.get("fields")})},onRender:function(){this.fieldSelect=new AJS.SingleSelect({element:this.ui.select,itemAttrDisplayed:"label",suggestionsHandler:this.ExistingOrCreateSuggester,errorMessage:""});this.bindUIElements()},events:{"selected select":"onFrotherSelected","unselect select":"onFrotherUnselect","submit form":"onSubmit"},onFrotherSelected:function(event,item){var name;name="fieldText" in item.properties?item.properties.fieldText:item.properties.label;this.model.set({fieldId:item.properties.value,fieldName:name})},onFrotherUnselect:function(){this.model.set({fieldId:null,fieldName:null})},onSubmit:function(event){event.preventDefault();this.trigger("request:submit")},enable:function(){this.fieldSelect&&this.fieldSelect.enable()},disable:function(){this.fieldSelect&&this.fieldSelect.disable()},isDirty:function(){return !!(this.fieldSelect&&(this.fieldSelect.getQueryVal()||this.fieldSelect.getSelectedDescriptor()))},modelEvents:{"change:fieldId":"onChangeField","change:fieldName":"onChangeField"},onChangeField:function(model){var field={id:model.get("fieldId"),name:model.get("fieldName")};if(!field.id){delete field.id}this.trigger("change:field",field)},ExistingOrCreateSuggester:AJS.SelectSuggestHandler.extend({formatSuggestions:function(descriptors,query){var suggestions;suggestions=this.sorted(descriptors);if(query.length>0){suggestions.push(this.creationSuggestion(query))}return suggestions},sorted:function(descriptors){var items;items=AJS.SuggestHelper.extractItems(descriptors).sort(function(a,b){a=a.label().toLowerCase();b=b.label().toLowerCase();return a.localeCompare(b)});return[new AJS.GroupDescriptor({items:items})]},creationSuggestion:function(label){var item;item=new AJS.ItemDescriptor({value:"",label:AJS.format("{0} (Create new field)",label),fieldText:label,title:label,allowDuplicate:false,noExactMatch:true});return new AJS.GroupDescriptor({label:"user inputted option",showLabel:false,replace:true,items:[item]})}})})}(JIRA.Admin.CustomFields,JIRA.Admin.CustomFields.Backbone,AJS.$,_,AJS));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/io/IssueCustomFields.js' */
(function(namespace,$,_){namespace.IssueCustomFields=function(options){options||(options={});_.extend(this,_.defaults(options,{autoCloseWebsudo:true}))};var standardErrorHandler=function(promise,statusText,smartAjaxResult){if(statusText!=="abort"){promise.reject(namespace.IssueCustomFields.STATUS.error,JIRA.SmartAjax.buildSimpleErrorContent(smartAjaxResult))}else{promise.reject(namespace.IssueCustomFields.STATUS.abort,null)}};var partial=function(func){return _.bind.apply(_,[func,undefined].concat(_.toArray(arguments).slice(1)))};_.extend(namespace.IssueCustomFields.prototype,{getSharedBy:function(wrap){var fields=this;var def=$.Deferred();wrap.done(function(origData){var instance=this,args;if(_.isUndefined(fields.issue)){origData.sharedBy=[];def.resolveWith(this,arguments)}else{args=_.toArray(arguments);var ajax=fields._ajax({type:"GET",url:namespace.url(["rest","globalconfig",1,"issuecustomfields",fields.issue,"affectedProjects"]),dataType:"json",contentType:"application/json"});ajax.done(function(sharedBy){origData.sharedBy=sharedBy;def.resolveWith(instance,args)});ajax.fail(function(){origData.sharedBy=[];def.resolveWith(instance,args)});ajax.progress(function(){def.notifyWith(instance,arguments)})}});wrap.fail(function(){def.rejectWith(this,arguments)});wrap.progress(function(){def.notifyWith(this,arguments)});return def.promise()},addFieldToScreen:function(field){var adding=$.Deferred();if(_.isUndefined(this.issue)){adding.reject(namespace.IssueCustomFields.STATUS.error,"No issue provided.")}else{var ajax=this._ajax({type:"POST",url:namespace.url(["rest","globalconfig",1,"issuecustomfields",this.issue]),data:field,dataType:"json",contentType:"application/json"});ajax.done(adding.resolve);ajax.progress(adding.notify);ajax.fail(partial(standardErrorHandler,adding))}return adding.promise()},addField:function(field){var instance=this,data=_.pick(field,"name","description","searcherKey","type");var def=this._ajax({type:"POST",url:namespace.url("/rest/api/2/field"),context:this,data:JSON.stringify(data),dataType:"json",contentType:"application/json"});return def.pipe(undefined,function(statusText,smartAjaxResult){return instance._parseErrorCollection(smartAjaxResult,{fieldName:"name"})})},addableFields:function(){var fields=$.Deferred();if(_.isUndefined(this.issue)){fields.reject(namespace.IssueCustomFields.STATUS.error,"No issue provided.")}else{var ajax=this._ajax({type:"GET",url:namespace.url(["rest","globalconfig",1,"issuecustomfields",this.issue,"addableFields"]),contentType:"application/json"});ajax.done(fields.resolve);ajax.progress(fields.notify);ajax.fail(partial(standardErrorHandler,fields))}return fields.promise()},setOptions:function(fieldId,options){var def=this._ajax({type:"POST",url:namespace.url(["rest","globalconfig","1","customfieldoptions",fieldId]),context:this,data:JSON.stringify(options),dataType:"json",contentType:"application/json"});var wrapped=$.Deferred();def.done(wrapped.resolve);def.progress(wrapped.notify);def.fail(partial(standardErrorHandler,wrapped));return wrapped},getCustomFieldTypes:function(){var ajaxing=this._ajax({type:"GET",url:namespace.url("/rest/globalconfig/1/customfieldtypes"),dataType:"json",contentType:"application/json"});var wrapped=$.Deferred();ajaxing.done(wrapped.resolve);ajaxing.progress(wrapped.notify);ajaxing.fail(partial(standardErrorHandler,wrapped));return wrapped},_remapObject:function(object,mapping){var remapped={};_.each(object,function(value,key){var newName=mapping[key]||key;remapped[newName]=value});return remapped},_parseErrorCollection:function(response,mapping){var generalErrors,fieldErrors;if(response.hasData){try{var parsed=JSON.parse(response.data);if(!_.isEmpty(parsed.errorMessages)){generalErrors=parsed.errorMessages}if(!_.isEmpty(parsed.errors)){fieldErrors=parsed.errors;if(mapping){fieldErrors=this._remapObject(fieldErrors,mapping)}}}catch(e){}}if(!generalErrors&&!fieldErrors){generalErrors=[JIRA.SmartAjax.buildSimpleErrorContent(response)]}return{fields:fieldErrors||{},general:generalErrors||[]}},_ajax:function(ajaxOptions){var instance=this;var wrapped=$.Deferred();var ajax=JIRA.SmartAjax.makeWebSudoRequest(ajaxOptions,{beforeShow:function(){wrapped.notify(namespace.IssueCustomFields.PROGRESS.SHOW)},success:function(closeFunction){wrapped.notify(namespace.IssueCustomFields.PROGRESS.SUCCESS,closeFunction);instance.autoCloseWebsudo&&closeFunction()},cancel:function(e){e.preventDefault();wrapped.rejectWith(instance,["abort",undefined])}});ajax.done(function(){wrapped.resolveWith(this,_.toArray(arguments))});ajax.fail(function(xhr,statusText,errorThrown,smartAjaxResult){wrapped.rejectWith(this,[statusText,smartAjaxResult])});return wrapped.promise()}});namespace.IssueCustomFields.STATUS={abort:"abort",error:"error"};namespace.IssueCustomFields.PROGRESS={SHOW:"websudoShow",SUCCESS:"websudoSuccess"}}(JIRA.Admin.CustomFields,AJS.$,_));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/main.js' */
(function($,namespace,AJS){namespace.addCustomField=function(){var api=new namespace.IssueCustomFields({autoCloseWebsudo:false});return new namespace.Wizard({autoClose:false,dirtyMessage:"You started adding a custom field. Your changes will be lost if you navigate away without finishing.",steps:[new namespace.TypeChoiceStep({api:api}),new namespace.CreateFieldStep({api:api})],completeHandler:namespace.Wizard.compositeComplete(new namespace.CreateFieldComplete({api:api}),new namespace.AddOptionsComplete({api:api}))}).start().done(function(){AJS.trigger("analytics",{name:"administration.customfields.created.from.global"})})};namespace.addCustomFieldToIssue=function(issue){var api,wizard,steps,completes;api=new namespace.IssueCustomFields({autoCloseWebsudo:false,issue:issue});steps=[new namespace.FieldWisherStep({api:api}),new namespace.TypeChoiceStep({api:api}),new namespace.CreateFieldStep({nextLabel:"Create",api:api})];completes=[new namespace.CreateFieldComplete({api:api}),new namespace.AddOptionsComplete({api:api}),new namespace.PutFieldOnIssueComplete({api:api}),new namespace.RefreshIssueComplete()];wizard=new namespace.Wizard({autoClose:false,dirtyMessage:"You started adding a custom field. Your changes will be lost if you navigate away without finishing.",steps:steps,completeHandler:namespace.Wizard.compositeComplete(completes)});return wizard.start().fail(namespace.addCustomFieldToIssue.notifyFailure).done(namespace.addCustomFieldToIssue.analytics).done(function(field){wizard.close();namespace.addCustomFieldToIssue.editOrNotify(field)})};_.extend(namespace.addCustomFieldToIssue,{editOrNotify:function(field){if(!namespace.addCustomFieldToIssue.editValue(field)){namespace.addCustomFieldToIssue.notifySuccess()}},editValue:function(field){var edit=JIRA&&JIRA.Issues&&JIRA.Issues.Api&&JIRA.Issues.Api.editFieldOnSelectedIssue;return edit&&edit(field.id)},notifyFailure:(function(){var stepsMessage=function(message,fails){showMessage(JIRA.Templates.CustomFields.addCompleteError({message:message,failedSteps:fails||[]}))};var showMessage=function(message){JIRA.Messages.showMsg(message,{type:JIRA.Messages.Types.ERROR,closeable:true})};return function(reason,wizardMsg,compositeResult){var REASONS=namespace.Wizard.FAIL_REASON,data;compositeResult=compositeResult||{};data=compositeResult.data||{};if(reason===REASONS.abort){if(compositeResult.dirty){if(data.createField){stepsMessage("The field was created but the following operations were aborted:",compositeResult.fails)}else{showMessage("Unable to add field to issue.")}}}else{if(reason===REASONS.error){if(data.createField){stepsMessage("The field was created but the following operations failed:",compositeResult.fails)}else{showMessage("Unable to add field to issue.")}}}}}()),notifySuccess:function(){JIRA.Messages.showMsg("The field was added successfully.",{type:JIRA.Messages.Types.SUCCESS,closeable:true})},analytics:function(data){if(data.createField){AJS.trigger("analytics",{name:"administration.customfields.created.and.added.to.issue"})}else{AJS.trigger("analytics",{name:"administration.customfields.existing.added.to.issue"})}}});$(document).on("click",".issueaction-fields-add",function(event){event.preventDefault();var issue=JIRA.Issues.Api.getSelectedIssueId();JIRA.Admin.CustomFields.addCustomFieldToIssue(issue)});$(document).on("click","#add_custom_fields",function(event){event.preventDefault();JIRA.Admin.CustomFields.addCustomField().done(function(field){var destination=namespace.url("/secure/admin/AssociateFieldToScreens!default.jspa",{fieldId:field.id,returnUrl:"ViewCustomFields.jspa"});AJS.reloadViaWindowLocation(destination)})})})(AJS.$,JIRA.Admin.CustomFields,AJS);
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/rpc.js' */
var gadgets=gadgets||{};gadgets.rpc=function(){var CALLBACK_NAME="__cb";var DEFAULT_NAME="";var FE_G2C_CHANNEL="__g2c_rpc";var FE_C2G_CHANNEL="__c2g_rpc";var services={};var iframePool=[];var relayUrl={};var useLegacyProtocol={};var authToken={};var callId=0;var callbacks={};var setup={};var sameDomain={};var params={};if(gadgets.util){params=gadgets.util.getUrlParameters()}authToken[".."]=params.rpctoken||params.ifpctok||0;function getRelayChannel(){return typeof window.postMessage==="function"?"wpm":typeof document.postMessage==="function"?"dpm":navigator.product==="Gecko"?"fe":"ifpc"}function setupChannel(){if(relayChannel==="dpm"||relayChannel==="wpm"){window.addEventListener("message",function(packet){process(gadgets.json.parse(packet.data))},false)}}var relayChannel=getRelayChannel();setupChannel();services[DEFAULT_NAME]=function(){throw new Error("Unknown RPC service: "+this.s)};services[CALLBACK_NAME]=function(callbackId,result){var callback=callbacks[callbackId];if(callback){delete callbacks[callbackId];callback(result)}};function setupFrame(frameId){if(setup[frameId]){return }if(relayChannel==="fe"){try{var frame=document.getElementById(frameId);frame[FE_G2C_CHANNEL]=function(args){process(gadgets.json.parse(args))}}catch(e){}}setup[frameId]=true}function encodeLegacyData(args){var stringify=gadgets.json.stringify;var argsEscaped=[];for(var i=0,j=args.length;i<j;++i){argsEscaped.push(encodeURIComponent(stringify(args[i])))}return argsEscaped.join("&")}function process(rpc){if(rpc&&typeof rpc.s==="string"&&typeof rpc.f==="string"&&rpc.a instanceof Array){if(authToken[rpc.f]){if(authToken[rpc.f]!=rpc.t){if(AJS.debug){console.log("Invalid auth token received for operation: "+rpc.s)}return }}if(rpc.c){rpc.callback=function(result){gadgets.rpc.call(rpc.f,CALLBACK_NAME,null,rpc.c,result)}}var result=(services[rpc.s]||services[DEFAULT_NAME]).apply(rpc,rpc.a);if(rpc.c&&typeof result!="undefined"){gadgets.rpc.call(rpc.f,CALLBACK_NAME,null,rpc.c,result)}}}function callFrameElement(targetId,serviceName,from,rpcData,callArgs){try{if(from!=".."){var fe=window.frameElement;if(typeof fe[FE_G2C_CHANNEL]==="function"){if(typeof fe[FE_G2C_CHANNEL][FE_C2G_CHANNEL]!=="function"){fe[FE_G2C_CHANNEL][FE_C2G_CHANNEL]=function(args){process(gadgets.json.parse(args))}}fe[FE_G2C_CHANNEL](rpcData);return }}else{var frame=document.getElementById(targetId);if(typeof frame[FE_G2C_CHANNEL]==="function"&&typeof frame[FE_G2C_CHANNEL][FE_C2G_CHANNEL]==="function"){frame[FE_G2C_CHANNEL][FE_C2G_CHANNEL](rpcData);return }}}catch(e){}callIfpc(targetId,serviceName,from,rpcData,callArgs)}function callIfpc(targetId,serviceName,from,rpcData,callArgs){var relay=gadgets.rpc.getRelayUrl(targetId);if(!relay){throw new Error("No relay file assigned for IFPC")}var src=null;if(useLegacyProtocol[targetId]){src=[relay,"#",encodeLegacyData([from,callId,1,0,encodeLegacyData([from,serviceName,"","",from].concat(callArgs))])].join("")}else{src=[relay,"#",targetId,"&",from,"@",callId,"&1&0&",encodeURIComponent(rpcData)].join("")}emitInvisibleIframe(src)}function emitInvisibleIframe(src){var iframe;for(var i=iframePool.length-1;i>=0;--i){var ifr=iframePool[i];try{if(ifr&&(ifr.recyclable||ifr.readyState==="complete")){ifr.parentNode.removeChild(ifr);if(window.ActiveXObject){iframePool[i]=ifr=null;iframePool.splice(i,1)}else{ifr.recyclable=false;iframe=ifr;break}}}catch(e){}}if(!iframe){iframe=document.createElement("iframe");iframe.style.border=iframe.style.width=iframe.style.height="0px";iframe.style.visibility="hidden";iframe.style.position="absolute";iframe.onload=function(){this.recyclable=true};iframePool.push(iframe)}iframe.src=src;setTimeout(function(){document.body.appendChild(iframe)},0)}function callSameDomain(target,rpc){if(typeof sameDomain[target]==="undefined"){sameDomain[target]=false;var targetEl=null;if(target===".."){targetEl=parent}else{targetEl=frames[target]}try{sameDomain[target]=targetEl.gadgets.rpc.receiveSameDomain}catch(e){}}if(typeof sameDomain[target]==="function"){sameDomain[target](rpc);return true}return false}if(gadgets.config){function init(config){if(config.rpc.parentRelayUrl.substring(0,7)==="http://"){relayUrl[".."]=config.rpc.parentRelayUrl}else{var params=document.location.search.substring(0).split("&");var parentParam="";for(var i=0,param;param=params[i];++i){if(param.indexOf("parent=")===0){parentParam=decodeURIComponent(param.substring(7));break}}relayUrl[".."]=parentParam+config.rpc.parentRelayUrl}useLegacyProtocol[".."]=!!config.rpc.useLegacyProtocol}var requiredConfig={parentRelayUrl:gadgets.config.NonEmptyStringValidator};gadgets.config.register("rpc",requiredConfig,init)}return{register:function(serviceName,handler){if(serviceName==CALLBACK_NAME){throw new Error("Cannot overwrite callback service")}if(serviceName==DEFAULT_NAME){throw new Error("Cannot overwrite default service:"+" use registerDefault")}services[serviceName]=handler},unregister:function(serviceName){if(serviceName==CALLBACK_NAME){throw new Error("Cannot delete callback service")}if(serviceName==DEFAULT_NAME){throw new Error("Cannot delete default service:"+" use unregisterDefault")}delete services[serviceName]},registerDefault:function(handler){services[""]=handler},unregisterDefault:function(){delete services[""]},call:function(targetId,serviceName,callback,var_args){++callId;targetId=targetId||"..";if(callback){callbacks[callId]=callback}var from="..";if(targetId===".."){from=window.name}var rpc={s:serviceName,f:from,c:callback?callId:0,a:Array.prototype.slice.call(arguments,3),t:authToken[targetId]};if(callSameDomain(targetId,rpc)){return }var rpcData=gadgets.json.stringify(rpc);var channelType=relayChannel;if(useLegacyProtocol[targetId]){channelType="ifpc"}switch(channelType){case"dpm":var targetDoc=targetId===".."?parent.document:frames[targetId].document;targetDoc.postMessage(rpcData);break;case"wpm":var targetWin=targetId===".."?parent:frames[targetId];targetWin.postMessage(rpcData,relayUrl[targetId]);break;case"fe":callFrameElement(targetId,serviceName,from,rpcData,rpc.a);break;default:callIfpc(targetId,serviceName,from,rpcData,rpc.a);break}},getRelayUrl:function(targetId){return relayUrl[targetId]},setRelayUrl:function(targetId,url,opt_useLegacy){relayUrl[targetId]=url;useLegacyProtocol[targetId]=!!opt_useLegacy},setAuthToken:function(targetId,token){authToken[targetId]=token;setupFrame(targetId)},getRelayChannel:function(){return relayChannel},receive:function(fragment){if(fragment.length>4){process(gadgets.json.parse(decodeURIComponent(fragment[fragment.length-1])))}},receiveSameDomain:function(rpc){rpc.a=Array.prototype.slice.call(rpc.a);window.setTimeout(function(){process(rpc)},0)}}}();
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/util.js' */
Function.prototype.inherits=function(parentCtor){function tempCtor(){}tempCtor.prototype=parentCtor.prototype;this.superClass_=parentCtor.prototype;this.prototype=new tempCtor();this.prototype.constructor=this};
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/json.js' */
var gadgets=gadgets||{};gadgets.json=function(){function f(n){return n<10?"0"+n:n}Date.prototype.toJSON=function(){return[this.getUTCFullYear(),"-",f(this.getUTCMonth()+1),"-",f(this.getUTCDate()),"T",f(this.getUTCHours()),":",f(this.getUTCMinutes()),":",f(this.getUTCSeconds()),"Z"].join("")};var m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function stringify(value){var a,i,k,l,r=/["\\\x00-\x1f\x7f-\x9f]/g,v;switch(typeof value){case"string":return r.test(value)?'"'+value.replace(r,function(a){var c=m[a];if(c){return c}c=a.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"':'"'+value+'"';case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}a=[];if(typeof value.length==="number"&&!(value.propertyIsEnumerable("length"))){l=value.length;for(i=0;i<l;i+=1){a.push(stringify(value[i])||"null")}return"["+a.join(",")+"]"}for(k in value){if(value.hasOwnProperty(k)){if(typeof k==="string"){v=stringify(value[k]);if(v){a.push(stringify(k)+":"+v)}}}}return"{"+a.join(",")+"}"}}return{stringify:stringify,parse:function(text){if(/^[\],:{}\s]*$/.test(text.replace(/\\["\\\/b-u]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){return eval("("+text+")")}return false}}}();
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/gadgets-core.js' */
var gadgets=gadgets||{};gadgets.error={};gadgets.error.SUBCLASS_RESPONSIBILITY="subclass responsibility";gadgets.error.TO_BE_DONE="to be done";gadgets.log=function(message){if(window.console&&console.log){console.log(message)}else{var logEntry=document.createElement("div");logEntry.className="gadgets-log-entry";logEntry.innerHTML=message;document.body.appendChild(logEntry)}};gadgets.Extensible=function(){};gadgets.Extensible.prototype.setDependencies=function(dependencies){for(var p in dependencies){this[p]=dependencies[p]}};gadgets.Extensible.prototype.getDependencies=function(name){return this[name]};gadgets.UserPrefStore=function(){};gadgets.UserPrefStore.prototype.getPrefs=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.UserPrefStore.prototype.savePrefs=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.DefaultUserPrefStore=function(){gadgets.UserPrefStore.call(this)};gadgets.DefaultUserPrefStore.inherits(gadgets.UserPrefStore);gadgets.DefaultUserPrefStore.prototype.getPrefs=function(gadget){};gadgets.DefaultUserPrefStore.prototype.savePrefs=function(gadget){};gadgets.GadgetService=function(){};gadgets.GadgetService.prototype.setHeight=function(elementId,height){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.GadgetService.prototype.setTitle=function(gadget,title){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.GadgetService.prototype.setUserPref=function(id){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.IfrGadgetService=function(){gadgets.GadgetService.call(this);var service=this;gadgets.rpc.register("resize_iframe",function(){service.setHeight.apply(this,arguments)});gadgets.rpc.register("set_pref",function(){service.setUserPref.apply(this,arguments)});gadgets.rpc.register("set_title",function(){service.setTitle.apply(this,arguments)});gadgets.rpc.register("requestNavigateTo",function(){service.requestNavigateTo.apply(this,arguments)})};gadgets.IfrGadgetService.inherits(gadgets.GadgetService);gadgets.IfrGadgetService.prototype.setHeight=function(height){if(height>gadgets.container.maxheight_){height=gadgets.container.maxheight_}var element=document.getElementById(this.f);if(element){element.style.height=height+"px"}};gadgets.IfrGadgetService.prototype.requestNavigateTo=function(view,opt_params){var id=this.getGadgetIdFromModuleId(this.f);var url=this.getUrlForView(view);if(opt_params){var paramStr=JSON.stringify(opt_params);if(paramStr.length>0){url+="&appParams="+encodeURIComponent(paramStr)}}if(url&&document.location.href.indexOf(url)==-1){document.location.href=url}};gadgets.IfrGadgetService.prototype.getUrlForView=function(view){if(view==="canvas"){return"/canvas"}else{if(view==="profile"){return"/profile"}else{return null}}};gadgets.IfrGadgetService.prototype.getGadgetIdFromModuleId=function(moduleId){return parseInt(moduleId.match(/_([0-9]+)$/)[1],10)};gadgets.LayoutManager=function(){};gadgets.LayoutManager.prototype.getGadgetChrome=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.StaticLayoutManager=function(){gadgets.LayoutManager.call(this)};gadgets.StaticLayoutManager.inherits(gadgets.LayoutManager);gadgets.StaticLayoutManager.prototype.setGadgetChromeIds=function(gadgetChromeIds){this.gadgetChromeIds_=gadgetChromeIds};gadgets.StaticLayoutManager.prototype.getGadgetChrome=function(gadget){var chromeId=this.gadgetChromeIds_[gadget.id];return chromeId?document.getElementById(chromeId):null};gadgets.FloatLeftLayoutManager=function(layoutRootId){gadgets.LayoutManager.call(this);this.layoutRootId_=layoutRootId};gadgets.FloatLeftLayoutManager.inherits(gadgets.LayoutManager);gadgets.FloatLeftLayoutManager.prototype.getGadgetChrome=function(gadget){var layoutRoot=document.getElementById(this.layoutRootId_);if(layoutRoot){var chrome=document.createElement("div");chrome.className="gadgets-gadget-chrome";chrome.style.cssFloat="left";layoutRoot.appendChild(chrome);return chrome}else{return null}};
/* module-key = 'com.atlassian.gadgets.embedded:gadget-container-resources', location = 'js/gadgets-container.js' */
gadgets.Container=function(){this.parentUrl_="http://"+document.location.host;this.country_="ALL";this.language_="ALL";this.view_="default";this.nocache_=1;this.maxheight_=2147483647};gadgets.Container.inherits(gadgets.Extensible);gadgets.Container.prototype.userPrefStore=new gadgets.DefaultUserPrefStore();gadgets.Container.prototype.gadgetService=new gadgets.GadgetService();gadgets.Container.prototype.layoutManager=new gadgets.StaticLayoutManager();gadgets.Container.prototype.setParentUrl=function(url){this.parentUrl_=url};gadgets.Container.prototype.setCountry=function(country){this.country_=country};gadgets.Container.prototype.setNoCache=function(nocache){this.nocache_=nocache};gadgets.Container.prototype.setLanguage=function(language){this.language_=language};gadgets.Container.prototype.setView=function(view){this.view_=view};gadgets.Container.prototype.setMaxHeight=function(maxheight){this.maxheight_=maxheight};gadgets.Container.prototype.getGadgetKey_=function(instanceId){return"gadget_"+instanceId};gadgets.IfrContainer=function(){gadgets.Container.call(this)};gadgets.IfrContainer.inherits(gadgets.Container);gadgets.IfrContainer.prototype.gadgetService=new gadgets.IfrGadgetService();gadgets.IfrContainer.prototype.setParentUrl=function(url){if(!url.match(/^http[s]?:\/\//)){url=document.location.href.match(/^[^?#]+\//)[0]+url}this.parentUrl_=url};gadgets.container=new gadgets.IfrContainer();
/* module-key = 'com.atlassian.gadgets.embedded:gadget-standalone-resources', location = 'js/gadgets-standalone.js' */
new gadgets.IfrGadgetService();gadgets.IfrGadgetService.prototype.setTitle=function(title){};
/* module-key = 'jira.webresources:jquery-easing', location = '/includes/jquery/plugins/easing/jquery.easing.1.3.js' */
jQuery.easing["jswing"]=jQuery.easing["swing"];jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(x,t,b,c,d){return jQuery.easing[jQuery.easing.def](x,t,b,c,d)},easeInQuad:function(x,t,b,c,d){return c*(t/=d)*t+b},easeOutQuad:function(x,t,b,c,d){return -c*(t/=d)*(t-2)+b},easeInOutQuad:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t+b}return -c/2*((--t)*(t-2)-1)+b},easeInCubic:function(x,t,b,c,d){return c*(t/=d)*t*t+b},easeOutCubic:function(x,t,b,c,d){return c*((t=t/d-1)*t*t+1)+b},easeInOutCubic:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t*t+b}return c/2*((t-=2)*t*t+2)+b},easeInQuart:function(x,t,b,c,d){return c*(t/=d)*t*t*t+b},easeOutQuart:function(x,t,b,c,d){return -c*((t=t/d-1)*t*t*t-1)+b},easeInOutQuart:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t*t*t+b}return -c/2*((t-=2)*t*t*t-2)+b},easeInQuint:function(x,t,b,c,d){return c*(t/=d)*t*t*t*t+b},easeOutQuint:function(x,t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b},easeInOutQuint:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t*t*t*t+b}return c/2*((t-=2)*t*t*t*t+2)+b},easeInSine:function(x,t,b,c,d){return -c*Math.cos(t/d*(Math.PI/2))+c+b},easeOutSine:function(x,t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b},easeInOutSine:function(x,t,b,c,d){return -c/2*(Math.cos(Math.PI*t/d)-1)+b},easeInExpo:function(x,t,b,c,d){return(t==0)?b:c*Math.pow(2,10*(t/d-1))+b},easeOutExpo:function(x,t,b,c,d){return(t==d)?b+c:c*(-Math.pow(2,-10*t/d)+1)+b},easeInOutExpo:function(x,t,b,c,d){if(t==0){return b}if(t==d){return b+c}if((t/=d/2)<1){return c/2*Math.pow(2,10*(t-1))+b}return c/2*(-Math.pow(2,-10*--t)+2)+b},easeInCirc:function(x,t,b,c,d){return -c*(Math.sqrt(1-(t/=d)*t)-1)+b},easeOutCirc:function(x,t,b,c,d){return c*Math.sqrt(1-(t=t/d-1)*t)+b},easeInOutCirc:function(x,t,b,c,d){if((t/=d/2)<1){return -c/2*(Math.sqrt(1-t*t)-1)+b}return c/2*(Math.sqrt(1-(t-=2)*t)+1)+b},easeInElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0){return b}if((t/=d)==1){return b+c}if(!p){p=d*0.3}if(a<Math.abs(c)){a=c;var s=p/4}else{var s=p/(2*Math.PI)*Math.asin(c/a)}return -(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b},easeOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0){return b}if((t/=d)==1){return b+c}if(!p){p=d*0.3}if(a<Math.abs(c)){a=c;var s=p/4}else{var s=p/(2*Math.PI)*Math.asin(c/a)}return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b},easeInOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0){return b}if((t/=d/2)==2){return b+c}if(!p){p=d*(0.3*1.5)}if(a<Math.abs(c)){a=c;var s=p/4}else{var s=p/(2*Math.PI)*Math.asin(c/a)}if(t<1){return -0.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b}return a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*0.5+c+b},easeInBack:function(x,t,b,c,d,s){if(s==undefined){s=1.70158}return c*(t/=d)*t*((s+1)*t-s)+b},easeOutBack:function(x,t,b,c,d,s){if(s==undefined){s=1.70158}return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},easeInOutBack:function(x,t,b,c,d,s){if(s==undefined){s=1.70158}if((t/=d/2)<1){return c/2*(t*t*(((s*=(1.525))+1)*t-s))+b}return c/2*((t-=2)*t*(((s*=(1.525))+1)*t+s)+2)+b},easeInBounce:function(x,t,b,c,d){return c-jQuery.easing.easeOutBounce(x,d-t,0,c,d)+b},easeOutBounce:function(x,t,b,c,d){if((t/=d)<(1/2.75)){return c*(7.5625*t*t)+b}else{if(t<(2/2.75)){return c*(7.5625*(t-=(1.5/2.75))*t+0.75)+b}else{if(t<(2.5/2.75)){return c*(7.5625*(t-=(2.25/2.75))*t+0.9375)+b}else{return c*(7.5625*(t-=(2.625/2.75))*t+0.984375)+b}}}},easeInOutBounce:function(x,t,b,c,d){if(t<d/2){return jQuery.easing.easeInBounce(x,t*2,0,c,d)*0.5+b}return jQuery.easing.easeOutBounce(x,t*2-d,0,c,d)*0.5+c*0.5+b}});
/* module-key = 'jira.webresources:jquery-fancybox', location = '/includes/jquery/plugins/fancybox/jquery.fancybox-1.3.4.js' */
(function($){var tmp,loading,overlay,wrap,outer,content,close,title,nav_left,nav_right,selectedIndex=0,selectedOpts={},selectedArray=[],currentIndex=0,currentOpts={},currentArray=[],ajaxLoader=null,imgPreloader=new Image(),imgRegExp=/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i,swfRegExp=/[^\.]\.(swf)\s*$/i,loadingTimer,loadingFrame=1,titleHeight=0,titleStr="",start_pos,final_pos,busy=false,fx=$.extend($("<div/>")[0],{prop:0}),isIE6=$.browser.msie&&$.browser.version<7&&!window.XMLHttpRequest,_abort=function(){loading.hide();imgPreloader.onerror=imgPreloader.onload=null;if(ajaxLoader){ajaxLoader.abort()}tmp.empty()},_error=function(){if(false===selectedOpts.onError(selectedArray,selectedIndex,selectedOpts)){loading.hide();busy=false;return }selectedOpts.titleShow=false;selectedOpts.width="auto";selectedOpts.height="auto";tmp.html('<p id="fancybox-error">The requested content cannot be loaded.<br />Please try again later.</p>');_process_inline()},_start=function(){var obj=selectedArray[selectedIndex],href,type,title,str,emb,ret;_abort();selectedOpts=$.extend({},$.fn.fancybox.defaults,(typeof $(obj).data("fancybox")=="undefined"?selectedOpts:$(obj).data("fancybox")));ret=selectedOpts.onStart(selectedArray,selectedIndex,selectedOpts);if(ret===false){busy=false;return }else{if(typeof ret=="object"){selectedOpts=$.extend(selectedOpts,ret)}}title=selectedOpts.title||(obj.nodeName?$(obj).attr("title"):obj.title)||"";if(obj.nodeName&&!selectedOpts.orig){selectedOpts.orig=$(obj).children("img:first").length?$(obj).children("img:first"):$(obj)}if(title===""&&selectedOpts.orig&&selectedOpts.titleFromAlt){title=selectedOpts.orig.attr("alt")}href=selectedOpts.href||(obj.nodeName?$(obj).attr("href"):obj.href)||null;if((/^(?:javascript)/i).test(href)||href=="#"){href=null}if(selectedOpts.type){type=selectedOpts.type;if(!href){href=selectedOpts.content}}else{if(selectedOpts.content){type="html"}else{if(href){if(href.match(imgRegExp)){type="image"}else{if(href.match(swfRegExp)){type="swf"}else{if($(obj).hasClass("iframe")){type="iframe"}else{if(href.indexOf("#")===0){type="inline"}else{type="ajax"}}}}}}}if(!type){_error();return }if(type=="inline"){obj=href.substr(href.indexOf("#"));type=$(obj).length>0?"inline":"ajax"}selectedOpts.type=type;selectedOpts.href=href;selectedOpts.title=title;if(selectedOpts.autoDimensions){if(selectedOpts.type=="html"||selectedOpts.type=="inline"||selectedOpts.type=="ajax"){selectedOpts.width="auto";selectedOpts.height="auto"}else{selectedOpts.autoDimensions=false}}if(selectedOpts.modal){selectedOpts.overlayShow=true;selectedOpts.hideOnOverlayClick=false;selectedOpts.hideOnContentClick=false;selectedOpts.enableEscapeButton=false;selectedOpts.showCloseButton=false}selectedOpts.padding=parseInt(selectedOpts.padding,10);selectedOpts.margin=parseInt(selectedOpts.margin,10);tmp.css("padding",(selectedOpts.padding+selectedOpts.margin));$(".fancybox-inline-tmp").unbind("fancybox-cancel").bind("fancybox-change",function(){$(this).replaceWith(content.children())});switch(type){case"html":tmp.html(selectedOpts.content);_process_inline();break;case"inline":if($(obj).parent().is("#fancybox-content")===true){busy=false;return }$('<div class="fancybox-inline-tmp" />').hide().insertBefore($(obj)).bind("fancybox-cleanup",function(){$(this).replaceWith(content.children())}).bind("fancybox-cancel",function(){$(this).replaceWith(tmp.children())});$(obj).appendTo(tmp);_process_inline();break;case"image":busy=false;$.fancybox.showActivity();imgPreloader=new Image();imgPreloader.onerror=function(){_error()};imgPreloader.onload=function(){busy=true;imgPreloader.onerror=imgPreloader.onload=null;_process_image()};imgPreloader.src=href;break;case"swf":selectedOpts.scrolling="no";str='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+selectedOpts.width+'" height="'+selectedOpts.height+'"><param name="movie" value="'+href+'"></param>';emb="";$.each(selectedOpts.swf,function(name,val){str+='<param name="'+name+'" value="'+val+'"></param>';emb+=" "+name+'="'+val+'"'});str+='<embed src="'+href+'" type="application/x-shockwave-flash" width="'+selectedOpts.width+'" height="'+selectedOpts.height+'"'+emb+"></embed></object>";tmp.html(str);_process_inline();break;case"ajax":busy=false;$.fancybox.showActivity();selectedOpts.ajax.win=selectedOpts.ajax.success;ajaxLoader=$.ajax($.extend({},selectedOpts.ajax,{url:href,data:selectedOpts.ajax.data||{},error:function(XMLHttpRequest,textStatus,errorThrown){if(XMLHttpRequest.status>0){_error()}},success:function(data,textStatus,XMLHttpRequest){var o=typeof XMLHttpRequest=="object"?XMLHttpRequest:ajaxLoader;if(o.status==200){if(typeof selectedOpts.ajax.win=="function"){ret=selectedOpts.ajax.win(href,data,textStatus,XMLHttpRequest);if(ret===false){loading.hide();return }else{if(typeof ret=="string"||typeof ret=="object"){data=ret}}}tmp.html(data);_process_inline()}}}));break;case"iframe":_show();break}},_process_inline=function(){var w=selectedOpts.width,h=selectedOpts.height;if(w.toString().indexOf("%")>-1){w=parseInt(($(window).width()-(selectedOpts.margin*2))*parseFloat(w)/100,10)+"px"}else{w=w=="auto"?"auto":w+"px"}if(h.toString().indexOf("%")>-1){h=parseInt(($(window).height()-(selectedOpts.margin*2))*parseFloat(h)/100,10)+"px"}else{h=h=="auto"?"auto":h+"px"}tmp.wrapInner('<div style="width:'+w+";height:"+h+";overflow: "+(selectedOpts.scrolling=="auto"?"auto":(selectedOpts.scrolling=="yes"?"scroll":"hidden"))+';position:relative;"></div>');selectedOpts.width=tmp.width();selectedOpts.height=tmp.height();_show()},_process_image=function(){selectedOpts.width=imgPreloader.width;selectedOpts.height=imgPreloader.height;$("<img />").attr({"id":"fancybox-img","src":imgPreloader.src,"alt":selectedOpts.title}).appendTo(tmp);_show()},_show=function(){var pos,equal;loading.hide();if(wrap.is(":visible")&&false===currentOpts.onCleanup(currentArray,currentIndex,currentOpts)){$.event.trigger("fancybox-cancel");busy=false;return }busy=true;$(content.add(overlay)).unbind();$(window).unbind("resize.fb scroll.fb");$(document).unbind("keydown.fb");if(wrap.is(":visible")&&currentOpts.titlePosition!=="outside"){wrap.css("height",wrap.height())}currentArray=selectedArray;currentIndex=selectedIndex;currentOpts=selectedOpts;if(currentOpts.overlayShow){overlay.css({"background-color":currentOpts.overlayColor,"opacity":currentOpts.overlayOpacity,"cursor":currentOpts.hideOnOverlayClick?"pointer":"auto","height":$(document).height()});if(!overlay.is(":visible")){if(isIE6){$("select:not(#fancybox-tmp select)").filter(function(){return this.style.visibility!=="hidden"}).css({"visibility":"hidden"}).one("fancybox-cleanup",function(){this.style.visibility="inherit"})}overlay.show()}}else{overlay.hide()}final_pos=_get_zoom_to();_process_title();if(wrap.is(":visible")){$(close.add(nav_left).add(nav_right)).hide();pos=wrap.position(),start_pos={top:pos.top,left:pos.left,width:wrap.width(),height:wrap.height()};equal=(start_pos.width==final_pos.width&&start_pos.height==final_pos.height);content.fadeTo(currentOpts.changeFade,0.3,function(){var finish_resizing=function(){content.html(tmp.contents()).fadeTo(currentOpts.changeFade,1,_finish)};$.event.trigger("fancybox-change");content.empty().removeAttr("filter").css({"border-width":currentOpts.padding,"width":final_pos.width-currentOpts.padding*2,"height":selectedOpts.autoDimensions?"auto":final_pos.height-titleHeight-currentOpts.padding*2});if(equal){finish_resizing()}else{fx.prop=0;$(fx).animate({prop:1},{duration:currentOpts.changeSpeed,easing:currentOpts.easingChange,step:_draw,complete:finish_resizing})}});return }wrap.removeAttr("style");content.css("border-width",currentOpts.padding);if(currentOpts.transitionIn=="elastic"){start_pos=_get_zoom_from();content.html(tmp.contents());wrap.show();if(currentOpts.opacity){final_pos.opacity=0}fx.prop=0;$(fx).animate({prop:1},{duration:currentOpts.speedIn,easing:currentOpts.easingIn,step:_draw,complete:_finish});return }if(currentOpts.titlePosition=="inside"&&titleHeight>0){title.show()}content.css({"width":final_pos.width-currentOpts.padding*2,"height":selectedOpts.autoDimensions?"auto":final_pos.height-titleHeight-currentOpts.padding*2}).html(tmp.contents());wrap.css(final_pos).fadeIn(currentOpts.transitionIn=="none"?0:currentOpts.speedIn,_finish)},_format_title=function(title){if(title&&title.length){if(currentOpts.titlePosition=="float"){return'<table id="fancybox-title-float-wrap" cellpadding="0" cellspacing="0"><tr><td id="fancybox-title-float-left"></td><td id="fancybox-title-float-main">'+title+'</td><td id="fancybox-title-float-right"></td></tr></table>'}return'<div id="fancybox-title-'+currentOpts.titlePosition+'">'+title+"</div>"}return false},_process_title=function(){titleStr=currentOpts.title||"";titleHeight=0;title.empty().removeAttr("style").removeClass();if(currentOpts.titleShow===false){title.hide();return }titleStr=$.isFunction(currentOpts.titleFormat)?currentOpts.titleFormat(titleStr,currentArray,currentIndex,currentOpts):_format_title(titleStr);if(!titleStr||titleStr===""){title.hide();return }title.addClass("fancybox-title-"+currentOpts.titlePosition).html(titleStr).appendTo("body").show();switch(currentOpts.titlePosition){case"inside":title.css({"width":final_pos.width-(currentOpts.padding*2),"marginLeft":currentOpts.padding,"marginRight":currentOpts.padding});titleHeight=title.outerHeight(true);title.appendTo(outer);final_pos.height+=titleHeight;break;case"over":title.css({"marginLeft":currentOpts.padding,"width":final_pos.width-(currentOpts.padding*2),"bottom":currentOpts.padding}).appendTo(outer);break;case"float":title.css("left",parseInt((title.width()-final_pos.width-40)/2,10)*-1).appendTo(wrap);break;default:title.css({"width":final_pos.width-(currentOpts.padding*2),"paddingLeft":currentOpts.padding,"paddingRight":currentOpts.padding}).appendTo(wrap);break}title.hide()},_set_navigation=function(){if(currentOpts.enableEscapeButton||currentOpts.enableKeyboardNav){$(document).bind("keydown.fb",function(e){if(e.keyCode==27&&currentOpts.enableEscapeButton){e.preventDefault();$.fancybox.close()}else{if((e.keyCode==37||e.keyCode==39)&&currentOpts.enableKeyboardNav&&e.target.tagName!=="INPUT"&&e.target.tagName!=="TEXTAREA"&&e.target.tagName!=="SELECT"){e.preventDefault();$.fancybox[e.keyCode==37?"prev":"next"]()}}})}if(!currentOpts.showNavArrows){nav_left.hide();nav_right.hide();return }if((currentOpts.cyclic&&currentArray.length>1)||currentIndex!==0){nav_left.show()}if((currentOpts.cyclic&&currentArray.length>1)||currentIndex!=(currentArray.length-1)){nav_right.show()}},_finish=function(){if(!$.support.opacity){content.get(0).style.removeAttribute("filter");wrap.get(0).style.removeAttribute("filter")}if(selectedOpts.autoDimensions){content.css("height","auto")}wrap.css("height","auto");if(titleStr&&titleStr.length){title.show()}if(currentOpts.showCloseButton){close.show()}_set_navigation();if(currentOpts.hideOnContentClick){content.bind("click",$.fancybox.close)}if(currentOpts.hideOnOverlayClick){overlay.bind("click",$.fancybox.close)}$(window).bind("resize.fb",$.fancybox.resize);if(currentOpts.centerOnScroll){$(window).bind("scroll.fb",$.fancybox.center)}if(currentOpts.type=="iframe"){$('<iframe id="fancybox-frame" name="fancybox-frame'+new Date().getTime()+'" frameborder="0" hspace="0" '+($.browser.msie?'allowtransparency="true""':"")+' scrolling="'+selectedOpts.scrolling+'" src="'+currentOpts.href+'"></iframe>').appendTo(content)}wrap.show();busy=false;$.fancybox.center();currentOpts.onComplete(currentArray,currentIndex,currentOpts);_preload_images()},_preload_images=function(){var href,objNext;if((currentArray.length-1)>currentIndex){href=currentArray[currentIndex+1].href;if(typeof href!=="undefined"&&href.match(imgRegExp)){objNext=new Image();objNext.src=href}}if(currentIndex>0){href=currentArray[currentIndex-1].href;if(typeof href!=="undefined"&&href.match(imgRegExp)){objNext=new Image();objNext.src=href}}},_draw=function(pos){var dim={width:parseInt(start_pos.width+(final_pos.width-start_pos.width)*pos,10),height:parseInt(start_pos.height+(final_pos.height-start_pos.height)*pos,10),top:parseInt(start_pos.top+(final_pos.top-start_pos.top)*pos,10),left:parseInt(start_pos.left+(final_pos.left-start_pos.left)*pos,10)};if(typeof final_pos.opacity!=="undefined"){dim.opacity=pos<0.5?0.5:pos}wrap.css(dim);content.css({"width":dim.width-currentOpts.padding*2,"height":dim.height-(titleHeight*pos)-currentOpts.padding*2})},_get_viewport=function(){return[$(window).width()-(currentOpts.margin*2),$(window).height()-(currentOpts.margin*2),$(document).scrollLeft()+currentOpts.margin,$(document).scrollTop()+currentOpts.margin]},_get_zoom_to=function(){var view=_get_viewport(),to={},resize=currentOpts.autoScale,double_padding=currentOpts.padding*2,ratio;if(currentOpts.width.toString().indexOf("%")>-1){to.width=parseInt((view[0]*parseFloat(currentOpts.width))/100,10)}else{to.width=currentOpts.width+double_padding}if(currentOpts.height.toString().indexOf("%")>-1){to.height=parseInt((view[1]*parseFloat(currentOpts.height))/100,10)}else{to.height=currentOpts.height+double_padding}if(resize&&(to.width>view[0]||to.height>view[1])){if(selectedOpts.type=="image"||selectedOpts.type=="swf"){ratio=(currentOpts.width)/(currentOpts.height);if((to.width)>view[0]){to.width=view[0];to.height=parseInt(((to.width-double_padding)/ratio)+double_padding,10)}if((to.height)>view[1]){to.height=view[1];to.width=parseInt(((to.height-double_padding)*ratio)+double_padding,10)}}else{to.width=Math.min(to.width,view[0]);to.height=Math.min(to.height,view[1])}}to.top=parseInt(Math.max(view[3]-20,view[3]+((view[1]-to.height-40)*0.5)),10);to.left=parseInt(Math.max(view[2]-20,view[2]+((view[0]-to.width-40)*0.5)),10);return to},_get_obj_pos=function(obj){var pos=obj.offset();pos.top+=parseInt(obj.css("paddingTop"),10)||0;pos.left+=parseInt(obj.css("paddingLeft"),10)||0;pos.top+=parseInt(obj.css("border-top-width"),10)||0;pos.left+=parseInt(obj.css("border-left-width"),10)||0;pos.width=obj.width();pos.height=obj.height();return pos},_get_zoom_from=function(){var orig=selectedOpts.orig?$(selectedOpts.orig):false,from={},pos,view;if(orig&&orig.length){pos=_get_obj_pos(orig);from={width:pos.width+(currentOpts.padding*2),height:pos.height+(currentOpts.padding*2),top:pos.top-currentOpts.padding-20,left:pos.left-currentOpts.padding-20}}else{view=_get_viewport();from={width:currentOpts.padding*2,height:currentOpts.padding*2,top:parseInt(view[3]+view[1]*0.5,10),left:parseInt(view[2]+view[0]*0.5,10)}}return from},_animate_loading=function(){if(!loading.is(":visible")){clearInterval(loadingTimer);return }$("div",loading).css("top",(loadingFrame*-40)+"px");loadingFrame=(loadingFrame+1)%12};$.fn.fancybox=function(options){if(!$(this).length){return this}$(this).data("fancybox",$.extend({},options,($.metadata?$(this).metadata():{}))).unbind("click.fb").bind("click.fb",function(e){e.preventDefault();if(busy){return }busy=true;$(this).blur();selectedArray=[];selectedIndex=0;var rel=$(this).attr("rel")||"";if(!rel||rel==""||rel==="nofollow"){selectedArray.push(this)}else{selectedArray=$("a[rel="+rel+"], area[rel="+rel+"]");selectedIndex=selectedArray.index(this)}_start();return });return this};$.fancybox=function(obj){var opts;if(busy){return }busy=true;opts=typeof arguments[1]!=="undefined"?arguments[1]:{};selectedArray=[];selectedIndex=parseInt(opts.index,10)||0;if($.isArray(obj)){for(var i=0,j=obj.length;i<j;i++){if(typeof obj[i]=="object"){$(obj[i]).data("fancybox",$.extend({},opts,obj[i]))}else{obj[i]=$({}).data("fancybox",$.extend({content:obj[i]},opts))}}selectedArray=jQuery.merge(selectedArray,obj)}else{if(typeof obj=="object"){$(obj).data("fancybox",$.extend({},opts,obj))}else{obj=$({}).data("fancybox",$.extend({content:obj},opts))}selectedArray.push(obj)}if(selectedIndex>selectedArray.length||selectedIndex<0){selectedIndex=0}_start()};$.fancybox.showActivity=function(){clearInterval(loadingTimer);loading.show();loadingTimer=setInterval(_animate_loading,66)};$.fancybox.hideActivity=function(){loading.hide()};$.fancybox.next=function(){return $.fancybox.pos(currentIndex+1)};$.fancybox.prev=function(){return $.fancybox.pos(currentIndex-1)};$.fancybox.pos=function(pos){if(busy){return }pos=parseInt(pos);selectedArray=currentArray;if(pos>-1&&pos<currentArray.length){selectedIndex=pos;_start()}else{if(currentOpts.cyclic&&currentArray.length>1){selectedIndex=pos>=currentArray.length?0:currentArray.length-1;_start()}}return };$.fancybox.cancel=function(){if(busy){return }busy=true;$.event.trigger("fancybox-cancel");_abort();selectedOpts.onCancel(selectedArray,selectedIndex,selectedOpts);busy=false};$.fancybox.close=function(){if(busy||wrap.is(":hidden")){return }busy=true;if(currentOpts&&false===currentOpts.onCleanup(currentArray,currentIndex,currentOpts)){busy=false;return }_abort();$(close.add(nav_left).add(nav_right)).hide();$(content.add(overlay)).unbind();$(window).unbind("resize.fb scroll.fb");$(document).unbind("keydown.fb");content.find("iframe").attr("src",isIE6&&/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank");if(currentOpts.titlePosition!=="inside"){title.empty()}wrap.stop();function _cleanup(){overlay.fadeOut("fast");title.empty().hide();wrap.hide();$.event.trigger("fancybox-cleanup");content.empty();currentOpts.onClosed(currentArray,currentIndex,currentOpts);currentArray=selectedOpts=[];currentIndex=selectedIndex=0;currentOpts=selectedOpts={};busy=false}if(currentOpts.transitionOut=="elastic"){start_pos=_get_zoom_from();var pos=wrap.position();final_pos={top:pos.top,left:pos.left,width:wrap.width(),height:wrap.height()};if(currentOpts.opacity){final_pos.opacity=1}title.empty().hide();fx.prop=1;$(fx).animate({prop:0},{duration:currentOpts.speedOut,easing:currentOpts.easingOut,step:_draw,complete:_cleanup})}else{wrap.fadeOut(currentOpts.transitionOut=="none"?0:currentOpts.speedOut,_cleanup)}};$.fancybox.resize=function(){if(overlay.is(":visible")){overlay.css("height",$(document).height())}$.fancybox.center(true)};$.fancybox.center=function(){var view,align;if(busy){return }align=arguments[0]===true?1:0;view=_get_viewport();if(!align&&(wrap.width()>view[0]||wrap.height()>view[1])){return }wrap.stop().animate({"top":parseInt(Math.max(view[3]-20,view[3]+((view[1]-content.height()-40)*0.5)-currentOpts.padding)),"left":parseInt(Math.max(view[2]-20,view[2]+((view[0]-content.width()-40)*0.5)-currentOpts.padding))},typeof arguments[0]=="number"?arguments[0]:200)};$.fancybox.init=function(){if($("#fancybox-wrap").length){return }$("body").append(tmp=$('<div id="fancybox-tmp"></div>'),loading=$('<div id="fancybox-loading"><div></div></div>'),overlay=$('<div id="fancybox-overlay"></div>'),wrap=$('<div id="fancybox-wrap"></div>'));outer=$('<div id="fancybox-outer"></div>').append('<div class="fancybox-bg" id="fancybox-bg-n"></div><div class="fancybox-bg" id="fancybox-bg-ne"></div><div class="fancybox-bg" id="fancybox-bg-e"></div><div class="fancybox-bg" id="fancybox-bg-se"></div><div class="fancybox-bg" id="fancybox-bg-s"></div><div class="fancybox-bg" id="fancybox-bg-sw"></div><div class="fancybox-bg" id="fancybox-bg-w"></div><div class="fancybox-bg" id="fancybox-bg-nw"></div>').appendTo(wrap);outer.append(content=$('<div id="fancybox-content"></div>'),close=$('<a id="fancybox-close"></a>'),title=$('<div id="fancybox-title"></div>'),nav_left=$('<a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a>'),nav_right=$('<a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a>'));close.click($.fancybox.close);loading.click($.fancybox.cancel);nav_left.click(function(e){e.preventDefault();$.fancybox.prev()});nav_right.click(function(e){e.preventDefault();$.fancybox.next()});if($.fn.mousewheel){wrap.bind("mousewheel.fb",function(e,delta){if(busy){e.preventDefault()}else{if($(e.target).get(0).clientHeight==0||$(e.target).get(0).scrollHeight===$(e.target).get(0).clientHeight){e.preventDefault();$.fancybox[delta>0?"prev":"next"]()}}})}if(!$.support.opacity){wrap.addClass("fancybox-ie")}if(isIE6){loading.addClass("fancybox-ie6");wrap.addClass("fancybox-ie6");$('<iframe id="fancybox-hide-sel-frame" src="'+(/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank")+'" scrolling="no" border="0" frameborder="0" tabindex="-1"></iframe>').prependTo(outer)}};$.fn.fancybox.defaults={padding:10,margin:40,opacity:false,modal:false,cyclic:false,scrolling:"auto",width:560,height:340,autoScale:true,autoDimensions:true,centerOnScroll:false,ajax:{},swf:{wmode:"transparent"},hideOnOverlayClick:true,hideOnContentClick:false,overlayShow:true,overlayOpacity:0.7,overlayColor:"#777",titleShow:true,titlePosition:"float",titleFormat:null,titleFromAlt:false,transitionIn:"fade",transitionOut:"fade",speedIn:300,speedOut:300,changeSpeed:300,changeFade:"fast",easingIn:"swing",easingOut:"swing",showCloseButton:true,showNavArrows:true,enableEscapeButton:true,enableKeyboardNav:true,onStart:function(){},onCancel:function(){},onComplete:function(){},onCleanup:function(){},onClosed:function(){},onError:function(){}};$(document).ready(function(){$.fancybox.init()})})(jQuery);
/* module-key = 'jira.webresources:jquery-fancybox', location = '/includes/jquery/plugins/fancybox/jquery.fancybox.jira.js' */
AJS.$.fn.fancybox.defaults.titleFormat=function(title){if(title&&title.length){title=AJS.escapeHtml(title);if(this.titlePosition=="float"){return'<table id="fancybox-title-float-wrap" cellpadding="0" cellspacing="0"><tr><td id="fancybox-title-float-left"></td><td id="fancybox-title-float-main">'+title+'</td><td id="fancybox-title-float-right"></td></tr></table>'}return'<div id="fancybox-title-'+this.titlePosition+'">'+title+"</div>"}};
/* module-key = 'jira.webresources:jquery-livestamp', location = '/includes/jquery/plugins/livestamp/moment.js' */
(function(undefined){var moment,VERSION="2.1.0",round=Math.round,i,languages={},hasModule=(typeof module!=="undefined"&&module.exports),aspNetJsonRegex=/^\/?Date\((\-?\d+)/i,aspNetTimeSpanJsonRegex=/(\-)?(\d*)?\.?(\d+)\:(\d+)\:(\d+)\.?(\d{3})?/,formattingTokens=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|SS?S?|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,parseTokenOneOrTwoDigits=/\d\d?/,parseTokenOneToThreeDigits=/\d{1,3}/,parseTokenThreeDigits=/\d{3}/,parseTokenFourDigits=/\d{1,4}/,parseTokenSixDigits=/[+\-]?\d{1,6}/,parseTokenWord=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,parseTokenTimezone=/Z|[\+\-]\d\d:?\d\d/i,parseTokenT=/T/i,parseTokenTimestampMs=/[\+\-]?\d+(\.\d{1,3})?/,isoRegex=/^\s*\d{4}-\d\d-\d\d((T| )(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,isoFormat="YYYY-MM-DDTHH:mm:ssZ",isoTimes=[["HH:mm:ss.S",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],parseTimezoneChunker=/([\+\-]|\d\d)/gi,proxyGettersAndSetters="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),unitMillisecondFactors={"Milliseconds":1,"Seconds":1000,"Minutes":60000,"Hours":3600000,"Days":86400000,"Months":2592000000,"Years":31536000000},unitAliases={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",w:"week",M:"month",y:"year"},formatFunctions={},ordinalizeTokens="DDD w W M D d".split(" "),paddedTokens="M D H h m s w W".split(" "),formatTokenFunctions={M:function(){return this.month()+1},MMM:function(format){return this.lang().monthsShort(this,format)},MMMM:function(format){return this.lang().months(this,format)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(format){return this.lang().weekdaysMin(this,format)},ddd:function(format){return this.lang().weekdaysShort(this,format)},dddd:function(format){return this.lang().weekdays(this,format)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return leftZeroFill(this.year()%100,2)},YYYY:function(){return leftZeroFill(this.year(),4)},YYYYY:function(){return leftZeroFill(this.year(),5)},gg:function(){return leftZeroFill(this.weekYear()%100,2)},gggg:function(){return this.weekYear()},ggggg:function(){return leftZeroFill(this.weekYear(),5)},GG:function(){return leftZeroFill(this.isoWeekYear()%100,2)},GGGG:function(){return this.isoWeekYear()},GGGGG:function(){return leftZeroFill(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),true)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),false)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return ~~(this.milliseconds()/100)},SS:function(){return leftZeroFill(~~(this.milliseconds()/10),2)},SSS:function(){return leftZeroFill(this.milliseconds(),3)},Z:function(){var a=-this.zone(),b="+";if(a<0){a=-a;b="-"}return b+leftZeroFill(~~(a/60),2)+":"+leftZeroFill(~~a%60,2)},ZZ:function(){var a=-this.zone(),b="+";if(a<0){a=-a;b="-"}return b+leftZeroFill(~~(10*a/6),4)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()}};function padToken(func,count){return function(a){return leftZeroFill(func.call(this,a),count)}}function ordinalizeToken(func,period){return function(a){return this.lang().ordinal(func.call(this,a),period)}}while(ordinalizeTokens.length){i=ordinalizeTokens.pop();formatTokenFunctions[i+"o"]=ordinalizeToken(formatTokenFunctions[i],i)}while(paddedTokens.length){i=paddedTokens.pop();formatTokenFunctions[i+i]=padToken(formatTokenFunctions[i],2)}formatTokenFunctions.DDDD=padToken(formatTokenFunctions.DDD,3);function Language(){}function Moment(config){extend(this,config)}function Duration(duration){var years=duration.years||duration.year||duration.y||0,months=duration.months||duration.month||duration.M||0,weeks=duration.weeks||duration.week||duration.w||0,days=duration.days||duration.day||duration.d||0,hours=duration.hours||duration.hour||duration.h||0,minutes=duration.minutes||duration.minute||duration.m||0,seconds=duration.seconds||duration.second||duration.s||0,milliseconds=duration.milliseconds||duration.millisecond||duration.ms||0;this._input=duration;this._milliseconds=milliseconds+seconds*1000+minutes*60000+hours*3600000;this._days=days+weeks*7;this._months=months+years*12;this._data={};this._bubble()}function extend(a,b){for(var i in b){if(b.hasOwnProperty(i)){a[i]=b[i]}}return a}function absRound(number){if(number<0){return Math.ceil(number)}else{return Math.floor(number)}}function leftZeroFill(number,targetLength){var output=number+"";while(output.length<targetLength){output="0"+output}return output}function addOrSubtractDurationFromMoment(mom,duration,isAdding,ignoreUpdateOffset){var milliseconds=duration._milliseconds,days=duration._days,months=duration._months,minutes,hours,currentDate;if(milliseconds){mom._d.setTime(+mom._d+milliseconds*isAdding)}if(days||months){minutes=mom.minute();hours=mom.hour()}if(days){mom.date(mom.date()+days*isAdding)}if(months){mom.month(mom.month()+months*isAdding)}if(milliseconds&&!ignoreUpdateOffset){moment.updateOffset(mom)}if(days||months){mom.minute(minutes);mom.hour(hours)}}function isArray(input){return Object.prototype.toString.call(input)==="[object Array]"}function compareArrays(array1,array2){var len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0,i;for(i=0;i<len;i++){if(~~array1[i]!==~~array2[i]){diffs++}}return diffs+lengthDiff}function normalizeUnits(units){return units?unitAliases[units]||units.toLowerCase().replace(/(.)s$/,"$1"):units}Language.prototype={set:function(config){var prop,i;for(i in config){prop=config[i];if(typeof prop==="function"){this[i]=prop}else{this["_"+i]=prop}}},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(m){return this._months[m.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(m){return this._monthsShort[m.month()]},monthsParse:function(monthName){var i,mom,regex;if(!this._monthsParse){this._monthsParse=[]}for(i=0;i<12;i++){if(!this._monthsParse[i]){mom=moment([2000,i]);regex="^"+this.months(mom,"")+"|^"+this.monthsShort(mom,"");this._monthsParse[i]=new RegExp(regex.replace(".",""),"i")}if(this._monthsParse[i].test(monthName)){return i}}},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(m){return this._weekdays[m.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(m){return this._weekdaysShort[m.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(m){return this._weekdaysMin[m.day()]},weekdaysParse:function(weekdayName){var i,mom,regex;if(!this._weekdaysParse){this._weekdaysParse=[]}for(i=0;i<7;i++){if(!this._weekdaysParse[i]){mom=moment([2000,1]).day(i);regex="^"+this.weekdays(mom,"")+"|^"+this.weekdaysShort(mom,"")+"|^"+this.weekdaysMin(mom,"");this._weekdaysParse[i]=new RegExp(regex.replace(".",""),"i")}if(this._weekdaysParse[i].test(weekdayName)){return i}}},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(key){var output=this._longDateFormat[key];if(!output&&this._longDateFormat[key.toUpperCase()]){output=this._longDateFormat[key.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(val){return val.slice(1)});this._longDateFormat[key]=output}return output},isPM:function(input){return((input+"").toLowerCase()[0]==="p")},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(hours,minutes,isLower){if(hours>11){return isLower?"pm":"PM"}else{return isLower?"am":"AM"}},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(key,mom){var output=this._calendar[key];return typeof output==="function"?output.apply(mom):output},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return(typeof output==="function")?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number)},pastFuture:function(diff,output){var format=this._relativeTime[diff>0?"future":"past"];return typeof format==="function"?format(output):format.replace(/%s/i,output)},ordinal:function(number){return this._ordinal.replace("%d",number)},_ordinal:"%d",preparse:function(string){return string},postformat:function(string){return string},week:function(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6}};function loadLang(key,values){values.abbr=key;if(!languages[key]){languages[key]=new Language()}languages[key].set(values);return languages[key]}function getLangDefinition(key){if(!key){return moment.fn._lang}if(!languages[key]&&hasModule){try{require("./lang/"+key)}catch(e){return moment.fn._lang}}return languages[key]}function removeFormattingTokens(input){if(input.match(/\[.*\]/)){return input.replace(/^\[|\]$/g,"")}return input.replace(/\\/g,"")}function makeFormatFunction(format){var array=format.match(formattingTokens),i,length;for(i=0,length=array.length;i<length;i++){if(formatTokenFunctions[array[i]]){array[i]=formatTokenFunctions[array[i]]}else{array[i]=removeFormattingTokens(array[i])}}return function(mom){var output="";for(i=0;i<length;i++){output+=array[i] instanceof Function?array[i].call(mom,format):array[i]}return output}}function formatMoment(m,format){var i=5;function replaceLongDateFormatTokens(input){return m.lang().longDateFormat(input)||input}while(i--&&localFormattingTokens.test(format)){format=format.replace(localFormattingTokens,replaceLongDateFormatTokens)}if(!formatFunctions[format]){formatFunctions[format]=makeFormatFunction(format)}return formatFunctions[format](m)}function getParseRegexForToken(token,config){switch(token){case"DDDD":return parseTokenThreeDigits;case"YYYY":return parseTokenFourDigits;case"YYYYY":return parseTokenSixDigits;case"S":case"SS":case"SSS":case"DDD":return parseTokenOneToThreeDigits;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return parseTokenWord;case"a":case"A":return getLangDefinition(config._l)._meridiemParse;case"X":return parseTokenTimestampMs;case"Z":case"ZZ":return parseTokenTimezone;case"T":return parseTokenT;case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return parseTokenOneOrTwoDigits;default:return new RegExp(token.replace("\\",""))}}function timezoneMinutesFromString(string){var tzchunk=(parseTokenTimezone.exec(string)||[])[0],parts=(tzchunk+"").match(parseTimezoneChunker)||["-",0,0],minutes=+(parts[1]*60)+~~parts[2];return parts[0]==="+"?-minutes:minutes}function addTimeToArrayFromToken(token,input,config){var a,datePartArray=config._a;switch(token){case"M":case"MM":datePartArray[1]=(input==null)?0:~~input-1;break;case"MMM":case"MMMM":a=getLangDefinition(config._l).monthsParse(input);if(a!=null){datePartArray[1]=a}else{config._isValid=false}break;case"D":case"DD":case"DDD":case"DDDD":if(input!=null){datePartArray[2]=~~input}break;case"YY":datePartArray[0]=~~input+(~~input>68?1900:2000);break;case"YYYY":case"YYYYY":datePartArray[0]=~~input;break;case"a":case"A":config._isPm=getLangDefinition(config._l).isPM(input);break;case"H":case"HH":case"h":case"hh":datePartArray[3]=~~input;break;case"m":case"mm":datePartArray[4]=~~input;break;case"s":case"ss":datePartArray[5]=~~input;break;case"S":case"SS":case"SSS":datePartArray[6]=~~(("0."+input)*1000);break;case"X":config._d=new Date(parseFloat(input)*1000);break;case"Z":case"ZZ":config._useUTC=true;config._tzm=timezoneMinutesFromString(input);break}if(input==null){config._isValid=false}}function dateFromArray(config){var i,date,input=[];if(config._d){return }for(i=0;i<7;i++){config._a[i]=input[i]=(config._a[i]==null)?(i===2?1:0):config._a[i]}input[3]+=~~((config._tzm||0)/60);input[4]+=~~((config._tzm||0)%60);date=new Date(0);if(config._useUTC){date.setUTCFullYear(input[0],input[1],input[2]);date.setUTCHours(input[3],input[4],input[5],input[6])}else{date.setFullYear(input[0],input[1],input[2]);date.setHours(input[3],input[4],input[5],input[6])}config._d=date}function makeDateFromStringAndFormat(config){var tokens=config._f.match(formattingTokens),string=config._i,i,parsedInput;config._a=[];for(i=0;i<tokens.length;i++){parsedInput=(getParseRegexForToken(tokens[i],config).exec(string)||[])[0];if(parsedInput){string=string.slice(string.indexOf(parsedInput)+parsedInput.length)}if(formatTokenFunctions[tokens[i]]){addTimeToArrayFromToken(tokens[i],parsedInput,config)}}if(string){config._il=string}if(config._isPm&&config._a[3]<12){config._a[3]+=12}if(config._isPm===false&&config._a[3]===12){config._a[3]=0}dateFromArray(config)}function makeDateFromStringAndArray(config){var tempConfig,tempMoment,bestMoment,scoreToBeat=99,i,currentScore;for(i=0;i<config._f.length;i++){tempConfig=extend({},config);tempConfig._f=config._f[i];makeDateFromStringAndFormat(tempConfig);tempMoment=new Moment(tempConfig);currentScore=compareArrays(tempConfig._a,tempMoment.toArray());if(tempMoment._il){currentScore+=tempMoment._il.length}if(currentScore<scoreToBeat){scoreToBeat=currentScore;bestMoment=tempMoment}}extend(config,bestMoment)}function makeDateFromString(config){var i,string=config._i,match=isoRegex.exec(string);if(match){config._f="YYYY-MM-DD"+(match[2]||" ");for(i=0;i<4;i++){if(isoTimes[i][1].exec(string)){config._f+=isoTimes[i][0];break}}if(parseTokenTimezone.exec(string)){config._f+=" Z"}makeDateFromStringAndFormat(config)}else{config._d=new Date(string)}}function makeDateFromInput(config){var input=config._i,matched=aspNetJsonRegex.exec(input);if(input===undefined){config._d=new Date()}else{if(matched){config._d=new Date(+matched[1])}else{if(typeof input==="string"){makeDateFromString(config)}else{if(isArray(input)){config._a=input.slice(0);dateFromArray(config)}else{config._d=input instanceof Date?new Date(+input):new Date(input)}}}}}function substituteTimeAgo(string,number,withoutSuffix,isFuture,lang){return lang.relativeTime(number||1,!!withoutSuffix,string,isFuture)}function relativeTime(milliseconds,withoutSuffix,lang){var seconds=round(Math.abs(milliseconds)/1000),minutes=round(seconds/60),hours=round(minutes/60),days=round(hours/24),years=round(days/365),args=seconds<45&&["s",seconds]||minutes===1&&["m"]||minutes<45&&["mm",minutes]||hours===1&&["h"]||hours<22&&["hh",hours]||days===1&&["d"]||days<=25&&["dd",days]||days<=45&&["M"]||days<345&&["MM",round(days/30)]||years===1&&["y"]||["yy",years];args[2]=withoutSuffix;args[3]=milliseconds>0;args[4]=lang;return substituteTimeAgo.apply({},args)}function weekOfYear(mom,firstDayOfWeek,firstDayOfWeekOfYear){var end=firstDayOfWeekOfYear-firstDayOfWeek,daysToDayOfWeek=firstDayOfWeekOfYear-mom.day(),adjustedMoment;if(daysToDayOfWeek>end){daysToDayOfWeek-=7}if(daysToDayOfWeek<end-7){daysToDayOfWeek+=7}adjustedMoment=moment(mom).add("d",daysToDayOfWeek);return{week:Math.ceil(adjustedMoment.dayOfYear()/7),year:adjustedMoment.year()}}function makeMoment(config){var input=config._i,format=config._f;if(input===null||input===""){return null}if(typeof input==="string"){config._i=input=getLangDefinition().preparse(input)}if(moment.isMoment(input)){config=extend({},input);config._d=new Date(+input._d)}else{if(format){if(isArray(format)){makeDateFromStringAndArray(config)}else{makeDateFromStringAndFormat(config)}}else{makeDateFromInput(config)}}return new Moment(config)}moment=function(input,format,lang){return makeMoment({_i:input,_f:format,_l:lang,_isUTC:false})};moment.utc=function(input,format,lang){return makeMoment({_useUTC:true,_isUTC:true,_l:lang,_i:input,_f:format})};moment.unix=function(input){return moment(input*1000)};moment.duration=function(input,key){var isDuration=moment.isDuration(input),isNumber=(typeof input==="number"),duration=(isDuration?input._input:(isNumber?{}:input)),matched=aspNetTimeSpanJsonRegex.exec(input),sign,ret;if(isNumber){if(key){duration[key]=input}else{duration.milliseconds=input}}else{if(matched){sign=(matched[1]==="-")?-1:1;duration={y:0,d:~~matched[2]*sign,h:~~matched[3]*sign,m:~~matched[4]*sign,s:~~matched[5]*sign,ms:~~matched[6]*sign}}}ret=new Duration(duration);if(isDuration&&input.hasOwnProperty("_lang")){ret._lang=input._lang}return ret};moment.version=VERSION;moment.defaultFormat=isoFormat;moment.updateOffset=function(){};moment.lang=function(key,values){if(!key){return moment.fn._lang._abbr}if(values){loadLang(key,values)}else{if(!languages[key]){getLangDefinition(key)}}moment.duration.fn._lang=moment.fn._lang=getLangDefinition(key)};moment.langData=function(key){if(key&&key._lang&&key._lang._abbr){key=key._lang._abbr}return getLangDefinition(key)};moment.isMoment=function(obj){return obj instanceof Moment};moment.isDuration=function(obj){return obj instanceof Duration};moment.fn=Moment.prototype={clone:function(){return moment(this)},valueOf:function(){return +this._d+((this._offset||0)*60000)},unix:function(){return Math.floor(+this/1000)},toString:function(){return this.format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){return formatMoment(moment(this).utc(),"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var m=this;return[m.year(),m.month(),m.date(),m.hours(),m.minutes(),m.seconds(),m.milliseconds()]},isValid:function(){if(this._isValid==null){if(this._a){this._isValid=!compareArrays(this._a,(this._isUTC?moment.utc(this._a):moment(this._a)).toArray())}else{this._isValid=!isNaN(this._d.getTime())}}return !!this._isValid},utc:function(){return this.zone(0)},local:function(){this.zone(0);this._isUTC=false;return this},format:function(inputString){var output=formatMoment(this,inputString||moment.defaultFormat);return this.lang().postformat(output)},add:function(input,val){var dur;if(typeof input==="string"){dur=moment.duration(+val,input)}else{dur=moment.duration(input,val)}addOrSubtractDurationFromMoment(this,dur,1);return this},subtract:function(input,val){var dur;if(typeof input==="string"){dur=moment.duration(+val,input)}else{dur=moment.duration(input,val)}addOrSubtractDurationFromMoment(this,dur,-1);return this},diff:function(input,units,asFloat){var that=this._isUTC?moment(input).zone(this._offset||0):moment(input).local(),zoneDiff=(this.zone()-that.zone())*60000,diff,output;units=normalizeUnits(units);if(units==="year"||units==="month"){diff=(this.daysInMonth()+that.daysInMonth())*43200000;output=((this.year()-that.year())*12)+(this.month()-that.month());output+=((this-moment(this).startOf("month"))-(that-moment(that).startOf("month")))/diff;output-=((this.zone()-moment(this).startOf("month").zone())-(that.zone()-moment(that).startOf("month").zone()))*60000/diff;if(units==="year"){output=output/12}}else{diff=(this-that);output=units==="second"?diff/1000:units==="minute"?diff/60000:units==="hour"?diff/3600000:units==="day"?(diff-zoneDiff)/86400000:units==="week"?(diff-zoneDiff)/604800000:diff}return asFloat?output:absRound(output)},from:function(time,withoutSuffix){return moment.duration(this.diff(time)).lang(this.lang()._abbr).humanize(!withoutSuffix)},fromNow:function(withoutSuffix){return this.from(moment(),withoutSuffix)},calendar:function(){var diff=this.diff(moment().startOf("day"),"days",true),format=diff<-6?"sameElse":diff<-1?"lastWeek":diff<0?"lastDay":diff<1?"sameDay":diff<2?"nextDay":diff<7?"nextWeek":"sameElse";return this.format(this.lang().calendar(format,this))},isLeapYear:function(){var year=this.year();return(year%4===0&&year%100!==0)||year%400===0},isDST:function(){return(this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone())},day:function(input){var day=this._isUTC?this._d.getUTCDay():this._d.getDay();if(input!=null){if(typeof input==="string"){input=this.lang().weekdaysParse(input);if(typeof input!=="number"){return this}}return this.add({d:input-day})}else{return day}},month:function(input){var utc=this._isUTC?"UTC":"",dayOfMonth,daysInMonth;if(input!=null){if(typeof input==="string"){input=this.lang().monthsParse(input);if(typeof input!=="number"){return this}}dayOfMonth=this.date();this.date(1);this._d["set"+utc+"Month"](input);this.date(Math.min(dayOfMonth,this.daysInMonth()));moment.updateOffset(this);return this}else{return this._d["get"+utc+"Month"]()}},startOf:function(units){units=normalizeUnits(units);switch(units){case"year":this.month(0);case"month":this.date(1);case"week":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}if(units==="week"){this.weekday(0)}return this},endOf:function(units){return this.startOf(units).add(units,1).subtract("ms",1)},isAfter:function(input,units){units=typeof units!=="undefined"?units:"millisecond";return +this.clone().startOf(units)>+moment(input).startOf(units)},isBefore:function(input,units){units=typeof units!=="undefined"?units:"millisecond";return +this.clone().startOf(units)<+moment(input).startOf(units)},isSame:function(input,units){units=typeof units!=="undefined"?units:"millisecond";return +this.clone().startOf(units)===+moment(input).startOf(units)},min:function(other){other=moment.apply(null,arguments);return other<this?this:other},max:function(other){other=moment.apply(null,arguments);return other>this?this:other},zone:function(input){var offset=this._offset||0;if(input!=null){if(typeof input==="string"){input=timezoneMinutesFromString(input)}if(Math.abs(input)<16){input=input*60}this._offset=input;this._isUTC=true;if(offset!==input){addOrSubtractDurationFromMoment(this,moment.duration(offset-input,"m"),1,true)}}else{return this._isUTC?offset:this._d.getTimezoneOffset()}return this},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},daysInMonth:function(){return moment.utc([this.year(),this.month()+1,0]).date()},dayOfYear:function(input){var dayOfYear=round((moment(this).startOf("day")-moment(this).startOf("year"))/86400000)+1;return input==null?dayOfYear:this.add("d",(input-dayOfYear))},weekYear:function(input){var year=weekOfYear(this,this.lang()._week.dow,this.lang()._week.doy).year;return input==null?year:this.add("y",(input-year))},isoWeekYear:function(input){var year=weekOfYear(this,1,4).year;return input==null?year:this.add("y",(input-year))},week:function(input){var week=this.lang().week(this);return input==null?week:this.add("d",(input-week)*7)},isoWeek:function(input){var week=weekOfYear(this,1,4).week;return input==null?week:this.add("d",(input-week)*7)},weekday:function(input){var weekday=(this._d.getDay()+7-this.lang()._week.dow)%7;return input==null?weekday:this.add("d",input-weekday)},isoWeekday:function(input){return input==null?this.day()||7:this.day(this.day()%7?input:input-7)},lang:function(key){if(key===undefined){return this._lang}else{this._lang=getLangDefinition(key);return this}}};function makeGetterAndSetter(name,key){moment.fn[name]=moment.fn[name+"s"]=function(input){var utc=this._isUTC?"UTC":"";if(input!=null){this._d["set"+utc+key](input);moment.updateOffset(this);return this}else{return this._d["get"+utc+key]()}}}for(i=0;i<proxyGettersAndSetters.length;i++){makeGetterAndSetter(proxyGettersAndSetters[i].toLowerCase().replace(/s$/,""),proxyGettersAndSetters[i])}makeGetterAndSetter("year","FullYear");moment.fn.days=moment.fn.day;moment.fn.months=moment.fn.month;moment.fn.weeks=moment.fn.week;moment.fn.isoWeeks=moment.fn.isoWeek;moment.fn.toJSON=moment.fn.toISOString;moment.duration.fn=Duration.prototype={_bubble:function(){var milliseconds=this._milliseconds,days=this._days,months=this._months,data=this._data,seconds,minutes,hours,years;data.milliseconds=milliseconds%1000;seconds=absRound(milliseconds/1000);data.seconds=seconds%60;minutes=absRound(seconds/60);data.minutes=minutes%60;hours=absRound(minutes/60);data.hours=hours%24;days+=absRound(hours/24);data.days=days%30;months+=absRound(days/30);data.months=months%12;years=absRound(months/12);data.years=years},weeks:function(){return absRound(this.days()/7)},valueOf:function(){return this._milliseconds+this._days*86400000+(this._months%12)*2592000000+~~(this._months/12)*31536000000},humanize:function(withSuffix){var difference=+this,output=relativeTime(difference,!withSuffix,this.lang());if(withSuffix){output=this.lang().pastFuture(difference,output)}return this.lang().postformat(output)},add:function(input,val){var dur=moment.duration(input,val);this._milliseconds+=dur._milliseconds;this._days+=dur._days;this._months+=dur._months;this._bubble();return this},subtract:function(input,val){var dur=moment.duration(input,val);this._milliseconds-=dur._milliseconds;this._days-=dur._days;this._months-=dur._months;this._bubble();return this},get:function(units){units=normalizeUnits(units);return this[units.toLowerCase()+"s"]()},as:function(units){units=normalizeUnits(units);return this["as"+units.charAt(0).toUpperCase()+units.slice(1)+"s"]()},lang:moment.fn.lang};function makeDurationGetter(name){moment.duration.fn[name]=function(){return this._data[name]}}function makeDurationAsGetter(name,factor){moment.duration.fn["as"+name]=function(){return +this/factor}}for(i in unitMillisecondFactors){if(unitMillisecondFactors.hasOwnProperty(i)){makeDurationAsGetter(i,unitMillisecondFactors[i]);makeDurationGetter(i.toLowerCase())}}makeDurationAsGetter("Weeks",604800000);moment.duration.fn.asMonths=function(){return(+this-this.years()*31536000000)/2592000000+this.years()*12};moment.lang("en",{ordinal:function(number){var b=number%10,output=(~~(number%100/10)===1)?"th":(b===1)?"st":(b===2)?"nd":(b===3)?"rd":"th";return number+output}});if(hasModule){module.exports=moment}if(typeof ender==="undefined"){this["moment"]=moment}if(typeof define==="function"&&define.amd){define("moment",[],function(){return moment})}}).call(this);
/* module-key = 'jira.webresources:jquery-livestamp', location = '/includes/jquery/plugins/livestamp/moment.jira.i18n.js' */
(function(moment){var relativize=AJS.Meta.getBoolean("date-relativize"),meridiem=['AM','PM'],map={d:"D",y:"Y",a:"A",E:"d",u:"d",Z:"ZZ",z:"[GMT]ZZ",XX:"ZZ",XXX:"Z"};JIRA.translateSimpleDateFormat=function(pattern){var inQuote=false,skip=false,tmpBuffer="",actuallyTranslate=function(tmpBuffer){return map[tmpBuffer]||_.reduce(tmpBuffer,function(memo,value){return memo+(map[value]||value)},"")},reduction=_.reduce(pattern,function(memo,value,index,list){if(skip){skip=false}else{if(value==="'"){if(tmpBuffer){memo+=actuallyTranslate(tmpBuffer);tmpBuffer=""}if(list[index+1]==="'"){memo+=value;skip=true}else{memo+=!inQuote?"[":"]";inQuote=!inQuote}}else{if(inQuote){memo+=value}else{if(!/[a-zA-Z]/.test(value)){if(tmpBuffer){memo+=actuallyTranslate(tmpBuffer);tmpBuffer=""}memo+=value}else{if(!tmpBuffer||tmpBuffer[tmpBuffer.length-1]===value){tmpBuffer+=value}else{memo+=actuallyTranslate(tmpBuffer);tmpBuffer=value}}}}}return memo},"");if(tmpBuffer){reduction+=actuallyTranslate(tmpBuffer)}return reduction};moment.lang("jira",{months:['January','February','March','April','May','June','July','August','September','October','November','December'],monthsShort:['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],weekdays:['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],weekdaysShort:['Sun','Mon','Tue','Wed','Thu','Fri','Sat'],weekdaysMin:['Sun','Mon','Tue','Wed','Thu','Fri','Sat'],longDateFormat:{LT:JIRA.translateSimpleDateFormat(AJS.Meta.get("date-time")),L:JIRA.translateSimpleDateFormat(AJS.Meta.get("date-day")),LL:JIRA.translateSimpleDateFormat(AJS.Meta.get("date-dmy")),LLL:JIRA.translateSimpleDateFormat(AJS.Meta.get("date-complete"))},meridiem:function(hours){return meridiem[+(hours>11)]},calendar:{sameDay:relativize?AJS.format("{0}Today{1} {2}","[","]","LT"):"LLL",nextDay:relativize?AJS.format("{0}Tomorrow{1} {2}","[","]","LT"):"LLL",nextWeek:"LLL",lastDay:relativize?AJS.format("{0}Yesterday{1} {2}","[","]","LT"):"LLL",lastWeek:"LLL",sameElse:"LLL"},relativeTime:{future:AJS.format("in {0}","%s"),past:AJS.format("{0} ago","%s"),s:"a few seconds",m:"a minute",mm:AJS.format("{0} minutes","%d"),h:"an hour",hh:AJS.format("{0} hours","%d"),d:"a day",dd:AJS.format("{0} days","%d"),M:"a month",MM:AJS.format("{0} months","%d"),y:"a year",yy:AJS.format("{0} years","%d")}})}(moment));
/* module-key = 'jira.webresources:jquery-livestamp', location = '/includes/jquery/plugins/livestamp/livestamp.js' */
(function($,moment){var timeout,updateInterval=6000,relativize=AJS.Meta.getBoolean("date-relativize"),livestamps=[],prep=function($el,timestamp){$el.data("livestampdata",timestamp);livestamps.push($el)},run=function(){update();clearTimeout(timeout);timeout=setTimeout(run,updateInterval)},update=function(){var now=moment(),sod=moment().startOf("day");livestamps=$.grep(livestamps,function($el){var timestamp=$el.data("livestampdata"),from,to;if(!moment.isMoment(timestamp)||!$el.closest("html").length){$el.removeData("livestampdata")}else{from=$el.text();if(relativize&&now.diff(timestamp,"hours")<=1){if(timestamp.isBefore(now)||$el.hasClass("allow-future")){to=timestamp.fromNow()}else{to=now.fromNow()}}else{to=timestamp.calendar();if(sod.diff(timestamp,"weeks")){$el.removeData("livestampdata")}}if(from!==to){$el.text(to)}}return !!$el.data("livestampdata")})},add=function($el){$el.each(function(){var $this=$(this),timestamp=$this.attr("datetime");if(timestamp){prep($this,moment(timestamp).zone(timestamp))}});run();return $el};$.fn.livestamp=function(){return add(this)}}(jQuery,moment));
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/issuecomponents.soy' */
// This file was automatically generated from issuecomponents.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Issue == 'undefined') { JIRA.Templates.Issue = {}; }


JIRA.Templates.Issue.watchersWithBrowse = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" method="post" class="aui recipients-form"><a href="#" class="cancel aui-icon aui-icon-close"></a><fieldset><label for="watchers-multi-select">', soy.$$escapeHtml("Add Watchers"), '</label><div class="autocomplete-user-target"><select id="watchers" name="watchers" data-description="', soy.$$escapeHtml("Start Typing for Users"), '" class="watchers-user-picker hidden" multiple="multiple">');
  var watcherList8 = opt_data.watchers;
  var watcherListLen8 = watcherList8.length;
  for (var watcherIndex8 = 0; watcherIndex8 < watcherListLen8; watcherIndex8++) {
    var watcherData8 = watcherList8[watcherIndex8];
    output.append('<option style="background-image:url(\'', soy.$$escapeHtml(watcherData8.avatarUrls['16x16']), '\')" selected="selected" value="', soy.$$escapeHtml(watcherData8.name), '">', soy.$$escapeHtml(watcherData8.displayName), '</option>');
  }
  output.append('</select></div></fieldset></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.watchersNoBrowse = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" method="post" class="aui recipients-form"><a href="#" class="cancel aui-icon aui-icon-close"></a><fieldset><label for="watchers-multi-select">', soy.$$escapeHtml("Add Watchers"), '</label><div><input type="text" class="text" id="watchers-nosearch" /><div class="description">', soy.$$escapeHtml("Type username and press enter."), '</div></div><div class="recipients"><ol class="watchers">');
  var watcherList24 = opt_data.watchers;
  var watcherListLen24 = watcherList24.length;
  for (var watcherIndex24 = 0; watcherIndex24 < watcherListLen24; watcherIndex24++) {
    var watcherData24 = watcherList24[watcherIndex24];
    JIRA.Templates.Fields.recipientUsername({username: watcherData24.name, icon: watcherData24.avatarUrls['16x16'], displayName: watcherData24.displayName, escape: true}, output);
  }
  output.append('</ol></div></fieldset></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.watchersReadOnly = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form class="aui recipients-form"><a href="#" class="cancel aui-icon aui-icon-close"></a><fieldset><div class="recipients"><ol class="watchers">');
  var watcherList34 = opt_data.watchers;
  var watcherListLen34 = watcherList34.length;
  for (var watcherIndex34 = 0; watcherIndex34 < watcherListLen34; watcherIndex34++) {
    var watcherData34 = watcherList34[watcherIndex34];
    JIRA.Templates.Fields.recipientUsername({username: watcherData34.name, icon: watcherData34.avatarUrls['16x16'], displayName: watcherData34.displayName, readOnly: true, escape: true}, output);
  }
  output.append('</ol></div></fieldset></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.error = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<p>', soy.$$escapeHtml(opt_data.msg), '</p><ul>');
  var messageList47 = opt_data.errors;
  var messageListLen47 = messageList47.length;
  for (var messageIndex47 = 0; messageIndex47 < messageListLen47; messageIndex47++) {
    var messageData47 = messageList47[messageIndex47];
    output.append('<li>', soy.$$escapeHtml(messageData47), '</li>');
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'jira.webresources:viewissue', location = '/includes/jquery/plugins/shorten/shorten.js' */
AJS.Shortener=AJS.Control.extend({_getDefaultOptions:function(){return{items:"a, span",numRows:1,shortenText:"hide",shortenOnInit:true,persist:true,expandButtonTooltip:"Click to view {0} more",collapseButtonTooltip:"Hide"}},init:function(options){if(typeof options==="string"){options={element:options}}options=options||{};this.options=AJS.$.extend(this._getDefaultOptions(),options);this._timerId=0;this.expanded=false;this.$container=AJS.$(this.options.element);this._assignEvents("body",document.body);this._ready()},_isValid:function(){return !this.initialized&&this.$container.is(":visible")&&this.$container.children().length>0},_ready:function(){if(this._isValid()){this.$items=this.$container.children(this.options.items);this.$expandButton=this._render("expandButton");this.$collapseButton=this._render("collapseButton");this._assignEvents("expand-button",".shortener-expand");this._assignEvents("collapse-button",".shortener-collapse");if(!jQuery.browser.msie||jQuery.browser.version>="9"){this._assignEvents("resize-region",window)}if(this._isCollapsedOnInit()){this.collapse()}else{this.expand()}this.initialized=true}},_renders:{"expandButton":function(){return AJS.$("<a href='#' class='ellipsis shortener-expand' title='"+this.options.expandButtonTooltip+"'></a><br>")},"collapseButton":function(){return AJS.$("<a title='Hide' class='icon icon-hide shortener-collapse' href='#'><span>"+this.options.collapseButtonTooltip+"</span></a>")}},_events:{"expand-button":{"click":function(event){if(event.currentTarget===this.$expandButton[0]){event.preventDefault();this.expand();this._saveState("expanded")}}},"collapse-button":{"click":function(event){if(event.currentTarget===this.$collapseButton[0]){event.preventDefault();this.collapse();this._saveState("collapsed");this.$container.scrollIntoView()}}},"resize-region":{"resize":function(){clearTimeout(this._timerId);if(!this.expanded){var instance=this;this._timerId=setTimeout(function(){instance.collapse()},400)}}},"body":{tabSelect:function(){this._ready()}}},_saveState:function(value){try{localStorage.setItem("AJS.Shortener#"+this.$container.closest("[id]").attr("id"),value)}catch(QUOTA_EXCEEDED_ERR){}},_loadState:function(){return localStorage.getItem("AJS.Shortener#"+this.$container.closest("[id]").attr("id"))},_isCollapsedOnInit:function(){var shortenOnInit=this._loadState();if(shortenOnInit!==null){return shortenOnInit!=="expanded"}return this.options.shortenOnInit},_removeButtons:function(){this.$expandButton.remove();this.$collapseButton.remove()},_getOverflowIndex:function(){if(this.$items.length>1){var currentRow=1;var prevItemPageX=-1;for(var i=0;i<this.$items.length;i++){var itemPageX=this.$items.eq(i).offset().left;if(itemPageX<=prevItemPageX){currentRow++;if(currentRow>this.options.numRows){return i}}prevItemPageX=itemPageX}}return -1},expand:function(){this._removeButtons();if(this._getOverflowIndex()>0){this.$collapseButton=this._render("collapseButton");this.$container.append(this.$collapseButton);this.$container.css("height","auto");if(jQuery.browser.msie&&jQuery.browser.version<"9"){AJS.$("body").toggleClass("reflow")}}this.expanded=true},collapse:function(){this._removeButtons();var i=this._getOverflowIndex();if(i>0){this.$container.css({"position":"absolute","visibility":"hidden","width":this.$container[0].clientWidth+"px"});var $expandButtonContent=this.$expandButton.first();do{var remainingItemCount=(this.$items.length-i);$expandButtonContent.text("("+remainingItemCount+")");this.$expandButton.insertBefore(this.$items[i]);i--;var oi=this.$items.eq(i).offset();var ob=this.$expandButton.offset();if(oi.left<ob.left&&ob.top<oi.top+10){break}}while(i>0);var height=(i<this.$items.length-1)?(this.$items.eq(i+1).offset().top-this.$container.offset().top)+"px":"auto";this.$container.css({"height":height,"position":"static","visibility":"visible","width":"auto"});$expandButtonContent.attr("title",AJS.format(this.options.expandButtonTooltip,remainingItemCount));if(jQuery.browser.msie&&jQuery.browser.version<"9"){AJS.$("body").toggleClass("reflow")}}else{this.$container.css("height","auto")}this.expanded=false}});jQuery.fn.shorten=function(options){var res=[];options=options||{};this.each(function(){options.element=this;res.push(new AJS.Shortener(options))});return res};
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/initShorten.js' */
JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,$ctx){AJS.$(".shorten",$ctx).shorten()});
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/initToggleBlock.js' */
AJS.$(function(){new JIRA.ToggleBlock({blockSelector:".toggle-wrap",triggerSelector:".mod-header .toggle-title",storageCollectionName:"block-states",});if(JIRA.Events.ISSUE_REFRESHED){JIRA.bind(JIRA.Events.ISSUE_REFRESHED,function(){if(JIRA.Events.REFRESH_TOGGLE_BLOCKS){JIRA.trigger(JIRA.Events.REFRESH_TOGGLE_BLOCKS)}})}});
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/initSlideshow.js' */
(function($){var defaultOpts={type:"image",centerOnScroll:true,onStart:AJS.disableKeyboardShortcuts,onClosed:AJS.enableKeyboardShortcuts};function initGallery($ctx){var transition=$.browser.msie&&$.browser.version<=8?"fade":"elastic";var galleryOpts=$.extend({},defaultOpts,{transitionIn:transition,transitionOut:transition});$ctx.find(".gallery, [id$='_thumb']").each(function(){$(this).fancybox(galleryOpts)});$ctx.find("#attachment_thumbnails .attachment-title").click(function(e){if(e.which===1){e.preventDefault();$(this).closest(".attachment-content").find(".gallery").click()}})}function initWorkflow($ctx){$ctx.find("a.issueaction-viewworkflow:not(.new-workflow-designer)").each(function(){$(this).fancybox(defaultOpts)})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,$ctx,reason){initGallery($ctx);initWorkflow($ctx)});$(function(){if(JIRA.Events.PANEL_REFRESHED){JIRA.bind(JIRA.Events.PANEL_REFRESHED,function(e,panel,$new,$existing){if(panel==="attachmentmodule"){initGallery($new)}else{if(panel==="details-module"){initWorkflow($new)}}})}})})(AJS.$);
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/initComment.js' */
(function($){var commentForm=JIRA.Issue.CommentForm={setCaretAtEndOfCommentField:function(){var $field=this.getField(),field=$field[0],length;if($field.length){length=$field.val().length;$field.scrollTop($field.attr("scrollHeight"));if(field.setSelectionRange&&length>0){field.setSelectionRange(length,length)}}},disable:function(){this.getForm().find("textarea").attr("readonly","readonly");this.getForm().find(":submit").attr("disabled","disabled")},isDirty:function(){var field=this.getField();if(field.length){return field[0].value!==field[0].defaultValue}return false},handleBrowseAway:function(){var isDirty=commentForm.isDirty(),isVisible=commentForm.getForm()&&commentForm.getForm().is(":visible");if(isDirty&&isVisible){return "You have entered a comment on this issue. If you navigate away from this page without first saving, the comment will be lost."}},setSubmitState:function(){if(jQuery.trim(this.getField().val()).length>0){this.getForm().find(":submit").removeAttr("disabled")}else{this.getForm().find(":submit").attr("disabled","disabled")}},enable:function(){this.getForm().find("textarea").removeAttr("readonly");this.getForm().find(":submit").removeAttr("disabled")},getCommentVisibility:function(){var visibility=$("#commentLevel :selected").val();if(visibility){var split_v=visibility.split(":");return{"type":split_v[0],"value":$("#commentLevel :selected").text()}}return null},ajaxSubmit:function(callback){var $loading=jQuery('<span class="icon throbber loading"></span>');var issueId=JIRA.Issue.getIssueId();var issueKey=JIRA.Issue.getIssueKey();var restURL=contextPath+"/rest/api/2/issue/"+issueKey+"/comment";var newComment={"body":this.getField()[0].value};var visibility=this.getCommentVisibility();if(visibility){newComment["visibility"]=visibility}$.ajax({url:restURL,type:"POST",contentType:"application/json",data:JSON.stringify(newComment),success:function(data){JIRA.trigger(JIRA.Events.UNLOCK_PANEL_REFRESHING,["addcommentmodule"]);JIRA.trigger(JIRA.Events.REFRESH_ISSUE_PAGE,[issueId,{complete:function(){var newCommentId="comment-"+data.id;jQuery("#"+newCommentId).scrollIntoView({marginBottom:200,marginTop:200});var $focusedTabs=$("#issue_actions_container > .issue-data-block.focused");$focusedTabs.removeClass("focused");var $newfocusedTab=$("#"+newCommentId);$newfocusedTab.addClass("focused");$loading.remove();footerComment.hide(true)}}])},error:function(xhr){function buildErrorDialog(errorMessage){var errorContent="<h2>"+"Error"+"</h2>"+'<div class="ajaxerror">'+'<div class="aui-message error">'+'<span class="aui-icon icon-warning"/>'+errorMessage+"</div>"+"</div>";return $(errorContent)}var response=$.parseJSON(xhr.responseText);var content;if(response&&response.errors&&response.errors.comment){content=buildErrorDialog(response.errors.comment)}else{content=JIRA.SmartAjax.buildDialogErrorContent(xhr)}new JIRA.FormDialog({content:content}).show();$loading.remove();commentForm.enable()}});$loading.appendTo(this.getForm().find(":submit").parent())},getForm:function(){var $form=$("form#issue-comment-add");if($form.length===1){this.$form=$form}return this.$form||$()},getField:function(){return this.getForm().find("#comment")},getSubmitButton:function(){return this.getForm().find("#issue-comment-add-submit")},hide:function(cancel){this.getForm().detach();if(JIRA.Events.UNLOCK_PANEL_REFRESHING){JIRA.trigger(JIRA.Events.UNLOCK_PANEL_REFRESHING,["addcommentmodule"])}if(cancel){this.cancel()}},show:function(){this.focus();if(JIRA.Events.LOCK_PANEL_REFRESHING){JIRA.trigger(JIRA.Events.LOCK_PANEL_REFRESHING,["addcommentmodule"])}},focus:function(){this.focusField();this.setCaretAtEndOfCommentField()},focusField:function(){this.getField().focus().trigger("keyup");this.getSubmitButton().scrollIntoView({marginBottom:200})},showNoCommentMsg:function(e){if(this.getField().val()===""){$("#emptyCommentErrMsg").show();return true}},cancel:function(){var instance=this;setTimeout(function(){instance.getField().val("")},100);$("#comment-preview_link.selected").click()}};var footerComment={getModule:function(){return $("#addcomment")},isActive:function(){return this.getModule().hasClass("active")},hide:function(cancel){if(this.isActive()){this.getModule().removeClass("active");commentForm.hide(cancel)}},ajaxSubmit:function(){commentForm.ajaxSubmit(function(){footerComment.hide()})},show:function(){if(!this.isActive()){this.getModule().addClass("active");this.appendForm();commentForm.show()}else{commentForm.focusField()}},appendForm:function(){this.getModule().find(".mod-content").append(commentForm.getForm())}};var oldBeforeUnload=window.onbeforeunload;$(document).delegate("body:not(.ka) #issue-comment-add","submit",function(e){window.onbeforeunload=oldBeforeUnload}).delegate(".ka #addcomment #issue-comment-add","submit",function(e){footerComment.ajaxSubmit();e.preventDefault()}).delegate(".issue-header #comment-issue","click",function(e){footerComment.show();e.preventDefault()}).delegate("#footer-comment-button","click",function(e){footerComment.show();e.preventDefault()}).delegate("#addcomment .cancel","click",function(e){e.preventDefault();footerComment.hide(true)}).delegate("#issue-comment-add","submit",function(){window.setTimeout(function(){commentForm.disable()},0)}).delegate("#issue-comment-add #comment","input",function(){commentForm.setSubmitState()}).delegate("#issue-comment-add input[type='submit']","click",function(e){if(commentForm.showNoCommentMsg()){e.preventDefault()}}).bind("showWikiInput",function(){var $commentField=commentForm.getField();if($commentField.is(":visible:enabled")){JIRA.Issue.getStalker().trigger("stalkerHeightUpdated");if($commentField.length>0){$commentField.focus()}}}).bind("showWikiInput",function(){commentForm.setCaretAtEndOfCommentField()}).bind("showWikiPreview",function(){JIRA.Issue.getStalker().trigger("stalkerHeightUpdated")});window.onbeforeunload=function(){return oldBeforeUnload.apply(this,arguments)||commentForm.handleBrowseAway.apply(this,arguments)};$(function(){new AJS.SecurityLevelSelect($("#commentLevel"))});JIRA.Issue.getDirtyCommentWarning=commentForm.handleBrowseAway;JIRA.Issue.invokeCommentTrigger=function(){var addIssueComment=AJS.$(".add-issue-comment");if(addIssueComment.length===0){return }var toolbarTrigger=addIssueComment.filter(".toolbar-trigger");if(toolbarTrigger.length>0){toolbarTrigger.click()}else{addIssueComment.click()}}})(AJS.$);AJS.$(function(){if(parseUri(window.location.href).anchor==="add-comment"){AJS.$("#footer-comment-button").click()}});
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/initCustomFieldTabs.js' */
(function($,scope){var activateTab=function(tabName){var tabTrigger;if(typeof tabName!=="string"&&tabName.length>0){return }if(tabName[0]!=="#"){tabName="#"+tabName}console.log("activating tab",tabName);tabTrigger=$("a[href='"+tabName+"']",scope);if(tabTrigger.length){AJS.tabs.change(tabTrigger)}};var revealer=function(e){var $containingTab=$(e.target).closest(".tabs-pane");if($containingTab.length>0){activateTab($containingTab.attr("id"))}};$(function(){if(JIRA.Events.NEW_CONTENT_ADDED){JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,$context){var $customFieldModule=$context.find(scope);$customFieldModule.unbind("reveal");$customFieldModule.bind("reveal",revealer);AJS.tabs.setup()})}if(JIRA.Events.PANEL_REFRESHED){JIRA.bind(JIRA.Events.PANEL_REFRESHED,function(e,panel,$new,$existing){if(panel==="details-module"){var $activeTab=$existing.find(scope).find(".active-tab");if($activeTab.length===1){activateTab($activeTab.find("a").attr("href"))}}})}$(scope).bind("reveal",revealer)})})(AJS.$,"#customfieldmodule");
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/initSetSelectedIssue.js' */
jQuery(function(){if(AJS.Meta.get("search-pos")){AJS.$.get(contextPath+"/secure/SetSelectedIssue.jspa",{atl_token:atl_token(),selectedIssueId:jQuery("#key-val").attr("rel"),nextIssueId:jQuery("#next-issue").attr("rel"),selectedIssueIndex:AJS.Meta.getNumber("search-pos")})}});
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/initSubtaskTimeLogging.js' */
(function($){$(document).delegate("#tt_include_subtasks input","click",function(e){if(AJS.$(this).is(":checked")){AJS.$("#tt_info_single").hide();AJS.$("#tt_info_aggregate").show()}else{AJS.$("#tt_info_aggregate").hide();AJS.$("#tt_info_single").show()}})})(AJS.$);
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/initWatchers.js' */
AJS.$(function(){var WatcherModel=Backbone.Model.extend({url:function(){return[AJS.contextPath(),"rest/api/2/issue",AJS.Meta.get("issue-key"),"watchers"].join("/")},initialize:function(){this.set("canBrowseUsers",AJS.Meta.get("can-search-users"));this.set("isReadOnly",!AJS.Meta.get("can-edit-watchers"))},_parseResponse:function(responseText){try{return JSON.parse(responseText)}catch(e){this._showFatalErrorMessage();return null}},_showFatalErrorMessage:function(){var msg="<p>"+"Communications Breakdown"+"</p>"+"<p>"+"Close this dialog and press refresh in your browser"+"</p>";JIRA.Messages.showErrorMsg(msg,{closeable:true})},getUser:function(username){return AJS.$.ajax({url:AJS.contextPath()+"/rest/api/2/user?username="+encodeURIComponent(username),error:_.bind(function(xhr){if(xhr.status!==404){this.handleErrorResponse(xhr,"There was an error adding watcher")}},this)})},handleErrorResponse:function(xhr,msg){var errorCollection=this._parseResponse(xhr.responseText);if(errorCollection.errorMessages){var html=JIRA.Templates.Issue.error({msg:msg,errors:errorCollection.errorMessages});JIRA.Messages.showErrorMsg(html,{closeable:true})}this.trigger("errorOccurred")},addWatcher:function(username){return AJS.$.ajax({type:"post",url:this.url(),global:false,data:JSON.stringify(username),contentType:"application/json",error:_.bind(function(xhr){this.handleErrorResponse(xhr,"There was an error adding watcher")},this)})},removeWatcher:function(username){return AJS.$.ajax({type:"delete",global:false,url:this.url()+"?username="+encodeURIComponent(username),error:_.bind(function(xhr){this.handleErrorResponse(xhr,"There was an error removing watcher")},this)})}});var AbstractWatchersView=Backbone.View.extend({initialize:function(){_.bindAll(this)},renderNoWatchers:function(){if(this.$(".recipients li").length===0){var $empty=AJS.$("<div class='aui-message info watchers-empty' />").html("<span class='aui-icon icon-info' /> "+"There are no watchers.");this.$("fieldset").append($empty)}else{this.$(".watchers-empty").remove()}},render:function(){var deferred=jQuery.Deferred();this.model.fetch().done(_.bind(function(){this._render();this.renderNoWatchers();deferred.resolve(this.$el);window.setTimeout(_.bind(function(){this.focus()},this),0)},this));return deferred.promise()},watch:function(){AJS.$("#watching-toggle").text("Stop watching this issue")},unwatch:function(){AJS.$("#watching-toggle").text("Start watching this issue")},focus:AJS.$.noop,_incrementWatcherCount:function(){var $el=AJS.$("#watcher-data");var currentCount=parseInt($el.text(),10);$el.text(currentCount+1);this.renderNoWatchers()},_decrementWatcherCount:function(){var $el=AJS.$("#watcher-data");var currentCount=parseInt($el.text(),10);$el.text(currentCount-1);this.renderNoWatchers()}});var WatchersView=AbstractWatchersView.extend({events:{selected:"addWatcherToModel",unselect:"removeWatcherFromModel"},_render:function(){this.$el.html(JIRA.Templates.Issue.watchersWithBrowse(this.model.toJSON()));var picker=new JIRA.MultiUserListPicker({element:this.$el.find(".watchers-user-picker"),width:220})},focus:function(){this.$el.find("#watchers-textarea").focus()},addWatcherToModel:function(e,descriptor){e.preventDefault();this.model.addWatcher(descriptor.value()).done(_.bind(function(){this._incrementWatcherCount();if(descriptor.value()===AJS.Meta.get("remote-user")){this.watch()}},this))},removeWatcherFromModel:function(e,descriptor){this.model.removeWatcher(descriptor.value()).done(_.bind(function(){this._decrementWatcherCount();if(descriptor.value()===AJS.Meta.get("remote-user")){this.unwatch();JIRA.trace("jira.issue.watcher.deleted")}},this))}});var WatchersNoBrowseView=AbstractWatchersView.extend({events:{"click .remove-recipient":"removeWatcher","submit":"addWatcher"},addWatcher:function(e){e.preventDefault();this.removeInlineError();var $field=AJS.$("#watchers-nosearch");var username=AJS.$.trim(AJS.$("#watchers-nosearch").val());$field.attr("disabled","disabled");if(this.hasUsername(username)){$field.removeAttr("disabled");this.showInlineError(AJS.format("User {0} is already watching this issue",username));$field.val("")}else{this.model.getUser(username).done(_.bind(function(data){var html=JIRA.Templates.Fields.recipientUsername({icon:data.avatarUrls["16x16"],username:data.name,displayName:data.displayName});if(username===AJS.Meta.get("remote-user")){this.watch()}$field.val("");this.$(".watchers").append(html);this.model.addWatcher(data.name);this._incrementWatcherCount()},this)).fail(_.bind(function(xhr){if(xhr.status===404){this.showInlineError("User does not exist")}},this)).always(function(){$field.removeAttr("disabled").focus()})}},hasUsername:function(username){var result=false;this.$(".watchers li").each(function(){if(AJS.$(this).attr("data-username")===username){result=true;return false}});return result},removeInlineError:function(){this.$(".error").remove()},showInlineError:function(msg){AJS.$("<div />").addClass("error").text(msg).insertAfter(this.$(".description"))},focus:function(){AJS.$("#watchers-nosearch").focus()},removeWatcher:function(e){e.preventDefault();var $item=AJS.$(e.target).closest("li");var username=$item.attr("data-username");if(username){$item.remove();this.model.removeWatcher(username);this._decrementWatcherCount();if(username===AJS.Meta.get("remote-user")){this.unwatch()}}JIRA.trace("jira.issue.watcher.deleted")},_render:function(){this.$el.html(JIRA.Templates.Issue.watchersNoBrowse(this.model.toJSON()))}});var WatchersReadOnly=AbstractWatchersView.extend({_render:function(){this.$el.html(JIRA.Templates.Issue.watchersReadOnly(this.model.toJSON()))}});function getView(model){if(model.get("isReadOnly")){return WatchersReadOnly}else{if(model.get("canBrowseUsers")){return WatchersView}else{return WatchersNoBrowseView}}}var dialog=AJS.InlineDialog("#view-watcher-list","watchers",function(contents,trigger,doShowPopup){var loadingIcon=AJS.$("#watching-toggle").next(".icon");var model=new WatcherModel();loadingIcon.addClass("loading");var view=getView(model);new view({model:model}).render().done(function(viewHtml){contents.html(viewHtml);contents.find(".cancel").click(function(e){dialog.hide();e.preventDefault()});loadingIcon.removeClass("loading");doShowPopup()});model.on("errorOccurred",function(){dialog.hide()})},{width:240,useLiveEvents:true,items:"#view-watcher-list",preHideCallback:function(){return !AJS.InlineLayer.current}});AJS.$(document).bind("keydown",function(e){if(e.keyCode===27&&AJS.InlineDialog.current!=dialog&&dialog.is(":visible")){if(AJS.InlineDialog.current){AJS.InlineDialog.current.hide()}dialog.hide()}});AJS.$(document).click(function(e){var currentDialog=AJS.InlineDialog.current;if(currentDialog&&currentDialog.id==="watchers"){if(!jQuery(e.target).closest("#inline-dialog-watchers, #watchers-suggestions").length){currentDialog.hide()}}});AJS.$(document).bind("showLayer",function(e,type,hash){if(type&&type==="inlineDialog"&&hash&&hash.id&&hash.id==="watchers"){AJS.$("body").unbind("click.watchers.inline-dialog-check")}})});
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/ViewIssueTabs.js' */
JIRA.ViewIssueTabs=(function(){var useHistoryApi=AJS.Meta.get("viewissue-use-history-api")!==false;var AJAX_LOAD_CLASS="ajax-activity-content";var AJAX_LINK_SELECTOR=AJS.format("a.{0}",AJAX_LOAD_CLASS);var issueTabLoadedListeners=[];var $tabWrapper,$tabContents;var xhrInProgress;function dispatchIssueTabLoadedEvent(container){container=container||document;AJS.$.each(issueTabLoadedListeners,function(i,fn){fn(container)})}function bindToTabDivs(container){var $newTabWrapper=AJS.$(container).find(".issuePanelWrapper");var $newTabContents=AJS.$(container).find("#issue_actions_container");$tabContents=$newTabContents.length?$newTabContents:$tabContents;$tabWrapper=$newTabWrapper.length?$newTabWrapper:$tabWrapper}function dispatchIssueTabErrorEvent(smartAjaxResult,activeTabKey){var errorPopup=new JIRA.FormDialog({id:"issue-tab-error-dialog",widthClass:"small",content:JIRA.SmartAjax.buildDialogErrorContent(smartAjaxResult,false)});setActiveTab(activeTabKey);$tabContents.show();errorPopup.show()}function setActiveTab(activeTabKey){AJS.$("#issue-tabs li").each(function(){var $li=AJS.$(this);var tabKey=$li.data("key");var labelHtml=AJS.format("<strong>{0}</strong>",$li.data("label"));if(tabKey==activeTabKey){$li.addClass("active");$li.html(labelHtml)}else{$li.removeClass("active");var id=$li.data("id");var href=$li.data("href");$li.html(AJS.format('<a id="{0}" href="{1}" class="{2}">{3}</a>',id,href,AJAX_LOAD_CLASS,labelHtml))}});enableAjaxOnLinks(AJS.$("#issue-tabs"))}function putTabInLoadingState(activeTabKey){setActiveTab(activeTabKey)}function enableAjaxOnLinks(context){var activeTabKey=AJS.$(context).find("li.active").data("key");AJS.$(context).find(AJAX_LINK_SELECTOR).click(function(event){if(event.metaKey){return }event.preventDefault();if(xhrInProgress){xhrInProgress.abort()}var $a=AJS.$(this);var containerID="#activitymodule div.mod-content";var loadingTabKey=$a.parent().data("key");if(loadingTabKey){putTabInLoadingState(loadingTabKey)}var xhr=JIRA.SmartAjax.makeRequest({jqueryAjaxFn:useHistoryApi?AJS.$.pjax:AJS.$.ajax,headers:{"X-PJAX":true},container:containerID,url:$a.attr("href"),timeout:null,complete:function(xhr,status,smartAjaxResult){if(status!="abort"){xhrInProgress=null;if(!smartAjaxResult.successful){if(smartAjaxResult.status<300||smartAjaxResult.status>=400){dispatchIssueTabErrorEvent(smartAjaxResult,activeTabKey)}return }var container=AJS.$(containerID);var newElements=AJS.$(smartAjaxResult.data);if(!useHistoryApi){smartUpdate(container,newElements)}dispatchIssueTabLoadedEvent(container);JIRA.trace("jira.issue.tab.loaded")}}});jQuery(xhr).throbber({target:$tabWrapper});xhrInProgress=xhr})}function smartUpdate(container,newElements){var newTabs=newElements.filter(".tabwrap");var oldTabs=container.find(".tabwrap");var newContents=newElements.find(".issuePanelContainer");var oldContents=$tabContents.contents();if(newTabs.length&&oldTabs.length&&newContents.length&&oldContents.length){oldTabs.replaceWith(newTabs);$tabContents.append(newContents);var newContentHeight=newContents.height();var visibleHeightDifference=AJS.$(window).scrollTop()+AJS.$(window).height()-($tabContents.offset().top+newContentHeight);if(visibleHeightDifference>0){$tabContents.css("height",newContentHeight+visibleHeightDifference);oldContents.remove();var preDelay=150;setTimeout(function(){var pixelsPerSecond=500;var animSpeed=visibleHeightDifference/pixelsPerSecond*1000;$tabContents.animate({height:newContentHeight},animSpeed,"easeOutQuart",function(){$tabContents.css("height","auto")})},preDelay)}else{$tabContents.empty().append(newContents)}newElements.filter("script").each(function(){AJS.$.globalEval(this.text||this.textContent||this.innerHTML||"")})}else{container.empty().append(newElements)}}function appendHashCodeToLinks(context){AJS.$(context).find(AJAX_LINK_SELECTOR).each(function(){var $a=AJS.$(this);$a.attr("href",$a.attr("href")+"#issue-tabs")})}function processActivityModuleLinks(context){if(!useHistoryApi||AJS.$.support.pjax){enableAjaxOnLinks(context)}else{appendHashCodeToLinks(context)}}function setupMouseoverBehaviour(context){if(jQuery.browser.msie&&parseInt(jQuery.browser.version,10)===7){jQuery("a.twixi",context).bind("focus",function(e){e.preventDefault()})}else{jQuery(context).bind("moveToFinished",function(event,target){jQuery("a.twixi:visible",target).focus()})}}function initLivestamp(context){context.find("time.livestamp").livestamp()}function onTabReady(listener){if(jQuery.inArray(listener,issueTabLoadedListeners)<0){issueTabLoadedListeners.push(listener)}}onTabReady(bindToTabDivs);onTabReady(processActivityModuleLinks);onTabReady(setupMouseoverBehaviour);onTabReady(JIRA.userhover);onTabReady(initLivestamp);return{onTabReady:onTabReady,domReady:dispatchIssueTabLoadedEvent}})();AJS.$(function(){if(JIRA.Events.PANEL_REFRESHED){JIRA.bind(JIRA.Events.PANEL_REFRESHED,function(e,panel,$new,$existing){if(panel==="activitymodule"){var $focusedTab=$existing.find("#issue_actions_container > .issue-data-block.focused");if($focusedTab.length===1){$new.find("#"+$focusedTab.attr("id")).addClass("focused")}}})}});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(event,$el){JIRA.ViewIssueTabs.domReady($el)});
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/WatchersAndVoters.js' */
AJS.$(function(){var toggleVotingAndWatching=function(trigger,className,resultContainer,issueOpTrigger,i18n){var classNameOn=className+"-on",classNameOff=className+"-off",restPath="/voters",spinner=trigger.next(".icon"),data,method="POST";if(trigger.hasClass(classNameOn)){method="DELETE"}if(className.indexOf("watch")!==-1){restPath="/watchers"}trigger.removeClass(classNameOn).removeClass(classNameOff);if(method==="POST"){data={dummy:true}}AJS.$(JIRA.SmartAjax.makeRequest({url:contextPath+"/rest/api/1.0/issues/"+trigger.attr("rel")+restPath,type:method,dataType:"json",data:data,contentType:"application/json",complete:function(xhr,textStatus,smartAjaxResult){var optIn=method==="POST";if(smartAjaxResult.successful){if(optIn){trigger.addClass(classNameOn);trigger.text(i18n.titleOn);issueOpTrigger.attr("title",i18n.titleOn).text(i18n.textOn)}else{trigger.addClass(classNameOff);trigger.text(i18n.titleOff);issueOpTrigger.attr("title",i18n.titleOff).text(i18n.textOff)}resultContainer.text(smartAjaxResult.data.count);resultContainer[optIn?"addClass":"removeClass"](classNameOn);resultContainer[optIn?"removeClass":"addClass"](classNameOff)}else{if(!smartAjaxResult.aborted){alert(JIRA.SmartAjax.buildSimpleErrorContent(smartAjaxResult,{alert:true}))}if(optIn){trigger.addClass(classNameOff);trigger.text(i18n.titleOff);issueOpTrigger.attr("title",i18n.titleOff).text(i18n.textOff)}else{trigger.addClass(classNameOn);trigger.text(i18n.titleOn);issueOpTrigger.attr("title",i18n.titleOn).text(i18n.textOn)}}}})).throbber({target:spinner})};AJS.$(document).delegate(".toggle-vote-issue","click",function(e){e.preventDefault();AJS.$("#vote-toggle").click()});AJS.$(document).delegate("#toggle-watch-issue","click",function(e){e.preventDefault();AJS.$("#watching-toggle").click()});var addI18nErrorCodes=function(i18n){AJS.$("input[type=hidden][id|=error]").each(function(index,elem){var i18n_id=elem.id.replace("error-","");i18n[i18n_id]=elem.value})};AJS.$(document).delegate("#vote-toggle","click",function(e){e.preventDefault();var i18n={titleOn:"Remove vote for this issue",titleOff:"Vote for this issue",textOn:"Remove Vote",textOff:"Add Vote",actionTextOff:"Vote",actionTextOn:"Voted"};addI18nErrorCodes(i18n);toggleVotingAndWatching(AJS.$(this),"vote-state",AJS.$("#vote-data"),AJS.$("#toggle-vote-issue"),i18n)});AJS.$(document).delegate("#watching-toggle","click",function(e){e.preventDefault();var i18n={titleOn:"Stop watching this issue",titleOff:"Start watching this issue",textOn:"Stop Watching",textOff:"Watch Issue",actionTextOff:"Watch",actionTextOn:"Watching"};addI18nErrorCodes(i18n);toggleVotingAndWatching(AJS.$(this),"watch-state",AJS.$("#watcher-data"),AJS.$("#toggle-watch-issue"),i18n)})});
/* module-key = 'jira.webresources:mark-and-quote-module', location = '/includes/jira/issue/markAndQuote.js' */
AJS.namespace("JIRA.Issue.Quote");(function initializeQuotes($){function onClick(event){JIRA.Issue.Quote.triggerQuoteButton({x:event.pageX,y:event.pageY})}JIRA.Issue.Quote.isEnabled=function isEnabled(){if(JIRA.Issue.Quote.enabled==null){AJS.$.ajax({url:contextPath+"/rest/api/2/mypreferences?key=mark-and-quote",type:"GET",contentType:"application/json",dataType:"json",async:false,success:function retrieveState(data,status){JIRA.Issue.Quote.enabled=data},error:function logError(xhr,status){JIRA.Issue.Quote.enabled=xhr.statusText=="Not Found"}})}return JIRA.Issue.Quote.enabled};JIRA.Issue.Quote.setEnabled=function setEnabled(whether){if(JIRA.Issue.Quote.enabled!=whether){JIRA.Issue.Quote.enabled=whether;AJS.$.ajax({url:contextPath+"/rest/api/2/mypreferences?key=mark-and-quote",type:"PUT",contentType:"application/json",dataType:"json",data:whether?"true":"false"})}};JIRA.Issue.Quote.getSelectedText=function getSelectedText(){function enclosing(elem){return elem.closest(".action-body, #description-val")}var text="";if(window.getSelection){text=window.getSelection()}else{if(document.getSelection){text=document.getSelection()}}if(text){var base=enclosing($(text.baseNode?text.baseNode.parentElement:text.anchorNode.parentNode));var extent=enclosing($(text.extentNode?text.extentNode.parentElement:text.focusNode.parentNode));if(base&&extent){if(base.length==0||extent.length==0||base[0]!=extent[0]){text=""}}}return $.trim(text.toString())};JIRA.Issue.Quote.triggerQuoteButton=function triggerQuoteButton(coords){var selectedText=JIRA.Issue.Quote.getSelectedText();if(selectedText){JIRA.Issue.Quote.selectedText=selectedText;JIRA.Issue.Quote.show(coords);setTimeout(function(){$("body").one("click",JIRA.Issue.Quote.hide)},200)}};JIRA.Issue.Quote.canComment=function canComment(){var hasCommentRights=($("#comment-issue").length==1);var isWikiMarkupOn=JIRA.Issue.CommentForm.getForm().find("#comment-preview_link").length==1;return hasCommentRights&&isWikiMarkupOn};JIRA.Issue.Quote.createButton=function createButton(within){JIRA.Issue.Quote.popup=$(JIRA.Templates.Issue.MarkAndQuote.popup({popupClass:"mark-and-quote-popup",buttonClass:"mark-and-quote-button",buttonText:" "+"Quote",disableLinkClass:"mark-and-quote-turn-off",disableLinkText:"Disable this"}));JIRA.Issue.Quote.popup[0].popup={persistent:true};within.append(JIRA.Issue.Quote.popup);JIRA.Issue.Quote.popup.find(".mark-and-quote-button").on("click",JIRA.Issue.Quote.buttonClick);JIRA.Issue.Quote.popup.find(".mark-and-quote-turn-off").on("click",function disableMarkAndQuote(e){e.preventDefault();JIRA.Issue.Quote.setEnabled(false);JIRA.Issue.Quote.displayDisabledState(JIRA.Issue.CommentForm.getForm().find(".field-group.comment-input"));JIRA.Issue.Quote.triggerAnalyticsEvent("disabled")})};JIRA.Issue.Quote.displayDisabledState=function displayDisabledState(within){var disabledInfoClass="mark-and-quote-disabled-info";var disabledInfoClassSelector="."+disabledInfoClass;if(within.find(disabledInfoClassSelector).length==1){return }if(within&&!JIRA.Issue.Quote.isEnabled()&&JIRA.Issue.Quote.canComment()){var element=$(JIRA.Templates.Issue.MarkAndQuote.disabledInfo({className:disabledInfoClass,infoText:"Mark quoting is disabled",linkClass:"mark-and-quote-reenable",linkText:"Enable"}));element.find(".mark-and-quote-reenable").on("click",function(e){e.preventDefault();within.find(disabledInfoClassSelector).remove();JIRA.Issue.Quote.setEnabled(true);JIRA.Issue.Quote.triggerAnalyticsEvent("enabled")});within.append(element)}};JIRA.Issue.Quote.handleContentAdded=function handleContentAdded(context,reason){context.each(function hookOnClicks(){var ctx=$(this);ctx.find("#issue_actions_container").on("mouseup dblclick",".activity-comment.expanded",onClick);ctx.find("#description-val").on("mouseup dblclick",onClick)});context.each(function displayDisabledState(){JIRA.Issue.CommentForm.getForm().find(".field-group.comment-input").each(function(){JIRA.Issue.Quote.displayDisabledState($(this))})});if(reason=="pageLoad"){AJS.whenIType("q").execute(JIRA.Issue.Quote.buttonClick);if(JIRA.Issue.Quote.popup==null){JIRA.Issue.Quote.createButton($("body"))}}};JIRA.Issue.Quote.show=function showButton(coords){if(JIRA.Issue.Quote.canComment()&&JIRA.Issue.Quote.isEnabled()){JIRA.Issue.Quote.popup.removeClass("hidden").css({top:coords.y+15,left:coords.x-35});JIRA.Issue.Quote.triggerAnalyticsEvent("displayed")}};JIRA.Issue.Quote.hide=function hideButton(){if(JIRA.Issue.Quote.popup){JIRA.Issue.Quote.popup.addClass("hidden")}$("body").off("click",JIRA.Issue.Quote.hide)};JIRA.Issue.Quote.openComment=function openComment(){$("#comment-issue").trigger("click")};JIRA.Issue.Quote.buttonClick=function buttonClick(){if(JIRA.Issue.Quote.selectedText&&JIRA.Issue.Quote.canComment()){JIRA.Issue.Quote.triggerAnalyticsEvent("used");JIRA.Issue.Quote.openComment();var commentField=$("#comment");if(commentField.length==0){setTimeout(JIRA.Issue.Quote.buttonClick,0)}else{var newValue=commentField.val()+"{quote}"+JIRA.Issue.Quote.selectedText+"{quote}\n";commentField.val(newValue)}}JIRA.Issue.Quote.selectedText=null};JIRA.Issue.Quote.triggerAnalyticsEvent=function analytics(eventName){AJS.trigger("analyticsEvent",{name:"jira.markAndQuote",data:{type:eventName}})};JIRA.Issue.Quote.popup=null;JIRA.Issue.Quote.selectedText=null;JIRA.Issue.Quote.enabled=null})(AJS.$);
/* module-key = 'jira.webresources:mark-and-quote-module', location = '/includes/templates/jira/issue/markAndQuote.soy' */
// This file was automatically generated from markAndQuote.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Issue == 'undefined') { JIRA.Templates.Issue = {}; }
if (typeof JIRA.Templates.Issue.MarkAndQuote == 'undefined') { JIRA.Templates.Issue.MarkAndQuote = {}; }


JIRA.Templates.Issue.MarkAndQuote.popup = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="inline-dialog-mark-and-quote" class="aui-inline-dialog hidden ', soy.$$escapeHtml(opt_data.popupClass), '"><div class="contents"><div>');
  aui.buttons.button({text: opt_data.buttonText, tagName: 'a', extraClasses: opt_data.buttonClass, iconType: 'aui', iconClass: 'aui-icon-small mark-and-quote-icon icon-comment'}, output);
  output.append('</div><div><a href="#" class="', soy.$$escapeHtml(opt_data.disableLinkClass), '">', soy.$$escapeHtml(opt_data.disableLinkText), '</a></div></div><div id="arrow-mark-and-quote" class="arrow aui-css-arrow"/></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.MarkAndQuote.disabledInfo = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="', soy.$$escapeHtml(opt_data.className), '">', soy.$$escapeHtml(opt_data.infoText), '   <a href="#" class="', soy.$$escapeHtml(opt_data.linkClass), '">', soy.$$escapeHtml(opt_data.linkText), '</a></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'jira.webresources:mark-and-quote-resources', location = '/includes/jira/issue/initMarkAndQuote.js' */
if((!AJS.$("html").hasClass("msie")||AJS.$("html").hasClass("msie-gt-8"))&&AJS.DarkFeatures.isEnabled("com.atlassian.jira.mark-and-quote")){JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){JIRA.Issue.Quote.handleContentAdded(context,reason)})};
/* module-key = 'jira.webresources:attach-screenshot-resources', location = '/includes/jira/issue/attachScreenshot.js' */
AJS.namespace("JIRA.Issue.AttachScreenshot");(function initializeAttachScreenshot(){AJS.EventQueue=AJS.EventQueue||[];AJS.$(document).on("click","#attach-screenshot",function(){AJS.EventQueue.push({name:"attach.screenshot.display",properties:{}})})})();
/* module-key = 'com.atlassian.jira.plugins.jira-bitbucket-connector-plugin:requiredResourceForAjaxCommitsTab', location = 'javascripts/dvcs-tabs.js' */
if(typeof(com)=="undefined"){com={}}if(typeof(com.atlassian)=="undefined"){com.atlassian={}}if(typeof(com.atlassian.jira)=="undefined"){com.atlassian.jira={}}if(typeof(com.atlassian.jira.dvcs)=="undefined"){com.atlassian.jira.dvcs={}}com.atlassian.jira.dvcs.showChangesetByFork=function(d,b,c,a){AJS.$("#"+d+" .CommitPanel").each(function(f,e){AJS.$(e).hide()});AJS.$("#"+d+"-"+b).show();com.atlassian.jira.dvcs.registerForksTooltip(d,c,a)};com.atlassian.jira.dvcs.registerForksTooltip=function(c,b,a){com.atlassian.jira.dvcs.registerInlineDialogTooltip(AJS.$("#fork-drop-down-"+c),"This changeset is present in multiple repositories (forks). Currently showing <a href='"+a+"' target='_blank'>"+b+"</a>.")};com.atlassian.jira.dvcs.registerInlineDialogTooltip=function(b,a){AJS.InlineDialog(AJS.$(b),"tooltip_"+AJS.$(b).attr("id"),function(d,c,e){d.css({padding:"10px"}).html(a);e();return false},{onHover:true,hideDelay:200,showDelay:1000,arrowOffsetX:-8,offsetX:-80,addActiveClass:false})};AJS.$(document).on("click","#dvcs-commits-tabpanel.ajax-activity-content",function(a){AJS.trigger("analyticsEvent",{name:"jira.dvcsconnector.issue.tabclick"})});AJS.$(document).on("click",".dvcs-link",function(a){AJS.trigger("analyticsEvent",{name:"jira.dvcsconnector.issue.linkclick",data:{type:AJS.$(this).attr("data-link-type")}})});
/* module-key = 'com.atlassian.jira.jira-view-issue-plugin:draggableattachment', location = 'viewissue/initDraggableAttachment.js' */
(function($) {
    $.event.props.push("dataTransfer");

    $('[draggable=true]').live("dragstart", function(evt) {
        var $this = AJS.$(this);
        var dataTransfer = evt.dataTransfer;
        dataTransfer.effectAllowed = 'copy';
        dataTransfer.dropEffect = 'copy';
        dataTransfer.setData("DownloadURL", $this.data('downloadurl'));
        if (!$this.find('img').length) {
            dataTransfer.setDragImage($this.closest('li').find('img:visible')[0], 8, 8);
        }
    });
})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-view-issue-plugin:expandablecomments', location = 'viewissue/comments-expanding.js' */
AJS.$(function($) {
    $(document).on('simpleClick', '.collapsed-comments', function(e) {
        e.preventDefault();

        var collapsedLink = $(this);
        var collapsedLinkBlock = collapsedLink.closest('.message-container');
        var container = collapsedLink.closest('.issuePanelContainer');
        var module = collapsedLink.closest('.module');
        var numCommentsBefore = collapsedLinkBlock.prevAll('.activity-comment').length;
        var numCollapsed = collapsedLink.find('.show-more-comments').data('collapsed-count');

        showLoading();
        makeRequest();

        function showLoading() {
            collapsedLink.find('.show-more-comments').text("Loading...");
        }

        function makeRequest() {
            var url = collapsedLink.attr('href');
            JIRA.SmartAjax.makeRequest({
                url: url,
                method: 'GET',
                headers: { "X-PJAX": true } // needed for the ViewIssue action to return only the activity panel
            }).done(showCollapsed);
        }

        function showCollapsed(html) {
            var commentsToShow = $(html).find('.activity-comment').slice(numCommentsBefore, numCommentsBefore + numCollapsed);
            collapsedLinkBlock.replaceWith(commentsToShow);
            JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED, [module, JIRA.CONTENT_ADDED_REASON.panelRefreshed]);

            // Expand the twixi for the first comment
            container.find('.activity-comment:first').removeClass('collapsed').addClass('expanded');
        }
    });
});

/* module-key = 'com.atlassian.plugins.helptips.jira-help-tips:common', location = 'js/HelpTip.js' */
(function(E){function A(){return false
}function C(){return true
}var J=0,F=new Date().getTime();
function G(L){L=""+(L||"");
return L.replace(/\./g,"-")
}function I(M,L){if(AJS.EventQueue&&L&&L.attributes.id){var O={};
var N=G(L.attributes.id);
O.name="helptips."+N+"."+M;
O.properties={};
AJS.EventQueue.push(O)
}}function B(){return"c"+F+(J++)
}var D=AJS.HelpTip=function(L){var M;
this.attributes=E.extend({},L);
this.attributes.id||(this.attributes.id=false);
this.attributes.callbacks||(this.attributes.callbacks={});
if(this.attributes.isSequence){if(!this.attributes.weight){this.attributes.weight=Number.MAX_VALUE
}AJS.HelpTip.Manager.sequences.push(this)
}if(this.attributes.body){this.attributes.bodyHtml=this.attributes.body;
delete this.attributes.body
}this.cid=B();
M=this.attributes.anchor;
delete this.attributes.anchor;
this.view=(M)?new H(this,M):new K(this);
this.view.$el.addClass("aui-help-tip")
};
E.extend(D.prototype,{show:function(N){N=N||{};
var M=this;
var O=E.Deferred();
if(this.attributes.callbacks.beforeShow){var L=this.attributes.callbacks.beforeShow();
if(L&&_.isFunction(L.done)){L.done(O.resolve)
}else{O.resolve()
}}else{O.resolve()
}O.done(function(){AJS.HelpTip.Manager.show(function(){if(!M.isDismissed()){if(!N.force&&AJS.Popups&&AJS.Popups.DisplayController){AJS.Popups.DisplayController.request({name:M.id,weight:1000,show:function(){M.view.show()
}})
}else{M.view.show()
}I("shown",M)
}})
})
},dismiss:function(){var L=G(arguments[0]||"programmatically");
this.view.dismiss();
if(L==="close-button"&&this.attributes.isSequence){AJS.HelpTip.Manager.clearSequences()
}if(!this.isDismissed()){AJS.HelpTip.Manager.dismiss(this);
I("dismissed."+L,this)
}},isVisible:function(){return this.view.$el.is(":visible")
},isDismissed:function(){return AJS.HelpTip.Manager.isDismissed(this)
}});
var H=function(M,L){this.initialize(M,L)
};
E.extend(H.prototype,{initialize:function(N,M){var L=this;
this.model=N;
this.beforeHide=A;
this.popup=AJS.InlineDialog(M,N.cid,_.bind(this._createDialog,this),_.extend({container:"#content",noBind:true,preHideCallback:function(){return L.beforeHide()
},calculatePositions:function(O,R,T,Q){var P=AJS.InlineDialog.opts.calculatePositions(O,R,T,Q);
var S=E(this.container);
P.popupCss.top-=S.offset().top;
P.popupCss.left-=S.offset().left;
return P
},addActiveClass:false,initCallback:N.attributes.callbacks.init,hideCallback:N.attributes.callbacks.hide},N.attributes.inlineDialogOpts));
this._popupHide=this.popup.hide;
this.popup.hide=A;
this.$el=E(this.popup[0]);
AJS.$(document).bind("showLayer",function(Q,P,O){if(P==="inlineDialog"&&O.id===N.cid){AJS.InlineDialog.current=null;
AJS.$(document.body).unbind("click."+N.cid+".inline-dialog-check");
O._validateClickToClose=A;
O.hide=A
}})
},show:function(){this.popup.show()
},dismiss:function(){this.beforeHide=C;
this._popupHide()
},_createDialog:function(Q,O,N){var M=this;
var P=AJS.HelpTip.Manager.sequences;
var L=this.model.attributes.position;
Q.html(E(AJS.Templates.HelpTip.tipContent(_.extend({hasSequence:(P.length>1&&(L+1<P.length)),length:P.length,position:L},this.model.attributes))));
Q.unbind("mouseover mouseout");
Q.find(".helptip-link").click(function(){I("learn-more.clicked",M.model)
});
Q.find(".helptip-close").click(function(R){R.preventDefault();
M.model.dismiss("close-button")
});
Q.find(".helptip-next").click(function(S){S.preventDefault();
M.model.dismiss("next-button");
var R=L+1;
P[R]&&(P[R].show({force:true}))
});
N()
}});
var K=function(L){this.initialize(L)
};
E.extend(K.prototype,{initialize:function(){this.$el=E("<div></div>")
},show:function(){},dismiss:function(){}})
})(AJS.$);
/* module-key = 'com.atlassian.plugins.helptips.jira-help-tips:common', location = 'js/HelpTipManager.js' */
(function(C){var B=AJS.contextPath()+"/rest/helptips/1.0/tips";
var A={dismissedTipIds:[],sequences:[],loaded:C.Deferred(),url:function(){return B
},sync:function(E,D){E||(E="get");
D||(D=null);
return C.ajax(this.url(),{type:E,context:this,dataType:"json",contentType:"application/json",data:D&&JSON.stringify(D),processData:false}).promise()
},fetch:function(){var D=this.sync();
D.done(function(E){C.merge(this.dismissedTipIds,E);
this.loaded.resolve()
});
return D.promise()
},show:function(D){this.loaded.done(D)
},dismiss:function(D){var E=D.attributes.id;
if(!E){D._dismissed=true
}else{this.dismissedTipIds.push(E);
this.sync("post",{id:E})
}},undismiss:function(D){var E=D.attributes.id;
if(!E){D._dismissed=false
}else{this.dismissedTipIds.splice(C.inArray(E,this.dismissedTipIds),1);
this.sync("delete",{id:E})
}},isDismissed:function(D){var E=D.attributes.id;
return(E)?C.inArray(E,this.dismissedTipIds)>=0:D._dismissed
},clearSequences:function(){this.sequences=[]
},hideSequences:function(){_.each(this.sequences,function(D){D.view.dismiss()
})
},showSequences:function(){if(!this._showStarted){var D=this;
var E=0;
this._showStarted=true;
C.when(this.loaded).done(function(){D.sequences.sort(function(G,F){return G.attributes.weight-F.attributes.weight
});
D.sequences=_.filter(D.sequences,function(G){var F=_.indexOf(D.dismissedTipIds,G.attributes.id)===-1;
if(F){G.attributes.position=E++
}return F
});
if(D.sequences.length>0){D.sequences[0].show({force:true})
}D._showStarted=false
})
}}};
AJS.HelpTip.Manager=A;
A.fetch()
})(AJS.$);
/* module-key = 'com.atlassian.plugins.helptips.jira-help-tips:common', location = 'templates/HelpTip.soy' */
// This file was automatically generated from HelpTip.soy.
// Please don't edit this file by hand.

if (typeof AJS == 'undefined') { var AJS = {}; }
if (typeof AJS.Templates == 'undefined') { AJS.Templates = {}; }
if (typeof AJS.Templates.HelpTip == 'undefined') { AJS.Templates.HelpTip = {}; }


AJS.Templates.HelpTip.tipContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.title) ? '<h2 class="helptip-title">' + soy.$$escapeHtml(opt_data.title) + '</h2>' : '', '<p class="helptip-body">', opt_data.bodyHtml, '</p>', (opt_data.url) ? '<p><a class="helptip-link" href="' + soy.$$escapeHtml(opt_data.url) + '" target="_blank">' + ((opt_data.linkText) ? soy.$$escapeHtml(opt_data.linkText) : soy.$$escapeHtml("Learn more")) + '</a></p>' : '');
  AJS.Templates.HelpTip.tipFooter(opt_data, output);
  return opt_sb ? '' : output.toString();
};


AJS.Templates.HelpTip.tipFooter = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form class="tip-footer">');
  AJS.Templates.HelpTip.nextButton(opt_data, output);
  AJS.Templates.HelpTip.closeButton(opt_data, output);
  AJS.Templates.HelpTip.sequencePaging(opt_data, output);
  output.append('</form>');
  return opt_sb ? '' : output.toString();
};


AJS.Templates.HelpTip.nextButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.hasSequence) ? '<button class="aui-button helptip-next" type="button">' + soy.$$escapeHtml("Next") + '</button>' : '');
  return opt_sb ? '' : output.toString();
};


AJS.Templates.HelpTip.closeButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<button class="aui-button ', (opt_data.hasSequence) ? ' aui-button-link ' : '', ' helptip-close" type="button">', soy.$$escapeHtml("Close"), '</button>');
  return opt_sb ? '' : output.toString();
};


AJS.Templates.HelpTip.sequencePaging = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.length > 1) ? '<span class="helptip-sequence-paging">' + soy.$$escapeHtml(opt_data.position + 1) + '/' + soy.$$escapeHtml(opt_data.length) + '</span>' : '');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-cta-dialog-plain-resources', location = 'js/viewissue/devstatus-cta-dialog.js' */
(function(d,c){AJS.namespace("JIRA.DevStatus.CtaDialog");var m="devstatus-cta-dialog",j="a.devstatus-cta-link",b=".devstatus-cta-link-text",k="#viewissue-devstatus-panel",h=".issue-container";function l(p,q){var o=jQuery.Deferred();c.SmartAjax.makeRequest({url:contextPath+"/rest/dev-status/1.0/issue/targets?cta="+encodeURIComponent(p)+"&issueId="+encodeURIComponent(q),complete:function(s,t,r){if(r.successful){o.resolve(r.data)}else{o.reject(c.SmartAjax.buildDialogErrorContent(r).html())}}});return o.promise()}function g(o){return c.Templates.DevStatus.Dialog.content(o)}function f(q){var p=q.attr("href"),o=p&&/\#([a-zA-Z\.]+)/.exec(p);return o&&o[1]}function i(o){return o.data("issueid")||c.Issue.getIssueId()}function n(o){return o.remoteApps.length===1&&o.remoteApps[0]}function e(){c.DevStatus.CtaDialog.dialog=new c.FormDialog({id:m,width:560,content:function(p){var q=this.$activeTrigger,o=f(q),r=i(q);l(o,r).done(function(s){var t=n(s);if(t){window.location=t.url}else{p(g(s));c.DevStatus.CtaDialog.dialog._focusFirstField("a.target");c.DevStatus.CtaDialogAnalytics.fireCreateBranchEvent("dialog.open")}}).fail(function(s){p(s)})},trigger:j,autoClose:true})}var a=false;c.DevStatus.CtaDialog.initHelptip=function(p){if(p.length>0&&!a){var o=f(p);new AJS.HelpTip({id:o+".tooltip",title:"Start development",bodyHtml:c.Templates.DevStatus.Tooltip.createBranch(),anchor:p.find(b),isSequence:true,inlineDialogOpts:{container:h}});a=true;AJS.HelpTip.Manager.showSequences()}};d(function(){e();c.DevStatus.CtaDialog.initHelptip(d(k).find(j));c.DevStatus.CtaDialogAnalytics.initialize(k,j,m)});c.bind(c.Events.NEW_CONTENT_ADDED,function(p,o){if(o.is(k)){c.DevStatus.CtaDialog.initHelptip(o.find(j))}})})(AJS.$,JIRA);
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-cta-dialog-plain-resources', location = 'templates/viewissue/devstatus-cta-dialog.soy' */
// This file was automatically generated from devstatus-cta-dialog.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.Dialog == 'undefined') { JIRA.Templates.DevStatus.Dialog = {}; }


JIRA.Templates.DevStatus.Dialog.content = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="jira-dialog-heading">', (opt_data.prompt) ? '<h2>' + soy.$$escapeHtml(opt_data.prompt) + '</h2>' : '', '</div><div class="jira-dialog-content"><ul class="targets">');
  var remoteAppList10 = opt_data.remoteApps;
  var remoteAppListLen10 = remoteAppList10.length;
  for (var remoteAppIndex10 = 0; remoteAppIndex10 < remoteAppListLen10; remoteAppIndex10++) {
    var remoteAppData10 = remoteAppList10[remoteAppIndex10];
    output.append('<li>');
    JIRA.Templates.DevStatus.Dialog.remoteApp(remoteAppData10, output);
    output.append('</li>');
  }
  output.append('</ul><div class="buttons-container"><div class="buttons"><button class="aui-button aui-button-link cancel" id="aui-dialog-close">', soy.$$escapeHtml("Cancel"), '</button></div></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.Dialog.remoteApp = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="target" data-application-type="', soy.$$escapeHtml(opt_data.applicationType), '" href="', soy.$$escapeHtml(opt_data.url), '">', (opt_data.iconUrl) ? '<img class="application-icon" src="' + soy.$$escapeHtml(opt_data.iconUrl) + '">' : '<span class="application-icon ' + soy.$$escapeHtml(opt_data.iconClass) + '"></span>', '<div class="title" title="', soy.$$escapeHtml(opt_data.name), '">', soy.$$escapeHtml(opt_data.name), '</div><div class="base-url" title="', soy.$$escapeHtml(opt_data.baseUrl), '">', soy.$$escapeHtml(opt_data.baseUrl), '</div></a>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-cta-tooltip-resources', location = 'templates/viewissue/devstatus-cta-tooltips.soy' */
// This file was automatically generated from devstatus-cta-tooltips.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.Tooltip == 'undefined') { JIRA.Templates.DevStatus.Tooltip = {}; }


JIRA.Templates.DevStatus.Tooltip.createBranch = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.DevStatus.Tooltip.tooltipLayout({extraClasses: 'create-branch', content: '<p>' + soy.$$escapeHtml("Create a branch for this issue in your source repository") + '. <a class="cta-learn-more-link" href="https://www.atlassian.com/git/workflows" target="_blank">' + soy.$$escapeHtml("Learn more about branching strategies") + '.</a></p><p class="branch-illustration"></p>'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.Tooltip.tooltipLayout = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="cta-tooltip', (opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '', '">', opt_data.content, '</div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-analytics-resources', location = 'js/analytics/devstatus-analytics.js' */
(function(d,a){AJS.namespace("JIRA.DevStatus.Analytics");var b=".edit-permission-link";function c(){return AJS.EventQueue&&!AJS.DarkFeatures.isEnabled("jira.plugin.devstatus.analytics.disabled")}a.DevStatus.Analytics={fireEvent:function(e,g){if(c()){var f=(typeof g!=="object")?{}:g;AJS.EventQueue.push({name:"devstatus."+e,properties:f})}}};a.DevStatus.LearnMoreAnalytics={fireLearnMoreEvent:function(e,f){return a.DevStatus.Analytics.fireEvent("learnmore."+e,f)}};a.DevStatus.CtaDialogAnalytics={issueDetails:{},fireCreateBranchEvent:function(e,g){g=(typeof g!=="object")?{}:g;var f=d.extend({issueStatus:this.issueDetails.status,issueType:this.issueDetails.type},g);return a.DevStatus.Analytics.fireEvent("createbranch."+e+"."+(this.issueDetails.isAssignee?"assignee":"nonassignee"),f)},_populateIssueDetails:function(e){this.issueDetails={status:""+e.data("issueStatus"),type:""+e.data("issueType"),isAssignee:e.data("isAssignee")}},_initHandler:function(h,g){if(h.data&&h.data.panelSelector&&g.is(h.data.panelSelector)){var f=h.data.instance;g.find(h.data.linkSelector).on("click",function(){var e=d(this);f._fireCreateBranchEvent(e)})}},_fireCreateBranchEvent:function(e){this._populateIssueDetails(e);this.fireCreateBranchEvent("click")},initialize:function(i,h,f){if(c()){var e=this;var g={instance:e,panelSelector:i,linkSelector:h};a.bind(a.Events.NEW_CONTENT_ADDED,g,this._initHandler);d(h).on("click",function(){var j=d(this);e._fireCreateBranchEvent(j)});d(document).on("click","#"+f+" .jira-dialog-content .target",function(){var j=d(this);e.fireCreateBranchEvent("dialog.click",{title:j.find(".title").attr("title"),applicationType:j.data("applicationType")})});d(document).on("click","#"+f+" .jira-dialog-content button.cancel",function(){e.fireCreateBranchEvent("dialog.cancel")});d(document).on("click",".cta-tooltip .cta-learn-more-link",function(){a.DevStatus.LearnMoreAnalytics.fireLearnMoreEvent("click.ctahelptipbranching")})}}};a.DevStatus.AdminAnalytics={fireAdminEvent:function(e,f){return a.DevStatus.Analytics.fireEvent("admin."+e,f)},initialize:function(){if(c()){var e=this,f=d("#project-config-panel-dev-status");f.find(b).on("click",function(){e.fireAdminEvent("editpermissionlink.config."+(d("ul.permissions-list li.devstatus-admin-permission-item").length>0?"withpermissions":"nopermissions"))});f.find(".learn-more-link").on("click",function(){a.DevStatus.LearnMoreAnalytics.fireLearnMoreEvent("click.adminappvertisementlink")});f.find("#project-config-applinks-connect").on("click",function(){e.fireAdminEvent("connect")});f.find(".devstatus-admin-connect-button-option").on("click",function(){var g=d(this).data("key")||"unknown";e.fireAdminEvent("connect."+g)})}}};a.DevStatus.AdminSummaryAnalytics={initialize:function(){if(c()){d("#project-config-webpanel-devstatus-admin-summary-panel").find(b).on("click",function(){a.DevStatus.AdminAnalytics.fireAdminEvent("editpermissionlink.summary.nopermissions")})}}}})(AJS.$,JIRA);
/* module-key = 'is.origo.jira.tempo-plugin:tempo-resource', location = 'js/jquery.editinplace.js' */
jQuery.fn.editInPlace=function(a){var b={url:"",params:"",field_type:"text",select_options:"",textarea_cols:"25",textarea_rows:"10",bg_over:"#ffc",bg_out:"transparent",saving_text:"Saving...",saving_image:"",default_text:"(Click here to add text)",select_text:"Choose new value",value_required:null,element_id:"element_id",update_value:"update_value",original_html:"original_html",save_button:'<button class="inplace_save">Save</button>',cancel_button:'<button class="inplace_cancel">Cancel</button>',show_buttons:false,on_blur:"save",callback:null,callbackShowErrors:true,success:null,error:function(d){alert("Failed to save value: "+d.responseText||"Unspecified Error")}};if(a){jQuery.extend(b,a)}if(b.saving_image!=""){var c=new Image();c.src=b.saving_image}String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")};String.prototype.escape_html=function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};return this.each(function(){if(jQuery(this).html()==""){jQuery(this).html(b.default_text)}var d=false;var e=jQuery(this);var f=0;jQuery(this).mouseover(function(){jQuery(this).css("background",b.bg_over)}).mouseout(function(){jQuery(this).css("background",b.bg_out)}).click(function(){f++;if(!d){d=true;var m=jQuery(this).html();var q=(b.show_buttons)?b.save_button+" "+b.cancel_button:"";if(m==b.default_text){jQuery(this).html("")}if(b.field_type=="textarea"){var p='<textarea name="inplace_value" class="inplace_field">'+jQuery(this).text().trim().escape_html()+"</textarea>"}else{if(b.field_type=="text"){var p='<input type="text" name="inplace_value" class="inplace_field" value="'+jQuery(this).text().trim().escape_html()+'" />'}else{if(b.field_type=="select"){var n=b.select_options.split(",");var p='<select name="inplace_value" class="inplace_field"><option value="">'+b.select_text+"</option>";for(var l=0;l<n.length;l++){var h=n[l].split(":");var o=h[1]||h[0];var k=o==m?'selected="selected" ':"";p+="<option "+k+'value="'+o.trim().escape_html()+'">'+h[0].trim().escape_html()+"</option>"}p+="</select>"}}}jQuery(this).html('<form class="inplace_form" style="display: inline; margin: 0; padding: 0;">'+p+" "+q+"</form>")}if(f==1){function g(){d=false;f=0;e.css("background",b.bg_out);e.html(m);return false}function j(){e.css("background",b.bg_out);var i=jQuery(this);var s=(i.is("form"))?i.children(0).val():i.parent().children(0).val();if(b.saving_image!=""){var r='<img src="'+b.saving_image+'" alt="Saving..." />'}else{var r=b.saving_text}e.html(r);if(b.params!=""){b.params="&"+b.params}if(b.callback){html=b.callback(e.attr("id"),s,m,b.params);d=false;f=0;if(html){e.html(html||s)}else{if(b.callbackShowErrors){alert("Failed to save value: "+s)}e.html(m)}}else{if(b.value_required&&(s==""||s==undefined)){d=false;f=0;e.html(m);alert("Error: You must enter a value to save this field")}else{jQuery.ajax({url:b.url,type:"POST",data:b.update_value+"="+s+"&"+b.element_id+"="+e.attr("id")+b.params+"&"+b.original_html+"="+m,dataType:"html",complete:function(t){d=false;f=0},success:function(u){var t=u||b.default_text;e.html(t);if(b.success){b.success(u,e)}},error:function(t){e.html(m);if(b.error){b.error(t,e)}}})}}return false}e.children("form").children(".inplace_field").focus().select();e.children("form").children(".inplace_cancel").click(g);e.children("form").children(".inplace_save").click(j);if(!b.show_buttons){if(b.on_blur=="save"){e.children("form").children(".inplace_field").blur(j)}else{e.children("form").children(".inplace_field").blur(g)}}jQuery(document).keyup(function(i){if(i.keyCode==27){g()}});e.children("form").submit(j)}})})};
/* module-key = 'is.origo.jira.tempo-plugin:tempo-resource', location = 'com/tempoplugin/js/tempo.dropdown.js' */
tempo.dropdown=(function(b){function a(){var d=b(this.hash);var e=d.is(":visible");b("div.action-list .box, div.actions-list.box").hide();b("a.open-dropdown").removeClass("active");if(!e){d.show();b(this).addClass("active")}else{d.hide();b(this).removeClass("active")}return false}function c(){b("a.open-dropdown").bind("click",a);b(document).bind("click",function(){var d=b(this);if(!d.is(".action-list *,.open-dropdown,.open-dropdown *")){b("div.action-list .box, div.actions-list.box").hide();b("a.open-dropdown:not(.open-issue)").removeClass("active")}});b("a.open-dropdown:not(.open-issue)").removeClass("active");tempo.widget.Dropdown.create({trigger:".tempo-actions-trigger",ajaxOptions:{dataType:"json",cache:false,formatSuccess:function(d){jiraFragment=tempo.widget.formatSuccess(d);jiraFragment.find("ul:first").remove();return jiraFragment}}})}return{init:c,handler:a}})(AJS.$);
/* module-key = 'is.origo.jira.tempo-plugin:tempo-resource', location = 'com/tempoplugin/js/tempo.ui.js' */
tempo.ui=(function(a){function b(){a("a.tempo-spinner").live("click",function(){tempo.spinner.show()});a("a.no-link").live("click",function(){return false});a("select.tempoDynamicDropDown").live("change",function(){var d=a(this);d.attr("selectedValue",d.val())});var c=window.onbeforeunload;window.onbeforeunload=function(){a("form.tempo-form").fixDirtyForm();if(a.isFunction(c)){return c.call([])}return true}}return{init:b}})(AJS.$);
/* module-key = 'is.origo.jira.tempo-plugin:tempo-resource', location = 'com/tempoplugin/js/tempo.plugins.js' */

/* module-key = 'is.origo.jira.tempo-plugin:tempo-resource', location = 'com/tempoplugin/js/tempo.inplace.js' */
tempo.inplace=(function(c){function b(g){var h=false;AJS.$(g).find("submit-result").each(function(){var i=c(this);if(i.attr("valid")=="false"){i.find("errors").each(function(){var j=c(this);alert(j.find("errorMessage").text())});h=false}else{h=true}});return h}function f(g){return AJS.$("<div/>").text(g).html()}function e(l,k,j,h,i,g){var m=f(k);c.ajax({url:h,async:false,type:"POST",data:i,dataType:"xml",success:function(n){if(!b(n)){return j}else{a(g)}},error:function(n,p,o){alert("Error: "+tempo.extractErrorMessage(n.responseText));return j}});return m}function a(g){if(g){tempo.state.dirty=true}else{tempo.requireReload()}}function d(j,g){j=j||document;var h="Save";var i="Cancel";c("span.tempo-edit-inplace",j).each(function(){var k=c(this);var o=k.hasClass("required");var m=k.attr("data-type")||"text";var l=k.attr("data-key");var n=k.attr("data-resource");if(m!="select"){k.editInPlace({value_required:o,show_buttons:true,save_button:'<a class="inplace_save" title="'+h+'">saveText</a>',cancel_button:'<a class="inplace_cancel" title="'+i+'">cancelText</a>',callbackShowErrors:false,field_type:m,callback:function(s,q,p){var r=e(s,q,p,n,{value:q,attributeKey:l},g);a(g);return c(p).text(q)}})}else{k.bind("click",function(){var p=k.siblings("select");k.hide();p.show()})}});tempo.widget.Dropdown.create({trigger:".tempo-actions-trigger",ajaxOptions:{dataType:"json",cache:false,formatSuccess:function(k){jiraFragment=tempo.widget.formatSuccess(k);jiraFragment.find("ul:first").remove();return jiraFragment}}});var h="Save";var i="Cancel";c("span.editHours",j).editInPlace({value_required:true,show_buttons:true,save_button:'<a class="inplace_save" title="'+h+'">saveText</a>',cancel_button:'<a class="inplace_cancel" title="'+i+'">cancelText</a>',callbackShowErrors:false,field_type:"text",callback:function(o,l,k){var n=c("#"+o).attr("hourtype");var p=o.replace(n+"_","");var m=e(o,l,k,contextPath+"/rest/tempo-rest/1.0/worklogs/hours/update",{worklogId:p,worklogHours:l,hourType:n},g);if(m!=k){a(g);return c(k).text(l)}return m}});c("span.editDesc",j).editInPlace({value_required:true,callbackShowErrors:false,show_buttons:true,save_button:'<a class="inplace_save" title="'+h+'">saveText</a>',cancel_button:'<a class="inplace_cancel" title="'+i+'">cancelText</a>',field_type:"textarea",textarea_rows:3,callback:function(n,l,k){var o=n.replace("comment_","");var m=e(n,l,k,contextPath+"/rest/tempo-rest/1.0/worklogs/description/update",{worklogId:o,worklogDescription:l},g);return c(k).text(l)}});c("span.tempo-calendar-inline",j).each(function(){var l=c(this);var q=l.find(".tempo-calendar-display");var m=l.find(".tempo-calendar-input");var n=l.find(".tempo-calendar-trigger");var p=m.attr("id").replace("date_","");q.editInPlace({value_required:true,callbackShowErrors:false,show_buttons:true,save_button:'<a class="inplace_save" title="'+h+'">saveText</a>',cancel_button:'<a class="inplace_cancel" title="'+i+'">cancelText</a>',field_type:"text",callback:function(u,t,s){return e(u,t,s,contextPath+"/rest/tempo-rest/1.0/worklogs/date/update",{worklogId:p,worklogDate:t},g)}});m.bind("change",function(){e(this,this.value,this.value,contextPath+"/rest/tempo-rest/1.0/worklogs/date/update",{worklogId:p,worklogDate:this.value},g)});var o=l.hasClass("showStartTime");var r=l.hasClass("ISO8061WeekNumbers");var k=tempo.DATE_FORMAT;if(o){k=tempo.DATE_TIME_FORMAT}Calendar.setup({context:l,firstDay:0,displayArea:q.attr("id"),inputField:m.attr("id"),button:n.attr("id"),align:"Tl",singleClick:true,ifFormat:k,daFormat:k,timeFormat:"24",showsTime:o,useISO8601WeekNumbers:r,electric:false})})}return d})(AJS.$);
/* module-key = 'is.origo.jira.tempo-plugin:tempo-resource', location = 'com/tempoplugin/js/tempo.worklogforms.js' */
tempo.worklogforms=(function(a){function d(){var e=new tempo.widget.FormPopup({id:"tempo-split-form-dialog",trigger:"a.worklogaction-tempo-split-worklog",ajaxOptions:{data:{inline:true,decorator:"dialog"}},widthClass:"medium",onContentRefresh:function(){var i=this.get$popupContent();i.bind("split",tempo.submit);a("#issue-split-button",i).bind("click",function(){i.trigger("split");return false});b(i,"split");c("splitIssue");a(".tempo-timepicker",i).tempoTimePicker();a("select.tempo-issue-picker",i).tempoIssuePicker({submitHandler:function(){i.trigger("split")}})}});var h=new tempo.widget.FormPopup({id:"tempo-move-form-dialog",trigger:"a.worklogaction-tempo-move-worklog",ajaxOptions:{data:{inline:true,decorator:"dialog"}},widthClass:"medium",onContentRefresh:function(){var i=this.get$popupContent();i.bind("move",tempo.submit);a("#issue-move-button",i).bind("click",function(){i.trigger("move");return false});b(i,"move");c("moveIssueKey");a(".tempo-timepicker",i).tempoTimePicker();a("select.tempo-issue-picker",i).tempoIssuePicker({submitHandler:function(){i.trigger("move")}})}});var f=new tempo.widget.FormPopup({id:"tempo-delete-form-dialog",trigger:"a.worklogaction-tempo-delete-worklog",ajaxOptions:{data:{inline:true,decorator:"dialog"}},widthClass:"medium"});a("a.delete-worklog").live("click",function(){var j=a("#comment_"+this.id.split("_")[1]).text();var i=confirm(this.title+"\n '"+a.trim(j)+"'");if(i){AJS.$.ajax({async:false,url:this.href,type:"DELETE",success:function(k){tempo.reload()},error:function(k){alert("Error during delete: "+tempo.extractErrorMessage(k.responseText))}})}return false});var g=a("#tempo-report-module.stalker-original").find(":input.worklog-attribute");g.live("click",function(){var i=a(this);if(i.val()!=null&&i.parent().find(".no-value").length==1){i.trigger("change")}});g.live("change",function(){var k=a(this);var i=k.attr("data-worklog");var j=k.attr("data-key");var l=k.val();if(k.is(":checkbox")&&!k.is(":checked")){l=""}a.ajax({url:contextPath+"/rest/tempo-rest/2.0/worklogs/"+i+"/attributes",data:{value:l,attributeKey:j},type:"POST",dataType:"xml",success:function(m){a(m).find("submit-result").each(function(){var o=a(this);if(o.attr("valid")=="false"){o.find("errors").each(function(){var q=a(this);alert(q.find("errorMessage").text())})}else{tempo.requireReload();if(k.hasClass("tempoDynamicDropDown")){var n=k.siblings("span.edit-select");if(n.length>0){var p=k.children("option:selected").text();k.hide();n.text(p).show()}}}})},error:function(m,o,n){alert("Unknown update error: "+o)}})})}function c(e){jira.widget.autocomplete.Issues({fieldID:e,ajaxData:{fieldName:e,showSubTasks:"true",currentJQL:""}})}function b(f,e){if(a.browser.msie){a(f).find(":not([autocomplete])").keypress(function(g){if(g.which==13){f.trigger(e);return false}});a(f).find("[autocomplete]").keypress(function(g){if(g.which==13){return false}})}}return{init:d}})(AJS.$);
/* module-key = 'is.origo.jira.tempo-plugin:tempo-issueview-resource', location = 'com/tempoplugin/js/tempo.issuepanel.js' */
tempo.ui.init();tempo.worklogforms.init();tempo.dropdown.init();JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(h,d,g){if(JIRA.Issues&&JIRA.Issues.InlineEdit){JIRA.Issues.InlineEdit.BlurTriggerMapping.custom.billingKeys=JIRA.Issues.InlineEdit.BlurTriggers.Default}var b=AJS.$(d);if(b.find("#tempo-content")){var i=b.find("#tempo-content");if(i.hasClass("empty")){a("");i.removeClass("empty")}}b.find("a.selectperiod").live("click",function(j){var k=AJS.$(this).attr("id").replace("period_","");a(k);j.preventDefault();return false});function a(e){AJS.$.ajax({async:true,url:contextPath+"/TempoIssuePanel!default.jspa?id="+jira.app.issue.getIssueId()+"&period="+e,type:"GET",success:function(j){c(j);tempo.inplace(b.find("#tempo-content"));b.find("#tempo-content a.open-dropdown").bind("click",tempo.dropdown.handler)}})}function c(e){b.find("#tempo-content").empty().append(e)}function f(){var j={};var e=window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(k,l,n){j[l]=n});return j}});
/* module-key = 'com.atlassian.auiplugin:aui-experimental-expander', location = 'js/atlassian/aui-experimental-expander.js' */
(function(C){var D=C(document),B=function(F){var E={};E.$trigger=C(F.currentTarget);E.$content=D.find("#"+E.$trigger.attr("aria-controls"));E.triggerIsParent=E.$content.parent().filter(E.$trigger).length!=0;E.$shortContent=E.triggerIsParent?E.$trigger.find(".aui-expander-short-content"):null;E.height=E.$content.css("min-height");E.isCollapsible=E.$trigger.data("collapsible")!=false;E.replaceText=E.$trigger.attr("data-replace-text");E.replaceSelector=E.$trigger.data("replace-selector");return E},A=function(F){if(F.replaceText){var E=F.replaceSelector?F.$trigger.find(F.replaceSelector):F.$trigger;F.$trigger.attr("data-replace-text",E.text());E.text(F.replaceText)}};EXPANDER_EVENTS={"aui-expander-invoke":function(H){var E=C(H.currentTarget);var G=D.find("#"+E.attr("aria-controls"));var F=E.data("collapsible")!=false;if(G.attr("aria-expanded")=="true"&&F){E.trigger("aui-expander-collapse")}else{E.trigger("aui-expander-expand")}},"aui-expander-expand":function(F){var E=B(F);E.$content.attr("aria-expanded","true");if(E.height!="0px"){E.$content.css("height","auto")}else{E.$content.attr("aria-hidden","false")}A(E);if(E.triggerIsParent){E.$shortContent.hide()}E.$trigger.trigger("aui-expander-expanded")},"aui-expander-collapse":function(I){var G=B(I),F,H=parseInt(G.$content.css("line-height"),10),E=G.$content.children().first().height();if(G.height!="0px"){G.$content.css("height",0)}else{G.$content.attr("aria-hidden","true")}A(G);G.$content.attr("aria-expanded","false");if(G.triggerIsParent){G.$shortContent.show()}G.$trigger.trigger("aui-expander-collapsed")},"click.aui-expander":function(E){$target=C(E.currentTarget);$target.trigger("aui-expander-invoke",E.currentTarget)}};D.on(EXPANDER_EVENTS,".aui-expander-trigger")})(jQuery);
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d-api', location = 'js/lib/draw2d/draw2d.js' */
var draw2d={geo:{},io:{json:{},png:{},svg:{}},util:{spline:{}},shape:{basic:{},arrow:{},node:{},note:{},diagram:{},analog:{},icon:{},layout:{},pert:{},state:{},widget:{}},policy:{canvas:{},port:{},figure:{}},command:{},decoration:{connection:{}},layout:{connection:{},anchor:{},mesh:{},locator:{}},ui:{},isTouchDevice:((navigator.platform.indexOf("iPhone")!=-1)||(navigator.platform.indexOf("iPod")!=-1)||(navigator.platform.indexOf("iPad")!=-1))};(function(){Raphael.fn.group=function(D,C){var A=document.getElementsByTagName("svg").length>0;if(!A){return{add:function(){}}}var B;this.svg="http://www.w3.org/2000/svg";this.defs=document.getElementsByTagName("defs")[D];this.svgcanv=document.getElementsByTagName("svg")[D];this.group=document.createElementNS(this.svg,"g");for(B=0;B<C.length;B++){this.group.appendChild(C[B].node)}this.svgcanv.appendChild(this.group);this.group.translate=function(F,E){this.setAttribute("transform","translate("+F+","+E+") scale("+this.getAttr("scale").x+","+this.getAttr("scale").y+")")};this.group.rotate=function(G,E,F){this.setAttribute("transform","translate("+this.getAttr("translate").x+","+this.getAttr("translate").y+") scale("+this.getAttr("scale").x+","+this.getAttr("scale").y+") rotate("+G+","+E+","+F+")")};this.group.scale=function(F,E){this.setAttribute("transform","scale("+F+","+E+") translate("+this.getAttr("translate").x+","+this.getAttr("translate").y+")")};this.group.push=function(E){this.appendChild(E.node)};this.group.getAttr=function(L){this.previous=this.getAttribute("transform")?this.getAttribute("transform"):"";var F=[],J,I,H;F=this.previous.split(" ");for(B=0;B<F.length;B++){if(F[B].substring(0,1)=="t"){var K=F[B],E=[];E=K.split("(");K=E[1].substring(0,E[1].length-1);E=[];E=K.split(",");J=E.length===0?{x:0,y:0}:{x:E[0],y:E[1]}}else{if(F[B].substring(0,1)==="r"){K=F[B];E=K.split("(");K=E[1].substring(0,E[1].length-1);E=K.split(",");I=E.length===0?{x:0,y:0,z:0}:{x:E[0],y:E[1],z:E[2]}}else{if(F[B].substring(0,1)==="s"){K=F[B];E=K.split("(");K=E[1].substring(0,E[1].length-1);E=K.split(",");H=E.length===0?{x:1,y:1}:{x:E[0],y:E[1]}}}}}if(typeof J==="undefined"){J={x:0,y:0}}if(typeof I==="undefined"){I={x:0,y:0,z:0}}if(typeof H==="undefined"){H={x:1,y:1}}if(L=="translate"){var G=J}else{if(L=="rotate"){G=I}else{if(L=="scale"){G=H}}}return G};this.group.copy=function(E){this.copy=E.node.cloneNode(true);this.appendChild(this.copy)};return this.group}})();Math.sign=function(){if(this<0){return -1}return 1};
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/jquery.ui.droppable-1.8.11.js' */
(function ($) {(function(A,B){A.widget("ui.droppable",{widgetEventPrefix:"drop",options:{accept:"*",activeClass:false,addClasses:true,greedy:false,hoverClass:false,scope:"default",tolerance:"intersect"},_create:function(){var D=this.options,C=D.accept;this.isover=0;this.isout=1;this.accept=A.isFunction(C)?C:function(E){return E.is(C)};this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};A.ui.ddmanager.droppables[D.scope]=A.ui.ddmanager.droppables[D.scope]||[];A.ui.ddmanager.droppables[D.scope].push(this);(D.addClasses&&this.element.addClass("ui-droppable"))},destroy:function(){var C=A.ui.ddmanager.droppables[this.options.scope];for(var D=0;D<C.length;D++){if(C[D]==this){C.splice(D,1)}}this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable");return this},_setOption:function(C,D){if(C=="accept"){this.accept=A.isFunction(D)?D:function(E){return E.is(D)}}A.Widget.prototype._setOption.apply(this,arguments)},_activate:function(D){var C=A.ui.ddmanager.current;if(this.options.activeClass){this.element.addClass(this.options.activeClass)}(C&&this._trigger("activate",D,this.ui(C)))},_deactivate:function(D){var C=A.ui.ddmanager.current;if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}(C&&this._trigger("deactivate",D,this.ui(C)))},_over:function(D){var C=A.ui.ddmanager.current;if(!C||(C.currentItem||C.element)[0]==this.element[0]){return }if(this.accept.call(this.element[0],(C.currentItem||C.element))){if(this.options.hoverClass){this.element.addClass(this.options.hoverClass)}this._trigger("over",D,this.ui(C))}},_out:function(D){var C=A.ui.ddmanager.current;if(!C||(C.currentItem||C.element)[0]==this.element[0]){return }if(this.accept.call(this.element[0],(C.currentItem||C.element))){if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("out",D,this.ui(C))}},_drop:function(D,E){var C=E||A.ui.ddmanager.current;if(!C||(C.currentItem||C.element)[0]==this.element[0]){return false}var F=false;this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var G=A.data(this,"droppable");if(G.options.greedy&&!G.options.disabled&&G.options.scope==C.options.scope&&G.accept.call(G.element[0],(C.currentItem||C.element))&&A.ui.intersect(C,A.extend(G,{offset:G.element.offset()}),G.options.tolerance)){F=true;return false}});if(F){return false}if(this.accept.call(this.element[0],(C.currentItem||C.element))){if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("drop",D,this.ui(C));return this.element}return false},ui:function(C){return{draggable:(C.currentItem||C.element),helper:C.helper,position:C.position,offset:C.positionAbs}}});A.extend(A.ui.droppable,{version:"@VERSION"});A.ui.intersect=function(P,J,N){if(!J.offset){return false}var E=(P.positionAbs||P.position.absolute).left,D=E+P.helperProportions.width,M=(P.positionAbs||P.position.absolute).top,L=M+P.helperProportions.height;var G=J.offset.left,C=G+J.proportions.width,O=J.offset.top,K=O+J.proportions.height;switch(N){case"fit":return(G<=E&&D<=C&&O<=M&&L<=K);break;case"intersect":return(G<E+(P.helperProportions.width/2)&&D-(P.helperProportions.width/2)<C&&O<M+(P.helperProportions.height/2)&&L-(P.helperProportions.height/2)<K);break;case"pointer":var H=((P.positionAbs||P.position.absolute).left+(P.clickOffset||P.offset.click).left),I=((P.positionAbs||P.position.absolute).top+(P.clickOffset||P.offset.click).top),F=A.ui.isOver(I,H,O,G,J.proportions.height,J.proportions.width);return F;break;case"touch":return((M>=O&&M<=K)||(L>=O&&L<=K)||(M<O&&L>K))&&((E>=G&&E<=C)||(D>=G&&D<=C)||(E<G&&D>C));break;default:return false;break}};A.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(F,H){var C=A.ui.ddmanager.droppables[F.options.scope]||[];var G=H?H.type:null;var I=(F.currentItem||F.element).find(":data(droppable)").andSelf();droppablesLoop:for(var E=0;E<C.length;E++){if(C[E].options.disabled||(F&&!C[E].accept.call(C[E].element[0],(F.currentItem||F.element)))){continue}for(var D=0;D<I.length;D++){if(I[D]==C[E].element[0]){C[E].proportions.height=0;continue droppablesLoop}}C[E].visible=C[E].element.css("display")!="none";if(!C[E].visible){continue}if(G=="mousedown"){C[E]._activate.call(C[E],H)}C[E].offset=C[E].element.offset();C[E].proportions={width:C[E].element[0].offsetWidth,height:C[E].element[0].offsetHeight}}},drop:function(C,D){var E=false;A.each(A.ui.ddmanager.droppables[C.options.scope]||[],function(){if(!this.options){return }if(!this.options.disabled&&this.visible&&A.ui.intersect(C,this,this.options.tolerance)){E=E||this._drop.call(this,D)}if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],(C.currentItem||C.element))){this.isout=1;this.isover=0;this._deactivate.call(this,D)}});return E},drag:function(C,D){if(C.options.refreshPositions){A.ui.ddmanager.prepareOffsets(C,D)}A.each(A.ui.ddmanager.droppables[C.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible){return }var F=A.ui.intersect(C,this,this.options.tolerance);var H=!F&&this.isover==1?"isout":(F&&this.isover==0?"isover":null);if(!H){return }var G;if(this.options.greedy){var E=this.element.parents(":data(droppable):eq(0)");if(E.length){G=A.data(E[0],"droppable");G.greedyChild=(H=="isover"?1:0)}}if(G&&H=="isover"){G.isover=0;G.isout=1;G._out.call(G,D)}this[H]=1;this[H=="isout"?"isover":"isout"]=0;this[H=="isover"?"_over":"_out"].call(this,D);if(G&&H=="isout"){G.isout=0;G.isover=1;G._over.call(G,D)}})}}})(jQuery);}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/shifty-0.6.1.js' */
(function ($) {(function(){var A;(function(D){var E,H="linear",K;if(typeof SHIFTY_DEBUG_NOW==="function"){E=SHIFTY_DEBUG_NOW}else{E=function(){return +new Date()}}function N(R,Q){var S;for(S in R){if(R.hasOwnProperty(S)){Q(R,S)}}}function L(R,Q){N(Q,function(S,T){R[T]=S[T]});return R}function G(R,Q){N(Q,function(S,T){if(typeof R[T]==="undefined"){R[T]=S[T]}});return R}function B(S,T,R){var U,Q;Q=(S-T.timestamp)/T.duration;for(U in R.current){if(R.current.hasOwnProperty(U)&&T.to.hasOwnProperty(U)){R.current[U]=J(T.originalState[U],T.to[U],K[T.easing[U]],Q)}}return R.current}function J(T,S,R,Q){return T+(S-T)*R(Q)}function F(Q,R){return setTimeout(Q,1000/R)}function M(T,Q,U,R){var S;for(S=0;S<Q[T].length;S++){Q[T][S].apply(U,R)}}function I(R,S,Q){N(A.prototype.filter,function(U,T){if(U[T][R]){U[T][R].apply(S,Q)}})}function P(U,T){var R=U.timestamp+U.duration,S=Math.min(E(),R),Q=S>=R;if(T.isTweening){if(!Q){T.loopId=F(function(){P(U,T)},U.owner.fps)}I("beforeTween",U.owner,[T.current,U.originalState,U.to]);B(S,U,T);I("afterTween",U.owner,[T.current,U.originalState,U.to]);if(U.hook.step){M("step",U.hook,U.owner,[T.current])}if(U.step){U.step.call(T.current,T.current)}}if(Q||!T.isTweening){U.owner.stop(true)}}if(typeof SHIFTY_DEBUG_NOW==="function"){D.timeoutHandler=P}function C(S,R){var Q;Q={};if(typeof R==="string"){N(S,function(T,U){Q[U]=R})}else{N(S,function(T,U){if(!Q[U]){Q[U]=R[U]||H}})}return Q}A=function(Q){Q=Q||{};this._hook={};this._tweenParams={owner:this,hook:this._hook,data:{}};this._state={};this._state.current=Q.initialState||{};this.fps=Q.fps||30;this.easing=Q.easing||H;this.duration=Q.duration||500;return this};A.prototype.tween=function(X,W,S,V,U){var Q,T,R;if(this._state.isTweening){return }Q=this;T=this._tweenParams;R=this._state;this._state.loopId=0;this._state.pausedAtTime=null;if(W){T.to=W||{};T.duration=S||this.duration;T.callback=V;T.easing=U||this.easing;R.current=X||{}}else{T.step=X.step;T.callback=X.callback;T.to=X.to||X.target||{};T.duration=X.duration||this.duration;T.easing=X.easing||this.easing;R.current=X.from||{}}T.timestamp=E();G(R.current,T.to);G(T.to,R.current);T.easing=C(R.current,T.easing);I("tweenCreated",T.owner,[R.current,T.originalState,T.to]);T.originalState=L({},R.current);R.isTweening=true;this.resume();if(X.start){X.start()}return this};A.prototype.to=function O(R,Q,T,S){if(arguments.length===1){if("to" in R){R.from=this.get();this.tween(R)}else{this.tween(this.get(),R)}}else{this.tween(this.get(),R,Q,T,S)}return this};A.prototype.get=function(){return this._state.current};A.prototype.set=function(Q){this._state.current=Q||{};return this};A.prototype.stop=function(Q){clearTimeout(this._state.loopId);this._state.isTweening=false;if(Q){L(this._state.current,this._tweenParams.to);I("afterTweenEnd",this,[this._state.current,this._tweenParams.originalState,this._tweenParams.to]);if(this._tweenParams.callback){this._tweenParams.callback.call(this._state.current,this._state.current)}}return this};A.prototype.pause=function(){clearTimeout(this._state.loopId);this._state.pausedAtTime=E();this._state.isPaused=true;return this};A.prototype.resume=function(){var Q;Q=this;if(this._state.isPaused){this._tweenParams.timestamp+=E()-this._state.pausedAtTime}P(Q._tweenParams,Q._state);return this};A.prototype.hookAdd=function(Q,R){if(!this._hook.hasOwnProperty(Q)){this._hook[Q]=[]}this._hook[Q].push(R)};A.prototype.hookRemove=function(R,S){var Q;if(!this._hook.hasOwnProperty(R)){return }if(!S){this._hook[R]=[];return }for(Q=this._hook[R].length;Q>=0;Q++){if(this._hook[R][Q]===S){this._hook[R].splice(Q,1)}}};A.prototype.filter={};A.util={now:E,each:N,tweenProps:B,tweenProp:J,applyFilter:I,simpleCopy:L,weakCopy:G,composeEasingObject:C};K=A.prototype.formula={linear:function(Q){return Q}};if(typeof exports==="object"){module.exports=A}else{if(typeof define==="function"&&define.amd){define(function(){return A})}else{if(typeof D.Tweenable==="undefined"){D.Tweenable=A}}}}(this));(function(){A.util.simpleCopy(A.prototype.formula,{easeInQuad:function(B){return Math.pow(B,2)},easeOutQuad:function(B){return -(Math.pow((B-1),2)-1)},easeInOutQuad:function(B){if((B/=0.5)<1){return 0.5*Math.pow(B,2)}return -0.5*((B-=2)*B-2)},easeInCubic:function(B){return Math.pow(B,3)},easeOutCubic:function(B){return(Math.pow((B-1),3)+1)},easeInOutCubic:function(B){if((B/=0.5)<1){return 0.5*Math.pow(B,3)}return 0.5*(Math.pow((B-2),3)+2)},easeInQuart:function(B){return Math.pow(B,4)},easeOutQuart:function(B){return -(Math.pow((B-1),4)-1)},easeInOutQuart:function(B){if((B/=0.5)<1){return 0.5*Math.pow(B,4)}return -0.5*((B-=2)*Math.pow(B,3)-2)},easeInQuint:function(B){return Math.pow(B,5)},easeOutQuint:function(B){return(Math.pow((B-1),5)+1)},easeInOutQuint:function(B){if((B/=0.5)<1){return 0.5*Math.pow(B,5)}return 0.5*(Math.pow((B-2),5)+2)},easeInSine:function(B){return -Math.cos(B*(Math.PI/2))+1},easeOutSine:function(B){return Math.sin(B*(Math.PI/2))},easeInOutSine:function(B){return(-0.5*(Math.cos(Math.PI*B)-1))},easeInExpo:function(B){return(B==0)?0:Math.pow(2,10*(B-1))},easeOutExpo:function(B){return(B==1)?1:-Math.pow(2,-10*B)+1},easeInOutExpo:function(B){if(B==0){return 0}if(B==1){return 1}if((B/=0.5)<1){return 0.5*Math.pow(2,10*(B-1))}return 0.5*(-Math.pow(2,-10*--B)+2)},easeInCirc:function(B){return -(Math.sqrt(1-(B*B))-1)},easeOutCirc:function(B){return Math.sqrt(1-Math.pow((B-1),2))},easeInOutCirc:function(B){if((B/=0.5)<1){return -0.5*(Math.sqrt(1-B*B)-1)}return 0.5*(Math.sqrt(1-(B-=2)*B)+1)},easeOutBounce:function(B){if((B)<(1/2.75)){return(7.5625*B*B)}else{if(B<(2/2.75)){return(7.5625*(B-=(1.5/2.75))*B+0.75)}else{if(B<(2.5/2.75)){return(7.5625*(B-=(2.25/2.75))*B+0.9375)}else{return(7.5625*(B-=(2.625/2.75))*B+0.984375)}}}},easeInBack:function(C){var B=1.70158;return(C)*C*((B+1)*C-B)},easeOutBack:function(C){var B=1.70158;return(C=C-1)*C*((B+1)*C+B)+1},easeInOutBack:function(C){var B=1.70158;if((C/=0.5)<1){return 0.5*(C*C*(((B*=(1.525))+1)*C-B))}return 0.5*((C-=2)*C*(((B*=(1.525))+1)*C+B)+2)},elastic:function(B){return -1*Math.pow(4,-8*B)*Math.sin((B*6-1)*(2*Math.PI)/2)+1},swingFromTo:function(C){var B=1.70158;return((C/=0.5)<1)?0.5*(C*C*(((B*=(1.525))+1)*C-B)):0.5*((C-=2)*C*(((B*=(1.525))+1)*C+B)+2)},swingFrom:function(C){var B=1.70158;return C*C*((B+1)*C-B)},swingTo:function(C){var B=1.70158;return(C-=1)*C*((B+1)*C+B)+1},bounce:function(B){if(B<(1/2.75)){return(7.5625*B*B)}else{if(B<(2/2.75)){return(7.5625*(B-=(1.5/2.75))*B+0.75)}else{if(B<(2.5/2.75)){return(7.5625*(B-=(2.25/2.75))*B+0.9375)}else{return(7.5625*(B-=(2.625/2.75))*B+0.984375)}}}},bouncePast:function(B){if(B<(1/2.75)){return(7.5625*B*B)}else{if(B<(2/2.75)){return 2-(7.5625*(B-=(1.5/2.75))*B+0.75)}else{if(B<(2.5/2.75)){return 2-(7.5625*(B-=(2.25/2.75))*B+0.9375)}else{return 2-(7.5625*(B-=(2.625/2.75))*B+0.984375)}}}},easeFromTo:function(B){if((B/=0.5)<1){return 0.5*Math.pow(B,4)}return -0.5*((B-=2)*Math.pow(B,3)-2)},easeFrom:function(B){return Math.pow(B,4)},easeTo:function(B){return Math.pow(B,0.25)}})}());(function(){var C=function(){};function E(F){F.shift();if(F.length){F[0]()}else{F.running=false}}function D(G,F){return function(){G();E(F)}}function B(F,K,J,G,I,H){return function(){if(J){F.tween(K,J,G,I,H)}else{K.callback=I;if(K.from){F.tween(K)}else{F.to(K)}}}}A.prototype.queue=function(K,J,F,I,H){var G;if(!this._tweenQueue){this._tweenQueue=[]}I=I||K.callback||C;G=D(I,this._tweenQueue);this._tweenQueue.push(B(this,K,J,F,G,H));return this};A.prototype.queueStart=function(){if(!this._tweenQueue.running&&this._tweenQueue.length>0){this._tweenQueue[0]();this._tweenQueue.running=true}return this};A.prototype.queueShift=function(){this._tweenQueue.shift();return this};A.prototype.queuePop=function(){this._tweenQueue.pop();return this};A.prototype.queueEmpty=function(){this._tweenQueue.length=0;return this};A.prototype.queueLength=function(){return this._tweenQueue.length}}());(function(){var B=/^#([0-9]|[a-f]){3}$/i,M=/^#([0-9]|[a-f]){6}$/i,E=/^rgb\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)\s*$/i,Q;if(!A){return }function P(R){return parseInt(R,16)}function G(R){R=R.replace(/#/g,"");if(R.length===3){R=R.split("");R=R[0]+R[0]+R[1]+R[1]+R[2]+R[2]}return[P(R.substr(0,2)),P(R.substr(2,2)),P(R.substr(4,2))]}function N(S){var T,R;T=G(S);R="rgb("+T[0]+","+T[1]+","+T[2]+")";return R}function J(R){return(typeof R==="string")&&(B.test(R)||M.test(R)||E.test(R))}function H(R){return(typeof R==="string")&&(B.test(R)||M.test(R))}function I(R){A.util.each(R,function(S,T){if(H(S[T])){S[T]=N(S[T])}})}function D(S){var R;R=[];A.util.each(S,function(T,U){if(J(T[U])){R.push(U)}});return R}function K(R){return R.match(/(\d+)/g)}function F(V,T){var U,S,R;S=T.length;for(U=0;U<S;U++){R=K(V[T[U]]);V["__r__"+T[U]]=+R[0];V["__g__"+T[U]]=+R[1];V["__b__"+T[U]]=+R[2];delete V[T[U]]}}function C(U,S){var T,R;R=S.length;for(T=0;T<R;T++){U[S[T]]="rgb("+parseInt(U["__r__"+S[T]],10)+","+parseInt(U["__g__"+S[T]],10)+","+parseInt(U["__b__"+S[T]],10)+")";delete U["__r__"+S[T]];delete U["__g__"+S[T]];delete U["__b__"+S[T]]}}function O(U,S){var T,R;R=S.length;for(T=0;T<R;T++){U["__r__"+S[T]]=U[S[T]];U["__g__"+S[T]]=U[S[T]];U["__b__"+S[T]]=U[S[T]]}}function L(U,S){var T,R;R=S.length;for(T=0;T<R;T++){delete U["__r__"+S[T]];delete U["__g__"+S[T]];delete U["__b__"+S[T]]}}A.prototype.filter.color={tweenCreated:function(S,T,R){I(S);I(T);I(R)},beforeTween:function(S,T,R){Q=D(T);F(S,Q);F(T,Q);F(R,Q);O(this._tweenParams.easing,Q)},afterTween:function(S,T,R){C(S,Q);C(T,Q);C(R,Q);L(this._tweenParams.easing,Q)}}}());(function(){var D=/\D+/g;var G;function B(I){return typeof I==="string"&&I.match(D)}function F(I){return I.replace(/\(/g,"\\(").replace(/\)/g,"\\)")}function H(I){var J;J={};A.util.each(I,function(M,N){var L=M[N];if(B(L)){var K=L.match(D);if(K.length===1){K.unshift("")}J[N]=K}});return J}function C(J,I){A.util.each(I,function(P,L){var M=I[L];var O;var K=F(M[0]);var N=F(M[1]);if(M[0]===""){O=new RegExp(N,"g")}else{O=new RegExp("("+K+"|"+N+")","g")}J[L]=+(J[L].replace(O,""))})}function E(J,I){A.util.each(I,function(M,L){var K=M[L];J[L]=K[0]+J[L]+K[1]})}A.prototype.filter.token={beforeTween:function(J,K,I){G=H(K);C(J,G);C(K,G);C(I,G)},afterTween:function(J,K,I){E(J,G);E(K,G);E(I,G)}}}());(function(){if(!A){return }function B(H,D,G,C,F){var E;E=A.util.composeEasingObject(H,F);return A.util.tweenProps(C,{originalState:H,to:G,timestamp:0,duration:1,easing:E},{current:D})}A.util.interpolate=function(I,H,C,G){var F,E,D;if(I&&I.from){H=I.to;C=I.position;G=I.easing;I=I.from}D=new A();D._tweenParams.easing=G||"linear";F=A.util.simpleCopy({},I);A.util.applyFilter("tweenCreated",D,[F,I,H]);A.util.applyFilter("beforeTween",D,[F,I,H]);E=B(I,F,H,C,D._tweenParams.easing);A.util.applyFilter("afterTween",D,[E,I,H]);return E};A.prototype.interpolate=function(F,C,E){var D;D=A.util.interpolate(this.get(),F,C,E);this.set(D);return D}}());(function(){var B=false;A.util.enableRounding=function(){B=true};A.util.disableRounding=function(){B=false};A.util.isRoundingEnabled=function(){return B};A.prototype.filter.round={afterTween:function(D,E,C){if(B){A.util.each(D,function(F,G){if(!F[G].replace){F[G]=Math.round(F[G])}})}}}}())}());}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/util/Color.js' */
(function ($) {draw2d.util.Color=Class.extend({init:function(D,C,A){this.hashString=null;if(typeof D==="undefined"||D===null){this.hashString="none"}else{if(D instanceof draw2d.util.Color){this.red=D.red;this.green=D.green;this.blue=D.blue}else{if(typeof C==="undefined"){var B=this.hex2rgb(D);this.red=B[0];this.green=B[1];this.blue=B[2]}else{this.red=D;this.green=C;this.blue=A}}}},getHTMLStyle:function(){return"rgb("+this.red+","+this.green+","+this.blue+")"},getRed:function(){return this.red},getGreen:function(){return this.green},getBlue:function(){return this.blue},getIdealTextColor:function(){var A=105;var B=(this.red*0.299)+(this.green*0.587)+(this.blue*0.114);return(255-B<A)?new draw2d.util.Color(0,0,0):new draw2d.util.Color(255,255,255)},hex2rgb:function(A){A=A.replace("#","");return({0:parseInt(A.substr(0,2),16),1:parseInt(A.substr(2,2),16),2:parseInt(A.substr(4,2),16)})},hex:function(){return(this.int2hex(this.red)+this.int2hex(this.green)+this.int2hex(this.blue))},hash:function(){if(this.hashString===null){this.hashString="#"+this.hex()}return this.hashString},int2hex:function(A){A=Math.round(Math.min(Math.max(0,A),255));return("0123456789ABCDEF".charAt((A-A%16)/16)+"0123456789ABCDEF".charAt(A%16))},darker:function(B){if(this.hashString==="none"){return this}var D=parseInt(Math.round(this.getRed()*(1-B)));var C=parseInt(Math.round(this.getGreen()*(1-B)));var A=parseInt(Math.round(this.getBlue()*(1-B)));if(D<0){D=0}else{if(D>255){D=255}}if(C<0){C=0}else{if(C>255){C=255}}if(A<0){A=0}else{if(A>255){A=255}}return new draw2d.util.Color(D,C,A)},lighter:function(B){if(this.hashString==="none"){return this}var D=parseInt(Math.round(this.getRed()*(1+B)));var C=parseInt(Math.round(this.getGreen()*(1+B)));var A=parseInt(Math.round(this.getBlue()*(1+B)));if(D<0){D=0}else{if(D>255){D=255}}if(C<0){C=0}else{if(C>255){C=255}}if(A<0){A=0}else{if(A>255){A=255}}return new draw2d.util.Color(D,C,A)},fadeTo:function(B,C){var E=Math.floor(this.red+(C*(B.red-this.red))+0.5);var D=Math.floor(this.green+(C*(B.green-this.green))+0.5);var A=Math.floor(this.blue+(C*(B.blue-this.blue))+0.5);return new draw2d.util.Color(E,D,A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/util/ArrayList.js' */
(function ($) {draw2d.util.ArrayList=Class.extend({init:function(A){this.increment=10;this.size=0;this.data=new Array(this.increment);if(typeof A!=="undefined"){$.each(A,$.proxy(function(B,C){this.add(C)},this))}},reverse:function(){var B=new Array(this.size);for(var A=0;A<this.size;A++){B[A]=this.data[this.size-A-1]}this.data=B;return this},getCapacity:function(){return this.data.length},getSize:function(){return this.size},isEmpty:function(){return this.getSize()===0},getLastElement:function(){if(this.data[this.getSize()-1]!==null){return this.data[this.getSize()-1]}return null},asArray:function(){this.trimToSize();return this.data},getFirstElement:function(){if(this.data[0]!==null&&typeof this.data[0]!=="undefined"){return this.data[0]}return null},get:function(A){return this.data[A]},add:function(A){if(this.getSize()==this.data.length){this.resize()}this.data[this.size++]=A;return this},grep:function(A){this.data=$.grep(this.data,A);this.data=$.grep(this.data,function(B){return(typeof B!=="undefined")});this.size=this.data.length;return this},addAll:function(B){if(!(B instanceof draw2d.util.ArrayList)){throw"Unable to handle unknown object type in ArrayList.addAll"}for(var A=0;A<B.getSize();A++){this.add(B.get(A))}return this},pop:function(){return this.removeElementAt(this.getSize()-1)},push:function(A){this.add(A)},remove:function(B){var A=this.indexOf(B);if(A>=0){return this.removeElementAt(A)}return null},insertElementAt:function(C,A){if(this.size==this.capacity){this.resize()}for(var B=this.getSize();B>A;B--){this.data[B]=this.data[B-1]}this.data[A]=C;this.size++;return this},removeElementAt:function(A){var C=this.data[A];for(var B=A;B<(this.size-1);B++){this.data[B]=this.data[B+1]}this.data[this.size-1]=null;this.size--;return C},removeAll:function(A){$.each(A,$.proxy(function(B,C){this.remove(C)},this));return this},indexOf:function(B){for(var A=0;A<this.getSize();A++){if(this.data[A]==B){return A}}return -1},contains:function(B){for(var A=0;A<this.getSize();A++){if(this.data[A]==B){return true}}return false},resize:function(){newData=new Array(this.data.length+this.increment);for(var A=0;A<this.data.length;A++){newData[A]=this.data[A]}this.data=newData;return this},trimToSize:function(){if(this.data.length==this.size){return this}var A=new Array(this.getSize());for(var B=0;B<this.getSize();B++){A[B]=this.data[B]}this.size=A.length;this.data=A;return this},sort:function(F){var D,C;var E;var B;var G;var A;for(D=1;D<this.getSize();D++){B=this.data[D];E=B[F];C=D-1;G=this.data[C];A=G[F];while(C>=0&&A>E){this.data[C+1]=this.data[C];C--;if(C>=0){G=this.data[C];A=G[F]}}this.data[C+1]=B}return this},clone:function(){var A=new draw2d.util.ArrayList();for(var B=0;B<this.size;B++){A.add(this.data[B])}return A},each:function(B){for(var A=0;A<this.size;A++){if(B(A,this.data[A])===false){break}}},overwriteElementAt:function(B,A){this.data[A]=B;return this},getPersistentAttributes:function(){return{data:this.data,increment:this.increment,size:this.getSize()}},setPersistentAttributes:function(A){this.data=A.data;this.increment=A.increment;this.size=A.size}});draw2d.util.ArrayList.EMPTY_LIST=new draw2d.util.ArrayList();}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/util/SVGUtil.js' */
(function ($) {Raphael.fn.polygon=function(F){var D=["M"],A=F.split(" ");for(var C=0;C<A.length;C++){var G=A[C].split(",");for(var B=0;B<G.length;B++){var E=parseFloat(G[B]);if(E){D.push(E)}}if(C==0){D.push("L")}}D.push("Z");return this.path(D)};}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/util/UUID.js' */
(function ($) {draw2d.util.UUID=function(){};draw2d.util.UUID.create=function(){var A=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(A()+A()+"-"+A()+"-"+A()+"-"+A()+"-"+A()+A()+A())};}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/util/spline/Spline.js' */
(function ($) {draw2d.util.spline.Spline=Class.extend({NAME:"draw2d.util.spline.Spline",init:function(){},generate:function(A,B){throw"inherit classes must implement the method 'draw2d.util.spline.Spline.generate()'"}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/util/spline/CubicSpline.js' */
(function ($) {draw2d.util.spline.CubicSpline=draw2d.util.spline.Spline.extend({NAME:"draw2d.util.spline.CubicSpline",init:function(){this._super()},generate:function(A,E){var D=new draw2d.util.ArrayList();D.add(A.get(0));D.addAll(A);D.add(A.get(A.getSize()-1));var G=D.getSize();var F=new draw2d.util.ArrayList();F.add(A.get(0));F.add(this.p(1,0,D));for(var C=1;C<G-2;C++){for(var B=1;B<=E;B++){F.add(this.p(C,B/E,D))}}F.add(A.get(A.getSize()-1));return F},p:function(D,I,E){var H=0;var F=0;var B=D-1;for(var C=-2;C<=1;C++){var G=this.blend(C,I);var A=E.get(B++);H+=G*A.x;F+=G*A.y}return new draw2d.geo.Point(H,F)},blend:function(B,A){if(B===-2){return(((-A+3)*A-3)*A+1)/6}else{if(B===-1){return(((3*A-6)*A)*A+4)/6}else{if(B===0){return(((-3*A+3)*A+3)*A+1)/6}}}return(A*A*A)/6}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/util/spline/CatmullRomSpline.js' */
(function ($) {draw2d.util.spline.CatmullRomSpline=draw2d.util.spline.CubicSpline.extend({NAME:"draw2d.util.spline.CatmullRomSpline",init:function(){this._super()},blend:function(B,A){if(B==-2){return((-A+2)*A-1)*A/2}else{if(B==-1){return(((3*A-5)*A)*A+2)/2}else{if(B==0){return((-3*A+4)*A+1)*A/2}else{return((A-1)*A*A)/2}}}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/util/spline/BezierSpline.js' */
(function ($) {draw2d.util.spline.BezierSpline=draw2d.util.spline.Spline.extend({NAME:"draw2d.util.spline.BezierSpline",init:function(){this._super()},generate:function(A,D){var F=A.getSize();var E=new draw2d.util.ArrayList();E.add(this.p(0,0,A));for(var C=0;C<F-3;C+=3){for(var B=1;B<=D;B++){E.add(this.p(C,B/D,A))}}return E},p:function(D,I,E){var H=0;var F=0;var B=D;for(var C=0;C<=3;C++){var G=this.blend(C,I);var A=E.get(B++);H+=G*A.x;F+=G*A.y}return new draw2d.geo.Point(H,F)},blend:function(B,A){if(B==0){return(1-A)*(1-A)*(1-A)}else{if(B==1){return 3*A*(1-A)*(1-A)}else{if(B==2){return 3*A*A*(1-A)}else{return A*A*A}}}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/geo/PositionConstants.js' */
(function ($) {draw2d.geo.PositionConstants=function(){};draw2d.geo.PositionConstants.NORTH=1;draw2d.geo.PositionConstants.SOUTH=4;draw2d.geo.PositionConstants.WEST=8;draw2d.geo.PositionConstants.EAST=16;}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/geo/Point.js' */
(function ($) {draw2d.geo.Point=Class.extend({NAME:"draw2d.geo.Point",init:function(A,B){this.x=A;this.y=B;this.bx=null;this.by=null;this.bw=null;this.bh=null},setBoundary:function(C,B,D,A){if(C instanceof draw2d.geo.Rectangle){this.bx=C.x;this.by=C.y;this.bw=C.w;this.bh=C.h}else{this.bx=C;this.by=B;this.bw=D;this.bh=A}this.adjustBoundary();return this},adjustBoundary:function(){if(this.bx===null){return }this.x=Math.min(Math.max(this.bx,this.x),this.bw);this.y=Math.min(Math.max(this.by,this.y),this.bh);return this},translate:function(B,A){this.x+=B;this.y+=A;this.adjustBoundary();return this},getX:function(){return this.x},getY:function(){return this.y},setX:function(A){this.x=A;this.adjustBoundary();return this},setY:function(A){this.y=A;this.adjustBoundary();return this},setPosition:function(A,B){if(A instanceof draw2d.geo.Point){this.x=A.x;this.y=A.y}else{this.x=A;this.y=B}this.adjustBoundary();return this},getPosition:function(C){var B=C.x-this.x;var A=C.y-this.y;if(Math.abs(B)>Math.abs(A)){if(B<0){return draw2d.geo.PositionConstants.WEST}return draw2d.geo.PositionConstants.EAST}if(A<0){return draw2d.geo.PositionConstants.NORTH}return draw2d.geo.PositionConstants.SOUTH},equals:function(A){return this.x===A.x&&this.y===A.y},getDistance:function(A){return Math.sqrt((this.x-A.x)*(this.x-A.x)+(this.y-A.y)*(this.y-A.y))},getTranslated:function(A){return new draw2d.geo.Point(this.x+A.x,this.y+A.y)},getPersistentAttributes:function(){return{x:this.x,y:this.y}},setPersistentAttributes:function(A){this.x=A.x;this.y=A.y},subtract:function(A){return new draw2d.geo.Point(this.x-A.x,this.y-A.y)},dot:function(A){return this.x*A.x+this.y*A.y},cross:function(A){return this.x*A.y-this.y*A.x},lerp:function(B,A){return new draw2d.geo.Point(this.x+(B.x-this.x)*A,this.y+(B.y-this.y)*A)},clone:function(){return new draw2d.geo.Point(this.x,this.y)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/geo/Rectangle.js' */
(function ($) {draw2d.geo.Rectangle=draw2d.geo.Point.extend({NAME:"draw2d.geo.Rectangle",init:function(A,D,B,C){this._super(A,D);this.w=B;this.h=C},adjustBoundary:function(){if(this.bx===null){return }this.x=Math.min(Math.max(this.bx,this.x),this.bw-this.w);this.y=Math.min(Math.max(this.by,this.y),this.bh-this.h);this.w=Math.min(this.w,this.bw);this.h=Math.min(this.h,this.bh)},resize:function(A,B){this.w+=A;this.h+=B;this.adjustBoundary();return this},scale:function(A,B){this.w+=(A);this.h+=(B);this.x-=(A/2);this.y-=(B/2);this.adjustBoundary();return this},setBounds:function(A){this.setPosition(A.x,A.y);this.w=A.w;this.h=A.h;return this},isEmpty:function(){return this.w<=0||this.h<=0},getWidth:function(){return this.w},setWidth:function(A){this.w=A;this.adjustBoundary();return this},getHeight:function(){return this.h},setHeight:function(A){this.h=A;this.adjustBoundary();return this},getLeft:function(){return this.x},getRight:function(){return this.x+this.w},getTop:function(){return this.y},getBottom:function(){return this.y+this.h},getTopLeft:function(){return new draw2d.geo.Point(this.x,this.y)},getTopCenter:function(){return new draw2d.geo.Point(this.x+(this.w/2),this.y)},getTopRight:function(){return new draw2d.geo.Point(this.x+this.w,this.y)},getBottomLeft:function(){return new draw2d.geo.Point(this.x,this.y+this.h)},getBottomCenter:function(){return new draw2d.geo.Point(this.x+(this.w/2),this.y+this.h)},getCenter:function(){return new draw2d.geo.Point(this.x+this.w/2,this.y+this.h/2)},getBottomRight:function(){return new draw2d.geo.Point(this.x+this.w,this.y+this.h)},getPoints:function(){var A=new draw2d.util.ArrayList();A.add(this.getTopLeft());A.add(this.getTopRight());A.add(this.getBottomRight());A.add(this.getBottomLeft());return A},moveInside:function(B){var A=new draw2d.geo.Rectangle(B.x,B.y,B.w,B.h);A.x=Math.max(A.x,this.x);A.y=Math.max(A.y,this.y);if(A.w<this.w){A.x=Math.min(A.x+A.w,this.x+this.w)-A.w}else{A.x=this.x}if(A.h<this.h){A.y=Math.min(A.y+A.h,this.y+this.h)-A.h}else{A.y=this.y}return A},getDistance:function(H){var F=this.x;var E=this.y;var G=this.w;var A=this.h;var C=H.getX();var B=H.getY();var D=1;var J=1;if(H instanceof draw2d.geo.Rectangle){D=H.getWidth();J=H.getHeight()}var I=9;if(F+G<=C){if((E+A)<=B){I=0}else{if(E>=(B+J)){I=6}else{I=7}}}else{if(F>=C+D){if(E+A<=B){I=2}else{if(E>=B+J){I=4}else{I=3}}}else{if(E+A<=B){I=1}else{if(E>=B+J){I=5}else{return 0}}}}switch(I){case 0:F=(F+G)-C;E=(E+A)-B;return -(F+E);case 1:return -((E+A)-B);case 2:F=(C+D)-F;E=(E+A)-B;return -(F+E);case 3:return -((C+D)-F);case 4:F=(C+D)-F;E=(B+J)-E;return -(F+E);case 5:return -((B+J)-E);case 6:F=(F+G)-C;E=(B+J)-E;return -(F+E);case 7:return -((F+G)-C)}throw"Unknown data type of parameter for distance calculation in draw2d.geo.Rectangle.getDistnace(..)"},determineOctant:function(D){var J=3;var C=this.x+J;var B=this.y+J;var E=this.w-(J*2);var K=this.h-(J*2);var G=D.x;var F=D.y;var H=2;var A=2;if(D instanceof draw2d.geo.Rectangle){H=D.w;A=D.h}var I=0;if(G+H<=C){if((F+A)<=B){I=0}else{if(F>=(B+K)){I=6}else{I=7}}}else{if(G>=C+E){if(F+A<=B){I=2}else{if(F>=B+K){I=4}else{I=3}}}else{if(F+A<=B){I=1}else{if(F>=B+K){I=5}else{I=8}}}}return I},getDirection:function(A){var B=this.getTopLeft();switch(this.determineOctant(A)){case 0:if((B.x-A.x)<(B.y-A.y)){return 0}return 3;case 1:return 0;case 2:B=this.getTopRight();if((A.x-B.x)<(B.y-A.y)){return 0}return 1;case 3:return 1;case 4:B=this.getBottomRight();if((A.x-B.x)<(A.y-B.y)){return 2}return 1;case 5:return 2;case 6:B=this.getBottomLeft();if((B.x-A.x)<(A.y-B.y)){return 2}return 3;case 7:return 3;case 8:if(A.y>this.y){return 2}return 0}return 0},equals:function(A){return this.x==A.x&&this.y==A.y&&this.w==A.w&&this.h==A.h},hitTest:function(A,D){if(A instanceof draw2d.geo.Point){D=A.y;A=A.x}var B=this.x+this.getWidth();var C=this.y+this.getHeight();return(A>=this.x&&A<=B&&D>=this.y&&D<=C)},isInside:function(A){return A.hitTest(this.getTopLeft())&&A.hitTest(this.getTopRight())&&A.hitTest(this.getBottomLeft())&&A.hitTest(this.getBottomRight())},intersects:function(A){x11=A.x,y11=A.y,x12=A.x+A.w,y12=A.y+A.h,x21=this.x,y21=this.y,x22=this.x+this.w,y22=this.y+this.h;x_overlap=Math.max(0,Math.min(x12,x22)-Math.max(x11,x21));y_overlap=Math.max(0,Math.min(y12,y22)-Math.max(y11,y21));return x_overlap*y_overlap!==0},toJSON:function(){return{width:this.w,height:this.h,x:this.x,y:this.y}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandType.js' */
(function ($) {draw2d.command.CommandType=Class.extend({NAME:"draw2d.command.CommandType",init:function(A){this.policy=A},getPolicy:function(){return this.policy}});draw2d.command.CommandType.DELETE="DELETE";draw2d.command.CommandType.MOVE="MOVE";draw2d.command.CommandType.CONNECT="CONNECT";draw2d.command.CommandType.MOVE_BASEPOINT="MOVE_BASEPOINT";draw2d.command.CommandType.RESIZE="RESIZE";draw2d.command.CommandType.RESET="RESET";}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/Command.js' */
(function ($) {draw2d.command.Command=Class.extend({NAME:"draw2d.command.Command",init:function(A){this.label=A},getLabel:function(){return this.label},canExecute:function(){return true},execute:function(){},cancel:function(){},undo:function(){},redo:function(){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandCollection.js' */
(function ($) {draw2d.command.CommandCollection=draw2d.command.Command.extend({NAME:"draw2d.command.CommandCollection",init:function(){this._super("Execute Commands");this.commands=new draw2d.util.ArrayList()},add:function(A){this.commands.add(A)},execute:function(){this.commands.each(function(A,B){B.execute()})},redo:function(){this.commands.each(function(A,B){B.redo()})},undo:function(){this.commands.reverse();this.commands.each(function(A,B){B.undo()});this.commands.reverse()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandStack.js' */
(function ($) {draw2d.command.CommandStack=Class.extend({NAME:"draw2d.command.CommandStack",init:function(){this.undostack=[];this.redostack=[];this.maxundo=50;this.transactionCommand=null;this.eventListeners=new draw2d.util.ArrayList()},setUndoLimit:function(A){this.maxundo=A},markSaveLocation:function(){this.undostack=[];this.redostack=[];this.notifyListeners(new draw2d.command.Command(),draw2d.command.CommandStack.POST_EXECUTE)},execute:function(A){if(A===null){return }if(typeof A==="undefined"){throw"Missing parameter [command] for method call CommandStack.execute"}if(A.canExecute()===false){return }if(this.transactionCommand!==null){this.transactionCommand.add(A);return }this.notifyListeners(A,draw2d.command.CommandStack.PRE_EXECUTE);this.undostack.push(A);A.execute();this.redostack=[];if(this.undostack.length>this.maxundo){this.undostack=this.undostack.slice(this.undostack.length-this.maxundo)}this.notifyListeners(A,draw2d.command.CommandStack.POST_EXECUTE)},startTransaction:function(){this.transactionCommand=new draw2d.command.CommandCollection()},commitTransaction:function(){if(this.transactionCommand===null){return }var A=this.transactionCommand;this.transactionCommand=null;this.execute(A)},undo:function(){var A=this.undostack.pop();if(A){this.notifyListeners(A,draw2d.command.CommandStack.PRE_UNDO);this.redostack.push(A);A.undo();this.notifyListeners(A,draw2d.command.CommandStack.POST_UNDO)}},redo:function(){var A=this.redostack.pop();if(A){this.notifyListeners(A,draw2d.command.CommandStack.PRE_REDO);this.undostack.push(A);A.redo();this.notifyListeners(A,draw2d.command.CommandStack.POST_REDO)}},getRedoLabel:function(){if(this.redostack.lenght===0){return""}var A=this.redostack[this.redostack.length-1];if(A){return A.getLabel()}return""},getUndoLabel:function(){if(this.undostack.lenght===0){return""}var A=this.undostack[this.undostack.length-1];if(A){return A.getLabel()}return""},canRedo:function(){return this.redostack.length>0},canUndo:function(){return this.undostack.length>0},addEventListener:function(A){if(A instanceof draw2d.command.CommandStackEventListener){this.eventListeners.add(A)}else{if(typeof A.stackChanged==="function"){this.eventListeners.add(A)}else{if(typeof A==="function"){this.eventListeners.add({stackChanged:A})}else{throw"Object doesn't implement required callback interface [draw2d.command.CommandStackListener]"}}}},removeEventListener:function(C){for(var A=0;A<size;A++){var B=this.eventListeners.get(A);if(B===C||B.stackChanged===C){this.eventListeners.remove(B);return }}},notifyListeners:function(E,D){var C=new draw2d.command.CommandStackEvent(this,E,D);var B=this.eventListeners.getSize();for(var A=0;A<B;A++){this.eventListeners.get(A).stackChanged(C)}}});draw2d.command.CommandStack.PRE_EXECUTE=1;draw2d.command.CommandStack.PRE_REDO=2;draw2d.command.CommandStack.PRE_UNDO=4;draw2d.command.CommandStack.POST_EXECUTE=8;draw2d.command.CommandStack.POST_REDO=16;draw2d.command.CommandStack.POST_UNDO=32;draw2d.command.CommandStack.POST_INIT=64;draw2d.command.CommandStack.POST_MASK=draw2d.command.CommandStack.POST_EXECUTE|draw2d.command.CommandStack.POST_UNDO|draw2d.command.CommandStack.POST_REDO;draw2d.command.CommandStack.PRE_MASK=draw2d.command.CommandStack.PRE_EXECUTE|draw2d.command.CommandStack.PRE_UNDO|draw2d.command.CommandStack.PRE_REDO;}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandStackEvent.js' */
(function ($) {draw2d.command.CommandStackEvent=Class.extend({NAME:"draw2d.command.CommandStackEvent",init:function(A,C,B){this.stack=A;this.command=C;this.details=B},getStack:function(){return this.stack},getCommand:function(){return this.command},getDetails:function(){return this.details},isPostChangeEvent:function(){return 0!=(this.getDetails()&draw2d.command.CommandStack.POST_MASK)},isPreChangeEvent:function(){return 0!=(this.getDetails()&draw2d.command.CommandStack.PRE_MASK)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandStackEventListener.js' */
(function ($) {draw2d.command.CommandStackEventListener=Class.extend({NAME:"draw2d.command.CommandStackEventListener",init:function(){},stackChanged:function(A){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandMove.js' */
(function ($) {draw2d.command.CommandMove=draw2d.command.Command.extend({NAME:"draw2d.command.CommandMove",init:function(B,A,C){this._super("Shape moved");this.figure=B;if(typeof A==="undefined"){this.oldX=B.getX();this.oldY=B.getY()}else{this.oldX=A;this.oldY=C}},setStartPosition:function(A,B){this.oldX=A;this.oldY=B},setPosition:function(A,B){this.newX=A;this.newY=B},canExecute:function(){return this.newX!=this.oldX||this.newY!=this.oldY},execute:function(){this.redo()},undo:function(){this.figure.setPosition(this.oldX,this.oldY)},redo:function(){this.figure.setPosition(this.newX,this.newY)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandMoveLine.js' */
(function ($) {draw2d.command.CommandMoveLine=draw2d.command.Command.extend({NAME:"draw2d.command.CommandMoveLine",init:function(B,C,A,E,D){this._super("Line moved");this.line=B;this.startX1=C;this.startY1=A;this.endX1=E;this.endY1=D;this.startX2=-1;this.startY2=-1;this.endX2=-1;this.endY2=-1},canExecute:function(){return this.startX1!=this.startX2||this.startY1!=this.startY2||this.endX1!=this.endX2||this.endY1!=this.endY2},execute:function(){this.startX2=this.line.getStartX();this.startY2=this.line.getStartY();this.endX2=this.line.getEndX();this.endY2=this.line.getEndY();this.redo()},undo:function(){this.line.setStartPoint(this.startX1,this.startY1);this.line.setEndPoint(this.endX1,this.endY1)},redo:function(){this.line.setStartPoint(this.startX2,this.startY2);this.line.setEndPoint(this.endX2,this.endY2)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandResize.js' */
(function ($) {draw2d.command.CommandResize=draw2d.command.Command.extend({NAME:"draw2d.command.CommandResize",init:function(B,C,A){this._super("Resize Shape");this.figure=B;if(typeof C==="undefined"){this.oldWidth=B.getWidth();this.oldHeight=B.getHeight()}else{this.oldWidth=C;this.oldHeight=A}},setDimension:function(B,A){this.newWidth=B|0;this.newHeight=A|0},canExecute:function(){return this.newWidth!=this.oldWidth||this.newHeight!=this.oldHeight},execute:function(){this.redo()},undo:function(){this.figure.setDimension(this.oldWidth,this.oldHeight)},redo:function(){this.figure.setDimension(this.newWidth,this.newHeight)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandConnect.js' */
(function ($) {draw2d.command.CommandConnect=draw2d.command.Command.extend({NAME:"draw2d.command.CommandConnect",init:function(A,B,C){this._super("Connecting Ports");this.canvas=A;this.source=B;this.target=C;this.connection=null},setConnection:function(A){this.connection=A},execute:function(){if(this.connection===null){this.connection=draw2d.Connection.createConnection(this.source,this.target)}this.connection.setSource(this.source);this.connection.setTarget(this.target);this.canvas.addFigure(this.connection);this.canvas.onNewConnection(this.connection)},redo:function(){this.canvas.addFigure(this.connection);this.connection.reconnect()},undo:function(){this.canvas.removeFigure(this.connection)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandReconnect.js' */
(function ($) {draw2d.command.CommandReconnect=draw2d.command.Command.extend({NAME:"draw2d.command.CommandReconnect",init:function(A){this._super("Connecting Ports");this.con=A;this.oldSourcePort=A.getSource();this.oldTargetPort=A.getTarget();this.oldRouter=A.getRouter()},canExecute:function(){return true},setNewPorts:function(A,B){this.newSourcePort=A;this.newTargetPort=B},execute:function(){this.redo()},cancel:function(){this.con.calculatePath();this.con.setRouter(this.oldRouter)},undo:function(){this.con.setSource(this.oldSourcePort);this.con.setTarget(this.oldTargetPort);this.con.setRouter(this.oldRouter);this.con.onReconnect(this.con.getSource(),this.con.getTarget())},redo:function(){this.con.setSource(this.newSourcePort);this.con.setTarget(this.newTargetPort);this.con.setRouter(this.oldRouter);this.con.onReconnect(this.con.getSource(),this.con.getTarget())}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandDelete.js' */
(function ($) {draw2d.command.CommandDelete=draw2d.command.Command.extend({init:function(A){this._super("Deleting Shape");this.parent=A.getParent();this.figure=A;this.canvas=A.getCanvas();this.connections=null},execute:function(){this.redo()},undo:function(){this.canvas.addFigure(this.figure);if(this.figure instanceof draw2d.Connection){this.figure.reconnect()}this.canvas.setCurrentSelection(this.figure);if(this.parent!==null){this.parent.addChild(this.figure)}for(var A=0;A<this.connections.getSize();++A){this.canvas.addFigure(this.connections.get(A));this.connections.get(A).reconnect()}},redo:function(){this.canvas.setCurrentSelection(null);if(this.figure instanceof draw2d.shape.node.Node&&this.connections===null){this.connections=new draw2d.util.ArrayList();var E=this.figure.getPorts();for(var C=0;C<E.getSize();C++){var A=E.get(C);for(var D=0,B=A.getConnections().getSize();D<B;D++){if(!this.connections.contains(A.getConnections().get(D))){this.connections.add(A.getConnections().get(D))}}}for(var C=0;C<E.getSize();C++){var A=E.get(C);A.setCanvas(null)}}this.canvas.removeFigure(this.figure);if(this.connections===null){this.connections=new draw2d.util.ArrayList()}if(this.parent!==null){this.parent.removeChild(this.figure)}for(var C=0;C<this.connections.getSize();++C){this.canvas.removeFigure(this.connections.get(C))}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandAdd.js' */
(function ($) {draw2d.command.CommandAdd=draw2d.command.Command.extend({init:function(C,B,A,D){this._super("Add Shape");this.figure=B;this.canvas=C;this.x=A;this.y=D},execute:function(){this.canvas.addFigure(this.figure,this.x,this.y)},redo:function(){this.execute()},undo:function(){this.canvas.removeFigure(this.figure)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/connection/ConnectionRouter.js' */
(function ($) {draw2d.layout.connection.ConnectionRouter=Class.extend({NAME:"draw2d.layout.connection.ConnectionRouter",init:function(){},route:function(A){throw"subclasses must implement the method [ConnectionRouter.route]"}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/connection/DirectRouter.js' */
(function ($) {draw2d.layout.connection.DirectRouter=draw2d.layout.connection.ConnectionRouter.extend({NAME:"draw2d.layout.connection.DirectRouter",init:function(){},invalidate:function(){},route:function(B){var D=B.getStartPoint();var A=B.getEndPoint();B.addPoint(D);B.addPoint(A);var C=["M",D.x," ",D.y];C.push("L",A.x," ",A.y);B.svgPathString=C.join("")}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/connection/ManhattanConnectionRouter.js' */
(function ($) {draw2d.layout.connection.ManhattanConnectionRouter=draw2d.layout.connection.ConnectionRouter.extend({NAME:"draw2d.layout.connection.ManhattanConnectionRouter",MINDIST:20,TOL:0.1,TOLxTOL:0.01,TOGGLE_DIST:5,init:function(){},route:function(D){var E=D.getStartPoint();var G=D.getSource().getConnectionDirection(D,D.getTarget());var H=D.getEndPoint();var C=D.getTarget().getConnectionDirection(D,D.getSource());this._route(D,H,C,E,G);var A=D.getPoints();var B=A.get(0);var I=["M",(B.x|0)+0.5," ",(B.y|0)+0.5];for(var F=1;F<A.getSize();F++){B=A.get(F);I.push("L",(B.x|0)+0.5," ",(B.y|0)+0.5)}D.svgPathString=I.join("")},_route:function(D,E,F,N,C){var M=0;var G=1;var K=2;var A=3;var J=E.x-N.x;var H=E.y-N.y;var L;var B;if(((J*J)<(this.TOLxTOL))&&((H*H)<(this.TOLxTOL))){D.addPoint(new draw2d.geo.Point(N.x,N.y));return }if(F===A){if((J>0)&&((H*H)<this.TOL)&&(C===G)){L=N;B=C}else{if(J<0){L=new draw2d.geo.Point(E.x-this.MINDIST,E.y)}else{if(((H>0)&&(C===K))||((H<0)&&(C===M))){L=new draw2d.geo.Point(N.x,E.y)}else{if(F==C){var I=Math.min(E.x,N.x)-this.MINDIST;L=new draw2d.geo.Point(I,E.y)}else{L=new draw2d.geo.Point(E.x-(J/2),E.y)}}}if(H>0){B=M}else{B=K}}}else{if(F===G){if((J<0)&&((H*H)<this.TOL)&&(C===A)){L=N;B=C}else{if(J>0){L=new draw2d.geo.Point(E.x+this.MINDIST,E.y)}else{if(((H>0)&&(C===K))||((H<0)&&(C===M))){L=new draw2d.geo.Point(N.x,E.y)}else{if(F===C){var I=Math.max(E.x,N.x)+this.MINDIST;L=new draw2d.geo.Point(I,E.y)}else{L=new draw2d.geo.Point(E.x-(J/2),E.y)}}}if(H>0){B=M}else{B=K}}}else{if(F===K){if(((J*J)<this.TOL)&&(H<0)&&(C===M)){L=N;B=C}else{if(H>0){L=new draw2d.geo.Point(E.x,E.y+this.MINDIST)}else{if(((J>0)&&(C===G))||((J<0)&&(C===A))){L=new draw2d.geo.Point(E.x,N.y)}else{if(F===C){var I=Math.max(E.y,N.y)+this.MINDIST;L=new draw2d.geo.Point(E.x,I)}else{L=new draw2d.geo.Point(E.x,E.y-(H/2))}}}if(J>0){B=A}else{B=G}}}else{if(F===M){if(((J*J)<this.TOL)&&(H>0)&&(C===K)){L=N;B=C}else{if(H<0){L=new draw2d.geo.Point(E.x,E.y-this.MINDIST)}else{if(((J>0)&&(C===G))||((J<0)&&(C===A))){L=new draw2d.geo.Point(E.x,N.y)}else{if(F===C){var I=Math.min(E.y,N.y)-this.MINDIST;L=new draw2d.geo.Point(E.x,I)}else{L=new draw2d.geo.Point(E.x,E.y-(H/2))}}}if(J>0){B=A}else{B=G}}}}}}this._route(D,L,B,N,C);D.addPoint(E)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/connection/ManhattanBridgedConnectionRouter.js' */
(function ($) {draw2d.layout.connection.ManhattanBridgedConnectionRouter=draw2d.layout.connection.ManhattanConnectionRouter.extend({NAME:"draw2d.layout.connection.ManhattanBridgedConnectionRouter",BRIDGE_HORIZONTAL_LR:" r 0 0 3 -4 7 -4 10 0 13 0 ",BRIDGE_HORIZONTAL_RL:" r 0 0 -3 -4 -7 -4 -10 0 -13 0 ",init:function(){},route:function(E){var F=E.getStartPoint();var K=E.getSource().getConnectionDirection(E,E.getTarget());var N=E.getEndPoint();var D=E.getTarget().getConnectionDirection(E,E.getSource());this._route(E,N,D,F,K);var O=E.getCanvas().getIntersection(E).sort("x");var L=O.clone().reverse();var G=O;var I=0;var A=E.getPoints();var B=A.get(0);var M=["M",(B.x|0)+0.5," ",(B.y|0)+0.5];var C=B;for(I=1;I<A.getSize();I++){B=A.get(I);var J=5;var H=this.BRIDGE_HORIZONTAL_LR;if(C.x>B.x){G=L;H=this.BRIDGE_HORIZONTAL_RL;J=-J}G.each(function(P,Q){if(Q.justTouching==false&&draw2d.shape.basic.Line.hit(1,C.x,C.y,B.x,B.y,Q.x,Q.y)===true){if(B.y===Q.y){M.push(" L",((Q.x-J)|0)+0.5," ",(Q.y|0)+0.5);M.push(H)}}});M.push(" L",(B.x|0)+0.5," ",(B.y|0)+0.5);C=B}E.svgPathString=M.join("")}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/connection/CircuitConnectionRouter.js' */
(function ($) {draw2d.layout.connection.CircuitConnectionRouter=draw2d.layout.connection.ManhattanConnectionRouter.extend({NAME:"draw2d.layout.connection.CircuitConnectionRouter",init:function(){this.setBridgeRadius(4);this.setJunctionRadius(2);this.abortRoutingOnFirstJunctionNode=false},setJunctionRadius:function(A){this.junctionRadius=A},setBridgeRadius:function(A){this.bridgeRadius=A;this.bridge_LR=[" r",0.5,-0.5,A-(A/2),-(A-A/4),A,-A,A+(A/2),-(A-A/4),A*2,"0 "].join(" ");this.bridge_RL=[" r",-0.5,-0.5,-(A-(A/2)),-(A-A/4),-A,-A,-(A+(A/2)),-(A-A/4),-A*2,"0 "].join(" ")},route:function(E){var F=E.getStartPoint();var L=E.getSource().getConnectionDirection(E,E.getTarget());var O=E.getEndPoint();var D=E.getTarget().getConnectionDirection(E,E.getSource());this._route(E,O,D,F,L);var P=E.getCanvas().getIntersection(E).sort("x");var M=P.clone().reverse();var G=P;var J=0;if(typeof E.junctionNodes!=="undefined"&&E.junctionNodes!==null){E.junctionNodes.remove()}E.junctionNodes=E.canvas.paper.set();var A=E.getPoints();var B=A.get(0);var N=["M",(B.x|0)+0.5," ",(B.y|0)+0.5];var C=B;var K=null;var I=null;var H=null;for(J=1;J<A.getSize();J++){B=A.get(J);if(C.x>B.x){G=M;I=this.bridge_RL;K=-this.bridgeRadius}else{G=P;I=this.bridge_LR;K=this.bridgeRadius}G.each($.proxy(function(S,U){if(draw2d.shape.basic.Line.hit(1,C.x,C.y,B.x,B.y,U.x,U.y)===true){if(E.sharingPorts(U.other)){var Q=U.other;var V=Q.getZOrder();var R=E.getZOrder();if(R<V){var T=E.canvas.paper.ellipse(U.x,U.y,this.junctionRadius,this.junctionRadius).attr({fill:E.lineColor.hash()});E.junctionNodes.push(T);if(this.abortRoutingOnFirstJunctionNode===true){if(E.getSource()==Q.getSource()||E.getSource()==Q.getTarget()){N=["M",(U.x|0)+0.5," ",(U.y|0)+0.5];if(H!==null){H.remove();E.junctionNodes.exclude(H)}}H=T}}}else{if(B.y===U.y){N.push(" L",((U.x-K)|0)+0.5," ",(U.y|0)+0.5);N.push(I)}}}},this));N.push(" L",(B.x|0)+0.5," ",(B.y|0)+0.5);C=B}E.svgPathString=N.join("")}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/connection/SplineConnectionRouter.js' */
(function ($) {draw2d.layout.connection.SplineConnectionRouter=draw2d.layout.connection.ManhattanConnectionRouter.extend({NAME:"draw2d.layout.connection.SplineConnectionRouter",init:function(){this.spline=new draw2d.util.spline.CubicSpline();this.MINDIST=50,this.cheapRouter=null},route:function(D){var F=0;var E=D.getStartPoint();var G=D.getSource().getConnectionDirection(D,D.getTarget());var J=D.getEndPoint();var C=D.getTarget().getConnectionDirection(D,D.getSource());this._route(D,J,C,E,G);var A=D.getPoints();D.oldPoint=null;D.lineSegments=new draw2d.util.ArrayList();D.basePoints=new draw2d.util.ArrayList();var H=this.spline.generate(A,8);H.each(function(K,L){D.addPoint(L)});var A=D.getPoints();length=A.getSize();var B=A.get(0);var I=["M",B.x," ",B.y];for(F=1;F<length;F++){B=A.get(F);I.push("L",B.x," ",B.y)}D.svgPathString=I.join("")}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/connection/FanConnectionRouter.js' */
(function ($) {draw2d.layout.connection.FanConnectionRouter=draw2d.layout.connection.DirectRouter.extend({NAME:"gdraw2d.layout.connection.FanConnectionRouter",init:function(){},route:function(F){var B=F.getSource().getConnections();var E=new draw2d.util.ArrayList();var C=0;for(var D=0;D<B.getSize();D++){var A=B.get(D);if(A.getTarget()===F.getTarget()||A.getSource()===F.getTarget()){E.add(A);if(F===A){C=E.getSize()}}}if(E.getSize()>1){this.routeCollision(F,C)}else{this._super(F)}},routeCollision:function(F,L){var C=F.getStartPoint();var I=F.getEndPoint();var H=15;var N=new draw2d.geo.Point((I.x+C.x)/2,(I.y+C.y)/2);var K=I.getPosition(C);var O;if(K==draw2d.geo.PositionConstants.SOUTH||K==draw2d.geo.PositionConstants.EAST){O=new draw2d.geo.Point(I.x-C.x,I.y-C.y)}else{O=new draw2d.geo.Point(C.x-I.x,C.y-I.y)}var D=Math.sqrt(O.x*O.x+O.y*O.y);var M=H*O.x/D;var G=H*O.y/D;var E;if(L%2===0){E=new draw2d.geo.Point(N.x+(L/2)*(-1*G),N.y+(L/2)*M)}else{E=new draw2d.geo.Point(N.x+(L/2)*G,N.y+(L/2)*(-1*M))}F.addPoint(C);F.addPoint(E);F.addPoint(I);var A=F.getPoints();var B=A.get(0);var P=["M",B.x," ",B.y];for(var J=1;J<A.getSize();J++){B=A.get(J);P.push("L",B.x," ",B.y)}F.svgPathString=P.join("")}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/connection/MazeConnectionRouter.js' */
(function ($) {var ROUTER_RECTS=null;draw2d.layout.connection.MazeConnectionRouter=draw2d.layout.connection.ConnectionRouter.extend({NAME:"draw2d.layout.connection.MazeConnectionRouter",init:function(){this.useSpline=false;this.useSimplify=true;this.useSimplifyValue=2;this.useDebug=false;this.useShift=4;this.portOutletOffset=15;this.finder=new PF.JumpPointFinder({allowDiagonal:false,dontCrossCorners:true})},route:function(D){var E=D.getStartPoint();var G=D.getSource().getConnectionDirection(D,D.getTarget());var H=D.getEndPoint();var C=D.getTarget().getConnectionDirection(D,D.getSource());this._route(D,H,C,E,G);var A=D.getPoints();var B=A.get(0);var I=["M",(B.x|0)+0.5," ",(B.y|0)+0.5];for(var F=1;F<A.getSize();F++){B=A.get(F);I.push("L",(B.x|0)+0.5," ",(B.y|0)+0.5)}D.svgPathString=I.join("")},_route:function(E,F,J,M,D){var C=this.useShift;oldToPt=M;oldFromPt=F;F=this.getAddjustedPoint(F,J,this.portOutletOffset);M=this.getAddjustedPoint(M,D,this.portOutletOffset);var A=this.generateNoGoGrid(E,F,J,M,D);var N=this.finder.findPath(F.x>>C,F.y>>C,M.x>>C,M.y>>C,A);$.each(N,function(O,P){P.x=P[0]=P[0]<<C;P.y=P[1]=P[1]<<C});if(this.useDebug){if(ROUTER_RECTS!==null){ROUTER_RECTS.remove()}ROUTER_RECTS=E.canvas.paper.set();for(var H=0;H<A.width;H++){for(var G=0;G<A.height;G++){if(!A.isWalkableAt(H,G)){ROUTER_RECTS.push(E.canvas.paper.rect(H<<C,G<<C,1<<C,1<<C).attr({fill:"red",opacity:"0.1"}))}}}ROUTER_RECTS.push(E.canvas.paper.rect(F.x-3,F.y-3,6,6).attr({fill:"#ff0000",opacity:"0.8"}));ROUTER_RECTS.push(E.canvas.paper.rect(M.x-3,M.y-3,6,6).attr({fill:"#ff0000",opacity:"0.8"}));$.each(N,function(O,P){ROUTER_RECTS.push(E.canvas.paper.rect(P.x-3,P.y-3,6,6).attr({fill:"#0000ff",opacity:"0.8"}))});var B=N[0];var K=["M",B.x," ",B.y];for(var H=1;H<N.length;H++){B=N[H];K.push("L",B.x," ",B.y)}K=K.join("");ROUTER_RECTS.push(E.canvas.paper.path(K).attr({stroke:"#0000ff"}))}this.adjustPath(F,N,J);N.reverse();this.adjustPath(M,N,D);N.reverse();$.each(N,function(O,P){P.x=P[0];P.y=P[1]});if(this.useSpline){var B=new draw2d.util.ArrayList();B.add(oldFromPt);$.each(N,function(O,P){B.add(new draw2d.geo.Point(P[0],P[1]))});B.add(oldToPt);if(this.useDebug){$.each(N,function(O,P){ROUTER_RECTS.push(E.canvas.paper.rect(P.x-3,P.y-3,6,6).attr({fill:"#00ff00",opacity:"0.8"}))});var L=N[0];var K=["M",L.x," ",L.y];for(var H=1;H<N.length;H++){L=N[H];K.push("L",L.x," ",L.y)}K=K.join("");ROUTER_RECTS.push(E.canvas.paper.path(K).attr({stroke:"#00ff00"}))}this.spline=new draw2d.util.spline.CubicSpline();var I=this.spline.generate(B,8);if(this.useSimplify){N=[];I.each(function(O,P){N.push({x:P.x,y:P.y})});N=this.simplify(N,this.useSimplifyValue,true);$.each(N,function(O,P){E.addPoint(P.x,P.y)})}else{I.each(function(O,P){E.addPoint(P)})}}else{if(this.useSimplify){N=this.simplify(N,this.useSimplifyValue,true)}if(this.useDebug){$.each(N,function(O,P){ROUTER_RECTS.push(E.canvas.paper.rect(P.x-3,P.y-3,6,6).attr({fill:"#00ff00",opacity:"0.8"}))});var B=N[0];var K=["M",B.x," ",B.y];for(var H=1;H<N.length;H++){B=N[H];K.push("L",B.x," ",B.y)}K=K.join("");ROUTER_RECTS.push(E.canvas.paper.path(K).attr({stroke:"#00ff00"}))}E.addPoint(oldFromPt);$.each(N,function(O,P){E.addPoint(P[0],P[1])});E.addPoint(oldToPt)}},generateNoGoGrid:function(F,G,C,I,B){var Q=this.useShift;var L=(1<<Q)/2;var R=F.getCanvas().paper.width>>Q;var D=F.getCanvas().paper.height>>Q;var A=new PF.Grid(R,D);var E=F.getCanvas().getFigures();E.each(function(V,Y){var X=Y.getBoundingBox();if(X.hitTest(G.x,G.y)===true||X.hitTest(I.x,I.y)){return }var T=X.x>>Q;var Z=X.y>>Q;if(T<1||Z<1){return }var W=(X.x+X.w+L)>>Q;var S=(X.y+X.h+L)>>Q;for(var V=T;V<=W;V++){for(var U=Z;U<=S;U++){A.setWalkableAt(V,U,false)}}});var K=F.getSource().getParent().getBoundingBox();if(B===1||B===3){var H=K.y>>Q;if(H>0){var M=K.y+K.h;var P=(I.x>>Q);for(var N=H-1;N<<Q<=M;N++){A.setWalkableAt(P,N,true)}}}else{var J=K.x>>Q;if(J>0){var O=K.x+K.w;var N=(I.x>>Q);for(var P=J-1;P<<Q<=O;P++){A.setWalkableAt(P,N,true)}}}K=F.getTarget().getParent().getBoundingBox();if(C===1||C===3){var H=K.y>>Q;if(H>0){var M=K.y+K.h;var P=(G.x>>Q);for(var N=H-1;N<<Q<=M;N++){A.setWalkableAt(P,N,true)}}}else{var J=K.x>>Q;if(J>0){var O=K.x+K.w;var N=(G.x>>Q);for(var P=J-1;P<<Q<=O;P++){A.setWalkableAt(P,N,true)}}}return A},getAddjustedPoint:function(C,B,A){switch(B){case 0:return new draw2d.geo.Point(C.x,C.y-A);case 1:return new draw2d.geo.Point(C.x+A,C.y);case 2:return new draw2d.geo.Point(C.x,C.y+A);case 3:return new draw2d.geo.Point(C.x-A,C.y)}},adjustPath:function(E,D,C){var B=this.useShift;var A=E.x>>B;var F=E.y>>B;$.each(D,function(G,H){if(F===(H[1]>>B)){H[1]=E.y}else{return false}});$.each(D,function(G,H){if(A===(H[0]>>B)){H[0]=E.x}else{return false}})},getSquareDistance:function(D,C){var B=D.x-C.x,A=D.y-C.y;return B*B+A*A},getSquareSegmentDistance:function(F,G,E){var A=G.x,H=G.y,C=E.x-A,B=E.y-H,D;if(C!==0||B!==0){D=((F.x-A)*C+(F.y-H)*B)/(C*C+B*B);if(D>1){A=E.x;H=E.y}else{if(D>0){A+=C*D;H+=B*D}}}C=F.x-A;B=F.y-H;return C*C+B*B},simplifyRadialDistance:function(F,D){var E,B=F.length,A,C=F[0],G=[C];for(E=1;E<B;E++){A=F[E];if(this.getSquareDistance(A,C)>D){G.push(A);C=A}}if(C!==A){G.push(A)}return G},simplifyDouglasPeucker:function(M,A){var I=M.length,K=(typeof Uint8Array!==undefined+"")?Uint8Array:Array,C=new K(I),G=0,L=I-1,E,D,F,H,B=[],J=[],N=[];C[G]=C[L]=1;while(L){D=0;for(E=G+1;E<L;E++){F=this.getSquareSegmentDistance(M[E],M[G],M[L]);if(F>D){H=E;D=F}}if(D>A){C[H]=1;B.push(G);J.push(H);B.push(H);J.push(L)}G=B.pop();L=J.pop()}for(E=0;E<I;E++){if(C[E]){N.push(M[E])}}return N},simplify:function(C,A,D){var B=(A!==undefined)?A*A:1;if(!D){C=this.simplifyRadialDistance(C,B)}C=this.simplifyDouglasPeucker(C,B);return C}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/connection/SketchConnectionRouter.js' */
(function ($) {draw2d.layout.connection.SketchConnectionRouter=draw2d.layout.connection.MazeConnectionRouter.extend({NAME:"draw2d.layout.connection.SketchConnectionRouter",init:function(){this._super();this.useSpline=true;this.useShift=5;this.useSimplifyValue=0.2;this.finder=new PF.JumpPointFinder({allowDiagonal:false,dontCrossCorners:true})}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/mesh/MeshLayouter.js' */
(function ($) {draw2d.layout.mesh.MeshLayouter=Class.extend({init:function(){},add:function(B,A){return new draw2d.util.ArrayList()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/mesh/ExplodeLayouter.js' */
(function ($) {draw2d.layout.mesh.ExplodeLayouter=draw2d.layout.mesh.MeshLayouter.extend({MIN_MARGIN:40,init:function(){},add:function(A,E){var J=[];J[0]={x:0,y:0};J[1]={x:0,y:0};J[2]={x:0,y:0};J[3]={x:0,y:0};J[4]={x:0,y:0};J[5]={x:0,y:0};J[6]={x:0,y:0};J[7]={x:0,y:0};J[8]={x:0,y:0};var C=E.getBoundingBox();var H=A.getFigures();var I=null;var B=0;var G=0;var F=null;var D=0;for(D=0;D<H.getSize();D++){I=H.get(D);if(I!==E){B=I.getBoundingBox().getDistance(C);if(B<this.MIN_MARGIN){G=this.determineOctant(C,I.getBoundingBox());switch(G){case 2:J[2].x=Math.max(J[2].x,this.MIN_MARGIN-B);J[3].x=Math.max(J[3].x,this.MIN_MARGIN-B);J[4].x=Math.max(J[4].x,this.MIN_MARGIN-B);break;case 3:J[2].x=Math.max(J[2].x,this.MIN_MARGIN-B);J[3].x=Math.max(J[3].x,this.MIN_MARGIN-B);J[4].x=Math.max(J[4].x,this.MIN_MARGIN-B);break;case 4:J[2].x=Math.max(J[2].x,this.MIN_MARGIN-B);J[3].x=Math.max(J[3].x,this.MIN_MARGIN-B);J[4].x=Math.max(J[4].x,this.MIN_MARGIN-B);J[4].y=Math.max(J[4].y,this.MIN_MARGIN-B);J[5].y=Math.max(J[5].y,this.MIN_MARGIN-B);J[6].y=Math.max(J[6].y,this.MIN_MARGIN-B);break;case 5:J[4].y=Math.max(J[4].y,this.MIN_MARGIN-B);J[5].y=Math.max(J[5].y,this.MIN_MARGIN-B);J[6].y=Math.max(J[6].y,this.MIN_MARGIN-B);break;case 6:J[4].y=Math.max(J[4].y,this.MIN_MARGIN-B);J[5].y=Math.max(J[5].y,this.MIN_MARGIN-B);J[6].y=Math.max(J[6].y,this.MIN_MARGIN-B);break;case 8:B=(C.getBottomRight().getDistance(I.getBoundingBox().getTopLeft()))|0;J[2].x=Math.max(J[2].x,this.MIN_MARGIN+B);J[3].x=Math.max(J[3].x,this.MIN_MARGIN+B);J[4].x=Math.max(J[4].x,this.MIN_MARGIN+B);J[4].y=Math.max(J[4].y,this.MIN_MARGIN+B);J[5].y=Math.max(J[5].y,this.MIN_MARGIN+B);J[6].y=Math.max(J[6].y,this.MIN_MARGIN+B);J[8].x=Math.max(J[8].x,this.MIN_MARGIN+B)}}}}var K=new draw2d.util.ArrayList();for(D=0;D<H.getSize();D++){I=H.get(D);if(I!==E){G=this.determineOctant(C,I.getBoundingBox());F=J[G];if(F.x!==0||F.y!==0){K.add(new draw2d.layout.mesh.ProposedMeshChange(I,F.x,F.y))}}}return K},determineOctant:function(F,D){var C=F.x;var B=F.y;var E=F.w;var K=F.h;var H=D.x;var G=D.y;var I=D.w;var A=D.h;var J=0;if(H+I<=C){if((G+A)<=B){J=0}else{if(G>=(B+K)){J=6}else{J=7}}}else{if(H>=C+E){if(G+A<=B){J=2}else{if(G>=B+K){J=4}else{J=3}}}else{if(G+A<=B){J=1}else{if(G>=B+K){J=5}else{J=8}}}}return J}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/mesh/ProposedMeshChange.js' */
(function ($) {draw2d.layout.mesh.ProposedMeshChange=Class.extend({init:function(B,A,C){this.figure=B;this.x=A;this.y=C},getFigure:function(){return this.figure},getX:function(){return this.x},getY:function(){return this.y}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/Locator.js' */
(function ($) {draw2d.layout.locator.Locator=Class.extend({NAME:"draw2d.layout.locator.Locator",init:function(A){this.parent=A},getParent:function(){return this.parent},setParent:function(A){this.parent=A},relocate:function(B,A){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/PortLocator.js' */
(function ($) {draw2d.layout.locator.PortLocator=draw2d.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.PortLocator",init:function(){this._super()},applyConsiderRotation:function(A,G,F){var H=A.getParent();var I=H.getWidth()/2;var D=H.getHeight()/2;var C=H.getRotationAngle();var B=Raphael.matrix();B.rotate(C,I,D);if(C===90||C===270){var E=H.getHeight()/H.getWidth();B.scale(E,1/E,I,D)}A.setPosition(B.x(G,F),B.y(G,F))}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/InputPortLocator.js' */
(function ($) {draw2d.layout.locator.InputPortLocator=draw2d.layout.locator.PortLocator.extend({NAME:"draw2d.layout.locator.InputPortLocator",init:function(){this._super()},relocate:function(B,A){var D=A.getParent();var C=D.getHeight();var E=C/(D.getInputPorts().getSize()+1);this.applyConsiderRotation(A,0,E*(B+1))}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/OutputPortLocator.js' */
(function ($) {draw2d.layout.locator.OutputPortLocator=draw2d.layout.locator.PortLocator.extend({NAME:"draw2d.layout.locator.OutputPortLocator",init:function(){this._super()},relocate:function(B,A){var C=A.getParent();var D=C.getHeight()/(C.getOutputPorts().getSize()+1);this.applyConsiderRotation(A,C.getWidth(),D*(B+1))}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/ConnectionLocator.js' */
(function ($) {draw2d.layout.locator.ConnectionLocator=draw2d.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.ConnectionLocator",init:function(A){this._super(A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/ManhattanMidpointLocator.js' */
(function ($) {draw2d.layout.locator.ManhattanMidpointLocator=draw2d.layout.locator.ConnectionLocator.extend({NAME:"draw2d.layout.locator.ManhattanMidpointLocator",init:function(A){this._super(A)},relocate:function(C,D){var A=this.getParent();var H=A.getPoints();var B=Math.floor((H.getSize()-2)/2);if(H.getSize()<=B+1){return }var I=H.get(B);var G=H.get(B+1);if(!I||!G){return }var F=((G.x-I.x)/2+I.x-D.getWidth()/2)|0;var E=((G.y-I.y)/2+I.y-D.getHeight()/2)|0;D.setPosition(F,E)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/PolylineMidpointLocator.js' */
(function ($) {draw2d.layout.locator.PolylineMidpointLocator=draw2d.layout.locator.ManhattanMidpointLocator.extend({NAME:"draw2d.layout.locator.PolylineMidpointLocator",init:function(A){this._super(A)},relocate:function(A,D){var C=this.getParent();var B=C.getPoints();if(B.getSize()%2===0){this._super(A,D)}else{var A=Math.floor(B.getSize()/2);var E=B.get(A);D.setPosition(E.x-(D.getWidth()/2),E.y-(D.getHeight()/2))}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/TopLocator.js' */
(function ($) {draw2d.layout.locator.TopLocator=draw2d.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.TopLocator",init:function(A){this._super(A)},relocate:function(B,D){var C=this.getParent();var A=C.getBoundingBox();var E=D.getBoundingBox();if(D instanceof draw2d.Port){D.setPosition(A.w/2,2)}else{D.setPosition(A.w/2-(E.w/2),-(E.h+2))}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/BottomLocator.js' */
(function ($) {draw2d.layout.locator.BottomLocator=draw2d.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.BottomLocator",init:function(A){this._super(A)},relocate:function(B,D){var C=this.getParent();var A=C.getBoundingBox();var E=D.getBoundingBox();if(D instanceof draw2d.Port){D.setPosition(A.w/2,A.h-2)}else{D.setPosition(A.w/2-E.w/2,2+A.h)}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/LeftLocator.js' */
(function ($) {draw2d.layout.locator.LeftLocator=draw2d.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.LeftLocator",init:function(A){this._super(A)},relocate:function(B,D){var C=this.getParent();var A=C.getBoundingBox();var E=D.getBoundingBox();if(D instanceof draw2d.Port){D.setPosition(2,A.h/2)}else{D.setPosition(-E.w-5,(A.h/2)-(E.h/2))}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/RightLocator.js' */
(function ($) {draw2d.layout.locator.RightLocator=draw2d.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.RightLocator",init:function(A){this._super(A)},relocate:function(B,D){var C=this.getParent();var A=C.getBoundingBox();var E=D.getBoundingBox();if(D instanceof draw2d.Port){D.setPosition(A.w-2,A.h/2)}else{D.setPosition(A.w+5,(A.h/2)-(E.h/2))}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/CenterLocator.js' */
(function ($) {draw2d.layout.locator.CenterLocator=draw2d.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.CenterLocator",init:function(A){this._super(A)},relocate:function(B,D){var C=this.getParent();var A=C.getBoundingBox();if(D instanceof draw2d.Port){D.setPosition(A.w/2,A.h/2)}else{var E=D.getBoundingBox();D.setPosition(A.w/2-E.w/2,A.h/2-(E.h/2))}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/EditPolicy.js' */
(function ($) {draw2d.policy.EditPolicy=Class.extend({NAME:"draw2d.policy.EditPolicy",init:function(){},onInstall:function(A){},onUninstall:function(A){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/CanvasPolicy.js' */
(function ($) {draw2d.policy.canvas.CanvasPolicy=draw2d.policy.EditPolicy.extend({NAME:"draw2d.policy.canvas.CanvasPolicy",init:function(){this._super()},onInstall:function(A){},onUninstall:function(A){},onClick:function(A,B){},onMouseMove:function(B,A,C){},snap:function(C,A,B){return B},onMouseDown:function(B,A,C){},onMouseDrag:function(D,C,B,E,A){},onMouseUp:function(B,A,C){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/SelectionPolicy.js' */
(function ($) {draw2d.policy.canvas.SelectionPolicy=draw2d.policy.canvas.CanvasPolicy.extend({NAME:"draw2d.policy.canvas.SelectionPolicy",init:function(){this._super()},unselect:function(B,A){A.unselect();B.getSelection().remove(A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/SingleSelectionPolicy.js' */
(function ($) {draw2d.policy.canvas.SingleSelectionPolicy=draw2d.policy.canvas.SelectionPolicy.extend({NAME:"draw2d.policy.canvas.SingleSelectionPolicy",init:function(){this._super();this.mouseMovedDuringMouseDown=false;this.mouseDraggingElement=null;this.mouseDownElement=null},select:function(C,A){var B=C.getSelection().getPrimary();if(C.getSelection().getAll().contains(A)){return }if(B!==null){this.unselect(C,B)}if(A!==null){A.select(true)}C.getSelection().setPrimary(A);C.selectionListeners.each(function(E,D){D.onSelectionChanged(A,B)})},onMouseDown:function(C,B,E){this.mouseMovedDuringMouseDown=false;var D=true;var A=C.getBestFigure(B,E);while((A!==null&&A.getParent()!==null)&&!(A instanceof draw2d.Port)){A=A.getParent()}if(A!==null&&A.isDraggable()){D=A.onDragStart(B-A.getAbsoluteX(),E-A.getAbsoluteY());if(D===false){this.mouseDraggingElement=null;this.mouseDownElement=A}else{this.mouseDraggingElement=A;this.mouseDownElement=A}}if(A!==C.getSelection().getPrimary()&&A!==null&&A.isSelectable()===true){this.select(C,A);if(A instanceof draw2d.shape.basic.Line){if(!(A instanceof draw2d.Connection)){C.draggingLineCommand=A.createCommand(new draw2d.command.CommandType(draw2d.command.CommandType.MOVE));if(C.draggingLineCommand!==null){C.draggingLine=A}}}else{if(D===false){A.unselect()}}}},onMouseDrag:function(D,J,I,H,E){this.mouseMovedDuringMouseDown=true;if(this.mouseDraggingElement!==null){if(D.linesToRepaintAfterDragDrop.isEmpty()===true&&(this.mouseDraggingElement instanceof draw2d.shape.node.Node)){var F=this.mouseDraggingElement.getConnections();var A=D.lineIntersections.clone();D.lineIntersections.each($.proxy(function(L,K){if(F.contains(K.line)||F.contains(K.other)){A.remove(K);D.linesToRepaintAfterDragDrop.add(K.line);D.linesToRepaintAfterDragDrop.add(K.other)}},this));D.lineIntersections=A;D.linesToRepaintAfterDragDrop.each($.proxy(function(L,K){this.repaintLineAfterDragDrop(K)},this))}var C=D.getSelection().getAll();if(!C.contains(this.mouseDraggingElement)){this.mouseDraggingElement.onDrag(J,I)}else{C.each(function(L,K){K.onDrag(J,I)})}var B=D.fromDocumentToCanvasCoordinate(D.mouseDownX,D.mouseDownY).translate(J,I);var G=D.getBestFigure(B.x,B.y,this.mouseDraggingElement);if(G!==D.currentDropTarget){if(D.currentDropTarget!==null){D.currentDropTarget.onDragLeave(this.mouseDraggingElement);D.currentDropTarget=null}if(G!==null){D.currentDropTarget=G.onDragEnter(this.mouseDraggingElement)}}}else{if(this.mouseDownElement!==null&&!(this.mouseDownElement instanceof draw2d.Connection)){this.mouseDownElement.onPanning(J,I)}}},repaintLineAfterDragDrop:function(A){A.svgPathString=null;A.repaint()},onMouseUp:function(B,A,D){if(this.mouseDraggingElement!==null){var C=B.getSelection().getAll();if(!C.contains(this.mouseDraggingElement)){this.mouseDraggingElement.onDragEnd()}else{B.getCommandStack().startTransaction();B.getSelection().getAll().each(function(F,E){E.onDragEnd()});B.getCommandStack().commitTransaction()}if(B.currentDropTarget!==null){this.mouseDraggingElement.onDrop(B.currentDropTarget);B.currentDropTarget.onDragLeave(this.mouseDraggingElement);B.currentDropTarget=null}this.mouseDraggingElement=null}if((this.mouseDownElement===null||this.mouseDownElement.isSelectable()===false)&&this.mouseMovedDuringMouseDown===false){this.select(B,null)}this.mouseDownElement=null;this.mouseMovedDuringMouseDown=false}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/PanningSelectionPolicy.js' */
(function ($) {draw2d.policy.canvas.PanningSelectionPolicy=draw2d.policy.canvas.SingleSelectionPolicy.extend({NAME:"draw2d.policy.canvas.PanningSelectionPolicy",init:function(){this._super()},onMouseDrag:function(D,C,B,F,A){this._super(D,C,B,F,A);if(this.mouseDraggingElement===null&&this.mouseDownElement===null){var E=D.getScrollArea();E.scrollTop(E.scrollTop()+A);E.scrollLeft(E.scrollLeft()+F)}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/BoundingBoxSelectionPolicy.js' */
(function ($) {draw2d.policy.canvas.BoundingboxSelectionPolicy=draw2d.policy.canvas.SingleSelectionPolicy.extend({NAME:"draw2d.policy.canvas.BoundingboxSelectionPolicy",init:function(){this._super();this.boundingBoxFigure1=null;this.boundingBoxFigure2=null;this.x=0;this.y=0},select:function(B,A){if(B.getSelection().getAll().contains(A)){return }if(A!==null){A.select(true)}B.getSelection().setPrimary(A);B.selectionListeners.each(function(D,C){C.onSelectionChanged(A)})},onMouseDown:function(B,A,D){this.x=A;this.y=D;var C=B.getSelection().getAll();this._super(B,A,D);if(this.mouseDownElement!==null&&this.mouseDownElement.isResizeHandle===false&&!C.contains(this.mouseDownElement)){C.each($.proxy(function(F,E){this.unselect(B,E)},this))}C=B.getSelection().getAll();C.each($.proxy(function(F,E){var G=E.onDragStart(E.getAbsoluteX(),E.getAbsoluteY());if(E instanceof draw2d.shape.basic.Line){}else{if(G===false){this.unselect(B,E)}}},this))},onMouseDrag:function(D,C,B,E,A){this._super(D,C,B,E,A);if(this.mouseDraggingElement===null&&this.mouseDownElement===null&&this.boundingBoxFigure1===null){this.boundingBoxFigure1=new draw2d.shape.basic.Rectangle(1,1);this.boundingBoxFigure1.setPosition(this.x,this.y);this.boundingBoxFigure1.setCanvas(D);this.boundingBoxFigure1.setBackgroundColor("#0f0f0f");this.boundingBoxFigure1.setAlpha(0.1);this.boundingBoxFigure2=new draw2d.shape.basic.Rectangle(1,1);this.boundingBoxFigure2.setPosition(this.x,this.y);this.boundingBoxFigure2.setCanvas(D);this.boundingBoxFigure2.setDashArray("- ");this.boundingBoxFigure2.setStroke(1);this.boundingBoxFigure2.setColor(new draw2d.util.Color(84,151,220));this.boundingBoxFigure2.setBackgroundColor(null)}if(this.boundingBoxFigure1!==null){this.boundingBoxFigure1.setDimension(Math.abs(C),Math.abs(B));this.boundingBoxFigure1.setPosition(this.x+Math.min(0,C),this.y+Math.min(0,B));this.boundingBoxFigure2.setDimension(Math.abs(C),Math.abs(B));this.boundingBoxFigure2.setPosition(this.x+Math.min(0,C),this.y+Math.min(0,B))}},onMouseUp:function(B,A,F){if(this.mouseDownElement===null){B.getSelection().getAll().each($.proxy(function(H,G){this.unselect(B,G)},this))}else{if(this.mouseDownElement!==null&&this.mouseMovedDuringMouseDown===false){var E=B.getSelection().getAll();if(!E.contains(this.mouseDownElement)){B.getSelection().getAll().each($.proxy(function(H,G){this.unselect(B,G)},this))}}}this._super(B,A,F);if(this.boundingBoxFigure1!==null){var D=this.boundingBoxFigure1.getBoundingBox();B.getFigures().each($.proxy(function(H,G){if(G.getBoundingBox().isInside(D)){var I=G.onDragStart(G.getAbsoluteX(),G.getAbsoluteY());if(I===true){this.select(B,G,false)}}},this));var C=B.getSelection();B.getLines().each($.proxy(function(H,G){if(G instanceof draw2d.Connection){if(C.contains(G.getSource().getParent())&&C.contains(G.getTarget().getParent())){this.select(B,G,false)}}},this));this.boundingBoxFigure1.setCanvas(null);this.boundingBoxFigure1=null;this.boundingBoxFigure2.setCanvas(null);this.boundingBoxFigure2=null}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/ReadOnlySelectionPolicy.js' */
(function ($) {draw2d.policy.canvas.ReadOnlySelectionPolicy=draw2d.policy.canvas.SelectionPolicy.extend({NAME:"draw2d.policy.canvas.ReadOnlySelectionPolicy",init:function(){this._super()},onInstall:function(A){A.getAllPorts().each($.proxy(function(C,B){B.setVisible(false)},this))},onUninstall:function(A){A.getAllPorts().each($.proxy(function(C,B){B.setVisible(true)},this))},onMouseDrag:function(D,C,B,F,A){var E=D.getScrollArea();E.scrollTop(E.scrollTop()+A);E.scrollLeft(E.scrollLeft()+F)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/DecorationPolicy.js' */
(function ($) {draw2d.policy.canvas.DecorationPolicy=draw2d.policy.canvas.CanvasPolicy.extend({NAME:"draw2d.policy.canvas.DecorationPolicy",init:function(){this._super()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/FadeoutDecorationPolicy.js' */
(function ($) {draw2d.policy.canvas.FadeoutDecorationPolicy=draw2d.policy.canvas.DecorationPolicy.extend({NAME:"draw2d.policy.canvas.FadeoutDecorationPolicy",DEFAULT_FADEOUT_DURATION:30,TARGET_COLOR:new draw2d.util.Color("#707070"),init:function(){this._super();this.alpha=1;this.hidePortsCounter=this.DEFAULT_FADEOUT_DURATION;this.canvas=null},onInstall:function(A){this.canvas=A;this.timerId=window.setInterval($.proxy(this.onTimer,this),100);this.hidePortsCounter=1;this.alpha=0.1},onUninstall:function(A){window.clearInterval(this.timerId);this.canvas.getAllPorts().each($.proxy(function(C,B){B.setAlpha(1)},this))},onTimer:function(){this.hidePortsCounter--;if(this.hidePortsCounter<=0&&this.alpha>0){this.alpha=Math.max(0,this.alpha-0.05);this.canvas.getAllPorts().each($.proxy(function(B,A){A.setAlpha(this.alpha)},this));this.canvas.getSelection().getAll().each($.proxy(function(B,A){A.selectionHandles.each($.proxy(function(C,D){D.setAlpha(this.alpha)},this))},this))}else{if(this.hidePortsCounter>0&&this.alpha!==1){this.alpha=1;this.duringHide=false;this.canvas.getAllPorts().each($.proxy(function(B,A){A.setAlpha(this.alpha)},this));this.canvas.getSelection().getAll().each($.proxy(function(B,A){A.selectionHandles.each($.proxy(function(C,D){D.setAlpha(this.alpha)},this))},this))}}},onMouseDown:function(B,A,C){this.hidePortsCounter=this.DEFAULT_FADEOUT_DURATION},onMouseMove:function(B,A,C){this.hidePortsCounter=this.DEFAULT_FADEOUT_DURATION},onMouseDrag:function(D,C,B,E,A){this.hidePortsCounter=this.DEFAULT_FADEOUT_DURATION},onMouseUp:function(B,A,C){this.hidePortsCounter=this.DEFAULT_FADEOUT_DURATION}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/CoronaDecorationPolicy.js' */
(function ($) {draw2d.policy.canvas.CoronaDecorationPolicy=draw2d.policy.canvas.DecorationPolicy.extend({NAME:"draw2d.policy.canvas.CoronaDecorationPolicy",init:function(){this._super();this.startDragX=0;this.startDragY=0},onInstall:function(A){var B=A.getFigures();B.each(function(D,C){C.getPorts().each(function(E,F){F.setVisible(false)})})},onUninstall:function(A){var B=A.getFigures();B.each(function(D,C){C.getPorts().each(function(E,F){F.setVisible(true)})})},onMouseDown:function(B,A,C){this.startDragX=A;this.startDragY=C},onMouseMove:function(B,A,C){this.updatePorts(B,A,C)},onMouseDrag:function(D,C,B,E,A){this.updatePorts(D,this.startDragX+C,this.startDragY+B)},updatePorts:function(B,A,D){var C=B.getFigures();C.each(function(F,E){if(E.isVisible()===true&&E.hitTest(A,D,50)===true&&E instanceof draw2d.shape.node.Node){E.getPorts().each(function(G,H){H.setVisible(true)})}else{E.getPorts().each(function(G,H){H.setVisible(false)})}})}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/SnapToEditPolicy.js' */
(function ($) {draw2d.policy.canvas.SnapToEditPolicy=draw2d.policy.canvas.CanvasPolicy.extend({NAME:"draw2d.policy.canvas.SnapToEditPolicy",init:function(A){this._super();this.grid=A},snap:function(C,A,B){return B}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/SnapToGridEditPolicy.js' */
(function ($) {draw2d.policy.canvas.SnapToGridEditPolicy=draw2d.policy.canvas.SnapToEditPolicy.extend({NAME:"draw2d.policy.canvas.SnapToGridEditPolicy",GRID_COLOR:"#e0e0f0",GRID_WIDTH:10,init:function(A){this._super();this.canvas=null;this.lines=null;if(A){this.grid=A}else{this.grid=this.GRID_WIDTH}},onInstall:function(A){this.canvas=A;this.showGrid()},onUninstall:function(A){this.canvas=null;this.lines.remove()},snap:function(B,A,D){var C=A.getSnapToGridAnchor();D.x=D.x+C.x;D.y=D.y+C.y;D.x=this.grid*Math.floor(((D.x+this.grid/2)/this.grid));D.y=this.grid*Math.floor(((D.y+this.grid/2)/this.grid));D.x=D.x-C.x;D.y=D.y-C.y;return D},showGrid:function(){var B=this.canvas.initialWidth;var C=this.canvas.initialHeight;this.lines=this.canvas.paper.set();for(var A=this.grid;A<B;A+=this.grid){this.lines.push(this.canvas.paper.path("M "+A+" 0 l 0 "+C))}for(var D=this.grid;D<C;D+=this.grid){this.lines.push(this.canvas.paper.path("M 0 "+D+" l "+B+" 0"))}this.lines.attr({stroke:this.GRID_COLOR});this.lines.toBack()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/ShowGridEditPolicy.js' */
(function ($) {draw2d.policy.canvas.ShowGridEditPolicy=draw2d.policy.canvas.SnapToEditPolicy.extend({NAME:"draw2d.policy.canvas.ShowGridEditPolicy",GRID_COLOR:"#e0e0f0",GRID_WIDTH:10,init:function(A){this._super();this.canvas=null;this.lines=null;if(A){this.grid=A}else{this.grid=this.GRID_WIDTH}},onInstall:function(A){this.canvas=A;this.showGrid()},onUninstall:function(A){this.canvas=null;this.lines.remove()},snap:function(B,A,C){return C},showGrid:function(){var B=this.canvas.initialWidth;var C=this.canvas.initialHeight;this.lines=this.canvas.paper.set();for(var A=this.grid;A<B;A+=this.grid){this.lines.push(this.canvas.paper.path("M "+A+" 0 l 0 "+C))}for(var D=this.grid;D<C;D+=this.grid){this.lines.push(this.canvas.paper.path("M 0 "+D+" l "+B+" 0"))}this.lines.attr({stroke:this.GRID_COLOR});this.lines.toBack()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/SnapToGeometryEditPolicy.js' */
(function ($) {draw2d.SnapToHelper={};draw2d.SnapToHelper.NORTH=1;draw2d.SnapToHelper.SOUTH=4;draw2d.SnapToHelper.WEST=8;draw2d.SnapToHelper.EAST=16;draw2d.SnapToHelper.CENTER=32;draw2d.SnapToHelper.NORTH_EAST=draw2d.SnapToHelper.NORTH|draw2d.SnapToHelper.EAST;draw2d.SnapToHelper.NORTH_WEST=draw2d.SnapToHelper.NORTH|draw2d.SnapToHelper.WEST;draw2d.SnapToHelper.SOUTH_EAST=draw2d.SnapToHelper.SOUTH|draw2d.SnapToHelper.EAST;draw2d.SnapToHelper.SOUTH_WEST=draw2d.SnapToHelper.SOUTH|draw2d.SnapToHelper.WEST;draw2d.SnapToHelper.NORTH_SOUTH=draw2d.SnapToHelper.NORTH|draw2d.SnapToHelper.SOUTH;draw2d.SnapToHelper.EAST_WEST=draw2d.SnapToHelper.EAST|draw2d.SnapToHelper.WEST;draw2d.SnapToHelper.NSEW=draw2d.SnapToHelper.NORTH_SOUTH|draw2d.SnapToHelper.EAST_WEST;draw2d.policy.canvas.SnapToGeometryEditPolicy=draw2d.policy.canvas.SnapToEditPolicy.extend({NAME:"draw2d.policy.canvas.SnapToGeometryEditPolicy",SNAP_THRESHOLD:3,LINE_COLOR:"#1387E6",FADEOUT_DURATION:300,init:function(){this._super();this.rows=null;this.cols=null;this.vline=null;this.hline=null;this.canvas=null},onInstall:function(A){this.canvas=A},onUninstall:function(A){this.canvas=null},onMouseUp:function(B,A,C){this.rows=null;this.cols=null;this.hideVerticalLine();this.hideHorizontalLine()},snap:function(E,B,H){if(B instanceof draw2d.ResizeHandle){var F=B.getSnapToGridAnchor();H.x+=F.x;H.y+=F.y;var A=new draw2d.geo.Point(H.x,H.y);var D=B.getSnapToDirection();var G=this.snapPoint(D,H,A);if((D&draw2d.SnapToHelper.EAST_WEST)&&!(G&draw2d.SnapToHelper.EAST_WEST)){this.showVerticalLine(A.x)}else{this.hideVerticalLine()}if((D&draw2d.SnapToHelper.NORTH_SOUTH)&&!(G&draw2d.SnapToHelper.NORTH_SOUTH)){this.showHorizontalLine(A.y)}else{this.hideHorizontalLine()}A.x-=F.x;A.y-=F.y;return A}else{var C=new draw2d.geo.Rectangle(H.x,H.y,B.getWidth(),B.getHeight());var A=new draw2d.geo.Rectangle(H.x,H.y,B.getWidth(),B.getHeight());var D=draw2d.SnapToHelper.NSEW;var G=this.snapRectangle(C,A);if((D&draw2d.SnapToHelper.WEST)&&!(G&draw2d.SnapToHelper.WEST)){this.showVerticalLine(A.x)}else{if((D&draw2d.SnapToHelper.EAST)&&!(G&draw2d.SnapToHelper.EAST)){this.showVerticalLine(A.getX()+A.getWidth())}else{this.hideVerticalLine()}}if((D&draw2d.SnapToHelper.NORTH)&&!(G&draw2d.SnapToHelper.NORTH)){this.showHorizontalLine(A.y)}else{if((D&draw2d.SnapToHelper.SOUTH)&&!(G&draw2d.SnapToHelper.SOUTH)){this.showHorizontalLine(A.getY()+A.getHeight())}else{this.hideHorizontalLine()}}return A.getTopLeft()}return H},snapRectangle:function(A,F){var E=A.getTopLeft();var D=A.getBottomRight();var B=this.snapPoint(draw2d.SnapToHelper.NORTH_WEST,A.getTopLeft(),E);F.x=E.x;F.y=E.y;var C=this.snapPoint(draw2d.SnapToHelper.SOUTH_EAST,A.getBottomRight(),D);if(B&draw2d.SnapToHelper.WEST){F.x=D.x-A.getWidth()}if(B&draw2d.SnapToHelper.NORTH){F.y=D.y-A.getHeight()}return B|C},snapPoint:function(D,C,E){if(this.rows===null||this.cols===null){this.populateRowsAndCols()}if((D&draw2d.SnapToHelper.EAST)!==0){var G=this.getCorrectionFor(this.cols,C.getX()-1,1);if(G!==this.SNAP_THRESHOLD){D&=~draw2d.SnapToHelper.EAST;E.x+=G}}if((D&draw2d.SnapToHelper.WEST)!==0){var B=this.getCorrectionFor(this.cols,C.getX(),-1);if(B!==this.SNAP_THRESHOLD){D&=~draw2d.SnapToHelper.WEST;E.x+=B}}if((D&draw2d.SnapToHelper.SOUTH)!==0){var F=this.getCorrectionFor(this.rows,C.getY()-1,1);if(F!==this.SNAP_THRESHOLD){D&=~draw2d.SnapToHelper.SOUTH;E.y+=F}}if((D&draw2d.SnapToHelper.NORTH)!==0){var A=this.getCorrectionFor(this.rows,C.getY(),-1);if(A!==this.SNAP_THRESHOLD){D&=~draw2d.SnapToHelper.NORTH;E.y+=A}}return D},populateRowsAndCols:function(){var E=this.canvas.getSelection();this.rows=[];this.cols=[];var D=this.canvas.getFigures();var B=0;for(var C=0;C<D.getSize();C++){var A=D.get(C);if(!E.contains(A)){var F=A.getBoundingBox();this.cols[B*3]={type:-1,location:F.getX()};this.rows[B*3]={type:-1,location:F.getY()};this.cols[B*3+1]={type:0,location:F.x+(F.getWidth()-1)/2};this.rows[B*3+1]={type:0,location:F.y+(F.getHeight()-1)/2};this.cols[B*3+2]={type:1,location:F.getRight()-1};this.rows[B*3+2]={type:1,location:F.getBottom()-1};B++}}},getCorrectionFor:function(B,H,E){var C=this.SNAP_THRESHOLD;var A=this.SNAP_THRESHOLD;for(var D=0;D<B.length;D++){var F=B[D];var G;if(F.type===-1&&E!==0){G=Math.abs(H-F.location);if(G<C){C=G;A=F.location-H}}else{if(F.type===0&&E===0){G=Math.abs(H-F.location);if(G<C){C=G;A=F.location-H}}else{if(F.type===1&&E!==0){G=Math.abs(H-F.location);if(G<C){C=G;A=F.location-H}}}}}return A},showVerticalLine:function(A){if(this.vline!=null){return }this.vline=this.canvas.paper.path("M "+A+" 0 l 0 "+this.canvas.getHeight()).attr({stroke:this.LINE_COLOR,"stroke-width":1})},hideVerticalLine:function(A){if(this.vline==null){return }var B=this.vline;B.animate({opacity:0.1},this.FADEOUT_DURATION,function(){B.remove()});this.vline=null},showHorizontalLine:function(A){if(this.hline!=null){return }this.hline=this.canvas.paper.path("M 0 "+A+" l "+this.canvas.getWidth()+" 0").attr({stroke:this.LINE_COLOR,"stroke-width":1})},hideHorizontalLine:function(){if(this.hline==null){return }var A=this.hline;A.animate({opacity:0.1},this.FADEOUT_DURATION,function(){A.remove()});this.hline=null}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/DragDropEditPolicy.js' */
(function ($) {draw2d.policy.figure.DragDropEditPolicy=draw2d.policy.EditPolicy.extend({NAME:"draw2d.policy.figure.DragDropEditPolicy",init:function(){this._super()},onDragStart:function(B,A){A.shape.attr({cursor:"move"})},onDrag:function(B,A){},onDragEnd:function(B,A){A.shape.attr({cursor:"default"})},adjustPosition:function(B,A,C){if(A instanceof draw2d.geo.Point){return A}return new draw2d.geo.Point(A,C)},adjustDimension:function(A,B,C){return new draw2d.geo.Rectangle(0,0,B,C)},moved:function(B,A){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/RegionEditPolicy.js' */
(function ($) {draw2d.policy.figure.RegionEditPolicy=draw2d.policy.figure.DragDropEditPolicy.extend({NAME:"draw2d.policy.figure.RegionEditPolicy",init:function(A,D,B,C){this._super();if(A instanceof draw2d.geo.Rectangle){this.constRect=A}else{if(typeof C==="number"){this.constRect=new draw2d.geo.Rectangle(A,D,B,C)}else{throw"Invalid parameter. RegionConstraintPolicy need a rectangle as parameter in the constructor"}}},adjustPosition:function(B,A,D){var C=null;if(A instanceof draw2d.geo.Point){C=new draw2d.geo.Rectangle(A.x,A.y,B.getWidth(),B.getHeight())}else{C=new draw2d.geo.Rectangle(A,D,B.getWidth(),B.getHeight())}C=this.constRect.moveInside(C);return C.getTopLeft()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/HorizontalEditPolicy.js' */
(function ($) {draw2d.policy.figure.HorizontalEditPolicy=draw2d.policy.figure.DragDropEditPolicy.extend({NAME:"draw2d.policy.figure.HorizontalEditPolicy",init:function(){this._super()},adjustPosition:function(B,A,C){return new draw2d.geo.Point(A,B.getY())}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/VerticalEditPolicy.js' */
(function ($) {draw2d.policy.figure.VerticalEditPolicy=draw2d.policy.figure.DragDropEditPolicy.extend({NAME:"draw2d.policy.figure.VerticalEditPolicy",init:function(){this._super()},adjustPosition:function(B,A,C){return new draw2d.geo.Point(B.getX(),C)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/SelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.SelectionFeedbackPolicy=draw2d.policy.figure.DragDropEditPolicy.extend({NAME:"draw2d.policy.figure.SelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(B,A,C){},onUnselect:function(B,A){A.selectionHandles.each(function(C,D){D.hide()});A.selectionHandles=new draw2d.util.ArrayList()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/LineSelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.LineSelectionFeedbackPolicy=draw2d.policy.figure.SelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.LineSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(B,A,C){if(A.selectionHandles.isEmpty()){A.selectionHandles.add(this.createLineStartResizeHandle(A));A.selectionHandles.add(this.createLineEndResizeHandle(A));A.selectionHandles.each(function(D,E){E.setDraggable(A.isResizeable());E.show(B)})}this.moved(B,A)},createLineStartResizeHandle:function(A){return new draw2d.shape.basic.LineStartResizeHandle(A)},createLineEndResizeHandle:function(A){return new draw2d.shape.basic.LineEndResizeHandle(A)},moved:function(C,A){if(A.selectionHandles.isEmpty()){return }var G=A.selectionHandles.get(0);var B=A.selectionHandles.get(1);var H=G.getWidth()/2;var E=G.getHeight()/2;var F=A.getStartPoint();var D=A.getEndPoint();G.setPosition(F.x-H,F.y-E);B.setPosition(D.x-H,D.y-E)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/RectangleSelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.RectangleSelectionFeedbackPolicy=draw2d.policy.figure.SelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.RectangleSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(D,I,G){if(I.selectionHandles.isEmpty()){var H=new draw2d.shape.basic.Rectangle();H.setBackgroundColor(null);H.setDashArray("- ");H.setColor("#2096fc");H.setStroke(0.5);H.hide=function(){H.setCanvas(null)};H.show=function(M){H.setCanvas(M);H.shape.toFront()};H.show(D);var F=new draw2d.ResizeHandle(I,1);var E=new draw2d.ResizeHandle(I,2);var C=new draw2d.ResizeHandle(I,3);var B=new draw2d.ResizeHandle(I,4);var A=new draw2d.ResizeHandle(I,5);var L=new draw2d.ResizeHandle(I,6);var K=new draw2d.ResizeHandle(I,7);var J=new draw2d.ResizeHandle(I,8);I.selectionHandles.add(F);I.selectionHandles.add(E);I.selectionHandles.add(C);I.selectionHandles.add(B);I.selectionHandles.add(A);I.selectionHandles.add(L);I.selectionHandles.add(K);I.selectionHandles.add(J);F.show(D);C.show(D);A.show(D);K.show(D);F.setDraggable(I.isResizeable());C.setDraggable(I.isResizeable());A.setDraggable(I.isResizeable());K.setDraggable(I.isResizeable());if(I.isResizeable()===true){F.setBackgroundColor(F.DEFAULT_COLOR);C.setBackgroundColor(C.DEFAULT_COLOR);A.setBackgroundColor(A.DEFAULT_COLOR);K.setBackgroundColor(K.DEFAULT_COLOR)}else{F.setBackgroundColor(null);C.setBackgroundColor(null);A.setBackgroundColor(null);K.setBackgroundColor(null)}if(I.isStrechable()&&I.isResizeable()){E.setDraggable(I.isResizeable());B.setDraggable(I.isResizeable());L.setDraggable(I.isResizeable());J.setDraggable(I.isResizeable());E.show(D);B.show(D);L.show(D);J.show(D)}I.selectionHandles.add(H)}this.moved(D,I)},moved:function(E,J){if(J.selectionHandles.isEmpty()){return }var L=J.getHeight();var K=J.getWidth();var I=J.getX();var F=J.getY();var G=J.selectionHandles.get(0);var C=J.selectionHandles.get(2);var A=J.selectionHandles.get(4);var N=J.selectionHandles.get(6);G.setPosition(I-G.getWidth(),F-G.getHeight());C.setPosition(I+K,F-C.getHeight());A.setPosition(I+K,F+L);N.setPosition(I-N.getWidth(),F+L);if(J.isStrechable()){var D=J.selectionHandles.get(1);var B=J.selectionHandles.get(3);var O=J.selectionHandles.get(5);var M=J.selectionHandles.get(7);D.setPosition(I+(K/2)-(D.getWidth()/2),F-D.getHeight());B.setPosition(I+K,F+(L/2)-(B.getHeight()/2));O.setPosition(I+(K/2)-(O.getWidth()/2),F+L);M.setPosition(I-M.getWidth(),F+(L/2)-(M.getHeight()/2))}var H=J.selectionHandles.get(8);H.setPosition(J.getPosition().translate(-2,-2));H.setDimension(J.getWidth()+4,J.getHeight()+4);H.setRotationAngle(J.getRotationAngle())}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/BigRectangleSelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.BigRectangleSelectionFeedbackPolicy=draw2d.policy.figure.RectangleSelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.BigRectangleSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(B,A,C){this._super(B,A,C);if(!A.selectionHandles.isEmpty()){A.selectionHandles.each(function(D,E){E.setDimension(15,15)})}this.moved(B,A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/RoundRectangleSelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.RoundRectangleSelectionFeedbackPolicy=draw2d.policy.figure.RectangleSelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.RoundRectangleSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(B,A,C){this._super(B,A,C);if(!A.selectionHandles.isEmpty()){A.selectionHandles.each(function(D,E){E.setDimension(12,12);E.setRadius(4)})}this.moved(B,A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/BusSelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.BusSelectionFeedbackPolicy=draw2d.policy.figure.SelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.BusSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(C,A,D){if(A.selectionHandles.isEmpty()){var B=new draw2d.ResizeHandle(A,2);var G=new draw2d.ResizeHandle(A,4);var F=new draw2d.ResizeHandle(A,6);var E=new draw2d.ResizeHandle(A,8);A.selectionHandles.add(B);A.selectionHandles.add(G);A.selectionHandles.add(F);A.selectionHandles.add(E);B.setDraggable(A.isResizeable());G.setDraggable(A.isResizeable());F.setDraggable(A.isResizeable());E.setDraggable(A.isResizeable());B.show(C);G.show(C);F.show(C);E.show(C)}this.moved(C,A)},moved:function(B,F){if(F.selectionHandles.isEmpty()){return }var C=F.selectionHandles.get(0);var A=F.selectionHandles.get(1);var J=F.selectionHandles.get(2);var I=F.selectionHandles.get(3);var H=F.getHeight();var G=F.getWidth();var E=F.getX();var D=F.getY();C.setPosition(E+(G/2)-(C.getWidth()/2),D-C.getHeight());A.setPosition(E+G,D+(H/2)-(A.getHeight()/2));J.setPosition(E+(G/2)-(J.getWidth()/2),D+H);I.setPosition(E-I.getWidth(),D+(H/2)-(I.getHeight()/2))}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/VBusSelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.VBusSelectionFeedbackPolicy=draw2d.policy.figure.BusSelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.VBusSelectionFeedbackPolicy",init:function(){this._super()},moved:function(D,B){if(B.selectionHandles.isEmpty()){return }var C=B.selectionHandles.get(0);var E=B.selectionHandles.get(2);var A=B.getWidth();C.setDimension(A,C.getHeight());E.setDimension(A,E.getHeight());this._super(D,B)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/HBusSelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.HBusSelectionFeedbackPolicy=draw2d.policy.figure.BusSelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.HBusSelectionFeedbackPolicy",init:function(){this._super()},moved:function(B,A){if(A.selectionHandles.isEmpty()){return }var D=A.selectionHandles.get(1);var C=A.selectionHandles.get(3);D.setDimension(D.getWidth(),A.getHeight());C.setDimension(D.getWidth(),A.getHeight());this._super(B,A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/AntSelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.AntSelectionFeedbackPolicy=draw2d.policy.figure.SelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.AntSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(B,A,C){if(A.selectionHandles.isEmpty()){var D=new draw2d.shape.basic.Rectangle();D.setBackgroundColor(null);D.setDashArray("- ");D.setColor("#00bdee");D.hide=function(){D.setCanvas(null)};D.show=function(E){D.setCanvas(E);D.shape.toFront()};D.show(B);A.selectionHandles.add(D)}this.moved(B,A)},moved:function(B,A){if(A.selectionHandles.isEmpty()){return }var C=A.selectionHandles.get(0);C.setPosition(A.getPosition().translate(-2,-2));C.setDimension(A.getWidth()+4,A.getHeight()+4);C.setRotationAngle(A.getRotationAngle())}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/GlowSelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.GlowSelectionFeedbackPolicy=draw2d.policy.figure.SelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.GlowSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(B,A,C){A.setGlow(true);this.moved(B,A)},onUnselect:function(B,A){this._super(B,A);A.setGlow(false)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/SlimSelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.SlimSelectionFeedbackPolicy=draw2d.policy.figure.RectangleSelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.SlimSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(B,A,C){this._super(B,A,C);if(!A.selectionHandles.isEmpty()){A.selectionHandles.each(function(D,E){E.setDimension(6,6);E.setRadius(0)})}this.moved(B,A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/port/PortFeedbackPolicy.js' */
(function ($) {draw2d.policy.port.PortFeedbackPolicy=draw2d.policy.figure.DragDropEditPolicy.extend({NAME:"draw2d.policy.port.PortFeedbackPolicy",init:function(){this._super()},onHoverEnter:function(B,C,A){},onHoverLeave:function(B,C,A){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/port/ElasticStrapFeedbackPolicy.js' */
(function ($) {draw2d.policy.port.ElasticStrapFeedbackPolicy=draw2d.policy.port.PortFeedbackPolicy.extend({NAME:"draw2d.policy.port.ElasticStrapFeedbackPolicy",init:function(){this._super();this.connectionLine=null},onDragStart:function(B,A){this.connectionLine=new draw2d.shape.basic.Line();this.connectionLine.setCanvas(B);this.connectionLine.getShapeElement();this.onDrag(B,A)},onDrag:function(C,A){var B=A.ox+A.getParent().getAbsoluteX();var D=A.oy+A.getParent().getAbsoluteY();this.connectionLine.setStartPoint(B,D);this.connectionLine.setEndPoint(A.getAbsoluteX(),A.getAbsoluteY())},onDragEnd:function(B,A){this.connectionLine.setCanvas(null);this.connectionLine=null},onHoverEnter:function(A,B,C){this.connectionLine.setGlow(true);C.setGlow(true)},onHoverLeave:function(A,B,C){C.setGlow(false);this.connectionLine.setGlow(false)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/port/IntrusivePortsFeedbackPolicy.js' */
(function ($) {draw2d.policy.port.IntrusivePortsFeedbackPolicy=draw2d.policy.port.PortFeedbackPolicy.extend({NAME:"draw2d.policy.port.IntrusivePortsFeedbackPolicy",init:function(){this._super();this.connectionLine=null;this.tweenable=null},onDragStart:function(D,B){var E=0;B.getDropTargets().each(function(G,F){F.__beforeInflate=F.getWidth();E=F.__beforeInflate});var C=B.getDropTargets();C.grep(function(F){return(F.NAME!=B.NAME&&F.parent!==B.parent)||(F instanceof draw2d.HybridPort)||(B instanceof draw2d.HybridPort)});this.prepareDropTargetsForDrag(C);var A=this;this.tweenable=new Tweenable();this.tweenable.tween({from:{size:E/2},to:{size:E},duration:200,easing:"easeOutSine",step:function(F){C.each(function(H,G){A.alterDropTargetOnDrag(G,F)})}});this.connectionLine=new draw2d.shape.basic.Line();this.connectionLine.setCanvas(D);this.connectionLine.getShapeElement();this.connectionLine.setDashArray("- ");this.connectionLine.setColor(this.getConnectionLineColour());this.onDrag(D,B)},getConnectionLineColour:function(){return"#30c48a"},prepareDropTargetsForDrag:function(A){},alterDropTargetOnDrag:function(A,B){A.shape.attr({rx:B.size,ry:B.size});A.width=A.height=B.size*2},onDrag:function(C,A){var B=A.ox+A.getParent().getAbsoluteX();var D=A.oy+A.getParent().getAbsoluteY();this.connectionLine.setStartPoint(B,D);this.connectionLine.setEndPoint(A.getAbsoluteX(),A.getAbsoluteY())},onDragEnd:function(C,B){this.tweenable.stop(false);this.tweenable=null;var A=this;var D=B.getDropTargets();this.prepareDropTargetsForDragEnd(D);D.each(function(F,E){A.alterDropTargetOnDragEnd(E)});this.connectionLine.setCanvas(null);this.connectionLine=null},prepareDropTargetsForDragEnd:function(A){},alterDropTargetOnDragEnd:function(A){A.shape.attr({rx:A.__beforeInflate/2,ry:A.__beforeInflate/2});A.width=A.height=A.__beforeInflate},onHoverEnter:function(A,B,C){this.connectionLine.setGlow(true);C.setGlow(true)},onHoverLeave:function(A,B,C){C.setGlow(false);this.connectionLine.setGlow(false)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/Canvas.js' */
(function ($) {draw2d.Canvas=Class.extend({NAME:"draw2d.Canvas",init:function(A){if($.browser.msie&&parseInt($.browser.version,10)===8){this.fromDocumentToCanvasCoordinate=this._fromDocumentToCanvasCoordinate_IE8_HACK}this.setScrollArea(document.body);this.canvasId=A;this.html=$("#"+A);this.html.css({cursor:"default"});this.initialWidth=this.getWidth();this.initialHeight=this.getHeight();this.html.css({"-webkit-tap-highlight-color":"rgba(0,0,0,0)"});this.html.droppable({accept:".draw2d_droppable",over:$.proxy(function(B,C){this.onDragEnter(C.draggable)},this),out:$.proxy(function(B,C){this.onDragLeave(C.draggable)},this),drop:$.proxy(function(B,C){B=this._getEvent(B);var D=this.fromDocumentToCanvasCoordinate(B.clientX,B.clientY);this.onDrop(C.draggable,D.getX(),D.getY())},this)});$(".draw2d_droppable").draggable({appendTo:"body",stack:"body",zIndex:27000,helper:"clone",drag:$.proxy(function(B,C){B=this._getEvent(B);var D=this.fromDocumentToCanvasCoordinate(B.clientX,B.clientY);this.onDrag(C.draggable,D.getX(),D.getY())},this),stop:function(C,B){this.isInExternalDragOperation=false},start:function(C,B){this.isInExternalDragOperation=true;$(B.helper).addClass("shadow")}});this.paper=Raphael(A,this.getWidth(),this.getHeight());this.paper.canvas.style.position="absolute";this.zoomFactor=1;this.selection=new draw2d.Selection();this.currentDropTarget=null;this.isInExternalDragOperation=false;this.currentHoverFigure=null;this.editPolicy=new draw2d.util.ArrayList();this.figures=new draw2d.util.ArrayList();this.lines=new draw2d.util.ArrayList();this.commonPorts=new draw2d.util.ArrayList();this.dropTargets=new draw2d.util.ArrayList();this.resizeHandles=new draw2d.util.ArrayList();this.selectionListeners=new draw2d.util.ArrayList();this.viewBoxListeners=new draw2d.util.ArrayList();this.commandStack=new draw2d.command.CommandStack();this.linesToRepaintAfterDragDrop=new draw2d.util.ArrayList();this.lineIntersections=new draw2d.util.ArrayList();this.installEditPolicy(new draw2d.policy.canvas.BoundingboxSelectionPolicy());this.commandStack.addEventListener($.proxy(function(B){if(B.isPostChangeEvent()===true){this.calculateConnectionIntersection();this.linesToRepaintAfterDragDrop.each(function(D,C){C.svgPathString=null;C.repaint()});this.linesToRepaintAfterDragDrop=new draw2d.util.ArrayList()}},this));this.mouseDown=false;this.mouseDownX=0;this.mouseDownY=0;this.mouseDragDiffX=0;this.mouseDragDiffY=0;$(document).bind("mouseup touchend",$.proxy(function(B){if(this.mouseDown===false){return }B=this._getEvent(B);this.calculateConnectionIntersection();this.mouseDown=false;var C=this.fromDocumentToCanvasCoordinate(B.clientX,B.clientY);this.editPolicy.each($.proxy(function(D,E){E.onMouseUp(this,C.x,C.y)},this));this.mouseDragDiffX=0;this.mouseDragDiffY=0},this));this.html.bind("mousemove touchmove",$.proxy(function(D){D=this._getEvent(D);if(this.mouseDown===false){var E=this.fromDocumentToCanvasCoordinate(D.clientX,D.clientY);try{var C=this.getBestFigure(E.x,E.y);if(C!==this.currentHoverFigure&&this.currentHoverFigure!==null){this.currentHoverFigure.onMouseLeave(C)}if(C!==this.currentHoverFigure&&C!==null){C.onMouseEnter(this.currentHoverFigure)}this.currentHoverFigure=C}catch(B){console.log(B)}this.editPolicy.each($.proxy(function(F,G){G.onMouseMove(this,E.x,E.y)},this))}},this));$(document).bind("mousemove touchmove",$.proxy(function(D){if(this.mouseDown){var C=this.fromDocumentToCanvasCoordinate(this.mouseDownX,this.mouseDownY);var F=this.fromDocumentToCanvasCoordinate(D.clientX,D.clientY);var E=F.x-C.x;var B=F.y-C.y;this.editPolicy.each($.proxy(function(G,H){H.onMouseDrag(this,E,B,this.mouseDragDiffX-E,this.mouseDragDiffY-B)},this));this.mouseDragDiffX=E;this.mouseDragDiffY=B}},this));this.html.bind("mousedown touchstart",$.proxy(function(B){var C=null;switch(B.which){case 1:case 0:B.preventDefault();B=this._getEvent(B);this.mouseDownX=B.clientX;this.mouseDownY=B.clientY;this.mouseDragDiffX=0;this.mouseDragDiffY=0;C=this.fromDocumentToCanvasCoordinate(B.clientX,B.clientY);this.mouseDown=true;this.editPolicy.each($.proxy(function(D,E){E.onMouseDown(this,C.x,C.y)},this));break;case 3:B.preventDefault();B=this._getEvent(B);C=this.fromDocumentToCanvasCoordinate(B.clientX,B.clientY);this.onRightMouseDown(C.x,C.y);break;case 2:break;default:}},this));this.html.bind("dblclick",$.proxy(function(B){B=this._getEvent(B);this.mouseDownX=B.clientX;this.mouseDownY=B.clientY;var C=this.fromDocumentToCanvasCoordinate(B.clientX,B.clientY);this.onDoubleClick(C.x,C.y)},this));$(document).bind("click",$.proxy(function(B){B=this._getEvent(B);if(this.mouseDownX===B.clientX||this.mouseDownY===B.clientY){var C=this.fromDocumentToCanvasCoordinate(B.clientX,B.clientY);this.onClick(C.x,C.y)}},this));$(document).bind("keydown",$.proxy(function(B){if(!$(B.target).is("input")){var C=B.ctrlKey;this.onKeyDown(B.keyCode,C)}},this))},calculateConnectionIntersection:function(){this.lineIntersections=new draw2d.util.ArrayList();var B=this.getLines().clone();while(B.getSize()>0){var A=B.removeElementAt(0);B.each($.proxy(function(E,C){var D=A.intersection(C);if(D.getSize()>0){this.lineIntersections.add({line:A,other:C,intersection:D});this.lineIntersections.add({line:C,other:A,intersection:D})}},this))}},clear:function(){this.lines.clone().each($.proxy(function(A,B){this.removeFigure(B)},this));this.figures.clone().each($.proxy(function(A,B){this.removeFigure(B)},this));this.zoomFactor=1;this.selection.clear();this.currentDropTarget=null;this.isInExternalDragOperation=false;this.figures=new draw2d.util.ArrayList();this.lines=new draw2d.util.ArrayList();this.commonPorts=new draw2d.util.ArrayList();this.dropTargets=new draw2d.util.ArrayList();this.commandStack.markSaveLocation();this.linesToRepaintAfterDragDrop=new draw2d.util.ArrayList();this.lineIntersections=new draw2d.util.ArrayList()},installEditPolicy:function(A){if(A instanceof draw2d.policy.canvas.SelectionPolicy){this.getSelection().getAll().each(function(C,B){B.unselect()});this.editPolicy.grep($.proxy(function(C){var B=!(C instanceof draw2d.policy.canvas.SelectionPolicy);if(B===false){C.onUninstall(this)}return B},this))}else{if(A instanceof draw2d.policy.canvas.SnapToEditPolicy){this.editPolicy.grep($.proxy(function(C){var B=!(C instanceof draw2d.policy.canvas.SnapToEditPolicy);if(B===false){C.onUninstall(this)}return B},this))}}A.onInstall(this);this.editPolicy.add(A)},uninstallEditPolicy:function(A){if(!(A instanceof draw2d.policy.EditPolicy)){return }this.editPolicy.grep($.proxy(function(B){if(B===A){B.onUninstall(this);return false}return true},this))},setViewBox:function(A){this.paper.setViewBox(A.getX(),A.getY(),A.getWidth(),A.getHeight());this.viewBoxListeners.each(function(B,C){C()})},setZoom:function(C,B){var A=$.proxy(function(G){this.zoomFactor=Math.min(Math.max(0.01,G),10);var F=(this.initialWidth*this.zoomFactor)|0;var E=(this.initialHeight*this.zoomFactor)|0;this.paper.setViewBox(0,0,F,E)},this);if(B){var D=new Tweenable();D.tween({from:{x:this.zoomFactor},to:{x:C},duration:300,easing:"easeOutSine",step:function(E){A(E.x)}})}else{A(C)}},getZoom:function(){return this.zoomFactor},fromDocumentToCanvasCoordinate:function(A,B){return new draw2d.geo.Point((A-this.getAbsoluteX()+this.getScrollLeft())*this.zoomFactor,(B-this.getAbsoluteY()+this.getScrollTop())*this.zoomFactor)},_fromDocumentToCanvasCoordinate_IE8_HACK:function(A,B){return new draw2d.geo.Point((A-this.getAbsoluteX())*this.zoomFactor,(B-this.getAbsoluteY())*this.zoomFactor)},fromCanvasToDocumentCoordinate:function(A,B){return new draw2d.geo.Point((A+this.getAbsoluteX()-this.getScrollLeft())*this.zoomFactor,(B+this.getAbsoluteY()-this.getScrollTop())*this.zoomFactor)},getHtmlContainer:function(){return this.html},_getEvent:function(A){if(typeof A.originalEvent!=="undefined"){if(A.originalEvent.touches&&A.originalEvent.touches.length){return A.originalEvent.touches[0]}else{if(A.originalEvent.changedTouches&&A.originalEvent.changedTouches.length){return A.originalEvent.changedTouches[0]}}}return A},setScrollArea:function(A){this.scrollArea=$(A)},getScrollArea:function(){return this.scrollArea},getScrollLeft:function(){return this.scrollArea.scrollLeft()},getScrollTop:function(){return this.scrollArea.scrollTop()},getAbsoluteX:function(){return this.html.offset().left},getAbsoluteY:function(){return this.html.offset().top},getWidth:function(){return this.html.width()},getHeight:function(){return this.html.height()},addFigure:function(B,A,C){if(B.getCanvas()===this){return }B.setCanvas(this);B.getShapeElement();if(B instanceof draw2d.shape.basic.Line){this.lines.add(B);this.linesToRepaintAfterDragDrop=this.lines}else{this.figures.add(B);if(typeof C!=="undefined"){B.setPosition(A,C)}}B.repaint();B.fireMoveEvent()},removeFigure:function(A){this.editPolicy.each($.proxy(function(B,C){if(typeof C.unselect==="function"){C.unselect(this,A)}},this));if(A===this.currentHoverFigure){this.currentHoverFigure=null}if(A instanceof draw2d.shape.basic.Line){this.lines.remove(A)}else{this.figures.remove(A)}A.setCanvas(null);if(A instanceof draw2d.Connection){A.disconnect()}A.onRemove()},getLines:function(){return this.lines},getFigures:function(){return this.figures},getLine:function(D){var C=this.lines.getSize();for(var B=0;B<C;B++){var A=this.lines.get(B);if(A.getId()===D){return A}}return null},getFigure:function(B){var A=null;this.figures.each(function(C,D){if(D.id===B){A=D;return false}});return A},getIntersection:function(B){var A=new draw2d.util.ArrayList();this.lineIntersections.each($.proxy(function(C,D){if(D.line===B){D.intersection.each(function(E,F){A.add({x:F.x,y:F.y,justTouching:F.justTouching,other:D.other})})}},this));return A},snapToHelper:function(A,B){this.editPolicy.each($.proxy(function(C,D){B=D.snap(this,A,B)},this));return B},registerPort:function(A){A.targets=this.dropTargets;this.commonPorts.add(A);this.dropTargets.add(A)},unregisterPort:function(A){A.targets=null;this.commonPorts.remove(A);this.dropTargets.remove(A)},getAllPorts:function(){return this.commonPorts},getCommandStack:function(){return this.commandStack},getCurrentSelection:function(){return this.selection.getPrimary()},getSelection:function(){return this.selection},setCurrentSelection:function(A){this.editPolicy.each($.proxy(function(B,C){if(typeof C.select==="function"){C.select(this,A)}},this))},addSelectionListener:function(A){if(A!==null){if(typeof A==="function"){this.selectionListeners.add({onSelectionChanged:A})}else{if(typeof A.onSelectionChanged==="function"){this.selectionListeners.add(A)}else{throw"Object doesn't implement required callback method [onSelectionChanged]"}}}},removeSelectionListener:function(A){this.selectionListeners=this.selectionListeners.grep(function(B){return B&&B!==A&&B.onSelectionChanged!==A})},addViewBoxListener:function(A){this.viewBoxListeners.add(A)},removeViewBoxListener:function(A){this.viewBoxListeners=this.viewBoxListeners.grep(function(B){return B!==A})},getBestFigure:function(I,H,A){var K=null;var E=null;var D=0;var B=null;for(D=0,len=this.resizeHandles.getSize();D<len;D++){E=this.resizeHandles.get(D);if(E.isVisible()===true&&E.hitTest(I,H)===true&&E!==A){return E}}for(D=0,len=this.commonPorts.getSize();D<len;D++){E=this.commonPorts.get(D);if(E!==A){if(E.isVisible()===true&&E.hitTest(I,H)===true){return E}}}K=this.getBestLine(I,H,A);if(K!==null){return K}for(D=(this.figures.getSize()-1);D>=0;D--){var G=this.figures.get(D);var C=function(L){L.each(function(M,N){C(N.getChildren());if(K===null&&N.isVisible()===true&&N.hitTest(I,H)===true){K=N}return K===null})};C(G.getChildren());if(K===null&&G.isVisible()===true&&G.hitTest(I,H)===true&&G!==A){if(K===null){K=G}else{if(K.getZOrder()<G.getZOrder()){K=G}}}if(K!==null){return K}}var F=this.lines.getSize();for(D=0;D<F;D++){var J=this.lines.get(D);B=J.getChildren();B.each(function(L,M){if(M.isVisible()===true&&M.hitTest(I,H)===true){K=M;return false}return true})}return K},getBestLine:function(B,G,E){var A=null;var F=this.lines.getSize();for(var D=0;D<F;D++){var C=this.lines.get(D);if(C.isVisible()===true&&C.hitTest(B,G)===true&&C!==E){if(A===null){A=C;break}}}return A},hideSnapToHelperLines:function(){this.hideSnapToHelperLineHorizontal();this.hideSnapToHelperLineVertical()},hideSnapToHelperLineHorizontal:function(){},hideSnapToHelperLineVertical:function(){},onDragEnter:function(A){},onDrag:function(B,A,C){},onDragLeave:function(A){},onDrop:function(B,A,C){},onKeyDown:function(B,A){if(B==46&&this.selection.getPrimary()!==null){this.commandStack.execute(this.selection.getPrimary().createCommand(new draw2d.command.CommandType(draw2d.command.CommandType.DELETE)))}else{if(B==90&&A){this.commandStack.undo()}else{if(B==89&&A){this.commandStack.redo()}else{if(B===107){this.setZoom(this.zoomFactor*0.95)}else{if(B===109){this.setZoom(this.zoomFactor*1.05)}}}}}},onDoubleClick:function(B,C){var A=this.getBestFigure(B,C);if(A!==null){A.onDoubleClick()}},onClick:function(B,C){var A=this.getBestFigure(B,C);if(A!==null){A.onClick()}},onRightMouseDown:function(B,C){var A=this.getBestFigure(B,C);if(A!==null){A.onContextMenu(B,C)}},onNewConnection:function(A){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/Selection.js' */
(function ($) {draw2d.Selection=Class.extend({NAME:"draw2d.Selection",init:function(){this.primary=null;this.all=new draw2d.util.ArrayList()},clear:function(){this.primary=null;this.all=new draw2d.util.ArrayList()},getPrimary:function(){return this.primary},setPrimary:function(A){this.primary=A;if(A!==null&&!this.all.contains(A)){this.all.add(A)}},remove:function(A){this.all.remove(A);if(this.primary===A){this.primary=null}},contains:function(A){return this.all.contains(A)},getAll:function(){return this.all.clone()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/Figure.js' */
(function ($) {draw2d.Figure=Class.extend({NAME:"draw2d.Figure",MIN_TIMER_INTERVAL:50,init:function(B,A){this.id=draw2d.util.UUID.create();this.isResizeHandle=false;this.command=null;this.canvas=null;this.shape=null;this.children=new draw2d.util.ArrayList();this.selectable=true;this.deleteable=true;this.resizeable=true;this.draggable=true;this.visible=true;this.canSnapToHelper=true;this.snapToGridAnchor=new draw2d.geo.Point(0,0);this.editPolicy=new draw2d.util.ArrayList();this.timerId=-1;this.timerInterval=0;this.parent=null;this.x=0;this.y=0;this.minHeight=5;this.minWidth=5;this.rotationAngle=0;if(typeof A!=="undefined"){this.width=B;this.height=A}else{this.width=this.getMinWidth();this.height=this.getMinHeight()}this.alpha=1;this.isInDragDrop=false;this.isMoving=false;this.originalAlpha=this.alpha;this.ox=0;this.oy=0;this.repaintBlocked=false;this.selectionHandles=new draw2d.util.ArrayList();this.moveListener=new draw2d.util.ArrayList();this.resizeListener=new draw2d.util.ArrayList();this.installEditPolicy(new draw2d.policy.figure.RectangleSelectionFeedbackPolicy())},select:function(A){if(typeof A==="undefined"){A=true}this.editPolicy.each($.proxy(function(B,C){if(C instanceof draw2d.policy.figure.SelectionFeedbackPolicy){C.onSelect(this.canvas,this,A)}},this));return this},unselect:function(){this.editPolicy.each($.proxy(function(A,B){if(B instanceof draw2d.policy.figure.SelectionFeedbackPolicy){B.onUnselect(this.canvas,this)}},this));return this},getId:function(){return this.id},setId:function(A){this.id=A;return this},setCanvas:function(A){if(A===null&&this.shape!==null){this.unselect();this.shape.remove();this.shape=null}this.canvas=A;if(this.canvas!==null){this.getShapeElement()}if(A===null){this.stopTimer()}else{if(this.timerInterval>=this.MIN_TIMER_INTERVAL){this.startTimer(this.timerInterval)}}this.children.each(function(B,C){C.figure.setCanvas(A)})},getCanvas:function(){return this.canvas},startTimer:function(A){this.stopTimer();this.timerInterval=Math.max(this.MIN_TIMER_INTERVAL,A);if(this.canvas!==null){this.timerId=window.setInterval($.proxy(this.onTimer,this),this.timerInterval)}return this},stopTimer:function(){if(this.timerId>=0){window.clearInterval(this.timerId);this.timerId=-1}},onTimer:function(){},installEditPolicy:function(A){if(A instanceof draw2d.policy.figure.SelectionFeedbackPolicy){this.editPolicy.grep($.proxy(function(C){var B=!(C instanceof draw2d.policy.figure.SelectionFeedbackPolicy);if(!B){C.onUninstall(this)}return B},this))}A.onInstall(this);this.editPolicy.add(A)},addFigure:function(B,A){B.setDraggable(false);B.setSelectable(false);B.setParent(this);this.children.add({figure:B,locator:A});if(this.canvas!==null){B.setCanvas(this.canvas)}this.repaint();return this},getChildren:function(){var A=new draw2d.util.ArrayList();this.children.each(function(B,C){A.add(C.figure)});return A},resetChildren:function(){this.children.each(function(A,B){B.figure.setCanvas(null)});this.children=new draw2d.util.ArrayList();this.repaint()},getShapeElement:function(){if(this.shape!==null){return this.shape}this.shape=this.createShapeElement();return this.shape},createShapeElement:function(){throw"Inherited class ["+this.NAME+"] must override the abstract method createShapeElement"},repaint:function(A){if(this.visible===true){this.shape.show()}else{this.shape.hide();return }A.opacity=this.alpha;this.shape.attr(A);this.applyTransformation();this.children.each(function(B,C){C.locator.relocate(B,C.figure)})},applyTransformation:function(){},setGlow:function(A){return this},onDragStart:function(B,A){this.isInDragDrop=false;this.isMoving=false;this.originalAlpha=this.getAlpha();this.command=this.createCommand(new draw2d.command.CommandType(draw2d.command.CommandType.MOVE));if(this.command!==null){this.ox=this.x;this.oy=this.y;this.isInDragDrop=true;this.editPolicy.each($.proxy(function(C,D){if(D instanceof draw2d.policy.figure.DragDropEditPolicy){D.onDragStart(this.canvas,this)}},this));return true}return false},onDrag:function(B,A){this.editPolicy.each($.proxy(function(E,F){if(F instanceof draw2d.policy.figure.DragDropEditPolicy){var D=F.adjustPosition(this,this.ox+B,this.oy+A);B=D.x-this.ox;A=D.y-this.oy}},this));this.x=this.ox+B;this.y=this.oy+A;if(this.getCanSnapToHelper()){var C=new draw2d.geo.Point(this.x,this.y);C=this.getCanvas().snapToHelper(this,C);this.x=C.x;this.y=C.y}this.setPosition(this.x,this.y);this.editPolicy.each($.proxy(function(D,E){if(E instanceof draw2d.policy.figure.DragDropEditPolicy){E.onDrag(this.canvas,this)}},this));if(this.isMoving===false){this.isMoving=true;this.setAlpha(this.originalAlpha*0.7)}},onPanning:function(B,A){},onDragEnd:function(){this.setAlpha(this.originalAlpha);this.command.setPosition(this.x,this.y);this.isInDragDrop=false;this.canvas.getCommandStack().execute(this.command);this.command=null;this.isMoving=false;this.editPolicy.each($.proxy(function(A,B){if(B instanceof draw2d.policy.figure.DragDropEditPolicy){B.onDragEnd(this.canvas,this)}},this));this.fireMoveEvent()},onDragEnter:function(A){return null},onDragLeave:function(A){},onDrop:function(A){},onMouseEnter:function(){},onMouseLeave:function(){},onDoubleClick:function(){},onClick:function(){},onContextMenu:function(A,B){},setAlpha:function(A){A=Math.min(1,Math.max(0,parseFloat(A)));if(A===this.alpha){return }this.alpha=A;this.repaint();return this},getAlpha:function(){return this.alpha},setRotationAngle:function(A){this.rotationAngle=A;this.editPolicy.each($.proxy(function(B,C){if(C instanceof draw2d.policy.figure.DragDropEditPolicy){C.moved(this.canvas,this)}},this));this.repaint();return this},getRotationAngle:function(){return this.rotationAngle},setVisible:function(A){this.visible=!!A;this.repaint();return this},isVisible:function(){return this.visible&&this.shape!==null},getZOrder:function(){if(this.shape===null){return -1}var A=0;var B=this.shape.node;while((B=B.previousSibling)!==null){A++}return A},setCanSnapToHelper:function(A){this.canSnapToHelper=!!A;return this},getCanSnapToHelper:function(){return this.canSnapToHelper},getSnapToGridAnchor:function(){return this.snapToGridAnchor},setSnapToGridAnchor:function(A){this.snapToGridAnchor=A},getWidth:function(){return this.width},getHeight:function(){return this.height},getMinWidth:function(){return this.minWidth},setMinWidth:function(A){this.minWidth=parseFloat(A);return this},getMinHeight:function(){return this.minHeight;return this},setMinHeight:function(A){this.minHeight=parseFloat(A);return this},getX:function(){return this.x},getY:function(){return this.y},getAbsoluteX:function(){if(this.parent===null){return this.x||0}return this.x+this.parent.getAbsoluteX()},getAbsoluteY:function(){if(this.parent===null){return this.y||0}return this.y+this.parent.getAbsoluteY()},getAbsolutePosition:function(){return new draw2d.geo.Point(this.getAbsoluteX(),this.getAbsoluteY())},getAbsoluteBounds:function(){return new draw2d.geo.Rectangle(this.getAbsoluteX(),this.getAbsoluteY(),this.getWidth(),this.getHeight())},setPosition:function(A,B){if(A instanceof draw2d.geo.Point){this.x=A.x;this.y=A.y}else{this.x=A;this.y=B}this.repaint();this.editPolicy.each($.proxy(function(C,D){if(D instanceof draw2d.policy.figure.DragDropEditPolicy){D.moved(this.canvas,this)}},this));this.fireMoveEvent();return this},getPosition:function(){return new draw2d.geo.Point(this.x,this.y)},translate:function(B,A){this.setPosition(this.x+B,this.y+A);return this},setDimension:function(A,B){A=Math.max(this.getMinWidth(),A);B=Math.max(this.getMinHeight(),B);if(this.width===A&&this.height===B){return }this.editPolicy.each($.proxy(function(D,E){if(E instanceof draw2d.policy.figure.DragDropEditPolicy){var C=E.adjustDimension(this,A,B);A=C.w;B=C.h}},this));this.width=Math.max(this.getMinWidth(),A);this.height=Math.max(this.getMinHeight(),B);this.repaint();this.fireResizeEvent();this.fireMoveEvent();this.editPolicy.each($.proxy(function(C,D){if(D instanceof draw2d.policy.figure.DragDropEditPolicy){D.moved(this.canvas,this)}},this));return this},getBoundingBox:function(){return new draw2d.geo.Rectangle(this.getAbsoluteX(),this.getAbsoluteY(),this.getWidth(),this.getHeight())},hitTest:function(A,C,B){if(typeof B==="number"){return this.getBoundingBox().scale(B,B).hitTest(A,C)}return this.getBoundingBox().hitTest(A,C)},setDraggable:function(A){this.draggable=!!A;return this},isDraggable:function(){return this.draggable},isResizeable:function(){return this.resizeable},setResizeable:function(A){this.resizeable=!!A;return this},isSelectable:function(){return this.selectable},setSelectable:function(A){this.selectable=!!A;return this},isStrechable:function(){return true},isDeleteable:function(){return this.deleteable},setDeleteable:function(A){this.deleteable=!!A;return this},setParent:function(A){this.parent=A;return this},getParent:function(){return this.parent},attachResizeListener:function(A){if(A===null){return }this.resizeListener.add(A);return this},detachResizeListener:function(A){if(A===null){return }this.resizeListener.remove(A);return this},fireResizeEvent:function(){this.resizeListener.each($.proxy(function(A,B){B.onOtherFigureIsResizing(this)},this));return this},onOtherFigureIsResizing:function(A){},attachMoveListener:function(A){if(A===null){return }if(!this.moveListener.contains(A)){this.moveListener.add(A)}return this},detachMoveListener:function(A){if(A===null){return }this.moveListener.remove(A);return this},fireMoveEvent:function(){this.moveListener.each($.proxy(function(A,B){B.onOtherFigureIsMoving(this)},this));return this},onOtherFigureIsMoving:function(A){},createCommand:function(A){if(A===null){return null}if(A.getPolicy()===draw2d.command.CommandType.MOVE){if(!this.isDraggable()){return null}return new draw2d.command.CommandMove(this)}if(A.getPolicy()===draw2d.command.CommandType.DELETE){if(!this.isDeleteable()){return null}return new draw2d.command.CommandDelete(this)}if(A.getPolicy()===draw2d.command.CommandType.RESIZE){if(!this.isResizeable()){return null}return new draw2d.command.CommandResize(this)}return null},getPersistentAttributes:function(){var A={type:this.NAME,id:this.id,x:this.x,y:this.y,width:this.width,height:this.height};return A},setPersistentAttributes:function(A){this.id=A.id;this.x=A.x;this.y=A.y;if(typeof A.width!=="undefined"){this.width=A.width}if(typeof A.height!=="undefined"){this.height=A.height}return this},onRemove:function(){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/node/Node.js' */
(function ($) {draw2d.shape.node.Node=draw2d.Figure.extend({NAME:"draw2d.shape.node.Node",init:function(B,A){this.inputPorts=new draw2d.util.ArrayList();this.outputPorts=new draw2d.util.ArrayList();this.hybridPorts=new draw2d.util.ArrayList();this.portRelayoutRequired=true;this.cachedPorts=null;this._super(B,A)},onDoubleClick:function(){var A=this.getWidth();var B=this.getHeight();this.setRotationAngle((this.getRotationAngle()+90)%360);this.setDimension(B,A);this.portRelayoutRequired=true},getPorts:function(){if(this.cachedPorts===null){this.cachedPorts=new draw2d.util.ArrayList();this.cachedPorts.addAll(this.inputPorts);this.cachedPorts.addAll(this.outputPorts);this.cachedPorts.addAll(this.hybridPorts);this.children.each($.proxy(function(A,B){this.cachedPorts.addAll(B.figure.getPorts())},this))}return this.cachedPorts},getInputPorts:function(){return this.inputPorts.clone().addAll(this.hybridPorts)},getOutputPorts:function(){return this.outputPorts.clone().addAll(this.hybridPorts)},getPort:function(B){var A=null;this.getPorts().each(function(C,D){if(D.getName()===B){A=D;return false}});return A},getInputPort:function(C){if(typeof C==="number"){return this.inputPorts.get(C)}for(var B=0;B<this.inputPorts.getSize();B++){var A=this.inputPorts.get(B);if(A.getName()===C){return A}}return null},getOutputPort:function(C){if(typeof C==="number"){return this.outputPorts.get(C)}for(var B=0;B<this.outputPorts.getSize();B++){var A=this.outputPorts.get(B);if(A.getName()===C){return A}}return null},getHybridPort:function(C){if(typeof C==="number"){return this.hybridPorts.get(C)}for(var B=0;B<this.hybridPorts.getSize();B++){var A=this.hybridPorts.get(B);if(A.getName()===C){return A}}return null},addPort:function(B,A){if(!(B instanceof draw2d.Port)){throw"Argument is not typeof 'draw2d.Port'. \nFunction: draw2d.shape.node.Node#addPort"}this.cachedPorts=null;this.portRelayoutRequired=true;if(B instanceof draw2d.InputPort){this.inputPorts.add(B)}else{if(B instanceof draw2d.OutputPort){this.outputPorts.add(B)}else{if(B instanceof draw2d.HybridPort){this.hybridPorts.add(B)}}}if((typeof A!=="undefined")&&(A instanceof draw2d.layout.locator.Locator)){B.setLocator(A)}B.setParent(this);B.setCanvas(this.canvas);B.setDeleteable(false);if(this.canvas!==null){B.getShapeElement();this.canvas.registerPort(B)}},removePort:function(A){this.portRelayoutRequired=true;this.inputPorts.remove(A);this.outputPorts.remove(A);this.hybridPorts.remove(A);if(A.getCanvas()!==null){A.getCanvas().unregisterPort(A);var C=A.getConnections();for(var B=0;B<C.getSize();++B){A.getCanvas().removeFigure(C.get(B))}}A.setCanvas(null)},createPort:function(C,B){var A=null;var D=0;switch(C){case"input":A=new draw2d.InputPort();D=this.inputPorts.getSize();break;case"output":A=new draw2d.OutputPort();D=this.outputPorts.getSize();break;case"hybrid":A=new draw2d.HybridPort();D=this.hybridPorts.getSize();break;default:throw"Unknown type ["+C+"] of port requested"}A.setName(C+D);this.addPort(A,B);this.setDimension(this.width,this.height);return A},getConnections:function(){var D=new draw2d.util.ArrayList();var F=this.getPorts();for(var C=0;C<F.getSize();C++){var A=F.get(C);for(var E=0,B=A.getConnections().getSize();E<B;E++){if(!D.contains(A.getConnections().get(E))){D.add(A.getConnections().get(E))}}}return D},setCanvas:function(B){var A=this.canvas;this._super(B);var C=this.getPorts();if(A!==null){C.each(function(E,D){A.unregisterPort(D)})}if(B!==null){C.each(function(E,D){D.setCanvas(B);B.registerPort(D)});this.setDimension(this.width,this.height)}else{C.each(function(E,D){D.setCanvas(null)})}},setRotationAngle:function(A){this.portRelayoutRequired=true;this._super(A);this.layoutPorts()},setDimension:function(A,B){this.portRelayoutRequired=true;this._super(A,B)},onPortValueChanged:function(A){},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }this._super(A);this.layoutPorts()},layoutPorts:function(){if(this.portRelayoutRequired===false){return }this.portRelayoutRequired=false;this.outputPorts.each(function(B,A){A.locator.relocate(B,A)});this.inputPorts.each(function(B,A){A.locator.relocate(B,A)});this.hybridPorts.each(function(B,A){A.locator.relocate(B,A)})}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/VectorFigure.js' */
(function ($) {draw2d.VectorFigure=draw2d.shape.node.Node.extend({NAME:"draw2d.VectorFigure",init:function(){this.stroke=1;this.bgColor=new draw2d.util.Color(255,255,255);this.lineColor=new draw2d.util.Color(128,128,255);this.color=new draw2d.util.Color(128,128,128);this.strokeBeforeGlow=this.stroke;this.glowIsActive=false;this._super()},setGlow:function(A){if(A===this.glowIsActive){return this}this.glowIsActive=A;if(A===true){this.strokeBeforeGlow=this.getStroke();this.setStroke(this.strokeBeforeGlow*2.5)}else{this.setStroke(this.strokeBeforeGlow)}return this},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}A.x=this.getAbsoluteX();A.y=this.getAbsoluteY();if(typeof A.stroke==="undefined"){if(this.color===null||this.stroke===0){A.stroke="none"}else{A.stroke=this.color.hash()}}A["stroke-width"]=this.stroke;if(typeof A.fill==="undefined"){A.fill=this.bgColor.hash()}this._super(A)},setBackgroundColor:function(A){this.bgColor=new draw2d.util.Color(A);this.repaint();return this},getBackgroundColor:function(){return this.bgColor},setStroke:function(A){this.stroke=A;this.repaint();return this},getStroke:function(){return this.stroke},setColor:function(A){this.color=new draw2d.util.Color(A);this.repaint();return this},getColor:function(){return this.color}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/basic/Rectangle.js' */
(function ($) {draw2d.shape.basic.Rectangle=draw2d.VectorFigure.extend({NAME:"draw2d.shape.basic.Rectangle",init:function(B,A){this.radius=2;this.dasharray=null;this._super();this.setBackgroundColor(new draw2d.util.Color(100,100,100));this.setColor("#1B1B1B");if(typeof B==="undefined"){this.setDimension(50,90)}else{this.setDimension(B,A)}},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}if(this.dasharray!==null){A["stroke-dasharray"]=this.dasharray}A.width=this.getWidth();A.height=this.getHeight();A.r=this.radius;this._super(A)},applyTransformation:function(){this.shape.transform("R"+this.rotationAngle);if(this.getRotationAngle()===90||this.getRotationAngle()===270){var B=this.getHeight()/this.getWidth();var A="...S"+B+","+1/B+","+(this.getAbsoluteX()+this.getWidth()/2)+","+(this.getAbsoluteY()+this.getHeight()/2);this.shape.transform(A)}},createShapeElement:function(){return this.canvas.paper.rect(this.getAbsoluteX(),this.getAbsoluteY(),this.getWidth(),this.getHeight())},setRadius:function(A){this.radius=A;this.repaint()},getRadius:function(){return this.radius},setDashArray:function(A){this.dasharray=A},getPersistentAttributes:function(){var A=this._super();A.radius=this.radius;return A},setPersistentAttributes:function(A){this._super(A);if(typeof A.radius==="number"){this.radius=A.radius}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/SetFigure.js' */
(function ($) {draw2d.SetFigure=draw2d.shape.basic.Rectangle.extend({NAME:"draw2d.SetFigure",init:function(B,A){this.svgNodes=null;this.originalWidth=null;this.originalHeight=null;this.scaleX=1;this.scaleY=1;this._super(B,A);this.setStroke(0);this.setBackgroundColor(null)},setCanvas:function(A){if(A===null&&this.svgNodes!==null){this.svgNodes.remove();this.svgNodes=null}this._super(A)},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(this.originalWidth!==null){this.scaleX=this.width/this.originalWidth;this.scaleY=this.height/this.originalHeight}if(typeof A==="undefined"){A={}}if(this.visible===true){this.svgNodes.show()}else{this.svgNodes.hide()}this._super(A)},applyTransformation:function(){var D="S"+this.scaleX+","+this.scaleY+",0,0 R"+this.rotationAngle+","+((this.getWidth()/2)|0)+","+((this.getHeight()/2)|0)+"T"+this.getAbsoluteX()+","+this.getAbsoluteY()+"";this.svgNodes.transform(D);if(this.rotationAngle===90||this.rotationAngle===270){var E=this.svgNodes.getBBox(true);var C=E.height/E.width;var B=E.width/E.height;var A="...S"+C+","+B+","+(this.getAbsoluteX()+this.getWidth()/2)+","+(this.getAbsoluteY()+this.getHeight()/2);this.svgNodes.transform(A)}},createShapeElement:function(){var A=this.canvas.paper.rect(this.getX(),this.getY(),this.getWidth(),this.getHeight());this.svgNodes=this.createSet();var B=this.svgNodes.getBBox();this.originalWidth=B.width;this.originalHeight=B.height;return A},createSet:function(){return this.canvas.paper.set()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/SVGFigure.js' */
(function ($) {draw2d.SVGFigure=draw2d.SetFigure.extend({NAME:"draw2d.SVGFigure",init:function(B,A){this._super(B,A)},createSet:function(){return this.importSVG(this.canvas,this.getSVG())},importSVG:function(C,A){var F=C.paper.set();try{if(typeof A==="undefined"){throw"No data was provided."}var E=$(A);if(E.attr("width")&&E.attr("height")){this.setDimension(E.attr("width"),E.attr("height"))}var D=new RegExp("([a-z0-9-]+) ?: ?([^ ;]+)[ ;]?","gi");E.children().each(function(K,L){var N=null;var G=null;var O={};var I=L.tagName;var M=I.indexOf(":");if(M!=-1){I=I.substr(M+1)}$(L.attributes).each(function(){switch(this.nodeName){case"stroke-dasharray":O[this.nodeName]="- ";break;case"style":G=this.nodeValue;break;case"id":case"xml:space":break;default:O[this.nodeName]=this.nodeValue;break}});if(G!==null){while(D.exec(G)){O[RegExp.$1]=RegExp.$2}}if(typeof O["stroke-width"]==="undefined"){O["stroke-width"]=(typeof O.stroke==="undefined"?0:1.2)}switch(I){case"rect":N=C.paper.rect();break;case"circle":N=C.paper.circle();break;case"ellipse":N=C.paper.ellipse();break;case"path":O.fill="none";N=C.paper.path(O.d);break;case"line":O.d="M "+O.x1+" "+O.y1+"L"+O.x2+" "+O.y2;O.fill="none";N=C.paper.path(O.d);break;case"polyline":var Q=O.points;O.d="M "+Q.replace(" "," L");N=C.paper.path(O.d);break;case"polygon":N=C.paper.polygon(O.points);break;case"image":N=C.paper.image();break;case"tspan":case"text":if(L.childNodes.length>0){var H=L.firstChild;do{switch(H.nodeType){case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:return ;case 1:}var J=C.paper.text(0,0,$(H).text());var P={x:parseFloat(H.attributes.x.value),y:parseFloat(H.attributes.y.value)};P["text-anchor"]="start";if(typeof H.attributes["font-size"]!=="undefined"){P["font-size"]=parseInt(H.attributes["font-size"].value)}else{if(typeof O["font-size"]!=="undefined"){P["font-size"]=parseInt(O["font-size"])}}if(typeof H.attributes["font-family"]!=="undefined"){P["font-family"]=H.attributes["family-family"].value}else{if(typeof O["font-family"]!=="undefined"){P["font-family"]=O["font-family"]}}P.fill="#000000";if(typeof H.attributes.fill!=="undefined"){P.fill=H.attributes.fill.value}else{if(typeof O.fill!=="undefined"){P.fill=O.fill}}P.y=P.y+J.getBBox().height/2;J.attr(P);F.push(J)}while(H=H.nextSibling)}else{N=C.paper.text(0,0,$(L).html());if(typeof O.fill==="undefined"){O.fill="#000000"}if(typeof O["text-anchor"]==="undefined"){O["text-anchor"]="start"}if(typeof O["font-size"]!=="undefined"){O["font-size"]=parseInt(O["font-size"])}if(typeof O["font-family"]!=="undefined"){O["font-family"]=parseInt(O["font-family"])}O.y=parseFloat(O.y)+N.getBBox().height/2}break}if(N!==null){N.attr(O);F.push(N)}})}catch(B){alert("The SVG data you entered was invalid! ("+B+")")}return F}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/node/Hub.js' */
(function ($) {draw2d.shape.node.Hub=draw2d.shape.basic.Rectangle.extend({NAME:"draw2d.shape.node.Hub",DEFAULT_COLOR:new draw2d.util.Color("#4DF0FE"),BACKGROUND_COLOR:new draw2d.util.Color("#29AA77"),init:function(C,A,B){this.label=null;this._super(C,A);this.port=this.createPort("hybrid",new draw2d.layout.locator.CenterLocator(this));this.CONNECTION_DIR_STRATEGY=[$.proxy(function(E,D){return this.getParent().getBoundingBox().getDirection(D.getAbsolutePosition())},this.port),$.proxy(function(E,D){return this.getAbsoluteY()>D.getAbsoluteY()?0:2},this.port),$.proxy(function(E,D){return this.getAbsoluteX()>D.getAbsoluteX()?3:1},this.port)];this.port.setGlow=$.proxy(this.setGlow,this);this.port._orig_hitTest=this.port.hitTest;this.port.hitTest=$.proxy(this.hitTest,this);this.port.setConnectionAnchor(new draw2d.layout.anchor.ShortesPathConnectionAnchor(this.port));this.port.setVisible(false);if(typeof A==="undefined"){this.setDimension(150,50)}this.setConnectionDirStrategy(0);this.setColor(this.DEFAULT_COLOR.darker());this.setBackgroundColor(this.BACKGROUND_COLOR);if(typeof B!=="undefined"){this.label=new draw2d.shape.basic.Label(B);this.label.setColor("#0d0d0d");this.label.setFontColor("#0d0d0d");this.label.setStroke(0);this.addFigure(this.label,new draw2d.layout.locator.CenterLocator(this))}},onDragEnter:function(A){return this.getHybridPort(0).onDragEnter(A)},getMinWidth:function(){if(this.label!==null){return Math.max(this.label.getMinWidth(),this._super())}else{return this._super()}},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}if(typeof A.fill==="undefined"){if(this.bgColor!==null){A.fill="90-"+this.bgColor.hash()+":5-"+this.bgColor.lighter(0.3).hash()+":95"}else{A.fill="none"}}this._super(A)},setConnectionDirStrategy:function(A){switch(A){case 0:case 1:case 2:this.port.getConnectionDirection=this.CONNECTION_DIR_STRATEGY[A];break}},getPersistentAttributes:function(){var A=this._super();A.dirStrategy=this.CONNECTION_DIR_STRATEGY.indexOf(this.port.getConnectionDirection);return A},setPersistentAttributes:function(A){this._super(A);if(typeof A.dirStrategy==="number"){this.setConnectionDirStrategy(A.dirStrategy)}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/node/HorizontalBus.js' */
(function ($) {draw2d.shape.node.HorizontalBus=draw2d.shape.node.Hub.extend({NAME:"draw2d.shape.node.HorizontalBus",init:function(C,A,B){this._super(C,A,B);this.setConnectionDirStrategy(1);this.installEditPolicy(new draw2d.policy.figure.HBusSelectionFeedbackPolicy())}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/node/VerticalBus.js' */
(function ($) {draw2d.shape.node.VerticalBus=draw2d.shape.node.Hub.extend({NAME:"draw2d.shape.node.VerticalBus",init:function(C,A,B){this._super(C,A,B);if(this.label!==null){this.label.setRotationAngle(90)}this.setConnectionDirStrategy(2);this.installEditPolicy(new draw2d.policy.figure.VBusSelectionFeedbackPolicy())},getMinHeight:function(){if(this.shape===null&&this.label===null){return 0}return this.label.getMinWidth()},getMinWidth:function(){if(this.shape===null&&this.label===null){return 0}return this.label.getMinHeight()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/node/Fulcrum.js' */
(function ($) {draw2d.shape.node.Fulcrum=draw2d.shape.node.Hub.extend({NAME:"draw2d.shape.node.Fulcrum",init:function(){this._super(40,40);this.port.setConnectionAnchor(new draw2d.layout.anchor.ConnectionAnchor(this.port));this.port.setVisible(true);this.port.hitTest=this.port._orig_hitTest;this.setConnectionDirStrategy(0);this.setColor(null);this.setRadius(10);this.setBackgroundColor(null);this.setStroke(0);this.installEditPolicy(new draw2d.policy.figure.AntSelectionFeedbackPolicy())},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}if(typeof A.fill==="undefined"){A.fill=this.bgColor.hash()}this._super(A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/basic/Oval.js' */
(function ($) {draw2d.shape.basic.Oval=draw2d.VectorFigure.extend({NAME:"draw2d.shape.basic.Oval",init:function(B,A){this._super();this.setBackgroundColor("#C02B1D");this.setColor("#1B1B1B");if((typeof A==="number")&&(typeof B==="number")){this.setDimension(B,A)}else{this.setDimension(50,50)}},createShapeElement:function(){var A=this.getWidth()/2;var B=this.getHeight()/2;return this.canvas.paper.ellipse(this.getAbsoluteX()+A,this.getAbsoluteY()+B,A,B)},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}if(typeof A.rx==="undefined"){A.rx=this.width/2;A.ry=this.height/2}if(typeof A.cx==="undefined"){A.cx=this.getAbsoluteX()+A.rx;A.cy=this.getAbsoluteY()+A.ry}this._super(A)},intersectionWithLine:function(S,Q){var D=this.getWidth()/2;var C=this.getHeight()/2;var G=new draw2d.util.ArrayList();var R=new draw2d.geo.Point(S.x,S.y);var J=Q.subtract(S);var O=new draw2d.geo.Point(this.getAbsoluteX()+D,this.getAbsoluteY()+C);var I=R.subtract(O);var B=new draw2d.geo.Point(J.x/(D*D),J.y/(C*C));var A=new draw2d.geo.Point(I.x/(D*D),I.y/(C*C));var P=J.dot(B);var N=J.dot(A);var M=I.dot(A)-1;var L=N*N-P*M;if(L<0){}else{if(L>0){var K=Math.sqrt(L);var F=(-N-K)/P;var E=(-N+K)/P;if((F<0||1<F)&&(E<0||1<E)){if((F<0&&E<0)||(F>1&&E>1)){}else{}}else{if(0<=F&&F<=1){G.add(S.lerp(Q,F))}if(0<=E&&E<=1){G.add(S.lerp(Q,E))}}}else{var H=-N/P;if(0<=H&&H<=1){G.add(S.lerp(Q,H))}else{}}}return G}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/basic/Circle.js' */
(function ($) {draw2d.shape.basic.Circle=draw2d.shape.basic.Oval.extend({NAME:"draw2d.shape.basic.Circle",init:function(A){this._super();if(typeof A==="number"){this.setDimension(A,A)}else{this.setDimension(40,40)}},setDimension:function(A,B){if(A>B){this._super(A,A)}else{this._super(B,B)}},isStrechable:function(){return false}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/basic/Label.js' */
(function ($) {draw2d.shape.basic.Label=draw2d.SetFigure.extend({NAME:"draw2d.shape.basic.Label",FONT_FALLBACK:{Georgia:"Georgia, serif","Palatino Linotype":'"Palatino Linotype", "Book Antiqua", Palatino, serif',"Times New Roman":'"Times New Roman", Times, serif',Arial:"Arial, Helvetica, sans-serif","Arial Black":'"Arial Black", Gadget, sans-serif',"Comic Sans MS":'"Comic Sans MS", cursive, sans-serif',Impact:"Impact, Charcoal, sans-serif","Lucida Sans Unicode":'"Lucida Sans Unicode", "Lucida Grande", sans-serif',"Tahoma, Geneva":"Tahoma, Geneva, sans-seri","Trebuchet MS":'"Trebuchet MS", Helvetica, sans-serif',Verdana:"Verdana, Geneva, sans-serif","Courier New":'"Courier New", Courier, monospace',"Lucida Console":'"Lucida Console", Monaco, monospace'},init:function(A){this._super();if(typeof A==="string"){this.text=A}else{this.text=""}this.cachedWidth=null;this.cachedHeight=null;this.cachedMinWidth=null;this.cachedMinHeight=null;this.fontSize=12;this.fontColor=new draw2d.util.Color("#080808");this.fontFamily=null;this.padding=4;this.bold=false;this.setStroke(1);this.setDimension(10,10);this.editor=null;this.installEditPolicy(new draw2d.policy.figure.AntSelectionFeedbackPolicy())},createSet:function(){return this.canvas.paper.text(0,0,this.text)},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }this.cachedWidth=null;this.cachedHeight=null;this.cachedMinWidth=null;this.cachedMinHeight=null;var B={};B.text=this.text;B.x=this.padding+this.getStroke();B.y=this.getHeight()/2;B["font-weight"]=(this.bold===true)?"bold":"normal";B["text-anchor"]="start";B["font-size"]=this.fontSize;if(this.fontFamily!==null){B["font-family"]=this.fontFamily}B.fill=this.fontColor.hash();this.svgNodes.attr(B);this._super(A)},applyTransformation:function(){this.shape.transform("R"+this.rotationAngle);this.svgNodes.transform("R"+this.rotationAngle+"T"+this.getAbsoluteX()+","+this.getAbsoluteY())},isResizeable:function(){return false},setFontSize:function(A){this.cachedMinWidth=null;this.cachedMinHeight=null;this.fontSize=A;this.repaint()},setBold:function(A){this.cachedMinWidth=null;this.cachedMinHeight=null;this.bold=A;this.repaint()},setFontColor:function(A){this.fontColor=new draw2d.util.Color(A);this.repaint()},getFontColor:function(){return this.fontColor},setPadding:function(A){this.cachedMinWidth=null;this.cachedMinHeight=null;this.cachedWidth=null;this.cachedHeight=null;this.padding=A;this.repaint()},setFontFamily:function(A){this.cachedMinWidth=null;this.cachedMinHeight=null;this.cachedWidth=null;this.cachedHeight=null;if(this.FONT_FALLBACK[A]!=="undefined"){A=this.FONT_FALLBACK[A]}this.fontFamily=A;this.repaint()},setDimension:function(A,B){this.cachedWidth=null;this.cachedHeight=null;this._super(A,B)},getMinWidth:function(){if(this.shape===null){return 0}if(this.cachedMinWidth===null){this.cachedMinWidth=this.svgNodes.getBBox(true).width+2*this.padding+2*this.getStroke()}return this.cachedMinWidth},getMinHeight:function(){if(this.shape===null){return 0}if(this.cachedMinHeight===null){this.cachedMinHeight=this.svgNodes.getBBox(true).height+2*this.padding+2*this.getStroke()}return this.cachedMinHeight},getWidth:function(){if(this.shape===null){return 0}if(this.cachedWidth===null){this.cachedWidth=Math.max(this.width,this.getMinWidth())}return this.cachedWidth},getHeight:function(){if(this.shape===null){return 0}if(this.cachedHeight===null){this.cachedHeight=Math.max(this.height,this.getMinHeight())}return this.cachedHeight},installEditor:function(A){this.editor=A},onDoubleClick:function(){if(this.editor!==null){this.editor.start(this)}},getText:function(){return this.text},setText:function(A){this.cachedWidth=null;this.cachedHeight=null;this.cachedMinWidth=null;this.cachedMinHeight=null;this.text=A;this.repaint();this.editPolicy.each($.proxy(function(B,C){if(C instanceof draw2d.policy.figure.DragDropEditPolicy){C.moved(this.canvas,this)}},this));this.fireResizeEvent();if(this.parent!==null){this.parent.repaint()}},hitTest:function(I,F){if(this.rotationAngle===0){return this._super(I,F)}var H=this.shape.matrix;var J=this.getBoundingBox().getPoints();J.each(function(M,L){var K=H.x(L.x,L.y);var N=H.y(L.x,L.y);L.x=K;L.y=N});var A=4;var D=0;var B=A-1;var G=false;for(D=0;D<A;D++){var E=J.get(D);var C=J.get(B);if((E.y<F&&C.y>=F||C.y<F&&E.y>=F)&&(E.x<=I||C.x<=I)){if(E.x+(F-E.y)/(C.y-E.y)*(C.x-E.x)<I){G=!G}}B=D}return G},getPersistentAttributes:function(){var A=this._super();A.text=this.text;A.fontSize=this.fontSize;A.fontColor=this.fontColor.hash();A.fontFamily=this.fontFamily;return A},setPersistentAttributes:function(A){this._super(A);if(typeof A.text!=="undefined"){this.setText(A.text)}if(typeof A.fontFamily!=="undefined"){this.setFontFamily(A.fontFamily)}if(typeof A.fontSize!=="undefined"){this.setFontSize(A.fontSize)}if(typeof A.fontColor!=="undefined"){this.setFontColor(A.fontColor)}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/basic/Line.js' */
(function ($) {draw2d.shape.basic.Line=draw2d.Figure.extend({NAME:"draw2d.shape.basic.Line",DEFAULT_COLOR:new draw2d.util.Color(0,0,0),init:function(B,A,D,C){this.repaintBlocked=false;this.corona=10;this.isGlowing=false;this.lineColor=this.DEFAULT_COLOR;this.stroke=1;this.dasharray=null;if(typeof C==="number"){this.startX=B;this.startY=A;this.endX=D;this.endY=C}else{this.startX=30;this.startY=30;this.endX=100;this.endY=100}this._super();this.installEditPolicy(new draw2d.policy.figure.LineSelectionFeedbackPolicy());this.setSelectable(true);this.setDeleteable(true)},onDragEnd:function(){this.setAlpha(this.originalAlpha);this.isInDragDrop=false;this.canvas.getCommandStack().execute(this.command);this.command=null;this.isMoving=false;this.editPolicy.each($.proxy(function(A,B){if(B instanceof draw2d.policy.figure.DragDropEditPolicy){B.onDragEnd(this.canvas,this)}},this));this.fireMoveEvent()},setDashArray:function(A){this.dasharray=A;return this},setCoronaWidth:function(A){this.corona=A;return this},createShapeElement:function(){return this.canvas.paper.path("M"+this.getStartX()+" "+this.getStartY()+"L"+this.getEndX()+" "+this.getEndY())},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={stroke:"#"+this.lineColor.hex(),"stroke-width":this.stroke,path:["M",this.getStartX(),this.getStartY(),"L",this.getEndX(),this.getEndY()].join(" ")}}else{if(typeof A.path==="undefined"){A.path=["M",this.getStartX(),this.getStartY(),"L",this.getEndX(),this.getEndY()].join(" ")}A.stroke=this.lineColor.hash();A["stroke-width"]=this.stroke}if(this.dasharray!==null){A["stroke-dasharray"]=this.dasharray}this._super(A)},setGlow:function(A){if(this.isGlowing===A){return }if(A===true){this._lineColor=this.lineColor;this._stroke=this.stroke;this.setColor(draw2d.util.Color("#3f72bf"));this.setStroke((this.stroke*4)|0)}else{this.setColor(this._lineColor);this.setStroke(this._stroke)}this.isGlowing=A;return this},isResizeable:function(){return true},setStroke:function(A){this.stroke=A;this.repaint();return this},setColor:function(A){this.lineColor=new draw2d.util.Color(A);this.repaint();return this},getColor:function(){return this.lineColor},setStartPoint:function(A,B){if(this.startX===A&&this.startY===B){return }this.startX=A;this.startY=B;this.repaint();this.editPolicy.each($.proxy(function(C,D){if(D instanceof draw2d.policy.figure.DragDropEditPolicy){D.moved(this.canvas,this)}},this));return this},setEndPoint:function(A,B){if(this.endX===A&&this.endY===B){return }this.endX=A;this.endY=B;this.repaint();this.editPolicy.each($.proxy(function(C,D){if(D instanceof draw2d.policy.figure.DragDropEditPolicy){D.moved(this.canvas,this)}},this));return this},getStartX:function(){return this.startX},getStartY:function(){return this.startY},getStartPoint:function(){return new draw2d.geo.Point(this.startX,this.startY)},getEndX:function(){return this.endX},getEndY:function(){return this.endY},getEndPoint:function(){return new draw2d.geo.Point(this.endX,this.endY)},getSegments:function(){var A=new draw2d.util.ArrayList();A.add({start:this.getStartPoint(),end:this.getEndPoint()});return A},getLength:function(){if(this.shape!==null){return this.shape.getTotalLength()}return Math.sqrt((this.startX-this.endX)*(this.startX-this.endX)+(this.startY-this.endY)*(this.startY-this.endY))},getAngle:function(){var A=this.getLength();var B=-(180/Math.PI)*Math.asin((this.startY-this.endY)/A);if(B<0){if(this.endX<this.startX){B=Math.abs(B)+180}else{B=360-Math.abs(B)}}else{if(this.endX<this.startX){B=180-B}}return B},createCommand:function(E){if(E.getPolicy()===draw2d.command.CommandType.MOVE){var B=this.getStartX();var D=this.getStartY();var A=this.getEndX();var C=this.getEndY();return new draw2d.command.CommandMoveLine(this,B,D,A,C)}if(E.getPolicy()===draw2d.command.CommandType.DELETE){if(this.isDeleteable()===false){return null}return new draw2d.command.CommandDelete(this)}return null},hitTest:function(B,A){return draw2d.shape.basic.Line.hit(this.corona,this.startX,this.startY,this.endX,this.endY,B,A)},intersection:function(B){var A=new draw2d.util.ArrayList();if(B===this){return A}var D=this.getSegments();var C=B.getSegments();D.each(function(F,E){C.each(function(H,G){var I=draw2d.shape.basic.Line.intersection(E.start,E.end,G.start,G.end);if(I!==null){A.add(I)}})});return A},getPersistentAttributes:function(){var A=this._super();delete A.x;delete A.y;delete A.width;delete A.height;A.stroke=this.stroke;A.color=this.getColor().hash();return A},setPersistentAttributes:function(A){this._super(A);if(typeof A.stroke!=="undefined"){this.setStroke(parseInt(A.stroke))}if(typeof A.color!=="undefined"){this.setColor(A.color)}}});draw2d.shape.basic.Line.intersection=function(E,C,I,H){var J=null;var F=(H.x-I.x)*(E.y-I.y)-(H.y-I.y)*(E.x-I.x);var G=(C.x-E.x)*(E.y-I.y)-(C.y-E.y)*(E.x-I.x);var D=(H.y-I.y)*(C.x-E.x)-(H.x-I.x)*(C.y-E.y);if(D!=0){var B=F/D;var A=G/D;if(0<=B&&B<=1&&0<=A&&A<=1){J=new draw2d.geo.Point((E.x+B*(C.x-E.x))|0,(E.y+B*(C.y-E.y))|0);J.justTouching=(0==B||B==1||0==A||A==1)}}return J};draw2d.shape.basic.Line.hit=function(D,C,J,B,I,H,G){B-=C;I-=J;H-=C;G-=J;var F=H*B+G*I;var A;if(F<=0){A=0}else{H=B-H;G=I-G;F=H*B+G*I;if(F<=0){A=0}else{A=F*F/(B*B+I*I)}}var E=H*H+G*G-A;if(E<0){E=0}return Math.sqrt(E)<D};}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/basic/PolyLine.js' */
(function ($) {draw2d.shape.basic.PolyLine=draw2d.shape.basic.Line.extend({NAME:"draw2d.shape.basic.PolyLine",init:function(){this.svgPathString=null;this.oldPoint=null;this.lineSegments=new draw2d.util.ArrayList();this.basePoints=new draw2d.util.ArrayList();this._super()},setStartPoint:function(A,B){this.repaintBlocked=true;this._super(A,B);this.calculatePath();this.repaintBlocked=false;this.repaint()},setEndPoint:function(A,B){this.repaintBlocked=true;this._super(A,B);this.calculatePath();this.repaintBlocked=false;this.repaint()},calculatePath:function(){if(this.shape===null){return }this.svgPathString=null;this.oldPoint=null;this.lineSegments=new draw2d.util.ArrayList();this.basePoints=new draw2d.util.ArrayList();this.router.route(this);this.routingRequired=false},repaint:function(){if(this.repaintBlocked===true||this.shape===null){return }if(this.svgPathString===null||this.routingRequired===true){this.calculatePath()}this._super({path:this.svgPathString,"stroke-linejoin":"round"})},onDragEnter:function(A){this.setGlow(true);return this},onDragLeave:function(A){this.setGlow(false)},getPoints:function(){return this.basePoints},getSegments:function(){return this.lineSegments},addPoint:function(A,B){if(typeof B!=="undefined"){A=new draw2d.geo.Point(A,B)}this.basePoints.add(A);if(this.oldPoint!==null){this.lineSegments.add({start:this.oldPoint,end:A})}this.svgPathString=null;this.oldPoint=A},onOtherFigureIsMoving:function(A){this.repaintBlocked=true;this._super(A);this.calculatePath();this.repaintBlocked=false;this.repaint()},hitTest:function(D,B){for(var C=0;C<this.lineSegments.getSize();C++){var A=this.lineSegments.get(C);if(draw2d.shape.basic.Line.hit(this.corona,A.start.x,A.start.y,A.end.x,A.end.y,D,B)){return true}}return false},createCommand:function(A){if(A.getPolicy()===draw2d.command.CommandType.DELETE){if(this.isDeleteable()===true){return new draw2d.command.CommandDelete(this)}}return null}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/basic/Diamond.js' */
(function ($) {draw2d.shape.basic.Diamond=draw2d.VectorFigure.extend({NAME:"draw2d.shape.basic.Diamond",init:function(B,A){this._super();this.setBackgroundColor("#00a3f6");this.setColor("#1B1B1B");if(typeof B==="undefined"){this.setDimension(50,90)}else{this.setDimension(B,A)}},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}var B=this.getBoundingBox();var C=["M",B.x+(B.w/2)," ",B.y];C.push("L",B.x+B.w," ",B.y+B.h/2);C.push("L",B.x+B.w/2," ",B.y+B.h);C.push("L",B.x," ",B.y+B.h/2);C.push("L",B.x+B.w/2," ",B.y);A.path=C.join("");this._super(A)},createShapeElement:function(){return this.canvas.paper.path("M0 0L1 1")}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/basic/Image.js' */
(function ($) {draw2d.shape.basic.Image=draw2d.shape.node.Node.extend({NAME:"draw2d.shape.basic.Image",init:function(C,B,A){this._super(B,A);this.path=C},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}A.x=this.getAbsoluteX();A.y=this.getAbsoluteY();A.width=this.getWidth();A.height=this.getHeight();this._super(A)},createShapeElement:function(){return this.canvas.paper.image(this.path,this.getX(),this.getY(),this.getWidth(),this.getHeight())}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/Connection.js' */
(function ($) {draw2d.Connection=draw2d.shape.basic.PolyLine.extend({NAME:"draw2d.Connection",init:function(A){this._super();this.sourcePort=null;this.targetPort=null;this.oldPoint=null;this.sourceDecorator=null;this.targetDecorator=null;this.sourceDecoratorNode=null;this.targetDecoratorNode=null;this.router=A||draw2d.Connection.DEFAULT_ROUTER;this.setColor("#1B1B1B");this.setStroke(1)},disconnect:function(){if(this.sourcePort!==null){this.sourcePort.detachMoveListener(this);this.fireSourcePortRouteEvent()}if(this.targetPort!==null){this.targetPort.detachMoveListener(this);this.fireTargetPortRouteEvent()}},reconnect:function(){if(this.sourcePort!==null){this.sourcePort.attachMoveListener(this);this.fireSourcePortRouteEvent()}if(this.targetPort!==null){this.targetPort.attachMoveListener(this);this.fireTargetPortRouteEvent()}this.onReconnect(this.getSourcePort(),this.getTargetPort());this.routingRequired=true;this.repaint()},isResizeable:function(){return this.isDraggable()},addFigure:function(B,A){if(!(A instanceof draw2d.layout.locator.ConnectionLocator)){throw"Locator must implement the class draw2d.layout.locator.ConnectionLocator"}this._super(B,A)},setSourceDecorator:function(A){this.sourceDecorator=A;this.routingRequired=true;if(this.sourceDecoratorNode!==null){this.sourceDecoratorNode.remove();this.sourceDecoratorNode=null}this.repaint()},getSourceDecorator:function(){return this.sourceDecorator},setTargetDecorator:function(A){this.targetDecorator=A;this.routingRequired=true;if(this.targetDecoratorNode!==null){this.targetDecoratorNode.remove();this.targetDecoratorNode=null}this.repaint()},getTargetDecorator:function(){return this.targetDecorator},setRouter:function(A){if(typeof A==="undefined"||A===null){this.router=new draw2d.layout.connection.NullRouter()}else{this.router=A}this.routingRequired=true;this.repaint()},getRouter:function(){return this.router},calculatePath:function(){if(this.sourcePort===null||this.targetPort===null){return }this._super()},repaint:function(B){if(this.repaintBlocked===true||this.shape===null){return }if(this.sourcePort===null||this.targetPort===null){return }this._super(B);if(this.getSource().getParent().isMoving===false&&this.getTarget().getParent().isMoving===false){if(this.targetDecorator!==null&&this.targetDecoratorNode===null){this.targetDecoratorNode=this.targetDecorator.paint(this.getCanvas().paper)}if(this.sourceDecorator!==null&&this.sourceDecoratorNode===null){this.sourceDecoratorNode=this.sourceDecorator.paint(this.getCanvas().paper)}}if(this.sourceDecoratorNode!==null){var C=this.getPoints().get(0);this.sourceDecoratorNode.transform("r"+this.getStartAngle()+","+C.x+","+C.y+" t"+C.x+","+C.y)}if(this.targetDecoratorNode!==null){var A=this.getPoints().getLastElement();this.targetDecoratorNode.transform("r"+this.getEndAngle()+","+A.x+","+A.y+" t"+A.x+","+A.y)}},getAbsoluteX:function(){return 0},getAbsoluteY:function(){return 0},postProcess:function(A){this.router.postProcess(this,this.getCanvas(),A)},onDragEnter:function(A){if(A instanceof draw2d.shape.basic.LineResizeHandle){return null}return this},onDragLeave:function(A){},getStartPoint:function(){if(this.isMoving===false){return this.sourcePort.getConnectionAnchorLocation(this.targetPort.getConnectionAnchorReferencePoint())}else{return this._super()}},getEndPoint:function(){if(this.isMoving===false){return this.targetPort.getConnectionAnchorLocation(this.sourcePort.getConnectionAnchorReferencePoint())}else{return this._super()}},setSource:function(A){if(this.sourcePort!==null){this.sourcePort.detachMoveListener(this);this.sourcePort.onDisconnect(this)}this.sourcePort=A;if(this.sourcePort===null){return }this.routingRequired=true;this.fireSourcePortRouteEvent();this.sourcePort.attachMoveListener(this);if(this.canvas!==null){this.sourcePort.onConnect(this)}this.setStartPoint(A.getAbsoluteX(),A.getAbsoluteY())},getSource:function(){return this.sourcePort},setTarget:function(A){if(this.targetPort!==null){this.targetPort.detachMoveListener(this);this.targetPort.onDisconnect(this)}this.targetPort=A;if(this.targetPort===null){return }this.routingRequired=true;this.fireTargetPortRouteEvent();this.targetPort.attachMoveListener(this);if(this.canvas!==null){this.targetPort.onConnect(this)}this.setEndPoint(A.getAbsoluteX(),A.getAbsoluteY())},getTarget:function(){return this.targetPort},sharingPorts:function(A){return this.sourcePort==A.sourcePort||this.sourcePort==A.targetPort||this.targetPort==A.sourcePort||this.targetPort==A.targetPort},setCanvas:function(A){this._super(A);if(this.sourceDecoratorNode!==null){this.sourceDecoratorNode.remove();this.sourceDecoratorNode=null}if(this.targetDecoratorNode!==null){this.targetDecoratorNode.remove();this.targetDecoratorNode=null}if(this.canvas===null){if(this.sourcePort!==null){this.sourcePort.detachMoveListener(this);this.sourcePort.onDisconnect(this)}if(this.targetPort!==null){this.targetPort.detachMoveListener(this);this.targetPort.onDisconnect(this)}}else{if(this.sourcePort!==null){this.sourcePort.attachMoveListener(this);this.sourcePort.onConnect(this)}if(this.targetPort!==null){this.targetPort.attachMoveListener(this);this.targetPort.onConnect(this)}}},onOtherFigureIsMoving:function(A){if(A===this.sourcePort){this.setStartPoint(this.sourcePort.getAbsoluteX(),this.sourcePort.getAbsoluteY())}else{this.setEndPoint(this.targetPort.getAbsoluteX(),this.targetPort.getAbsoluteY())}this._super(A)},getStartAngle:function(){if(this.lineSegments.getSize()===0){return 0}var D=this.lineSegments.get(0).start;var B=this.lineSegments.get(0).end;if(this.router instanceof draw2d.layout.connection.SplineConnectionRouter){B=this.lineSegments.get(5).end}var A=Math.sqrt((D.x-B.x)*(D.x-B.x)+(D.y-B.y)*(D.y-B.y));var C=-(180/Math.PI)*Math.asin((D.y-B.y)/A);if(C<0){if(B.x<D.x){C=Math.abs(C)+180}else{C=360-Math.abs(C)}}else{if(B.x<D.x){C=180-C}}return C},getEndAngle:function(){if(this.lineSegments.getSize()===0){return 90}var D=this.lineSegments.get(this.lineSegments.getSize()-1).end;var B=this.lineSegments.get(this.lineSegments.getSize()-1).start;if(this.router instanceof draw2d.layout.connection.SplineConnectionRouter){B=this.lineSegments.get(this.lineSegments.getSize()-5).end}var A=Math.sqrt((D.x-B.x)*(D.x-B.x)+(D.y-B.y)*(D.y-B.y));var C=-(180/Math.PI)*Math.asin((D.y-B.y)/A);if(C<0){if(B.x<D.x){C=Math.abs(C)+180}else{C=360-Math.abs(C)}}else{if(B.x<D.x){C=180-C}}return C},fireSourcePortRouteEvent:function(){var B=this.sourcePort.getConnections();for(var A=0;A<B.getSize();A++){B.get(A).repaint()}},fireTargetPortRouteEvent:function(){var B=this.targetPort.getConnections();for(var A=0;A<B.getSize();A++){B.get(A).repaint()}},createCommand:function(A){if(A.getPolicy()===draw2d.command.CommandType.MOVE_BASEPOINT){return new draw2d.command.CommandReconnect(this)}return this._super(A)},getPersistentAttributes:function(){var B=this._super();var A=this.getSource().getParent();while(A.getParent()!==null){A=A.getParent()}B.source={node:A.getId(),port:this.getSource().getName()};var A=this.getTarget().getParent();while(A.getParent()!==null){A=A.getParent()}B.target={node:A.getId(),port:this.getTarget().getName()};B.router=this.router.NAME;return B},setPersistentAttributes:function(memento){this._super(memento);if(typeof memento.router!=="undefined"){this.setRouter(eval("new "+memento.router+"()"))}},onReconnect:function(A,B){}});draw2d.Connection.createConnection=function(A,B){return new draw2d.Connection()};draw2d.Connection.DEFAULT_ROUTER=new draw2d.layout.connection.ManhattanConnectionRouter();}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/ResizeHandle.js' */
(function ($) {draw2d.ResizeHandle=draw2d.shape.basic.Rectangle.extend({NAME:"draw2d.ResizeHandle",DEFAULT_COLOR:"#00bdee",init:function(A,B){this._super();this.isResizeHandle=true;this.owner=A;this.type=B;this.command=null;this.commandMove=null;this.commandResize=null;this.setDimension();this.setBackgroundColor(this.DEFAULT_COLOR);this.setColor("#7A7A7A");this.setStroke(1);this.setSelectable(false);this.setRadius(0)},select:function(A){},unselect:function(){},getSnapToDirection:function(){switch(this.type){case 1:return draw2d.SnapToHelper.NORTH_WEST;case 2:return draw2d.SnapToHelper.NORTH;case 3:return draw2d.SnapToHelper.NORTH_EAST;case 4:return draw2d.SnapToHelper.EAST;case 5:return draw2d.SnapToHelper.SOUTH_EAST;case 6:return draw2d.SnapToHelper.SOUTH;case 7:return draw2d.SnapToHelper.SOUTH_WEST;case 8:return draw2d.SnapToHelper.WEST;case 9:return draw2d.SnapToHelper.NSEW;default:return draw2d.SnapToHelper.EAST}},createShapeElement:function(){var A=this._super();switch(this.type){case 1:A.attr({cursor:"nw-resize"});break;case 2:A.attr({cursor:"n-resize"});break;case 3:A.attr({cursor:"ne-resize"});break;case 4:A.attr({cursor:"e-resize"});break;case 5:A.attr({cursor:"se-resize"});break;case 6:A.attr({cursor:"s-resize"});break;case 7:A.attr({cursor:"sw-resize"});break;case 8:A.attr({cursor:"w-resize"});break}return A},onDragStart:function(){if(!this.isDraggable()){return false}this.ox=this.getAbsoluteX();this.oy=this.getAbsoluteY();this.commandMove=this.owner.createCommand(new draw2d.command.CommandType(draw2d.command.CommandType.MOVE));this.commandResize=this.owner.createCommand(new draw2d.command.CommandType(draw2d.command.CommandType.RESIZE));return true},onDrag:function(K,J){if(this.isDraggable()===false){return }var I=this.getAbsoluteX();var H=this.getAbsoluteY();this._super(K,J);var F=this.getAbsoluteX()-I;var D=this.getAbsoluteY()-H;var A=this.owner;var C=A.getAbsoluteX();var B=A.getAbsoluteY();var E=A.getWidth();var G=A.getHeight();switch(this.type){case 1:A.setDimension(E-F,G-D);A.setPosition(C+(E-A.getWidth()),B+(G-A.getHeight()));break;case 2:A.setDimension(E,G-D);A.setPosition(C,B+(G-A.getHeight()));break;case 3:A.setDimension(E+F,G-D);A.setPosition(C,B+(G-A.getHeight()));break;case 4:A.setDimension(E+F,G);break;case 5:A.setDimension(E+F,G+D);break;case 6:A.setDimension(E,G+D);break;case 7:A.setDimension(E-F,G+D);A.setPosition(C+(E-A.getWidth()),B);break;case 8:A.setDimension(E-F,G);A.setPosition(C+(E-A.getWidth()),B);break}},onDragEnd:function(){if(!this.isDraggable()){return }if(this.commandMove!==null){this.commandMove.setPosition(this.owner.getX(),this.owner.getY());this.canvas.getCommandStack().execute(this.commandMove);this.commandMove=null}if(this.commandResize!==null){this.commandResize.setDimension(this.owner.getWidth(),this.owner.getHeight());this.canvas.getCommandStack().execute(this.commandResize);this.commandResize=null}this.canvas.hideSnapToHelperLines()},setPosition:function(A,B){if(A instanceof draw2d.geo.Point){this.x=A.x;this.y=A.y}else{this.x=A;this.y=B}this.repaint()},setDimension:function(C,A){if(typeof A!=="undefined"){this._super(C,A)}else{if(draw2d.isTouchDevice){this._super(15,15)}else{this._super(8,8)}}var D=this.getWidth();var B=D/2;switch(this.type){case 1:this.setSnapToGridAnchor(new draw2d.geo.Point(D,D));break;case 2:this.setSnapToGridAnchor(new draw2d.geo.Point(B,D));break;case 3:this.setSnapToGridAnchor(new draw2d.geo.Point(0,D));break;case 4:this.setSnapToGridAnchor(new draw2d.geo.Point(0,B));break;case 5:this.setSnapToGridAnchor(new draw2d.geo.Point(0,0));break;case 6:this.setSnapToGridAnchor(new draw2d.geo.Point(B,0));break;case 7:this.setSnapToGridAnchor(new draw2d.geo.Point(D,0));break;case 8:this.setSnapToGridAnchor(new draw2d.geo.Point(D,B));break;case 9:this.setSnapToGridAnchor(new draw2d.geo.Point(B,B));break}},show:function(A){this.setCanvas(A);this.canvas.resizeHandles.add(this);this.shape.toFront()},hide:function(){if(this.shape===null){return }this.canvas.resizeHandles.remove(this);this.setCanvas(null)},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}if(this.getAlpha()<0.9){A.fill="#e6e6e8"}else{A.fill="90-#b8c8ec-#e6e6e8"}this._super(A)},supportsSnapToHelper:function(){return true},onKeyDown:function(B,A){this.canvas.onKeyDown(B,A)},fireMoveEvent:function(){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/LineResizeHandle.js' */
(function ($) {draw2d.shape.basic.LineResizeHandle=draw2d.shape.basic.Circle.extend({NAME:"draw2d.shape.basic.LineResizeHandle",init:function(A){this._super();this.owner=A;this.isResizeHandle=true;if(draw2d.isTouchDevice){this.setDimension(14,14)}else{this.setDimension(7,7)}this.setBackgroundColor("#d04437");this.setColor("#d04437");this.setStroke(1);this.setSelectable(false);this.currentTarget=null},select:function(A){},unselect:function(){},getRelatedPort:function(){return null},getOppositePort:function(){return null},getOppositePortTo:function(A){return _.without([this.owner.getSource(),this.owner.getTarget()],A)[0]},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}if(!("fill" in A)){if(this.getAlpha()<0.9){A.fill="#d04437"}else{A.fill="r(.4,.3)#d04437:40-#d04437:60-#d04437"}}this._super(A)},onDragStart:function(){this.ox=this.x;this.oy=this.y;this.command=this.getCanvas().getCurrentSelection().createCommand(new draw2d.command.CommandType(draw2d.command.CommandType.MOVE_BASEPOINT));return true},onDrag:function(D,A){this.setPosition(this.ox+D,this.oy+A);var C=this.getRelatedPort();var B=this.getBoundingBox().getCenter();var E=C!==null?C.getDropTarget(B.x,B.y,null):null;if(E!==this.currentTarget&&E!==this.getOppositePortTo(C)){if(this.currentTarget!==null){this.currentTarget.onDragLeave(C);this.currentTarget.setGlow(false)}if(E!==null){this.currentTarget=E.onDragEnter(C);if(this.currentTarget!==null){this.currentTarget.setGlow(true)}}else{this.currentTarget=C}}else{if(this.currentTarget!==null){this.currentTarget.setGlow(true)}}return true},onDragEnd:function(){if(!this.isDraggable()){return false}var A=this.getRelatedPort();if(A!==null){if(this.currentTarget!==null){this.onDrop(this.currentTarget);this.currentTarget.onDragLeave(A);this.currentTarget.setGlow(false);this.currentTarget=null}}if(this.getCanvas().getCurrentSelection() instanceof draw2d.Connection){if(this.command!==null){this.command.cancel()}}else{if(this.command!==null){this.getCanvas().getCommandStack().execute(this.command)}}this.command=null;this.getCanvas().hideSnapToHelperLines();return true},supportsSnapToHelper:function(){if(this.getCanvas().getCurrentSelection() instanceof draw2d.Connection){return false}return true},show:function(B,A,C){this.setCanvas(B);this.setPosition(A,C);this.shape.toFront();this.canvas.resizeHandles.add(this)},hide:function(){if(this.shape===null){return }this.canvas.resizeHandles.remove(this);this.setCanvas(null)},onKeyDown:function(B,A){this.canvas.onKeyDown(B,A)},fireMoveEvent:function(){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/LineStartResizeHandle.js' */
(function ($) {draw2d.shape.basic.LineStartResizeHandle=draw2d.shape.basic.LineResizeHandle.extend({NAME:"draw2d.shape.basic.LineStartResizeHandle",init:function(A){this._super(A)},getRelatedPort:function(){if(this.owner instanceof draw2d.Connection){return this.owner.getSource()}return null},getOppositePort:function(){if(this.owner instanceof draw2d.Connection){return this.owner.getTarget()}return null},onDrag:function(D,A){var G=this.getX();var F=this.getY();this._super(D,A);var E=G-this.getX();var C=F-this.getY();var B=this.owner.getStartPoint();this.owner.setStartPoint(B.x-E,B.y-C);this.owner.isMoving=true;return true},onDrop:function(A){this.owner.isMoving=false;if(this.owner instanceof draw2d.Connection&&this.command!==null){this.command.setNewPorts(A,this.owner.getTarget());this.getCanvas().getCommandStack().execute(this.command)}this.command=null}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/LineEndResizeHandle.js' */
(function ($) {draw2d.shape.basic.LineEndResizeHandle=draw2d.shape.basic.LineResizeHandle.extend({NAME:"draw2d.shape.basic.LineEndResizeHandle",init:function(A){this._super(A)},getRelatedPort:function(){if(this.owner instanceof draw2d.Connection){return this.owner.getTarget()}return null},getOppositePort:function(){if(this.owner instanceof draw2d.Connection){return this.owner.getSource()}return null},onDrag:function(D,A){var G=this.getX();var F=this.getY();this._super(D,A);var E=G-this.getX();var C=F-this.getY();var B=this.owner.getEndPoint();this.owner.setEndPoint(B.x-E,B.y-C);this.owner.isMoving=true;this.detachMoveListener(this.owner);return true},onDrop:function(A){this.owner.isMoving=false;if(this.owner instanceof draw2d.Connection&&this.command!==null){this.command.setNewPorts(this.owner.getSource(),A);this.getCanvas().getCommandStack().execute(this.command)}this.command=null}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/Port.js' */
(function ($) {draw2d.Port=draw2d.shape.basic.Circle.extend({NAME:"draw2d.Port",DEFAULT_BORDER_COLOR:new draw2d.util.Color("#1B1B1B"),init:function(A){this.locator=null;this.lighterBgColor=null;this._super();if(draw2d.isTouchDevice){this.setDimension(25,25)}else{this.setDimension(10,10)}this.ox=this.x;this.oy=this.y;this.coronaWidth=5;this.corona=null;this.currentTargetPort=null;this.currentTarget=null;this.setBackgroundColor("#4f6870");this.setStroke(1);this.setColor(this.DEFAULT_BORDER_COLOR);this.setSelectable(false);if(typeof A==="undefined"){this.name=null}else{this.name=A}this.connectionAnchor=new draw2d.layout.anchor.ConnectionAnchor(this);this.value=null;this.maxFanOut=Number.MAX_VALUE;this.setCanSnapToHelper(false);this.installEditPolicy(new draw2d.policy.port.IntrusivePortsFeedbackPolicy())},setMaxFanOut:function(A){this.maxFanOut=Math.max(1,A);return this},getMaxFanOut:function(){return this.maxFanOut},setConnectionAnchor:function(A){if(typeof A==="undefined"||A===null){A=new draw2d.layout.anchor.ConnectionAnchor()}this.connectionAnchor=A;this.connectionAnchor.setOwner(this);return this},getConnectionAnchorLocation:function(A){return this.connectionAnchor.getLocation(A)},getConnectionAnchorReferencePoint:function(){return this.connectionAnchor.getReferencePoint()},getConnectionDirection:function(B,A){return this.getParent().getBoundingBox().getDirection(this.getAbsolutePosition())},setLocator:function(A){this.locator=A;return this},setBackgroundColor:function(A){this._super(A);this.lighterBgColor=this.bgColor.lighter(0.3).hash();return this},setValue:function(A){this.value=A;if(this.getParent()!==null){this.getParent().onPortValueChanged(this)}return this},getValue:function(){return this.value},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}A.cx=this.getAbsoluteX();A.cy=this.getAbsoluteY();A.rx=this.width/2;A.ry=A.rx;A.cursor="move";if(this.getAlpha()<0.9){A.fill=this.bgColor.hash()}else{A.fill=["90",this.bgColor.hash(),this.lighterBgColor].join("-")}this._super(A)},onMouseEnter:function(){this.setStroke(2)},onMouseLeave:function(){this.setStroke(1)},getConnections:function(){var A=new draw2d.util.ArrayList();var C=this.moveListener.getSize();for(var B=0;B<C;B++){var D=this.moveListener.get(B);if(D instanceof draw2d.Connection){A.add(D)}}return A},setParent:function(A){this._super(A);if(this.parent!==null){this.parent.detachMoveListener(this)}if(this.parent!==null){this.parent.attachMoveListener(this)}},getCoronaWidth:function(){return this.coronaWidth},setCoronaWidth:function(A){this.coronaWidth=A},onDragStart:function(){if(this.getConnections().getSize()>=this.maxFanOut){return false}this.getShapeElement().toFront();this.ox=this.x;this.oy=this.y;this.editPolicy.each($.proxy(function(A,B){if(B instanceof draw2d.policy.figure.DragDropEditPolicy){B.onDragStart(this.canvas,this)}},this));return true},onDrag:function(B,A){this.isInDragDrop=true;this._super(B,A);var C=this.getDropTarget(this.getAbsoluteX(),this.getAbsoluteY(),this);if(C!==this.currentTarget){if(this.currentTarget!==null){this.currentTarget.onDragLeave(this);this.editPolicy.each($.proxy(function(D,E){if(E instanceof draw2d.policy.port.PortFeedbackPolicy){E.onHoverLeave(this.canvas,this,this.currentTarget)}},this))}if(C!==null){this.currentTarget=C.onDragEnter(this);if(this.currentTarget!==null){this.currentTargetPort=C;this.editPolicy.each($.proxy(function(D,E){if(E instanceof draw2d.policy.port.PortFeedbackPolicy){E.onHoverEnter(this.canvas,this,this.currentTarget)}},this))}}else{this.currentTarget=null}}},onDragEnd:function(){this.setAlpha(1);this.setPosition(this.ox,this.oy);this.isInDragDrop=false;if(this.currentTarget){this.editPolicy.each($.proxy(function(A,B){if(B instanceof draw2d.policy.port.PortFeedbackPolicy){B.onHoverLeave(this.canvas,this,this.currentTarget)}},this))}this.editPolicy.each($.proxy(function(A,B){if(B instanceof draw2d.policy.figure.DragDropEditPolicy){B.onDragEnd(this.canvas,this)}},this));this.currentTarget=null},onDragEnter:function(B){if(!(B instanceof draw2d.Port)){return null}if(this.getConnections().getSize()>=this.maxFanOut){return null}var A=new draw2d.command.CommandType(draw2d.command.CommandType.CONNECT);A.canvas=this.parent.getCanvas();A.source=B;A.target=this;var C=this.createCommand(A);if(C===null){return null}return this},onDragLeave:function(A){if(!(A instanceof draw2d.Port)){return }},onDrop:function(C){if(!(C instanceof draw2d.Port)){return }var A=new draw2d.command.CommandType(draw2d.command.CommandType.CONNECT);A.canvas=this.parent.getCanvas();A.source=C;A.target=this;var B=this.createCommand(A);if(B!==null){this.parent.getCanvas().getCommandStack().execute(B)}this.setGlow(false)},onConnect:function(A){},onDisconnect:function(A){},onOtherFigureIsMoving:function(A){this.repaint();this.fireMoveEvent()},getName:function(){return this.name},setName:function(A){this.name=A},hitTest:function(B,F){var A=this.getAbsoluteX()-(this.coronaWidth*2)-this.getWidth()/2;var E=this.getAbsoluteY()-(this.coronaWidth*2)-this.getHeight()/2;var C=A+this.width+(this.coronaWidth*4);var D=E+this.height+(this.coronaWidth*4);return(B>=A&&B<=C&&F>=E&&F<=D)},setGlow:function(A){if(A===true&&this.corona===null){this.corona=new draw2d.Corona();this.corona.setDimension(this.getWidth()+(this.getCoronaWidth()*2),this.getWidth()+(this.getCoronaWidth()*2));this.corona.setPosition(this.getAbsoluteX()-this.getCoronaWidth()-this.getWidth()/2,this.getAbsoluteY()-this.getCoronaWidth()-this.getHeight()/2);this.corona.setCanvas(this.getCanvas());this.corona.getShapeElement();this.corona.repaint()}else{if(A===false&&this.corona!==null){this.corona.setCanvas(null);this.parent.getCanvas().removeFigure(this.corona);this.corona=null}}return this},createCommand:function(A){if(A.getPolicy()===draw2d.command.CommandType.MOVE){if(!this.isDraggable()){return null}return new draw2d.command.CommandMovePort(this)}if(A.getPolicy()===draw2d.command.CommandType.CONNECT){if(A.source.parent.id===A.target.parent.id){return null}else{return new draw2d.command.CommandConnect(A.canvas,A.source,A.target)}}return null},fireMoveEvent:function(){if(this.isInDragDrop===true){return }this._super()},getDropTarget:function(A,E,B){for(var C=0;C<this.targets.getSize();C++){var D=this.targets.get(C);if(D!==B){if(D.hitTest(A,E)===true){return D}}}return null},getDropTargets:function(){return this.targets.clone().grep($.proxy(function(A){return A!==this},this))}});draw2d.Corona=draw2d.shape.basic.Circle.extend({init:function(){this._super();this.setAlpha(0.3);this.setBackgroundColor(new draw2d.util.Color(178,225,255));this.setColor(new draw2d.util.Color(102,182,252))},setAlpha:function(A){this._super(Math.min(0.3,A));this.setDeleteable(false);this.setDraggable(false);this.setResizeable(false);this.setSelectable(false);return this}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/InputPort.js' */
(function ($) {draw2d.InputPort=draw2d.Port.extend({NAME:"draw2d.InputPort",init:function(A){this._super(A);this.locator=new draw2d.layout.locator.InputPortLocator()},onDragEnter:function(A){if(A instanceof draw2d.OutputPort){return this._super(A)}if(A instanceof draw2d.HybridPort){return this._super(A)}return null},onDragLeave:function(A){if(A instanceof draw2d.OutputPort){this._super(A)}else{if(A instanceof draw2d.HybridPort){this._super(A)}}},createCommand:function(A){if(A.getPolicy()===draw2d.command.CommandType.CONNECT){if(A.source.getParent().getId()===A.target.getParent().getId()){return null}if(A.source instanceof draw2d.OutputPort){return new draw2d.command.CommandConnect(A.canvas,A.source,A.target)}if(A.source instanceof draw2d.HybridPort){return new draw2d.command.CommandConnect(A.canvas,A.source,A.target)}return null}return this._super(A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/OutputPort.js' */
(function ($) {draw2d.OutputPort=draw2d.Port.extend({NAME:"draw2d.OutputPort",init:function(A){this._super(A);this.locator=new draw2d.layout.locator.OutputPortLocator()},onDragEnter:function(A){if(A instanceof draw2d.InputPort){return this._super(A)}if(A instanceof draw2d.HybridPort){return this._super(A)}return null},onDragLeave:function(A){if(A instanceof draw2d.InputPort){this._super(A)}else{if(A instanceof draw2d.HybridPort){this._super(A)}}},createCommand:function(A){if(A.getPolicy()===draw2d.command.CommandType.CONNECT){if(A.source.getParent().getId()===A.target.getParent().getId()){return null}if(A.source instanceof draw2d.InputPort){return new draw2d.command.CommandConnect(A.canvas,A.target,A.source)}if(A.source instanceof draw2d.HybridPort){return new draw2d.command.CommandConnect(A.canvas,A.target,A.source)}return null}return this._super(A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/HybridPort.js' */
(function ($) {draw2d.HybridPort=draw2d.Port.extend({NAME:"draw2d.HybridPort",init:function(A){this._super(A);this.locator=new draw2d.layout.locator.InputPortLocator()},onDragEnter:function(A){if(A instanceof draw2d.Port){return this._super(A)}return null},onDragLeave:function(A){if(!(A instanceof draw2d.Port)){return }if(A instanceof draw2d.Port){this._super(A)}},createCommand:function(A){if(A.getPolicy()===draw2d.command.CommandType.CONNECT){if(A.source instanceof draw2d.InputPort){return new draw2d.command.CommandConnect(A.canvas,A.target,A.source)}else{if(A.source instanceof draw2d.OutputPort){return new draw2d.command.CommandConnect(A.canvas,A.source,A.target)}else{if(A.source instanceof draw2d.HybridPort){return new draw2d.command.CommandConnect(A.canvas,A.target,A.source)}}}return null}return this._super(A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/anchor/ConnectionAnchor.js' */
(function ($) {draw2d.layout.anchor.ConnectionAnchor=Class.extend({NAME:"draw2d.layout.anchor.ConnectionAnchor",init:function(A){this.owner=A},getLocation:function(A){return this.getReferencePoint()},getOwner:function(){return this.owner},setOwner:function(A){if(typeof A==="undefined"){throw"Missing parameter for 'owner' in ConnectionAnchor.setOwner"}this.owner=A},getBox:function(){return this.getOwner().getAbsoluteBounds()},getReferencePoint:function(){return this.getOwner().getAbsolutePosition()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/anchor/ChopboxConnectionAnchor.js' */
(function ($) {draw2d.layout.anchor.ChopboxConnectionAnchor=draw2d.layout.anchor.ConnectionAnchor.extend({NAME:"draw2d.layout.anchor.ChopboxConnectionAnchor",init:function(A){this._super(A)},getLocation:function(B){var E=new draw2d.geo.Rectangle(0,0);E.setBounds(this.getBox());E.translate(-1,-1);E.resize(1,1);var A=E.getCenter();if(E.isEmpty()||(B.x==A.x&&B.y==A.y)){return A}var D=B.x-A.x;var C=B.y-A.y;var F=0.5/Math.max(Math.abs(D)/E.w,Math.abs(C)/E.h);D*=F;C*=F;A.translate(D,C);return A},getBox:function(){return this.getOwner().getParent().getBoundingBox()},getReferencePoint:function(){return this.getBox().getCenter()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/anchor/ShortesPathConnectionAnchor.js' */
(function ($) {draw2d.layout.anchor.ShortesPathConnectionAnchor=draw2d.layout.anchor.ConnectionAnchor.extend({NAME:"draw2d.layout.anchor.ShortesPathConnectionAnchor",init:function(A){this._super(A)},getLocation:function(E){var D=this.getOwner().getParent().getBoundingBox();var B=D.getCenter();if(this.getOwner().getParent() instanceof draw2d.shape.basic.Oval){var A=this.getOwner().getParent().intersectionWithLine(E,B);if(A.getSize()==1){return A.get(0)}}var C=D.determineOctant(new draw2d.geo.Rectangle(E.x,E.y,2,2));switch(C){case 0:return D.getTopLeft();case 1:return new draw2d.geo.Point(E.x,D.getTop());case 2:return D.getTopRight();case 3:return new draw2d.geo.Point(D.getRight(),E.y);case 4:return D.getBottomRight();case 5:return new draw2d.geo.Point(E.x,D.getBottom());case 6:return D.getBottomLeft();case 7:return new draw2d.geo.Point(D.getLeft(),E.y)}return D.getTopLeft()},getBox:function(){return this.getOwner().getParent().getBoundingBox()},getReferencePoint:function(){return this.getBox().getCenter()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/anchor/CenterEdgeConnectionAnchor.js' */
(function ($) {draw2d.layout.anchor.CenterEdgeConnectionAnchor=draw2d.layout.anchor.ConnectionAnchor.extend({NAME:"draw2d.layout.anchor.CenterEdgeConnectionAnchor",init:function(A){this._super(A)},getLocation:function(D){var C=this.getOwner().getParent().getBoundingBox();var B=C.getDirection(D);var A=C.getCenter();switch(B){case 0:A.y=C.y;break;case 1:A.x=C.x+C.w;break;case 2:A.y=C.y+C.h;break;case 3:A.x=C.x}return A},getBox:function(){return this.getOwner().getParent().getBoundingBox()},getReferencePoint:function(){return this.getBox().getCenter()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/arrow/CalligrapherArrowLeft.js' */
(function ($) {draw2d.shape.arrow.CalligrapherArrowLeft=draw2d.SVGFigure.extend({NAME:"draw2d.shape.arrow.CalligrapherArrowLeft",init:function(){this._super()},getSVG:function(){return'<svg width="230" height="60" xmlns="http://www.w3.org/2000/svg" version="1.1">  <path style="fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none" id="path3024" d="m 218.87943,27.464763 c -1.21088,-0.0563 -2.42064,-0.14616 -3.63262,-0.16893 c -5.82495,-0.10948 -18.61676,-0.0226 -22.97385,0.0122 c -7.12848,0.057 -14.25673,0.14021 -21.38495,0.22333 c -9.03765,0.10539 -18.07511,0.22813 -27.11266,0.3422 c -10.2269,0.11878 -20.4538,0.23756 -30.6807,0.35634 c -35.488759,0.4089 -70.975849,0.82793 -106.4669238,0.95195 c 0,0 7.9718628,-5.70244 7.9718628,-5.70244 l 0,0 c 6.374241,0.28694 12.745594,0.64561 19.122722,0.86083 c 28.09499,0.94816 56.21338,0.92473 84.315959,0.32205 c 10.51273,-0.32805 21.0288,-0.56402 31.53819,-0.98412 c 27.47361,-1.09824 54.91405,-2.91665 82.28177,-5.53697 c 0,0 -12.9788,9.32351 -12.9788,9.32351 z" inkscape:connector-curvature="0" />  <path style="fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none" id="path3026" d="m 100.75066,1.6309831 c -7.165239,3.9571 -14.284929,7.47866 -22.036659,10.2707299 c -5.00195,1.80163 -10.10374,3.31886 -15.2402,4.79424 c -8.25878,2.37815 -16.55626,4.65805 -24.9012,6.79479 c -2.89107,0.71593 -5.74687,1.56407 -8.66266,2.20424 c -3.211679,0.70512 -6.49468,1.17333 -9.752959,1.6747 c -5.447101,0.92112 -10.9044008,1.81762 -16.3983488,2.50082 c -1.608931,0.0814 -0.850754,0.10697 -2.275834,-0.0365 C 20.004071,21.041553 19.256899,21.517873 32.515691,19.216243 c 6.21537,-1.05913 12.34875,-2.37668 18.3945,-4.03234 c 8.12719,-2.02803 16.23765,-4.1157 24.26421,-6.4321199 c 5.23574,-1.55053 10.41682,-3.15473 15.46857,-5.12875 c 1.38953,-0.54295 2.7579,-1.12682 4.12253,-1.71603 c 0.98421,-0.42496 3.86537,-1.81801999 2.92296,-1.32600999 C 93.642191,2.6934931 89.529511,4.7073031 85.450031,6.7704531 l 15.300629,-5.1394 z" inkscape:connector-curvature="0" sodipodi:nodetypes="csccsccccccsssccc" />  <path style="fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none" id="path3028" d="m 80.764281,58.068863 c -2.45498,-3.50762 -6.58178,-6.10525 -10.40324,-8.66732 c -4.30614,-2.72676 -7.93958,-6.28283 -12.6021,-8.28702 c -7.39912,-4.50257 -11.70055,-7.85592 -20.85866,-9.23429 c -4.9257,-0.85706 -17.294247,-1.32043 -22.226462,-2.15427 c -3.445882,-0.42869 -6.2035918,0.70541 -9.6845138,0.57715 c -1.496337,-0.0586 -2.99355,-0.0965 -4.491229,-0.12472 l 13.9525278,-6.24562 l 3.25,-1.17153 c 1.441459,0.0813 -1.116338,0.15309 0.325505,0.23016 c 3.574557,0.17902 7.211864,0.0695 10.712655,0.73822 c 4.723107,1.08097 9.443947,2.1624 14.234177,3.05317 c 2.76739,0.64203 3.92627,0.87082 6.64127,1.66289 c 4.42146,1.28993 8.60075,3.01513 12.86503,4.58129 c 1.90199,0.73446 5.05193,1.93181 6.89302,2.7216 c 4.92005,2.11061 9.5916,4.57045 13.9716,7.31023 c 4.16708,2.62011 8.48023,5.20033 11.72012,8.56863 z" inkscape:connector-curvature="0" sodipodi:nodetypes="ccccccccccccscsccc" /></svg>'},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(this.svgNodes!==null){this.svgNodes.attr({fill:this.color.hash()})}this._super(A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/arrow/CalligrapherArrowDownLeft.js' */
(function ($) {draw2d.shape.arrow.CalligrapherArrowDownLeft=draw2d.SVGFigure.extend({NAME:"draw2d.shape.arrow.CalligrapherArrowDownLeft",init:function(){this._super()},getSVG:function(){return'<svg width="180" height="300" xmlns="http://www.w3.org/2000/svg" version="1.1">     <path style="fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none" id="path3084" d="m 159.63578,17.846597 c 0.43137,9.44641 -0.0636,18.88035 -0.8284,28.30165 c -1.73211,18.38336 -4.05381,36.71698 -6.08253,55.075313 c -1.61738,13.7075 -3.03402,27.43467 -3.97611,41.19113 c -1.09101,11.16584 -1.31019,22.36559 -1.28541,33.56466 c -0.1328,4.82188 0.3218,9.6468 0.14332,14.46812 c -0.0888,2.39977 -0.28315,3.73625 -0.55012,6.12095 c -0.85848,4.73147 -2.27416,9.40019 -4.7769,13.68272 c -1.47003,2.51544 -3.78493,5.6647 -5.47739,8.05048 c -5.02888,6.66256 -11.08555,12.65652 -18.10552,17.75963 c -4.23302,3.07716 -7.74942,5.12065 -12.22081,7.86298 c -13.253319,6.72606 -25.889792,15.11686 -40.84124,18.60576 c -3.016829,0.7039 -4.431417,0.8157 -7.450859,1.2076 c -6.983246,0.5774 -14.009174,0.3375 -21.010676,0.2509 c -3.278795,-0.033 -6.55749,0.01 -9.835897,0.045 c 0,0 20.838833,-13.2364 20.838833,-13.2364 l 0,0 c 3.147056,0.093 6.294483,0.1852 9.443646,0.2007 c 6.966697,0.011 13.971433,0.1301 20.897176,-0.6344 c 3.732439,-0.5577 7.321215,-1.2431 10.881203,-2.4145 c 1.517208,-0.4992 5.830867,-2.43339 4.487902,-1.6386 c -6.098183,3.6088 -25.104875,12.8748 -9.52514,5.223 c 4.40875,-2.5927 8.262057,-4.7459 12.425175,-7.65986 c 6.839117,-4.78709 12.633657,-10.50427 17.500607,-16.86761 c 2.53518,-3.56692 5.24684,-7.12748 7.07617,-11.03446 c 1.42357,-3.0404 2.21532,-6.28727 2.91146,-9.50152 c 0.91919,-6.88822 1.03991,-13.81392 1.25118,-20.74151 c 0.47683,-11.27871 0.96259,-22.55877 1.61689,-33.83062 c 1.21127,-14.03392 3.64191,-27.94339 5.46543,-41.92167 c 2.26899,-18.186603 4.6835,-36.384373 5.4487,-54.679643 c 0.0788,-2.46092 0.23808,-4.92087 0.23618,-7.38276 c -0.005,-6.45916 -0.62194,-13.00218 -2.13821,-19.32664 c 0,0 23.48134,-10.73998 23.48134,-10.73998 z" inkscape:connector-curvature="0" />     <path style="fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none" id="path3086" d="m 41.271518,252.40239 c 2.465518,-0.7264 4.879503,-1.7726 7.145328,-2.9859 c 0.955597,-0.5117 3.736822,-2.1986 2.791991,-1.6673 c -5.218817,2.9348 -10.409826,5.9187 -15.61474,8.878 c 5.366557,-3.4898 10.227818,-7.6685 14.119927,-12.75576 c 3.507157,-5.09382 4.097613,-11.17122 4.301158,-17.17644 c 0.02635,-3.95844 -0.31227,-7.90612 -0.635377,-11.84752 c 0,0 19.920693,-10.3059 19.920693,-10.3059 l 0,0 c 0.171761,4.05015 0.409899,8.09777 0.50079,12.15101 c -0.185739,6.23619 -0.347804,12.66862 -3.492579,18.24747 c -0.503375,0.75197 -0.961922,1.53596 -1.510126,2.25591 c -3.478528,4.56826 -8.226837,8.04586 -12.757403,11.47443 c -7.345206,4.3297 -14.671333,8.692 -22.035619,12.9891 c -3.551305,2.0723 -7.368692,3.8726 -11.394645,4.7773 c 0,0 18.660602,-14.0344 18.660602,-14.0344 z" inkscape:connector-curvature="0" />     <path style="fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none" id="path3088" d="m 37.815923,255.49919 c 3.41111,0.1581 6.814569,0.2213 10.182693,0.8184 c 6.92998,2.6928 13.533527,6.2357 20.043462,9.8162 c 3.912139,2.1362 7.91195,4.4644 10.690321,8.0298 c 1.039962,1.2802 1.510411,2.7604 1.893523,4.3313 c 0,0 -20.370847,10.9259 -20.370847,10.9259 l 0,0 c -0.225419,-1.2711 -0.55067,-2.4558 -1.329618,-3.5184 c -2.332229,-3.3633 -5.869056,-5.6279 -9.247191,-7.8233 c -6.335066,-3.7106 -12.98611,-7.1834 -20.232784,-8.6836 c -3.497247,-0.3814 -7.011372,-0.4307 -10.521829,-0.1703 c 0,0 18.89227,-13.726 18.89227,-13.726 z" inkscape:connector-curvature="0" /></svg>'},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(this.svgNodes!==null){this.svgNodes.attr({fill:this.color.hash()})}this._super(A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/node/Start.js' */
(function ($) {draw2d.shape.node.Start=draw2d.shape.basic.Rectangle.extend({NAME:"draw2d.shape.node.Start",DEFAULT_COLOR:new draw2d.util.Color("#4D90FE"),init:function(){this._super();this.createPort("output");this.setDimension(50,50);this.setBackgroundColor(this.DEFAULT_COLOR);this.setColor(this.DEFAULT_COLOR.darker())}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/node/End.js' */
(function ($) {draw2d.shape.node.End=draw2d.shape.basic.Rectangle.extend({NAME:"draw2d.shape.node.End",DEFAULT_COLOR:new draw2d.util.Color("#4D90FE"),init:function(){this._super();this.createPort("input");this.setDimension(50,50);this.setBackgroundColor(this.DEFAULT_COLOR);this.setColor(this.DEFAULT_COLOR.darker())}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/node/Between.js' */
(function ($) {draw2d.shape.node.Between=draw2d.shape.basic.Rectangle.extend({NAME:"draw2d.shape.node.Between",DEFAULT_COLOR:new draw2d.util.Color("#4D90FE"),init:function(){this._super();this.setDimension(50,50);this.setBackgroundColor(this.DEFAULT_COLOR);this.setColor(this.DEFAULT_COLOR.darker());this.createPort("output");this.createPort("input")}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/note/PostIt.js' */
(function ($) {draw2d.shape.note.PostIt=draw2d.shape.basic.Label.extend({NAME:"draw2d.shape.note.PostIt",init:function(A){this._super(A);this.setStroke(1);this.setBackgroundColor("#5b5b5b");this.setColor("#FFFFFF");this.setFontColor("#ffffff");this.setFontSize(14);this.setPadding(5);this.setRadius(5)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/widget/Widget.js' */
(function ($) {draw2d.shape.widget.Widget=draw2d.SetFigure.extend({init:function(B,A){this._super(B,A)},getWidth:function(){return this.width},getHeight:function(){return this.height}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/widget/Slider.js' */
(function ($) {draw2d.shape.widget.Slider=draw2d.shape.widget.Widget.extend({NAME:"draw2d.shape.widget.Slider",DEFAULT_COLOR_THUMB:new draw2d.util.Color("#bddf69"),DEFAULT_COLOR_BG:new draw2d.util.Color("#d3d3d3"),init:function(B,A){if(typeof B==="undefined"){B=120;A=15}this.currentValue=0;this.slideBoundingBox=new draw2d.geo.Rectangle(0,0,10,20);this._super(B,A);this.setBackgroundColor(this.DEFAULT_COLOR_BG);this.setColor(this.DEFAULT_COLOR_THUMB);this.setStroke(1);this.setRadius(4);this.setResizeable(true);this.setMinHeight(10);this.setMinWidth(80)},createSet:function(){var A=this.canvas.paper.set();var B=this.canvas.paper.rect(5,5,10,20);B.node.style.cursor="col-resize";A.push(B);return A},setDimension:function(A,B){this._super(A,B);this.slideBoundingBox.setBoundary(0,0,this.getWidth()-10,this.getHeight());this.slideBoundingBox.setHeight(this.getHeight()+1);this.repaint()},onValueChange:function(A){},onDragStart:function(B,A){if(this.slideBoundingBox.hitTest(B,A)){this.origX=this.slideBoundingBox.getX();this.origY=this.slideBoundingBox.getY();return false}return this._super(B,A)},onPanning:function(B,A){this.slideBoundingBox.setPosition(this.origX+B,this.origY+A);this.setValue(100/(this.slideBoundingBox.bw-this.slideBoundingBox.getWidth())*this.slideBoundingBox.getX())},setValue:function(A){this.currentValue=Math.min(Math.max(0,(A|0)),100);this.repaint();this.onValueChange(this.currentValue)},repaint:function(B){if(this.repaintBlocked===true||this.shape===null){return }if(typeof B==="undefined"){B={}}var C=((this.slideBoundingBox.bw-this.slideBoundingBox.getWidth())/100*this.currentValue)|0;this.slideBoundingBox.setX(C);if(this.svgNodes!==null){var A=this.slideBoundingBox.toJSON();A.y=A.y-5;A.height=A.height+10;A.fill=this.getColor().hash();A.stroke=this.getColor().darker(0.2).hash();A.r=4;this.svgNodes.attr(A)}B.fill="90-"+this.bgColor.hash()+":5-"+this.bgColor.lighter(0.3).hash()+":95";B.stroke=this.bgColor.darker(0.1).hash();this._super(B)},applyTransformation:function(){this.svgNodes.transform("T"+this.getAbsoluteX()+","+this.getAbsoluteY())}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/diagram/Diagram.js' */
(function ($) {draw2d.shape.diagram.Diagram=draw2d.SetFigure.extend({init:function(B,A){this.data=[];this.padding=5;this.cache={};this._super(B,A);this.setBackgroundColor("#8dabf2");this.setStroke(1);this.setColor("#f0f0f0");this.setRadius(2);this.setResizeable(true)},setData:function(A){this.data=A;this.cache={};if(this.svgNodes!==null){this.svgNodes.remove();this.svgNodes=this.createSet()}this.repaint()},setDimension:function(A,B){this.cache={};this._super(A,B)},getWidth:function(){return this.width},getHeight:function(){return this.height},repaint:function(A){if(this.repaintBlocked===true||this.shape==null){return }if(typeof A==="undefined"){A={}}if(typeof A.fill==="undefined"){A.fill="none"}this._super(A)},applyTransformation:function(){if(this.isResizeable()===true){this.svgNodes.transform("S"+this.scaleX+","+this.scaleY+","+this.getAbsoluteX()+","+this.getAbsoluteY()+"t"+this.getAbsoluteX()+","+this.getAbsoluteY())}else{this.svgNodes.transform("T"+this.getAbsoluteX()+","+this.getAbsoluteY())}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/diagram/Pie.js' */
(function ($) {draw2d.shape.diagram.Pie=draw2d.shape.diagram.Diagram.extend({COLORS:["#00A8F0","#b9dd69","#f3546a","#4DA74D","#9440ED"],TWO_PI:Math.PI*2,init:function(A){this._super(A,A);this.setStroke(0)},setData:function(B){this.sum=0;$.each(B,$.proxy(function(C,D){this.sum+=D},this));var A=1/this.sum;$.each(B,$.proxy(function(C,D){B[C]=A*D},this));this._super(B)},createSet:function(){var A=this.getWidth()/2;var F=this.data.length;var C=this.canvas.paper.set();var H=0;for(var E=0;E<F;E++){var G=this.TWO_PI*this.data[E];var D=this.COLORS[E%F];var B=this.drawSegment(A,G,H,0.1);B.attr({stroke:this.color.hash(),fill:D});C.push(B);H+=G}return C},setDimension:function(A,B){if(A>B){this._super(A,A)}else{this._super(B,B)}if(this.svgNodes!==null){this.svgNodes.remove();this.svgNodes=this.createSet()}this.repaint()},polarPath:function(B,D,C){var A,E;A=B*Math.cos(D+C)+B;E=B*Math.sin(D+C)+B;return"L "+A+" "+E+" "},drawSegment:function(A,E,D,B){var F="M "+A+" "+A;for(var C=0;C<E;C+=B){F+=this.polarPath(A,C,D)}F+=this.polarPath(A,E,D);F+="L "+A+" "+A;return this.getCanvas().paper.path(F)},applyTransformation:function(){this.svgNodes.transform("T"+this.getAbsoluteX()+","+this.getAbsoluteY())}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/diagram/Sparkline.js' */
(function ($) {draw2d.shape.diagram.Sparkline=draw2d.shape.diagram.Diagram.extend({init:function(B,A){this.min=0;this.max=10;if(typeof B==="undefined"){B=180;A=50}this._super(B,A)},setData:function(A){this.min=Math.min.apply(Math,A);this.max=Math.max.apply(Math,A);if(this.max==this.min){this.max=this.min+1}this._super(A)},createSet:function(){return this.canvas.paper.path("M0 0 l0 0")},repaint:function(E){if(this.repaintBlocked===true||this.shape===null){return }if(typeof E==="undefined"){E={}}E.fill="90-#000:5-#4d4d4d:95";var H=this.padding;var A=this.getWidth()-2*+this.padding;var I=this.getHeight()-2*+this.padding;var C=this.data.length;var D=this.min;var G=this.max;var B=function(L,J){var K=1;if(C>1){K=(A/(C-1))}return{y:-((L-D)/(G-D)*I)+I+H,x:H+J*K}};if(this.svgNodes!==null&&(typeof this.cache.pathString==="undefined")){var F=null;$.each(this.data,$.proxy(function(J,K){var L=B(K,J);if(F===null){this.cache.pathString=["M",L.x,L.y].join(" ")}else{this.cache.pathString=[this.cache.pathString,"L",L.x,L.y].join(" ")}F=L},this));this.svgNodes.attr({path:this.cache.pathString,stroke:"#f0f0f0"})}this._super(E)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/analog/OpAmp.js' */
(function ($) {draw2d.shape.analog.OpAmp=draw2d.SVGFigure.extend({NAME:"draw2d.shape.analog.OpAmp",MyInputPortLocator:draw2d.layout.locator.PortLocator.extend({init:function(){this._super()},relocate:function(C,B){var D=B.getParent();var A=(8+18.5*C)*D.scaleY;this.applyConsiderRotation(B,1,A)}}),init:function(B,A){if(typeof B==="undefined"){B=50;A=50}this._super(B,A);this.inputLocator=new this.MyInputPortLocator();this.createPort("input",this.inputLocator);this.createPort("input",this.inputLocator);this.createPort("output");this.setBackgroundColor("#f0f0ff")},getSVG:function(){return'<svg xmlns="http://www.w3.org/2000/svg" version="1.1"><path d="m8.2627,0l0,35.36035l31.23926,-17.76025l-31.23926,-17.60011l0,0l0,0.00001zm2.27832,27.36719l4.08105,0m-2.10449,-2.20703l0,4.27979m2.26367,-21.35938l-4.15918,0"  stroke="#1B1B1B" fill="none"/><line x1="0.53516"  y1="8"  x2="8.21191"  y2="8"  stroke="#010101"/><line x1="39.14941" y1="18" x2="45.81055" y2="18" stroke="#010101" /><line x1="0.53516"  y1="27" x2="8.21191"  y2="27" stroke="#010101" /></svg>'},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}A.fill="none";if(this.bgColor!=null){this.svgNodes[0].attr({fill:this.bgColor.hash()})}this._super(A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/analog/ResistorBridge.js' */
(function ($) {draw2d.shape.analog.ResistorBridge=draw2d.SVGFigure.extend({NAME:"draw2d.shape.analog.ResistorBridge",MyInputPortLocator:draw2d.layout.locator.PortLocator.extend({init:function(){this._super()},relocate:function(C,A){var B=A.getParent().getWidth();var D=A.getParent().getHeight();this.applyConsiderRotation(A,B/2+1,D*C)}}),MyOutputPortLocator:draw2d.layout.locator.PortLocator.extend({init:function(){this._super()},relocate:function(C,A){var B=A.getParent().getWidth();var D=A.getParent().getHeight();this.applyConsiderRotation(A,B*(C-2),D/2)}}),init:function(B,A){if(typeof B==="undefined"){B=50;A=50}this._super(B,A);this.inputLocator=new this.MyInputPortLocator();this.outputLocator=new this.MyOutputPortLocator();this.createPort("hybrid",this.inputLocator);this.createPort("hybrid",this.inputLocator);this.createPort("hybrid",this.outputLocator);this.createPort("hybrid",this.outputLocator)},getSVG:function(){return'<svg  xmlns="http://www.w3.org/2000/svg" version="1.1"><path fill="#010101" stroke="#010101" stroke-miterlimit="14.3" id="path12322" d="m47.62207,22.71094l0,0c0.73145,0.73242 0.71777,1.93359 -0.03027,2.68164c-0.74805,0.74951 -1.94922,0.76123 -2.68073,0.0293c-0.73138,-0.73242 -0.71967,-1.93211 0.03033,-2.68115c0.74707,-0.74803 1.94727,-0.76219 2.68066,-0.02979l0,0z"/><path fill="#010101" stroke="#010101" stroke-miterlimit="14.3" id="path12324" d="m25.84082,0.93115l0,0c0.73145,0.73096 0.71875,1.93359 -0.02832,2.68066c-0.75,0.74951 -1.94922,0.76123 -2.68164,0.0293c-0.73242,-0.73241 -0.71973,-1.93164 0.0293,-2.68065c0.74805,-0.74756 1.94922,-0.76172 2.68066,-0.0293l0,0l0,-0.00002z"/><path fill="#010101" stroke="#010101" stroke-miterlimit="14.3" id="path12326" d="m25.75098,44.58203l0,0c0.73145,0.73193 0.71875,1.93311 -0.02832,2.68115c-0.75,0.74902 -1.94922,0.76074 -2.68262,0.0293c-0.73145,-0.73193 -0.71973,-1.93262 0.03033,-2.68164c0.74707,-0.74756 1.94922,-0.76123 2.68066,-0.02879l0,0l-0.00006,-0.00002z"/><path fill="#010101" stroke="#010101" stroke-miterlimit="14.3" id="path12328" d="m3.9707,22.80127l0,0c0.73242,0.73193 0.71777,1.93359 -0.0293,2.68115c-0.74902,0.74951 -1.94922,0.76172 -2.68164,0.0293c-0.73145,-0.73242 -0.71973,-1.93164 0.03027,-2.68115c0.74707,-0.74707 1.94922,-0.76074 2.68066,-0.0293l0,0z"/><polyline fill="none" stroke="#010101" id="polyline12334" points="24.908203125,45.49267578125 31.71875,38.68310546875 31.2119140625,36.98876953125 34.892578125,37.95703125 33.953125,34.22265625 37.6650390625,35.18359375 36.6767578125,31.52490234375 40.3759765625,32.47314453125 39.873046875,30.52783203125 45.884765625,24.51708984375 " stroke-miterlimit="14.3"/><polyline fill="#010101" id="polyline12338" points="36.3408203125,23.98876953125 38.146484375,29.55810546875 33.630859375,29.55810546875 35.435546875,23.98779296875 "/><line fill="none" stroke="#010101" id="line12340" y2="28.90967" x2="35.8877" y1="41.13428" x1="35.88867" stroke-miterlimit="14.3"/><polyline fill="none" stroke="#010101" id="polyline12346" points="3.2109375,23.79248046875 10.01953125,16.98388671875 9.513671875,15.2890625 13.193359375,16.25732421875 12.251953125,12.5234375 15.9658203125,13.48486328125 14.9775390625,9.82568359375 18.6767578125,10.7734375 18.173828125,8.82958984375 24.185546875,2.81787109375 " stroke-miterlimit="14.3"/><polyline fill="#010101" id="polyline12350" points="13.126953125,23.80419921875 11.3212890625,18.236328125 15.8369140625,18.236328125 14.0322265625,23.806640625 "/><line fill="none" stroke="#010101" id="line12352" y2="18.8833" x2="13.58008" y1="6.65967" x1="13.5791" stroke-miterlimit="14.3"/><polyline fill="none" stroke="#010101" id="polyline12358" points="46.65625,24.33642578125 39.84765625,17.52783203125 38.154296875,18.033203125 39.1220703125,14.353515625 35.3876953125,15.29345703125 36.34765625,11.58056640625 32.689453125,12.56884765625 33.6376953125,8.86865234375 31.6923828125,9.373046875 24.322265625,2.00341796875 " stroke-miterlimit="14.3"/><polyline fill="#010101" id="polyline12362" points="36.578125,1.87109375 38.3828125,7.439453125 33.8681640625,7.439453125 35.6728515625,1.869140625 "/><line fill="none" stroke="#010101" id="line12364" y2="6.7915" x2="36.125" y1="19.01758" x1="36.125" stroke-miterlimit="14.3"/><polyline fill="none" stroke="#010101" id="polyline12370" points="24.494140625,46.49951171875 17.685546875,39.69091796875 15.9921875,40.1953125 16.958984375,36.515625 13.2265625,37.45556640625 14.185546875,33.7421875 10.52734375,34.73193359375 11.474609375,31.03125 9.529296875,31.53515625 2.1611328125,24.166015625 " stroke-miterlimit="14.3"/><polyline fill="#010101" id="polyline12374" points="12.150390625,44.80029296875 10.34765625,39.23193359375 14.861328125,39.23095703125 13.0556640625,44.80224609375 "/><line fill="none" stroke="#010101" id="line12376" y2="39.87891" x2="12.60352" y1="27.6543" x1="12.60352" stroke-miterlimit="14.3"/></svg>'}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/analog/ResistorVertical.js' */
(function ($) {draw2d.shape.analog.ResistorVertical=draw2d.SetFigure.extend({NAME:"draw2d.shape.analog.ResistorVertical",MyInputPortLocator:draw2d.layout.locator.PortLocator.extend({init:function(){this._super()},relocate:function(C,A){var B=A.getParent().getWidth();var D=A.getParent().getHeight();this.applyConsiderRotation(A,B/2,D)}}),MyOutputPortLocator:draw2d.layout.locator.PortLocator.extend({init:function(){this._super()},relocate:function(C,A){var B=A.getParent().getWidth();this.applyConsiderRotation(A,B/2,0)}}),init:function(B,A){if(typeof B==="undefined"){B=30;A=50}this._super(B,A);this.inputLocator=new this.MyInputPortLocator();this.outputLocator=new this.MyOutputPortLocator();this.createPort("hybrid",this.inputLocator);this.createPort("hybrid",this.outputLocator)},createSet:function(){var A=this._super();A.push(this.canvas.paper.path("M15,0 L15,5 L0,7.5 L30,10 L0,15 L30,20 L0,25 L30,30 L15,32.5 L15,40"));return A}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/analog/VoltageSupplyHorizontal.js' */
(function ($) {draw2d.shape.analog.VoltageSupplyHorizontal=draw2d.SVGFigure.extend({NAME:"draw2d.shape.analog.VoltageSupplyHorizontal",MyInputPortLocator:draw2d.layout.locator.PortLocator.extend({init:function(){this._super()},relocate:function(B,A){var C=A.getParent().getHeight();this.applyConsiderRotation(A,0,C/2)}}),MyOutputPortLocator:draw2d.layout.locator.PortLocator.extend({init:function(){this._super()},relocate:function(C,A){var B=A.getParent().getWidth();var D=A.getParent().getHeight();this.applyConsiderRotation(A,B,D/2)}}),init:function(B,A){if(typeof B==="undefined"){B=50;A=30}this._super(B,A);this.createPort("hybrid",new this.MyInputPortLocator());this.createPort("hybrid",new this.MyOutputPortLocator())},getSVG:function(){return'<svg width="49" height="28" xmlns="http://www.w3.org/2000/svg" version="1.1"><path d="m24.99933,18.95592l0,-9.54576m-5.78374,-9.40907l0,28.35939m-5.78718,-9.40457l0,-9.54576m-5.78374,-9.40907l0,28.35939" id="path10566" stroke-miterlimit="14.3" stroke="#010101" fill="none"/><path d="m26.79878,14.13039l6.90583,0m-33.22691,0l6.90583,0" id="path10568" stroke-miterlimit="14.3" stroke-linecap="square" stroke="#010101" fill="none"/></svg>'}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/analog/VoltageSupplyVertical.js' */
(function ($) {draw2d.shape.analog.VoltageSupplyVertical=draw2d.SVGFigure.extend({NAME:"draw2d.shape.analog.VoltageSupplyVertical",MyInputPortLocator:draw2d.layout.locator.PortLocator.extend({init:function(){this._super()},relocate:function(C,A){var B=A.getParent().getWidth();var D=A.getParent().getHeight();this.applyConsiderRotation(A,B/2,D)}}),MyOutputPortLocator:draw2d.layout.locator.PortLocator.extend({init:function(){this._super()},relocate:function(C,A){var B=A.getParent().getWidth();this.applyConsiderRotation(A,B/2,0)}}),init:function(B,A){if(typeof B==="undefined"){B=30;A=50}this._super(B,A);this.inputLocator=new this.MyInputPortLocator();this.outputLocator=new this.MyOutputPortLocator();this.createPort("hybrid",this.inputLocator);this.createPort("hybrid",this.outputLocator)},getSVG:function(){return'<svg  xmlns="http://www.w3.org/2000/svg" version="1.1"><path d="m19.62398,12.37594l-9.87926,0m-9.74355,8.22145l29.36289,0m-9.74007,8.22469l-9.87927,0m-9.74355,8.22145l29.36289,0" id="path10560" stroke-miterlimit="14.3" stroke="#010101" fill="none"/><path d="m14.63157,9.81646l0,-9.81646m0,47.2328l0,-9.81646" id="path10562" stroke-miterlimit="14.3" stroke-linecap="square" stroke="#010101" fill="none"/></svg>'}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/layout/Layout.js' */
(function ($) {draw2d.shape.layout.Layout=draw2d.shape.basic.Rectangle.extend({NAME:"draw2d.shape.layout.Layout",init:function(){this._super();this.setBackgroundColor(null);this.setRadius(0);this.setStroke(0);this.installEditPolicy(new draw2d.policy.figure.AntSelectionFeedbackPolicy())},addFigure:function(B,A){this._super(B,this.locator);B.attachResizeListener(this)},onOtherFigureIsResizing:function(A){if(this.getParent() instanceof draw2d.shape.layout.Layout){this.fireResizeEvent()}else{this.setDimension(1,1)}},onDoubleClick:function(A){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/layout/HorizontalLayout.js' */
(function ($) {draw2d.shape.layout.HorizontalLayout=draw2d.shape.layout.Layout.extend({NAME:"draw2d.shape.layout.HorizontalLayout",init:function(){this._super();var A=this;this.locator={relocate:function(B,E){var D=A.getStroke();var F=D;for(var C=0;C<B;C++){var G=A.children.get(C).figure;F+=G.getWidth()+A.gap}E.setPosition(F,D)}};this.setDimension(1,1);this.gap=0},setGap:function(A){this.gap=A;this.setDimension(1,1)},getMinWidth:function(){var A=this.stroke*2+Math.max(0,this.children.getSize()-1)*this.gap;this.children.each(function(B,C){A+=C.figure.getMinWidth()});return A},getMinHeight:function(){var A=10;this.children.each(function(B,C){A=Math.max(A,C.figure.getMinHeight())});return A+this.stroke*2},setDimension:function(A,B){this._super(A,B);var C=this.width-this.getMinWidth();if(C>0){C=(C/this.children.getSize())|0;this.children.each(function(D,E){E.figure.setDimension(E.figure.getMinWidth()+C,E.figure.getHeight())})}else{this.children.each(function(D,E){E.figure.setDimension(1,1)})}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/layout/VerticalLayout.js' */
(function ($) {draw2d.shape.layout.VerticalLayout=draw2d.shape.layout.Layout.extend({NAME:"draw2d.shape.layout.VerticalLayout",init:function(){this._super();this.gap=0;var A=this;this.locator={relocate:function(B,F){var E=A.getStroke()/2;var D=E;for(var C=0;C<B;C++){var G=A.children.get(C).figure;D=D+G.getHeight()+A.gap}F.setPosition(E,D)}};this.setDimension(10,10)},setGap:function(A){this.gap=A;this.setDimension(1,1)},getMinWidth:function(){var A=10;this.children.each(function(B,C){A=Math.max(A,C.figure.getMinWidth())});return A+this.stroke},getMinHeight:function(){var A=+this.stroke+Math.max(0,this.children.getSize()-1)*this.gap;this.children.each(function(B,C){A+=C.figure.getMinHeight()});return A},setDimension:function(A,C){this._super(A,C);var B=this.width-this.stroke;this.children.each(function(D,E){E.figure.setDimension(B,E.figure.getHeight())})}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/pert/Activity.js' */
(function ($) {draw2d.shape.pert.Activity=draw2d.shape.layout.VerticalLayout.extend({NAME:"draw2d.shape.pert.Activity",init:function(){this._super();var C=this;this.mementoValues={duration:null};this.lighterBgColor=null;this.darkerBgColor=null;this.setBackgroundColor("#f3f3f3");this.setStroke(2);this.setColor(this.darkerBgColor);this.setRadius(5);var B=new draw2d.shape.layout.HorizontalLayout();B.setStroke(0);this.earlyStartLabel=this.createLabel("Early Start").setStroke(0);this.durationLabel=new draw2d.shape.basic.Label("Duration");this.durationLabel.setStroke(1);this.durationLabel.setColor(this.darkerBgColor);this.durationLabel.setRadius(0);this.durationLabel.setBackgroundColor(null);this.durationLabel.setPadding(5);this.durationLabel.setColor(this.bgColor.darker(0.2));this.durationLabel.installEditor(new draw2d.ui.LabelEditor({onCommit:function(D){C.setDuration(parseFloat(D))}}));this.earlyEndLabel=this.createLabel("Early End").setStroke(0);B.addFigure(this.earlyStartLabel);B.addFigure(this.durationLabel);B.addFigure(this.earlyEndLabel);this.activityLabel=new draw2d.shape.basic.Label("Activity Name");this.activityLabel.setRadius(0);this.activityLabel.setPadding(10);this.activityLabel.setColor(this.darkerBgColor);this.activityLabel.setBackgroundColor(null);this.activityLabel.installEditor(new draw2d.ui.LabelInplaceEditor());this.inputPort=this.activityLabel.createPort("input");this.inputPort.getActivity=function(){return C};this.inputPort.onConnect=function(){C.setDuration(C.mementoValues.duration)};this.inputPort.onDisconnect=function(){C.setDuration(C.mementoValues.duration)};this.inputPort.setValue=function(D){C.setDuration(C.mementoValues.duration)};this.outputPort=this.activityLabel.createPort("output");this.outputPort.getActivity=function(){return C};this.outputPort.onConnect=function(){C.setDuration(C.mementoValues.duration)};this.outputPort.onDisconnect=function(){C.setDuration(C.mementoValues.duration)};var A=new draw2d.shape.layout.HorizontalLayout();A.setStroke(0);this.lateStartLabel=this.createLabel("Late Start").setStroke(0);this.stackLabel=this.createLabel("Stack");this.lateEndLabel=this.createLabel("Late End").setStroke(0);A.addFigure(this.lateStartLabel);A.addFigure(this.stackLabel);A.addFigure(this.lateEndLabel);this.addFigure(B);this.addFigure(this.activityLabel);this.addFigure(A);this.setDuration(1)},setDuration:function(C){if(this.mementoValues.duration!==C){this.mementoValues.duration=C;this.durationLabel.setText(this.mementoValues.duration)}var D=this.getEarlyStart();this.earlyStartLabel.setText(D);this.earlyEndLabel.setText(D+this.mementoValues.duration);var B=this.outputPort.getConnections();B.each($.proxy(function(F,G){var E=G.getTarget();E.setValue()},this));if(B.getSize()===0){var A=parseFloat(this.earlyEndLabel.getText());this.setLateFinish(A)}},getEarlyEnd:function(){return this.getEarlyStart()+this.mementoValues.duration},getEarlyStart:function(){var A=0;this.inputPort.getConnections().each(function(B,D){var C=D.getSource().getActivity();A=Math.max(A,C.getEarlyEnd())});return A},setLateFinish:function(C){var A=C-this.mementoValues.duration;this.lateEndLabel.setText(C);this.lateStartLabel.setText(A);this.stackLabel.setText(A-parseFloat(this.earlyStartLabel.getText()));var B=this.inputPort.getConnections();B.each($.proxy(function(E,F){var D=F.getSource();D.getActivity().setLateFinish(A)},this))},createLabel:function(A){var B=new draw2d.shape.basic.Label(A);B.setStroke(1);B.setColor(this.darkerBgColor);B.setRadius(0);B.setBackgroundColor(null);B.setPadding(5);B.setColor(this.bgColor.darker(0.2));B.onDoubleClick=function(C){};return B},setBackgroundColor:function(A){this._super(A);this.lighterBgColor=this.bgColor.lighter(0.2).hash();this.darkerBgColor=this.bgColor.darker(0.2).hash()},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}if(this.getAlpha()<0.9){A.fill=this.bgColor.hash()}else{A.fill=["90",this.bgColor.hash(),this.lighterBgColor].join("-")}this._super(A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/ui/LabelEditor.js' */
(function ($) {draw2d.ui.LabelEditor=Class.extend({init:function(A){this.listener=$.extend({onCommit:function(){},onCancel:function(){}},A)},start:function(A){var B=prompt("Label: ",A.getText());if(B){A.setText(B);this.listener.onCommit(A.getText())}else{this.listener.onCancel()}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/ui/LabelInplaceEditor.js' */
(function ($) {draw2d.ui.LabelInplaceEditor=draw2d.ui.LabelEditor.extend({init:function(A){this._super();this.listener=$.extend({onCommit:function(){},onCancel:function(){}},A)},start:function(B){this.label=B;this.commitCallback=$.proxy(this.commit,this);$("body").bind("click",this.commitCallback);this.html=$('<input id="inplaceeditor">');this.html.val(B.getText());this.html.hide();$("body").append(this.html);this.html.autoResize({animate:false});this.html.bind("keyup",$.proxy(function(E){switch(E.which){case 13:this.commit();break;case 27:this.cancel();break}},this));this.html.bind("blur",this.commitCallback);this.html.bind("click",function(E){E.stopPropagation();E.preventDefault()});var A=this.label.getCanvas();var C=this.label.getBoundingBox();C.setPosition(A.fromCanvasToDocumentCoordinate(C.x,C.y));var D=A.getScrollArea();if(D.is($("body"))){C.translate(A.getScrollLeft(),A.getScrollTop())}C.translate(-1,-1);C.resize(2,2);this.html.css({position:"absolute",top:C.y,left:C.x,"min-width":C.w,height:C.h});this.html.fadeIn($.proxy(function(){this.html.focus()},this))},commit:function(){this.html.unbind("blur",this.commitCallback);$("body").unbind("click",this.commitCallback);var A=this.html.val();this.label.setText(A);this.html.fadeOut($.proxy(function(){this.html.remove();this.html=null;this.listener.onCommit(this.label.getText())},this))},cancel:function(){this.html.unbind("blur",this.commitCallback);$("body").unbind("click",this.commitCallback);this.html.fadeOut($.proxy(function(){this.html.remove();this.html=null;this.listener.onCancel()},this))}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/decoration/connection/Decorator.js' */
(function ($) {draw2d.decoration.connection.Decorator=Class.extend({NAME:"draw2d.decoration.connection.Decorator",init:function(B,A){if(typeof B==="undefined"||B<1){this.width=20}if(typeof A==="undefined"||A<1){this.height=15}this.color=new draw2d.util.Color(0,0,0);this.backgroundColor=new draw2d.util.Color(250,250,250)},paint:function(A){},setColor:function(A){this.color=new draw2d.util.Color(A);return this},setBackgroundColor:function(A){this.backgroundColor=new draw2d.util.Color(A);return this},setDimension:function(B,A){this.width=B;this.height=A;return this}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/decoration/connection/ArrowDecorator.js' */
(function ($) {draw2d.decoration.connection.ArrowDecorator=draw2d.decoration.connection.Decorator.extend({NAME:"draw2d.decoration.connection.ArrowDecorator",init:function(B,A){this._super(B,A)},paint:function(B){var A=B.set();A.push(B.path(["M0 0","L",this.width," ",-this.height/2,"L",this.width," ",this.height/2,"L0 0"].join("")));A.attr({fill:this.backgroundColor.hash(),stroke:this.color.hash()});return A}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/decoration/connection/DiamondDecorator.js' */
(function ($) {draw2d.decoration.connection.DiamondDecorator=draw2d.decoration.connection.Decorator.extend({NAME:"draw2d.decoration.connection.DiamondDecorator",init:function(B,A){this._super(B,A)},paint:function(B){var A=B.set();A.push(B.path(["M",this.width/2," ",-this.height/2,"L",this.width," ",0,"L",this.width/2," ",this.height/2,"L",0," ",0,"L",this.width/2," ",-this.height/2,"Z"].join("")));A.attr({fill:this.backgroundColor.hash(),stroke:this.color.hash()});return A}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/decoration/connection/CircleDecorator.js' */
(function ($) {draw2d.decoration.connection.CircleDecorator=draw2d.decoration.connection.Decorator.extend({NAME:"draw2d.decoration.connection.CircleDecorator",init:function(B,A){this._super(B,A)},paint:function(B){var A=B.circle(0,0,this.width/2);A.attr({fill:this.backgroundColor.hash(),stroke:this.color.hash()});return A}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/decoration/connection/BarDecorator.js' */
(function ($) {draw2d.decoration.connection.BarDecorator=draw2d.decoration.connection.Decorator.extend({NAME:"draw2d.decoration.connection.BarDecorator",init:function(B,A){this._super(B,A)},paint:function(C){var A=C.set();var B=["M",this.width/2," ",-this.height/2];B.push("L",this.width/2," ",this.height/2);A.push(C.path(B.join("")));A.attr({fill:this.backgroundColor.hash(),stroke:this.color.hash()});return A}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/io/Reader.js' */
(function ($) {draw2d.io.Reader=Class.extend({init:function(){},unmarshal:function(B,A){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/io/Writer.js' */
(function ($) {draw2d.io.Writer=Class.extend({init:function(){},marshal:function(A){return""},formatXml:function(A){var C="";var B=/(>)(<)(\/*)/g;A=A.replace(B,"$1\r\n$2$3");var D=0;jQuery.each(A.split("\r\n"),function(F,H){var E=0;if(H.match(/.+<\/\w[^>]*>$/)){E=0}else{if(H.match(/^<\/\w/)){if(D!=0){D-=1}}else{if(H.match(/^<\w[^>]*[^\/]>.*$/)){E=1}else{E=0}}}var I="";for(var G=0;G<D;G++){I+="  "}C+=I+H+"\r\n";D+=E});return C}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/io/svg/Writer.js' */
(function ($) {draw2d.io.svg.Writer=draw2d.io.Writer.extend({init:function(){this._super()},marshal:function(B){var C=B.getCurrentSelection();B.setCurrentSelection(null);var A=B.getHtmlContainer().html().replace(/>\s+/g,">").replace(/\s+</g,"<");A=this.formatXml(A);A=A.replace(/<desc>.*<\/desc>/g,"<desc>Create with draw2d JS graph library and RaphaelJS</desc>");B.setCurrentSelection(C);return A}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/io/png/Writer.js' */
(function ($) {draw2d.io.png.Writer=draw2d.io.Writer.extend({init:function(){this._super()},marshal:function(D){var C=D.getHtmlContainer().html().replace(/>\s+/g,">").replace(/\s+</g,"<");C=C.replace('<svg xmlns="http://www.w3.org/2000/svg"',"<svg");var B=$('<canvas id="canvas" width="1000px" height="600px"></canvas>');$("body").append(B);canvg("canvas",C,{ignoreMouse:true,ignoreAnimation:true});var A=document.getElementById("canvas").toDataURL("image/png");B.remove();return A}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/io/json/Writer.js' */
(function ($) {draw2d.io.json.Writer=draw2d.io.Writer.extend({init:function(){this._super()},marshal:function(C){var A=[];var E=C.getFigures();var D=0;var F=null;for(D=0;D<E.getSize();D++){F=E.get(D);A.push(F.getPersistentAttributes())}var B=C.getLines();B.each(function(H,G){A.push(G.getPersistentAttributes())});return A}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/io/json/Reader.js' */
(function ($) {draw2d.io.json.Reader=draw2d.io.Reader.extend({init:function(){this._super()},unmarshal:function(canvas,json){var node=null;$.each(json,function(i,element){var o=eval("new "+element.type+"()");var source=null;var target=null;for(i in element){var val=element[i];if(i==="source"){node=canvas.getFigure(val.node);source=node.getPort(val.port)}else{if(i==="target"){node=canvas.getFigure(val.node);target=node.getPort(val.port)}}}if(source!==null&&target!==null){o.setSource(source);o.setTarget(target)}o.setPersistentAttributes(element);canvas.addFigure(o)});canvas.calculateConnectionIntersection();canvas.getLines().each(function(i,line){line.svgPathString=null;line.repaint()});canvas.linesToRepaintAfterDragDrop=canvas.getLines().clone()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/icon/Icon.js' */
(function ($) {draw2d.shape.icon.Icon=draw2d.SetFigure.extend({NAME:"draw2d.shape.icon.Icon",init:function(B,A){this._super(B,A);this.setBackgroundColor("#333333")},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}A.fill="none";if(this.svgNodes!==null){this.svgNodes.attr({fill:this.bgColor.hash(),stroke:"none"})}this._super(A)},applyTransformation:function(){if(this.isResizeable()===true){this.svgNodes.transform("S"+this.scaleX+","+this.scaleY+","+this.getAbsoluteX()+","+this.getAbsoluteY()+"t"+(this.getAbsoluteX()-this.offsetX)+","+(this.getAbsoluteY()-this.offsetY))}else{this.svgNodes.transform("T"+(this.getAbsoluteX()-this.offsetX)+","+(this.getAbsoluteY()-this.offsetY))}},createShapeElement:function(){var A=this._super();var B=this.svgNodes.getBBox();this.offsetX=B.x;this.offsetY=B.y;return A},setDimension:function(A,B){if(A>B){this._super(A,A)}else{this._super(B,B)}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/icon/ArrowLeft.js' */
(function ($) {draw2d.shape.icon.ArrowLeft=draw2d.shape.icon.Icon.extend({NAME:"draw2d.shape.icon.ArrowLeft",init:function(B,A){this._super(B,A)},createSet:function(){return this.canvas.paper.path("M24.316,5.318L6.684,15.5l17.632,10.182V5.318L24.316,5.318z")}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:form-dialog-view', location = 'js/util/BackboneDefine.js' */
Backbone.define=function(name,ctor){eval("Backbone['Class: "+name+"'] = function() { Backbone['Class: "+name+"'].__ctor.apply(this, arguments); }");var cls=Backbone["Class: "+name];cls.__ctor=ctor;ctor.prototype.name=name;cls.prototype=ctor.prototype;_.extend(cls,ctor);_.each(ctor.prototype,function(fn,fnName){if(typeof fn==="function"){fn.displayName=name+"."+fnName}});var context=window;var parts=name.split(".");_.each(parts,function(part,i){if(i===parts.length-1){context[part]=cls}else{context=context[part]==null?(context[part]={}):context[part]}});return cls};
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:form-dialog-view', location = 'js/views/dialogs/FormDialogView.js' */
(function(){Backbone.define("JIRA.WorkflowDesigner.Dialogs.FormDialogView",Backbone.View.extend({disable:function(){this.$(":input").attr("disabled","disabled")},enable:function(){this.$(":input").removeAttr("disabled")},hide:function(){this.dialog.hide(true)},_onContentRefresh:jQuery.noop,_onError:function(B){this.enable();this.showErrorMessage(B)},_onSubmit:function(){throw new Error("FormDialogView subclasses must implement _onSubmit().")},removeErrorMessages:function(){this.$(".error").remove()},reposition:function(){this.dialog._positionInCenter()},show:function(){var B=this;function C(){A.call(this);B.setElement(this.get$popup());B._onContentRefresh()}this.dialog=new JIRA.FormDialog({content:this._getContent(),id:this.id,onContentRefresh:C,submitHandler:_.bind(this._onSubmit,this)});this.dialog.show()},showErrorMessage:function(C){var B=this.$(".form-body");B.find(".aui-message.error").remove();B.prepend(aui.message.error({content:C})).scrollTop(0);this.reposition()}}));function A(){this.get$popup().find(":submit").removeClass("button")}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:properties-view', location = 'js/util/BackboneDefine.js' */
Backbone.define=function(name,ctor){eval("Backbone['Class: "+name+"'] = function() { Backbone['Class: "+name+"'].__ctor.apply(this, arguments); }");var cls=Backbone["Class: "+name];cls.__ctor=ctor;ctor.prototype.name=name;cls.prototype=ctor.prototype;_.extend(cls,ctor);_.each(ctor.prototype,function(fn,fnName){if(typeof fn==="function"){fn.displayName=name+"."+fnName}});var context=window;var parts=name.split(".");_.each(parts,function(part,i){if(i===parts.length-1){context[part]=cls}else{context=context[part]==null?(context[part]={}):context[part]}});return cls};
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:properties-view', location = 'js/views/properties-panel/PropertiesView.js' */
(function(){AJS.namespace("JIRA.WorkflowDesignerPropertiesPanel.PropertiesView");Backbone.define("JIRA.WorkflowDesigner.PropertiesPanel.PropertiesView",Backbone.View.extend({initialize:function(A){this._selectedView=A.selectedView;this._workflowModel=A.workflowModel;this._selectedView&&this._selectedView.model.on("change",this._onChange,this)},applyDescriptionExpander:function(){var B=this.$("#properties-panel-description"),A=parseInt(B.css("max-height"),10),C;if(B.length===0){return }B.css({height:"auto",maxHeight:"none"});C=B.height()>A;if(C){B.css({height:"",minHeight:A})}else{B.find(".aui-expander-trigger").remove();B.removeClass("aui-expander-content")}},_destroy:function(){this._selectedView.destroy()},_edit:function(){this._selectedView.edit()},_getTemplateData:function(){var A=this._selectedView&&this._selectedView.model.toJSON();return A||{}},_onChange:function(){this.render().applyDescriptionExpander()},remove:function(){Backbone.View.prototype.remove.apply(this);this._selectedView&&this._selectedView.model.off("change",this.render,this)},render:function(){var A=this._getTemplate();this.$el.html(A(this._getTemplateData()));return this}}))}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:status-dialog-view', location = 'js/views/dialogs/StatusDialogView.js' */
(function(){Backbone.define("JIRA.WorkflowDesigner.Dialogs.StatusDialogView",JIRA.WorkflowDesigner.Dialogs.FormDialogView.extend({initialize:function(A){this._workflowModel=A.workflowModel;this._statusModel=A.statusModel;_.bindAll(this,"_onSubmit","_onSuccess","_onError")},_getContent:function(){return jQuery(JIRA.WorkflowDesigner.Templates.statusDialog(this._statusModel.toJSON()))},_onSubmit:function(C,D){var A,B;C.preventDefault();this.disable();this.removeErrorMessages();A={description:this.$("#status-description").val(),name:this.$("#status-name").val(),workflowName:this._workflowModel.get("name")};B=this._makeRequest(A);B.done(this._onSuccess).fail(D).fail(this._onError)}}))}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:status-dialog-view', location = 'soy/WorkflowDesigner.soy' */
// This file was automatically generated from WorkflowDesigner.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.WorkflowDesigner == 'undefined') { JIRA.WorkflowDesigner = {}; }
if (typeof JIRA.WorkflowDesigner.Templates == 'undefined') { JIRA.WorkflowDesigner.Templates = {}; }


JIRA.WorkflowDesigner.Templates.actions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param3 = new soy.StringBuilder();
  if (! opt_data.immutable) {
    var param6 = new soy.StringBuilder();
    aui.buttons.button({extraClasses: 'add-status', iconClass: 'aui-icon-small aui-iconfont-add', iconText: "Add existing status", iconType: 'aui', text: "Add existing status"}, param6);
    aui.buttons.button({extraClasses: 'create-status', iconClass: 'aui-icon-small aui-iconfont-add', iconText: "Create new status", iconType: 'aui', text: "Create new status"}, param6);
    aui.form.checkboxField({extraClasses: 'show-transition-labels', fields: [{'id': 'show-transition-labels', 'isChecked': opt_data.showTransitionLabels, 'labelText': "Show transition labels"}], legendContent: ''}, param6);
    aui.toolbar2.item({content: param6.toString(), item: 'primary'}, param3);
  }
  if (opt_data.fullScreenButton) {
    var param27 = new soy.StringBuilder();
    aui.buttons.button({extraClasses: 'enter-full-screen full-screen-trigger', iconClass: 'aui-icon-small', iconType: 'aui', text: '', extraAttributes: {'title': "Enter full screen"}}, param27);
    aui.buttons.button({extraClasses: 'exit-full-screen full-screen-trigger hidden', iconClass: 'aui-icon-small', iconType: 'aui', text: '', extraAttributes: {'title': "Exit full screen"}}, param27);
    aui.toolbar2.item({content: param27.toString(), item: 'secondary'}, param3);
  }
  aui.toolbar2.toolbar2({content: param3.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.addStatusDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var hasStatuses__soy44 = opt_data.statuses.length > 0;
  output.append('<div class="aui-dialog-content">');
  var param47 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml("Add Status"), '</h2><div class="form-body">');
  var statusList51 = opt_data.statuses;
  var statusListLen51 = statusList51.length;
  if (statusListLen51 > 0) {
    for (var statusIndex51 = 0; statusIndex51 < statusListLen51; statusIndex51++) {
      var statusData51 = statusList51[statusIndex51];
      JIRA.WorkflowDesigner.Templates.addStatusDialogStatus(soy.$$augmentData(statusData51, {isSelected: statusIndex51 == 0}), param47);
    }
  } else {
    param47.append('<div class="no-statuses-message">', soy.$$escapeHtml("There are no statuses that can be added to this workflow."), '</div>');
  }
  param47.append('</div><div class="buttons-container form-footer">', (hasStatuses__soy44) ? '<div class="checkbox buttons-container-left"><input class="checkbox" id="create-global-transition" type="checkbox"><label for="create-global-transition">' + soy.$$escapeHtml("Add global transition to status") + '</label></div>' : '', '<div class="buttons">');
  if (hasStatuses__soy44) {
    aui.form.submit({extraClasses: 'aui-button aui-button-primary', text: "Add"}, param47);
  }
  aui.form.linkButton({text: "Cancel"}, param47);
  param47.append('</div></div>');
  aui.form.form({action: '', content: param47.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.addStatusDialogStatus = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div unselectable="on" class="', (opt_data.isSelected) ? 'selected' : '', ' status" data-id="', soy.$$escapeHtml(opt_data.id), '"><img unselectable="on" src="', soy.$$escapeHtml(opt_data.iconURL), '"/><div unselectable="on"><strong unselectable="on">', soy.$$escapeHtml(opt_data.name), '</strong>', (opt_data.description) ? soy.$$escapeHtml(opt_data.description) : '', '</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.cannotDeleteInitialTransition = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content">');
  var param95 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml("Read-Only"), '</h2><div class="form-body"><p>', soy.$$escapeHtml(AJS.format("The initial transition cannot be deleted.",opt_data.transitionName)), '</p></div><div class="buttons-container form-footer"><div class="buttons">');
  aui.form.linkButton({id: 'cancel', text: "Cancel"}, param95);
  param95.append('</div></div>');
  aui.form.form({action: '', content: param95.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.confirmDeleteTransition = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content">');
  var param110 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml("Confirm Delete"), '</h2><div class="form-body"><p>', soy.$$escapeHtml(AJS.format("Are you sure you want to delete the transition \x27\x27{0}\x27\x27?",opt_data.transitionName)), '</p></div><div class="buttons-container form-footer"><div class="buttons">');
  aui.form.submit({extraClasses: 'aui-button aui-button-primary', text: "Delete"}, param110);
  aui.form.linkButton({id: 'cancel', text: "Cancel"}, param110);
  param110.append('</div></div>');
  aui.form.form({action: '', content: param110.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.createGlobalTransitionDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content">');
  var param128 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml("Add Global Transition"), '</h2><div class="form-body">');
  aui.form.textField({id: 'global-transition-name', isRequired: true, labelContent: "Name"}, param128);
  aui.form.textareaField({id: 'global-transition-description', labelContent: "Description"}, param128);
  aui.form.selectField({id: 'global-transition-screen-id', isMultiple: false, options: opt_data.screens, isRequired: false, labelContent: "Transition screen"}, param128);
  param128.append('</div><div class="buttons-container form-footer"><div class="buttons">');
  aui.form.submit({extraClasses: 'aui-button aui-button-primary', text: "Create"}, param128);
  aui.form.linkButton({text: "Cancel"}, param128);
  param128.append('</div></div>');
  aui.form.form({action: '', content: param128.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.statusDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var submitText__soy155 = new soy.StringBuilder((opt_data.statusId) ? soy.$$escapeHtml("Save") : soy.$$escapeHtml("Create"));
  submitText__soy155 = submitText__soy155.toString();
  var title__soy161 = new soy.StringBuilder((opt_data.statusId) ? soy.$$escapeHtml("Edit Status") : soy.$$escapeHtml("Create New Status"));
  title__soy161 = title__soy161.toString();
  output.append('<div class="aui-dialog-content">');
  var param169 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml(title__soy161), '</h2><div class="form-body">');
  aui.form.textField({id: 'status-name', isRequired: true, labelContent: "Name", name: 'name', value: opt_data.name}, param169);
  aui.form.textareaField({id: 'status-description', labelContent: "Description", name: 'description', value: opt_data.description}, param169);
  param169.append('</div><div class="buttons-container form-footer">', (! opt_data.statusId) ? '<div class="checkbox buttons-container-left"><input class="checkbox" id="create-global-transition" type="checkbox"><label for="create-global-transition">' + soy.$$escapeHtml("Add global transition to status") + '</label></div>' : '', '<div class="buttons">');
  aui.form.submit({extraClasses: 'aui-button aui-button-primary', text: submitText__soy155}, param169);
  aui.form.linkButton({id: 'cancel', text: "Cancel"}, param169);
  param169.append('</div></div>');
  aui.form.form({action: '', content: param169.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.globalTransitionDialogContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<strong>', soy.$$escapeHtml(opt_data.name), '</strong><p>', soy.$$escapeHtml(AJS.format("All statuses can transition to \x27\x27{0}\x27\x27.",opt_data.statusName)), '</p>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.transitionDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var submitText__soy207 = new soy.StringBuilder((opt_data.actionId) ? soy.$$escapeHtml("Save") : soy.$$escapeHtml("Add"));
  submitText__soy207 = submitText__soy207.toString();
  var title__soy213 = new soy.StringBuilder((opt_data.actionId) ? (opt_data.globalTransition) ? soy.$$escapeHtml("Edit Global Transition") : soy.$$escapeHtml("Edit Transition") : (opt_data.globalTransition) ? soy.$$escapeHtml("Add Global Transition") : soy.$$escapeHtml("Add Transition"));
  title__soy213 = title__soy213.toString();
  output.append('<div class="aui-dialog-content">');
  var param229 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml(title__soy213), '</h2><div class="form-body">');
  aui.form.textField({id: 'transition-name', isRequired: true, labelContent: "Name", name: 'name', value: opt_data.name}, param229);
  aui.form.textareaField({id: 'transition-description', labelContent: "Description", name: 'description', value: opt_data.description}, param229);
  aui.form.selectField({id: 'transition-screen-id', isMultiple: false, isRequired: false, labelContent: "Transition screen", options: opt_data.screens}, param229);
  param229.append('</div><div class="buttons-container form-footer"><div class="buttons">');
  aui.form.submit({extraClasses: 'aui-button aui-button-primary', text: submitText__soy207}, param229);
  aui.form.linkButton({id: 'cancel', text: "Cancel"}, param229);
  param229.append('</div></div>');
  aui.form.form({action: '', content: param229.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.confirmDeleteStatus = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content">');
  var param263 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml("Confirm Remove Status"), '</h2><div class="form-body"><p>', soy.$$escapeHtml(AJS.format("Are you sure you want to remove the status \x27\x27{0}\x27\x27 and delete the related transitions?",opt_data.name)), '</p></div><div class="buttons-container form-footer"><div class="buttons">');
  aui.form.submit({extraClasses: 'aui-button aui-button-primary', text: "Remove"}, param263);
  aui.form.linkButton({id: 'cancel', text: "Cancel"}, param263);
  param263.append('</div></div>');
  aui.form.form({action: '', content: param263.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.cannotDeleteInitialStatus = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content">');
  var param281 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml("Read-Only"), '</h2><div class="form-body"><p>', soy.$$escapeHtml(AJS.format("The initial status cannot be deleted.",opt_data.name)), '</p></div><div class="buttons-container form-footer"><div class="buttons">');
  aui.form.linkButton({id: 'cancel', text: "Cancel"}, param281);
  param281.append('</div></div>');
  aui.form.form({action: '', content: param281.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.cannotDeleteStatusFromActiveWorkflow = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content">');
  var param296 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml(AJS.format("The status \x27\x27{0}\x27\x27 cannot be removed.",opt_data.name)), '</h2><div class="form-body"><p>', soy.$$escapeHtml("Statuses cannot be removed from draft workflows."), '</p><p><a target="_blank" href="https://confluence.atlassian.com/display/JIRA/Configuring+Workflow#ConfiguringWorkflow-Limitationswheneditinganactiveworkflow">', soy.$$escapeHtml("More information."), '</a></p></div><div class="buttons-container form-footer"><div class="buttons">');
  aui.form.linkButton({id: 'cancel', text: "Cancel"}, param296);
  param296.append('</div></div>');
  aui.form.form({action: '', content: param296.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:transition-dialog-view', location = 'js/views/dialogs/TransitionDialogView.js' */
(function(){Backbone.define("JIRA.WorkflowDesigner.Dialogs.TransitionDialogView",JIRA.WorkflowDesigner.Dialogs.FormDialogView.extend({initialize:function(A){_.bindAll(this,"_onError","_onSubmit","_onSuccess","_onHide");this._transitionModel=A.transitionModel;this._workflowModel=A.workflowModel},_getContent:function(){var A=this,B=this._transitionModel.get("screenId");function C(D){return{text:D.name,value:D.id,selected:D.id===Number(B)}}return function(G){var F=A._transitionModel.toJSON(),E=JIRA.WorkflowDesigner.IO.AJAX.ScreensAJAXManager.getScreens(),D=JIRA.WorkflowDesigner.Templates.transitionDialog;E.done(function(H){_.extend(F,{screens:_.map(H,C)});G(D(F))});E.fail(function(H){JIRA.WorkflowDesigner.Messages.showErrorMessage(H,{closeable:true});A.hide()})}},_getScreenIdElement:function(){return this._screenIdElement||(this._screenIdElement=this.$("#transition-screen-id"))},_getSelectedScreenId:function(){return this._getScreenIdElement().find(":selected").val()},_getSelectedScreenName:function(){return this._getScreenIdElement().find(":selected").text()},_getTransitionDescriptionElement:function(){return this._transitionDescriptionElement||(this._transitionDescriptionElement=this.$("#transition-description"))},_getTransitionDescription:function(){return this._getTransitionDescriptionElement().val()},_getTransitionNameElement:function(){return this._transitionNameElement||(this._transitionNameElement=this.$("#transition-name"))},_getTransitionName:function(){return this._getTransitionNameElement().val()},_onContentRefresh:function(){new AJS.SingleSelect({element:this.$("#transition-screen-id"),revertOnInvalid:true})},_onHide:jQuery.noop,_onSubmit:function(C,D){var A,B;C.preventDefault();this.disable();this.removeErrorMessages();A={transitionId:this._transitionModel.getActionId(),description:this._getTransitionDescription(),name:this._getTransitionName(),screenId:this._getSelectedScreenId(),sourceStepId:this._transitionModel.getSourceStepId(),targetStepId:this._transitionModel.getTargetStepId(),workflowName:this._workflowModel.get("name")};B=this._makeRequest(A);B.done(this._onSuccess).fail(D).fail(this._onError)},_onSuccess:function(A){this._transitionModel.set(_.extend({},A,{name:this._getTransitionName(),description:this._getTransitionDescription(),screenId:this._getSelectedScreenId(),screenName:this._getSelectedScreenName()}));this.hide()}}))}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:transition-dialog-view', location = 'soy/WorkflowDesigner.soy' */
// This file was automatically generated from WorkflowDesigner.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.WorkflowDesigner == 'undefined') { JIRA.WorkflowDesigner = {}; }
if (typeof JIRA.WorkflowDesigner.Templates == 'undefined') { JIRA.WorkflowDesigner.Templates = {}; }


JIRA.WorkflowDesigner.Templates.actions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param3 = new soy.StringBuilder();
  if (! opt_data.immutable) {
    var param6 = new soy.StringBuilder();
    aui.buttons.button({extraClasses: 'add-status', iconClass: 'aui-icon-small aui-iconfont-add', iconText: "Add existing status", iconType: 'aui', text: "Add existing status"}, param6);
    aui.buttons.button({extraClasses: 'create-status', iconClass: 'aui-icon-small aui-iconfont-add', iconText: "Create new status", iconType: 'aui', text: "Create new status"}, param6);
    aui.form.checkboxField({extraClasses: 'show-transition-labels', fields: [{'id': 'show-transition-labels', 'isChecked': opt_data.showTransitionLabels, 'labelText': "Show transition labels"}], legendContent: ''}, param6);
    aui.toolbar2.item({content: param6.toString(), item: 'primary'}, param3);
  }
  if (opt_data.fullScreenButton) {
    var param27 = new soy.StringBuilder();
    aui.buttons.button({extraClasses: 'enter-full-screen full-screen-trigger', iconClass: 'aui-icon-small', iconType: 'aui', text: '', extraAttributes: {'title': "Enter full screen"}}, param27);
    aui.buttons.button({extraClasses: 'exit-full-screen full-screen-trigger hidden', iconClass: 'aui-icon-small', iconType: 'aui', text: '', extraAttributes: {'title': "Exit full screen"}}, param27);
    aui.toolbar2.item({content: param27.toString(), item: 'secondary'}, param3);
  }
  aui.toolbar2.toolbar2({content: param3.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.addStatusDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var hasStatuses__soy44 = opt_data.statuses.length > 0;
  output.append('<div class="aui-dialog-content">');
  var param47 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml("Add Status"), '</h2><div class="form-body">');
  var statusList51 = opt_data.statuses;
  var statusListLen51 = statusList51.length;
  if (statusListLen51 > 0) {
    for (var statusIndex51 = 0; statusIndex51 < statusListLen51; statusIndex51++) {
      var statusData51 = statusList51[statusIndex51];
      JIRA.WorkflowDesigner.Templates.addStatusDialogStatus(soy.$$augmentData(statusData51, {isSelected: statusIndex51 == 0}), param47);
    }
  } else {
    param47.append('<div class="no-statuses-message">', soy.$$escapeHtml("There are no statuses that can be added to this workflow."), '</div>');
  }
  param47.append('</div><div class="buttons-container form-footer">', (hasStatuses__soy44) ? '<div class="checkbox buttons-container-left"><input class="checkbox" id="create-global-transition" type="checkbox"><label for="create-global-transition">' + soy.$$escapeHtml("Add global transition to status") + '</label></div>' : '', '<div class="buttons">');
  if (hasStatuses__soy44) {
    aui.form.submit({extraClasses: 'aui-button aui-button-primary', text: "Add"}, param47);
  }
  aui.form.linkButton({text: "Cancel"}, param47);
  param47.append('</div></div>');
  aui.form.form({action: '', content: param47.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.addStatusDialogStatus = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div unselectable="on" class="', (opt_data.isSelected) ? 'selected' : '', ' status" data-id="', soy.$$escapeHtml(opt_data.id), '"><img unselectable="on" src="', soy.$$escapeHtml(opt_data.iconURL), '"/><div unselectable="on"><strong unselectable="on">', soy.$$escapeHtml(opt_data.name), '</strong>', (opt_data.description) ? soy.$$escapeHtml(opt_data.description) : '', '</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.cannotDeleteInitialTransition = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content">');
  var param95 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml("Read-Only"), '</h2><div class="form-body"><p>', soy.$$escapeHtml(AJS.format("The initial transition cannot be deleted.",opt_data.transitionName)), '</p></div><div class="buttons-container form-footer"><div class="buttons">');
  aui.form.linkButton({id: 'cancel', text: "Cancel"}, param95);
  param95.append('</div></div>');
  aui.form.form({action: '', content: param95.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.confirmDeleteTransition = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content">');
  var param110 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml("Confirm Delete"), '</h2><div class="form-body"><p>', soy.$$escapeHtml(AJS.format("Are you sure you want to delete the transition \x27\x27{0}\x27\x27?",opt_data.transitionName)), '</p></div><div class="buttons-container form-footer"><div class="buttons">');
  aui.form.submit({extraClasses: 'aui-button aui-button-primary', text: "Delete"}, param110);
  aui.form.linkButton({id: 'cancel', text: "Cancel"}, param110);
  param110.append('</div></div>');
  aui.form.form({action: '', content: param110.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.createGlobalTransitionDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content">');
  var param128 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml("Add Global Transition"), '</h2><div class="form-body">');
  aui.form.textField({id: 'global-transition-name', isRequired: true, labelContent: "Name"}, param128);
  aui.form.textareaField({id: 'global-transition-description', labelContent: "Description"}, param128);
  aui.form.selectField({id: 'global-transition-screen-id', isMultiple: false, options: opt_data.screens, isRequired: false, labelContent: "Transition screen"}, param128);
  param128.append('</div><div class="buttons-container form-footer"><div class="buttons">');
  aui.form.submit({extraClasses: 'aui-button aui-button-primary', text: "Create"}, param128);
  aui.form.linkButton({text: "Cancel"}, param128);
  param128.append('</div></div>');
  aui.form.form({action: '', content: param128.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.statusDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var submitText__soy155 = new soy.StringBuilder((opt_data.statusId) ? soy.$$escapeHtml("Save") : soy.$$escapeHtml("Create"));
  submitText__soy155 = submitText__soy155.toString();
  var title__soy161 = new soy.StringBuilder((opt_data.statusId) ? soy.$$escapeHtml("Edit Status") : soy.$$escapeHtml("Create New Status"));
  title__soy161 = title__soy161.toString();
  output.append('<div class="aui-dialog-content">');
  var param169 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml(title__soy161), '</h2><div class="form-body">');
  aui.form.textField({id: 'status-name', isRequired: true, labelContent: "Name", name: 'name', value: opt_data.name}, param169);
  aui.form.textareaField({id: 'status-description', labelContent: "Description", name: 'description', value: opt_data.description}, param169);
  param169.append('</div><div class="buttons-container form-footer">', (! opt_data.statusId) ? '<div class="checkbox buttons-container-left"><input class="checkbox" id="create-global-transition" type="checkbox"><label for="create-global-transition">' + soy.$$escapeHtml("Add global transition to status") + '</label></div>' : '', '<div class="buttons">');
  aui.form.submit({extraClasses: 'aui-button aui-button-primary', text: submitText__soy155}, param169);
  aui.form.linkButton({id: 'cancel', text: "Cancel"}, param169);
  param169.append('</div></div>');
  aui.form.form({action: '', content: param169.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.globalTransitionDialogContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<strong>', soy.$$escapeHtml(opt_data.name), '</strong><p>', soy.$$escapeHtml(AJS.format("All statuses can transition to \x27\x27{0}\x27\x27.",opt_data.statusName)), '</p>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.transitionDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var submitText__soy207 = new soy.StringBuilder((opt_data.actionId) ? soy.$$escapeHtml("Save") : soy.$$escapeHtml("Add"));
  submitText__soy207 = submitText__soy207.toString();
  var title__soy213 = new soy.StringBuilder((opt_data.actionId) ? (opt_data.globalTransition) ? soy.$$escapeHtml("Edit Global Transition") : soy.$$escapeHtml("Edit Transition") : (opt_data.globalTransition) ? soy.$$escapeHtml("Add Global Transition") : soy.$$escapeHtml("Add Transition"));
  title__soy213 = title__soy213.toString();
  output.append('<div class="aui-dialog-content">');
  var param229 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml(title__soy213), '</h2><div class="form-body">');
  aui.form.textField({id: 'transition-name', isRequired: true, labelContent: "Name", name: 'name', value: opt_data.name}, param229);
  aui.form.textareaField({id: 'transition-description', labelContent: "Description", name: 'description', value: opt_data.description}, param229);
  aui.form.selectField({id: 'transition-screen-id', isMultiple: false, isRequired: false, labelContent: "Transition screen", options: opt_data.screens}, param229);
  param229.append('</div><div class="buttons-container form-footer"><div class="buttons">');
  aui.form.submit({extraClasses: 'aui-button aui-button-primary', text: submitText__soy207}, param229);
  aui.form.linkButton({id: 'cancel', text: "Cancel"}, param229);
  param229.append('</div></div>');
  aui.form.form({action: '', content: param229.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.confirmDeleteStatus = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content">');
  var param263 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml("Confirm Remove Status"), '</h2><div class="form-body"><p>', soy.$$escapeHtml(AJS.format("Are you sure you want to remove the status \x27\x27{0}\x27\x27 and delete the related transitions?",opt_data.name)), '</p></div><div class="buttons-container form-footer"><div class="buttons">');
  aui.form.submit({extraClasses: 'aui-button aui-button-primary', text: "Remove"}, param263);
  aui.form.linkButton({id: 'cancel', text: "Cancel"}, param263);
  param263.append('</div></div>');
  aui.form.form({action: '', content: param263.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.cannotDeleteInitialStatus = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content">');
  var param281 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml("Read-Only"), '</h2><div class="form-body"><p>', soy.$$escapeHtml(AJS.format("The initial status cannot be deleted.",opt_data.name)), '</p></div><div class="buttons-container form-footer"><div class="buttons">');
  aui.form.linkButton({id: 'cancel', text: "Cancel"}, param281);
  param281.append('</div></div>');
  aui.form.form({action: '', content: param281.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.cannotDeleteStatusFromActiveWorkflow = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content">');
  var param296 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml(AJS.format("The status \x27\x27{0}\x27\x27 cannot be removed.",opt_data.name)), '</h2><div class="form-body"><p>', soy.$$escapeHtml("Statuses cannot be removed from draft workflows."), '</p><p><a target="_blank" href="https://confluence.atlassian.com/display/JIRA/Configuring+Workflow#ConfiguringWorkflow-Limitationswheneditinganactiveworkflow">', soy.$$escapeHtml("More information."), '</a></p></div><div class="buttons-container form-footer"><div class="buttons">');
  aui.form.linkButton({id: 'cancel', text: "Cancel"}, param296);
  param296.append('</div></div>');
  aui.form.form({action: '', content: param296.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-mixins', location = 'js/views/mixins/LineResizeHandleMixin.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.LineResizeHandleMixin");JIRA.WorkflowDesigner.LineResizeHandleMixin={init:function(){this._actionableArea=new draw2d.shape.basic.Circle(20);this._actionableArea.draggable=true;this.setActionableAreaAttributes({})},setPosition:function(){this._actionableArea.setPosition(this.x-this._actionableArea.width/2+this.width/2,this.y-this._actionableArea.height/2+this.height/2)},show:function(A){this._actionableArea.setCanvas(A);this._actionableArea.sendToFront()},hide:function(){this._actionableArea.setCanvas(null)},repaint:function(A){A=_.extend({},A,{cursor:"crosshair",fill:"#333333",stroke:"#333333"});var B=this.getGap();this.x-=B.x;this.y-=B.y;if(this._actionableArea&&this._actionableAreaAttributes){this._actionableArea.repaint(this._actionableAreaAttributes);this._actionableArea.sendToFront()}return draw2d.shape.basic.LineResizeHandle.prototype.repaint.call(this,A)},setActionableAreaAttributes:function(A){this._actionableAreaAttributes=_.defaults({},A,{cursor:"crosshair","fill-opacity":0,"stroke-opacity":0})},hitTest:function(A,B){return this._actionableArea.hitTest(A,B)},sendActionableAreaToFront:function(){this._actionableArea.sendToFront()},onDragStart:function(){var A=this.getRelatedPort();A.triggerDragStart();_.chain(A.getDropTargets().asArray()).without(this.getOppositePortTo(A)).invoke("show")},onDragEnd:function(){var A=this.getRelatedPort();A.triggerDragEnd();A.getDropTargets().each(function(C,B){B.hide()})}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-mixins', location = 'js/views/mixins/SelectableFigureMixin.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.SelectableFigureMixin");JIRA.WorkflowDesigner.SelectableFigureMixin={initialize:function(){_.bindAll(this,"_onSelectionChange");this.canvas.addSelectionListener(this._onSelectionChange)},deselect:function(){if(this.isSelected()){this.canvas.selectFigure(null)}else{this._deselect()}},isSelected:function(){return this.canvas.getSelectedFigure()===this._getFigure()},_onSelectionChange:function(C,E){var A=this._getFigure(),B=E===A&&C!==A,D=E!==A&&C===A;if(B){this._deselect()}else{if(D){this._select()}}},remove:function(){this.canvas.removeSelectionListener(this._onSelectionChange)},select:function(){if(this.isSelected()){this._select()}else{this.canvas.selectFigure(this._getFigure())}}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/lib/cocktail-0.3.0.js' */
(function(){var A;if(typeof exports!=="undefined"){A=exports}else{A=this.Cocktail={}}A.mixins={};A.mixin=function C(F){var G=_.chain(arguments).toArray().rest().flatten().value();var H={};_(G).each(function(I){if(_.isString(I)){I=A.mixins[I]}_(I).each(function(K,J){if(_.isFunction(K)){if(F.prototype[J]){H[J]=H[J]||[F.prototype[J]];H[J].push(K)}F.prototype[J]=K}else{if(_.isObject(K)){F.prototype[J]=_.extend({},K,F.prototype[J]||{})}}})});_(H).each(function(I,J){F.prototype[J]=function(){var M=this,K=arguments,L=undefined;_(I).each(function(N){var O=_.isFunction(N)?N.apply(M,K):N;L=(O===undefined?L:O)});return L}})};var D;A.patch=function E(G){D=G.Model.extend;var F=function(J,K){var H=D.call(this,J,K);var I=H.prototype.mixins;if(I&&H.prototype.hasOwnProperty("mixins")){A.mixin(H,I)}return H};_([G.Model,G.Collection,G.Router,G.View]).each(function(H){H.mixin=function I(){A.mixin(this,_.toArray(arguments))};H.extend=F})};A.unpatch=function B(F){_([F.Model,F.Collection,F.Router,F.View]).each(function(G){G.mixin=undefined;G.extend=D})}})();
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/util/BackboneDefine.js' */
Backbone.define=function(name,ctor){eval("Backbone['Class: "+name+"'] = function() { Backbone['Class: "+name+"'].__ctor.apply(this, arguments); }");var cls=Backbone["Class: "+name];cls.__ctor=ctor;ctor.prototype.name=name;cls.prototype=ctor.prototype;_.extend(cls,ctor);_.each(ctor.prototype,function(fn,fnName){if(typeof fn==="function"){fn.displayName=name+"."+fnName}});var context=window;var parts=name.split(".");_.each(parts,function(part,i){if(i===parts.length-1){context[part]=cls}else{context=context[part]==null?(context[part]={}):context[part]}});return cls};
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/Application.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Application");JIRA.WorkflowDesigner.Application=function(B){var A;_.bindAll(this,"_enterFullScreen","_exitFullScreen");B.element=jQuery(B.element);B=_.defaults(B,{actions:true,draft:false,fullScreenButton:true,immutable:false});this.element=B.element;this.element.addClass("workflow-designer");this.workflowModel=new JIRA.WorkflowDesigner.WorkflowModel({currentStepId:B.currentStepId,name:B.workflowId,draft:B.draft});this.canvasView=new JIRA.WorkflowDesigner.CanvasView({container:B.element,immutable:B.immutable,model:this.workflowModel});if(B.actions){A=new JIRA.WorkflowDesigner.ActionsView({container:B.element,immutable:B.immutable,fullScreenButton:B.fullScreenButton,model:this.workflowModel}).render();A.on("fullScreen:enter",this._enterFullScreen);A.on("fullScreen:exit",this._exitFullScreen)}if(!B.immutable){new JIRA.WorkflowDesigner.IO.LayoutAutoSaver({workflowModel:this.workflowModel})}this._browserZoomChecker=new JIRA.WorkflowDesigner.BrowserZoomChecker();this._loadWorkflow(B)};_.extend(JIRA.WorkflowDesigner.Application.prototype,{destroy:function(){this._browserZoomChecker.destroy();this.canvasView.remove();this.element.empty()},_enterFullScreen:function(){var A=this.canvasView;A.setResizeInterval(25);JIRA.WorkflowDesigner.FullScreenController.enterFullScreen(this.element).done(function(){A.setResizeInterval(JIRA.WorkflowDesigner.Canvas.DEFAULT_RESIZE_INTERVAL)})},_exitFullScreen:function(){var B=this.canvasView,A=this;B.setResizeInterval(25);JIRA.WorkflowDesigner.FullScreenController.exitFullScreen(this.element).done(function(){B.setResizeInterval(JIRA.WorkflowDesigner.Canvas.DEFAULT_RESIZE_INTERVAL);A.element.css("width","auto")})},_loadWorkflow:function(C){var B,A=this;if(C.layoutData){B=jQuery.Deferred().resolve(C.layoutData)}else{if(C.workflowId){B=JIRA.WorkflowDesigner.IO.AJAX.WorkflowAJAXManager.load(C.workflowId,!!C.draft)}}if(B){this.canvasView.showProgressIndicator();B.always(this.canvasView.hideProgressIndicator);B.done(function(D){A.workflowModel.reset(D);if(!C.immutable){new JIRA.WorkflowDesigner.PropertiesPanel.PropertiesPanelView({container:C.element,model:A.workflowModel}).render()}A.canvasView.autoFit()});B.fail(function(D){JIRA.WorkflowDesigner.Messages.showErrorMessage(D,{closeable:true})})}}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/Constants.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Constants");JIRA.WorkflowDesigner.Constants={HIGHLIGHT_DELAY:150}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/collections/StatusCollection.js' */
(function(){Backbone.define("JIRA.WorkflowDesigner.StatusCollection",Backbone.Collection.extend({model:function(A,B){return new JIRA.WorkflowDesigner.StatusModel(A,B)}}))}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/collections/TransitionCollection.js' */
(function(){Backbone.define("JIRA.WorkflowDesigner.TransitionCollection",Backbone.Collection.extend({model:function(A,B){return new JIRA.WorkflowDesigner.TransitionModel(A,B)},getInitial:function(){return this.find(function(A){return A.isInitial()})}}))}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/io/ajax/AJAXManager.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.IO.AJAX.AJAXManager");JIRA.WorkflowDesigner.IO.AJAX.AJAXManager={_makeRequest:function(A){A.headers=_.extend({},A.headers,{"X-Atlassian-Token":"nocheck"});return jQuery.ajax(A)}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/io/ajax/ScreensAJAXManager.js' */
(function(){var A;AJS.namespace("JIRA.WorkflowDesigner.IO.AJAX.ScreensAJAXManager");JIRA.WorkflowDesigner.IO.AJAX.ScreensAJAXManager=_.extend({},JIRA.WorkflowDesigner.IO.AJAX.AJAXManager,{getScreens:function(){var B=jQuery.Deferred(),C;if(A){B.resolve(A)}else{C=this._makeRequest({dataType:"json",url:AJS.contextPath()+"/rest/workflowDesigner/latest/screens"});C.done(function(D){A=D;B.resolve(A)});C.fail(function(E,D){B.reject(JIRA.WorkflowDesigner.IO.ErrorHandler.getErrorMessage(E,D))})}return B.promise()},reset:function(){A=undefined}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/io/ajax/StatusesAJAXManager.js' */
(function(){var A;AJS.namespace("JIRA.WorkflowDesigner.IO.AJAX.StatusesAJAXManager");JIRA.WorkflowDesigner.IO.AJAX.StatusesAJAXManager=_.extend({},JIRA.WorkflowDesigner.IO.AJAX.AJAXManager,{getStatuses:function(){var B=jQuery.Deferred(),C;if(A){B.resolve(A)}else{C=this._makeRequest({dataType:"json",url:AJS.contextPath()+"/rest/workflowDesigner/latest/statuses"});C.done(function(D){A=D;B.resolve(A)});C.fail(function(E,D){B.reject(JIRA.WorkflowDesigner.IO.ErrorHandler.getErrorMessage(E,D))})}return B.promise()},reset:function(){A=undefined}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/io/ajax/WorkflowAJAXManager.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.IO.AJAX.WorkflowAJAXManager");JIRA.WorkflowDesigner.IO.AJAX.WorkflowAJAXManager=_.extend({},JIRA.WorkflowDesigner.IO.AJAX.AJAXManager,{load:function(C,A){var B=jQuery.Deferred(),D;D=this._makeRequest({data:{name:C,draft:!!A},dataType:"json",url:AJS.contextPath()+"/rest/workflowDesigner/latest/workflows"});D.fail(function(F,E){B.reject(JIRA.WorkflowDesigner.IO.ErrorHandler.getErrorMessage(F,E))});D.success(function(E){var G,F=E.layout;G=JIRA.WorkflowDesigner.IO.WorkflowDataReader.read(F);G=_.extend(G,{description:E.description});B.resolve(G,E)});return B.promise()},save:function(C){var B=jQuery.Deferred(),A=this,D=JIRA.WorkflowDesigner.IO.WorkflowDataWriter.write(C);this.saveRequest&&this.saveRequest.abort();this.saveRequest=this._makeRequest({contentType:"application/json",data:JSON.stringify(D),success:B.resolve,type:"POST",url:AJS.contextPath()+"/rest/workflowDesigner/latest/workflows"});this.saveRequest.fail(function(F,E){B.reject(JIRA.WorkflowDesigner.IO.ErrorHandler.getErrorMessage(F,E))});this.saveRequest.always(function(){delete A.saveRequest});return B.promise()}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/io/ajax/WorkflowGlobalTransitionsAJAXManager.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.IO.AJAX.WorkflowGlobalTransitionsAJAXManager");JIRA.WorkflowDesigner.IO.AJAX.WorkflowGlobalTransitionsAJAXManager=_.extend({},JIRA.WorkflowDesigner.IO.AJAX.AJAXManager,{createGlobalTransition:function(B){var A=jQuery.Deferred(),C;C=this._makeRequest({data:_.pick(B,"statusId","workflowName","name","description","screenId"),dataType:"json",type:"post",url:AJS.contextPath()+"/rest/workflowDesigner/latest/workflows/globalTransitions"});C.done(function(D){A.resolve(JIRA.WorkflowDesigner.IO.WorkflowDataReader.read(D))});C.fail(function(E,D){A.reject(JIRA.WorkflowDesigner.IO.ErrorHandler.getErrorMessage(E,D))});return A.promise()},deleteGlobalTransition:function(B){var A=jQuery.Deferred(),C;C=this._makeRequest({data:_.pick(B,"transitionId","workflowName"),dataType:"json",type:"delete",url:AJS.contextPath()+"/rest/workflowDesigner/latest/workflows/globalTransitions"});C.done(function(D){A.resolve(D)});C.fail(function(E,D){A.reject(JIRA.WorkflowDesigner.IO.ErrorHandler.getErrorMessage(E,D))});return A.promise()},updateGlobalTransition:function(B){var A=jQuery.Deferred(),C;C=this._makeRequest({data:_.pick(B,"transitionId","name","description","screenId","workflowName"),dataType:"json",type:"put",url:AJS.contextPath()+"/rest/workflowDesigner/latest/workflows/globalTransitions"});C.done(A.resolve);C.fail(function(E,D){A.reject(JIRA.WorkflowDesigner.IO.ErrorHandler.getErrorMessage(E,D))});return A.promise()}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/io/ajax/WorkflowStatusesAJAXManager.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.IO.AJAX.WorkflowStatusesAJAXManager");JIRA.WorkflowDesigner.IO.AJAX.WorkflowStatusesAJAXManager=_.extend({},JIRA.WorkflowDesigner.IO.AJAX.AJAXManager,{addStatus:function(B){var A=jQuery.Deferred(),C;C=this._makeRequest({data:_.pick(B,"createGlobalTransition","statusId","workflowName"),dataType:"json",type:"post",url:AJS.contextPath()+"/rest/workflowDesigner/latest/workflows/statuses"});C.done(function(D){A.resolve(JIRA.WorkflowDesigner.IO.WorkflowDataReader.read(D))});C.fail(function(E,D){A.reject(JIRA.WorkflowDesigner.IO.ErrorHandler.getErrorMessage(E,D))});return A.promise()},createStatus:function(B){var A=jQuery.Deferred(),C;C=this._makeRequest({data:_.pick(B,"createGlobalTransition","description","name","workflowName"),dataType:"json",type:"post",url:AJS.contextPath()+"/rest/workflowDesigner/latest/workflows/statuses/create"});C.done(function(D){A.resolve(JIRA.WorkflowDesigner.IO.WorkflowDataReader.read(D));JIRA.WorkflowDesigner.IO.AJAX.StatusesAJAXManager.reset()});C.fail(function(E,D){A.reject(JIRA.WorkflowDesigner.IO.ErrorHandler.getErrorMessage(E,D))});return A.promise()},removeStatus:function(B){var A=jQuery.Deferred(),C;C=this._makeRequest({data:_.pick(B,"statusId","workflowName"),dataType:"json",type:"delete",url:AJS.contextPath()+"/rest/workflowDesigner/latest/workflows/statuses"});C.done(function(D){A.resolve(JIRA.WorkflowDesigner.IO.WorkflowDataReader.read(D))});C.fail(function(E,D){A.reject(JIRA.WorkflowDesigner.IO.ErrorHandler.getErrorMessage(E,D))});return A.promise()},updateStatus:function(B){var A=jQuery.Deferred(),C;C=this._makeRequest({data:_.pick(B,"statusId","description","name","workflowName"),dataType:"json",type:"put",url:AJS.contextPath()+"/rest/workflowDesigner/latest/workflows/statuses"});C.done(A.resolve);C.fail(function(E,D){A.reject(JIRA.WorkflowDesigner.IO.ErrorHandler.getErrorMessage(E,D))});return A.promise()}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/io/ajax/WorkflowTransitionsAJAXManager.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.IO.AJAX.WorkflowTransitionsAJAXManager");JIRA.WorkflowDesigner.IO.AJAX.WorkflowTransitionsAJAXManager=_.extend({},JIRA.WorkflowDesigner.IO.AJAX.AJAXManager,{addTransition:function(B){return A.call(this,{data:B,type:"post"})},deleteTransition:function(B){return A.call(this,{data:B,type:"delete"})},updateTransition:function(B){return A.call(this,{data:B,type:"put"})}});function A(C){var B=jQuery.Deferred(),D;D=this._makeRequest(_.defaults({},C,{dataType:"json",url:AJS.contextPath()+"/rest/workflowDesigner/latest/workflows/transitions"}));D.done(function(E){B.resolve(E)});D.fail(function(F,E){B.reject(JIRA.WorkflowDesigner.IO.ErrorHandler.getErrorMessage(F,E))});return B.promise()}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/io/ErrorHandler.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.IO.ErrorHandler");JIRA.WorkflowDesigner.IO.ErrorHandler={getErrorMessage:function(B,A){if(A==="timeout"){return this._messageProvider.timeout()}if(this._isWebSudoError(B)){return this._messageProvider.websudo()}if(this._isNotAuthenticatedError(B)){return this._messageProvider.notAuthenticated()}if(_.contains([400,403,404],B.status)){return B.responseText}if(A!=="abort"){return this._messageProvider.generic()}return null},_isWebSudoError:function(A){return A.status===401&&A.responseText.match(/websudo/i)},_isNotAuthenticatedError:function(A){return A.status===401},handle:function(B,A){var C=this.getErrorMessage(B,A);if(C){JIRA.WorkflowDesigner.Messages.showErrorMessage(C,{closeable:true})}},_messageProvider:{timeout:function(){return "The call to the JIRA server did not complete within the timeout period.  We are unsure of the result of this operation."},websudo:function(){return "Your temporary administrative access has timed out. Please refresh the page and try again."},notAuthenticated:function(){return "You are not authorized to perform this operation.  Please log in."},generic:function(){return "The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation."}}};_.bindAll(JIRA.WorkflowDesigner.IO.ErrorHandler)}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/io/LayoutAutoSaver.js' */
(function(){var B;AJS.namespace("JIRA.WorkflowDesigner.IO.LayoutAutoSaver");JIRA.WorkflowDesigner.IO.LayoutAutoSaver=function(C){_.bindAll(this);this._save=_.debounce(this._save,1000);this.window=C.window||window;this.workflowModel=C.workflowModel;this.workflowModel.on("layoutChanged",this._onLayoutChanged)};JIRA.WorkflowDesigner.IO.LayoutAutoSaver.prototype={_installUnsavedChangesMessage:function(){var C=!B&&this.window.onbeforeunload!==A;if(C){this.originalOnBeforeUnload=this.window.onbeforeunload;this.window.onbeforeunload=A}},_onLayoutChanged:function(){this._installUnsavedChangesMessage();this.layoutId=_.uniqueId();this._save()},_removeUnsavedChangesMessage:function(C){return _.bind(function(){if(this.layoutId===C){this.window.onbeforeunload=this.originalOnBeforeUnload;delete this.originalOnBeforeUnload}},this)},_save:function(){var C;C=JIRA.WorkflowDesigner.IO.AJAX.WorkflowAJAXManager.save(this.workflowModel);C.done(this._removeUnsavedChangesMessage(this.layoutId));C.fail(function(D){JIRA.WorkflowDesigner.Messages.showErrorMessage(D,{closeable:true})})}};function A(){return "Some changes made to this workflow haven\'t been saved. If you navigate away they will be lost."}JIRA.WorkflowDesigner.IO.LayoutAutoSaver.disableMessage=function(){B=true}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/io/WorkflowDataReader.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.IO.WorkflowDataReader");JIRA.WorkflowDesigner.IO.WorkflowDataReader={read:function(D){var B={},C=[];if(!D||!D.statuses||!D.transitions){return }_.each(D.statuses,function(F){var E=new JIRA.WorkflowDesigner.StatusModel(F);B[E.id]=E});_.each(D.transitions,function(E){C.push(A(E,B))});return{statuses:_.values(B),transitions:C}}};function A(B,C){B=_.chain(B).omit("sourceId","targetId").extend({source:C[B.sourceId],target:C[B.targetId]}).value();return new JIRA.WorkflowDesigner.TransitionModel(B)}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/io/WorkflowDataWriter.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.IO.WorkflowDataWriter");JIRA.WorkflowDesigner.IO.WorkflowDataWriter={write:function(B){var C={layout:{statuses:B.get("statuses").invoke("toJSON"),transitions:B.get("transitions").map(A)}};return _.chain(B.toJSON()).extend(C).omit("currentStepId","description","selectedModel","selectedView","showTransitionLabels","statuses","transitions").value()}};function A(B){var F,E=B.get("globalTransition"),C=B.get("source"),D=B.get("target");F={sourceId:E?D.id:C.id,targetId:D.id};return _.chain(B.toJSON()).extend(F).omit("id","source","target").value()}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/layout/connection/GappedConnection.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Layout.Connection.GappedConnection");JIRA.WorkflowDesigner.Layout.Connection.GappedConnection=draw2d.Connection.extend({init:function(A,B){this._super();this._sourceGap=A;this._targetGap=B},_getTransformation:function(C,D){var B=0,A=0;switch(C){case JIRA.WorkflowDesigner.Direction.UP:A=-D;break;case JIRA.WorkflowDesigner.Direction.RIGHT:B=D;break;case JIRA.WorkflowDesigner.Direction.DOWN:A=D;break;case JIRA.WorkflowDesigner.Direction.LEFT:B=-D;break}return{x:B,y:A}},getEndPointGapTransformation:function(){return this._getTransformation(this.getTarget().getConnectionDirection(),this._targetGap)},getStartPointGapTransformation:function(){return this._getTransformation(this.getSource().getConnectionDirection(),this._sourceGap)},setEndPoint:function(A,C){var B;if(this.isMoving){this._super(A,C)}else{B=this.getEndPointGapTransformation();this._super(A+B.x,C+B.y)}},setStartPoint:function(A,C){var B;if(this.isMoving){this._super(A,C)}else{B=this.getStartPointGapTransformation();this._super(A+B.x,C+B.y)}},getEndPoint:function(){var B,A=this._super();if(this.isMoving){return A}B=this.getEndPointGapTransformation();return A.clone().translate(B.x,B.y)},getStartPoint:function(){var B=this.getStartPointGapTransformation(),A=this._super();if(this.isMoving){return A}return A.clone().translate(B.x,B.y)}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/layout/connection/RoundedManhattanConnectionRouter.js' */
(function(){var A;AJS.namespace("JIRA.WorkflowDesigner.Layout.Connection.RoundedManhattanConnectionRouter");JIRA.WorkflowDesigner.Layout.Connection.RoundedManhattanConnectionRouter=draw2d.layout.connection.ManhattanConnectionRouter.extend({CORNER_RADIUS:5,init:function(){this._super.apply(this,arguments);A=JIRA.WorkflowDesigner.Vector2D},_calculateConnectionPoints:function(B){this._route(B,B.getEndPoint(),B.getTarget().getConnectionDirection(),B.getStartPoint(),B.getSource().getConnectionDirection());return B.getPoints().asArray()},_getPointInstructions:function(C,D,F){var E=new A(C,F[D+1]||C),G=new A(C,F[D-1]||C),B;B=Math.min(E.getLength()/2,G.getLength()/2,this.CORNER_RADIUS);return["L",C.add(G.normalize().multiply(B)).getComponents(),"S",C.getComponents(),C.add(E.normalize().multiply(B)).getComponents()]},route:function(D){var C=this,E;function B(G,F,H,I){return G.concat(C._getPointInstructions(F,H,I))}E=this._calculateConnectionPoints(D);D.svgPathString=_.reduce(E,B,["M",E[0].x,E[0].y]).join(" ")}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/layout/locator/PositionOnParentBoundsLocator.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Layout.Locator.PositionOnParentBoundsLocator");JIRA.WorkflowDesigner.Layout.Locator.PositionOnParentBoundsLocator=draw2d.layout.locator.Locator.extend({init:function(A){this._super(A.parent);this.side=A.side;this.bias=A.bias},relocate:function(B,D){var F=this.getParent().getBoundingBox(),C=JIRA.WorkflowDesigner.Direction,A,E;if(this.side===C.UP||this.side===C.DOWN){A=F.getWidth()*this.bias;E=(this.side===C.UP)?0:F.getHeight()}else{if(this.side===C.LEFT||this.side===C.RIGHT){E=F.getHeight()*this.bias;A=(this.side===C.LEFT)?0:F.getWidth()}}D.setPosition(A,E)}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/layout/locator/StaticLocator.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Layout.Locator.StaticLocator");JIRA.WorkflowDesigner.Layout.Locator.StaticLocator=draw2d.layout.locator.Locator.extend({init:function(B,A,C){this._super(B);this._x=A;this._y=C},relocate:function(A,B){B.setPosition(this._x,this._y)}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/models/StatusModel.js' */
(function(){Backbone.define("JIRA.WorkflowDesigner.StatusModel",Backbone.Model.extend({defaults:{description:"",id:undefined,initial:false,name:"",stepId:undefined,statusId:undefined,x:undefined,y:undefined},hasCoordinates:function(){var A=this.get("x"),B=this.get("y");return _.isNumber(A)&&_.isNumber(B)},isInitial:function(){return this.get("initial")},hasTransition:function(A){return(A.get("source")===this||A.get("target")===this)}}))}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/models/TransitionModel.js' */
(function(){Backbone.define("JIRA.WorkflowDesigner.TransitionModel",Backbone.Model.extend({defaults:{id:null,actionId:null,conditionsCount:null,description:null,globalTransition:false,name:null,postFunctionsCount:null,propertiesCount:null,screenId:null,screenName:null,source:null,sourceAngle:null,target:null,targetAngle:null,validatorsCount:null},initialize:function(){this._createId();this.on("change:actionId change:source change:target",_.bind(this._createId,this))},_createId:function(){var D=this.getActionId(),B,A=this.get("source"),C=this.get("target");if(D&&A&&C){B=A.isInitial()?"IA":"A";this.set("id",B+"<"+D+":"+A.get("id")+":"+C.get("id")+">")}},isGlobalTransition:function(){return this.get("globalTransition")},isInitial:function(){return this.get("source").isInitial()},getActionId:function(){return this.get("actionId")},getSourceStepId:function(){return this.get("source").get("stepId")},getTargetStepId:function(){return this.get("target").get("stepId")},sync:jQuery.noop}))}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/models/WorkflowModel.js' */
(function(){var D="JIRA.WorkflowDesigner.showTransitionLabels";var A;function B(){return A.getItem(D)==="true"}function C(E){return A.setItem(D,""+E)}Backbone.define("JIRA.WorkflowDesigner.WorkflowModel",Backbone.Model.extend({defaults:function(){return{currentStepId:undefined,description:undefined,draft:false,name:undefined,selectedModel:undefined,selectedView:undefined,showTransitionLabels:false,statuses:new JIRA.WorkflowDesigner.StatusCollection(),transitions:new JIRA.WorkflowDesigner.TransitionCollection()}},initialize:function(F,G){var H=this.get("statuses"),I=this.get("transitions"),E=_.bind(this.trigger,this,"layoutChanged");A=(G&&G.localStorage)||window.localStorage;this.set("showTransitionLabels",B());H.on("change:x change:y",E);I.on("change:actionId change:sourceAngle change:targetAngle remove",E);I.on("destroy",this._onDestroy,this)},addStatus:function(E){var F=E instanceof JIRA.WorkflowDesigner.StatusModel;F||(E=new JIRA.WorkflowDesigner.StatusModel(E));this.get("statuses").add(E);return E},addTransition:function(F){var E=F instanceof JIRA.WorkflowDesigner.TransitionModel;E||(F=new JIRA.WorkflowDesigner.TransitionModel(F));this.get("transitions").add(F);return F},_getNewModel:function(E,G){var F=G.length===0;E=_.filter(E,function(H){return !G.get(H.id)});if(E.length===1&&!F){return E[0]}},_onDestroy:function(F){var E=this.get("selectedModel")===F;if(E){this.set({selectedModel:null,selectedView:null})}},removeTransition:function(E){this.get("transitions").remove(E)},reset:function(F){var E,G=this.get("statuses"),H=this.get("transitions");E=this._getNewModel(F.statuses,G)||this._getNewModel(F.transitions,H);G.reset(F.statuses);H.reset(F.transitions);this.set(_.omit(F,"statuses","transitions"));this.trigger("reset:after");this.unset("selectedView");this.set("selectedModel",E)},selectView:function(E){this.set({selectedModel:E&&E.model,selectedView:E})},setShowTransitionLabels:function(E){this.set("showTransitionLabels",E);C(this.get("showTransitionLabels"));JIRA.WorkflowDesigner.Analytics.triggerToggleLabels(E)},statusHasGlobalTransition:function(E){return this.get("transitions").some(function(F){return F.get("globalTransition")&&F.get("target")===E})}}))}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/policy/canvas/PanningSingleSelectionPolicy.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Policy.Canvas.PanningSingleSelectionPolicy");JIRA.WorkflowDesigner.Policy.Canvas.PanningSingleSelectionPolicy=draw2d.policy.canvas.SingleSelectionPolicy.extend({init:function(A){this._super();this._getCanvasBoundingBox=A},onMouseDown:function(B,A,C){AJS.InlineDialog.current&&AJS.InlineDialog.current.hide();this._super(B,A,C);this._initialViewBox=B.getViewBox();this._boundingBox=this._getCanvasBoundingBox()},onMouseDrag:function(D,C,B,E,A){this._super(D,C,B,E,A);if(this.mouseDownElement===null&&this.mouseDraggingElement===null){D.setViewBoxQuick(JIRA.WorkflowDesigner.ViewBoxTransformer.getPanViewBox({diagramBoundingBox:this._boundingBox,displacement:new JIRA.WorkflowDesigner.Vector2D(-C,-B),viewBox:this._initialViewBox}))}}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/policy/canvas/snap-to-geometry/GuideLineEditPolicy.js' */
(function(){var A;AJS.namespace("JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.GuideLineEditPolicy");JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.GuideLineEditPolicy=draw2d.policy.canvas.CanvasPolicy.extend({GUIDE_LINE_COLOUR:"#ff0000",init:function(){_.bindAll(this);this._super.apply(this,arguments);A=JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.SnapPoints},_collectFigures:function(){var B=this;if(this.figures){return }this.figures=[];this.canvas.getFigures().each(function(D,C){if(C.snapToGeometry){if(C.isInDragDrop){B.dragFigure=C}else{B.figures.push(C)}}})},_collectSnapPoints:function(){if(this.SnapPoints){return }this.SnapPoints={x:A.getXSnapPoints(this.figures),y:A.getYSnapPoints(this.figures)}},_drawGuideLine:function(C,E,B,D){var F=["M",C,E,"L",B,D].join(" ");this.guideLines||(this.guideLines=[]);this.guideLines.push(this.canvas.paper.path(F).attr({stroke:this.GUIDE_LINE_COLOUR}))},_drawGuideLines:function(B,C,D){var E=_.cartesianProduct(C,D);_.each(E,function(F){if(this._equalSnapPoints(F[0],F[1])){B.apply(this,F)}},this)},_drawHorizontalGuideLines:function(){var C;function B(E,G){var F=Math.max(E.rectangle.getRight(),G.rectangle.getRight()),D=Math.min(E.rectangle.getLeft(),G.rectangle.getLeft());this._drawGuideLine(D,E.value,F,E.value)}C=A.getYSnapPoints(this.dragFigure);this._drawGuideLines(B,C,this.SnapPoints.y)},_drawVerticalGuideLines:function(){var C;function B(E,G){var F=Math.max(E.rectangle.getBottom(),G.rectangle.getBottom()),D=Math.min(E.rectangle.getTop(),G.rectangle.getTop());this._drawGuideLine(E.value,D,E.value,F)}C=A.getXSnapPoints(this.dragFigure);this._drawGuideLines(B,C,this.SnapPoints.x)},_equalSnapPoints:function(C,B){return Math.abs(C.value-B.value)<=0.1},onInstall:function(B){this.canvas=B},onMouseDrag:function(){this._collectFigures();this._removeGuideLines();if(!this.dragFigure||this.figures.length===0){return }this._collectSnapPoints();this._drawHorizontalGuideLines();this._drawVerticalGuideLines()},onMouseUp:function(){delete this.dragFigure;delete this.figures;delete this.SnapPoints;this._removeGuideLines()},onUninstall:function(){delete this.canvas},_removeGuideLines:function(){_.invoke(this.guideLines,"remove");this.guideLines=[]}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/policy/canvas/snap-to-geometry/SnapEditPolicy.js' */
(function(){var B,A;AJS.namespace("JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.SnapEditPolicy");JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.SnapEditPolicy=draw2d.policy.canvas.SnapToEditPolicy.extend({SNAP_THRESHOLD:3,init:function(){this._super.apply(this,arguments);B=JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.Snapper;A=JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.SnapPoints},_createSnappers:function(C){var D;if(this.snappers){return }D=this._getFigures(C);this.snappers={x:new B(this._getXSnapPoints(D)),y:new B(this._getYSnapPoints(D))}},_getFigures:function(C){return _.filter(C.getFigures().asArray(),function(D){return !D.isInDragDrop&&D.snapToGeometry})},_getXSnapPoints:function(C){return _.pluck(A.getXSnapPoints(C),"value")},_getYSnapPoints:function(C){return _.pluck(A.getYSnapPoints(C),"value")},onMouseUp:function(){delete this.snappers},snap:function(E,D,C){if(!D.snapToGeometry){return C}this._createSnappers(E);return this._snapFigure(D).getTopLeft()},_snapFigure:function(C){return C.getBoundingBox().translate(this._snapPoints(this._getXSnapPoints(C),this.snappers.x),this._snapPoints(this._getYSnapPoints(C),this.snappers.y))},_snapPoints:function(E,D){var C=_.chain(E).map(D.snap).min(Math.abs).value();return Math.abs(C)<=this.SNAP_THRESHOLD?C:0}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/policy/canvas/snap-to-geometry/Snapper.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.Snapper");JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.Snapper=function(A){_.bindAll(this);this.points=A};JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.Snapper.prototype={snap:function(B){function A(C){return C-B}if(this.points.length===0){return 0}return _.chain(this.points).map(A).min(Math.abs).value()}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/policy/canvas/snap-to-geometry/SnapPoints.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.SnapPoints");JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.SnapPoints={getXSnapPoints:function(A){function B(C){var D=C.getBoundingBox();return _.map([D.getLeft(),D.getCenter().getX(),D.getRight()],this._makeSnapPoint(C))}_.isArray(A)||(A=[A]);return _.flatMap(A,B,this)},getYSnapPoints:function(A){function B(C){var D=C.getBoundingBox();return _.map([D.getTop(),D.getBottom()],this._makeSnapPoint(C))}_.isArray(A)||(A=[A]);return _.flatMap(A,B,this)},_makeSnapPoint:function(A){return function(B){return{rectangle:A.getBoundingBox(),value:B}}}};_.bindAll(JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.SnapPoints)}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/policy/figure/ImmutableFigureEditPolicy.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Policy.Figure.ImmutableFigureEditPolicy");JIRA.WorkflowDesigner.Policy.Figure.ImmutableFigureEditPolicy=draw2d.policy.figure.DragDropEditPolicy.extend({onInstall:function(A){this._super(A);this._originalState={isDeleteable:A.isDeleteable(),isResizeable:A.isResizeable()};A.setDeleteable(false);A.setResizeable(false)},onUninstall:function(A){A.setDeleteable(this._originalState.isDeleteable);A.setResizeable(this._originalState.isResizeable)}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/policy/port/StatusPortsFeedbackPolicy.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Policy.Feedback.StatusPortsFeedbackPolicy");JIRA.WorkflowDesigner.Policy.Feedback.StatusPortsFeedbackPolicy=draw2d.policy.port.IntrusivePortsFeedbackPolicy.extend({prepareDropTargetsForDrag:function(A){_.invoke(A.asArray(),"show")},alterDropTargetOnDrag:jQuery.noop,alterDropTargetOnDragEnd:jQuery.noop,getConnectionLineColour:function(){return"#1a8cff"},onHoverEnter:function(B,C,A){A.setGlow(true)},onHoverLeave:function(B,C,A){A.setGlow(false)}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/policy/port/LineSelectionFeedbackPolicy.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Policy.Feedback.LineSelectionFeedbackPolicy");JIRA.WorkflowDesigner.Policy.Feedback.LineSelectionFeedbackPolicy=draw2d.policy.figure.LineSelectionFeedbackPolicy.extend({createLineStartResizeHandle:function(A){return new JIRA.WorkflowDesigner.LineStartResizeHandle(A)},createLineEndResizeHandle:function(A){return new JIRA.WorkflowDesigner.LineEndResizeHandle(A)}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/util/Analytics.js' */
(function(){var D=jQuery(document);function C(E,F){if(AJS.EventQueue){AJS.EventQueue.push({name:"administration.workflow."+E,properties:F})}}function B(E,F){D.on("click",E,function(){C(F)})}B(".enter-full-screen","fullscreen");B(".transition-properties","view.transition.properties");B(".transition-conditions","view.transition.conditions");B(".transition-validators","view.transition.validators");B(".transition-postfunctions","view.transition.postfunctions");B(".status-properties","view.status.properties");function A(F,E){C("edit",{mode:"new-diagram",action:F,object:E})}AJS.namespace("JIRA.WorkflowDesigner.Analytics");JIRA.WorkflowDesigner.Analytics={triggerToggleLabels:function(E){C("toggle.labels."+(E?"on":"off"))},triggerAddStatus:function(){A("add","status")},triggerUpdateStatus:function(){A("update","status")},triggerAddStep:function(){A("add","step")},triggerUpdateStep:function(){A("update","step")},triggerRemoveStep:function(){A("remove","step")},triggerAddTransition:function(){A("add","transition")},triggerUpdateTransition:function(){A("update","transition")},triggerRemoveTransition:function(){A("remove","transition")},triggerAddGlobalTransition:function(){A("add","globaltransition")},triggerUpdateGlobalTransition:function(){A("update","globaltransition")},triggerRemoveGlobalTransition:function(){A("remove","globaltransition")}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/util/Canvas.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Canvas");JIRA.WorkflowDesigner.Canvas=draw2d.Canvas.extend({init:function(){_.bindAll(this,"_scheduleResize");this._super.apply(this,arguments);this.paper.canvas.style.position="";this.svgElement=jQuery(this.paper.canvas);this._debouncedSetViewBox=_.debounce(this.setViewBox,100);this._scheduleResize()},DEFAULT_RESIZE_INTERVAL:100,fitToContainer:function(){var C=Number(this.svgElement.attr("height")),A=Number(this.svgElement.attr("width")),E=this.getHeight(),D=this.getWidth(),B=C!==E||A!==D;if(!this.html.is(":visible")){return }if(B){this.paper.setSize(D,E);this.svgElement.css({height:E,width:D})}},fromCanvasToDocumentCoordinate:function(B,C){var A=JIRA.WorkflowDesigner.SVGUtilities.fromSVGToScreenCoordinate(this.paper.canvas,B,C);return new draw2d.geo.Point(A.x,A.y)},fromDocumentToCanvasCoordinate:function(B,C){var A=JIRA.WorkflowDesigner.SVGUtilities.fromScreenToSVGCoordinate(this.paper.canvas,B,C);return new draw2d.geo.Point(A.x,A.y)},getBestFigure:function(A,E,D){var C=D instanceof draw2d.Port,B=D instanceof draw2d.shape.basic.LineResizeHandle;if(!D||C||B){return this._super(A,E,D)}return null},getSelectedFigure:function(){return this.getSelection().getPrimary()},getViewBox:function(){var B,C=jQuery(this.html).offset(),A;A=this.paper.canvas.getAttribute("viewBox");A=A&&_.map(A.split(" "),parseFloat).slice(0,2)||[0,0];B=this.fromDocumentToCanvasCoordinate(C.left+this.svgElement.width()-jQuery(document).scrollLeft(),C.top+this.svgElement.height()-jQuery(document).scrollTop());return new draw2d.geo.Rectangle(A[0],A[1],B.x-A[0],B.y-A[1])},getZoom:function(){return this.svgElement.width()/this.getViewBox().getWidth()},_scheduleResize:function(){var A=!!this.svgElement.closest("body").length,B=_.isNumber(this._resizeInterval)?this._resizeInterval:this.DEFAULT_RESIZE_INTERVAL;if(A){setTimeout(this._scheduleResize,B);this.fitToContainer()}},selectFigure:function(A){var B=this;this.editPolicy.each(function(D,C){var E=C instanceof draw2d.policy.canvas.SingleSelectionPolicy;if(E){C.select(B,A)}})},setResizeInterval:function(A){this._resizeInterval=A},setViewBoxQuick:function(A){this.paper.canvas.setAttribute("viewBox",[A.getX(),A.getY(),A.getWidth(),A.getHeight()].join(" "));this._debouncedSetViewBox(A)},zoom:function(B,C,A){this.setViewBoxQuick(JIRA.WorkflowDesigner.ViewBoxTransformer.getZoomViewBox({diagramBoundingBox:A,factor:B,target:C,viewBox:this.getViewBox(),zoom:this.getZoom()}))}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/util/BrowserUtilities.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.BrowserUtilities");JIRA.WorkflowDesigner.BrowserUtilities={escapeQueryParameter:function(A){return encodeURIComponent(A).replace(/[!'()]/g,escape).replace(/\*/g,"%2A").replace(/%20/g,"+")},isIE8:function(){return !!jQuery.browser.msie&&parseInt(jQuery.browser.version,10)<9},makeQueryString:function(B){function A(D){var C=JIRA.WorkflowDesigner.BrowserUtilities.escapeQueryParameter;return _.map(D,C).join("=")}return _.map(_.pairs(B),A).join("&")},getZoomLevel:function(){var A;if(jQuery.browser.mozilla){return null}else{if(jQuery.browser.msie){A=screen.deviceXDPI/screen.logicalXDPI}else{if(jQuery.browser.webkit){A=window.outerWidth/window.innerWidth}}}return Math.round(A*10)/10},isMac:function(){return navigator.platform.toUpperCase().indexOf("MAC")!==-1}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/util/BrowserZoomChecker.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.BrowserZoomChecker");JIRA.WorkflowDesigner.BrowserZoomChecker=function(){_.bindAll(this,"_startWindowResizeSession","_endWindowResizeSession");jQuery(window).on("resize",this._startWindowResizeSession);this._debouncedEndWindowResizeSession=_.debounce(this._endWindowResizeSession,250);this._intervalId=setInterval(_.bind(this._check,this),1000)};_.extend(JIRA.WorkflowDesigner.BrowserZoomChecker.prototype,{_isMac:JIRA.WorkflowDesigner.BrowserUtilities.isMac(),_check:function(){var A=this._isMac?"The workflow designer may not behave correctly at your current browser zoom level, press \u2318 + 0 to reset it.":"The workflow designer may not behave correctly at your current browser zoom level, press Ctrl + 0 to reset it.",B;if(this._windowIsResizing){return }B=JIRA.WorkflowDesigner.BrowserUtilities.getZoomLevel();if(!B){return }if(B!==1){this._browserZoomMessage=JIRA.WorkflowDesigner.Messages.showErrorMessage(A)}else{if(this._browserZoomMessage){this._browserZoomMessage.remove()}}},destroy:function(){clearInterval(this._intervalId);jQuery(window).off("resize",this._startWindowResizeSession);this._browserZoomMessage&&this._browserZoomMessage.remove()},_endWindowResizeSession:function(){this._windowIsResizing=false},_startWindowResizeSession:function(){this._windowIsResizing=true;this._debouncedEndWindowResizeSession()}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/util/DialogSizeCalculator.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.DialogSizeCalculator");JIRA.WorkflowDesigner.DialogSizeCalculator={DISTANCE_FROM_EDGE:100,calculateDialogSize:function(B,A){this.dialog=B;A=_.defaults(A||{},{windowHeight:this._getWindowHeight(),windowWidth:this._getWindowWidth(),dialogHeaderHeight:this._getDialogHeaderHeight(),dialogFooterHeight:this._getDialogFooterHeight()});return{height:this._calculateDialogHeight(A.windowHeight,A.dialogHeaderHeight,A.dialogFooterHeight),width:this._calculateDialogWidth(A.windowWidth)}},_calculateDialogHeight:function(C,A,B){return C-A-B-(this.DISTANCE_FROM_EDGE*2)},_calculateDialogWidth:function(A){return A-(this.DISTANCE_FROM_EDGE*2)},_getWindowHeight:function(){return jQuery(window).height()},_getWindowWidth:function(){return jQuery(window).width()},_getDialogHeaderHeight:function(){return this.dialog.$popupHeading.outerHeight()},_getDialogFooterHeight:function(){return this.dialog.$buttonContainer.outerHeight()}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/util/Direction.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Direction");JIRA.WorkflowDesigner.Direction={DOWN:2,LEFT:3,RIGHT:1,UP:0}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/util/Draw2DUtilities.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Draw2DUtilities");JIRA.WorkflowDesigner.Draw2DUtilities={setCursor:function(A,C){var B=A.svgNodes||A.shape;B&&B.attr("cursor",C)}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/util/Collection.js' */
(function(){var A;AJS.namespace("JIRA.WorkflowDesigner.Collection");JIRA.WorkflowDesigner.Collection=function(B){this.length=0;this._objects=[];this.reset(B||[])};_.extend(JIRA.WorkflowDesigner.Collection.prototype,Backbone.Events,{add:function(B){B=[].concat(B);_.each(B,function(C){C.on("all",this.trigger,this)},this);this._objects=this._objects.concat(B);this.length=this._objects.length;return this},at:function(B){return this._objects[B]},remove:function(B){B=_.isArray(B)?B:[B];_.each(B,function(C){C.off("all",this.trigger,this)},this);this._objects=_.difference(this._objects,B);this.length=this._objects.length;return this},reset:function(B){this.remove(this._objects);return this.add(B)}});A=["chain","find","invoke"];_.each(A,function(B){JIRA.WorkflowDesigner.Collection.prototype[B]=function(){return _[B].apply(_,[this._objects].concat(_.toArray(arguments)))}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/util/FigureUtilities.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.FigureUtilities");JIRA.WorkflowDesigner.FigureUtilities={calculateBoundingBox:function(D){var B=null,F=null,G=null,E=null,C,A;_.each(D,function(H){var J=H.getX(),I=H.getY();if(!B||B>J){B=J}if(!F||F<J){F=J}if(!G||G>I){G=I}if(!E||E<I){E=I}});C=F-B;A=E-G;return new draw2d.geo.Rectangle(B,G,C,A)}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/util/Messages.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Messages");JIRA.WorkflowDesigner.Messages={showErrorMessage:function(C,B){var A=JIRA.Messages.showErrorMsg(C,B);A.css("z-index",2510);return A}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/util/MouseWheelHandler.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.MouseWheelHandler");JIRA.WorkflowDesigner.MouseWheelHandler=function(A){this._attachGlobalEvents(this._events,_.bind(this._onMouseWheel,this));this._endSession=_.debounce(_.bind(this._endSession,this),this.SESSION_DURATION);this._workflowCanvas=jQuery(A).get(0)};_.extend(JIRA.WorkflowDesigner.MouseWheelHandler.prototype,Backbone.Events,{DAMPENING_FIREFOX:20,DAMPENING_OTHERS:500,MINIMUM_ZOOM_FACTOR:0.1,SESSION_DURATION:500,_activeSession:null,_events:["DOMMouseScroll","mousewheel"],_workflowCanvas:null,_attachGlobalEvents:function(A,B){_.each(A,function(C){AJS.$(document).on(C,B)})},_onMouseWheel:function(A){this._activeSession||this._startNewSession(A.target);switch(this._activeSession){case"zoom":this._doZoom(A);break;case"scroll":break}this._endSession()},_isWorkflowDesigner:function(A){return A===this._workflowCanvas||AJS.$.contains(this._workflowCanvas,A)},_startNewSession:function(A){if(this._isWorkflowDesigner(A)){this._activeSession="zoom"}else{this._activeSession="scroll"}},_endSession:function(){this._activeSession=null},_computeZoomFactor:function(B){var C=!!B.originalEvent.detail,A;if(C){A=1+B.originalEvent.detail/this.DAMPENING_FIREFOX}else{A=1-B.originalEvent.wheelDelta/this.DAMPENING_OTHERS}isNaN(A)&&(A=1);return Math.max(this.MINIMUM_ZOOM_FACTOR,A)},_doZoom:function(A){A.preventDefault();this.trigger("zoom",{factor:this._computeZoomFactor(A),clientX:A.originalEvent.clientX,clientY:A.originalEvent.clientY})}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/util/patches/FigurePatch.js' */
(function(){_.extend(draw2d.Figure.prototype,{sendToBack:function(){this.svgNodes&&this.svgNodes.toBack();this.shape&&this.shape.toBack();return this},sendToFront:function(){this.shape&&this.shape.toFront();this.svgNodes&&this.svgNodes.toFront();return this}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/util/patches/LabelPatch.js' */
(function(){var A=draw2d.shape.basic.Label.prototype.setText;_.extend(draw2d.shape.basic.Label.prototype,{setText:function(){A.apply(this,arguments);this.cachedHeight=null;this.cachedMinHeight=null}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/util/patches/LinePatch.js' */
(function(){_.extend(draw2d.shape.basic.Line.prototype,{getBoundingBox:function(){return JIRA.WorkflowDesigner.FigureUtilities.calculateBoundingBox([this.getStartPoint(),this.getEndPoint()])}});draw2d.shape.basic.Line.hit=function(D,C,J,B,I,H,G){B-=C;I-=J;H-=C;G-=J;var F=H*B+G*I;var A;if(F<=0){return false}else{H=B-H;G=I-G;F=H*B+G*I;if(F<=0){return false}else{A=F*F/(B*B+I*I)}}var E=H*H+G*G-A;if(E<0){E=0}return Math.sqrt(E)<D}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/util/patches/NodePatch.js' */
(function(){_.extend(draw2d.shape.node.Node.prototype,{onDoubleClick:jQuery.noop})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/util/patches/PointPatch.js' */
(function(){_.extend(draw2d.geo.Point.prototype,{add:function(){return this.getTranslated.apply(this,arguments)},getComponents:function(){return[this.x,this.y]}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/util/patches/PolyLinePatch.js' */
(function(){_.extend(draw2d.shape.basic.PolyLine.prototype,{getBoundingBox:function(){var A=this.getPoints().asArray();return JIRA.WorkflowDesigner.FigureUtilities.calculateBoundingBox(A)}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/util/patches/RectanglePatch.js' */
(function(){var A={union:function(C){var B,D;B={x:Math.max(C.getRight(),this.getRight()),y:Math.max(C.getBottom(),this.getBottom())};D={x:Math.min(C.getLeft(),this.getLeft()),y:Math.min(C.getTop(),this.getTop())};return new draw2d.geo.Rectangle(D.x,D.y,B.x-D.x,B.y-D.y)},clone:function(){return new draw2d.geo.Rectangle(this.x,this.y,this.w,this.h)},scaleByFactor:function(B){return this.scale(this.w*(B-1),this.h*(B-1))},getRelativePosition:function(B){return B.subtract(this.getTopLeft())},getRelativePositionAsPercentage:function(C){var B=this.getRelativePosition(C);return new draw2d.geo.Point(B.x/this.w,B.y/this.h)}};_.extend(draw2d.geo.Rectangle.prototype,A)}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/util/SVGUtilities.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.SVGUtilities");JIRA.WorkflowDesigner.SVGUtilities={fromScreenToSVGCoordinate:function(C,B,D){C=jQuery(C).get(0);return A(C,C.getScreenCTM().inverse(),B,D)},fromSVGToPageCoordinate:function(E,D,F){var C=jQuery(window.document),B=JIRA.WorkflowDesigner.SVGUtilities.fromSVGToScreenCoordinate(E,D,F);B.x+=C.scrollLeft();B.y+=C.scrollTop();return B},fromSVGToScreenCoordinate:function(C,B,D){C=jQuery(C).get(0);return A(C,C.getScreenCTM(),B,D)},getPageBoundingBox:function(D){var C,B=jQuery(D).get(0).getBBox(),E;E=JIRA.WorkflowDesigner.SVGUtilities.fromSVGToPageCoordinate(D,B.x,B.y);C=JIRA.WorkflowDesigner.SVGUtilities.fromSVGToPageCoordinate(D,B.x+B.width,B.y+B.height);return{height:C.y-E.y,width:C.x-E.x,x:E.x,y:E.y}}};function A(E,D,C,F){var B=jQuery(E).closest("svg").get(0).createSVGPoint();B.x=C;B.y=F;B=B.matrixTransform(D);return{x:B.x,y:B.y}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/util/UnderscoreMixins.js' */
(function(){_.mixin({cartesianProduct:function(){var A=Array.prototype.slice.call(arguments,0);return _.reduce(A,function(C,D){var B=[];_.each(C,function(E){_.each(D,function(F){B.push(E.concat(F))})});return B},[[]])},flatMap:_.compose(_.flatten,_.map),sum:function(B,A){return _.reduce(B,function(C,D){return C+D},0,A)}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/util/Vector2D.js' */
(function(){var A=draw2d.geo.Point;AJS.namespace("JIRA.WorkflowDesigner.Vector2D");JIRA.WorkflowDesigner.Vector2D=A.extend({init:function(D,C){var E=D instanceof A&&C instanceof A,B=D,F=C;if(E){B=C.x-D.x;F=C.y-D.y}this._super(B,F)},getLength:function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},multiply:function(B){this.x*=B;this.y*=B;return this},normalize:function(){var B=this.getLength();if(B>0){this.multiply(1/B)}return this}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/util/ViewBoxTransformer.js' */
(function(){var E=0.25;var C=2;var B=0.5;function D(G){return G.clone().scaleByFactor(E*2)}function F(I,H,G){return I.clone().translate(-H,-G).resize(H,G)}function A(I,H){var K=C*H,G=B*H,J=Math.max(Math.min(I,K),G);if(Math.abs(J-1)>0.0001){return J}else{return 1}}JIRA.WorkflowDesigner.ViewBoxTransformer={getZoomViewBox:function(Q){var H=Q.viewBox,L=Q.diagramBoundingBox,P=A(Q.factor,Q.zoom),G,N,I,O=Q.target,K,M,J;N=H.getWidth()*P;G=H.getHeight()*P;J=D(L);K=F(J,N,G);I=H.getRelativePositionAsPercentage(O);M=new draw2d.geo.Point(O.getX()-I.x*N,O.getY()-I.y*G);M.setBoundary(K.getLeft(),K.getTop(),K.getRight(),K.getBottom());return new draw2d.geo.Rectangle(M.getX(),M.getY(),N,G)},getPanViewBox:function(K){var M=K.viewBox,J=K.diagramBoundingBox,I=K.displacement,H,G,L;L=D(J);H=F(L,M.getWidth(),M.getHeight());G=M.getTopLeft().translate(I.x,I.y).setBoundary(H.getLeft(),H.getTop(),H.getRight(),H.getBottom());return new draw2d.geo.Rectangle(G.getX(),G.getY(),M.getWidth(),M.getHeight())}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/views/ActionsView.js' */
(function(){Backbone.define("JIRA.WorkflowDesigner.ActionsView",Backbone.View.extend({className:"actions",events:{"click .add-status":"_addStatus","click .create-status":"_createStatus","click .enter-full-screen":"_enterFullScreen","click .exit-full-screen":"_exitFullScreen","change .show-transition-labels":"_setShowTransitionLabels"},initialize:function(A){jQuery(A.container).append(this.$el);this.fullScreenButton=A.fullScreenButton;this.immutable=A.immutable},_addStatus:function(){new JIRA.WorkflowDesigner.Dialogs.AddStatusDialogView({workflowModel:this.model}).show()},_createStatus:function(){new JIRA.WorkflowDesigner.Dialogs.CreateStatusDialogView({statusModel:new JIRA.WorkflowDesigner.StatusModel(),workflowModel:this.model}).show()},_enterFullScreen:function(){this._toggleFullScreenTriggers();this.trigger("fullScreen:enter")},_exitFullScreen:function(){this._toggleFullScreenTriggers();this.trigger("fullScreen:exit")},render:function(){var A,B=JIRA.WorkflowDesigner.Templates.actions;this.$el.html(B({fullScreenButton:this.fullScreenButton,immutable:this.immutable,showTransitionLabels:this.model.get("showTransitionLabels")}));A=this.$(".full-screen-trigger");A.tooltip();A.filter(".hidden").tipsy("disable");return this},_toggleFullScreenTriggers:function(){this.$(".full-screen-trigger").each(function(A,B){jQuery(B).tipsy("toggleEnabled")}).toggleClass("hidden")},_setShowTransitionLabels:function(A){this.model.setShowTransitionLabels(jQuery(A.target).is(":checked"))}}))}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/views/BaseStatusView.js' */
(function(){Backbone.define("JIRA.WorkflowDesigner.BaseStatusView",Backbone.View.extend({initialize:function(A){_.bindAll(this);A=_.defaults({},A,{immutable:false});this.canvas=A.canvas;this.immutable=A.immutable;this.isPortDragged=A.isPortDragged;this.getAllTargetPorts=A.getAllTargetPorts;this.workflowModel=A.workflowModel;this.model.on("change",this.render)},_createAndConfigureFigure:function(){var B=this._createFigure(),A=this;var D=B.onDrag;B.onDrag=function(){D.apply(this,arguments);A.trigger("drag")};var C=B.onDragEnd;B.onDragEnd=function(){C.apply(this,arguments);A._updatePosition();A.trigger("dragEnd")};this._installEditPolicy(B);return B},_createPort:function(A){A=_.extend({},A,{canvas:this.canvas,isPortDragged:this.isPortDragged,getAllTargetPorts:this.getAllTargetPorts,getSiblingPorts:this.getPorts});return new JIRA.WorkflowDesigner.StatusPort(A)},highlight:function(){var A=this;clearInterval(this._highlightIntervalId);this._highlightIntervalId=setTimeout(function(){A._highlight()},JIRA.WorkflowDesigner.Constants.HIGHLIGHT_DELAY)},_highlight:function(){this.trigger("highlight")},unhighlight:function(){clearInterval(this._highlightIntervalId);this._unhighlight()},_unhighlight:function(){this.trigger("unhighlight")},getAngleToPort:function(A){return this._getAngleToFigure(A)},getAngleToStatus:function(A){return this._getAngleToFigure(A.figure)},_getAngleToFigure:function(A){var C=A.getBoundingBox().getCenter(),B=this.figure.getBoundingBox().getCenter();return Math.atan2(C.getY()-B.getY(),C.getX()-B.getX())/Math.PI*180},getPortForAngle:function(B){function A(C){var D=Math.abs(B-this._getAngleToFigure(C));return D<180?D:Math.abs(D-360)}return _.min(this.getPorts(),A,this)},_installEditPolicy:function(A){var B;if(this.immutable){B=new JIRA.WorkflowDesigner.Policy.Figure.ImmutableFigureEditPolicy()}else{B=new draw2d.policy.figure.DragDropEditPolicy()}A.installEditPolicy(B)},isInitial:function(){return this.model.isInitial()},remove:function(){Backbone.View.prototype.remove.apply(this,arguments);this.canvas.removeFigure(this.figure)},render:function(){this.figure||(this.figure=this._createAndConfigureFigure());return this},_setFigurePositionFromModel:function(B){var A=this.model.get("x"),C=this.model.get("y");if(_.isNumber(A)&&_.isNumber(C)){B.setPosition(A,C)}},setPosition:function(A,B){this.model.set({x:A,y:B})},_updatePosition:function(){var A=this.getBoundingBox();this.setPosition(A.getX(),A.getY())}}))}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/views/CanvasView.js' */
(function(){Backbone.define("JIRA.WorkflowDesigner.CanvasView",Backbone.View.extend({className:"canvas",initialize:function(A){var B=this.model.get("statuses"),C=this.model.get("transitions");_.bindAll(this);A=_.defaults({},A,{immutable:false});this.canvas=this._createCanvas(A.container);this.immutable=A.immutable;this.statusViews=new JIRA.WorkflowDesigner.Collection();this.transitionViews=new JIRA.WorkflowDesigner.Collection();this._mouseWheelHandler=new JIRA.WorkflowDesigner.MouseWheelHandler(this.el);this._mouseWheelHandler.on("zoom",this._onZoom);B.on("add",this.addStatus,this);B.on("remove",this.removeStatus);B.on("reset",this.resetStatuses);this.statusViews.on("deselected",this._clearSelectedView,this);this.statusViews.on("port:drag:start",_.bind(this._setPortDragged,this,true));this.statusViews.on("port:drag:end",_.bind(this._onPortDragEnd,this));this.statusViews.on("selected",this._setSelectedView,this);this.model.on("change:selectedModel",this._onSelectedModelChange);this.model.on("reset:after",this._positionNewStatuses);this.transitionViews.on("deselected",this._clearSelectedView,this);this.transitionViews.on("reconnect",this._onReconnect,this);this.transitionViews.on("selected",this._setSelectedView,this);C.on("add",this.addTransition);C.on("remove",this.removeTransition);C.on("reset",this.resetTransitions);!this.immutable&&jQuery(document).on("keydown",this._onKeyDown)},addStatus:function(B){var D=B.get("initial"),A,C;if(D){C=JIRA.WorkflowDesigner.InitialStatusView}else{C=JIRA.WorkflowDesigner.StatusView}A=new C({canvas:this.canvas,getAllTargetPorts:this._getAllTargetPorts,immutable:this.immutable,isPortDragged:this._isPortDragged,model:B,workflowModel:this.model}).render();this.statusViews.add(A);return A},addTransition:function(A){var D=A.get("globalTransition"),B=this._getTransitionViewWithModel(A),C;if(B){return B}if(D){C=JIRA.WorkflowDesigner.GlobalTransitionView}else{C=JIRA.WorkflowDesigner.TransitionView}B=new C({canvas:this.canvas,immutable:this.immutable,model:A,sourceView:this._getStatusViewWithModel(A.get("source")),targetView:this._getStatusViewWithModel(A.get("target")),workflowModel:this.model}).render();this.transitionViews.add(B);return B},autoFit:function(){var A,D,B,C=10,E;this.canvas.fitToContainer();A=this.getCanvasBoundingBox();if(A){A.scale(C*2,C*2);E=new draw2d.geo.Rectangle(0,0,this.$el.width(),this.$el.height());B=A.getHeight()<=E.getHeight()&&A.getWidth()<=E.getWidth();if(!B){this.canvas.setViewBox(A);E=this.canvas.getViewBox()}D=A.getCenter();this.canvas.setViewBox(new draw2d.geo.Rectangle(D.getX()-E.getWidth()/2,D.getY()-E.getHeight()/2,E.getWidth(),E.getHeight()))}},_clearSelectedView:function(A){var B=this.model.get("selectedView")===A;B&&this.model.selectView(null)},_createCanvas:function(A){var B,C=this._getUniqueId();A=jQuery(A);A.append(this.el);this.$el.attr("id",C);B=new JIRA.WorkflowDesigner.Canvas(C);B.installEditPolicy(new JIRA.WorkflowDesigner.Policy.Canvas.PanningSingleSelectionPolicy(_.bind(this.getCanvasBoundingBox,this)));B.installEditPolicy(new JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.SnapEditPolicy());B.installEditPolicy(new JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.GuideLineEditPolicy());B.onNewConnection=this._onNewConnection;return B},_delete:function(){var A=this.model.get("selectedView");A&&A.destroy();return !!A},_getAllTargetPorts:function(){function B(C){return C.model.isInitial()}function A(C){return C.getPorts()}return this.statusViews.chain().reject(B).flatMap(A).value()},getCanvasBoundingBox:function(){var A;function B(E,C){var D=C.getBoundingBox();if(A){A=A.union(D)}else{A=D}}this.canvas.getFigures().each(B);this.canvas.getLines().each(B);return A},_getStatusViewWithModel:function(A){return this.statusViews.find(function(B){return B.model===A})},getStatusViewWithPort:function(A){return this.statusViews.find(function(B){return _.contains(B.getPorts(),A)})},_getTransitionViewWithModel:function(A){return this.transitionViews.find(function(B){return B.model===A})},_getUniqueId:function(){var A=0,B;do{A++;B="workflow-designer"+A}while(jQuery("#"+B).length);return B},hideProgressIndicator:function(){this.progressIndicator.hide()},_isPortDragged:function(){return !!this.portDragged},_onKeyDown:function(A){if(this._shouldHandleDelete(A)){this._delete()&&A.preventDefault()}},_onNewConnection:function(C){var B=C.getSource(),A=this.getStatusViewWithPort(B),E=C.getTarget(),D=this.getStatusViewWithPort(E),F;F=this.model.addTransition({source:A.model,sourceAngle:A.getAngleToPort(B),target:D.model,targetAngle:D.getAngleToPort(E)});this.canvas.removeFigure(C);new JIRA.WorkflowDesigner.Dialogs.AddTransitionDialogView({transitionModel:F,workflowModel:this.model}).show()},_onReconnect:function(E){var B=E.getConnection().getSource(),A=this.getStatusViewWithPort(B),D=E.getConnection().getTarget(),C=this.getStatusViewWithPort(D);E.model.set({source:A.model,sourceAngle:A.getAngleToPort(B),target:C.model,targetAngle:C.getAngleToPort(D)});E.setViews(A,C)},_onZoom:function(A){AJS.InlineDialog.current&&AJS.InlineDialog.current.hide();this.zoom(A.factor,this.canvas.fromDocumentToCanvasCoordinate(A.clientX,A.clientY))},_positionNewStatuses:function(){var A=this.model.get("statuses").map(this._getStatusViewWithModel);JIRA.WorkflowDesigner.StatusPositioner.positionStatuses(A,this.canvas.getViewBox())},remove:function(){Backbone.View.prototype.remove.apply(this,arguments);jQuery(document).off("keydown",this._onKeyDown)},removeStatus:function(B){var A=this._getStatusViewWithModel(B);if(A){A.remove();this.statusViews.remove(A)}},removeTransition:function(A){var B=this._getTransitionViewWithModel(A);if(B){B.remove();this.transitionViews.remove(B)}},resetStatuses:function(){while(this.statusViews.length){this.removeStatus(this.statusViews.at(0).model)}this.model.get("statuses").each(function(A){this.addStatus(A)},this)},resetTransitions:function(){while(this.transitionViews.length){this.removeTransition(this.transitionViews.at(0).model)}this.model.get("transitions").forEach(function(A){this.addTransition(A)},this)},_onSelectedModelChange:function(D,A){var C=this._getStatusViewWithModel(A)||this._getTransitionViewWithModel(A),B=this.model.get("selectedView");if(A&&C!==B){C.select()}},_onPortDragEnd:function(){function A(B){return B.model.isInitial()}this._setPortDragged(false);this.statusViews.chain().reject(A).invoke("updatePortsVisibility")},_setPortDragged:function(A){this.portDragged=A},setResizeInterval:function(A){this.canvas.setResizeInterval(A)},_setSelectedView:function(A){this.model.selectView(A)},_shouldHandleDelete:function(D){var A=[jQuery.ui.keyCode.BACKSPACE,jQuery.ui.keyCode.DELETE],E=!!jQuery(".aui-blanket:visible").length,C=_.contains(A,D.which),B=jQuery(D.target).is(":input");return !E&&C&&!B},showProgressIndicator:function(){this.progressIndicator||(this.progressIndicator=new JIRA.WorkflowDesigner.IndeterminateProgressIndicatorView({container:this.el}));this.progressIndicator.show()},zoom:function(A,B){this.canvas.zoom(A,B||this.canvas.getViewBox().getCenter(),this.getCanvasBoundingBox())}}))}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/views/dialogs/AddStatusDialogView.js' */
(function(){Backbone.define("JIRA.WorkflowDesigner.Dialogs.AddStatusDialogView",JIRA.WorkflowDesigner.Dialogs.FormDialogView.extend({events:{"click .status":"_onStatusClicked","dblclick .status":"_onSubmit"},id:"add-status-dialog",initialize:function(A){_.bindAll(this);this.workflowModel=A.workflowModel},_getContent:function(){var A=this;return function(C){var B=JIRA.WorkflowDesigner.IO.AJAX.StatusesAJAXManager.getStatuses();B.done(function(D){A.statuses=D;C(JIRA.WorkflowDesigner.Templates.addStatusDialog({statuses:A._getValidStatuses(D)}))});B.fail(function(D){JIRA.WorkflowDesigner.Messages.showErrorMessage(D,{closeable:true});A.hide()})}},_getSelectedStatus:function(){var A=this.$(".selected").data("id");return _.where(this.statuses,{id:A.toString()})[0]},_getValidStatuses:function(C){var B;function A(E){return E.name.toLowerCase()}function D(E){return !_.contains(B,E.id)}B=this.workflowModel.get("statuses").pluck("statusId");return _.chain(C).filter(D).sortBy(A).value()},_onStatusClicked:function(A){this.$(".status").removeClass("selected");jQuery(A.target).closest(".status").addClass("selected")},_onSuccess:function(A){this.hide();this.workflowModel.reset(A)},_onSubmit:function(C,D){var A,B;C.preventDefault();this.disable();this.removeErrorMessages();A={createGlobalTransition:this.$("#create-global-transition").is(":checked"),statusId:this._getSelectedStatus().id,workflowName:this.workflowModel.get("name")};B=JIRA.WorkflowDesigner.IO.AJAX.WorkflowStatusesAJAXManager.addStatus(A);B.done(this._onSuccess).fail(D).fail(this._onError);JIRA.WorkflowDesigner.Analytics.triggerAddStep()}}))}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/views/dialogs/AddTransitionDialogView.js' */
(function(){Backbone.define("JIRA.WorkflowDesigner.Dialogs.AddTransitionDialogView",JIRA.WorkflowDesigner.Dialogs.TransitionDialogView.extend({id:"add-transition-dialog",_makeRequest:function(A){return JIRA.WorkflowDesigner.IO.AJAX.WorkflowTransitionsAJAXManager.addTransition(A)},_onHide:function(C,A,B){var D=_.contains([JIRA.Dialog.HIDE_REASON.cancel,JIRA.Dialog.HIDE_REASON.escape],B);if(D){this._workflowModel.removeTransition(this._transitionModel)}},_onSuccess:function(){JIRA.WorkflowDesigner.Dialogs.TransitionDialogView.prototype._onSuccess.apply(this,arguments);this._workflowModel.set("selectedModel",this._transitionModel)},show:function(){JIRA.WorkflowDesigner.Dialogs.TransitionDialogView.prototype.show.apply(this);jQuery(this.dialog).one("Dialog.hide",this._onHide)},_onSubmit:function(){JIRA.WorkflowDesigner.Dialogs.TransitionDialogView.prototype._onSubmit.apply(this,arguments);JIRA.WorkflowDesigner.Analytics.triggerAddTransition()}}))}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/views/dialogs/CreateGlobalTransitionDialogView.js' */
(function(){Backbone.define("JIRA.WorkflowDesigner.Dialogs.CreateGlobalTransitionDialogView",JIRA.WorkflowDesigner.Dialogs.FormDialogView.extend({id:"create-global-transition-dialog",initialize:function(A){this.statusModel=A.statusModel;this.workflowModel=A.workflowModel},_getContent:function(){var A=this;function B(C){return{text:C.name,value:C.id}}return function(C){JIRA.WorkflowDesigner.IO.AJAX.ScreensAJAXManager.getScreens().done(function(D){C(JIRA.WorkflowDesigner.Templates.createGlobalTransitionDialog({screens:_.map(D,B)}))}).fail(function(){JIRA.WorkflowDesigner.IO.ErrorHandler.handle.apply(this,arguments);A.hide()})}},_getSelectedScreenId:function(){return this.$("#global-transition-screen-id").find(":selected").val()},_onContentRefresh:function(){new AJS.SingleSelect({element:this.$("#global-transition-screen-id"),revertOnInvalid:true})},_onSuccess:function(A){this.hide();this.workflowModel.reset(A)},_onSubmit:function(B,C){B.preventDefault();this.disable();this.removeErrorMessages();var A={statusId:this.statusModel.get("statusId"),workflowName:this.workflowModel.get("name"),name:this.$("#global-transition-name").val(),description:this.$("#global-transition-description").val(),screenId:this._getSelectedScreenId()};JIRA.WorkflowDesigner.IO.AJAX.WorkflowGlobalTransitionsAJAXManager.createGlobalTransition(A).always(C).done(_.bind(this._onSuccess,this)).fail(_.bind(this._onError,this));JIRA.WorkflowDesigner.Analytics.triggerAddGlobalTransition()}}))}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/views/dialogs/CreateStatusDialogView.js' */
(function(){Backbone.define("JIRA.WorkflowDesigner.Dialogs.CreateStatusDialogView",JIRA.WorkflowDesigner.Dialogs.StatusDialogView.extend({id:"create-status-dialog",_makeRequest:function(A){A=_.extend({},A,{createGlobalTransition:this.$("#create-global-transition").is(":checked")});return JIRA.WorkflowDesigner.IO.AJAX.WorkflowStatusesAJAXManager.createStatus(A)},_onSuccess:function(A){this.hide();this._workflowModel.reset(A)},_onSubmit:function(){JIRA.WorkflowDesigner.Dialogs.StatusDialogView.prototype._onSubmit.apply(this,arguments);JIRA.WorkflowDesigner.Analytics.triggerAddStatus();JIRA.WorkflowDesigner.Analytics.triggerAddStep()}}))}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/views/dialogs/DeleteStatusDialogView.js' */
(function(){Backbone.define("JIRA.WorkflowDesigner.Dialogs.DeleteStatusDialogView",JIRA.WorkflowDesigner.Dialogs.FormDialogView.extend({id:"delete-status-dialog",initialize:function(A){_.bindAll(this);this.statusModel=A.statusModel;this.workflowModel=A.workflowModel},_getContent:function(){var A=this._chooseContentTemplate();return jQuery(A(this.statusModel.toJSON()))},_chooseContentTemplate:function(){var B=this.workflowModel.get("transitions").getInitial(),A=this.statusModel.hasTransition(B);if(this.workflowModel.get("draft")){return JIRA.WorkflowDesigner.Templates.cannotDeleteStatusFromActiveWorkflow}if(A){return JIRA.WorkflowDesigner.Templates.cannotDeleteInitialStatus}return JIRA.WorkflowDesigner.Templates.confirmDeleteStatus},_onSubmit:function(C,D){var A,B;C.preventDefault();this.disable();this.removeErrorMessages();A={statusId:this.statusModel.get("statusId"),workflowName:this.workflowModel.get("name")};B=JIRA.WorkflowDesigner.IO.AJAX.WorkflowStatusesAJAXManager.removeStatus(A);B.done(this._onSuccess).fail(D).fail(this._onError);JIRA.WorkflowDesigner.Analytics.triggerRemoveStep()},_onSuccess:function(A){this.hide();this.workflowModel.reset(A)}}))}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/views/dialogs/DeleteTransitionDialogView.js' */
(function(){Backbone.define("JIRA.WorkflowDesigner.Dialogs.DeleteTransitionDialogView",JIRA.WorkflowDesigner.Dialogs.FormDialogView.extend({id:"delete-transition-dialog",initialize:function(A){_.bindAll(this);this.transitionModel=A.transitionModel;this.workflowModel=A.workflowModel},_getContent:function(){var A=this._chooseContentTemplate();return jQuery(A({transitionName:this.transitionModel.get("name")}))},_chooseContentTemplate:function(){if(this.transitionModel.isInitial()){return JIRA.WorkflowDesigner.Templates.cannotDeleteInitialTransition}return JIRA.WorkflowDesigner.Templates.confirmDeleteTransition},_onSubmit:function(C,D){var A,B;C.preventDefault();this.disable();this.removeErrorMessages();A={transitionId:this.transitionModel.get("actionId"),sourceStepId:this.transitionModel.getSourceStepId(),workflowName:this.workflowModel.get("name")};if(this.transitionModel.isGlobalTransition()){B=JIRA.WorkflowDesigner.IO.AJAX.WorkflowGlobalTransitionsAJAXManager.deleteGlobalTransition(A);JIRA.WorkflowDesigner.Analytics.triggerRemoveGlobalTransition()}else{B=JIRA.WorkflowDesigner.IO.AJAX.WorkflowTransitionsAJAXManager.deleteTransition(A);JIRA.WorkflowDesigner.Analytics.triggerRemoveTransition()}B.done(this._onSuccess).fail(D).fail(this._onError)},_onSuccess:function(){this.hide();this.transitionModel.destroy()}}))}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/views/dialogs/EditGlobalTransitionDialogView.js' */
(function(){Backbone.define("JIRA.WorkflowDesigner.Dialogs.EditGlobalTransitionDialogView",JIRA.WorkflowDesigner.Dialogs.TransitionDialogView.extend({id:"edit-global-transition-dialog",_makeRequest:function(A){return JIRA.WorkflowDesigner.IO.AJAX.WorkflowGlobalTransitionsAJAXManager.updateGlobalTransition(A)},_onSubmit:function(){JIRA.WorkflowDesigner.Dialogs.TransitionDialogView.prototype._onSubmit.apply(this,arguments);JIRA.WorkflowDesigner.Analytics.triggerUpdateGlobalTransition()}}))}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/views/dialogs/EditStatusDialogView.js' */
(function(){Backbone.define("JIRA.WorkflowDesigner.Dialogs.EditStatusDialogView",JIRA.WorkflowDesigner.Dialogs.StatusDialogView.extend({id:"edit-status-dialog",_makeRequest:function(A){A=_.extend({},A,{statusId:this._statusModel.get("statusId")});return JIRA.WorkflowDesigner.IO.AJAX.WorkflowStatusesAJAXManager.updateStatus(A)},_onSuccess:function(){this._statusModel.set({name:this.$("#status-name").val(),description:this.$("#status-description").val()});this.hide()},_onSubmit:function(){JIRA.WorkflowDesigner.Dialogs.StatusDialogView.prototype._onSubmit.apply(this,arguments);JIRA.WorkflowDesigner.Analytics.triggerUpdateStatus();JIRA.WorkflowDesigner.Analytics.triggerUpdateStep()}}))}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/views/dialogs/EditTransitionDialogView.js' */
(function(){Backbone.define("JIRA.WorkflowDesigner.Dialogs.EditTransitionDialogView",JIRA.WorkflowDesigner.Dialogs.TransitionDialogView.extend({id:"edit-transition-dialog",_makeRequest:function(A){return JIRA.WorkflowDesigner.IO.AJAX.WorkflowTransitionsAJAXManager.updateTransition(A)},_onSubmit:function(){JIRA.WorkflowDesigner.Dialogs.TransitionDialogView.prototype._onSubmit.apply(this,arguments);JIRA.WorkflowDesigner.Analytics.triggerUpdateTransition()}}))}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/views/FullScreenController.js' */
(function(){var G=500,B="full-screen-controller-original-properties",F="full-screen-controller-placeholder";function E(J,I){return _.reduce(I,function(L,K){L[K]=J.css(K);return L},{})}function A(I){var J;J=jQuery("<div>").css({height:I.outerHeight()}).insertAfter(I);I.data(F,J)}function D(I){I.data(F).remove();I.removeData(F)}function C(I){var J=I.data(B);I.css(J).removeData(B)}function H(J,I){var K=E(J,_.keys(I));J.css(I).data(B,K)}AJS.namespace("JIRA.WorkflowDesigner.FullScreenController");JIRA.WorkflowDesigner.FullScreenController={enterFullScreen:function(L){var J=jQuery("body"),K=jQuery.Deferred(),I=jQuery(window.document);L=jQuery(L);A(L);H(L,{height:L.outerHeight(),left:L.offset().left-I.scrollLeft(),position:"fixed",top:L.offset().top-I.scrollTop(),width:L.outerWidth(),zIndex:2500});H(J,{overflow:"hidden"});L.appendTo(J);L.animate({height:"100%",left:0,top:0,width:"100%"},G,K.resolve);return K.promise()},exitFullScreen:function(L){var J=jQuery("body"),K=jQuery.Deferred(),I=jQuery(window.document),M;function N(){L.insertBefore(M);D(L);C(L);K.resolve()}L=jQuery(L);M=L.data(F);C(J);L.animate({height:M.outerHeight(),left:M.offset().left-I.scrollLeft(),top:M.offset().top-I.scrollTop(),width:M.outerWidth()},G,N);return K.promise()}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/views/transitions/GlobalTransitionFigure.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.GlobalTransitionFigure");JIRA.WorkflowDesigner.GlobalTransitionFigure=draw2d.shape.basic.Rectangle.extend({init:function(){var E,C,A,B,D;_.bindAll(this,"_onDoubleClick");this._super.apply(this,arguments);this.installEditPolicy(new draw2d.policy.figure.SelectionFeedbackPolicy());this.setAlpha(0);this.setDeleteable(false);this.setDimension(68,14);this.setResizeable(false);A=this._line=new draw2d.shape.basic.Line(0,0,0,0);A.onDoubleClick=this._onDoubleClick;A.setColor("#cccccc");A.setStroke(1);this.addFigure(A,new draw2d.layout.locator.CenterLocator(this));E=this._arrow=new JIRA.WorkflowDesigner.TriangleFigure();E.onDoubleClick=this._onDoubleClick;E.setDimension(7,8);E.setBackgroundColor("#cccccc");E.setColor("#cccccc");E.setStroke(1);this.addFigure(E,new JIRA.WorkflowDesigner.Layout.Locator.StaticLocator(this,0,3));B=this._createLozenge();D=new JIRA.WorkflowDesigner.Layout.Locator.StaticLocator(this,49,0);this.addFigure(B,D);C=this._hover=new draw2d.shape.basic.Rectangle(19,14);C.onDoubleClick=this._onDoubleClick;C.setAlpha(0);this.addFigure(C,D)},_createLozenge:function(){var A,B;A=new draw2d.shape.basic.Rectangle(19,14);A.setBackgroundColor("#333333");A.setStroke(0);B=new draw2d.shape.basic.Label();B.setAlpha(0);B.setBold(true);B.setFontColor("#ffffff");B.setFontFamily("Arial");B.setFontSize(11);B.setStroke(0);B.setText("All");A.addFigure(B,new draw2d.layout.locator.CenterLocator(A));return A},getHoverElement:function(){return this._hover.shape.node},getPorts:function(){return new draw2d.util.ArrayList()},onDrag:jQuery.noop,_onDoubleClick:function(){this.onDoubleClick.apply(this,arguments)},select:function(){this._super.apply(this,arguments);this._arrow.setBackgroundColor("#ffffff");this._arrow.setColor("#1a8cff");this._line.setColor("#1a8cff")},setPosition:function(A,C){var B;this._super(A,C);B=this.getBoundingBox();this._line.setStartPoint(B.getLeft(),B.getCenter().getY());this._line.setEndPoint(B.getRight(),B.getCenter().getY())},unselect:function(){this._super.apply(this,arguments);this._arrow.setBackgroundColor("#cccccc");this._arrow.setColor("#cccccc");this._line.setColor("#cccccc")}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/views/transitions/GlobalTransitionView.js' */
(function(){Backbone.define("JIRA.WorkflowDesigner.GlobalTransitionView",Backbone.View.extend({initialize:function(A){this.canvas=A.canvas;this._immutable=A.immutable;this._targetView=A.targetView;this._workflowModel=A.workflowModel;this._targetView.on("move",this._onMove,this)},_createDialog:function(){var C=this._figure.getHoverElement(),E=_.uniqueId("global-transition-dialog-"),A=this;function D(){return{fill:"#333333",stroke:"#333333"}}function B(H,G,F){var I=JIRA.WorkflowDesigner.Templates.globalTransitionDialogContent;H.html(I({name:A.model.get("name"),statusName:A.model.get("target").get("name")}));F()}this._dialog=AJS.InlineDialog(C,E,B,{calculatePositions:JIRA.WorkflowDesigner.InlineDialogSVGPositioner,getArrowAttributes:D,hideDelay:50,onHover:true})},_createFigure:function(){this._figure=new JIRA.WorkflowDesigner.GlobalTransitionFigure();this._figure.setSelectable(!this._immutable);this._immutable||(this._figure.onDoubleClick=_.bind(this.edit,this));this.canvas.addFigure(this._figure);this._createDialog();this._positionFigure()},_deselect:function(){this.trigger("deselected",this)},destroy:function(){new JIRA.WorkflowDesigner.Dialogs.DeleteTransitionDialogView({transitionModel:this.model,workflowModel:this._workflowModel}).show()},edit:function(){new JIRA.WorkflowDesigner.Dialogs.EditGlobalTransitionDialogView({transitionModel:this.model,workflowModel:this._workflowModel}).show()},_getFigure:function(){return this._figure},_onMove:function(){this._dialog&&this._dialog.hide();this._positionFigure()},_positionFigure:function(){var A=this._figure.getBoundingBox(),B=this._targetView.getBoundingBox();this._figure.setPosition(B.getRight()+2,B.getCenter().getY()-A.getHeight()/2)},remove:function(){Backbone.View.prototype.remove.apply(this,arguments);this.canvas.removeFigure(this._figure);this._targetView.off("move",this._onMove)},render:function(){this._figure||this._createFigure();return this},_select:function(){this.trigger("selected",this)}}));Cocktail.mixin(JIRA.WorkflowDesigner.GlobalTransitionView,JIRA.WorkflowDesigner.SelectableFigureMixin)}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/views/IndeterminateProgressIndicatorView.js' */
(function(){Backbone.define("JIRA.WorkflowDesigner.IndeterminateProgressIndicatorView",Backbone.View.extend({className:"indeterminate-progress-indicator",frameHeight:40,imageHeight:440,initialize:function(A){_.bindAll(this);this.container=jQuery(A.container)},hide:function(){clearInterval(this.intervalID);this.$el.remove()},show:function(){var B=0;function A(){B=(B-this.frameHeight)%this.imageHeight;this.$el.css("background-position","0 "+B+"px")}clearInterval(this.intervalID);this.$el.appendTo(this.container);this.intervalID=setInterval(_.bind(A,this),50)}}))}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/views/InitialStatusView.js' */
(function(){Backbone.define("JIRA.WorkflowDesigner.InitialStatusView",JIRA.WorkflowDesigner.BaseStatusView.extend({_createFigure:function(){this.fill=new draw2d.shape.basic.Circle(30);this.fill.onMouseEnter=this.highlight;this.fill.onMouseLeave=this.unhighlight;this.fill.setBackgroundColor("#C0C0C0");this.fill.setStroke(0);this.circle=new draw2d.shape.basic.Circle(30);this.circle.setBackgroundColor("#C0C0C0");this.circle.setStroke(0);this.circle.setSelectable(false);this.circle.snapToGeometry=true;this.circle.addFigure(this.fill,new draw2d.layout.locator.CenterLocator(this.circle));this.canvas.addFigure(this.circle);JIRA.WorkflowDesigner.Draw2DUtilities.setCursor(this.fill,"move");this._addPort();return this.circle},_addPort:function(){var B=JIRA.WorkflowDesigner.Direction.DOWN,A;this.port=this._createPort({connectionDirection:B});A=new JIRA.WorkflowDesigner.Layout.Locator.PositionOnParentBoundsLocator({parent:this.circle,side:B,bias:0.5});this.circle.addPort(this.port,A)},getBoundingBox:function(){return this.circle.getBoundingBox()},getPorts:function(){return[this.port]},_isCurrentStatus:function(){return false},isSelected:function(){return false},render:function(){JIRA.WorkflowDesigner.BaseStatusView.prototype.render.apply(this,arguments);this._setFigurePositionFromModel(this.circle);return this}}))}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/views/InlineDialogSVGPositioner.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.InlineDialogSVGPositioner");JIRA.WorkflowDesigner.InlineDialogSVGPositioner=function(E,F,G,D){var C,A,B;C=JIRA.WorkflowDesigner.SVGUtilities.getPageBoundingBox(F.target);B=jQuery("<div/>").css({height:C.height,left:C.x,position:"absolute",top:C.y,width:C.width}).appendTo("body");A=AJS.InlineDialog.opts.calculatePositions(E,{target:B},G,D);B.remove();return A}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/views/LineEndResizeHandle.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.LineEndResizeHandle");JIRA.WorkflowDesigner.LineEndResizeHandle=draw2d.shape.basic.LineEndResizeHandle.extend({getGap:function(){if(this.owner instanceof JIRA.WorkflowDesigner.Layout.Connection.GappedConnection){return this.owner.getEndPointGapTransformation()}return{x:0,y:0}}});Cocktail.mixin(JIRA.WorkflowDesigner.LineEndResizeHandle,JIRA.WorkflowDesigner.LineResizeHandleMixin)}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/views/LineStartResizeHandle.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.LineStartResizeHandle");JIRA.WorkflowDesigner.LineStartResizeHandle=draw2d.shape.basic.LineStartResizeHandle.extend({getGap:function(){if(this.owner instanceof JIRA.WorkflowDesigner.Layout.Connection.GappedConnection){return this.owner.getStartPointGapTransformation()}return{x:0,y:0}}});Cocktail.mixin(JIRA.WorkflowDesigner.LineStartResizeHandle,JIRA.WorkflowDesigner.LineResizeHandleMixin)}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/views/properties-panel/NoSelectionPropertiesView.js' */
(function(){var A;function B(C){var D="JIRA.WorkflowDesigner.transitionTipViewCount";if(A===undefined){A=parseInt(C.getItem(D),10)||0;C.setItem(D,A+1)}return A<3}AJS.namespace("JIRA.WorkflowDesigner.PropertiesPanel.NoSelectionPropertiesView");Backbone.define("JIRA.WorkflowDesigner.PropertiesPanel.NoSelectionPropertiesView",JIRA.WorkflowDesigner.PropertiesPanel.PropertiesView.extend({initialize:function(C){JIRA.WorkflowDesigner.PropertiesPanel.PropertiesView.prototype.initialize.apply(this,arguments);this._localStorage=C.localStorage||localStorage},_getTemplate:function(){return JIRA.WorkflowDesigner.Templates.PropertiesPanel.noSelection},_getTemplateData:function(){return _.extend(this._workflowModel.toJSON(),{showTransitionTip:B(this._localStorage)})}},{_resetTransitionTip:function(){A=undefined}}))}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/views/properties-panel/PropertiesPanelView.js' */
(function(){function B(C){return C instanceof JIRA.WorkflowDesigner.StatusView}function A(C){return C instanceof JIRA.WorkflowDesigner.GlobalTransitionView||C instanceof JIRA.WorkflowDesigner.TransitionView}AJS.namespace("JIRA.WorkflowDesigner.PropertiesPanel.PropertiesPanelView");Backbone.define("JIRA.WorkflowDesigner.PropertiesPanel.PropertiesPanelView",Backbone.View.extend({className:"properties-panel",initialize:function(C){jQuery(C.container).prepend(this.el);this.model.on("change:selectedView",this.render,this)},_getViewClass:function(D){var E=JIRA.WorkflowDesigner.PropertiesPanel.NoSelectionPropertiesView,F;function C(G){return G[0](D)}F=_.find(this._getViewClassMap(),C)||[];return F[1]||E},_getViewClassMap:function(){return this._viewMap||(this._viewMap=[[B,JIRA.WorkflowDesigner.PropertiesPanel.StatusPropertiesView],[A,JIRA.WorkflowDesigner.PropertiesPanel.TransitionPropertiesView]])},render:function(){var C=this.model.get("selectedView"),D=this._getViewClass(C);this._propertiesView&&this._propertiesView.remove();this._propertiesView=new D({selectedView:C,workflowModel:this.model});this.$el.empty().append(this._propertiesView.render().el);this._propertiesView.applyDescriptionExpander();return this}}))}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/views/properties-panel/StatusPropertiesView.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.PropertiesPanel.StatusPropertiesView");Backbone.define("JIRA.WorkflowDesigner.PropertiesPanel.StatusPropertiesView",JIRA.WorkflowDesigner.PropertiesPanel.PropertiesView.extend({events:{"click .delete":"_destroy","click .create-global-transition":"_createGlobalTransition","click .edit":"_edit"},_createGlobalTransition:function(){new JIRA.WorkflowDesigner.Dialogs.CreateGlobalTransitionDialogView({workflowModel:this._workflowModel,statusModel:this._selectedView.model}).show()},_getTemplate:function(){return JIRA.WorkflowDesigner.Templates.PropertiesPanel.status},_getTemplateData:function(){return _.extend(JIRA.WorkflowDesigner.PropertiesPanel.PropertiesView.prototype._getTemplateData.apply(this),{workflowName:JIRA.WorkflowDesigner.BrowserUtilities.escapeQueryParameter(this._workflowModel.get("name")),isDraft:this._workflowModel.get("draft"),hasGlobalTransition:this._workflowModel.statusHasGlobalTransition(this._selectedView.model)})},render:function(){var A=JIRA.WorkflowDesigner.PropertiesPanel.PropertiesView.prototype.render.apply(this,arguments);this.$(".icon-help").tooltip({gravity:"ne"});return A}}))}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/views/properties-panel/TransitionPropertiesView.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.PropertiesPanel.TransitionPropertiesView");Backbone.define("JIRA.WorkflowDesigner.PropertiesPanel.TransitionPropertiesView",JIRA.WorkflowDesigner.PropertiesPanel.PropertiesView.extend({events:{"click .delete":"_destroy","click .edit":"_edit"},_getQueryString:function(){var C=this._selectedView.model.isInitial(),A=this._selectedView.model.isGlobalTransition(),B;B={workflowMode:this._workflowModel.get("draft")?"draft":"live",workflowName:this._workflowModel.get("name"),workflowTransition:this._selectedView.model.get("actionId")};if(!C&&!A){B.workflowStep=this._selectedView.model.getSourceStepId()}return JIRA.WorkflowDesigner.BrowserUtilities.makeQueryString(B)},_getTemplate:function(){return JIRA.WorkflowDesigner.Templates.PropertiesPanel.transition},_getTemplateData:function(){var B=JIRA.WorkflowDesigner.PropertiesPanel.PropertiesView,A=B.prototype._getTemplateData.apply(this);return _.extend(A,{isInitial:this._selectedView.model.isInitial(),queryString:this._getQueryString()})}}))}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/views/StatusPort.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.StatusPort");JIRA.WorkflowDesigner.StatusPort=draw2d.HybridPort.extend({RADIUS:8,STROKE_WIDTH:1,init:function(A){this._super();_.bindAll(this);this.connectionDirection=A.connectionDirection;this.canvas=A.canvas;this.isPortDragged=A.isPortDragged;this.getAllTargetPorts=A.getAllTargetPorts;this.getSiblingPorts=A.getSiblingPorts;this.lighterBgColor=this.bgColor.hash();this.setBackgroundColor("#ffffff");this.setColor("#1a8cff");this.setCoronaWidth(6);this.setDimension(this.RADIUS,this.RADIUS);this.setStroke(this.STROKE_WIDTH);this.creatingTransition=false;this.hide();this._resetEditPolicies();this.installEditPolicy(new JIRA.WorkflowDesigner.Policy.Feedback.StatusPortsFeedbackPolicy())},_resetEditPolicies:function(){var A=this;this.editPolicy.each(function(B,C){C.onUninstall(A)});this.editPolicy=new draw2d.util.ArrayList()},getConnectionDirection:function(){return this.connectionDirection},getDropTarget:function(A,F){var E=new draw2d.geo.Point(A,F),C;function B(G){return G.hitTest(E.x,E.y)}function D(G){return G.getAbsolutePosition().getDistance(E)}C=_.chain(this.getDropTargets().asArray()).filter(B).min(D).value();return C instanceof draw2d.Port?C:null},getDropTargets:function(){var A;if(this.creatingTransition){A=_.without(this.getAllTargetPorts(),this)}else{A=this.getSiblingPorts()}return new draw2d.util.ArrayList(A).trimToSize()},onMouseEnter:function(A){this.trigger("mouse:enter",A)},onMouseLeave:function(A){this.trigger("mouse:leave",A)},onDragStart:function(){this.creatingTransition=true;this.triggerDragStart();this.trigger("select");this._super()},onDragEnd:function(){this._super();this.creatingTransition=false;this.triggerDragEnd()},triggerDragStart:function(){this.trigger("drag:start")},triggerDragEnd:function(){this.trigger("drag:end")},hitTest:function(B,H){if(this.isPortDragged()){return this._super(B,H)}var E=this.getAbsoluteX();var C=this.getAbsoluteY();var D=E-this.getWidth()/2;var A=C-this.getHeight()/2;var G=E+this.getWidth()/2;var F=C+this.getHeight()/2;return(B>=D&&B<=G&&H>=A&&H<=F)},show:function(){this.sendToFront().setVisible(true)},hide:function(){this.setVisible(false)},repaint:function(){this._super.apply(this,arguments);this._setCursor(this)},setGlow:function(A){var B="#3b7fc4";this._super(A);if(A){this.corona.setBackgroundColor(B);this.corona.setColor(B);this.corona.shape.attr("opacity",0.45);this._setCursor(this.corona);this.sendToFront();this.setStroke(0)}else{this.setStroke(this.STROKE_WIDTH)}},_setCursor:function(A){JIRA.WorkflowDesigner.Draw2DUtilities.setCursor(A,"crosshair")}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/views/StatusPositioner.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.StatusPositioner");JIRA.WorkflowDesigner.StatusPositioner={positionStatuses:function(G,F){var H,E;H=new draw2d.geo.Point(F.getCenter().getX(),F.getY()+F.getHeight()*0.2);function D(J){var I=_.sum(_.map(J,B));E=H.getY()-I/2}function C(I){I.setPosition(H.getX()-I.getBoundingBox().getWidth()/2,E);E+=B(I)}_.chain(G).reject(A).tap(D).each(C)}};function B(C){return C.getBoundingBox().getHeight()}function A(C){return C.model.hasCoordinates()}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/views/StatusView.js' */
(function(){Backbone.define("JIRA.WorkflowDesigner.StatusView",JIRA.WorkflowDesigner.BaseStatusView.extend({_calculateWidth:function(){return Math.max(60,this.label.getBoundingBox().getWidth()+40)},_createFigure:function(){var C=this._getEdgeAndTextColor(),B=this._getFillAndOutlineColor(),A;this.highlightRegion=new draw2d.shape.basic.Rectangle();this.highlightRegion.setAlpha(0);this.highlightRegion.onMouseEnter=this._onMouseEnter;this.highlightRegion.onMouseLeave=this._onMouseLeave;this.immutable||(this.highlightRegion.onDoubleClick=this.edit);this.selectedOutline=new draw2d.shape.basic.Rectangle();this.selectedOutline.setColor("#1a8cff");this.selectedOutline.setRadius(4);this.selectedOutline.setStroke(2);this.selectedOutline.setVisible(false);this.edge=new draw2d.shape.basic.Rectangle();this.edge.setBackgroundColor(C);this.edge.setRadius(4);this.edge.setStroke(0);this.fill=new draw2d.shape.basic.Rectangle();this.fill.setBackgroundColor(B);this.fill.setRadius(3);this.fill.setStroke(0);this.label=new draw2d.shape.basic.Label();this.label.setBold(true);this.label.setFontColor(C);this.label.setFontFamily("Arial");this.label.setFontSize(11);this.label.setStroke(0);this.outline=new draw2d.shape.basic.Rectangle();this.outline.setBackgroundColor(B);this.outline.setRadius(3);this.outline.setStroke(0);this.container=new draw2d.shape.basic.Rectangle();A=new draw2d.layout.locator.CenterLocator(this.container);this.container.addFigure(this.highlightRegion,A);this.container.addFigure(this.edge,A);this.container.addFigure(this.outline,A);this.container.addFigure(this.selectedOutline,A);this.container.addFigure(this.fill,A);this.container.addFigure(this.label,A);this.container.setAlpha(0);this.container.installEditPolicy(new draw2d.policy.figure.SelectionFeedbackPolicy());this._setFigurePositionFromModel(this.container);this.container.setSelectable(!this.immutable);this.container.setStroke(0);this.container.snapToGeometry=true;this.container.setDeleteable(false);this.container.setSelectable(!this.immutable);this.container.attachMoveListener({onOtherFigureIsMoving:_.throttle(_.bind(this.trigger,this,"move"),25)});this.canvas.addFigure(this.container);this._createPorts();this.selectedOutline.shape.attr("fill-opacity","0");this._setCursor(this.highlightRegion);this._setCursor(this.selectedOutline);this._setCursor(this.edge);this._setCursor(this.fill);this._setCursor(this.label);return this.container},_deselect:function(){this.selectedOutline.setVisible(false);this.trigger("deselected",this);this.selected=false;this.unhighlight()},destroy:function(){new JIRA.WorkflowDesigner.Dialogs.DeleteStatusDialogView({statusModel:this.model,workflowModel:this.workflowModel}).show()},edit:function(){new JIRA.WorkflowDesigner.Dialogs.EditStatusDialogView({statusModel:this.model,workflowModel:this.workflowModel}).show()},_getEdgeAndTextColor:function(){if(this._shouldRenderSubtleMode()&&!this._isCurrentStatus()){return"#4a6785"}else{return"#ffffff"}},_getFigure:function(){return this.container},_getFillAndOutlineColor:function(){if(this._shouldRenderSubtleMode()&&!this._isCurrentStatus()){return"#ffffff"}else{return"#4a6785"}},_isCurrentStatus:function(){var A=this.model.get("stepId")===this.workflowModel.get("currentStepId"),B=this.model.get("initial");return A&&!B},_shouldRenderSubtleMode:function(){return this.workflowModel.has("currentStepId")},_select:function(){this._highlight();this.selected=true;this.selectedOutline.setVisible(true);this.trigger("selected",this)},_setCursor:function(A){JIRA.WorkflowDesigner.Draw2DUtilities.setCursor(A,"move")},_onMouseEnter:function(A){this._isThisStatusHighlightTarget(A)||this.highlight()},_onMouseLeave:function(A){this._isThisStatusHighlightTarget(A)||this.unhighlight()},_isThisStatusHighlightTarget:function(A){return A&&(this.highlightRegion===A||_.contains(this.ports,A))},_highlight:function(){JIRA.WorkflowDesigner.BaseStatusView.prototype._highlight.apply(this);this._showAllPorts()},_unhighlight:function(){if(!this.selected){this._hideAllPorts();JIRA.WorkflowDesigner.BaseStatusView.prototype._unhighlight.apply(this)}},_showAllPorts:function(){this.immutable||_.invoke(this.getPorts(),"show")},_hideAllPorts:function(){this.immutable||_.invoke(this.getPorts(),"hide")},_addPort:function(D,E){var B=this,A,C;C=this._createPort({connectionDirection:E});A=new JIRA.WorkflowDesigner.Layout.Locator.PositionOnParentBoundsLocator({parent:this.outline,side:E,bias:D});this.outline.addPort(C,A);C.bind("mouse:enter",function(G,F){B._onMouseEnter(F)});C.bind("mouse:leave",function(F,G){B._onMouseLeave(G)});C.bind("drag:start",this._portStatusDragStart);C.bind("drag:end",this._portStatusDragEnd);C.bind("select",this.select);return C},_portStatusDragStart:function(){this.trigger("port:drag:start")},_portStatusDragEnd:function(){this.trigger("port:drag:end")},_createPorts:function(){var A=JIRA.WorkflowDesigner.Direction;this.ports=[this._addPort(0.22,A.UP),this._addPort(0.5,A.UP),this._addPort(0.78,A.UP),this._addPort(0.5,A.RIGHT),this._addPort(0.78,A.DOWN),this._addPort(0.5,A.DOWN),this._addPort(0.22,A.DOWN),this._addPort(0.5,A.LEFT)]},getBoundingBox:function(){return this.container.getBoundingBox()},getPorts:function(){return this.ports},_positionContainer:function(){if(this.model.hasCoordinates()){this.container.setPosition(this.model.get("x"),this.model.get("y"))}},updatePortsVisibility:function(){_.invoke(this.getPorts(),this.selected?"show":"hide")},render:function(){JIRA.WorkflowDesigner.BaseStatusView.prototype.render.apply(this,arguments);this.label.setText(this.model.get("name").toUpperCase());this._setSize(this._calculateWidth(),30);this._positionContainer();return this},_setSize:function(C,A){var B=(this._shouldRenderSubtleMode()&&!this._isCurrentStatus())?2:0;this.container.setDimension(C,A);this.highlightRegion.setDimension(C+12,A+12);this.selectedOutline.setDimension(C+1,A+1);this.edge.setDimension(C-B,A-B);this.fill.setDimension(C-2-B,A-2-B);this.outline.setDimension(C-2-B,A-2-B)}}));Cocktail.mixin(JIRA.WorkflowDesigner.StatusView,JIRA.WorkflowDesigner.SelectableFigureMixin)}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/views/transitions/TransitionConnection.js' */
(function(){var A="#707070",D=30,C="#cccccc",E="#ffffff",F="#1a8cff",B="#f5f5f5";AJS.namespace("JIRA.WorkflowDesigner.TransitionConnection");JIRA.WorkflowDesigner.TransitionConnection=JIRA.WorkflowDesigner.Layout.Connection.GappedConnection.extend({init:function(G){var I,H;_.bindAll(this,"_onDoubleClick","_onMouseEnter","_onMouseLeave");this._isInitialTransition=G;if(G){this._super(0,3)}else{this._super(3,3)}I=new draw2d.decoration.connection.ArrowDecorator();I.onDoubleClick=this._onDoubleClick;I.setBackgroundColor(C);I.setColor(C);I.setDimension(7,7);H=this._label=new draw2d.shape.basic.Label();H.onDoubleClick=this._onDoubleClick;H.onMouseEnter=this._onMouseEnter;H.onMouseLeave=this._onMouseLeave;H.setBackgroundColor(E);H.setColor("#cccccc");H.setBold(true);H.setDraggable(false);H.setFontColor("#333333");H.setFontFamily("Arial");H.setFontSize(11);H.setPadding(2);H.setParent(this);H.setRadius(3);H.setSelectable(false);H.setStroke(0);this.setColor(C);this.setCoronaWidth(6);this.setDeleteable(false);this.setResizeable(false);this.setRouter(new JIRA.WorkflowDesigner.Layout.Connection.RoundedManhattanConnectionRouter());this.setStroke(1);this.setTargetDecorator(I)},highlight:function(){this.sendToFront();this.setColor(A);this.targetDecoratorNode.attr({fill:A,stroke:A}).insertAfter(this.shape)},_onDoubleClick:function(){this.onDoubleClick.apply(this,arguments)},_onMouseEnter:function(){this.onMouseEnter.apply(this,arguments)},_onMouseLeave:function(){this.onMouseLeave.apply(this,arguments)},_positionLabel:function(){this._labelLocator||(this._labelLocator=new draw2d.layout.locator.PolylineMidpointLocator(this));this._labelLocator.relocate(0,this._label)},select:function(){var G;this._super.apply(this,arguments);this.sendToFront();this.setColor(F);this.targetDecoratorNode.attr({fill:"#ffffff",stroke:F}).insertAfter(this.shape);this._label.setBackgroundColor(B).setStroke(1);G=this.selectionHandles.get(0);this._isInitialTransition&&G.hide();G.sendToFront();this.selectionHandles.get(0).sendActionableAreaToFront();this.selectionHandles.get(1).sendActionableAreaToFront();return this},setCanvas:function(G){var H=G!==null,I=G===null;if(H){G.addFigure(this._label)}else{if(I){this.canvas.removeFigure(this._label)}}this._super(G)},setText:function(G){this._label.setText(this._truncate(G));this._positionLabel()},_truncate:function(H){var G=this._getEllipsis();if(!H||H.length<=D){return H}return H.substring(0,D-G.length)+G},_getEllipsis:function(){return "\u2026"},setTextVisible:function(G){this._label.sendToFront().setVisible(G);this._positionLabel()},setSource:function(G){this._super(G);this._positionLabel()},setTarget:function(G){this._super(G);this._positionLabel()},textIsVisible:function(){return this._label.isVisible()},unhighlight:function(){this.sendToBack();this.setColor(C);this.targetDecoratorNode.attr({fill:C,stroke:C}).insertAfter(this.shape)},unselect:function(){this._super.apply(this,arguments);this.unhighlight();this._label.setBackgroundColor(E).setStroke(0);return this}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/views/transitions/TransitionView.js' */
(function(){Backbone.define("JIRA.WorkflowDesigner.TransitionView",Backbone.View.extend({initialize:function(A){this.canvas=A.canvas;this._immutable=A.immutable;this._views=new JIRA.WorkflowDesigner.Collection();this._views.reset([A.sourceView,A.targetView]);this._workflowModel=A.workflowModel;this.model.on("change:name",this.render,this);this._views.on("drag",this._onStatusDrag,this);this._views.on("dragEnd",this._onStatusDragEnd,this);this._views.on("highlight",this._highlight,this);this._views.on("unhighlight",this._unhighlight,this);this._workflowModel.on("change:showTransitionLabels",this._setTextVisibility,this)},_createConnection:function(){var A;A=new JIRA.WorkflowDesigner.TransitionConnection(this.isInitialTransition());A.onMouseEnter=_.bind(this._onMouseEnter,this);A.onMouseLeave=_.bind(this._onMouseLeave,this);A.onReconnect=_.bind(this.trigger,this,"reconnect",this);A.setSelectable(!this._immutable);if(!this._immutable){A.installEditPolicy(new JIRA.WorkflowDesigner.Policy.Feedback.LineSelectionFeedbackPolicy());A.onDoubleClick=_.bind(this.edit,this)}this.canvas.addFigure(A);this._connection=A;this._setConnectionPorts();this._setTextVisibility()},_deselect:function(){this._unhighlight();this.trigger("deselected",this)},destroy:function(){new JIRA.WorkflowDesigner.Dialogs.DeleteTransitionDialogView({transitionModel:this.model,workflowModel:this._workflowModel}).show()},edit:function(){new JIRA.WorkflowDesigner.Dialogs.EditTransitionDialogView({transitionModel:this.model,workflowModel:this._workflowModel}).show()},getConnection:function(){return this._connection},_getFigure:function(){return this._connection},_getSourceAngle:function(){var B=this._getSourceView()===this._getTargetView(),A=this.model.get("sourceAngle");if(_.isNumber(A)){return A}else{if(B){return -90}else{return this._getSourceView().getAngleToStatus(this._getTargetView())}}},_getSourceView:function(){return this._views.at(0)},_getTargetAngle:function(){var B=this._getSourceView()===this._getTargetView(),A=this.model.get("targetAngle");if(_.isNumber(A)){return A}else{if(B){return 0}else{return this._getTargetView().getAngleToStatus(this._getSourceView())}}},_getTargetView:function(){return this._views.at(1)},_highlight:function(){this._highlighted=true;this.isSelected()||this._connection.highlight();this.render()},isHighlighted:function(){return this._highlighted},isInitialTransition:function(){return this.model.get("source").get("initial")},_onMouseEnter:function(){var B=JIRA.WorkflowDesigner.Constants.HIGHLIGHT_DELAY,A=this;clearTimeout(this._highlightIntervalId);this._highlightIntervalId=setTimeout(function(){A._highlight()},B)},_onMouseLeave:function(){clearTimeout(this._highlightIntervalId);this._unhighlight()},_onStatusDragEnd:function(){this._connection.setTextVisible(true)},_onStatusDrag:function(){this._connection.setTextVisible(false)},remove:function(){Backbone.View.prototype.remove.apply(this,arguments);this.canvas.removeFigure(this._connection);this._views.off("drag",this._onStatusDrag);this._views.off("dragEnd",this._onStatusDragEnd);this._views.off("highlight",this._highlight);this._views.off("unhighlight",this._unhighlight)},render:function(){this._connection||this._createConnection();this._connection.setText(this.model.get("name"));this._setTextVisibility();return this},_select:function(){this._connection.select();this._highlight();this.trigger("selected",this)},_setConnectionPorts:function(){var A=this._getSourceView().getPortForAngle(this._getSourceAngle()),B=this._getTargetView().getPortForAngle(this._getTargetAngle());this._connection.setSource(A);this._connection.setTarget(B);this.model.set({sourceAngle:this._getSourceView().getAngleToPort(A),targetAngle:this._getTargetView().getAngleToPort(B)})},_setTextVisibility:function(){var C=!!this.model.get("name"),A=this._workflowModel.get("showTransitionLabels"),B=C&&(A||this.isHighlighted()||this.isSelected());this._connection.setTextVisible(this.isInitialTransition()||B)},setViews:function(A,B){this._views.reset([A,B])},_unhighlight:function(){var A=_.some(this._views.invoke("isSelected"));if(this.isSelected()||A){return }this._connection.unhighlight();this._highlighted=false;this.render()}}));Cocktail.mixin(JIRA.WorkflowDesigner.TransitionView,JIRA.WorkflowDesigner.SelectableFigureMixin)}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'js/views/TriangleFigure.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.TriangleFigure");JIRA.WorkflowDesigner.TriangleFigure=draw2d.VectorFigure.extend({repaint:function(A){var B;if(this.shape===null){return }B=["M",this.getAbsoluteX(),this.getAbsoluteY()+this.getHeight()/2,"l",this.getWidth(),-(this.getHeight()/2),"l",0,this.getHeight(),"Z"].join(" ");this._super(_.extend({},A,{path:B}))},createShapeElement:function(){return this.canvas.paper.path("")}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'soy/WorkflowDesigner.soy' */
// This file was automatically generated from WorkflowDesigner.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.WorkflowDesigner == 'undefined') { JIRA.WorkflowDesigner = {}; }
if (typeof JIRA.WorkflowDesigner.Templates == 'undefined') { JIRA.WorkflowDesigner.Templates = {}; }


JIRA.WorkflowDesigner.Templates.actions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param3 = new soy.StringBuilder();
  if (! opt_data.immutable) {
    var param6 = new soy.StringBuilder();
    aui.buttons.button({extraClasses: 'add-status', iconClass: 'aui-icon-small aui-iconfont-add', iconText: "Add existing status", iconType: 'aui', text: "Add existing status"}, param6);
    aui.buttons.button({extraClasses: 'create-status', iconClass: 'aui-icon-small aui-iconfont-add', iconText: "Create new status", iconType: 'aui', text: "Create new status"}, param6);
    aui.form.checkboxField({extraClasses: 'show-transition-labels', fields: [{'id': 'show-transition-labels', 'isChecked': opt_data.showTransitionLabels, 'labelText': "Show transition labels"}], legendContent: ''}, param6);
    aui.toolbar2.item({content: param6.toString(), item: 'primary'}, param3);
  }
  if (opt_data.fullScreenButton) {
    var param27 = new soy.StringBuilder();
    aui.buttons.button({extraClasses: 'enter-full-screen full-screen-trigger', iconClass: 'aui-icon-small', iconType: 'aui', text: '', extraAttributes: {'title': "Enter full screen"}}, param27);
    aui.buttons.button({extraClasses: 'exit-full-screen full-screen-trigger hidden', iconClass: 'aui-icon-small', iconType: 'aui', text: '', extraAttributes: {'title': "Exit full screen"}}, param27);
    aui.toolbar2.item({content: param27.toString(), item: 'secondary'}, param3);
  }
  aui.toolbar2.toolbar2({content: param3.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.addStatusDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var hasStatuses__soy44 = opt_data.statuses.length > 0;
  output.append('<div class="aui-dialog-content">');
  var param47 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml("Add Status"), '</h2><div class="form-body">');
  var statusList51 = opt_data.statuses;
  var statusListLen51 = statusList51.length;
  if (statusListLen51 > 0) {
    for (var statusIndex51 = 0; statusIndex51 < statusListLen51; statusIndex51++) {
      var statusData51 = statusList51[statusIndex51];
      JIRA.WorkflowDesigner.Templates.addStatusDialogStatus(soy.$$augmentData(statusData51, {isSelected: statusIndex51 == 0}), param47);
    }
  } else {
    param47.append('<div class="no-statuses-message">', soy.$$escapeHtml("There are no statuses that can be added to this workflow."), '</div>');
  }
  param47.append('</div><div class="buttons-container form-footer">', (hasStatuses__soy44) ? '<div class="checkbox buttons-container-left"><input class="checkbox" id="create-global-transition" type="checkbox"><label for="create-global-transition">' + soy.$$escapeHtml("Add global transition to status") + '</label></div>' : '', '<div class="buttons">');
  if (hasStatuses__soy44) {
    aui.form.submit({extraClasses: 'aui-button aui-button-primary', text: "Add"}, param47);
  }
  aui.form.linkButton({text: "Cancel"}, param47);
  param47.append('</div></div>');
  aui.form.form({action: '', content: param47.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.addStatusDialogStatus = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div unselectable="on" class="', (opt_data.isSelected) ? 'selected' : '', ' status" data-id="', soy.$$escapeHtml(opt_data.id), '"><img unselectable="on" src="', soy.$$escapeHtml(opt_data.iconURL), '"/><div unselectable="on"><strong unselectable="on">', soy.$$escapeHtml(opt_data.name), '</strong>', (opt_data.description) ? soy.$$escapeHtml(opt_data.description) : '', '</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.cannotDeleteInitialTransition = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content">');
  var param95 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml("Read-Only"), '</h2><div class="form-body"><p>', soy.$$escapeHtml(AJS.format("The initial transition cannot be deleted.",opt_data.transitionName)), '</p></div><div class="buttons-container form-footer"><div class="buttons">');
  aui.form.linkButton({id: 'cancel', text: "Cancel"}, param95);
  param95.append('</div></div>');
  aui.form.form({action: '', content: param95.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.confirmDeleteTransition = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content">');
  var param110 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml("Confirm Delete"), '</h2><div class="form-body"><p>', soy.$$escapeHtml(AJS.format("Are you sure you want to delete the transition \x27\x27{0}\x27\x27?",opt_data.transitionName)), '</p></div><div class="buttons-container form-footer"><div class="buttons">');
  aui.form.submit({extraClasses: 'aui-button aui-button-primary', text: "Delete"}, param110);
  aui.form.linkButton({id: 'cancel', text: "Cancel"}, param110);
  param110.append('</div></div>');
  aui.form.form({action: '', content: param110.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.createGlobalTransitionDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content">');
  var param128 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml("Add Global Transition"), '</h2><div class="form-body">');
  aui.form.textField({id: 'global-transition-name', isRequired: true, labelContent: "Name"}, param128);
  aui.form.textareaField({id: 'global-transition-description', labelContent: "Description"}, param128);
  aui.form.selectField({id: 'global-transition-screen-id', isMultiple: false, options: opt_data.screens, isRequired: false, labelContent: "Transition screen"}, param128);
  param128.append('</div><div class="buttons-container form-footer"><div class="buttons">');
  aui.form.submit({extraClasses: 'aui-button aui-button-primary', text: "Create"}, param128);
  aui.form.linkButton({text: "Cancel"}, param128);
  param128.append('</div></div>');
  aui.form.form({action: '', content: param128.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.statusDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var submitText__soy155 = new soy.StringBuilder((opt_data.statusId) ? soy.$$escapeHtml("Save") : soy.$$escapeHtml("Create"));
  submitText__soy155 = submitText__soy155.toString();
  var title__soy161 = new soy.StringBuilder((opt_data.statusId) ? soy.$$escapeHtml("Edit Status") : soy.$$escapeHtml("Create New Status"));
  title__soy161 = title__soy161.toString();
  output.append('<div class="aui-dialog-content">');
  var param169 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml(title__soy161), '</h2><div class="form-body">');
  aui.form.textField({id: 'status-name', isRequired: true, labelContent: "Name", name: 'name', value: opt_data.name}, param169);
  aui.form.textareaField({id: 'status-description', labelContent: "Description", name: 'description', value: opt_data.description}, param169);
  param169.append('</div><div class="buttons-container form-footer">', (! opt_data.statusId) ? '<div class="checkbox buttons-container-left"><input class="checkbox" id="create-global-transition" type="checkbox"><label for="create-global-transition">' + soy.$$escapeHtml("Add global transition to status") + '</label></div>' : '', '<div class="buttons">');
  aui.form.submit({extraClasses: 'aui-button aui-button-primary', text: submitText__soy155}, param169);
  aui.form.linkButton({id: 'cancel', text: "Cancel"}, param169);
  param169.append('</div></div>');
  aui.form.form({action: '', content: param169.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.globalTransitionDialogContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<strong>', soy.$$escapeHtml(opt_data.name), '</strong><p>', soy.$$escapeHtml(AJS.format("All statuses can transition to \x27\x27{0}\x27\x27.",opt_data.statusName)), '</p>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.transitionDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var submitText__soy207 = new soy.StringBuilder((opt_data.actionId) ? soy.$$escapeHtml("Save") : soy.$$escapeHtml("Add"));
  submitText__soy207 = submitText__soy207.toString();
  var title__soy213 = new soy.StringBuilder((opt_data.actionId) ? (opt_data.globalTransition) ? soy.$$escapeHtml("Edit Global Transition") : soy.$$escapeHtml("Edit Transition") : (opt_data.globalTransition) ? soy.$$escapeHtml("Add Global Transition") : soy.$$escapeHtml("Add Transition"));
  title__soy213 = title__soy213.toString();
  output.append('<div class="aui-dialog-content">');
  var param229 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml(title__soy213), '</h2><div class="form-body">');
  aui.form.textField({id: 'transition-name', isRequired: true, labelContent: "Name", name: 'name', value: opt_data.name}, param229);
  aui.form.textareaField({id: 'transition-description', labelContent: "Description", name: 'description', value: opt_data.description}, param229);
  aui.form.selectField({id: 'transition-screen-id', isMultiple: false, isRequired: false, labelContent: "Transition screen", options: opt_data.screens}, param229);
  param229.append('</div><div class="buttons-container form-footer"><div class="buttons">');
  aui.form.submit({extraClasses: 'aui-button aui-button-primary', text: submitText__soy207}, param229);
  aui.form.linkButton({id: 'cancel', text: "Cancel"}, param229);
  param229.append('</div></div>');
  aui.form.form({action: '', content: param229.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.confirmDeleteStatus = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content">');
  var param263 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml("Confirm Remove Status"), '</h2><div class="form-body"><p>', soy.$$escapeHtml(AJS.format("Are you sure you want to remove the status \x27\x27{0}\x27\x27 and delete the related transitions?",opt_data.name)), '</p></div><div class="buttons-container form-footer"><div class="buttons">');
  aui.form.submit({extraClasses: 'aui-button aui-button-primary', text: "Remove"}, param263);
  aui.form.linkButton({id: 'cancel', text: "Cancel"}, param263);
  param263.append('</div></div>');
  aui.form.form({action: '', content: param263.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.cannotDeleteInitialStatus = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content">');
  var param281 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml("Read-Only"), '</h2><div class="form-body"><p>', soy.$$escapeHtml(AJS.format("The initial status cannot be deleted.",opt_data.name)), '</p></div><div class="buttons-container form-footer"><div class="buttons">');
  aui.form.linkButton({id: 'cancel', text: "Cancel"}, param281);
  param281.append('</div></div>');
  aui.form.form({action: '', content: param281.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.cannotDeleteStatusFromActiveWorkflow = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content">');
  var param296 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml(AJS.format("The status \x27\x27{0}\x27\x27 cannot be removed.",opt_data.name)), '</h2><div class="form-body"><p>', soy.$$escapeHtml("Statuses cannot be removed from draft workflows."), '</p><p><a target="_blank" href="https://confluence.atlassian.com/display/JIRA/Configuring+Workflow#ConfiguringWorkflow-Limitationswheneditinganactiveworkflow">', soy.$$escapeHtml("More information."), '</a></p></div><div class="buttons-container form-footer"><div class="buttons">');
  aui.form.linkButton({id: 'cancel', text: "Cancel"}, param296);
  param296.append('</div></div>');
  aui.form.form({action: '', content: param296.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer', location = 'soy/PropertiesPanel.soy' */
// This file was automatically generated from PropertiesPanel.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.WorkflowDesigner == 'undefined') { JIRA.WorkflowDesigner = {}; }
if (typeof JIRA.WorkflowDesigner.Templates == 'undefined') { JIRA.WorkflowDesigner.Templates = {}; }
if (typeof JIRA.WorkflowDesigner.Templates.PropertiesPanel == 'undefined') { JIRA.WorkflowDesigner.Templates.PropertiesPanel = {}; }


JIRA.WorkflowDesigner.Templates.PropertiesPanel.description = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var id__soy3 = 'properties-panel-description';
  var param4 = new soy.StringBuilder(opt_data.content);
  aui.expander.trigger({content: '<span class="trigger-text">' + soy.$$escapeHtml("Show more") + '</span>', contentId: id__soy3, extraClasses: 'aui-expander-reveal-text', replaceSelector: '.trigger-text', replaceText: "Show less", tag: 'a'}, param4);
  aui.expander.content({content: param4.toString(), extraClasses: 'description', id: id__soy3}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.PropertiesPanel.module = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="module">', (opt_data.heading) ? '<div class="mod-header"><h4>' + soy.$$escapeHtml(opt_data.heading) + '</h4></div>' : '', '<div class="mod-content">', opt_data.content, '</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.PropertiesPanel.noSelection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param32 = new soy.StringBuilder();
  if (opt_data.showTransitionTip) {
    JIRA.WorkflowDesigner.Templates.PropertiesPanel.module({content: '<p>' + soy.$$escapeHtml("Drag a port to another status to draw a new transition line.") + '</p><div class="transition-tip-image"></div>', heading: "Getting started"}, param32);
  }
  JIRA.WorkflowDesigner.Templates.PropertiesPanel.propertiesPanel({additionalModules: param32.toString(), description: opt_data.description, titleContent: soy.$$escapeHtml(opt_data.name) + ((opt_data.draft) ? '<span id="status-lozenge-draft" class="aui-lozenge aui-lozenge-subtle status-lozenge">' + soy.$$escapeHtml("Draft") + '</span>' : '<span id="status-lozenge-inactive" class="aui-lozenge aui-lozenge-subtle status-lozenge">' + soy.$$escapeHtml("Inactive") + '</span>')}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.PropertiesPanel.optionsItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li><a class="', soy.$$escapeHtml(opt_data.classes), '" href="', soy.$$escapeHtml(opt_data.href), '">', soy.$$escapeHtml(opt_data.label), '</a>', (opt_data.count != null) ? '<span> (' + soy.$$escapeHtml(opt_data.count) + ')</span>' : '', '</li>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.PropertiesPanel.propertiesPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var hasActions__soy69 = opt_data.extraActions && opt_data.extraActions.length || opt_data.mainActions && opt_data.mainActions.length;
  var hasInformation__soy70 = opt_data.description || opt_data.informationContent && opt_data.informationContent.length;
  output.append('<h3>', opt_data.titleContent, '</h3>');
  if (hasInformation__soy70) {
    if (opt_data.description) {
      JIRA.WorkflowDesigner.Templates.PropertiesPanel.description({content: '<strong>' + soy.$$escapeHtml("Description") + '</strong> <span class="description-content">' + soy.$$escapeHtml(opt_data.description) + '</span>'}, output);
    }
    output.append((opt_data.informationContent) ? opt_data.informationContent : '');
  }
  if (hasActions__soy69) {
    JIRA.WorkflowDesigner.Templates.PropertiesPanel.module({content: ((opt_data.extraActions) ? '<div class="extra-actions">' + opt_data.extraActions + '</div>' : '') + ((opt_data.mainActions) ? '<div>' + opt_data.mainActions + '</div>' : '')}, output);
  }
  if (opt_data.options) {
    JIRA.WorkflowDesigner.Templates.PropertiesPanel.module({content: '<ul>' + opt_data.options + '</ul>', heading: "Options"}, output);
  }
  output.append((opt_data.additionalModules) ? opt_data.additionalModules : '');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.PropertiesPanel.status = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var workflowMode__soy120 = opt_data.isDraft ? 'draft' : 'live';
  var commonParameters__soy121 = 'workflowMode=' + workflowMode__soy120 + '&workflowName=' + opt_data.workflowName + '&workflowStep=' + opt_data.stepId;
  var param123 = new soy.StringBuilder();
  if (! opt_data.hasGlobalTransition) {
    aui.buttons.button({text: "Add a global transition", extraClasses: 'create-global-transition'}, param123);
    param123.append(' <span class="aui-icon icon-help" title="', soy.$$escapeHtml("Creating a global transition allows all statuses to transition to this one."), '">', soy.$$escapeHtml("Help"), '</span>');
  }
  var param134 = new soy.StringBuilder();
  aui.buttons.button({text: ' ' + "Edit", iconType: 'aui', iconClass: 'aui-icon-small aui-iconfont-edit', extraClasses: 'edit'}, param134);
  aui.buttons.button({text: "Remove status", extraClasses: 'delete aui-button-link'}, param134);
  var param143 = new soy.StringBuilder();
  JIRA.WorkflowDesigner.Templates.PropertiesPanel.optionsItem({label: "Properties", href: "" + '/secure/admin/workflows/ViewWorkflowStepMetaAttributes.jspa?' + commonParameters__soy121, classes: 'status-properties'}, param143);
  JIRA.WorkflowDesigner.Templates.PropertiesPanel.propertiesPanel({description: opt_data.description, extraActions: param123.toString(), mainActions: param134.toString(), options: param143.toString(), titleContent: soy.$$escapeHtml(opt_data.name)}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.PropertiesPanel.transition = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var viewPropertiesURL__soy152 = "" + '/secure/admin/workflows/ViewWorkflowTransitionMetaAttributes.jspa?' + opt_data.queryString;
  var viewTransitionURL__soy153 = "" + '/secure/admin/workflows/ViewWorkflowTransition.jspa?' + opt_data.queryString;
  var param163 = new soy.StringBuilder();
  aui.buttons.button({text: ' ' + "Edit", iconType: 'aui', iconClass: 'aui-icon-small aui-iconfont-edit', extraClasses: 'edit'}, param163);
  aui.buttons.button({text: "Delete transition", extraClasses: 'delete aui-button-link'}, param163);
  var param172 = new soy.StringBuilder();
  JIRA.WorkflowDesigner.Templates.PropertiesPanel.optionsItem({label: "Properties", href: viewPropertiesURL__soy152, count: opt_data.propertiesCount, classes: 'transition-properties'}, param172);
  if (! opt_data.isInitial) {
    JIRA.WorkflowDesigner.Templates.PropertiesPanel.optionsItem({label: "Conditions", href: viewTransitionURL__soy153 + '&descriptorTab=conditions', count: opt_data.conditionsCount, classes: 'transition-conditions'}, param172);
  }
  JIRA.WorkflowDesigner.Templates.PropertiesPanel.optionsItem({label: "Validators", href: viewTransitionURL__soy153 + '&descriptorTab=validators', count: opt_data.validatorsCount, classes: 'transition-validators'}, param172);
  JIRA.WorkflowDesigner.Templates.PropertiesPanel.optionsItem({label: "Post functions", href: viewTransitionURL__soy153 + '&descriptorTab=postfunctions', count: opt_data.postFunctionsCount, classes: 'transition-postfunctions'}, param172);
  JIRA.WorkflowDesigner.Templates.PropertiesPanel.propertiesPanel({description: opt_data.description, informationContent: (opt_data.screenName) ? '<p><strong>' + soy.$$escapeHtml("Transition screen") + '</strong> ' + soy.$$escapeHtml(opt_data.screenName) + '</p>' : '', mainActions: param163.toString(), options: param172.toString(), titleContent: soy.$$escapeHtml(opt_data.name)}, output);
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:dialog', location = 'js/views/dialogs/Dialog.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Dialog");JIRA.WorkflowDesigner.Dialog=JIRA.FormDialog.extend({init:function(A){_.bindAll(this);A=_.defaults({},A,{content:this.createDialogContent,isDraft:false,onContentRefresh:this._showWorkflowDesigner,widthClass:"large"});this.options=A;this.sizeAndPositionDialog=_.throttle(this._sizeAndPositionDialog,100);this._super(A);this.onContentReady(this._addLabelHint)},createDialogContent:function(A){A(JIRA.WorkflowDesigner.Templates.Dialog.workflowDialog({title:_.result(this.options,"workflowId")}))},show:function(){this._super.apply(this,arguments);jQuery(window).on("resize",this.sizeAndPositionDialog)},hide:function(){this._designer&&this._designer.destroy();this._super.apply(this,arguments);jQuery(window).off("resize",this.sizeAndPositionDialog)},_sizeAndPositionDialog:function(){var A,B;if(JIRA.Dialog.current===this){B=JIRA.WorkflowDesigner.DialogSizeCalculator.calculateDialogSize(this);this.options.width=B.width;A=this.$popup.find(".form-body");A.css({height:B.height,maxHeight:""});this._positionInCenter()}},_showWorkflowDesigner:function(){this._sizeAndPositionDialog();this._designer=new JIRA.WorkflowDesigner.Application({actions:false,element:this.get$popup().find(".form-body"),immutable:true,draft:_.result(this.options,"isDraft"),layoutData:_.result(this.options,"layoutData"),workflowId:_.result(this.options,"workflowId"),currentStepId:_.result(this.options,"currentStepId")})},_addLabelHint:function(){this.getButtonsContainer().prepend(JIRA.WorkflowDesigner.Templates.Dialog.labelMouseOverHint())}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:dialog', location = 'soy/Dialog.soy' */
// This file was automatically generated from Dialog.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.WorkflowDesigner == 'undefined') { JIRA.WorkflowDesigner = {}; }
if (typeof JIRA.WorkflowDesigner.Templates == 'undefined') { JIRA.WorkflowDesigner.Templates = {}; }
if (typeof JIRA.WorkflowDesigner.Templates.Dialog == 'undefined') { JIRA.WorkflowDesigner.Templates.Dialog = {}; }


JIRA.WorkflowDesigner.Templates.Dialog.workflowDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content"><h2 class="dialog-title">', soy.$$escapeHtml(opt_data.title), '</h2><div class="form-body"></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.Dialog.labelMouseOverHint = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="buttons-container-left"><small>', soy.$$escapeHtml("Mouse over objects to see transition names."), '</small></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:view-issue-page-workflow-designer', location = 'js/views/ViewIssue.js' */
(function(){var F,B,D,A,E,C;AJS.namespace("JIRA.WorkflowDesigner.ViewIssue");JIRA.WorkflowDesigner.ViewIssue={replaceViewWorkflowLink:function(G){var H=JIRA.WorkflowDesigner.Templates.ViewIssue.viewWorkflowLink,J,I;G=jQuery(G);J=G.find(".issueaction-viewworkflow:not(.new-workflow-designer)");I=J.attr("href");if(J.length){F=parseInt(B(I,"stepId"),10);D=null;J.replaceWith(H({href:I}));C=B(I,"workflowName")}},shouldShowNewWorkflowDesigner:function(){return !JIRA.WorkflowDesigner.BrowserUtilities.isIE8()}};JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(H,G){if(JIRA.WorkflowDesigner.ViewIssue.shouldShowNewWorkflowDesigner()){JIRA.WorkflowDesigner.ViewIssue.replaceViewWorkflowLink(G)}});B=function(H,G){var I=parseUri(H).queryKey[G];return decodeURIComponent(I.replace(/\+/g,"%20"))};A=function(){var G;if(D){return jQuery.Deferred().resolve(D).promise()}else{G=JIRA.WorkflowDesigner.IO.AJAX.WorkflowAJAXManager.load(C);G.done(function(I,H){D=H});return G}};E=new JIRA.WorkflowDesigner.Dialog({content:function(I){var G=A();var H=this;G.done(function(){H.createDialogContent(I)});G.fail(function(){JIRA.WorkflowDesigner.Messages.showErrorMessage("Couldn\'t load workflow information.",{closeable:true});E.hide(true)})},id:"view-workflow-dialog",trigger:".issueaction-viewworkflow.new-workflow-designer",workflowId:function(){return C},currentStepId:function(){return F},layoutData:function(){return JIRA.WorkflowDesigner.IO.WorkflowDataReader.read(D)}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:view-issue-page-workflow-designer', location = 'soy/ViewIssue.soy' */
// This file was automatically generated from ViewIssue.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.WorkflowDesigner == 'undefined') { JIRA.WorkflowDesigner = {}; }
if (typeof JIRA.WorkflowDesigner.Templates == 'undefined') { JIRA.WorkflowDesigner.Templates = {}; }
if (typeof JIRA.WorkflowDesigner.Templates.ViewIssue == 'undefined') { JIRA.WorkflowDesigner.Templates.ViewIssue = {}; }


JIRA.WorkflowDesigner.Templates.ViewIssue.viewWorkflowLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="issueaction-viewworkflow new-workflow-designer" href="', soy.$$escapeHtml(opt_data.href), '">', soy.$$escapeHtml("View Workflow"), '</a>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jirafisheyeplugin:css', location = 'script/fisheye.js' */
AJS.$(function(){AJS.JFEP=AJS.JFEP||{};var a=function(b){AJS.$(".review-filter",b).live("change",function(d){var f=AJS.$(d.target).val(),c=AJS.$(d.target).is(":checked")?"block":"none";AJS.$(".review-status-"+f).css("display",c)});AJS.$(".tab-content",b).find(".project-activity:gt(0)").addClass("hidden");AJS.$("#activity-filter",b).live("change",function(c){var d=AJS.$("#activity-filter").val();AJS.$(".project-activity").addClass("hidden");AJS.$(".limit-"+d).removeClass("hidden")})};AJS.$("#preview-hide-tab",AJS.$(document)).live("click",function(b){AJS.$("#preview_form").submit();b.preventDefault()});if(JIRA.ViewIssueTabs){JIRA.ViewIssueTabs.onTabReady(a)}else{a(document)}AJS.JFEP.reviewIssueToggle=function(){AJS.$(".review-issue-target").addClass("hidden");AJS.$(".review-issue-trigger").click(function(c){c.preventDefault();var b=AJS.$(this).attr("href");AJS.$(b).toggleClass("hidden")})};AJS.JFEP.ignoreCookieName=function(){var b=AJS.$("#header-details-user-fullname").attr("data-username");if(!b){b="__ANON"}return"JFEP.ignoredAppLinks."+b};AJS.JFEP.ignoreAppLink=function(f){var e;var c=document.cookie;if(c.indexOf(AJS.JFEP.ignoreCookieName()+"=")>-1){var d=new RegExp(AJS.JFEP.ignoreCookieName()+"=([^;]*)");e=d.exec(c)[1]}else{e=""}if(e.indexOf(f)==-1){e+=(e.length>0?"|":"")+f;var b=new Date();b.setDate(b.getDate()+365);document.cookie=AJS.JFEP.ignoreCookieName()+"="+e+"; expires="+b.toUTCString()+"; path="+contextPath}};AJS.JFEP.clearIgnoredAppLinks=function(){var b=new Date();b.setDate(b.getDate()-5);document.cookie=AJS.JFEP.ignoreCookieName()+"=expired;expires="+b.toUTCString()+"; path="+contextPath};AJS.$(".ignore-applink").live("click",function(){var b=AJS.$(this).attr("data-id");AJS.JFEP.ignoreAppLink(b);AJS.$(this).parents(".credentials-required-message").slideUp()});AJS.$(".clear-ignored-applinks").live("click",function(){AJS.JFEP.clearIgnoredAppLinks();document.location.reload(true)});AJS.JFEP.loadMoreChangesets=function(c,b,d,e){jQuery("#more-changesets-action-spinner").show();jQuery("#more-changesets-blurb").hide();JIRA.SmartAjax.makeRequest({url:c+"/rest/tabs/1.0/more-changesets/"+b+d,type:"GET",dataType:"json",contentType:"application/json",complete:function(i,f,h){if(!h.successful){var g=(h.status!==401||h.statusText===JIRA.SmartAjax.SmartAjaxResult.TIMEOUT)?JSON.parse(h.data).errorMessages:JIRA.SmartAjax.buildSimpleErrorContent(h);jQuery(document).trigger(JIRA.SERVER_ERROR_EVENT,g)}else{e(h.data.changesets)}}})}});
/* module-key = 'com.atlassian.jira.plugin.ext.bamboo:css', location = 'templates/plugins/bamboo/script/common.js' */
(function(b,a){if(typeof a.CONFIG==="undefined"){a.CONFIG={$planSelect:b(),$buildTypes:b(),buildResultsContainerId:"bamboo-build-results",stagesContainerId:"bamboo-plan-stages",variablesContainerId:"bamboo-override-variables",initialised:false,updateTimeout:null,init:function(){if(a.CONFIG.initialised){return}b(document).bind("dialogContentReady",function(f){var d=a.CONFIG.buildResultsContainerId,c=a.CONFIG.stagesContainerId,g=a.CONFIG.variablesContainerId;a.CONFIG.$planSelect=b("#bamboo-plan").change(a.CONFIG.onPlanChange);a.CONFIG.BuildResults.init({container:{id:d,insertAfter:a.CONFIG.$planSelect.closest(".field-group")}});a.CONFIG.Stages.init({container:{id:c,insertAfter:"#"+d}});a.CONFIG.Variables.init({container:{id:g,insertAfter:"#"+c}});a.CONFIG.$buildTypes=b("input:radio[name='buildType']").change(a.CONFIG.onBuildTypeChange).filter(":checked").change().end()});a.CONFIG.initialised=true}};a.CONFIG.Spinner=function(c,d){this.beforeShow=d;this.add=function(){return b(bamboo.components.icon({type:"loading"})).appendTo(c)}};a.CONFIG.Spinner.prototype.show=function(){var c=this.$spinner;this.beforeShow();if(!c||(c&&(!c.length||!c.parent().length))){this.$spinner=this.add()}else{c.show()}return this};a.CONFIG.Spinner.prototype.hide=function(){this.$spinner.hide();return this}}a.CONFIG.onPlanChange=function(j){var f=b("#existing-build").is(":checked"),i=b(this),d=i.add(a.CONFIG.$buildTypes).attr("disabled",true),m=i.find("option:selected"),h=(f?m.attr("data-selected-build-result"):null),n=(f?null:m.attr("data-selected-stages")),k=(f?null:m.attr("data-selected-variables")),l,g,c;if(k){k=b.parseJSON(k)}a.CONFIG.BuildResults.updateSelectedBuildResult(h);a.CONFIG.Stages.updateSelectedStages(n);a.CONFIG.Variables.updateSelectedVariables(k);a.CONFIG.Variables.hide();if(f){a.CONFIG.Stages.hide();a.CONFIG.BuildResults.showSpinner();l=a.restURL+"history/"+a.jiraProjectKey+"/"+i.val()+"/5";g={continuable:true,buildstate:"successful"};c=function(e){if(e.results.result&&e.results.result.length){a.CONFIG.BuildResults.show(e.results.result)}else{a.CONFIG.BuildResults.showNoResultsMsg()}d.attr("disabled",false)}}else{a.CONFIG.BuildResults.hide();a.CONFIG.Stages.showSpinner();l=a.restURL+"plan/"+a.jiraProjectKey+"/"+i.val();c=function(e){if(e.stages.stage&&e.stages.stage.length){a.CONFIG.Stages.show(e.stages.stage)}else{a.CONFIG.Stages.showNoStagesMsg()}if(e.variableContext.variable&&e.variableContext.variable.length){a.CONFIG.Variables.show(e.variableContext.variable)}d.attr("disabled",false)}}b.ajax({url:l,dataType:"json",data:g,beforeSend:function(){i.attr("disabled","true")},success:c,error:function(u,v){var q,t,o,p,r=b('<div class="form-body"></div><div class="form-footer"><a class="cancel">Cancel</a></div>');r.find(".cancel").click(function(w){if(a.CONFIG.FormDialog&&a.CONFIG.FormDialog.hide){a.CONFIG.FormDialog.hide()}});try{p=u.responseText||u.response;if(p){q=b.parseJSON(p);t=q.message;o=(q.messageBody?"<p>"+q.messageBody+"</p>":null);if(q.oauthCallback){r.filter(".content-footer").prepend('<a href="'+q.oauthCallback+"&amp;redirectUrl="+encodeURIComponent(a.baseURL)+'">Login &amp; Approve</a> | ')}}else{throw"noJSONResponse"}}catch(s){t="An error occurred while trying to retrieve the build information."}AJS.messages.warning(r.filter(".form-body"),{title:t,body:o,closeable:false});i.closest("form").replaceWith(r)},ajaxComplete:function(){i.attr("disabled","false")}})};a.CONFIG.onBuildTypeChange=function(g){var c=b(this),f=c.closest("fieldset.group"),d=f.nextAll(".field-group,.group"),h=b("#"+a.CONFIG.buildResultsContainerId);switch(c.val()){case"no-build":d.hide();f.css({"margin-bottom":0,"padding-bottom":0});break;case"new-build":d.show();h.hide();f.css({"margin-bottom":"","padding-bottom":""});a.CONFIG.$planSelect.change();break;case"existing-build":d.show();f.css({"margin-bottom":"","padding-bottom":""});a.CONFIG.$planSelect.change();break}};a.CONFIG.Stages=(function(){var d={container:{id:null,insertAfter:null,i18n:{legend:"Stages"}},selectedStages:null},k,j,f,g=function(){j=b("<fieldset/>",{id:k.container.id,"class":"group",html:f}).insertAfter(k.container.insertAfter).delegate("input:checkbox","click",h)},c=function(m){var l=false,v,o,x;for(o=0,x=m.length;o<x;o++){var q=m[o],r=!!(q.state&&q.state!="Unknown"),w=!!(q.manual),n=!!(!q.manual||r),p,t,u="stage-"+o,s;if(!l&&q.manual&&!r){l=true}t=b('<input type="checkbox" />').attr({name:"selectedStages",id:u,"class":"checkbox",checked:w,disabled:n}).val(q.name);s=b("<label />",{text:q.name,"for":u});p=b("<div/>",{"class":"checkbox"+(q.manual?(r?" already-run":" manual"):"")+(!l?" selected":"")}).append(t).append(s).appendTo(j);if(!r&&w){v=p}}if(v){v.find("input:checkbox").trigger("click",true)}},e=function(){j.find("div.checkbox,p").remove()},h=function(p,l){if(l){p.preventDefault()}var m=b(this),o=m.is(":checked"),n=false;m.closest("div.checkbox").toggleClass("selected",o).prevAll("div.checkbox").each(function(s){var r=b(this),t=r.children("input:checkbox"),q=r.hasClass("manual");if(o){r.addClass("selected");if(q){t.attr("checked","checked").attr("disabled","disabled")}}else{if(q&&!n){t.removeAttr("disabled");n=true}}}).end().nextAll("div.checkbox").each(function(r){var q=b(this);if(q.hasClass("manual")){return false}else{q.toggleClass("selected",o)}})},i;return{init:function(l){k=b.extend(true,d,l);f="<legend><span>"+k.container.i18n.legend+"</span></legend>";g();i=new a.CONFIG.Spinner(j,e)},show:function(l){j.html(f).show();c(l)},hide:function(){j.hide().html(f)},showNoStagesMsg:function(){i.hide();j.append(b("<p/>",{text:"No stages found."}))},showSpinner:function(){i.show()},updateSelectedStages:function(l){k.selectedStages=l}}})();a.CONFIG.Variables=(function(){var c={container:{id:null,insertAfter:null,i18n:{legend:"Build Variables"}},selectedVariables:null},l,j,k,g,h=function(){j=b("<fieldset/>",{id:l.container.id,"class":"group",html:g}).insertAfter(l.container.insertAfter).delegate("#override-another","click",i).delegate(".bamboo-icon-variable-delete","click",f).delegate("select","change",e)},d=function(r){var m,q,o,p;k=b("<select/>",{"class":"select"});for(o=0,p=r.length;o<p;o++){var n=r[o];if(m!=n.variableType){m=n.variableType;q=b("<optgroup/>",{label:m}).appendTo(k)}b("<option/>",{text:n.key,data:{"server-value":n.value}}).appendTo(q)}},i=function(){var n=k.clone(true),o,p,q,m="";if(arguments.length==2){p=n.find("option[text='"+arguments[0]+"']");m=arguments[1]}else{p=n.find("option:first")}p.attr("selected","selected");q=b('<input type="text" />').attr({name:"variable_"+p.val(),placeholder:p.data("server-value"),"class":"text medium-field"}).val(m);o=b("<div/>",{"class":"field-group"}).append(n).append(q).append(bamboo.components.icon({type:"variable-delete"})).insertBefore(j.children("a"))},f=function(m){b(this).closest(".field-group").remove()},e=function(o){var m=b(this),n=m.find("option:selected");m.nextAll(".text").attr({name:"variable_"+n.val(),placeholder:n.data("server-value")})};return{init:function(m){l=b.extend(true,c,m);g="<legend><span>"+l.container.i18n.legend+'</span></legend><a id="override-another" class="aui-button aui-button-link">Override variable<span class="icon icon-edit-sml"></span></a>';h()},show:function(m){d(m);if(l.selectedVariables&&l.selectedVariables.variables){b.each(l.selectedVariables.variables,i)}j.show()},hide:function(){j.hide().html(g)},updateSelectedVariables:function(m){l.selectedVariables=m}}})();a.CONFIG.BuildResults=(function(){var e={container:{id:null,insertAfter:null,i18n:{legend:"Existing Build"}},selectedBuildResult:null},k,j,g,h=function(){j=b("<fieldset/>",{id:k.container.id,"class":"group",html:g}).insertAfter(k.container.insertAfter).delegate("input:radio","change",f).delegate("a","click",function(l){l.preventDefault();window.open(this.href)})},d=function(p){var o,q,n="build-result-"+p.number,l,m=(p.lifeCycleState=="Finished"?(p.continuable?"SuccessfulPartial":p.state):p.lifeCycleState);q=b('<input type="radio" />').attr({name:"buildResult",id:n,"class":"radio",checked:(p.key==k.selectedBuildResult)}).val(p.key).data("stages",(p.stages.stage&&p.stages.stage.length?p.stages.stage:[]));l=b("<label />",{html:'<a href="'+a.bambooBaseURL+"/browse/"+p.key+'" class="'+m+'">#'+p.number+'</a><span class="trigger-reason">'+a.replaceWithBambooIcon(p.buildReason)+"</span>","for":n}).prepend(bamboo.components.icon({type:m}));o=b("<div/>",{"class":"radio"}).append(q).append(l).appendTo(j)},c=function(){j.find("div.radio,p").remove()},f=function(l){var m=b(this).data("stages");if(m&&m.length){a.CONFIG.Stages.show(m)}else{a.CONFIG.Stages.showNoStagesMsg()}},i;return{init:function(l){k=b.extend(true,e,l);g="<legend><span>"+k.container.i18n.legend+"</span></legend>";h();i=new a.CONFIG.Spinner(j,c)},show:function(n){j.html(g).show();for(var l=0,m=n.length;l<m;l++){d(n[l])}},hide:function(){j.hide().html(g)},showNoResultsMsg:function(){i.hide();j.append(b("<p/>",{text:"No builds found with unbuilt manual stages."})).show()},showSpinner:function(){i.show()},updateSelectedBuildResult:function(l){k.selectedBuildResult=l}}})();a.CheckReleaseBuildStatus=function(d,c){b.ajax({url:a.restURL+"status/"+a.jiraVersionId+"/"+d,dataType:"json",success:function(h){var f=h.bamboo,g=(f.lifeCycleState=="Finished"?(f.continuable?"SuccessfulPartial":f.state):f.lifeCycleState),e;if((f.lifeCycleState!="InProgress"&&f.lifeCycleState!="Queued")||(h.jira&&h.jira.forceRefresh)){AJS.reloadViaWindowLocation()}else{if(f.lifeCycleState=="InProgress"&&f.progress){if(!c){e=b("#build-details");c=b(bamboo.components.buildDetail({key:"Duration",keyClass:"duration",value:f.progress.prettyBuildTime+" &ndash; <span>"+f.progress.prettyTimeRemaining+"</span>"})).appendTo(e).find("dd");e.find(".build + dd > span.bamboo-icon").replaceWith(bamboo.components.icon({type:g}))}else{c.html(f.progress.prettyBuildTime+" &ndash; <span>"+f.progress.prettyTimeRemaining+"</span>")}}}clearTimeout(a.CONFIG.updateTimeout);a.CONFIG.updateTimeout=setTimeout(function(){a.CheckReleaseBuildStatus(d,c)},5000)},error:function(l,m){var i,k,g,h,f=b("#build-details").empty();try{h=l.responseText||l.response;if(h){i=b.parseJSON(h);k=i.message;g=(i.messageBody?"<p>"+i.messageBody+"</p>":"");if(i.oauthCallback){g+='<p><a href="'+i.oauthCallback+"&amp;redirectUrl="+encodeURIComponent(a.baseURL)+'">Login &amp; Approve</a></p>'}}else{throw"noJSONResponse"}}catch(j){k="An error occurred while trying to retrieve the build information."}AJS.messages.warning(f,{title:k,body:g,closeable:false})}})};a.ShowBuildReleaseDetails=function(e){var d=b("#build-details"),c=b(bamboo.components.icon({type:"loading"}));if(d.length){c.appendTo(d);b.ajax({url:a.restURL+"status/"+a.jiraVersionId+"/"+e,dataType:"json",success:function(i){var f=i.bamboo,g=(f.lifeCycleState=="Finished"?(f.continuable?"SuccessfulPartial":f.state):f.lifeCycleState),h;if(i.jira&&i.jira.forceRefresh){AJS.reloadViaWindowLocation()}c.remove();d.append(bamboo.components.buildDetail({key:"Build",keyClass:"build",value:bamboo.components.icon({type:g})+' <a href="'+a.bambooBaseURL+"/browse/"+e+'"><span class="'+g+'">#'+f.number+"</span> "+f.planName+"</a>"}));d.append(bamboo.components.buildDetail({key:"Trigger",keyClass:"trigger",value:a.replaceWithBambooIcon(f.buildReason)}));if(f.vcsRevisionKey){d.append(bamboo.components.buildDetail({key:"Revision",keyClass:"revision",value:f.vcsRevisionKey}))}if(f.labels.label&&f.labels.label.length){d.append(bamboo.components.buildDetail({key:"Labels",keyClass:"labels",value:bamboo.components.labels({baseBambooUrl:a.bambooBaseURL,labels:f.labels.label})}))}if(f.lifeCycleState=="InProgress"||f.lifeCycleState=="Queued"){if(f.lifeCycleState=="InProgress"&&f.progress){h=b(bamboo.components.buildDetail({key:"Duration",keyClass:"duration",value:f.progress.prettyBuildTime+" &ndash; <span>"+f.progress.prettyTimeRemaining+"</span>"})).appendTo(d).find("dd")}clearTimeout(a.CONFIG.updateTimeout);a.CONFIG.updateTimeout=setTimeout(function(){a.CheckReleaseBuildStatus(e,h)},5000)}else{if(f.lifeCycleState=="Finished"){if(f.buildCompletedTime){d.append(bamboo.components.buildDetail({key:"Completed",keyClass:"completed",value:'<time datetime="'+f.buildCompletedTime+'">'+f.prettyBuildCompletedTime+" &ndash; <span>"+f.buildRelativeTime+"</span></time>"}))}if(f.buildDuration){d.append(bamboo.components.buildDetail({key:"Duration",keyClass:"duration",value:f.buildDurationDescription}))}}else{if(f.lifeCycleState=="NotBuilt"){if(f.buildStartedTime){d.append(bamboo.components.buildDetail({key:"Started",keyClass:"started",value:'<time datetime="'+f.buildStartedTime+'">'+f.prettyBuildStartedTime+"</time>"}))}if(f.buildCompletedTime){d.append(bamboo.components.buildDetail({key:"Completed",keyClass:"completed",value:'<time datetime="'+f.buildCompletedTime+'">'+f.prettyBuildCompletedTime+" &ndash; <span>"+f.buildRelativeTime+"</span></time>"}))}d.append(bamboo.components.buildDetail({key:"Status",keyClass:"status",value:(f.buildStartedTime&&!f.buildCompletedTime?"Reason for not completing is unknown":"Reason for not building is unknown")}))}}}if(f.artifacts.artifact&&f.artifacts.artifact.length){d.append(bamboo.components.buildDetail({key:"Artifacts",keyClass:"artifacts",value:bamboo.components.artifacts({artifacts:f.artifacts.artifact})}))}},error:function(k,l){var h,j,f,g;c.remove();try{g=k.responseText||k.response;if(g){h=b.parseJSON(g);j=h.message;f=(h.messageBody?"<p>"+h.messageBody+"</p>":"");if(h.oauthCallback){f+='<p><a href="'+h.oauthCallback+"&amp;redirectUrl="+encodeURIComponent(a.baseURL)+'">Login &amp; Approve</a></p>'}}else{throw"noJSONResponse"}}catch(i){j="An error occurred while trying to retrieve the build information."}AJS.messages.warning(d,{title:j,body:f,closeable:false})}})}};a.replaceWithBambooIcon=function(c){return c.replace(/(\b)icon(\b)/g,"$1bamboo-icon$2")};a.init=(function(){a.CONFIG.init();b(function(){var c=b("#runRelease");if(c.length){a.CONFIG.FormDialog=new JIRA.FormDialog({trigger:c,widthClass:"large",autoClose:true});if(/showReleaseDialog=true/.test(window.location.href)){c.click()}}})})()}(AJS.$,window.JBAM=(window.JBAM||{})));
/* module-key = 'com.atlassian.jira.plugin.ext.bamboo:deployments-resources', location = '/templates/plugins/bamboo/script/backbone-brace/backbone.brace.min.js' */
//     Backbone Brace - 2012/10/29
//     Copyright 2012 Atlassian Software Systems Pty Ltd
//     Licensed under the Apache License, Version 2.0
(function(){function i(e){return n.isArray(e)?n.reduce(e,function(e,t){return e[t]=null,e},{}):e}function s(e,t){if(!e||t==null)return t;if(typeof e=="string"||e instanceof String){if(typeof t!=""+e)throw"The typeof "+t+" is "+typeof t+" but expected it to be "+e;return t}if(n.isArray(e)||e===Array){if(!u(t))throw"Array type expected, but nonnull, non-Array value provided.";return e===Array||!e[0]?t:n.map(t,n.bind(s,null,e[0]))}if(typeof e!="function")throw"Invalid expected type "+e+". Should be falsy, String, Array, Backbone.Collection constructor, or function.";return t instanceof e?t:o(e)?new e(s([e.model],t)):new e(t)}function o(e,t){return e&&(e.__super__ instanceof(t||r.Collection)||e.__super__===(t||r.Collection).prototype||e===(t||r.Collection))}function u(e){return n.has(e,"length")&&!(e instanceof String||n.has({string:1,"function":1},typeof e)||e instanceof r.Collection)}function a(e,t){var r={};return n.each(e,function(e,n){if(!!t[n]&&!f(e,t[n])){if(!e||f(t[n],e))return;throw n+" has conflicted type descriptors."}r[n]=e}),r}function f(e,t){return!t||t===e?!0:!e||typeof e=="string"?!1:e instanceof Array?t===Array||t instanceof Array&&f(e[0],t[0]):typeof t!="function"?!1:o(t)?o(e,t):e.prototype instanceof t}function l(e){return n.isObject(e)?n.reduce(e,function(e,t,r){return t&&n.isFunction(t.toJSON)?e[r]=t.toJSON():n.isArray(t)&&(e[r]=n.map(t,function(e){return e&&n.isFunction(e.toJSON)?e.toJSON():e})),e},e):e}function c(e){return function(){var n=e.call(this);return l(n)}}function h(e){return function r(s,o){var u,a=n.extend({},s),f;return s&&s.mixins&&(f=s.mixins,delete a.mixins),u=e.call(this,a,o),this.prototype.namedEvents&&t.Mixins.applyMixin(u,{namedEvents:this.prototype.namedEvents}),this.prototype.namedAttributes&&t.Mixins.applyMixin(u,{namedAttributes:this.prototype.namedAttributes}),f&&n.each(s.mixins,function(e){t.Mixins.applyMixin(u,e)}),u.prototype.namedEvents&&t.Mixins.applyMixin(u,t.EventsMixinCreator.create(u.prototype.namedEvents)),u.prototype.namedAttributes&&(u.prototype.namedAttributes=i(u.prototype.namedAttributes),t.Mixins.applyMixin(u,t.AttributesMixinCreator.create(u.prototype.namedAttributes))),u.prototype.toJSON&&(u.prototype.toJSON=c(u.prototype.toJSON)),u.extend=r,u}}function p(e,t){var r=e.prototype,i=t.prototype,o=r.set;i.set=function(e,t,r){var i,u=this.namedAttributes;if(!u||e==null)return o.apply(this,arguments);n.isObject(e)?(i=n.clone(e),r=t):(i={},i[e]=t);for(var a in i){if(!n.has(i,a))continue;if(!n.has(u,a))throw"Attribute '"+a+"' does not exist";i[a]=s(u[a],i[a])}return o.call(this,i,r)};var u=r.get;i.get=function(e){if(this.namedAttributes&&!n.has(this.namedAttributes,e))throw"Attribute '"+e+"' does not exist";return u.apply(this,arguments)}}function d(e){var t=e.extend(),n=e.extend;return t.extend=h(n),t}function v(e){var t=d(e);return p(e,t),t}var e=this,t;typeof exports!="undefined"?t=exports:t=e.Brace={};var n=e._;!n&&typeof require!="undefined"&&(n=require("underscore"));var r=e.Backbone;!r&&typeof require!="undefined"&&(r=require("backbone")),t.Mixins={createMethodName:function(e,t){return e+t.charAt(0).toUpperCase()+t.substr(1)},applyMixin:function(e,t){n.forEach(n.keys(t),function(r){var s=e.prototype;if("initialize"===r){var o=s.initialize;s.initialize=function(){o&&o.apply(this,arguments),t.initialize.apply(this,arguments)};return}if("validate"===r){var u=s.validate;s.validate=function(){if(u){var e=u.apply(this,arguments);if(e)return e}return t.validate.apply(this,arguments)};return}if("defaults"===r){var f=s.defaults||(s.defaults={}),l=t[r];for(var c in l){if(f.hasOwnProperty(c))throw"Mixin error: class already has default '"+c+"' defined";f[c]=l[c]}return}if("namedAttributes"===r){var h=i(s.namedAttributes)||{},p=i(t[r]);s.namedAttributes=n.extend(h,a(p,h));return}if("namedEvents"===r){if(!n.isArray(t[r]))throw"Expects events member on mixin to be an array";s.namedEvents||(s.namedEvents=[]),s.namedEvents=n.uniq(s.namedEvents.concat(t[r]));return}if(s.hasOwnProperty(r))throw"Mixin error: class already has property '"+r+"' defined";s[r]=t[r]},this)}},t.AttributesMixinCreator={create:function(e){var r={};return e||(e={}),n.has(e,"id")||(e.id=null),n.each(e,function(e,n){var i=t.Mixins.createMethodName("set",n);r[i]=function(e,t){return this.set(n,e,t)};var s=t.Mixins.createMethodName("get",n);r[s]=function(){return this.get(n)}}),r},ensureType:s},t.EventsMixinCreator={create:function(e){var r={},i=function(e){var i=t.Mixins.createMethodName("on",e);r[i]=function(){return this.on.apply(this,[e].concat(n.toArray(arguments)))};var s=t.Mixins.createMethodName("trigger",e);r[s]=function(){return this.trigger.apply(this,[e].concat(n.toArray(arguments)))}};return n.each(e,n.bind(i,this)),r}},t.Model=v(r.Model),t.Collection=d(r.Collection),t.View=d(r.View),t.Router=d(r.Router)})();
/* module-key = 'com.atlassian.jira.plugin.ext.bamboo:deployments-resources', location = '/templates/plugins/bamboo/script/deployments.js' */
(function(c,b){b.Model={};b.Model.DeploymentProject=Brace.Model.extend({namedAttributes:{name:"string",id:"number",url:"string",environmentCount:"number",upToDateEnvironmentCount:"number",applinkId:"string"}});b.Model.Version=Brace.Model.extend({namedAttributes:{name:"string",id:"number",url:"string"}});b.Model.Environment=Brace.Model.extend({namedAttributes:{name:"string",id:"number",issueStatus:"string",statusOk:"boolean",url:"string",version:b.Model.Version}});b.Model.IssueDeploymentStatus=Brace.Model.extend({fetchUrl:"",namedAttributes:{deploymentProject:b.Model.DeploymentProject,versions:Brace.Collection.extend({model:b.Model.Version}),environments:Brace.Collection.extend({model:b.Model.Environment})},url:function(){return this.fetchUrl},initialize:function(e,d){this.fetchUrl=d.fetchUrl}});b.Model.ErrorMessage=Brace.Model.extend({namedAttributes:{message:"string",messageBody:"string"}});b.Model.OauthCallback=Brace.Model.extend({namedAttributes:{oauthCallback:"string",serverName:"string"}});b.Model.RelatedDeploymentProjects=Brace.Model.extend({fetchUrl:"",namedAttributes:{deploymentProjects:Brace.Collection.extend({model:b.Model.DeploymentProject}),errorMessages:Brace.Collection.extend({model:b.Model.ErrorMessage}),oauthCallbacks:Brace.Collection.extend({model:b.Model.OauthCallback})},url:function(){return this.fetchUrl},initialize:function(e,d){this.fetchUrl=d.fetchUrl}});b.IssueDeploymentStatus={};b.IssueDeploymentStatus.View=Brace.View.extend({oAuthDanceReturnUrl:"",initialize:function(d){this.options.bootstrap=d.bootstrap||[];this.oAuthDanceReturnUrl=d.oAuthDanceReturnUrl||"";this.model=new b.Model.IssueDeploymentStatus(this.options.bootstrap,{fetchUrl:d.fetchUrl});this.update()},render:function(){this.$el.html(bamboo.deployments.issueDetailsDialogContent({data:this.model.toJSON()}));return this},update:function(){return this.model.fetch({cache:false}).done(_.bind(this.render,this)).fail(_.bind(this.removeSpinner,this)).fail(_.bind(this.clearError,this)).fail(_.bind(this.displayError,this))},displayError:function(d,f,e){a(d,f,e,this.$el)},clearError:function(){this.$el.children(".aui-message").remove()},removeSpinner:function(){this.$el.children(".bamboo-icon-loading").remove()}});b.RelatedDeploymentProjects={};b.RelatedDeploymentProjects.PopupDialog=b.RelatedDeploymentProjects.PopupDialog||new JIRA.FormDialog({trigger:".bamboo-deployments-details-link",width:640,autoClose:true});b.RelatedDeploymentProjects.View=Brace.View.extend({initialize:function(d){this.options.bootstrap=d.bootstrap||[];this.oAuthDanceReturnUrl=d.oAuthDanceReturnUrl||"";this.issueId=d.issueId||"";this.selector=d.el;this.model=new b.Model.RelatedDeploymentProjects(this.options.bootstrap,{fetchUrl:d.fetchUrl});this.update()},render:function(){c(this.selector).html(bamboo.deployments.issuePanelContent({data:this.model.toJSON(),issueId:this.issueId,oAuthDanceReturnUrl:encodeURIComponent(this.oAuthDanceReturnUrl)}));return this.showPanelIfNotEmpty()},showPanelIfNotEmpty:function(){if(!c(this.selector).is(":empty")){c("#bamboo-deployment-projects-right").show()}else{c("#bamboo-deployment-projects-right").hide()}return this},update:function(){return this.model.fetch({cache:false}).done(_.bind(this.render,this)).fail(_.bind(this.displayError,this))},displayError:function(d,f,e){c(this.selector).children(".aui-message").remove();a(d,f,e,c(this.selector))}});function a(h,l,j,g){var f,k,d;try{d=h.responseText||h.response;if(d){f=c.parseJSON(d);g.append(bamboo.components.errorResponseMessage({errorMessage:f,oAuthDanceReturnUrl:encodeURIComponent(this.oAuthDanceReturnUrl)}))}else{k="Unknown error: no response from server"}}catch(i){k="An error occurred while trying to retrieve the deployment project information."}if(k){AJS.messages.warning(g,{title:k,closeable:false})}c("#bamboo-deployment-projects-right").show()}}(AJS.$,window.JBAM_DEPLOYMENT=(window.JBAM_DEPLOYMENT||{})));
/* module-key = 'com.atlassian.jira.plugin.ext.bamboo:deployments-resources', location = '/templates/plugins/bamboo/deployments/deployments.soy' */
// This file was automatically generated from deployments.soy.
// Please don't edit this file by hand.

if (typeof bamboo == 'undefined') { var bamboo = {}; }
if (typeof bamboo.deployments == 'undefined') { bamboo.deployments = {}; }


bamboo.deployments.issueDetailsDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Issue deployment details"), '</h2><div id=\'bamboo-deployments-issue-status-container\'><span class="bamboo-icon bamboo-icon-loading" title="loading"><span> </span></span></div><script>new JBAM_DEPLOYMENT.IssueDeploymentStatus.View({el: \'#bamboo-deployments-issue-status-container\', fetchUrl: \'', soy.$$escapeHtml("" + '/rest/bamboo/latest/deploy/' + opt_data.issueKey + '/' + opt_data.applinkId + '/' + opt_data.deploymentProjectId), '\', oAuthDanceReturnUrl: \'', soy.$$escapeHtml(opt_data.returnUrl), '\'});<\/script>');
  return opt_sb ? '' : output.toString();
};


bamboo.deployments.issuePanelContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.data.deploymentProjects) {
    output.append('<ul class=\'property-list\'>');
    var deploymentProjectList14 = opt_data.data.deploymentProjects;
    var deploymentProjectListLen14 = deploymentProjectList14.length;
    for (var deploymentProjectIndex14 = 0; deploymentProjectIndex14 < deploymentProjectListLen14; deploymentProjectIndex14++) {
      var deploymentProjectData14 = deploymentProjectList14[deploymentProjectIndex14];
      output.append('<li class=\'item\'><div class=\'wrap\'><strong class=\'name\'>', soy.$$escapeHtml(deploymentProjectData14.name), '</strong><span class=\'value\'>', (deploymentProjectData14.environmentCount == 0) ? '<span class="aui-icon aui-icon-info"> </span> ' + soy.$$escapeHtml("No environments defined") : (deploymentProjectData14.upToDateEnvironmentCount == 0) ? '<span class="aui-icon aui-icon-warning"> </span> ' + soy.$$escapeHtml("None of the environments have all related commits.") : (deploymentProjectData14.environmentCount > deploymentProjectData14.upToDateEnvironmentCount) ? '<span class="aui-icon aui-icon-warning"> </span> ' + soy.$$escapeHtml(AJS.format("{0} of {1} environments don\x27\x27t have all related commits.",deploymentProjectData14.environmentCount - deploymentProjectData14.upToDateEnvironmentCount,deploymentProjectData14.environmentCount)) : '<span class="aui-icon aui-icon-success"> </span> ' + soy.$$escapeHtml("All environments have all related commits."), ' <a id="bamboo-deployment-details_', soy.$$escapeHtml(deploymentProjectData14.id), '" class="bamboo-deployments-details-link" href="', soy.$$escapeHtml(""), '/secure/ViewIssueDeploymentStatus.jspa?id=', soy.$$escapeHtml(opt_data.issueId), '&deploymentProjectId=', soy.$$escapeHtml(deploymentProjectData14.id), '&applicationLinkId=', soy.$$escapeHtml(deploymentProjectData14.applinkId), '">', "Details\x26hellip;", '</a></span></div></li>');
    }
    output.append('</ul>');
  }
  if (opt_data.data.errorMessages) {
    var errorMessageList49 = opt_data.data.errorMessages;
    var errorMessageListLen49 = errorMessageList49.length;
    for (var errorMessageIndex49 = 0; errorMessageIndex49 < errorMessageListLen49; errorMessageIndex49++) {
      var errorMessageData49 = errorMessageList49[errorMessageIndex49];
      bamboo.components.errorResponseMessage({errorMessage: errorMessageData49, oAuthDanceReturnUrl: opt_data.oAuthDanceReturnUrl}, output);
    }
  }
  if (opt_data.data.oauthCallbacks && opt_data.data.oauthCallbacks.length) {
    output.append('<div class="aui-message no-border no-background"><span class="aui-icon icon-warning"></span> ', soy.$$escapeHtml("For more deployment information, you need to log in to and approve the following servers:"), '<ul>');
    var oauthCallbackList59 = opt_data.data.oauthCallbacks;
    var oauthCallbackListLen59 = oauthCallbackList59.length;
    for (var oauthCallbackIndex59 = 0; oauthCallbackIndex59 < oauthCallbackListLen59; oauthCallbackIndex59++) {
      var oauthCallbackData59 = oauthCallbackList59[oauthCallbackIndex59];
      output.append('<li><a href="', oauthCallbackData59.oauthCallback, '&amp;redirectUrl=', opt_data.oAuthDanceReturnUrl, '">', soy.$$escapeHtml(oauthCallbackData59.serverName), '</a></li>');
    }
    output.append('</ul></div>');
  }
  return opt_sb ? '' : output.toString();
};


bamboo.deployments.issueDetailsDialogContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h3>', soy.$$escapeHtml("Bamboo releases with related commits"), '</h3><ul class=\'property-list\'><li class=\'item\'><div class=\'wrap\'><strong class=\'name\'>', soy.$$escapeHtml("Deployment project"), '</strong><span class=\'value\'>');
  bamboo.deployments.itemLink({item: opt_data.data.deploymentProject}, output);
  output.append('</span></div></li><li class=\'item\'><div class=\'wrap\'><strong class=\'name\'>', soy.$$escapeHtml("Releases with commits"), '</strong><span class=\'value\'>');
  var versionList82 = opt_data.data.versions;
  var versionListLen82 = versionList82.length;
  if (versionListLen82 > 0) {
    for (var versionIndex82 = 0; versionIndex82 < versionListLen82; versionIndex82++) {
      var versionData82 = versionList82[versionIndex82];
      bamboo.deployments.itemLink({item: versionData82}, output);
      output.append((! (versionIndex82 == versionListLen82 - 1)) ? ', ' : '');
    }
  } else {
    output.append(soy.$$escapeHtml("No related releases found"));
  }
  output.append('</span></div></li></ul>');
  bamboo.deployments.environmentsTable({environments: opt_data.data.environments}, output);
  return opt_sb ? '' : output.toString();
};


bamboo.deployments.environmentsTable = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h3>', soy.$$escapeHtml("Issue availability across environments"), '</h3>');
  if (opt_data.environments.length > 0) {
    output.append('<table width=\'100%\' class=\'aui\'><colgroup><col width=\'45%\'><col width=\'30%\'><col width=\'25%\'></colgroup><thead><tr><th>', soy.$$escapeHtml("Environment"), '</th><th>', soy.$$escapeHtml("Issue availability"), '</th><th>', soy.$$escapeHtml("Current release"), '</th></tr></thead><tbody>');
    var environmentList107 = opt_data.environments;
    var environmentListLen107 = environmentList107.length;
    for (var environmentIndex107 = 0; environmentIndex107 < environmentListLen107; environmentIndex107++) {
      var environmentData107 = environmentList107[environmentIndex107];
      output.append('<tr><td>');
      bamboo.deployments.itemLink({item: environmentData107}, output);
      output.append((! environmentData107.statusOk) ? ' <span class="aui-icon aui-icon-error">Error</span>' : '', '</td><td>');
      bamboo.deployments.issueAvailabilityLozenge({issueStatus: environmentData107.issueStatus}, output);
      output.append('</td><td>');
      if (environmentData107.version) {
        bamboo.deployments.itemLink({item: environmentData107.version}, output);
      } else {
        output.append('<em>', soy.$$escapeHtml("Never deployed"), '</em>');
      }
      output.append('</td></tr>');
    }
    output.append('</tbody></table>');
  } else {
    output.append('<p>', soy.$$escapeHtml("No environments defined"), '</p>');
  }
  return opt_sb ? '' : output.toString();
};


bamboo.deployments.issueAvailabilityLozenge = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.issueStatus == 'AVAILABLE') ? '<span class="aui-lozenge aui-lozenge-success">' + soy.$$escapeHtml("deployed") + '</span>' : (opt_data.issueStatus == 'PARTIALLY_AVAILABLE') ? '<span class="aui-lozenge aui-lozenge-current">' + soy.$$escapeHtml("partly deployed") + '</span>' : '<span class="aui-lozenge">' + soy.$$escapeHtml("not deployed") + '</span>');
  return opt_sb ? '' : output.toString();
};


bamboo.deployments.itemLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.item.url) ? '<a href="' + opt_data.item.url + '">' + soy.$$escapeHtml(opt_data.item.name) + '</a>' : soy.$$escapeHtml(opt_data.item.name));
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.xiplink.jira.git.jira_git_plugin:diff-resource', location = 'js/diff.js' */
AJS.$(function(){var a=function(){};AJS.$.extend(a.prototype,{url:AJS.contextPath()+"/secure/Diff.jspa",urlContent:AJS.contextPath()+"/secure/ViewGitFileContent.jspa",initialHeight:530,loadHandler:function(){var d=this;var c=[{selector:".gp-view-commit-diff",handler:d.onCommitClick},{selector:".gp-view-file-diff",handler:d.onFileClick},{selector:".gp-view-summary-diff",handler:d.onSummaryClick},{selector:".gp-view-file-content",handler:d.onFileClickShowContent}];var e=true;AJS.$.each(c,function(f,g){var h=AJS.$(g.selector).get(0);if(h!==undefined&&!d.hasListeners(h,g.handler)){e=false;return false}});if(e){return}this.buildItems();AJS.$.each(c,function(g,f){AJS.$(f.selector+"[handled!=handled]").click(AJS.$.proxy(f.handler,d)).attr("handled","handled")})},buildItems:function(){this.diffPopup=new AJS.Dialog(860,this.initialHeight,"diff-popup");this.loadingMsg=new AJS.Dialog(400,80);this.diffPopup.addButton("Close",function(d){d.hide()});this.diffPopup.addPanel("","");this.diffPopup.addHeader("-");var c=AJS.$('<div id="diff-loading-indicator" class="aui-progress-indicator"/>').css("margin-top","17px");c.append(AJS.$('<span class="aui-progress-indicator-value"/>'));this.loadingMsg.addPanel("",c);if(AJS.progressBars){AJS.progressBars.setIndeterminate("diff-loading-indicator")}},sendRequest:function(i,d,c){var f=AJS.$(i.currentTarget);this.loadingMsg.show();var h={};for(var e in c){c.hasOwnProperty(e);h[e]=f.attr(c[e])}var j=this.diffPopup;var g=this.loadingMsg;AJS.$.ajax({url:d,type:"GET",data:h,dataType:"html",success:AJS.$.proxy(this.onDataReceived,this,f)});return false},onCommitClick:function(c){return this.sendRequest(c,this.url,{revision:"revision",repoId:"repoId",projectId:"project"})},onSummaryClick:function(c){return this.sendRequest(c,this.url,{revisionA:"revisionA",revisionB:"revisionB",repoId:"repoid",projectId:"project",path:"path"})},onFileClick:function(c){return this.sendRequest(c,this.url,{revision:"revision",repoId:"repoId",projectId:"project",path:"path"})},onFileClickShowContent:function(c){return this.sendRequest(c,this.urlContent,{revision:"revision",repoId:"repoId",projectId:"project",path:"path"})},onDataReceived:function(g,f){var j=this.diffPopup.getPage(0),m,k;this.loadingMsg.hide();if(g.attr("revision")){j.header.html(g.attr("revision"))}else{var e=g.attr("revisionA"),d=g.attr("revisionB"),h;e=e.replace("^","");h=["Revisions: ","...",e.substr(33)," - ","...",d.substr(33),].join("");j.header.html(h)}var i=AJS.$(f);this.diffPopup.getCurrentPanel().body.html("");this.diffPopup.getCurrentPanel().body.append(i);this.diffPopup.show();var l=j.element.find(".code-diff-wrap");m=l.height();if(this.initialHeight>m+120){this.diffPopup.updateHeight()}else{k=this.diffPopup.height;if(k<=this.initialHeight){this.diffPopup.getCurrentPanel().body.css({height:this.initialHeight-87});this.diffPopup.height=this.initialHeight;this.diffPopup.popup.changeSize(undefined,this.initialHeight+20)}}var c=l.width();l.find(".filename").each(function(o,p){var q=AJS.$(p).children(".path")[0];var n=AJS.$(p).children(".name")[0];if(q.scrollWidth+n.scrollWidth>c){AJS.$(p).width(c);AJS.$(q).width(c-n.scrollWidth-2)}});l.children("table").width(c)},hasListeners:function(e,d){var c=AJS.$.data(e,"events"),f=false;if(c){AJS.$.each(c.click,function(h,g){if(g.handler.toString()===d.toString()){f=true}})}return f}});var b=new a();JIRA.ViewIssueTabs&&JIRA.ViewIssueTabs.onTabReady(AJS.$.proxy(b.loadHandler,b));JIRA.Project&&JIRA.Project.navigationTabs&&JIRA.Project.navigationTabs.addLoadEvent("git-project-tab-panel",AJS.$.proxy(b.loadHandler,b));b.loadHandler.call(b)});
/* module-key = 'com.xiplink.jira.git.jira_git_plugin:issue-resource', location = 'js/summary.js' */
AJS.$(function(){var b=function(){$=AJS.$;function f(g,h){return(g>h)?1:(g<h)?-1:0}function e(g){return function(h,i){return f(g(h),g(i))}}var d={"gp-files-sort":{path:function(g){return $(g).find(".gp-content-item-name > a").text()},changed:function(g){return d["gp-files-sort"]["lines-added"](g)+d["gp-files-sort"]["lines-changed"](g)+d["gp-files-sort"]["lines-removed"](g)},"lines-before":function(g){return -$(g).data("lines-before")},"lines-added":function(g){return -$(g).data("lines-added")},"lines-changed":function(g){return -$(g).data("lines-changed")},"lines-removed":function(g){return -$(g).data("lines-removed")},"lines-after":function(g){return -$(g).data("lines-after")}},"gp-developers-sort":{name:function(g){return $(g).find(".gp-content-item-name").text()},changes:function(g){return d["gp-developers-sort"]["lines-added"](g)+d["gp-developers-sort"]["lines-changed"](g)+d["gp-developers-sort"]["lines-removed"](g)},"lines-added":function(g){return -$(g).data("lines-added")},"lines-changed":function(g){return -$(g).data("lines-changed")},"lines-removed":function(g){return -$(g).data("lines-removed")}}};function c(k,m){var l=$("#"+k);var h=$("#"+k+"-button");var j=$("[gp-sort-target="+k+"]");var i;if(m){i=l.find("a[data-sorter="+m+"]")}else{i=l.find("a.checked");m=i.data("sorter")}if(!i.hasClass("checked")){l.find("a.checked").removeClass("checked");i.addClass("checked")}h.html("Sort: <b>"+i.text()+"</b>");var g=j.children();g.detach();g.sort(e(d[k][m]));g.appendTo(j)}$(function(){c("gp-files-sort");c("gp-developers-sort");AJS.$("#gp-files-sort").on("aui-dropdown2-item-check",function(){c("gp-files-sort")});AJS.$("#gp-developers-sort").on("aui-dropdown2-item-check",function(){c("gp-developers-sort")})})};var a=function(){var c=null;AJS.$(".gp-commit-group").each(function(d,f){var e=f.attributes.repoid.value;f.style.display=e==c?"none":"block";c=e})};JIRA.ViewIssueTabs&&JIRA.ViewIssueTabs.onTabReady(b);JIRA.ViewIssueTabs&&JIRA.ViewIssueTabs.onTabReady(a);b();a()});
/* module-key = 'com.xiplink.jira.git.jira_git_plugin:issue-and-project-resource', location = 'js/issue-and-project.js' */
AJS.$(function(){var b=function(f){var g=f?function(j){return AJS.$(f).find(j)}:AJS.$;var i=function(k,j){return k==="0"?"-":Number(k)?j+Math.abs(Number(k)):k};var h=function(j,k){g(j).each(function(l,m){m.innerHTML=i(m.innerHTML,k)})};h(".gp-green","+");h(".gp-yellow","&plusmn;");h(".gp-red","-")};var d=function(){var f=AJS.$;var g=4;f(".gp-commit").each(function(){var l=f(this);if(l.attr("data-more-text-already-prepared")){return}l.attr("data-more-text-already-prepared","true");var m=l.find(".gp-content");var o=m.children(".gp-commit-file");if(o.length<=g){return}var n=o.length-g+1;var p=l.attr("data-more-text-line").replace("%i",n);var j=0;var q=0;var r=0;for(var k=g-1;k<o.length;++k){o.eq(k).css("display","none");j+=Number(o.eq(k).attr("data-added"));r+=Number(o.eq(k).attr("data-changed"));q+=Number(o.eq(k).attr("data-deleted"))}var h=f('<div class="gp-content-item"><div class="gp-count"><div class="gp-green">'+j+'</div><div class="gp-yellow">'+r+'</div><div class="gp-red">'+q+'</div></div><div class="gp-content-item-name"><a class="path" href="#">'+p+"</a></div></div>");b(h[0]);h.find("a").click(function(){h.remove();o.css("display","");o.each(e);return false});o.eq(o.length-1).after(h)})};var e=(function(){var g=function(i){var h=AJS.$(i);return !(h.hasClass("gp-ellipsized-file-name"))&&(h.find(".gp-ellipsized-file-name").size()==0)&&!(h.hasClass("gp-clear"))};var f=function(i){var k=0;AJS.$(i).children().each(function(l,m){if(g(m)){k+=AJS.$(m).outerWidth(true)}});var h=AJS.$(i).find(".gp-content-item-name");var j=parseFloat(h.css("margin-left"));k=Math.max(k,j);return AJS.$(i).width()-k};return function(l,p){var i=f(p);var h=AJS.$(p).find(".gp-ellipsized-file-name");var m=h.find(".path");var o=h.find(".name");var n=i-o.width();var k=m.outerWidth()-m.width();var j=m[0].scrollWidth;if(n<=j+1){m.width(n-k-1)}else{m.width("")}}})();var a=function(){AJS.$(".gp-ellipsized-file-name-container").each(e)};var c=function(){b();a();d()};JIRA.ViewIssueTabs&&JIRA.ViewIssueTabs.onTabReady(c);JIRA.Project&&JIRA.Project.navigationTabs&&JIRA.Project.navigationTabs.addLoadEvent("git-project-tab-panel",AJS.$.proxy(c));c();AJS.$(window).resize(a)});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:lib', location = 'lib/brace.js' */
(function(){var i=this;var k;if(typeof exports!=="undefined"){k=exports}else{k={}}var o=i._;if(!o&&(typeof require!=="undefined")){o=require("underscore")}var n=i.Backbone;if(!n&&(typeof require!=="undefined")){n=require("backbone")}function f(q){if(o.isArray(q)){return o.reduce(q,function(r,s){r[s]=null;return r},{})}return q}function b(q,r){if(!q||r==null){return r}if(typeof q==="string"||q instanceof String){if(typeof r!==""+q){throw"The typeof "+r+" is "+typeof r+" but expected it to be "+q}return r}if(o.isArray(q)||q===Array){if(!l(r)){throw"Array type expected, but nonnull, non-Array value provided."}return q===Array||!q[0]?r:o.map(r,o.bind(b,null,q[0]))}if(typeof q!=="function"){throw"Invalid expected type "+q+". Should be falsy, String, Array, Backbone.Collection constructor, or function."}if(r instanceof q){return r}if(h(q)){return new q(b([q.model],r))}return new q(r)}function h(r,q){return r&&(r.__super__ instanceof (q||n.Collection)||r.__super__===(q||n.Collection).prototype||r===(q||n.Collection))}function l(q){return o.has(q,"length")&&!(q instanceof String||o.has({string:1,"function":1},typeof q)||q instanceof n.Collection)}function m(s,r){var q={};o.each(s,function(u,t){if(!r[t]||p(u,r[t])){q[t]=u}else{if(!u||p(r[t],u)){return}else{throw t+" has conflicted type descriptors."}}});return q}function p(r,q){if(!q||q===r){return true}if(!r||typeof r==="string"){return false}if(r instanceof Array){return q===Array||(q instanceof Array&&p(r[0],q[0]))}if(typeof q!=="function"){return false}if(h(q)){return h(r,q)}return r.prototype instanceof q}function e(q){if(o.isObject(q)){return o.reduce(q,function(r,t,s){if(t&&o.isFunction(t.toJSON)){r[s]=t.toJSON()}return r},q)}else{return q}}function a(r){return function q(){var s=r.call(this);return e(s)}}k.Mixins={createMethodName:function(q,r){return q+r.charAt(0).toUpperCase()+r.substr(1)},applyMixin:function(r,q){o.forEach(o.keys(q),function(z){var w=r.prototype;if("initialize"===z){var y=w.initialize;w.initialize=function(){if(y){y.apply(this,arguments)}q.initialize.apply(this,arguments)};return}if("validate"===z){var s=w.validate;w.validate=function(){if(s){var B=s.apply(this,arguments);if(B){return B}}return q.validate.apply(this,arguments)};return}if("defaults"===z){var v=w.defaults||(w.defaults={});var x=q[z];for(var u in x){if(v.hasOwnProperty(u)){throw"Mixin error: class already has default '"+u+"' defined"}v[u]=x[u]}return}if("namedAttributes"===z){var t=f(w.namedAttributes)||{};var A=f(q[z]);w.namedAttributes=o.extend(t,m(A,t));return}if("namedEvents"===z){if(!o.isArray(q[z])){throw"Expects events member on mixin to be an array"}if(!w.namedEvents){w.namedEvents=[]}w.namedEvents=o.uniq(w.namedEvents.concat(q[z]));return}if(w.hasOwnProperty(z)){throw"Mixin error: class already has property '"+z+"' defined"}w[z]=q[z]},this)}};k.AttributesMixinCreator={create:function(r){var q={};if(!r){r={}}if(!o.has(r,"id")){r.id=null}o.each(r,function(u,t){var v=k.Mixins.createMethodName("set",t);q[v]=function(x,w){return this.set(t,x,w)};var s=k.Mixins.createMethodName("get",t);q[s]=function(){return this.get(t)}});return q},ensureType:b};k.EventsMixinCreator={create:function(r){var q={};var s=function(u){var t=k.Mixins.createMethodName("on",u);q[t]=function(){return this.on.apply(this,[u].concat(o.toArray(arguments)))};var v=k.Mixins.createMethodName("trigger",u);q[v]=function(){return this.trigger.apply(this,[u].concat(o.toArray(arguments)))}};o.each(r,o.bind(s,this));return q}};function d(r){return function q(u,v){var w;var t=o.extend({},u);var s;if(u&&u.mixins){s=u.mixins;delete t.mixins}w=r.call(this,t,v);if(this.prototype.namedEvents){k.Mixins.applyMixin(w,{namedEvents:this.prototype.namedEvents})}if(this.prototype.namedAttributes){k.Mixins.applyMixin(w,{namedAttributes:this.prototype.namedAttributes})}if(s){o.each(u.mixins,function(x){k.Mixins.applyMixin(w,x)})}if(w.prototype.namedEvents){k.Mixins.applyMixin(w,k.EventsMixinCreator.create(w.prototype.namedEvents))}if(w.prototype.namedAttributes){w.prototype.namedAttributes=f(w.prototype.namedAttributes);k.Mixins.applyMixin(w,k.AttributesMixinCreator.create(w.prototype.namedAttributes))}if(w.prototype.toJSON){w.prototype.toJSON=a(w.prototype.toJSON)}w.extend=q;return w}}function g(u,s){var t=u.prototype;var q=s.prototype;var r=t.set;q.set=function(A,B,z){var y,x=this.namedAttributes;if(!x||A==null){return r.apply(this,arguments)}if(o.isObject(A)){y=o.clone(A);z=B}else{y={};y[A]=B}for(var w in y){if(!o.has(y,w)){continue}if(!o.has(x,w)){throw"Attribute '"+w+"' does not exist"}y[w]=b(x[w],y[w])}return r.call(this,y,z)};var v=t.get;q.get=function(w){if(this.namedAttributes&&!o.has(this.namedAttributes,w)){throw"Attribute '"+w+"' does not exist"}return v.apply(this,arguments)}}function c(q){var s=q.extend();var r=q.extend;s.extend=d(r);return s}function j(q){var r=c(q);g(q,r);return r}k.Model=j(n.Model);k.Collection=c(n.Collection);k.View=c(n.View);k.Router=c(n.Router);k.Evented=c(n.View);if(typeof JIRA==="undefined"){JIRA={}}if(!JIRA.Issues){JIRA.Issues={}}JIRA.Issues.Brace=k}());
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:tipsy', location = 'lib/jquery.hoverIntent.min.js' */
/**
* hoverIntent r6 // 2011.02.26 // jQuery 1.5.1+
* <http://cherne.net/brian/resources/jquery.hoverIntent.html>
* 
* @param  f  onMouseOver function || An object with configuration options
* @param  g  onMouseOut function  || Nothing (use configuration options object)
* @author    Brian Cherne brian(at)cherne(dot)net
*/
(function($){$.fn.hoverIntent=function(f,g){var cfg={sensitivity:7,interval:100,timeout:0};cfg=$.extend(cfg,g?{over:f,out:g}:f);var cX,cY,pX,pY;var track=function(ev){cX=ev.pageX;cY=ev.pageY};var compare=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);if((Math.abs(pX-cX)+Math.abs(pY-cY))<cfg.sensitivity){$(ob).unbind("mousemove",track);ob.hoverIntent_s=1;return cfg.over.apply(ob,[ev])}else{pX=cX;pY=cY;ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)}};var delay=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);ob.hoverIntent_s=0;return cfg.out.apply(ob,[ev])};var handleHover=function(e){var ev=jQuery.extend({},e);var ob=this;if(ob.hoverIntent_t){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t)}if(e.type=="mouseenter"){pX=ev.pageX;pY=ev.pageY;$(ob).bind("mousemove",track);if(ob.hoverIntent_s!=1){ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)}}else{$(ob).unbind("mousemove",track);if(ob.hoverIntent_s==1){ob.hoverIntent_t=setTimeout(function(){delay(ev,ob)},cfg.timeout)}}};return this.bind('mouseenter',handleHover).bind('mouseleave',handleHover)}})(jQuery);
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:tipsy', location = 'util/TipsyView.js' */
if(!jQuery.fn.tooltip){jQuery.fn.tooltip=jQuery.noop;jQuery.fn.tipsy=jQuery.noop}JIRA.Issues.Tipsy=JIRA.Issues.Brace.View.extend({events:{click:"hide"},initialize:function(a){if(_.isFunction(a.showCondition)){this.shouldShow=a.showCondition}else{if(a.showCondition){this.shouldShow=_.bind(function(){return this.$el.filter(a.showCondition).length>0},this)}else{this.shouldShow=function(){return true}}}this.tipsy=this.$el.tooltip(_.extend({trigger:"manual"},a.tipsy));this.hoverIntent(a.intents)},hoverIntent:function(a){if(this.tipsy){this.tipsy.hoverIntent(_.extend({interval:200,over:_.bind(this.show,this),out:_.bind(this.hide,this)},a))}return this},show:function(){if(this.shouldShow()&&this.tipsy){this.$el.tipsy("show")}},hide:function(){if(this.tipsy){this.$el.tipsy("hide")}},remove:function(){this.hide();this.$el.removeData("tipsy")}});JIRA.Issues.Tipsy.revalidate=function(){return jQuery.fn.tipsy.revalidate()};JIRA.Issues.Tipsy.autoBounds=function(){return jQuery.fn.tipsy.autoBounds.apply(jQuery.fn.tipsy,arguments)};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:backbone-ext', location = 'content/js/base/AttributesMixinCreator.js' */
AJS.namespace("JIRA.Issues.AttributesMixinCreator");(function(){JIRA.Issues.AttributesMixinCreator={create:function(b){var a={};if(_.indexOf(b,"id")===-1){b.unshift("id")}_.each(b,function(d){var e=JIRA.Issues.Mixins.createMethodName("set",d);a[e]=function(h,f){var g={};g[d]=h;this.set(g,f);return this};var c=JIRA.Issues.Mixins.createMethodName("get",d);a[c]=function(){return this.get(d)}});return a}}})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:backbone-ext', location = 'content/js/base/EventsMixinCreator.js' */
(function(){JIRA.Issues.EventsMixinCreator={create:function(b){var a={};var c=function(e){var d=JIRA.Issues.Mixins.createMethodName("bind",e);a[d]=function(){return this.bind.apply(this,[e].concat(_.toArray(arguments)))};var g=JIRA.Issues.Mixins.createMethodName("unbind",e);a[g]=function(){return this.unbind.apply(this,[e].concat(_.toArray(arguments)))};var f=JIRA.Issues.Mixins.createMethodName("trigger",e);a[f]=function(){return this.trigger.apply(this,[e].concat(_.toArray(arguments)))};var h=JIRA.Issues.Mixins.createMethodName("one",e);a[h]=function(){var i=this;var j=arguments[0];var l=function(){i.unbind(e,l);j(arguments)};var k=_.toArray(arguments).slice(1);return this.bind.apply(this,[e,l].concat(k))}};_.each(b,_.bind(c,this));return a}}})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:backbone-ext', location = 'content/js/base/Extensions.js' */
AJS.namespace("JIRA.Issues.BaseModel");AJS.namespace("JIRA.Issues.BaseCollection");AJS.namespace("JIRA.Issues.BaseView");AJS.namespace("JIRA.Issues.BaseRouter");(function(){function applyMixin(ctor,mixin){_.forEach(_.keys(mixin),function(key){var proto=ctor.prototype;if("initialize"===key){var oldInitialize=proto.initialize;proto.initialize=function(){mixin.initialize.apply(this,arguments);if(oldInitialize){oldInitialize.apply(this,arguments)}};return}if("validate"===key){var oldValidate=proto.validate;proto.validate=function(){var errors=mixin.validate.apply(this,arguments);if(errors){return errors}if(oldValidate){return oldValidate.apply(this,arguments)}};return}if("defaults"===key){var defaults=proto.defaults||(proto.defaults={});var mixinDefaults=mixin[key];for(var id in mixinDefaults){if(defaults.hasOwnProperty(id)){throw"Mixin error: object "+ctor+" already has default "+id+" defined for mixin "+mixin}defaults[id]=mixinDefaults[id]}return}if("properties"===key){if(!_.isArray(mixin[key])){throw"Expects properties member on mixin to be an array"}if(!proto.properties){proto.properties=[]}proto.properties=proto.properties.concat(mixin[key]);return}if("namedEvents"===key){if(!_.isArray(mixin[key])){throw"Expects events member on mixin to be an array"}if(!proto.namedEvents){proto.namedEvents=[]}proto.namedEvents=proto.namedEvents.concat(mixin[key]);return}if(proto.hasOwnProperty(key)){throw"Mixin error: object "+ctor+" already has property "+key+" for mixin "+mixin}proto[key]=mixin[key]},this)}function generateMixinExtend(oldExtend){return function(protoProps,classProps){var child;var cleanProtoProps=_.extend({},protoProps);var mixins;if(protoProps&&protoProps.mixins){mixins=protoProps.mixins;delete cleanProtoProps.mixins}child=oldExtend.call(this,cleanProtoProps,classProps);if(mixins){_.each(protoProps.mixins,function(mixin){applyMixin(child,mixin)})}if(child.prototype.namedEvents){applyMixin(child,JIRA.Issues.EventsMixinCreator.create(child.prototype.namedEvents))}if(child.prototype.properties){applyMixin(child,JIRA.Issues.AttributesMixinCreator.create(child.prototype.properties))}child.extend=arguments.callee;return child}}function overrideSetGet(ctor,childCtor){var proto=ctor.prototype;var childProto=childCtor.prototype;childProto.set=function(key,value,options){var attrs,properties=this.properties;if(properties){if(_.isObject(key)||key==null){attrs=key}else{attrs={};attrs[key]=value}for(var attr in attrs){if(_.indexOf(properties,attr)<0){throw"Property '"+attr+"' does not exist"}}}return proto.set.apply(this,arguments)};childProto.get=function(attr){if(this.properties&&_.indexOf(this.properties,attr)<0){throw"Property '"+attr+"' does not exist"}return proto.get.apply(this,arguments)}}function addListenMethods(ctor,childCtor){var proto=ctor.prototype;var childProto=childCtor.prototype;childProto.addListener=function(other,event,callback,context){if(arguments.length<3){throw"The 'other', 'event', and 'callback' arguments are mandatory"}var capitalisedEvent=event.charAt(0).toUpperCase()+event.slice(1);var registerMethodName="on"+capitalisedEvent;var unregisterMethodName="off"+capitalisedEvent;var braceRegisterMethodName="bind"+capitalisedEvent;var braceUnregisterMethodName="unbind"+capitalisedEvent;var finalRegisterName;var finalUnRegisterName;if(other[registerMethodName]){finalRegisterName=registerMethodName;finalUnRegisterName=unregisterMethodName||braceUnregisterMethodName;if(typeof other[finalRegisterName]!=="function"){throw"object does not have method "+registerMethodName+"'"}if(typeof other[finalUnRegisterName]!=="function"){throw"object does not have method "+unregisterMethodName+"'"}}else{finalRegisterName=braceRegisterMethodName;finalUnRegisterName=braceUnregisterMethodName;if(typeof other[finalRegisterName]!=="function"){throw"object does not have event ["+event+"] registered'"}}other[finalRegisterName](callback,context);this._cleanerUppers=this._cleanerUppers||[];this._cleanerUppers.push(function(){other[finalUnRegisterName](callback,context)})};childProto.removeListeners=function(){if(this._cleanerUppers){_.each(this._cleanerUppers,function(cleanerUpper){cleanerUpper()})}}}function addViewCleanupMethods(ctor,childCtor){var proto=ctor.prototype;var childProto=childCtor.prototype;var superRemove=proto.remove;childProto.remove=function(){this.removeListeners();return superRemove.apply(this,arguments)};proto.deactivate=function(){this.undelegateEvents();this.removeListeners()}}function applyExtensions(ctor){var child=ctor.extend();var oldExtend=ctor.extend;child.extend=generateMixinExtend(oldExtend);return child}function applyModelExtensions(ctor){var child=applyExtensions(ctor);overrideSetGet(ctor,child);return child}function applyViewExtensions(ctor){var child=applyExtensions(ctor);addListenMethods(ctor,child);addViewCleanupMethods(ctor,child);return child}JIRA.Issues.BaseModel=applyModelExtensions(Backbone.Model);JIRA.Issues.BaseCollection=applyExtensions(Backbone.Collection);JIRA.Issues.BaseView=applyViewExtensions(Backbone.View);JIRA.Issues.BaseRouter=applyExtensions(Backbone.Router);var Evented=function(){this.initialize.apply(this,arguments)};_.extend(Evented.prototype,Backbone.Events,{initialize:function(){}});Evented.extend=Backbone.Model.extend;JIRA.Issues.BaseEvented=applyExtensions(Evented);_.mixin({lambda:function(x){return function(){return x}},isNotBlank:function(object){return !!object},bindObjectTo:function(obj,context){_.map(obj,function(value,key){if(_.isFunction(value)){obj[key]=_.bind(value,context)}})}});Backbone.define=function(name,ctor){eval("Backbone['Class: "+name+"'] = function() { Backbone['Class: "+name+"'].__ctor.apply(this, arguments); }");var cls=Backbone["Class: "+name];cls.__ctor=ctor;ctor.prototype.name=name;cls.prototype=ctor.prototype;_.extend(cls,ctor);_.each(ctor.prototype,function(fn,fnName){if(typeof fn==="function"){fn.displayName=name+"."+fnName}});var context=window;var parts=name.split(".");_.each(parts,function(part,i){if(i===parts.length-1){context[part]=cls}else{context=context[part]==null?(context[part]={}):context[part]}});return cls}})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:backbone-ext', location = 'content/js/base/Mixins.js' */
(function(){JIRA.Issues.Mixins={createMethodName:function(a,b){return a+b.charAt(0).toUpperCase()+b.substr(1)}}})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:backbone-ext', location = 'content/js/base/ModelUtils.js' */
(function(){var b=function(d,c){return function(f,g,e){c[this.cid]={model:this};if(_.isObject(f)){c[this.cid].options=g;return d.call(this,f,_.extend(g||{},{silent:true}))}c[this.cid].options=e;return d.call(this,f,g,_.extend(e||{},{silent:true}))}};var a=function(){var e=Backbone.Model.prototype;if(typeof e._txModels!=="undefined"){return{publishChanges:function(){}}}var c=e._txModels={};var d=e.set;e.set=b(d,c);return{publishChanges:function(){e.set=d;_.each(c,function(f){f.model.change(f.options)});delete e._txModels}}};JIRA=JIRA||{};JIRA.Issues=JIRA.Issues||{};JIRA.Issues.ModelUtils=JIRA.Issues.ModelUtils||{};JIRA.Issues.ModelUtils.transaction=function(e,d){var c=a();e.apply(d);c.publishChanges();return undefined};JIRA.Issues.ModelUtils.makeTransactional=function(d){var e=function(f){return function(){var g=arguments;JIRA.Issues.ModelUtils.transaction(function(){f.apply(this,g)},this)}};var c=Array.prototype.slice.call(arguments,1);if(c.length===0){c=_.functions(d)}_.each(c,function(f){if(f.indexOf("_")!==0){d[f]=e(d[f])}})}})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:backbone-ext', location = 'content/js/backbonepatch/backbone-0.9.2-navigate-patch.js' */
Backbone.History.prototype.navigate=function(c,b){if(!Backbone.History.started){return false}if(!b||b===true){b={trigger:b}}c=this.getFragment(c||"");if(this.fragment===c){return}this.fragment=c;var a=this.options.root+c;if(this._hasPushState){window.history[b.replace?"replaceState":"pushState"]({},document.title,a)}else{if(this._wantsHashChange){this._updateHash(window.location,c,b.replace);if(this.iframe&&(c!==this.getFragment(this.getHash(this.iframe)))){if(!b.replace){this.iframe.document.open().close()}this._updateHash(this.iframe.location,c,b.replace)}}else{return window.location.assign(a)}}if(b.trigger){this.loadUrl(c)}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'lib/backbone.brace.js' */
(function(){var i=this;var k;if(typeof exports!=="undefined"){k=exports}else{k=i.Brace={}}var o=i._;if(!o&&(typeof require!=="undefined")){o=require("underscore")}var n=i.Backbone;if(!n&&(typeof require!=="undefined")){n=require("backbone")}function f(q){if(o.isArray(q)){return o.reduce(q,function(r,s){r[s]=null;return r},{})}return q}function b(q,r){if(!q||r==null){return r}if(typeof q==="string"||q instanceof String){if(typeof r!==""+q){throw"The typeof "+r+" is "+typeof r+" but expected it to be "+q}return r}if(o.isArray(q)||q===Array){if(!l(r)){throw"Array type expected, but nonnull, non-Array value provided."}return q===Array||!q[0]?r:o.map(r,o.bind(b,null,q[0]))}if(typeof q!=="function"){throw"Invalid expected type "+q+". Should be falsy, String, Array, Backbone.Collection constructor, or function."}if(r instanceof q){return r}if(h(q)){return new q(b([q.model],r))}return new q(r)}function h(r,q){return r&&(r.__super__ instanceof (q||n.Collection)||r.__super__===(q||n.Collection).prototype||r===(q||n.Collection))}function l(q){return o.has(q,"length")&&!(q instanceof String||o.has({string:1,"function":1},typeof q)||q instanceof n.Collection)}function m(s,r){var q={};o.each(s,function(u,t){if(!r[t]||p(u,r[t])){q[t]=u}else{if(!u||p(r[t],u)){return}else{throw t+" has conflicted type descriptors."}}});return q}function p(r,q){if(!q||q===r){return true}if(!r||typeof r==="string"){return false}if(r instanceof Array){return q===Array||(q instanceof Array&&p(r[0],q[0]))}if(typeof q!=="function"){return false}if(h(q)){return h(r,q)}return r.prototype instanceof q}function e(q){if(o.isObject(q)){return o.reduce(q,function(r,t,s){if(t&&o.isFunction(t.toJSON)){r[s]=t.toJSON()}return r},q)}else{return q}}function a(r){return function q(){var s=r.call(this);return e(s)}}k.Mixins={createMethodName:function(q,r){return q+r.charAt(0).toUpperCase()+r.substr(1)},applyMixin:function(r,q){o.forEach(o.keys(q),function(z){var w=r.prototype;if("initialize"===z){var y=w.initialize;w.initialize=function(){if(y){y.apply(this,arguments)}q.initialize.apply(this,arguments)};return}if("validate"===z){var s=w.validate;w.validate=function(){if(s){var B=s.apply(this,arguments);if(B){return B}}return q.validate.apply(this,arguments)};return}if("defaults"===z){var v=w.defaults||(w.defaults={});var x=q[z];for(var u in x){if(v.hasOwnProperty(u)){throw"Mixin error: class already has default '"+u+"' defined"}v[u]=x[u]}return}if("namedAttributes"===z){var t=f(w.namedAttributes)||{};var A=f(q[z]);w.namedAttributes=o.extend(t,m(A,t));return}if("namedEvents"===z){if(!o.isArray(q[z])){throw"Expects events member on mixin to be an array"}if(!w.namedEvents){w.namedEvents=[]}w.namedEvents=o.uniq(w.namedEvents.concat(q[z]));return}if(w.hasOwnProperty(z)){throw"Mixin error: class already has property '"+z+"' defined"}w[z]=q[z]},this)}};k.AttributesMixinCreator={create:function(r){var q={};if(!r){r={}}if(!o.has(r,"id")){r.id=null}o.each(r,function(u,t){var v=k.Mixins.createMethodName("set",t);q[v]=function(x,w){return this.set(t,x,w)};var s=k.Mixins.createMethodName("get",t);q[s]=function(){return this.get(t)}});return q},ensureType:b};k.EventsMixinCreator={create:function(r){var q={};var s=function(u){var t=k.Mixins.createMethodName("on",u);q[t]=function(){return this.on.apply(this,[u].concat(o.toArray(arguments)))};var v=k.Mixins.createMethodName("trigger",u);q[v]=function(){return this.trigger.apply(this,[u].concat(o.toArray(arguments)))}};o.each(r,o.bind(s,this));return q}};function d(r){return function q(u,v){var w;var t=o.extend({},u);var s;if(u&&u.mixins){s=u.mixins;delete t.mixins}w=r.call(this,t,v);if(this.prototype.namedEvents){k.Mixins.applyMixin(w,{namedEvents:this.prototype.namedEvents})}if(this.prototype.namedAttributes){k.Mixins.applyMixin(w,{namedAttributes:this.prototype.namedAttributes})}if(s){o.each(u.mixins,function(x){k.Mixins.applyMixin(w,x)})}if(w.prototype.namedEvents){k.Mixins.applyMixin(w,k.EventsMixinCreator.create(w.prototype.namedEvents))}if(w.prototype.namedAttributes){w.prototype.namedAttributes=f(w.prototype.namedAttributes);k.Mixins.applyMixin(w,k.AttributesMixinCreator.create(w.prototype.namedAttributes))}if(w.prototype.toJSON){w.prototype.toJSON=a(w.prototype.toJSON)}w.extend=q;return w}}function g(u,s){var t=u.prototype;var q=s.prototype;var r=t.set;q.set=function(A,B,z){var y,x=this.namedAttributes;if(!x||A==null){return r.apply(this,arguments)}if(o.isObject(A)){y=o.clone(A);z=B}else{y={};y[A]=B}for(var w in y){if(!o.has(y,w)){continue}if(!o.has(x,w)){throw"Attribute '"+w+"' does not exist"}y[w]=b(x[w],y[w])}return r.call(this,y,z)};var v=t.get;q.get=function(w){if(this.namedAttributes&&!o.has(this.namedAttributes,w)){throw"Attribute '"+w+"' does not exist"}return v.apply(this,arguments)}}function c(q){var s=q.extend();var r=q.extend;s.extend=d(r);return s}function j(q){var r=c(q);g(q,r);return r}k.Model=j(n.Model);k.Collection=c(n.Collection);k.View=c(n.View);k.Router=c(n.Router);k.Evented=c(n.View)}());
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'lib/backbone.define.js' */
Backbone.define=function(name,ctor){eval("Backbone['Class: "+name+"'] = function() { Backbone['Class: "+name+"'].__ctor.apply(this, arguments); }");var cls=Backbone["Class: "+name];cls.__ctor=ctor;ctor.prototype.name=name;cls.prototype=ctor.prototype;_.extend(cls,ctor);_.each(ctor.prototype,function(fn,fnName){if(typeof fn==="function"){fn.displayName=name+"."+fnName}});var context=window;var parts=name.split(".");_.each(parts,function(part,i){if(i===parts.length-1){context[part]=cls}else{context=context[part]==null?(context[part]={}):context[part]}});return cls};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/Utils.js' */
JIRA.Issues.Actions={DELETE:"delete",EDIT_COMMENT:"editComment",UPDATE:"update",INLINE_EDIT:"inlineEdit",ROW_UPDATE:"rowUpdate"};JIRA.Issues.XsrfTokenHeader={"X-Atlassian-Token":"nocheck"};JIRA.Issues.Utils={isIssueDialog:function(a){return !!a.issueId||_.include(JIRA.Dialogs,a)},isDeleteDialog:function(a){return a.options.id==="delete-issue-dialog"},isEditCommentDialog:function(a){return a.options.id==="edit-comment"},getEffectiveIssueKeyForDialog:function(a){var b=a&&a.$activeTrigger&&a.$activeTrigger.data("issuekey");if(b){return b}else{return JIRA.Issues.Api.getSelectedIssue().getKey()}},getEffectiveIssueIdForDialog:function(a){if(a.issueId){return a.issueId}else{return JIRA.Issues.Api.getSelectedIssue().getId()}},getAction:function(a){if(this.isDeleteDialog(a)){return JIRA.Issues.Actions.DELETE}else{if(this.isEditCommentDialog(a)){return JIRA.Issues.Actions.EDIT_COMMENT}else{return JIRA.Issues.Actions.UPDATE}}},getMessage:function(a){if(!this.isEditCommentDialog(a)){return a.options.issueMsg||"thanks_issue_updated"}},getMeta:function(a){if(this.isEditCommentDialog(a)){return{commentId:a.$activeTrigger.attr("id").replace("edit_comment_","")}}else{return{}}},getUpdateCommandForDialog:function(b){var a=this;if(this.isIssueDialog(b)){return{key:a.getEffectiveIssueKeyForDialog(b),id:a.getEffectiveIssueIdForDialog(b),action:a.getAction(b),message:a.getMessage(b),meta:a.getMeta(b)}}},debounce:function(a,c){var b=Array.prototype.slice.call(arguments,2);if(!a){console.error("JIRA.Issues.Utils.debounce: ctx must be defined")}clearTimeout(a[c+"DebounceTimeout"]);a[c].apply(a,b);if(!a[c+"DebounceTimeout"]){a[c+"Original"]=a[c];a[c]=_.debounce(_.bind(function(){return a[c+"Original"].apply(this,arguments)},this),300)}a[c+"DebounceTimeout"]=setTimeout(_.bind(function(){a[c]=a[c+"Original"];a[c+"DebounceTimeout"]=null},this),500)},waitForDeferreds:function(e,d,a){a=a||window;var c=[];var b=jQuery.Deferred();_.each(e,function(){var f=d.apply(a,arguments);if(f&&f.promise){c.push(f)}});if(c.length){jQuery.when.apply(jQuery,c).then(function(){b.resolveWith(a)})}else{b.resolveWith(a)}return b.promise()},resolvedPromise:function(){return jQuery.Deferred().resolve().promise()}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/AuiOverrides.js' */
AJS.undim=function(){if(AJS.dim.$dim){AJS.dim.$dim.remove();AJS.dim.$dim=null;if(AJS.dim.shim){AJS.dim.shim.remove()}if(AJS.$.browser.msie&&parseInt(AJS.$.browser.version,10)<8){AJS.$("html").removeAttr("style")}else{AJS.$("body").removeAttr("style")}}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/ScrollIntoView.js' */
/*!
 * jQuery scrollintoview() plugin and :scrollable selector filter
 *
 * Version 1.8 (14 Jul 2011)
 * Requires jQuery 1.4 or newer
 *
 * Copyright (c) 2011 Robert Koritnik
 * Licensed under the terms of the MIT license
 * http://www.opensource.org/licenses/mit-license.php
 */
(function(g){var c={vertical:{x:false,y:true},horizontal:{x:true,y:false},both:{x:true,y:true},x:{x:true,y:false},y:{x:false,y:true}};var b={duration:0,direction:"y"};var f=/^(?:html)$/i;var h=function(l,k){k=k||(document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(l,null):l.currentStyle);var j=document.defaultView&&document.defaultView.getComputedStyle?true:false;var i={top:(parseFloat(j?k.borderTopWidth:g.css(l,"borderTopWidth"))||0),left:(parseFloat(j?k.borderLeftWidth:g.css(l,"borderLeftWidth"))||0),bottom:(parseFloat(j?k.borderBottomWidth:g.css(l,"borderBottomWidth"))||0),right:(parseFloat(j?k.borderRightWidth:g.css(l,"borderRightWidth"))||0)};return{top:i.top,left:i.left,bottom:i.bottom,right:i.right,vertical:i.top+i.bottom,horizontal:i.left+i.right}};var d=function(i){var k=g(window);var j=f.test(i[0].nodeName);return{border:j?{top:0,left:0,bottom:0,right:0}:h(i[0]),scroll:{top:(j?k:i).scrollTop(),left:(j?k:i).scrollLeft()},scrollbar:{right:j?0:i.innerWidth()-i[0].clientWidth,bottom:j?0:i.innerHeight()-i[0].clientHeight},rect:(function(){var l=i[0].getBoundingClientRect();return{top:j?0:l.top,left:j?0:l.left,bottom:j?i[0].clientHeight:l.bottom,right:j?i[0].clientWidth:l.right}})()}};g.fn.extend({scrollIntoViewForAuto:function(k){k=g.extend({},b,k);k.direction=c[typeof(k.direction)==="string"&&k.direction.toLowerCase()]||c.both;var o="";if(k.direction.x===true){o="horizontal"}if(k.direction.y===true){o=o?"both":"vertical"}var m=this.eq(0);var j=m.closest(":scrollable("+o+")");if(j.length>0){j=j.eq(0);var n={e:d(m),s:d(j)};var i={top:n.e.rect.top-(n.s.rect.top+n.s.border.top),bottom:n.s.rect.bottom-n.s.border.bottom-n.s.scrollbar.bottom-n.e.rect.bottom,left:n.e.rect.left-(n.s.rect.left+n.s.border.left),right:n.s.rect.right-n.s.border.right-n.s.scrollbar.right-n.e.rect.right};var l={};if(k.direction.y===true){if(i.top<0){l.scrollTop=n.s.scroll.top+i.top-30}else{if(i.top>0&&i.bottom<0){l.scrollTop=n.s.scroll.top+Math.min(i.top,-i.bottom)+30}}}if(k.direction.x===true){if(i.left<0){l.scrollLeft=n.s.scroll.left+i.left}else{if(i.left>0&&i.right<0){l.scrollLeft=n.s.scroll.left+Math.min(i.left,-i.right)}}}if(!g.isEmptyObject(l)){if(f.test(j[0].nodeName)){j=g("html,body")}j.animate(l,k.duration).eq(0).queue(function(p){g.isFunction(k.complete)&&k.complete.call(j[0]);p()})}else{g.isFunction(k.complete)&&k.complete.call(j[0])}}return this}});var a={auto:true,scroll:true,visible:false,hidden:false};g.extend(g.expr[":"],{scrollable:function(l,j,o,i){var n=c[typeof(o[3])==="string"&&o[3].toLowerCase()]||c.both;var m=(document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(l,null):l.currentStyle);var p={x:a[m.overflowX.toLowerCase()]||false,y:a[m.overflowY.toLowerCase()]||false,isRoot:f.test(l.nodeName)};if(!p.x&&!p.y&&!p.isRoot){return false}var k={height:{scroll:l.scrollHeight,client:l.clientHeight},width:{scroll:l.scrollWidth,client:l.clientWidth},scrollableX:function(){return(p.x||p.isRoot)&&this.width.scroll>this.width.client},scrollableY:function(){return(p.y||p.isRoot)&&this.height.scroll>this.height.client}};return n.y&&k.scrollableY()||n.x&&k.scrollableX()}});var e=jQuery.fn.scrollIntoView;JIRA.Issues.overrideScrollIntoViewForSplit=function(){jQuery.fn.scrollIntoView=jQuery.fn.scrollIntoViewForAuto};JIRA.Issues.restoreScrollIntoViewForNormal=function(){jQuery.fn.scrollIntoView=e}})(jQuery);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/ClientAnalytics.js' */
AJS.namespace("JIRA.Issues.Analytics");JIRA.Issues.Analytics=_.clone(Backbone.Events);JIRA.Issues.Analytics.generateGuid=function(){return Math.random().toString(36).substring(2)+Math.random().toString(36).substring(2)};JIRA.Issues.Analytics.startTime=new Date().getTime();JIRA.Issues.Analytics.pageSessionGuid=JIRA.Issues.Analytics.generateGuid();JIRA.Issues.Analytics.stableSearchGuid=null;JIRA.Issues.Analytics.registerEventName=function(a){JIRA.Issues.Analytics.on(a,function(b){JIRA.Issues.Analytics.convertToLogEvent(a,b)})};JIRA.Issues.Analytics.registerEventNames=function(a){_.each(a,JIRA.Issues.Analytics.registerEventName)};JIRA.Issues.Analytics.initTrackers=function(b){var c={type:"click",handler:a,context:document};function a(f,d){JIRA.Issues.Analytics.convertToLogEvent(this.name,d)}_.each(b,function(d){_.defaults(d,c);JIRA.Issues.Analytics.registerEventName(d.name);AJS.$(d.context).delegate(d.selector,d.type,function(f){if(!f.preventFurtherAnalytics){d.handler.apply(d,Array().slice.call(arguments))}})})};JIRA.Issues.Analytics.convertToLogEvent=function(b,c){var a="***** Analytics log ["+b+"]";c=c||{};c.context_pageSession=JIRA.Issues.Analytics.pageSessionGuid;c.context_pageTime=new Date().getTime()-JIRA.Issues.Analytics.startTime;if(JIRA.Issues.Analytics.stableSearchGuid){c.context_stableSearch=JIRA.Issues.Analytics.stableSearchGuid}a+="["+JSON.stringify(c)+"]";AJS.log(a);if(AJS.EventQueue){AJS.EventQueue.push({name:b,properties:c||{}})}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/IssueNavFeatures.js' */
AJS.namespace("JIRA.Issues.Feature");JIRA.Issues.Feature=Class.extend({init:function(a){this.featureKey=a},enabled:function(){return AJS.DarkFeatures.isEnabled(this.featureKey)}});AJS.namespace("JIRA.Issues.GhettoFeature");JIRA.Issues.GhettoFeature=JIRA.Issues.Feature.extend({enabled:function(){return this._super()&&(!this._ieGhetto.enabled()||history.pushState)},_ieGhetto:new JIRA.Issues.Feature("ka.ghetto")});JIRA.Issues.KillSwitchFeature=JIRA.Issues.Feature.extend({enabled:function(){var a=AJS.DarkFeatures.isEnabled("ka.ghetto")&&!history.pushState;return this._super()||a}});AJS.namespace("JIRA.Issues.DarkFeatures");JIRA.Issues.DarkFeatures={KILL_SWITCH:new JIRA.Issues.KillSwitchFeature("ka.KILL_SWITCH"),NO_PREFETCH:new JIRA.Issues.GhettoFeature("ka.NO_PREFETCH"),PROJECT_SHORTCUTS:new JIRA.Issues.Feature("rotp.project.shortcuts")};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/analytics.js' */
(function(){JIRA.Issues.Analytics.registerEventNames(["kickass.search","kickass.switchtobasic","kickass.switchtoadvanced","kickass.returntosearch","kickass.editField","kickass.editMultipleFields","kickass.editClientDuration","kickass.editClientCancelledDuration","kickass.editSaveonserverDuration","kickass.issueLoadDuration","kickass.openIssueFromTable","kickass.issueTotalSaveDuration","kickass.focusshifteropened","kickass.queryTooComplexSwitchToAdvanced","kickass.basicModeCriteriaCountWhenSearching","kickass.criteriaAutoUpdateEnabled","kickass.issueTableRefresh","kickass.conditionalLoading"]);JIRA.Issues.Analytics.trigger("kickass.criteriaAutoUpdateEnabled",{enabled:AJS.Meta.getBoolean("hasCriteriaAutoUpdate")});JIRA.Issues.Analytics.initTrackers([{name:"kickass.clickedOnSystemFilter",selector:".system-filters a",handler:a},{name:"kickass.clickedOnFavouriteFilter",selector:".favourite-filters a.push-state"},{name:"kickass.clickedOnFavouriteFilterActionsMenu",selector:".favourite-filters a.filter-actions"},{name:"kickass.renamedFilterFromActionsMenu",selector:"#rename-filter-form",type:"submit"},{name:"kickass.deletedFilterFromActionsMenu",selector:"#delete-filter-form",type:"submit"},{name:"kickass.copiedFilterFromActionsMenu",selector:"#copy-filter-dialog form",type:"submit"},{name:"kickass.removeFilterFromFavouritesViaActionsMenu",selector:".unfavourite-filter"},{name:"kickass.saveACopyOfFilterFromSearchHeader",selector:"#save-filter-dialog form",type:"submit"},{name:"kickass.filterChangesSaved",selector:".header-section-primary .save-changes"},{name:"kickass.clickedOnShowFiltersDetailsDropDown",selector:".show-filter-details",type:"mousedown"},{name:"kickass.clickedOnChangePermissions",selector:".filter-permissions .change-permissions"},{name:"kickass.clickedOnUnfavouriteStar",selector:".filter-operations .fav-link.off"},{name:"kickass.clickedOnSaveFilterAs",selector:".save-as-new-filter",handler:f},{name:"kickass.clickedOnPagniationLink",selector:".pagination a",handler:e},{name:"kickass.inbrowsersearch",type:"keydown",handler:c},{name:"kickass.reloadPage",type:"keydown",handler:g},{name:"kickass.moreCriteriaNewlySelectedCount",type:AJS.InlineLayer.EVENTS.beforeHide,handler:d},{name:"kickass.createdNewSearch",selector:".new-search"},{name:"kickass.sortByColumn",selector:".sortable",handler:b},{name:"kickass.findFiltersClicked",selector:".find-filters"}]);function a(j){var i=AJS.$(j.target);JIRA.Issues.Analytics.trigger(this.name,{name:h(i.attr("href"))})}function f(){var j=AJS.$(".system-filters a.active").length===1,i=AJS.$(".favourite-filters a.active").length===1;JIRA.Issues.Analytics.trigger(this.name,{systemFilterSelected:j,favouriteFilterSelected:i})}function h(i){var j=parseUri(i);return j.queryKey.filter}function e(k){var j=AJS.$(k.target),i=j.text();JIRA.Issues.Analytics.trigger(this.name,{page:i})}function c(i){if(i.keyCode===70&&(i.metaKey||i.ctrlKey)){JIRA.Issues.Analytics.trigger(this.name)}}function g(i){if(i.keyCode===82&&(i.metaKey||i.ctrlKey)){JIRA.Issues.Analytics.trigger(this.name)}}function d(l,j){if(j&&j.find("#criteria-multi-select").length){var k=AJS.$("#criteria-multi-select");var i=k.find("input[checked]").length-k.find(".selected-group input[checked]").length;JIRA.Issues.Analytics.trigger(this.name,{count:i})}}function b(i){var j=jQuery(i.target);if(!j.is("th")){j=j.parent("th")}if(j.length){JIRA.Issues.Analytics.trigger(this.name,{direction:j.hasClass("ascending")?"descending":"ascending",column:j.data("id")})}}})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/Stalker.js' */
(function(b){var a;b.fn.stalker=function(d){var e=this,h;if(!e.length||e.data("stalker-applied")){return}e.data("stalker-applied",true);d=d||{};d.offsetTop=d.offsetTop||0;function g(){if(a){e.css({position:"",top:"",left:"",right:"",height:""}).removeClass("detached");e.unbind("stalkerHeightUpdated",j);a.remove();a=null}}function f(){if(!a){a=jQuery("<div class='stalker-placeholder' />").css("visibility","hidden").addClass(e[0].className).height(e.outerHeight()).width(e.outerWidth()).insertBefore(e);e.bind("stalkerHeightUpdated",j);e.css({position:"fixed",top:d.offsetTop,left:h.left,right:h.right}).addClass("detached");if(typeof c.timeout==="undefined"){c()}}}function j(){a.height(e.height())}function i(){if(!e.is(":visible")){return}if(!h){h=e.offset()}if(b(window).scrollTop()+d.offsetTop>=h.top){f()}else{g()}}function c(){if(a){i();c.timeout=setTimeout(c,250)}else{delete c.timeout}}b(window).bind("resize scroll",i);i();return{unstalk:function(){g();b(window).unbind("resize scroll",i)}}}})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/Sidebar.js' */
/*!
 * jQuery UI Sidebar
 * http://jqueryui.com
 *
 * Depends:
 *   jquery.ui.widget.js
 */
(function(a){a.widget("ui.sidebar",{version:"0.1",options:{minWidth:function(b){return 50},maxWidth:function(b){return jQuery(window).width()},resize:a.noop,easeOff:(jQuery.browser.msie&&jQuery.browser.version<=8)?500:0},_create:function(){_.bindAll(this);if(this.options.easeOff){this.updatePosition=_.debounce(this.updatePosition,this.options.easeOff)}if(!this.options.id){console.error("ui.sidebar: You must specify an id")}this._addHandle();this._restore();this.handle.mousedown(this._setContainment);this.handle.draggable({axis:"x",drag:this._handleDrag,stop:this._persist});a(window).resize(_.debounce(this.updatePosition,30))},_restore:function(){if(window.localStorage){var b=localStorage.getItem("ui.sidebar."+this.options.id);if(b){this._setWidth(b)}}},_persist:function(){if(window.localStorage){localStorage.setItem("ui.sidebar."+this.options.id,this.element.outerWidth())}},_setContainment:function(){var b=jQuery(window).height();this._elementLeft=this.element.offset().left;this._minLeft=this._elementLeft+this.options.minWidth(this);this._maxLeft=Math.max(this._minLeft,this._elementLeft+this.options.maxWidth(this));this.handle.draggable({containment:[this._minLeft,b,this._maxLeft,b]})},_handleDrag:function(d,b){var c=b.position.left-this._elementLeft;this._setWidth(c,true)},_setWidth:function(e,d){if(!d){var c=this.options.maxWidth(this);var b=this.options.minWidth(this);if(e>c){e=c}else{if(e<b){e=b}}}e-=this.element.outerWidth()-this.element.width();this.element.width(e);this.options.resize(e)},_addHandle:function(){this.handle=jQuery("<div />").addClass("ui-sidebar").appendTo(this.element);_.defer(this._setHandlePosition)},_setHandlePosition:function(){this._setContainment();if(this._minLeft===this._maxLeft){this.handle.hide()}else{var c=this.element.offset();var b=c.left+this.element.outerWidth();this.handle.css({top:c.top,left:b,height:this.element.outerHeight()}).show()}},updatePosition:function(){this._setHandlePosition();this._setWidth(this.handle.offset().left-this._elementLeft);this._persist()}})})(jQuery);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/PopoutSidebar.js' */
(function(a){a.widget("ui.popoutSidebar",{version:"0.1",options:{renderExpanded:a.noop,renderCollapsed:a.noop,persist:a.noop,collapsedWidth:30,expandedWidth:200,minWidth:function(){return 200},maxWidth:function(){return 500},resize:a.noop,dockText:"Dock",undockText:"Undock",dockTitle:"Dock the filter panel so you can always see the list of filters",undockTitle:"Undock the filter panel so it is hidden when not being focused"},CLASS_NAMES:{popout:"ui-popout",placeholder:"ui-popout-placeholder",detached:"ui-popout-detached",expanding:"ui-popout-expanding",expanded:"ui-popout-expanded",collapsed:"ui-popout-collapsed",collapsing:"ui-popout-collapsing"},_create:function(){_.bindAll(this);if(!this.element.data("popoutsidebar")){this.element.data("popoutsidebar",true);var b=!!jQuery.browser.msie&&jQuery.browser.version<=8;this.element.bind("updateOffsets.popout",b?_.debounce(this.updateOffsets,200):this.updateOffsets);this.element.bind("updateOffsets.reset",this.reset);this.element.delegate(".ui-dock","click",_.bind(function(c){this.dock(true);c.preventDefault()},this));this.element.delegate(".ui-undock","click",_.bind(function(c){this.undock(true);c.preventDefault()},this));this.isDocked=this.options.isDocked;this.expandedWidth=this.options.expandedWidth;this.useTransitions=!jQuery.browser.msie||parseInt(jQuery.browser.version,10)>8;if(this.options.isDocked){this._renderUnDock()}else{this._enableUndockedMode()}this.updateOffsets()}},_init:function(){if(this.options.isDocked){this._setupHandle()}},_persistState:function(){this.expandedWidth=this.element.outerWidth();this.options.persist(this.isDocked,this.expandedWidth)},_setContainment:function(){var b=jQuery(window).height();this._elementLeft=this.element.offset().left;this._minLeft=this._elementLeft+this.options.minWidth();this._maxLeft=Math.max(this._minLeft,this._elementLeft+this.options.maxWidth());this.handle.draggable({containment:[this._minLeft,b,this._maxLeft,b]});this.handle.css("position","absolute")},_setWidth:function(b){b=Math.min(Math.max(this.options.minWidth(),b),this.options.maxWidth());this.element.width(b)},_setupHandle:function(){this._getContents();this.handle=jQuery("<div />").addClass("ui-sidebar").appendTo(this.element);this._setWidth(this.expandedWidth);this._setHandlePosition();this.handle.mousedown(this._setContainment);this.handle.draggable({axis:"x",drag:this._handleDrag,stop:this._persistState})},_setHandlePosition:function(){this._setContainment();if(this._minLeft===this._maxLeft){this.handle.hide()}else{var b=this.element.offset();var c=b.left+this.element.outerWidth();this.handle.css({left:c}).show()}},_handleDrag:function(d,b){var c=b.position.left;this._setWidth(c);this.options.resize()},_getUndockedClasses:function(){return[this.CLASS_NAMES.detached].join(" ")},_getUndockedStates:function(){return[this.CLASS_NAMES.collapsed,this.CLASS_NAMES.collapsing,this.CLASS_NAMES.expanding,this.CLASS_NAMES.expanded].join(" ")},_setUndockedState:function(b){this.element.removeClass(this._getUndockedStates());this.element.addClass(b)},unbindHoverIntent:function(){this.element.off("mouseleave mouseenter mousemove");this.element[0].hoverIntent_s=0},bindHoverIntent:function(){this.element.hoverIntent({interval:40,over:this.expand,out:this.collapse,sensitivity:8})},_unbindUnDockedEvents:function(){this.unbindHoverIntent();JIRA.unbind(AJS.InlineLayer.EVENTS.show,this._handleDropdown);a(window).unbind("scroll",this.updateOffsets)},_bindUnDockedEvents:function(b){this.bindHoverIntent();a(window).scroll(this.updateOffsets);this.element[0].hoverIntent_s=b?1:0},isUndocked:function(){return this.element.hasClass(this.CLASS_NAMES.detached)},_registerMousePos:function(b){this._clientX=b.clientX;this._clientY=b.clientY},_handleDropdown:function(){a(document).mousemove(this._registerMousePos);if(this.isUndocked()&&AJS.InlineLayer.current.offsetTarget().closest(this.element).size()){this.unbindHoverIntent();JIRA.one(AJS.InlineLayer.EVENTS.hide,_.bind(function(){_.defer(_.bind(function(){if(!AJS.InlineLayer.current){if(JIRA.Dialog.current||this._clientX>this.element.offset().left+this.element.outerWidth()){this.collapse(JIRA.Dialog.current?false:true);this.bindHoverIntent()}else{this.bindHoverIntent();this.element[0].hoverIntent_s=1}a(document).unbind("mousemove",this._registerMousePos)}},this))},this))}},updateOffsets:function(f){if(this.element.is(":visible")){var d=a("body").height()>a(window).height();if(d){this.element.addClass("ui-sidebar-scrollable")}else{this.element.removeClass("ui-sidebar-scrollable")}if(this.isUndocked()){var c=this._getPlaceholder().offset().top;var g=jQuery(window).scrollTop();var h=Math.max(c-g,0);var b=d?a(window).height()-h:Math.min(this._getPlaceholder().outerHeight(),a(window).height()-this._getPlaceholder().offset().top);var e={top:h,height:b};if(f){e.width=f}this.element.css(e)}}},_renderUnDock:function(){if(this.isDocked&&!this.element.find(".ui-undock").size()){this.element.find(".ui-dock").remove();this._renderDockingLink(this.options.undockText,this.options.undockTitle,"ui-undock")}},_renderDock:function(){if(this.isUndocked()&&!this.element.find(".ui-dock").size()){this.element.find(".ui-undock").remove();this._renderDockingLink(this.options.dockText,this.options.dockTitle,"ui-dock")}},_renderDockingLink:function(e,d,b){var c=a("<a class='aui-button aui-button-subtle' href='#'/>").addClass(b).append(a("<span class='icon'/>").text(e)).attr("title",d);this.dockTipsy=new JIRA.Issues.Tipsy({el:c});this._getContents().find(this.options.toggleTarget).append(c)},renderDockState:function(){if(this.isDocked){this._renderUnDock()}else{this._renderDock()}},_enableUndockedMode:function(b){this.element.addClass(this.CLASS_NAMES.popout);if(!this.isUndocked()){this._getPlaceholder().insertBefore(this.element);this.element.addClass(this.CLASS_NAMES.detached).addClass(this.CLASS_NAMES.collapsed).appendTo("body")}this.updateOffsets();this._bindUnDockedEvents(b);JIRA.bind(AJS.InlineLayer.EVENTS.show,this._handleDropdown)},_getPlaceholder:function(){if(!this.placeholder){this.placeholder=a("<div class='navigator-sidebar collapsed' />")}return this.placeholder},toggle:function(){if(!this.isExpanding()&&!this.isCollapsing()){if(this.isDocked){this.undock(false)}else{this.dock(false)}}},undock:function(b){if(!this.isUndocked()){this.isDocked=false;if(this.dockTipsy){this.dockTipsy.remove();this.dockTipsy=null}this._persistState();this._getPlaceholder().insertBefore(this.element);this.element.addClass(this._getUndockedClasses()+" "+this.CLASS_NAMES.expanded).appendTo("body");if(b!==false&&this.useTransitions){this._getPlaceholder().width(this.expandedWidth).animate({width:this.options.collapsedWidth},200)}else{this._getPlaceholder().width(this.options.collapsedWidth)}this.updateOffsets(this.expandedWidth);this.collapse(b,_.bind(function(){this._enableUndockedMode(false)},this))}},dock:function(b){if(this.isUndocked()){this.isDocked=true;if(this.dockTipsy){this.dockTipsy.remove();this.dockTipsy=null}this._unbindUnDockedEvents();this._persistState();if(b!==false&&this.useTransitions){this._getPlaceholder().animate({width:this.expandedWidth},200,_.bind(this._dockingComplete,this))}else{this._dockingComplete()}}},_dockingComplete:function(){this.element.removeClass(this._getUndockedClasses());this.element.removeClass(this._getUndockedStates());this.element.css({height:"",width:"",top:""}).insertBefore(this._getPlaceholder());this._getPlaceholder().remove();this.options.renderExpanded(this.element);this._setupHandle();this._renderUnDock();JIRA.Issues.triggerHorizontalResize()},_getContents:function(){if(!this.element.find(".ui-sidebar-content").size()){this.element.wrapInner("<div class='ui-sidebar-content' />")}return this.element.find(".ui-sidebar-content")},expand:function(b){if(this.isCollapsed()){this.updateOffsets();if(b!==false&&this.useTransitions){this._setUndockedState(this.CLASS_NAMES.expanding);this.element.animate({width:this.expandedWidth},150,_.bind(function(){this._setUndockedState(this.CLASS_NAMES.expanded);this.options.renderExpanded(this.element);this._renderDock();this._getContents().css("opacity",0).animate({opacity:1},200,_.bind(this._expandingComplete,this))},this))}else{this.element.css("width",this.expandedWidth);this.options.renderExpanded(this.element);this._renderDock();this._expandingComplete()}}else{if(this.isCollapsing()){this.activityAfterTransition="expand"}else{if(this.isExpanding()){this.activityAfterTransition=null}}}},_expandingComplete:function(){JIRA.Issues.triggerHorizontalResize();this._bindUnDockedEvents(true);this._setUndockedState(this.CLASS_NAMES.expanded);if(this.activityAfterTransition==="collapse"){this.activityAfterTransition=null;this.collapse(true)}},collapse:function(b,c){if(this.isExpanded()){if(b!==false&&this.useTransitions){this._setUndockedState(this.CLASS_NAMES.collapsing);this._getContents().animate({opacity:0},150,_.bind(function(){this.options.renderCollapsed(this.element);this.element.width(this.expandedWidth);this.element.animate({width:this.options.collapsedWidth},150,_.bind(function(){this._collapsingComplete(c)},this))},this))}else{this.options.renderCollapsed(this.element);this.element.width("");this._collapsingComplete(c)}}else{if(this.isExpanding()){this.activityAfterTransition="collapse"}else{if(this.isCollapsing()){this.activityAfterTransition=null}}}},_collapsingComplete:function(b){this._setUndockedState(this.CLASS_NAMES.collapsed);JIRA.Issues.triggerHorizontalResize();this._bindUnDockedEvents(false);if(this.activityAfterTransition==="expand"){this.activityAfterTransition=null;this.expand(true)}if(typeof b==="function"){b()}},isCollapsed:function(){return this.element.hasClass(this.CLASS_NAMES.collapsed)},isCollapsing:function(){return this.element.hasClass(this.CLASS_NAMES.collapsing)},isExpanded:function(){return this.element.hasClass(this.CLASS_NAMES.expanded)},isExpanding:function(){return this.element.hasClass(this.CLASS_NAMES.expanding)}})}(jQuery));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/HtmlCatchExceptions.js' */
(function(b){var a=function(c){return function(d){try{c.apply(this,arguments)}catch(f){if(console&&console.error&&typeof d==="string"){console.error("Error while evaluating HTML: "+f.message+", in: ",d)}}return this}};b.fn.htmlCatchExceptions=a(b.fn.html);b.fn.appendCatchExceptions=a(b.fn.append);b.fn.prependCatchExceptions=a(b.fn.prepend);b.catchExceptions=function(c){return b("<div>").htmlCatchExceptions(c).children()}})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/ScrollLock.js' */
(function(b){var a=30;b.fn.scrollLock=function(c,d){if(typeof c!=="string"){d=c;c=null}if(!d){d=a}this.on("DOMMouseScroll mousewheel",c,function(f){f.preventDefault();var g;if(f.originalEvent.wheelDelta){g=f.originalEvent.wheelDelta/120}if(f.originalEvent.detail){g=-f.originalEvent.detail/3}this.scrollTop-=g*d})}})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/mixin/SingleSelect.js' */
AJS.namespace("JIRA.Issues.Mixin.SingleSelect");JIRA.Issues.Mixin.SingleSelect={properties:["collection"],selectById:function(a){this.setSelected(this.getCollection().get(a))},selectAt:function(a){this.setSelected(this.getCollection().at(a))},clearSelection:function(){this.setSelected()},next:function(){var d=this.getSelected(),c=this.getCollection();if(!d){if(c.length>0){this.setSelected(c.first())}}else{var b=c.indexOf(d);var a=(b+1)%c.length;this.setSelected(c.at(a))}},prev:function(){var d=this.getSelected(),c=this.getCollection();if(!d){if(c.length>0){this.setSelected(c.last())}}else{var b=c.indexOf(d);var a=(b+c.length-1)%c.length;this.setSelected(c.at(a))}}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/mixin/LoadingClass.js' */
AJS.namespace("JIRA.Issues.Mixin.LoadingClass");JIRA.Issues.Mixin.LoadingClass={addLoadingClass:function(){this.$el.addClass("loading")},removeLoadingClass:function(){this.$el.removeClass("loading")}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/QueryStringParser.js' */
AJS.namespace("JIRA.Issues.QueryStringParser");JIRA.Issues.QueryStringParser={parser:/(?:^|&)([^&=]*)=?([^&]*)/g,parse:function(b){if(!b&&b!==0){return{}}b=""+b;if("?"===b.charAt(0)){b=b.substring(1)}var a={};b.replace(this.parser,function(d,c,f){var e=decodeURIComponent((f||"").replace(/\+/g," "));a[decodeURIComponent(c)]=e});return a}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/IssueEventBus.js' */
JIRA.Issues.IssueEventBus=JIRA.Issues.BaseModel.extend({properties:["issueId"],namedEvents:["save","saveSuccess","savingStarted","saveError","panelRendered","replacedFocusedPanel","fieldSubmitted","dismiss","refreshIssue","issueRefreshed","updateFromDom","updateStatusColor","quickEditKeyPressed","openFocusShifter"]});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/DefaultMessageOptions.js' */
AJS.namespace("JIRA.Issues.getDefaultMessageOptions",window,function(){return{closeable:true,timeout:5}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/viewissue/model/IssuePanelModel.js' */
Backbone.define("JIRA.Issues.IssuePanelModel",JIRA.Issues.BaseModel.extend({properties:["entity","updateLocked"],namedEvents:["updated"],initialize:function(){JIRA.bind(JIRA.Events.LOCK_PANEL_REFRESHING,_.bind(function(a,b){if(b===this.getEntity().id){this.setUpdateLocked(true)}},this));JIRA.bind(JIRA.Events.UNLOCK_PANEL_REFRESHING,_.bind(function(a,b){if(b===this.getEntity().id){this.setUpdateLocked(false)}},this))},applyUpdates:function(f,b,e,c){if((AJS.$.browser.msie&&parseInt(AJS.$.browser.version,10)<9)&&f.text()===b.text()){return false}var d,a,g=[];var h=_.any(c,function(i){return b.find(JIRA.Issues.IssueFieldUtil.getFieldSelector(i)).length===1});if(!h){a=f;d="replace";g.push(f)}else{_.each(e,function(k){var j=b.find(JIRA.Issues.IssueFieldUtil.getFieldSelector(k));if(j.length===1){var i=f.find(JIRA.Issues.IssueFieldUtil.getFieldSelector(k));if(i.length===1){j.replaceWith(i);g.push(i)}else{j.closest("li, dl").remove()}}});d="update";a=b}return{type:d,$existing:b,$el:a,updates:g}},update:function(a,b){if(!this.getUpdateLocked()){this.setEntity(a);this.triggerUpdated(b)}},getPanelId:function(){return(this.getEntity().prefix||"")+this.getEntity().id}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/viewissue/model/IssuePanelsModel.js' */
Backbone.define("JIRA.Issues.IssuePanelsModel",JIRA.Issues.BaseModel.extend({properties:["leftPanels","rightPanels","infoPanels"],namedEvents:["panelRemoved","panelAdded"],initialize:function(){this.set({leftPanels:[],rightPanels:[],infoPanels:[]},{silent:true})},update:function(b,a){this.updatePanels("leftPanels",b.leftPanels,a);this.updatePanels("rightPanels",b.rightPanels,a);this.updatePanels("infoPanels",b.infoPanels,a)},updatePanels:function(g,b,d){var i=this;var j=this.get(g);var f=[];var a=d.changed;if(a){var c=a.updated&&a.updated.panels?a.updated.panels[g]:[];var e=a.added&&a.added.panels?a.added.panels[g]:[];var k=a.deleted&&a.deleted.panels?a.deleted.panels[g]:[];if(!_.isEmpty(k)){_.each(j,function(m){var l=m.getEntity().id;if(_.contains(k,l)){i.triggerPanelRemoved({location:g,panel:m})}})}_.each(b,function(m,n){var o=m.id;if(_.contains(e,o)){var l=new JIRA.Issues.IssuePanelModel({id:m.id,entity:m});if(!d.initialize){i.triggerPanelAdded({location:g,panel:l,index:n},b)}f.push(l)}else{if(!_.contains(k,o)){var p=_.find(j,function(q){return q.id===o});if(_.contains(c,o)){p.update(m,d)}f.push(p)}}})}else{_.each(j,function(m){var l=m.getEntity().id;if(!_.any(b,function(n){return n.id===l})){i.triggerPanelRemoved({location:g,panel:m})}});_.each(b,function(m,n){var l=_.find(j,function(o){return o.id===m.id});if(l){l.update(m,d)}else{l=new JIRA.Issues.IssuePanelModel({id:m.id,entity:m});if(!d.initialize){i.triggerPanelAdded({location:g,panel:l,index:n},b)}}f.push(l)})}var h={};h[g]=f;this.set(h,{silent:true})},createPlaceholderModel:function(d,c){var b,a=this.get(d);if(!_.any(a,function(e){return e.id===c})){b=new JIRA.Issues.IssuePanelModel({id:c,entity:{id:c}});a.push(b);return b}}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/viewissue/model/IssueViewModel.js' */
Backbone.define("JIRA.Issues.IssueViewModel",JIRA.Issues.BaseModel.extend({namedEvents:["updated"],properties:["entity","id","issueEventBus","issuePagerModel","panels","pager","standalone","statusColorSupport","splitViewMode"],defaults:function(){return{splitViewMode:false}},initialize:function(){_.bindAll(this);this.set({panels:new JIRA.Issues.IssuePanelsModel()});if(this.getStatusColorSupport()){this.on("change",_.bind(function(){this.getIssueEventBus().triggerUpdateStatusColor()},this))}},isStandalone:function(){return jQuery("body").hasClass("standalone-viewissue")},update:function(b,a){this.setEntity(b.issue);this.getPanels().update(b.panels,a);this.triggerUpdated(a)},updateFromDom:function(a){this.setEntity(a)},dismiss:function(){this.getIssueEventBus().triggerDismiss()}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/viewissue/model/IssuePagerModel.js' */
Backbone.define("JIRA.Issues.IssuePagerModel",JIRA.Issues.BaseModel.extend({properties:["pager"],namedEvents:["returnToSearch"],update:function(a){this.set("pager",a)}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/SessionTimedOutDialog.js' */
AJS.namespace("JIRA.Issues.SessionTimedOutDialog");JIRA.Issues.SessionTimedOutDialog={dialogHasShown:false,whiteList:["/secure/Search!Jql.jspa","/secure/SearchRendererEdit!Default.jspa","/rest/issueNav/1/issueTable","/rest/issueNav/latest","/rest/api/2/filter"],onRequestResponse:function(f,g,d){if(!this.dialogHasShown&&this.urlIsInWhiteList(d.url)){var b=JIRA.Issues.LoginUtils.loggedInUserName(),a=g.getResponseHeader("X-AUSERNAME");if(this.userHasChanged(b,a)){this.dialogHasShown=true;var c=new JIRA.FormDialog({content:AJS.$(JIRA.Templates.Issues.Util.anonymousErrorDialog({modifierKey:AJS.Navigator.modifierKey(),redirect:window.location.href.substring(window.location.href.indexOf(contextPath)+contextPath.length)}))});c.show()}}},userHasChanged:function(b,a){if(b===""&&a==="anonymous"){return false}if(b===""&&a&&a!=="anonymous"&&a!==""){return false}if(b!==""&&a==="anonymous"){return true}return false},urlIsInWhiteList:function(b){for(var c=0;c<this.whiteList.length;c++){var a=this.whiteList[c];if(b.indexOf(a)>-1){return true}}return false}};(function(a){a(document).ajaxComplete(function(c,d,b){JIRA.Issues.SessionTimedOutDialog.onRequestResponse(c,d,b)})})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/LoginUtils.js' */
JIRA.Issues.LoginUtils={isLoggedIn:function(){return !!this.loggedInUserName()},loggedInUserName:function(){return AJS.Meta.get("remote-user")},currentContextRelativePath:function(){var b=this._getWindowLocation();var c=b.protocol+"//"+b.host+(contextPath||"");var a=b.href;if(a.indexOf(c)===0){return a.substr(c.length)}return a},redirectUrlToCurrent:function(){var a=this.currentContextRelativePath();return contextPath+"/login.jsp?os_destination="+encodeURIComponent(a)},redirectUrl:function(a){return contextPath+"/login.jsp?os_destination="+encodeURIComponent(a)},_getWindowLocation:function(){return window.location}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/ConcurrentDeferred.js' */
jQuery.ConcurrentDeferred=function(c){var b=jQuery.Deferred();var d;var a=function(e){d=e;e.done(function(){if(d===e){b.resolve.apply(b,arguments)}}).fail(function(){if(d===e){b.reject.apply(b,arguments)}})};a(c);jQuery.extend(b,{update:function(e){if(!this.isPending()){throw"Cannot update non-pending ConcurrentDeferred"}var f=d;a(e);if(jQuery.isFunction(f.abort)){f.abort()}return this},isPending:function(){return this.state()==="pending"}});return b};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/RecurringPromise.js' */
jQuery.RecurringPromise=function(a){if(!(this instanceof jQuery.RecurringPromise)){return new jQuery.RecurringPromise()}this._parent=a;this._doneCallbacks=jQuery.Callbacks();this._failCallbacks=jQuery.Callbacks();this._alwaysCallbacks=jQuery.Callbacks()};jQuery.RecurringPromise.prototype={add:function(b){var a=jQuery.Deferred();a.original=b;var c=this._getPending();this._setPending(a);this._abortIfPending(c);b.done(_.bind(function(){if(this._getPending()===a){this._getPending().resolveWith(this,arguments);this._doneCallbacks.fireWith(this,arguments)}},this));b.fail(_.bind(function(){if(this._getPending()===a){this._getPending().rejectWith(this,arguments);this._failCallbacks.fireWith(this,arguments)}},this));b.always(_.bind(function(){if(this._getPending()===a){this._alwaysCallbacks.fireWith(this,arguments)}},this));return a.promise()},done:function(a){this._doneCallbacks.add(a);return this},fail:function(a){this._failCallbacks.add(a);return this},always:function(a){this._alwaysCallbacks.add(a);return this},reset:function(){this._abortIfPending(this._getPending());this._setPending(null)},sub:function(){return new jQuery.RecurringPromise(this)},_getPending:function(){return this._parent?this._parent._getPending():this._pending},_setPending:function(a){if(this._parent){this._parent._setPending(a)}else{this._pending=a}},_abortIfPending:function(a){if(a&&a.state()==="pending"){a.reject("abort");if(jQuery.isFunction(a.original.abort)){a.original.abort()}}}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/AsyncData.js' */
Backbone.define("JIRA.Issues.AsyncData",JIRA.Issues.BaseEvented.extend({namedEvents:["change"],initialize:function(a){this.data={};this.pendings={};this.accessIndex=0;if(a){this.disableCache=a.disableCache;this.maxCacheSize=a.maxCacheSize}},get:function(b,a,i){var g=jQuery.Deferred();var d=this.disableCache?{}:this.data;var f=_.bind(function(m,l){var k=this._set(d,b,_.defaults(m,{accessIndex:this.accessIndex++}),true,i);var j=_.defaults({changed:k},l,d[b]);if(i&&i.mergeIntoCurrent){j.mergeIntoCurrent=true}if(d[b]&&!d[b].error){g.resolve(d[b].value,j,i)}else{g.reject(d[b]&&d[b].value,j,i)}},this);var c=_.bind(function(j){var k=this.fetch(b,i);this.setPending(b,k,function(l){f({value:l,error:false,updated:new Date()},{initialLoad:j})},function(l){var m={error:true,updated:new Date()};if(l!==undefined){m.value=l}f(m,{initialLoad:j,error:true})})},this);var e=function(){f({},{fromCache:true})};var h=_.bind(function(){this.pendings[b].always(_.bind(f,this,{},{initialLoad:true}))},this);if(a||this.disableCache){c(false)}else{if(this.hasCached(b)){e()}else{if(this.hasPending(b)){h()}else{c(true)}}}return g.promise()},setPending:function(d,b,a,c){if(this.hasPending(d)){this.pendings[d].update(b)}else{this.pendings[d]=jQuery.ConcurrentDeferred(b)}return this.pendings[d].done(function(e){a(e)}).fail(function(e){c(e)})},getIdByValue:function(a){var b;for(b in this.data){if(this.data[b].value===a){return b}}return null},getMeta:function(a){return this.data[a]||{}},getAllCached:function(){var a={};_.each(this.data,function(b,c){a[c]=b.value});return a},hasCached:function(b){var a=this.getMeta(b);return a.value!==undefined||a.error===true},hasError:function(b){var a=this.getMeta(b);return a.error===true},hasPending:function(b){var a=this.pendings[b];return a?a.isPending():false},set:function(b,a){return this._set(this.data,b,{value:a,updated:new Date()},true)},remove:function(a){if(this.data[a]){delete this.data[a];this.triggerChange();return true}return false},setError:function(c,a){var b={error:true,updated:new Date()};if(a!==undefined){b.value=a}return this._set(this.data,c,b,true)},setMultiple:function(b){var a=new Date();var c=false;_.each(b,_.bind(function(d,e){d=_.pick(d,"value","error");d.updated=a;if(this._set(this.data,e,d,false)){c=true}},this));if(c){this.triggerChange()}return c},reset:function(a){this.data={};this.pendings={};this.accessIndex=0;if(a){this.setMultiple(a)}else{this.triggerChange()}},_set:function(e,g,f,c,b){if(this.disableCache&&e===this.data){e={}}var d=e[g]?_.clone(e[g]):{};var a=this.mergeFetchedAndCached(d,f,b?b:{},e[g]);if(c&&(!e[g]||a||e[g].error!==d.error)&&e===this.data){this.triggerChange()}if(!e[g]&&this.maxCacheSize&&_.keys(e).length===this.maxCacheSize){if(f.accessIndex){this._dropItem(e);e[g]=d}}else{e[g]=d}return a},_dropItem:function(c){var a=null;for(var b in c){if(!c[b].accessIndex){a=b;break}else{if(a===null||c[b].accessIndex<c[a].accessIndex){a=b}}}if(a!==null){delete c[a]}},fetch:function(d,b){var c=this.getMeta(d);var a=jQuery.Deferred();if(!this.hasCached(d)||c.error){a.reject(c.value)}else{a.resolve(c.value)}return a.promise()},mergeFetchedAndCached:function(b,d,a,c){_.extend(b,d);return !c||c.value!==b.value||c.error!==b.error}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/search/cache/IssueCacheManager.js' */
(function(){Backbone.define("JIRA.Issues.Cache.IssueCacheManager",JIRA.Issues.BaseEvented.extend({initialize:function(a){this.searchResults=a.searchResults;this.viewIssueData=a.viewIssueData;this.searchResults.bind("issueDeleted",this._onIssueDeleted,this);this.searchResults.bind("nextIssueSelected",this._onNextIssueSelected,this);this.searchResults.bind("prevIssueSelected",this._onPrevIssueSelected,this);this._prefetchCandidate=null},prefetchIssues:function(){if(this._prefetchCandidate&&this._prefetchCandidate.key){this._prefetchIssue(this._prefetchCandidate.key);this._prefetchCandidate=null}},scheduleIssueToBePrefetched:function(a){this._prefetchCandidate=a},_onIssueDeleted:function(a){this.viewIssueData.remove(a.key)},_onNextIssueSelected:function(a){this._prefetchCandidate=a.nextNextIssue},_onPrevIssueSelected:function(a){this._prefetchCandidate=a.prevPrevIssue},_prefetchIssue:function(a){if(!JIRA.Issues.DarkFeatures.NO_PREFETCH.enabled()){this.viewIssueData.get(a,false,{prefetch:true})}}}))})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/search/issue/IssueModule.js' */
Backbone.define("JIRA.Issues.IssueModule",JIRA.Issues.BaseEvented.extend({namedEvents:["issueRequested","loadComplete","loadError","returnToSearch","issueViewUpdated","saveSuccess","fieldSubmitted","replacedFocusedPanel"],initialize:function(a){_.bindAll(this);this.searchPageModule=a.searchPageModule;this.viewIssueController=new JIRA.Issues.ViewIssueController({saveInProgressManager:a.saveInProgressManager,viewIssueContext:a.container},{viewIssueData:a.viewIssueData});this.viewIssueController.bindIssueRequested(this.triggerIssueRequested);this.viewIssueController.bindIssueLoaded(this.triggerLoadComplete);this.viewIssueController.bindIssueError(this.triggerLoadError);this.viewIssueController.bindIssueRequested(this.triggerIssueRequested);this.viewIssueController.bindIssueViewUpdated(this.triggerIssueViewUpdated);this.viewIssueController.bindReturnToSearch(this.triggerReturnToSearch);this.viewIssueController.bindSaveSuccess(this.triggerSaveSuccess);this.viewIssueController.bindFieldSubmitted(this.triggerFieldSubmitted);this.viewIssueController.bindReplacedFocusedPanel(this.triggerReplacedFocusedPanel)},abortIfUpdatePending:function(){this.viewIssueController.loadingPromiseManager.reset()},abortPending:function(){this.viewIssueController.cancelLoad()},canDismissComment:function(){return this.viewIssueController.canDismissComment()},beforeHide:function(){this.viewIssueController.hideLightbox();this.viewIssueController.hideDropdown();this.viewIssueController.cancelLoad();this.viewIssueController.setSkipSaveIssueSuccessHandler(true);this.removeIssueMetadata()},beforeShow:function(){this.addIssueMetadata()},editField:function(d){var b=this.viewIssueController,a={id:this.getIssueId(),key:this.getIssueKey()};function c(){if(d.matchesFieldSelector()){d.edit()}else{new JIRA.Issues.ModalIssueFieldView({issueEventBus:b.getViewIssueModel().getIssueEventBus(),model:d,issue:a}).show()}}if(!d.getSaving()){c()}else{JIRA.one(JIRA.Events.ISSUE_REFRESHED,function(){c()})}},_getIssueEntity:function(){var a=this.viewIssueController.getViewIssueModel();return a&&a.getEntity()},getIssueId:function(){var a=this._getIssueEntity();return a&&a.id||null},getIssueKey:function(){var a=this._getIssueEntity();return a&&a.key||null},loadIssue:function(b){var a=AJS.$("#key-val"),d=AJS.Meta.get("serverRenderedViewIssue");if(d){this.viewIssueController.applyToDom({id:a.attr("rel")||b.id||-1,key:a.text()||b.key});if(!b.id||b.id===-1){this._createIssueDoesNotExistView(AJS.$(".issue-body-content"))}AJS.Meta.set("serverRenderedViewIssue",null);_.defer(_.bind(function(){this._bringViewIssueElementIntoView(b.viewIssueQuery)},this));var c={id:this.getIssueId()};JIRA.trace("jira.issue.refreshed",c);JIRA.trace("jira.psycho.issue.refreshed",c);return jQuery.Deferred().resolve().promise()}else{b=_.extend({},b,{bringToFocus:_.bind(function(){this._bringViewIssueElementIntoView(b.viewIssueQuery)},this)});return this.viewIssueController.load(b)}},renderIssueDoesNotExist:function(a){this._createIssueDoesNotExistView(a).render()},_createIssueDoesNotExistView:function(a){return new JIRA.Issues.IssueMissingErrorView({el:a,searchPageModule:this.searchPageModule})},updateIssuePager:function(a){this.viewIssueController.updatePager(a)},openFocusShifter:function(){var a=this.viewIssueController.getViewIssueModel();a.getIssueEventBus().triggerOpenFocusShifter()},refreshIssue:function(b){var c,d,a;d=jQuery.Deferred();c=_.extend({},b,{success:d.resolve,error:d.reject});a=this.viewIssueController.getViewIssueModel();if(a){a.getIssueEventBus().triggerRefreshIssue(c)}else{d.resolve()}return d.promise()},removeIssueMetadata:function(){this.viewIssueController.removeIssueMetadata()},addIssueMetadata:function(){this.viewIssueController.addIssueMetadata()},setContainer:function(a){this.viewIssueController.changeViewIssueContext(a)},getLoading:function(){return this.viewIssueController.loading},isCurrentlyLoading:function(){return this.viewIssueController.isCurrentlyLoading()},getUpdating:function(){return this.viewIssueController.updating},updateIssueWithQuery:function(a){this.viewIssueController.updateIssueWithQuery(a)},_bringViewIssueElementIntoView:function(a){if(a){var b;if(a.focusedCommentId){b="#comment-"+a.focusedCommentId}else{if(a.attachmentSortBy||a.attachmentOrder){b="#attachmentmodule"}}if(b){AJS.$(b).scrollIntoView({marginBottom:200,marginTop:200})}}},dismiss:function(){this.viewIssueController.dismiss()}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/search/issue/SimpleIssue.js' */
Backbone.define("JIRA.Issues.SimpleIssue",JIRA.Issues.BaseModel.extend({properties:["id","key"],defaults:{id:null,key:null},hasIssue:function(){return !!this.getId()}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/search/issue/FullScreenIssue.js' */
Backbone.define("JIRA.Issues.FullScreenIssue",JIRA.Issues.BaseView.extend({namedEvents:["issueHidden"],initialize:function(a){_.extend(this,a);_.bindAll(this);if(this.issueContainer.hasClass("hidden")){this.issueContainer.detach();this.issueContainer.removeClass("hidden")}if(this.searchContainer.hasClass("hidden")){this.searchContainer.detach();this.searchContainer.removeClass("hidden")}},deactivate:function(){if(this.active){if(this.stalker){this.stalker.unstalk()}this.issueModule.unbindLoadComplete(this.onLoadComplete);this.issueModule.unbindLoadError(this.showError);this.issueModule.abortIfUpdatePending();this.active=false}},activate:function(){if(!this.active){this.issueModule.bindLoadComplete(this.onLoadComplete);this.issueModule.bindLoadError(this.showError);this.active=true}},onLoadComplete:function(a,b){this.stalker=AJS.$(".js-stalker",this.issueContainer).stalker();this._makeIssueVisible();if(b.isNewIssue){this._scrollToTop()}},_makeIssueVisible:function(){this.issueModule.beforeShow();this._setBodyClasses({error:false,issue:true,search:true});if(!this.isVisible()){this.issueContainer.insertBefore(this.searchContainer);this.searchContainer.detach();JIRA.trace("jira.psycho.issue.refreshed",{id:this.issueModule.getIssueId()});JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.issueContainer,JIRA.CONTENT_ADDED_REASON.pageLoad])}},updateIssue:function(c){var a,b;b=c.key==this.issueModule.getIssueKey();if(this.isVisible()){a=this.issueModule.refreshIssue(c);a.done(function(){if(!b&&c.message){JIRA.Issues.showNotification(c.message,c.key)}})}else{a=jQuery.Deferred().resolve().promise()}return a},showError:function(a){if(!this.isVisible()){JIRA.Messages.showErrorMsg(AJS.format("{0} can not be opened. The issue may have been deleted or you might not have permission to see the issue.",a.issueKey),{closeable:true})}else{this._setBodyClasses({error:true,issue:false,search:false})}},bindLoadComplete:function(b,a){this.issueModule.bindLoadComplete(b,a);this.issueModule.bindLoadError(b,a)},isVisible:function(){return this.issueContainer.closest("body").length>0},_scrollToTop:function(){AJS.$(window).scrollTop(0)},_setBodyClasses:function(a){AJS.$("body").toggleClass("page-type-message",a.error).toggleClass("navigator-issue-only",a.issue).toggleClass("page-type-navigator",a.search)},hide:function(){this._setBodyClasses({error:false,issue:false,search:true});if(this.isVisible()){this.searchContainer.insertBefore(this.issueContainer);this.issueContainer.detach()}this.trigger("issueHidden")},updatePager:function(a){this.issueModule.updateIssuePager(a)},show:function(a){this.activate();if(!AJS.Meta.get("serverRenderedViewIssue")){this.issueContainer.find("#issue-content").remove()}this.issueModule.setContainer(this.issueContainer);return this.issueModule.loadIssue(a).always(_.bind(function(){this.updatePager(a.pager);this.issueCacheManager.prefetchIssues()},this))}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/search/issue/ViewIssueData.js' */
Backbone.define("JIRA.Issues.ViewIssueData",JIRA.Issues.AsyncData.extend({initialize:function(a){JIRA.Issues.AsyncData.prototype.initialize.call(this,_.defaults(a||{},{disableCache:JIRA.Issues.DarkFeatures.KILL_SWITCH.enabled()||JIRA.Issues.DarkFeatures.NO_PREFETCH.enabled(),maxCacheSize:+AJS.Meta.get("viewissue-max-cache-size")}))},fetch:function(e,d){var h={issueKey:e,decorator:"none",prefetch:!!d.prefetch};if(d.mergeIntoCurrent){if(this.data&&this.data[e]&&this.data[e].value&&this.data[e].value.issue){h.lastReadTime=this.data[e].value.readTime;h.fields=[];_.each(this.data[e].value.fields,function(i){h.fields.push(i.id+":"+i.contentId)});h.issue=["summary:"+this.data[e].value.issue.summaryContentId];h.links=[];var g=function(i){_.each(i.links,function(j){h.links.push(j.id+":"+j.contentId)});_.each(i.groups,function(j){g(j)})};_.each(this.data[e].value.issue.operations.linkGroups,function(i){g(i)});h.panels=[];var a=this;var b=function(i){_.each(a.data[e].value.panels[i],function(j){h.panels.push(j.completeKey+":"+j.contentId)})};b("leftPanels");b("rightPanels");b("infoPanels")}}if("loadFields" in d){h.loadFields=d.loadFields}if(d.issueEntity){_.defaults(h,d.issueEntity.viewIssueQuery)}var f=jQuery.ajax({url:contextPath+"/secure/IssueAction!default.jspa",headers:{"X-SITEMESH-OFF":true},data:h,type:d.mergeIntoCurrent?"POST":"GET"});var c=f.pipe(function(i){return i},function(i){return _.pick(i,"status","responseText","statusText")});c.abort=function(){f.abort.apply(f,arguments)};return c},mergeFetchedAndCached:function(l,m,d){if(this._skipMerging(l,m,d)){_.extend(l,m);return null}_.each(_.pairs(m),function(s){if(s[0]!=="value"){l[s[0]]=s[1]}});var q=m.value;var k=[];var b=[];var h=[];_.each(q.removedContentIds,function(u,t){var s;if(t==="fields"){s=k}else{if(t==="panels"){s=b}else{if(t==="links"){s=h}}}if(s){_.each(u,function(v){s.push(v)})}});var g=q.fields;var e=q.issue.operations.linkGroups;var o=q.panels;var j=q.issue.summary;if(this._nothingChanged(k,b,h,g,o,e,j)){this._sendAnalyticsEvent(false,false,false,false);return null}var p={updated:{},added:{},deleted:{}};var i=l.value;var f=this._comparator;var c=false;var n=false;var a=false;var r=false;if(k.length>0||g.length>0){this._mergeFields(g,i,p,k);c=true}if(b.length>0||o.leftPanels.length>0||o.rightPanels.length>0||o.infoPanels.length>0){this._mergePanels(o,i,p,b,f);n=true}if(h.length>0||e.length>0){this._mergeLinks(e,i,p,h,f);a=true}if(j){this._mergeSummary(q,i,p);r=true}this._sendAnalyticsEvent(c,n,a,r);return p},_skipMerging:function(c,b,a){return _.isEmpty(c)||!a.mergeIntoCurrent||!c.value||!c.value.issue||b.error===true},_nothingChanged:function(e,a,g,b,d,c,f){return e.length==0&&a.length==0&&g.length==0&&b.length==0&&c.length==0&&d.leftPanels.length==0&&d.rightPanels.length==0&&d.infoPanels.length==0&&!f},_sendAnalyticsEvent:function(c,b,a,d){JIRA.Issues.Analytics.trigger("kickass.conditionalLoading",{fieldsChanged:c,panelsChanged:b,linksChanged:a,summaryChanged:d})},_mergeFields:function(c,e,d,a){d.added.fields=[];d.updated.fields=[];d.deleted.fields=[];_.each(c,function(f){var g=_.find(e.fields,function(h){return h.id==f.id});if(g){d.updated.fields.push(f.id)}else{d.added.fields.push(f.id)}});var b=c;_.each(e.fields,function(f){if(_.contains(a,f.id)){d.deleted.fields.push(f.id)}else{if(!_.contains(d.updated.fields,f.id)){b.push(f)}}});e.fields=b},_mergeSummary:function(c,b,a){a.updated.issue=["summary"];b.issue.summary=c.issue.summary;b.issue.summaryContentId=c.issue.summaryContentId},_mergePanels:function(e,d,c,a,b){c.added.panels={};c.updated.panels={};c.deleted.panels={};var f=function(g){c.added.panels[g]=[];c.updated.panels[g]=[];c.deleted.panels[g]=[];_.each(e[g],function(i){var j=_.find(d.panels[g],function(k){return k.id==i.id});if(j){c.updated.panels[g].push(i.id)}else{c.added.panels[g].push(i.id)}});var h=e[g];_.each(d.panels[g],function(i){if(_.contains(a,i.completeKey)){c.deleted.panels[g].push(i.id)}else{if(!_.contains(c.updated.panels[g],i.id)){h.push(i)}}});h.sort(b);d.panels[g]=h};f("leftPanels");f("rightPanels");f("infoPanels")},_mergeLinks:function(e,d,c,a,b){c.added.groups={};c.updated.groups={};c.deleted.groups={};var f=[];this._mergeOperationsLinks(e,d,f,c,a,b);this._mergeToolsLinks(e,d,f,c,a,b);d.issue.operations.linkGroups=f},_mergeOperationsLinks:function(j,d,c,a,k,b){a.added.groups["view.issue.opsbar"]=[];a.updated.groups["view.issue.opsbar"]=[];a.deleted.groups["view.issue.opsbar"]=[];var i=_.find(d.issue.operations.linkGroups,function(l){return"view.issue.opsbar"===l.id});var h=_.find(j,function(l){return"view.issue.opsbar"===l.id});var g={};var e={};if(h){_.each(h.groups,function(l){var m=_.find(i.groups,function(o){return l.id===o.id});if(m){a.updated.groups["view.issue.opsbar"].push(l.id)}else{a.added.groups["view.issue.opsbar"].push(l.id)}_.each(l.links,function(o){g[o.id]=o;e[o.id]=l.id});if(l.groups&&l.groups.length>0){var n=l.groups[0];_.each(n.groups,function(o){_.each(o.links,function(p){g[p.id]=p;e[p.id]=o.id})})}})}if(i){var f=[];if(h){_.each(h.groups,function(l){if(_.contains(a.added.groups["view.issue.opsbar"],l.id)){f.push(l)}})}_.each(i.groups,function(q){var p=[];var m=null;if(h){m=_.find(h.groups,function(t){return q.id===t.id});if(m){_.each(m.links,function(t){var u=_.find(q.links,function(v){return t.id===v.id});if(!u){p.push(t)}})}}var n=false;var l=function(u,t){_.each(u.links,function(v){var w=e[v.id];if(w&&w!==u.id){n=true}else{if(g[v.id]){t.push(g[v.id])}else{if(!_.contains(k,v.id)){t.push(v)}else{n=true}}}})};l(q,p);p.sort(b);q.links=p;var o=null;if(m&&m.groups&&m.groups.length>0){o=m.groups[0]}var s=null;if(q.groups&&q.groups.length>0){s=q.groups[0];var r=[];if(o){_.each(o.groups,function(t){var u=_.find(s.groups,function(v){return t.id===v.id});if(!u){r.push(t)}})}_.each(s.groups,function(v){var u=[];if(o){var t=_.find(o.groups,function(w){return w.id===v.id});if(t){_.each(t.links,function(w){var x=_.find(v.links,function(y){return w.id===y.id});if(!x){u.push(w)}})}}l(v,u);if(u.length>0){u.sort(b);v.links=u;r.push(v)}});if(r.length>0){r.sort(b);s.groups=r}else{s=null;n=true}}else{if(o){s=m.groups[0]}}q.groups=[];if(s){q.groups[0]=s}if(p.length>0||s){f.push(q);if(n&&!_.contains(a.updated.groups["view.issue.opsbar"],q.id)){a.updated.groups["view.issue.opsbar"].push(q.id)}}else{a.deleted.groups["view.issue.opsbar"].push(q.id)}});if(f.length>0){f.sort(b);i.groups=f;c.push(i)}}else{if(h){c.push(h)}}a.added.groups["view.issue.opsbar"].sort();a.deleted.groups["view.issue.opsbar"].sort();a.updated.groups["view.issue.opsbar"].sort()},_mergeToolsLinks:function(j,g,f,a,k,b){a.updated.groups["jira.issue.tools"]=false;var m=_.find(g.issue.operations.linkGroups,function(n){return"jira.issue.tools"===n.id});var l=_.find(j,function(n){return"jira.issue.tools"===n.id});var h={};if(l){a.updated.groups["jira.issue.tools"]=true;_.each(l.links,function(n){h[n.id]=n});if(l.groups&&l.groups.length>0){_.each(l.groups[0].links,function(n){h[n.id]=n})}}if(m){var c=[];if(l){_.each(l.links,function(n){var o=_.find(m.links,function(p){return n.id===p.id});if(!o){c.push(n)}})}_.each(m.links,function(n){if(h[n.id]){c.push(h[n.id])}else{if(!_.contains(k,n.id)){c.push(n)}}});c.sort(b);m.links=c;var i=null;if(l&&l.groups&&l.groups.length>0){i=l.groups[0]}if(m.groups&&m.groups.length>0){var e=m.groups[0];var d=[];if(i){_.each(i.links,function(n){var o=_.find(e.links,function(p){return n.id===p.id});if(!o){d.push(n)}})}_.each(e.links,function(n){if(h[n.id]){d.push(h[n.id])}else{if(!_.contains(k,n.id)){d.push(n)}}});m.groups=[];if(d.length>0){d.sort(b);e.links=d;m.groups[0]=e}}else{if(i){m.groups=[i]}}f.push(m)}else{if(l){f.push(l)}}},_comparator:function(b,a){if(b.weight&&a.weight){if(b.weight>a.weight){return 1}if(b.weight<a.weight){return -1}return 0}if(b.weight&&!a.weight){return 1}if(!b.weight&&a.weight){return -1}return 0}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/Resize.js' */
(function(){var a="horizontalResize",b="verticalResize";JIRA.Issues.offHorizontalResize=function(d,c){AJS.$(document).off(a,d,c)};JIRA.Issues.onHorizontalResize=function(d,c){AJS.$(document).on(a,d,c)};JIRA.Issues.triggerHorizontalResize=_.throttle(function(){AJS.$(document).trigger(a)},100);JIRA.Issues.offVerticalResize=function(d,c){AJS.$(document).off(b,d,c)};JIRA.Issues.onVerticalResize=function(d,c){AJS.$(document).on(b,d,c)};JIRA.Issues.triggerVerticalResize=_.throttle(function(){AJS.$(document).trigger(b)},100);jQuery(window).resize(JIRA.Issues.triggerVerticalResize)}());
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/UserParms.js' */
JIRA.Issues.UserParms={createSharedObjects:function(){return this.get().createSharedObjects},get:function(){if(!this.data){this.data=AJS.$("#user-parms").data("user-parms")||{}}return this.data}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-searchheader', location = 'content/templates/issuenav-searchheader.soy' */
// This file was automatically generated from issuenav-searchheader.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNavSearchHeader == 'undefined') { JIRA.Templates.IssueNavSearchHeader = {}; }


JIRA.Templates.IssueNavSearchHeader.searchHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.IssueNavSearchHeader.primarySection(opt_data, output);
  if (opt_data.owner) {
    JIRA.Templates.IssueNavSearchHeader.secondarySection(opt_data, output);
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavSearchHeader.primarySection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="header-section-primary"><h1 class="search-title" title="', soy.$$escapeHtmlAttribute(opt_data.title), '">', soy.$$escapeHtml(opt_data.title), '</h1><ul class="filter-operations">', (opt_data.primaryOps && opt_data.primaryOps.length) ? '<li class="filter-edited-item"><span>' + soy.$$escapeHtml("Edited") + '</span></li>' : '');
  if (opt_data.primaryButton) {
    output.append('<li>', (opt_data.primaryOps && opt_data.primaryOps.length) ? '<div class="aui-buttons">' : '', '<a href="', (opt_data.primaryButton.href) ? soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.primaryButton.href)) : '#', '" class="aui-button ', soy.$$escapeHtmlAttribute(opt_data.primaryButton.styleClass), '">', soy.$$escapeHtml(opt_data.primaryButton.label), '</a>');
    if (opt_data.primaryOps && opt_data.primaryOps.length) {
      output.append('<button class="aui-button aui-dropdown2-trigger js-edited-trigger" aria-owns="js-edited-content" aria-haspopup="true" data-container=".aui-buttons"></button></div><div id="js-edited-content" class="aui-dropdown2 aui-style-default"><ul>');
      var opList38 = opt_data.primaryOps;
      var opListLen38 = opList38.length;
      for (var opIndex38 = 0; opIndex38 < opListLen38; opIndex38++) {
        var opData38 = opList38[opIndex38];
        output.append('<li><a href="', (opData38.href) ? soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opData38.href)) : '#', '" ', (opData38.styleClass) ? 'class="' + soy.$$escapeHtmlAttribute(opData38.styleClass) + '"' : '', '>', soy.$$escapeHtml(opData38.label), '</a></li>');
      }
      output.append('</ul></div>');
    }
    output.append('</li>');
  }
  if (opt_data.owner) {
    var opList59 = opt_data.secondaryOps;
    var opListLen59 = opList59.length;
    for (var opIndex59 = 0; opIndex59 < opListLen59; opIndex59++) {
      var opData59 = opList59[opIndex59];
      output.append('<li><a href="', (opData59.href) ? soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opData59.href)) : '#', '" ', (opData59.title) ? 'title="' + soy.$$escapeHtmlAttribute(opData59.title) + '"' : '', ' class="', soy.$$escapeHtmlAttribute(opData59.styleClass), '">', (opData59.label) ? soy.$$escapeHtml(opData59.label) : '', '</a></li>');
    }
  }
  output.append('</ul></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavSearchHeader.secondarySection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.owner) {
    output.append('<div class="header-section-secondary"><div class="search-owner">');
    JIRA.Templates.IssueNavSearchHeader.filterOwner(opt_data, output);
    output.append('</div></div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavSearchHeader.filterOwner = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="search-owner">', (opt_data.avatarUrl) ? '<span class="aui-avatar aui-avatar-large search-owner-avatar"><span class="aui-avatar-inner"><img src="' + soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.avatarUrl)) + '" /></span></span>' : '', '<span class="search-owner-name">');
  var ownerLink__soy95 = new soy.StringBuilder();
  JIRA.Templates.IssueNavSearchHeader.ownerLink(opt_data, ownerLink__soy95);
  ownerLink__soy95 = ownerLink__soy95.toString();
  output.append(AJS.format("Owned by {0}",ownerLink__soy95), '</span></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavSearchHeader.ownerLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a href="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.ownerUrl)), '" class="user-hover" rel="', soy.$$escapeHtmlAttribute(opt_data.ownerUserName), '">', soy.$$escapeHtml(opt_data.owner), '</a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavSearchHeader.filterDetails = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.IssueNavSearchHeader.filterDescription(opt_data, output);
  JIRA.Templates.IssueNavSearchHeader.filterPermissions(opt_data, output);
  if (opt_data.userIsLoggedIn) {
    JIRA.Templates.IssueNavSearchHeader.filterSubscriptions(opt_data, output);
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavSearchHeader.filterDescription = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="filter-details-section sub-section">');
  if (opt_data.owner) {
    JIRA.Templates.IssueNavSearchHeader.filterOwner(opt_data, output);
  }
  output.append((opt_data.filter.description) ? '<p class="filter-name">' + soy.$$escapeHtml(opt_data.filter.description) + ((opt_data.permissions.userHasEditPermission) ? ' <a href="' + soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("")) + '/secure/EditFilter!default.jspa?filterId=' + soy.$$escapeUri(opt_data.filter.id) + '">(' + soy.$$escapeHtml("Edit") + ')</a>' : '') + '</p>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavSearchHeader.filterPermissions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="filter-details-section sub-section"><h4 class="section-header">', soy.$$escapeHtml("Permissions"), '</h4>');
  if (opt_data.sharePermissions && opt_data.sharePermissions.length > 0) {
    output.append('<p>', soy.$$escapeHtml("This filter is visible to:"), '</p><ul class="shared-filters">');
    var shareList155 = opt_data.sharePermissions;
    var shareListLen155 = shareList155.length;
    for (var shareIndex155 = 0; shareIndex155 < shareListLen155; shareIndex155++) {
      var shareData155 = shareList155[shareIndex155];
      JIRA.Templates.IssueNavSearchHeader.filterSharePermissionItem({type: shareData155.type, project: (shareData155.project) ? '<a href="' + soy.$$escapeHtml("") + '/browse/' + soy.$$escapeHtml(shareData155.project.key) + '">' + soy.$$escapeHtml(shareData155.project.name) + '</a>' : '', projectRole: (shareData155.role) ? soy.$$escapeHtml(shareData155.role.name) : '', group: (shareData155.group) ? soy.$$escapeHtml(shareData155.group.name) : ''}, output);
    }
    output.append('</ul>');
  } else {
    output.append('<p>', soy.$$escapeHtml("This filter is only visible to you."), '</p>');
  }
  output.append((opt_data.permissions.userHasEditSharingPermission) ? '<p><a class="edit-permissions" href="' + soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("")) + '/secure/EditFilter!default.jspa?filterId=' + soy.$$escapeUri(opt_data.filter.id) + '">' + soy.$$escapeHtml("Edit permissions") + '</a></p>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavSearchHeader.filterSubscriptions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="filter-details-section full-section"><h4>', soy.$$escapeHtml("Subscriptions"), '</h4>');
  if (opt_data.subscriptions.items.length) {
    output.append('<p>', soy.$$escapeHtml("This filter has the following subscriptions:"), '</p>');
    JIRA.Templates.IssueNavSearchHeader.filterSubscriptionList(opt_data, output);
  } else {
    output.append('<p>', soy.$$escapeHtml("This filter has no subscriptions."), '</p>');
  }
  output.append('<ul class="manage-links"><li><a href="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("")), '/secure/FilterSubscription!default.jspa?filterId=', soy.$$escapeUri(opt_data.filter.id), '&returnUrl=', soy.$$escapeUri(opt_data.returnUrl), '">', soy.$$escapeHtml("New subscription"), '</a></li>', (opt_data.subscriptions.items.length) ? '<li><a href="' + soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("")) + '/secure/ViewSubscriptions.jspa?filterId=' + soy.$$escapeUri(opt_data.filter.id) + '">' + soy.$$escapeHtml("Manage subscriptions") + '</a></li>' : '', '</ul></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavSearchHeader.filterSubscriptionList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul>');
  var subList235 = opt_data.filter.subscriptions.items;
  var subListLen235 = subList235.length;
  for (var subIndex235 = 0; subIndex235 < subListLen235; subIndex235++) {
    var subData235 = subList235[subIndex235];
    output.append((subData235.group) ? '<li>' + soy.$$escapeHtml(subData235.group.name) + '</li>' : '<li>' + soy.$$escapeHtml(subData235.user.displayName) + '</li>');
  }
  output.append((opt_data.filter.subscriptions.additionalLength) ? '<li><a href="' + soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("")) + '/secure/ViewSubscriptions.jspa?filterId=' + soy.$$escapeUri(opt_data.filter.id) + '">' + soy.$$escapeHtml(AJS.format("{0} more",opt_data.filter.subscriptions.additionalLength)) + '</a></li>' : '', '</ul>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavSearchHeader.filterSharePermissionItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.type == 'global') ? '<li>' + soy.$$escapeHtml("Everyone") + '</li>' : (opt_data.type == 'group') ? '<li>' + AJS.format("{0}Group{1}: {2}",'<strong>','</strong>',opt_data.group) + '</li>' : (opt_data.projectRole) ? '<li>' + AJS.format("{0}Project{1}: {2} {3}Role{4}: {5}",'<strong>','</strong>',opt_data.project,'<strong>','</strong>',opt_data.projectRole) + '</li>' : '<li>' + AJS.format("{0}Project{1}: {2}",'<strong>','</strong>',opt_data.project) + '</li>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavSearchHeader.saveFilterDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content"><form action="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.contextPath)), '/rest/api/2/filter/" class="aui" id="save-filter-form" method="post"><div class="aui-messages"></div><div class="form-body"><h2 class="dialog-title">', soy.$$escapeHtml(opt_data.headerText), '</h2>', (opt_data.copyFromAnotherUser) ? '<p class="form-description">' + ((opt_data.filterOwnerName) ? soy.$$escapeHtml(AJS.format("This filter was created by {0}. You can save a copy of this filter but you cannot modify the original.",opt_data.filterOwnerName)) : soy.$$escapeHtml("You can save a copy of this filter but you cannot modify the original.")) + '</p>' : '', '<div class="field-group"><label for="filterName">', soy.$$escapeHtml("Filter Name"), '<span class="aui-icon icon-required"><span class="content">Required</span></span></label><input type="text" id="filterName" name="name"', (opt_data.prefilledFilterName) ? ' value="' + soy.$$escapeHtmlAttribute(opt_data.prefilledFilterName) + '"' : '', 'class="text long-field"><div class="description">', soy.$$escapeHtml("Enter a name for this Filter"), '</div>');
  var fieldList305 = opt_data.hiddenFields;
  var fieldListLen305 = fieldList305.length;
  for (var fieldIndex305 = 0; fieldIndex305 < fieldListLen305; fieldIndex305++) {
    var fieldData305 = fieldList305[fieldIndex305];
    output.append('<input type="hidden" name="', soy.$$escapeHtmlAttribute(fieldData305.name), '" value="', (fieldData305.value) ? soy.$$escapeHtmlAttribute(fieldData305.value) : '', '" />');
  }
  output.append('</div>', (opt_data.isDefaultShareScopeGlobal) ? '<div class="aui-message info shadowed"><p class="title"><span class="aui-icon icon-info"></span><strong>' + soy.$$escapeHtml("By default your filters are shared with everyone.") + '</strong></p><input type="checkbox" id="setSharingPrivate" class="checkbox"><label for="setSharingPrivate">' + soy.$$escapeHtml("My filters should be private by default.") + '</label></div>' : '', '</div><div class="buttons-container form-footer"><div class="buttons"><input accesskey="', soy.$$escapeHtmlAttribute("s"), '" title="', soy.$$escapeHtmlAttribute(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="aui-button submit" type="submit" value="', soy.$$escapeHtmlAttribute("Submit"), '" /><a accesskey="', soy.$$escapeHtmlAttribute("`"), '" title="', soy.$$escapeHtmlAttribute(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="aui-button aui-button-link cancel" href="javascript:">', soy.$$escapeHtml("Cancel"), '</a></div></div></form></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavSearchHeader.layoutSwitcher = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-buttons"><button id="layout-switcher-button" class="aui-button drop-arrow js-default-dropdown" type="button"><span class="aui-icon aui-icon-small ', soy.$$escapeHtmlAttribute(opt_data.activeLayout.iconClass), '"></span></button><div class="aui-list hidden"><h5>', soy.$$escapeHtml("Views"), '</h5><ul class="aui-list-section aui-first aui-last">');
  var layoutList341 = opt_data.layouts;
  var layoutListLen341 = layoutList341.length;
  for (var layoutIndex341 = 0; layoutIndex341 < layoutListLen341; layoutIndex341++) {
    var layoutData341 = layoutList341[layoutIndex341];
    output.append('<li class="aui-list-item layout-switcher-item"><a href="#" class="aui-list-item-link" data-layout-key="', soy.$$escapeHtmlAttribute(layoutData341.id), '"><span class="aui-icon aui-icon-small ', (opt_data.activeLayout.id == layoutData341.id) ? 'aui-iconfont-success' : '', '"></span>', soy.$$escapeHtml(layoutData341.label), '</a>');
  }
  output.append('</ul></div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-searchheader', location = 'content/js/search/searchheader/SearchHeaderView.js' */
Backbone.define("JIRA.Issues.SearchHeaderView",JIRA.Issues.BaseView.extend({template:JIRA.Templates.IssueNavSearchHeader.searchHeader,filterDetailsTemplate:JIRA.Templates.IssueNavSearchHeader.filterDetails,primarySectionTemplate:JIRA.Templates.IssueNavSearchHeader.primarySection,secondarySectionTemplate:JIRA.Templates.IssueNavSearchHeader.secondaySection,filterFavouriteButton:".fav-link",events:{"click .fav-link":"_onToggleFavourite"},initialize:function(a){_.bindAll(this);this._searchPageModule=a.searchPageModule;this._searchPageModule.on("change changeFilterProps",this.render,this);this.pageTitle=document.title},render:function(){var d=!this.$el.closest("body").length,h={},b={isDirty:this._searchPageModule.isDirty()},c=this._searchPageModule.getFilter();if(!c){h.title="Search";h.primaryButton=JIRA.Issues.FilterModel.getOpById("saveAs");this.$el.removeClass("is-filter-with-owner")}else{if(!c.getIsValid()){h.title="Search";this.$el.removeClass("is-filter-with-owner")}else{var g=c.getOperationsJson(b);var e=g.primary.reverse().pop();var f=g.primary.reverse();h.title=c.getName();this._addOwnerData(c,h);h.primaryButton=e;h.primaryOps=f;h.secondaryOps=g.secondary;this.$el.toggleClass("is-filter-with-owner",!!c.getOwner())}}var a=this.$(".filter-edited-item").length===1;this.$el.html(this.template(h));if(a){this.$(".filter-edited-item").show().css("opacity",1)}else{if(!d){this.$(".filter-edited-item").hide().fadeIn(1000)}}this._createFilterFavouriteTipsy();this.updateJqlError(false);this.updateWindowTitle();this.bindDetailsDialog();this.bindDropdown();return this},updateJqlError:function(a){var b="";if(this.isError=a){b="You cannot save a filter that is in error."}else{if(!this.queryIsSaveable()){b="You must be logged in to perform filter actions"}}this.$(".save-as-new-filter, .save-changes").attr("title",b).toggleClass("disabled",!this.queryIsSaveable())},update:function(){JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.returnToSearch]);this.updateWindowTitle()},updateWindowTitle:function(){if(this._searchPageModule.isFullScreenIssueVisible()){return}var a=this._searchPageModule.getFilter(),b=AJS.format("{0} - {1}","Issue Navigator",JIRA.Settings.ApplicationTitle.get());if(a&&a.getIsValid()){document.title="["+a.getName()+"] "+b}else{document.title=b}},userIsLoggedIn:function(){return JIRA.Issues.LoginUtils.isLoggedIn()},queryIsSaveable:function(){return this.userIsLoggedIn()&&!this.isError},_onToggleFavourite:function(b){b.preventDefault();var a=this.$(".fav-link").hasClass("on");this._searchPageModule.getFilter().saveFavourite(!a);if(!a){this._searchPageModule.filterModuleSaved(this._searchPageModule.getFilter())}},_onSaveAsNew:function(a){a.preventDefault();this._searchPageModule.getJqlDeferred().done(_.bind(function(b){if(this.queryIsSaveable()){new JIRA.Issues.FilterSaveDialogView({id:"save-filter-dialog",type:JIRA.Issues.FilterSaveDialogView.Types.SAVE_AS,searchPageModule:this._searchPageModule}).show()}},this))},_createFilterFavouriteTipsy:function(){new JIRA.Issues.Tipsy({el:this.filterFavouriteButton})},_onSaveChanges:function(f){f.preventDefault();if(!this.queryIsSaveable()){return}var d=this._searchPageModule.getFilter();var b=AJS.escapeHtml(d.getName());var c=d.saveFilter(this._searchPageModule.getEffectiveJql());var a=this;c.done(function(){JIRA.Messages.showSuccessMsg(AJS.format("The filter \u003cstrong>{0}\u003c\/strong> has been successfully saved.",b),JIRA.Issues.getDefaultMessageOptions());a._searchPageModule.setSessionSearch(d)});c.fail(function(){JIRA.Messages.showErrorMsg(AJS.format("The filter \u003cstrong>{0}\u003c\/strong> could not be saved.",b),JIRA.Issues.getDefaultMessageOptions())})},_onDiscardChanges:function(a){a.preventDefault();this._searchPageModule.discardFilterChanges()},_getFilterDetailsDialogCSS:function(a,d,e,c){var b=AJS.InlineDialog.opts.calculatePositions(a,d,e,c);b.arrowCss.left-=7;return b},bindDetailsDialog:function(){var b="filter-details-overlay";AJS.$("#inline-dialog-"+b).remove();var a=this.$(".show-filter-details");var c=AJS.InlineDialog(a,b,this._onShowFilterDetailsDialog,{addActiveClass:true,calculatePositions:this._getFilterDetailsDialogCSS,hideDelay:3600000,offsetX:-36,width:400});a.click(function(){if(a.hasClass("active")){setTimeout(c.hide,0)}})},bindDropdown:function(){this.$(".save-changes").on("click",this._onSaveChanges);this.$(".discard-filter-changes").on("click",this._onDiscardChanges);this.$(".save-as-new-filter").on("click",this._onSaveAsNew)},_onShowFilterDetailsDialog:function(d,f,h){var b=this._searchPageModule.getFilter(),c=_.sortBy(b.getSharePermissions(),function(i){var j=[i.type];i.group&&j.push(i.group.name);i.project&&j.push(i.project.name);i.role&&j.push(i.role.name);return j}),g=_.clone(b.getSubscriptions()),a=JIRA.Issues.LoginUtils.loggedInUserName()===b.getOwnerUserName();g.additionalLength=b.getNumberOfAdditionalSubscriptions();var e={filter:b.toJSON(),sharePermissions:c,subscriptions:g,permissions:{userHasEditSharingPermission:a&&(!!JIRA.Issues.UserParms.createSharedObjects()||c.length>0),userHasEditPermission:a},userIsLoggedIn:this.userIsLoggedIn(),returnUrl:window.location};this._addOwnerData(b,e);d.html(this.filterDetailsTemplate(e));d.bind("click",function(i){i.stopPropagation()});h()},_addOwnerData:function(a,b){if(a.getOwner()){_.extend(b,{owner:a.getOwner()||"",ownerUserName:a.getOwnerUserName()||"",avatarUrl:a.getAvatarUrl(),ownerUrl:AJS.contextPath()+"/secure/ViewProfile.jspa?name="+encodeURIComponent(a.getOwnerUserName())})}},_appendErrorContent:function(a,d){var b=a.find(".aui-messages");var f=JSON.parse(d.responseText);a.find(".error").remove();b.empty();try{if(f&&f.errors){jQuery.each(f.errors,function(g,e){a.find("#"+g).after("<div class='error'>"+AJS.escapeHTML(e)+"</div>")})}if(f&&f.errorMessages){jQuery.each(f.errorMessages,function(g,h){var e=JIRA.Issues.getDefaultMessageOptions();e.body=AJS.escapeHTML(h);e.shadowed=false;AJS.messages.error(b,e)})}else{b.append(JIRA.SmartAjax.buildDialogErrorContent(d,true))}}catch(c){b.append(JIRA.SmartAjax.buildDialogErrorContent(d,true))}}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-searchheader', location = 'content/js/search/searchheader/LayoutSwitcherView.js' */
Backbone.define("JIRA.Issues.LayoutSwitcherView",JIRA.Issues.BaseView.extend({template:JIRA.Templates.IssueNavSearchHeader.layoutSwitcher,initialize:function(a){_.bindAll(this);this.searchPageModule=a.searchPageModule;this.searchPageModule.on("change:currentLayout",this.render)},render:function(){this.$el.html(this.template({layouts:this.searchPageModule.getSortedLayouts(),activeLayout:this.searchPageModule.getActiveLayout()}));this._addLayoutSwitcherTooltip();this.$el.find(".aui-list-item-link").click(this._onLayoutSwitchClick);JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.layoutSwitcherReady]);return this},enableLayoutSwitcher:function(){this.$el.find("#layout-switcher-button").removeClass("disabled").removeAttr("disabled");return this},disableLayoutSwitcher:function(){this.$el.find("#layout-switcher-button").addClass("disabled").attr("disabled","");return this},_addLayoutSwitcherTooltip:function(){function a(){var b=AJS.KeyboardShortcut.getKeyboardShortcutKeys("switch.search.layouts");if(b){return AJS.format("Change view (Type \'\'{0}\'\')",AJS.KeyboardShortcut.getKeyboardShortcutKeys("switch.search.layouts"))}else{return "Change view"}}new JIRA.Issues.Tipsy({el:this.$el.find("#layout-switcher-button"),showCondition:":not(.active)",tipsy:{title:a,gravity:"ne"}})},_onLayoutSwitchClick:function(c,a){var b=AJS.$(c.target).closest("[data-layout-key]").data("layout-key");c.preventDefault();this.searchPageModule.changeLayout(b,a)}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-searchheader', location = 'content/js/search/searchheader/SearchHeaderModule.js' */
Backbone.define("JIRA.Issues.SearchHeaderModule",JIRA.Issues.BaseEvented.extend({initialize:function(a){this._searchPageModule=a.searchPageModule},registerSearch:function(a){this._search=a},createView:function(a){this.searchHeaderView=new JIRA.Issues.SearchHeaderView({el:a.searchHeaderEl,searchPageModule:this._searchPageModule});return this.searchHeaderView},createToolsView:function(a){new JIRA.Issues.IssueTableHeaderOperationsView({el:a,search:this._search,searchPageModule:this._searchPageModule})},handleIssueSearchAppeared:function(){this.searchHeaderView.update()},handleJqlError:function(){this.searchHeaderView&&this.searchHeaderView.updateJqlError(true)},handleJqlSuccess:function(){this.searchHeaderView&&this.searchHeaderView.updateJqlError(false)}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/templates/issuenav-filter.soy' */
// This file was automatically generated from issuenav-filter.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNavFilter == 'undefined') { JIRA.Templates.IssueNavFilter = {}; }


JIRA.Templates.IssueNavFilter.collapsedFiltersPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="toggle-filter-panel" href="#" title="', soy.$$escapeHtmlAttribute(AJS.format("Dock the filters panel ({0})",'[')), '"></a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavFilter.filtersPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="filters-content"><h4 class="filter-title">', soy.$$escapeHtml("Filters"), '</h4><ul class="filter-options"><li><a href="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.contextPath)), '/issues/?jql=" class="new-search aui-button" title="', soy.$$escapeHtmlAttribute("Create a new search filter"), '">', soy.$$escapeHtml("New filter"), '</a></li><li><a class="find-filters" href="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.contextPath)), '/secure/ManageFilters.jspa?filterView=search">', soy.$$escapeHtml("Find filters"), '</a></li></ul><div class="filter-panel-section">');
  JIRA.Templates.IssueNavFilter.filterList({filters: opt_data.systemFilters, fallbackMessage: 'Warning: No system filters!', name: 'system-filters'}, output);
  output.append('</div><div class="filter-panel-section"><h4 class="filter-title">', soy.$$escapeHtml("Favorite Filters"), '</h4>');
  JIRA.Templates.IssueNavFilter.filterList({filters: opt_data.favouriteFilters, fallbackMessage: opt_data.favouriteFiltersFallback ? opt_data.favouriteFiltersFallback : opt_data.isAnonymous ? AJS.format("You must be {0}logged in{1} to view favorite filters.",'<a class="login-link" href="' + opt_data.loginUrl + '">','</a>') : "You don\x27t have any favorite filters.", name: 'favourite-filters'}, output);
  output.append('</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavFilter.filterDropDown = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-list"><ul class="aui-list-section">', (opt_data.canEdit) ? '<li class="aui-list-item"><a href="" class="aui-list-item-link rename-filter" data-id="' + soy.$$escapeHtmlAttribute(opt_data.filter.id) + '">' + soy.$$escapeHtml("Rename") + '</a></li>' : '', '<li class="aui-list-item"><a href="" class="aui-list-item-link copy-filter" data-id="', soy.$$escapeHtmlAttribute(opt_data.filter.id), '">', soy.$$escapeHtml("Copy"), '</a></li></ul><ul class="aui-list-section', (! opt_data.canEdit) ? ' aui-last' : '', '"><li class="aui-list-item"><a href="" class="aui-list-item-link unfavourite-filter" data-id="', soy.$$escapeHtmlAttribute(opt_data.filter.id), '">', soy.$$escapeHtml("Remove from favorites"), '</a></li></ul>', (opt_data.canEdit) ? '<ul class="aui-list-section aui-last"><li class="aui-list-item"><a href="" class="aui-list-item-link delete-filter" data-id="' + soy.$$escapeHtmlAttribute(opt_data.filter.id) + '">' + soy.$$escapeHtml("Delete") + '</a></li></ul>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavFilter.renameFilterDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content"><form action="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("")), '/rest/api/2/filter/', soy.$$escapeHtmlAttribute(opt_data.filter.id), '" class="aui" id="rename-filter-form" method="put"><div class="aui-messages"></div><div class="form-body"><h2 class="dialog-title">', soy.$$escapeHtml("Rename Filter"), ': ', soy.$$escapeHtml(opt_data.filter.name), '</h2><div class="field-group"><label for="filterName">', soy.$$escapeHtml("Filter Name"), '<span class="aui-icon icon-required"><span class="content">Required</span></span></label><input type="text" id="filterName" name="name" value="', soy.$$escapeHtmlAttribute(opt_data.filter.name), '" class="text long-field"></div></div><div class="buttons-container form-footer"><div class="buttons"><input accesskey="', soy.$$escapeHtmlAttribute("s"), '" title="', soy.$$escapeHtmlAttribute(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="aui-button submit" type="submit" value="', soy.$$escapeHtmlAttribute("Submit"), '" /><a accesskey="', soy.$$escapeHtmlAttribute("`"), '" title="', soy.$$escapeHtmlAttribute(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="aui-button aui-button-link cancel" href="javascript:">', soy.$$escapeHtml("Cancel"), '</a></div></div></form></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavFilter.deleteFilterDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content"><form action="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("")), '/rest/api/2/filter/', soy.$$escapeHtmlAttribute(opt_data.filter.id), '" class="aui" id="delete-filter-form" method="delete"><div class="aui-messages"></div><div class="form-body"><h2 class="dialog-title">', soy.$$escapeHtml("Delete Filter"), ': ', soy.$$escapeHtml(opt_data.filter.name), '</h2>');
  if (opt_data.filter.subscriptions.items.length) {
    output.append('<p class="form-description">', soy.$$escapeHtml(AJS.format("The filter {0} has the following subscriptions. Are you sure you want to delete it?",opt_data.filter.name)), '</p>');
    JIRA.Templates.IssueNavSearchHeader.filterSubscriptionList(opt_data, output);
    output.append('<p class="form-description"><a href="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("")), '/secure/ViewSubscriptions.jspa?filterId=', soy.$$escapeUri(opt_data.filter.id), '">', soy.$$escapeHtml("Manage subscriptions"), '</a></p>');
  } else {
    output.append('<p class="form-description">', soy.$$escapeHtml(AJS.format("Are you sure you want to delete the filter {0}?",opt_data.filter.name)), '</p>');
  }
  output.append('</div><div class="buttons-container form-footer"><div class="buttons"><input accesskey="', soy.$$escapeHtmlAttribute("s"), '" title="', soy.$$escapeHtmlAttribute(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="aui-button submit" type="submit" value="', soy.$$escapeHtmlAttribute("Delete"), '" /><a accesskey="', soy.$$escapeHtmlAttribute("`"), '" title="', soy.$$escapeHtmlAttribute(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="aui-button aui-button-link cancel" href="javascript:">', soy.$$escapeHtml("Cancel"), '</a></div></div></form></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavFilter.filterList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.filters.length > 0) {
    output.append('<ul class="saved-filter filter-list ', soy.$$escapeHtmlAttribute(opt_data.name), '">');
    var filterList135 = opt_data.filters;
    var filterListLen135 = filterList135.length;
    for (var filterIndex135 = 0; filterIndex135 < filterListLen135; filterIndex135++) {
      var filterData135 = filterList135[filterIndex135];
      output.append((opt_data.name == 'favourite-filters') ? '<li><a class="filter-link" href="' + soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("")) + '/issues/?filter=' + soy.$$escapeUri(filterData135.id) + '" data-id="' + soy.$$escapeHtmlAttribute(filterData135.id) + '" title="' + soy.$$escapeHtmlAttribute(filterData135.name) + '">' + soy.$$escapeHtml(filterData135.name) + '</a><a href="#" class="filter-actions" data-id="' + soy.$$escapeHtmlAttribute(filterData135.id) + '"><span>' + soy.$$escapeHtml("Filter Actions") + '</span></a></li>' : '<li><a class="filter-link' + ((filterData135.requiresLoginForUser) ? ' requires-login' : '') + '" href="' + soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(filterData135.navUrl)) + '" data-id="' + soy.$$escapeHtmlAttribute(filterData135.id) + '" title="' + soy.$$escapeHtmlAttribute(filterData135.name) + '">' + soy.$$escapeHtml(filterData135.name) + '</a></li>');
    }
    output.append('</ul>');
  } else {
    output.append('<p class="filter-info ', soy.$$escapeHtmlAttribute(opt_data.name), '">', opt_data.fallbackMessage, '</p>');
  }
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/filters/FilterModel.js' */
Backbone.define("JIRA.Issues.FilterModel",JIRA.Issues.BaseModel.extend({properties:["id","name","description","jql","favourite","isSystem","sharePermissions","subscriptions","ownerUserName","ownerDisplayName","avatarUrl","requiresLogin","isValid"],defaults:{isSystem:false,isValid:true},urlRoot:contextPath+"/rest/api/2/filter/",getOwner:function(){return this.getOwnerDisplayName()||this.getOwnerUserName()},isFavouriteFilter:function(){return !this.getIsSystem()&&!!this.getFavourite()},url:function(){return this.urlRoot+encodeURIComponent(this.id)+"?expand="+JIRA.Issues.FilterModel.getExpandValue()},isMyFilter:function(){return !this.getIsSystem()&&this.getOwnerUserName()===JIRA.Issues.LoginUtils.loggedInUserName()},parse:function(b,a){return JIRA.Issues.FilterModel.transformToModel(b)},getOperationsJson:function(a){var c={};var b=JIRA.Issues.FilterModel.operations;c.primary=_.filter(b.primary,_.bind(function(d){return d.validate.call(this,a)},this));c.secondary=_.filter(b.secondary,_.bind(function(d){return d.validate.call(this,a)},this));c.primary=_.map(c.primary,_.bind(function(d){return this._opAsJSON(d)},this));c.secondary=_.map(c.secondary,_.bind(function(d){return this._opAsJSON(d)},this));return c},_opAsJSON:function(b){var a={};jQuery.each(b,_.bind(function(c,d){if(c!=="validate"){a[c]=jQuery.isFunction(d)?d.call(this):d}},this));return a},getNumberOfAdditionalSubscriptions:function(){var a=this.getSubscriptions();return a.size>a.items.length?a.size-a.items.length:0},saveFavourite:function(b){var a=this;var c=this.getFavourite();this.setFavourite(b);if(this.pendingRequest){this.pendingRequest.abort()}this.pendingRequest=JIRA.SmartAjax.makeRequest({url:AJS.contextPath()+"/rest/api/1.0/filters/"+encodeURIComponent(this.getId())+"/favourite",type:b?"PUT":"DELETE"}).then(function(){delete a.pendingRequest}).done(function(d){var e=AJS.$(d).text().match(/favourite state: (\w+)/)[1]==="true";a.setFavourite(e)}).fail(function(){a.setFavourite(c)});return this.pendingRequest},saveFilter:function(b){if(this.pendingRequest){this.pendingRequest.abort()}var c=JIRA.Issues.FilterModel.transformFromModel(this.toJSON());c.jql=b;var a=this;this.pendingRequest=JIRA.SmartAjax.makeRequest({url:this.url(),type:"PUT",contentType:"application/json",data:JSON.stringify(c)}).done(function(d){a.set(JIRA.Issues.FilterModel.transformToModel(d))}).then(function(){delete a.pendingRequest;JIRA.trace("jira.filter.saved")});return this.pendingRequest},toJSONForTemplate:function(){var a=this.toJSON();_.extend(a,{requiresLoginForUser:this._requiresLoginForUser(this.getRequiresLogin()),navUrl:this._constructNavUrl(this.getId(),this.getRequiresLogin())});return a},_requiresLoginForUser:function(a){return !JIRA.Issues.LoginUtils.isLoggedIn()&&a},_constructNavUrl:function(a,b){var c="/issues/?filter="+a;if(this._requiresLoginForUser(b)){return JIRA.Issues.LoginUtils.redirectUrl(c)}else{return contextPath+c}},_getFavouriteText:function(){if(this.isFavouriteFilter()){return "Remove this filter from your Favorite Filters"}else{return "Add this filter to your Favorite Filters"}}},{maxSubscriptions:5,getExpandValue:function(){return"subscriptions[-"+JIRA.Issues.FilterModel.maxSubscriptions+":]"},transformToModel:function(a){if(a.subscriptions&&a.subscriptions.items){a.subscriptions.items.reverse()}return{id:a.id,name:a.name,description:a.description,jql:a.jql,favourite:a.favourite,sharePermissions:a.sharePermissions||[],subscriptions:a.subscriptions,ownerUserName:a.owner&&a.owner.name,ownerDisplayName:a.owner&&a.owner.displayName,avatarUrl:a.owner&&a.owner.avatarUrls["48x48"],requiresLogin:a.requiresLogin}},transformFromModel:function(a){return{id:a.id,name:a.name,jql:a.jql,favourite:a.favourite}},operations:{primary:[{id:"save",styleClass:"save-changes",label:"Save",validate:function(a){return a.isDirty&&this.isMyFilter()}},{id:"saveAs",styleClass:"save-as-new-filter",label:"Save as",href:AJS.contextPath()+"/secure/SaveAsFilter!default.jspa",validate:function(){return !!JIRA.Issues.LoginUtils.loggedInUserName()}},{id:"discardChanges",styleClass:"discard-filter-changes",label:"Discard changes",validate:function(a){return a.isDirty}}],secondary:[{id:"details",styleClass:"show-filter-details",title:"View information about this filter",validate:function(){return !this.getIsSystem()},label:"Details"},{id:"favourite",title:function(){return this._getFavouriteText()},label:function(){return this._getFavouriteText()},styleClass:function(){return"fav-link icon"+(this.isFavouriteFilter()?" on":" off")},href:function(){return AJS.contextPath()+"/secure/EditFilter!default.jspa?filterId="+this.id},validate:function(){return !!JIRA.Issues.LoginUtils.loggedInUserName()&&!this.getIsSystem()}}]},getOpById:function(a){return _.find(this.operations.primary.concat(this.operations.secondary),function(b){if(b.id===a){return true}})}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/filters/FilterCollection.js' */
Backbone.define("JIRA.Issues.FilterCollection",JIRA.Issues.BaseCollection.extend({model:JIRA.Issues.FilterModel,fetch:function(){this.trigger("fetch",this);return JIRA.Issues.BaseCollection.prototype.fetch.apply(this,arguments)},initialize:function(b,a){this.url=a&&a.url},toJSONForTemplate:function(){return this.invoke("toJSONForTemplate")}}));Backbone.define("JIRA.Issues.SortedFilterCollection",JIRA.Issues.FilterCollection.extend({comparator:function(b,a){return b.getName().toLowerCase().localeCompare(a.getName().toLowerCase())}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/filters/FilterDialogView.js' */
Backbone.define("JIRA.Issues.FilterDialogView",JIRA.Issues.BaseView.extend({initialize:function(){_.bindAll(this)},createDialog:function(a){this.filterDialog=this.filterDialog||new JIRA.FormDialog({content:this._createDialogContent,id:a,submitHandler:this._onSubmitFilterDialog})},show:function(){this.filterDialog.show()},hide:function(){this.filterDialog.hide(true);this.filterDialog.destroy()},_createDialogContent:function(a){a()},_serializeForm:function(a){return JSON.stringify({name:a.find("[name=name]").val(),jql:a.find("[name=jql]").val()})},_getFormUrl:function(a){return a.attr("action")},_getFormRequestType:function(a){return a.attr("method")},_onSubmitFilterDialog:function(d,a){d.preventDefault();var c=this.filterDialog.$form,b=JIRA.SmartAjax.makeRequest({type:this._getFormRequestType(c),url:this._getFormUrl(c),contentType:"application/json",dataType:"json",processData:false,data:this._serializeForm(c)});b.fail(this._onSubmitError);b.done(a);b.done(this._onSubmitSuccess);b.done(this.hide);b.always(function(){JIRA.trace("jira.filter.saved")});return b},_onSubmitError:function(a){this.filterDialog.getButtonsContainer().find("input").removeAttr("disabled");this.filterDialog.hideFooterLoadingIndicator();this.filterDialog.$form.removeClass("submitting");this._appendErrorContent(this.filterDialog.$popup,a);this.filterDialog.$form.find("#filterName").focus()},_onSubmitSuccess:jQuery.noop,_appendErrorContent:function(a,d){var b=a.find(".aui-messages");var f=JSON.parse(d.responseText);a.find(".error").remove();b.empty();try{if(f&&f.errors){jQuery.each(f.errors,function(g,e){a.find("#"+g).after("<div class='error'>"+AJS.escapeHTML(e)+"</div>")})}if(f&&f.errorMessages){jQuery.each(f.errorMessages,function(g,h){var e=JIRA.Issues.getDefaultMessageOptions();e.body=AJS.escapeHTML(h);e.shadowed=false;AJS.messages.error(b,e)})}else{b.append(JIRA.SmartAjax.buildDialogErrorContent(d,true))}}catch(c){b.append(JIRA.SmartAjax.buildDialogErrorContent(d,true))}}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/filters/FilterRenameDialogView.js' */
Backbone.define("JIRA.Issues.FilterRenameDialogView",JIRA.Issues.FilterDialogView.extend({template:JIRA.Templates.IssueNavFilter.renameFilterDialog,initialize:function(a){_.bindAll(this);this.filterId=a.filterId;this.createDialog(a.id)},_createDialogContent:function(c){var a=this;var b=this.model.getFilterById(this.filterId);b.done(function(d){c(a.template({modifierKey:AJS.Navigator.modifierKey(),filter:d.toJSON()}))})},_onSubmitSuccess:function(a){this.filterDialog.hide(true);this.filterDialog.destroy();a=this.model.setRenamedFilterName(a);JIRA.Messages.showSuccessMsg(AJS.format("The filter \u003cstrong>{0}\u003c\/strong> has been renamed.",AJS.escapeHtml(a.getName())),JIRA.Issues.getDefaultMessageOptions())}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/filters/FilterDeleteDialogView.js' */
Backbone.define("JIRA.Issues.FilterDeleteDialogView",JIRA.Issues.FilterDialogView.extend({template:JIRA.Templates.IssueNavFilter.deleteFilterDialog,initialize:function(a){_.bindAll(this);this.filterId=a.filterId;this.createDialog(a.id)},_createDialogContent:function(c){var a=this;var b=this.model.getFilterById(this.filterId);b.done(_.bind(function(d){this.filter=d;c(a.template({modifierKey:AJS.Navigator.modifierKey(),filter:d.toJSON()}))},this))},_onSubmitSuccess:function(){this.filterDialog.hide(true);this.filterDialog.destroy();var a=this.filter.getName();this.model.deleteFilter(this.filter);JIRA.Messages.showSuccessMsg(AJS.format("The filter \u003cstrong>{0}\u003c\/strong> has been deleted.",AJS.escapeHtml(a)),JIRA.Issues.getDefaultMessageOptions())}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/filters/FilterSaveDialogView.js' */
Backbone.define("JIRA.Issues.FilterSaveDialogView",JIRA.Issues.FilterDialogView.extend({template:JIRA.Templates.IssueNavSearchHeader.saveFilterDialog,initialize:function(a){_.bindAll(this);this._searchPageModule=a.searchPageModule;this.type=a.type;this.createDialog(a.id)},_createDialogContent:function(b){var a=this;JIRA.SmartAjax.makeRequest({url:AJS.contextPath()+"/rest/api/2/filter/defaultShareScope",contentType:"application/json"}).done(function(c){b(a._createSaveAsDialogHtml(c&&c.scope==="GLOBAL"))})},_onSubmitFilterDialog:function(c,b){c.preventDefault();var a=this;if(AJS.$("#setSharingPrivate").prop("checked")){JIRA.SmartAjax.makeRequest({url:AJS.contextPath()+"/rest/api/2/filter/defaultShareScope",type:"PUT",contentType:"application/json",processData:false,data:JSON.stringify({scope:"PRIVATE"})}).done(function(){a._sendFormAsFilter(b)})}else{this._sendFormAsFilter(b)}},_sendFormAsFilter:function(a){var c=this.filterDialog.$form;var b=JIRA.SmartAjax.makeRequest({type:"POST",url:c.attr("action")+"?expand="+JIRA.Issues.FilterModel.getExpandValue(),contentType:"application/json",processData:false,data:JSON.stringify({jql:c.find("[name=jql]").val(),name:c.find("[name=name]").val(),id:c.find("[name=filterId]").val(),favourite:true})});b.fail(this._onSubmitError);b.done(a);b.done(this._onSubmitSuccess);b.done(this._hideDialog);b.always(function(){JIRA.trace("jira.filter.saved")})},_getCurrentFilter:function(){if(this.model){return this.model}else{return this._searchPageModule.getFilter()}},_createSaveAsDialogHtml:function(d){var b=this._getCurrentFilter();var a;var e;var c=[];if(this.type===JIRA.Issues.FilterSaveDialogView.Types.COPY){a="Copy Filter"+" : "+this.model.getName();c.push({name:"filterId",value:this.model.getId()});e=AJS.format("Copy of {0}",this.model.getName())}else{a="Save Filter";if(b&&!b.getIsSystem()){c.push({name:"filterId",value:b.getId()})}c.push({name:"jql",value:this._searchPageModule.getEffectiveJql()})}return this.template({hiddenFields:c,headerText:a,prefilledFilterName:e,contextPath:AJS.contextPath(),modifierKey:AJS.Navigator.modifierKey(),copyFromAnotherUser:b&&b.getOwnerUserName()!==AJS.Meta.get("remote-user"),filterOwnerName:b&&b.getOwnerDisplayName(),isDefaultShareScopeGlobal:d,filter:(this.model)?this.model.toJSON():null})},_getFormUrl:function(a){return a.attr("action")+a.find("[name=id]").val()},_onSubmitSuccess:function(b){var a=new JIRA.Issues.FilterModel(JIRA.Issues.FilterModel.transformToModel(b));this._searchPageModule.filterModuleSaved(a,true);this._searchPageModule.setSessionSearch(a);this.filterDialog.hide(true);this.filterDialog.destroy()}}));JIRA.Issues.FilterSaveDialogView.Types={SAVE_AS:"saveAs",COPY:"copy"};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/filters/FilterPanelView.js' */
Backbone.define("JIRA.Issues.FilterPanelView",JIRA.Issues.BaseView.extend({events:{"click .filter-actions":"_showActionsDropdown","simpleClick .filter-list a.filter-link:not(.requires-login)":"_onClickFilter","simpleClick .new-search":"_onClickNewSearch","click .ui-dock":"_onDockFilterPanelClick","click .ui-undock":"_onUndockFilterPanelClick"},collapsedTemplate:JIRA.Templates.IssueNavFilter.collapsedFiltersPanel,template:JIRA.Templates.IssueNavFilter.filtersPanel,initialize:function(a){_.bindAll(this);if(a.easeOff){this._adjustFavouriteFiltersHeight=_.debounce(this._adjustFavouriteFiltersHeight,a.easeOff)}JIRA.Issues.onVerticalResize(this._adjustFavouriteFiltersHeight);this.filterActionsDialogView=new JIRA.Issues.FilterActionsDialogView({el:this.$el,model:this.model,searchPageModule:a.searchPageModule});this.model.favouriteFiltersCollection.bind("change add remove reset",_.bind(function(){delete this.favouriteFiltersFallback;this.render()},this));this.model.favouriteFiltersCollection.bind("fetch",_.bind(function(){this.favouriteFiltersFallback="Loading favourite filters...";this.render()},this));this.model.favouriteFiltersCollection.bind("error",_.bind(function(){this.favouriteFiltersFallback="Failed to retrieve favourite filters from server.";this.render()},this));this.model.systemFiltersCollection.bind("change",this.render);this.panelReady=jQuery.Deferred();this.searchPageModule=a.searchPageModule;this.searchPageModule.bind("change:currentLayout",this._adjustFavouriteFiltersHeight);this.searchPageModule.bind("change:filter",this._renderSelectedFilter);JIRA.bind(JIRA.Events.LAYOUT_RENDERED,_.bind(function(c,b){if(b){delete this._splitViewSidebarElement}else{this._splitViewSidebarElement=AJS.$(".list-results-panel:first")}},this));if(this.model.initialFavouritesFetch&&this.model.initialFavouritesFetch.state()==="pending"){this.model.favouriteFiltersCollection.trigger("fetch")}},_adjustFavouriteFiltersHeight:function(){var f=AJS.$(".jira-feedback-link-container.subtle-style").outerHeight(true),d=f?f+10:0,c=this.$(".favourite-filters"),a=c.length&&c.offset().top,b=this.searchPageModule.getCurrentLayout() instanceof JIRA.Issues.SplitScreenLayout,e=jQuery(window).outerHeight();c.css("height",e-a-d)},_onDockFilterPanelClick:function(){AJS.$(".navigator-container").removeClass("navigator-sidebar-collapsed")},_onUndockFilterPanelClick:function(){AJS.$(".navigator-container").addClass("navigator-sidebar-collapsed")},toggleDockState:function(){this.$el.popoutSidebar("toggle")},_onClickFilter:function(b){b.preventDefault();var a=jQuery(b.target).data("id");this.searchPageModule.resetToFilter(a)},_onClickNewSearch:function(a){a.preventDefault();this.searchPageModule.resetToBlank({isNewSearch:true})},render:function(){if(!this.model.isDocked()){AJS.$(".navigator-container").addClass("navigator-sidebar-collapsed");this._renderCollapsed()}else{AJS.$(".navigator-container").removeClass("navigator-sidebar-collapsed");this._renderOpen()}var a=AJS.KeyboardShortcut.getKeyboardShortcutKeys("toggle.filter.panel");this.$el.popoutSidebar({isDocked:this.model.isDocked(),expandedWidth:this.model.getWidth(),renderExpanded:this._renderOpen,renderCollapsed:this._renderCollapsed,undockText:"Undock",undockTitle:AJS.format("Undock the filter panel so it is hidden when not being focused (Type \'\'{0}\'\')",a),dockText:"Dock",dockTitle:AJS.format("Dock the filter panel so you can always see the list of filters (Type \'\'{0}\'\')",a),toggleTarget:".filter-title:first",persist:_.bind(function(c,b){this.model.setDocked(c);this.model.setWidth(b)},this),resize:_.bind(function(){this._splitViewSidebarElement&&this._splitViewSidebarElement.sidebar("updatePosition")},this)});if(this.model.shouldShowDockIntro()){this.$el.popoutSidebar("collapse",false)}if(this.model.isDocked()){this.$el.popoutSidebar("renderDockState")}this._fireDockAnalytics();this.panelReady.resolve();return this.$el},_fireDockAnalytics:function(){if(localStorage.getItem("dockStatesAnalyticsEnabled")){var a=this.model.isDocked();if(localStorage.getItem("dockStateAnalytic")!==""+a){localStorage.setItem("dockStateAnalytic",a);JIRA.Issues.Analytics.trigger("kickass.filters.docked",{isDocked:this.model.isDocked()})}}},_renderCollapsed:function(){var a=jQuery(".jira-feedback-link-container.subtle-style").detach().addClass("left noborder");this.$el.addClass("collapsed").html(this.collapsedTemplate({isDocked:this.model.isDocked()}));JIRA.Issues.triggerHorizontalResize();a.appendTo("body");return this},_renderOpen:function(){var b=jQuery(".jira-feedback-link-container.subtle-style").detach().removeClass("left noborder");this.$el.removeClass("collapsed");this.model.favouriteFiltersCollection.sort({silent:true});this.$el.width(this.model.getWidth());this.$el.html(this.template({contextPath:window.contextPath,favouriteFilters:this.model.favouriteFiltersCollection.toJSONForTemplate(),favouriteFiltersFallback:this.favouriteFiltersFallback,isAnonymous:!JIRA.Issues.LoginUtils.isLoggedIn(),loginUrl:JIRA.Issues.LoginUtils.redirectUrlToCurrent(),systemFilters:this.model.systemFiltersCollection.toJSONForTemplate()}));this._renderSelectedFilter();JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.filterPanelOpened]);var a=this;this.$el.find("a.filter-actions").each(function(e,c){var g=new AJS.Dropdown({alignment:AJS.LEFT,styleClass:"filter-actions-dropdown",content:function(){return a.filterActionsDialogView.getDropdownContents(AJS.$(c))},positioningController:new JIRA.Issues.WindowPositioning(),trigger:AJS.$(c)});var f=AJS.$(c).find("span"),d=AJS.$(c).closest("li");g.bind("hideLayer",function(){f.removeClass("active");d.removeClass("hover")});g.bind("showLayer",function(){f.addClass("active");d.addClass("hover");a.filterActionsDialogView.setElement(this.layerController.$layer)})});b.appendTo(this.$el);JIRA.Issues.triggerHorizontalResize();this._adjustFavouriteFiltersHeight();return this},_renderSelectedFilter:function(){var a=this.searchPageModule.getFilter();this.$el.find(".filter-list a").removeClass("active");if(a){this.$el.find(".filter-list a.filter-link").each(function(){var b=jQuery(this);if(b.data("id")==a.getId()){b.addClass("active").focus().blur();return false}return true})}},_showActionsDropdown:function(b){b.preventDefault();var a=AJS.$(b.target).parents("li").addClass("open");AJS.$(document).one("hideLayer",function(){a.removeClass("open")})}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/filters/FilterPanelModel.js' */
(function(){var b="issues.sidebar.docked";var a="issues.sidebar.width";Backbone.define("JIRA.Issues.FilterPanelModel",JIRA.Issues.BaseModel.extend({initialize:function(c,d){_.extend(this,_.defaults(d,{storage:window.localStorage}));this.favouriteFiltersCollection=new JIRA.Issues.SortedFilterCollection([],{url:JIRA.Issues.FilterPanelModel.favouriteFiltersURL()});this.systemFiltersCollection=new JIRA.Issues.FilterCollection(d.systemFilters);this.favouriteFiltersCollection.on("change:favourite",this._removeUnfavouritedFilters,this);this.initialFavouritesFetch=this.favouriteFiltersCollection.fetch()},addFavouriteFilter:function(c){if(!this.favouriteFiltersCollection.get(c.getId())){this.favouriteFiltersCollection.add(c)}return this.favouriteFiltersCollection.get(c.getId())},addSystemFilters:function(c){this.systemFiltersCollection.add(c);this.systemFiltersCollection.trigger("change")},deleteFilter:function(d){var d=this.favouriteFiltersCollection.get(d),c=this.searchPageModule.getFilter();if(d){this.favouriteFiltersCollection.remove(d);if(c&&c.getId()===d.getId()){this.searchPageModule.resetToBlank()}}},getFilterById:function(d){var c=jQuery.Deferred();var e=this.systemFiltersCollection.get(d)||this.favouriteFiltersCollection.get(d);if(e){c.resolve(e)}else{e=new JIRA.Issues.FilterModel({id:d});e.fetch({success:_.bind(function(h,g){var f=this.favouriteFiltersCollection;if(e.getFavourite()){this.initialFavouritesFetch.done(function(){c.resolve(f.get(d)||e)});this.initialFavouritesFetch.fail(function(){c.resolve(h)})}else{c.resolve(e)}},this),error:function(f){f.setIsValid(false);c.reject.apply(this,arguments)}})}return c.promise()},setDocked:function(c){this._getStorage().setItem("dockStatesAnalyticsEnabled",true);return this._getStorage().setItem(b,c)},setWidth:function(c){return this._getStorage().setItem(a,c)},getWidth:function(){var c=parseInt(this._getStorage().getItem(a),10);return((c>0)?c:200)},_removeUnfavouritedFilters:function(){var c=this.favouriteFiltersCollection;c.remove(c.filter(function(d){return !d.getFavourite()}))},setRenamedFilterName:function(c){var d=this.favouriteFiltersCollection.get(c.id);if(d){d.setName(c.name)}return d},_getStorage:function(){return this.storage||window.localStorage},_getWindowWidth:function(){return jQuery(window).width()},isDockedPrefGiven:function(){return this._getStorage().getItem(b)!==null},shouldShowDockIntro:function(){return !this.isDocked()&&!this.isDockedPrefGiven()},isExpanded:function(){return this.shouldShowDockIntro()?false:this.isDocked()},isDocked:function(){var c=this._getStorage();if(c.getItem(b)==null){return this._getWindowWidth()>1200}else{return c.getItem(b)!=="false"}}},{favouriteFiltersURL:function(){return contextPath+"/rest/api/2/filter/favourite?expand="+JIRA.Issues.FilterModel.getExpandValue()}}))}());
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/filters/FilterModule.js' */
Backbone.define("JIRA.Issues.FilterModule",JIRA.Issues.BaseEvented.extend({initialize:function(a){_.bindAll(this);this._searchPageModule=a.searchPageModule;this.newSearchFilter=new JIRA.Issues.FilterModel({name:"Search"});this.filterPanelModel=a.filterPanelModel||new JIRA.Issues.FilterPanelModel({},{searchPageModule:a.searchPageModule,systemFilters:a.systemFilters})},canEditColumns:function(){var a=this._searchPageModule.getFilter();return a&&a.isMyFilter()},initSystemFilters:function(){var a=jQuery.Deferred(),b=!!this.filterPanelModel.systemFiltersCollection.size();if(b){a.resolve()}else{AJS.$.ajax({context:this,url:AJS.contextPath()+"/rest/issueNav/latest/systemFilters"}).done(function(c){var d=this._searchPageModule.addOwnerToSystemFilters(JSON.parse(c));this.filterPanelModel.addSystemFilters(d);a.resolve()}).fail(function(){a.reject()})}return a.promise()},addFavouriteFilter:function(a){return this.filterPanelModel.addFavouriteFilter(a)},getNewSearchFilter:function(){return this.newSearchFilter},getFilterById:function(a){return this.filterPanelModel.getFilterById(a)},createView:function(a){this.filterPanelView=new JIRA.Issues.FilterPanelView({el:a.$filterPanelEl,model:this.filterPanelModel,searchPageModule:this._searchPageModule,easeOff:(!!jQuery.browser.msie&&jQuery.browser.version<=8)?500:0});return this.filterPanelView},toggleFilterPanel:function(){this.filterPanelView.toggleDockState()},createHelptipForFilterPanelDocking:function(){var d="filters-dock-intro";var c=this.filterPanelModel;var b=this.filterPanelView;if(c.shouldShowDockIntro()&&b.$el.is(":visible")){var a=new AJS.HelpTip({id:d,title:"Did you notice?",bodyHtml:"You can dock the filter bar to always show your list of filters.",anchor:".ui-dock",isSequence:true,weight:2,callbacks:{beforeShow:function(){b.$el.popoutSidebar("expand",false)},init:function(){if(b.$el.popoutSidebar("isUndocked")){b.$el.popoutSidebar("unbindHoverIntent")}},hide:function(){if(b.$el.popoutSidebar("isUndocked")){b.$el.popoutSidebar("bindHoverIntent");b.$el.popoutSidebar("collapse")}}}});return a}}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/filters/FilterActionsDialogView.js' */
Backbone.define("JIRA.Issues.FilterActionsDialogView",JIRA.Issues.BaseView.extend({template:JIRA.Templates.IssueNavFilter.filterDropDown,events:{"click .rename-filter":"_renameFilter","click .copy-filter":"_copyFilter","click .unfavourite-filter":"_unFavouriteFilter","click .delete-filter":"_deleteFilter"},initialize:function(a){this._searchPageModule=a.searchPageModule;_.bindAll(this)},getDropdownContents:function(c){var d=this.model.getFilterById(c.data("id")),a=this,b=jQuery.Deferred();d.done(function(e){b.resolve(AJS.$(a.template({filter:e,canEdit:JIRA.Issues.LoginUtils.loggedInUserName()===e.getOwnerUserName()})))});return b},_renameFilter:function(a){a.preventDefault();var b=AJS.$(a.target).data("id");new JIRA.Issues.FilterRenameDialogView({id:"rename-filter-dialog",model:this.model,filterId:b}).show()},_copyFilter:function(a){a.preventDefault();var b=AJS.$(a.target).data("id");this._getFilter(b,_.bind(function(c){new JIRA.Issues.FilterSaveDialogView({id:"copy-filter-dialog",type:JIRA.Issues.FilterSaveDialogView.Types.COPY,searchPageModule:this._searchPageModule,model:c}).show()},this))},_unFavouriteFilter:function(a){a.preventDefault();var b=AJS.$(a.target).data("id");this._getFilter(b,function(c){c.saveFavourite(false)})},_deleteFilter:function(a){a.preventDefault();var b=AJS.$(a.target).data("id");new JIRA.Issues.FilterDeleteDialogView({id:"delete-filter-dialog",model:this.model,filterId:b}).show()},_getFilter:function(c,b){var a=this.model.getFilterById(c);a.done(b)}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/util/WindowPositioning.js' */
JIRA.Issues.WindowPositioning=AJS.InlineLayer.StandardPositioning.extend({_calculateOverflow:function(c){var b=this.layer().css("position")==="fixed",a=c.top+this.layer().outerHeight(true),e=jQuery(window).outerHeight(),d=jQuery(window).scrollTop();if(b){return Math.max(0,a-e)}else{return Math.max(0,a-d-e)}},left:function(){var a=this._super(),b=this._calculateOverflow(a);if(b>0){a.left+=this.offsetTarget().outerWidth();a.top-=b}return a},right:function(){var a=this._super(),b=this._calculateOverflow(a);if(b>0){a.left-=this.offsetTarget().outerWidth();a.top-=b}return a}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:columnpicker', location = 'columnpicker/ColumnPicker.soy' */
// This file was automatically generated from ColumnPicker.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Dialogs == 'undefined') { JIRA.Templates.Dialogs = {}; }
if (typeof JIRA.Templates.Dialogs.ColumnPicker == 'undefined') { JIRA.Templates.Dialogs.ColumnPicker = {}; }


JIRA.Templates.Dialogs.ColumnPicker.popup = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div><form action="#" method="post"  class="aui top-label column-picker"><div class="check-list-top-panel"><h3>', soy.$$escapeHtml("Columns"), '</h3>');
  if (opt_data.columns.length > 1) {
    output.append('<p class="aui-buttons">');
    var columnList9 = opt_data.columns;
    var columnListLen9 = columnList9.length;
    for (var columnIndex9 = 0; columnIndex9 < columnListLen9; columnIndex9++) {
      var columnData9 = columnList9[columnIndex9];
      output.append('<button type="button" class="config-chooser aui-button ', (columnData9.isActive) ? ' active' : '', '" id="columns-chooser-', soy.$$escapeHtml(columnData9.name), '" data-value="', soy.$$escapeHtml(columnData9.name), '"', (columnData9.isDisabled) ? 'aria-disabled="true"' : '', '>', soy.$$escapeHtml(columnData9.description), '</button>');
    }
    output.append('</p>');
  }
  output.append('</div>');
  var columnList28 = opt_data.columns;
  var columnListLen28 = columnList28.length;
  for (var columnIndex28 = 0; columnIndex28 < columnListLen28; columnIndex28++) {
    var columnData28 = columnList28[columnIndex28];
    output.append('<div class="', soy.$$escapeHtml(columnData28.name), '-column-sparkler hidden"></div>');
  }
  output.append((! opt_data.isAutoUpdate) ? '<div class="button-panel"><input accesskey="' + soy.$$escapeHtml("s") + '" title="' + soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)) + '" class="aui-button submit" type="submit" value="' + soy.$$escapeHtml("Done") + '"/> <a accesskey="' + soy.$$escapeHtml("`") + '" title="' + soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)) + '" class="aui-button aui-button-link close-dialog" href="javascript:">' + soy.$$escapeHtml("Cancel") + '</a></div>' : '', '</form></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.ColumnPicker.trigger = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<button class="aui-button aui-button-subtle column-picker-trigger" title="', soy.$$escapeHtml("Columns"), '">', soy.$$escapeHtml("Columns"), '</button>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.ColumnPicker.restoreDefaultsLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<button class="aui-button aui-button-link restore-defaults">', soy.$$escapeHtml(opt_data.linkText), '</button>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-components:columnpicker', location = 'columnpicker/ColumnPicker.js' */
if(!JIRA.Components){JIRA.Components={}}JIRA.Components.ColumnPicker=JIRA.Issues.Brace.Model.extend({initialize:function(a,b){this.columnPickerModel=new JIRA.Issues.ColumnPickerModel({autoUpdate:b.autoUpdate});this.columnPickerView=new JIRA.Issues.ColumnPickerView({columnPickerModel:this.columnPickerModel});_.each(b.providers,_.bind(function(c){if(c instanceof JIRA.Issues.ColumnConfigModel){this.columnPickerModel.addColumnProvider(c.getName(),c)}else{this.columnPickerModel.addColumnProvider(c.id,this._createProviderModel(c));if(c.columns){this.columnPickerModel.syncColumns(c.id,c.columns)}}},this));this.setCurrentColumnConfig(b.providers[0].id);if(b.el){this.columnPickerView.setElement(b.el).render()}},_createProviderModel:function(a){return JIRA.Issues.ColumnConfigModel.create(a.id,a.label,_.omit(a,"id","label","columns"))},getCurrentColumnConfig:function(){return this.columnPickerModel.getCurrentColumnConfig()},setElement:function(a){this.columnPickerView.setElement(a);return this},render:function(){this.columnPickerView.render();return this},clearFilterConfiguration:function(){this.columnPickerModel.clearFilterConfiguration();return this},adjustHeight:function(){this.columnPickerView.adjustHeight();return this},setCurrentColumnConfig:function(a){this.columnPickerModel.setCurrentColumnConfig(a);return this},saveColumns:function(a){this.columnPickerModel.saveColumns(a);return this},syncColumns:function(a,b){this.columnPickerModel.syncColumns(a,b);return this},getColumnConfig:function(){this.columnPickerModel.getColumnConfig()},onColumnsSync:function(b,a){this.columnPickerModel.onColumnsSync(b,a);return this},on:function(b,c,a){this.columnPickerModel.on(b,c,a);return this},off:function(a,b){this.columnPickerModel.off(a,b);return this}});JIRA.Components.ColumnPicker.create=function(a){return new JIRA.Components.ColumnPicker(null,a)};
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:columnpicker', location = 'columnpicker/ColumnPickerModel.js' */
JIRA.Issues.ColumnPickerModel=JIRA.Issues.Brace.Model.extend({namedAttributes:["columnConfig","savedColumnConfig","search","availableColumns","autoUpdate"],namedEvents:["columnsSync","changeColumnConfigDisabled","destroyColumnConfig"],allColumnsUrl:AJS.contextPath()+"/rest/gadget/1.0/availableColumns",shouldRefreshSearchOnActivation:function(){return this.getCurrentColumnConfig().shouldRefreshSearchOnActivation()},shouldCloseOnActivation:function(){return this.getCurrentColumnConfig().shouldCloseOnActivation()},shouldLoadDefaultsOnActivation:function(){return this.getCurrentColumnConfig().shouldLoadDefaultsOnActivation()},shouldRevertOnHide:function(){return this.getCurrentColumnConfig().shouldRevertOnHide()},loadDefaultColumns:function(){this.getCurrentColumnConfig().loadDefaultColumns()},initialize:function(){_.bindAll(this);this.columnsData={}},refreshSearchWithColumns:function(a){a=a||this.getCurrentColumnConfig();this.triggerColumnsSync(a.getName(),a.getColumns())},fetchAvailableColumnsIfNeeded:function(){if(!this.has("availableColumns")){jQuery.ajax(this.allColumnsUrl).done(_.bind(function(a){this.setAvailableColumns(a.availableColumns)},this))}},getCurrentColumnConfig:function(a){if(!a){a=this.getColumnConfig()}return this.columnsData[a]},revertColumnConfig:function(){if(this.shouldRevertOnHide()&&this.getSavedColumnConfig()!=this.getColumnConfig()){this._previousAttributes.columnConfig=this.getSavedColumnConfig();this.setColumnConfig(this.getSavedColumnConfig(),{silent:true})}},setCurrentColumnConfig:function(a){this.setColumnConfig(a);this.setSavedColumnConfig(a)},syncColumns:function(a,b){_.each(this.columnsData,function(c){if(c.getName()==a){c.setColumns(b);c.setSavedColumns(b)}})},saveColumns:function(a){this.getCurrentColumnConfig().setColumns(a);this.getCurrentColumnConfig().save();this.getCurrentColumnConfig().triggerColumnsSync()},addColumnProvider:function(b,a){this.columnsData[b]=a;a.on("columnsSync sync destroy",_.bind(function(){this.refreshSearchWithColumns(a)},this));a.on("change:isDisabled",_.bind(function(d,c){this.triggerChangeColumnConfigDisabled(d,c)},this));a.on("destroy",_.bind(function(c){this.triggerDestroyColumnConfig(c)},this))}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:columnpicker', location = 'columnpicker/ColumnPickerView.js' */
JIRA.Issues.ColumnPickerView=JIRA.Issues.Brace.View.extend({initialize:function(a){_.extend(this,a);_.bindAll(this);this.subViews={}},dialog:null,activeSubview:null,_onDOMConfigChooserClick:function(b){var a=jQuery(b.target);if(a.attr("aria-disabled")){return}this.columnPickerModel.setColumnConfig(a.data("value")||"user")},_activateNewSubView:function(a){a.activate();if(this.columnPickerModel.shouldCloseOnActivation()){this.dialog.hide()}else{this.activeSubview=a;this.activeSubview.show();this.adjustHeight()}if(this.columnPickerModel.shouldRefreshSearchOnActivation()){this.columnPickerModel.refreshSearchWithColumns()}if(this.columnPickerModel.shouldLoadDefaultsOnActivation()){this.columnPickerModel.loadDefaultColumns()}},_onDOMFormSubmit:function(a){a.preventDefault();this.activeSubview.saveColumns();this.dialog.hide()},_onDOMCloseDialogClick:function(a){this.dialog.hide()},_onDOMTriggerClick:function(a){this.dialog.show();this.activeSubview=this.subViews[this.columnPickerModel.getCurrentColumnConfig().getName()];this.activeSubview.show();this._activateConfigChooserButton(this.columnPickerModel.getCurrentColumnConfig().getName());this.columnPickerModel.fetchAvailableColumnsIfNeeded()},_activateConfigChooserButton:function(a){this.dialog.find(".config-chooser.active").removeClass("active");this.dialog.find("#columns-chooser-"+a).addClass("active")},_onDOMDialogHide:function(a){this.columnPickerModel.revertColumnConfig();this.activeSubview.hide()},_onModelChangeColumnConfig:function(d,b){var a=this.subViews[b];this._activateConfigChooserButton(a.model.getName());var c=this.subViews[d.previous("columnConfig")];if(c!=a){c.hide();c.deactivate();this._activateNewSubView(a)}},_onModelChangeAvailableColumns:function(b,a){_.each(this.subViews,function(c){c.createSparklerControl(a)})},_onModelDestroyColumnConfig:function(){this.dialog.hide()},_onModelChangeColumnConfigDisabled:function(b,a){var c=this.dialog.find("#columns-chooser-"+b.getName());if(a){c.attr("aria-disabled",true)}else{c.removeAttr("aria-disabled")}},render:function(){if(!this.$trigger){this.$trigger=jQuery(JIRA.Templates.Dialogs.ColumnPicker.trigger())}this.$el.append(this.$trigger);this.$trigger.click(this._onDOMTriggerClick);this._renderInlineDialog()},adjustHeight:function(){if(AJS.InlineDialog.current&&AJS.InlineDialog.current.id==="column-picker-dialog"&&this.activeSubview){var c=jQuery(this.activeSubview.el).find(".aui-list-scroll");var d=((jQuery(window).height()-this.$trigger.offset().top)-90);var b=d-this.dialog.height();var a=Math.max(Math.min(c.height()+b,270),80);c.css("height",a);return true}return false},_generateInlineDialogContent:function(c,a,b){if(!this.dialogContent){c.html(JIRA.Templates.Dialogs.ColumnPicker.popup({modifierKey:AJS.Navigator.modifierKey(),isAutoUpdate:this.columnPickerModel.getAutoUpdate(),columns:_.map(this.columnPickerModel.columnsData,_.bind(function(d){return{name:d.getName(),description:d.getDescription(),selected:false,isDisabled:d.isDisabled(),isActive:this.columnPickerModel.getCurrentColumnConfig()==d}},this))}));c.find(".config-chooser").click(this._onDOMConfigChooserClick);c.find("form").submit(this._onDOMFormSubmit);c.find(".close-dialog").click(this._onDOMCloseDialogClick);c.click(function(d){d.stopPropagation()});this._createSubViews(c);this.dialogContent=c.children()}else{c.append(this.dialogContent)}b()},_renderInlineDialog:function(){if(this.dialog){return}this.dialog=AJS.InlineDialog(this.$trigger,"column-picker-dialog",_.bind(this._generateInlineDialogContent,this),{offsetY:15,addActiveClass:true,hideDelay:null,noBind:true,initCallback:_.bind(function(){var a=this;var b=function(){if(!a.adjustHeight()){setTimeout(b,100)}};b()},this),hideCallback:this._onDOMDialogHide})},_createSubViews:function(a){_.each(this.columnPickerModel.columnsData,_.bind(function(b){this.subViews[b.getName()]=new JIRA.Issues.ColumnPickerSparklerView({el:a.find("."+b.getName()+"-column-sparkler"),model:b,autoUpdate:this.columnPickerModel.getAutoUpdate()})},this));if(this.columnPickerModel.has("availableColumns")){this._onModelChangeAvailableColumns(this.columnPickerModel,this.columnPickerModel.getAvailableColumns())}this.columnPickerModel.on("change:availableColumns",this._onModelChangeAvailableColumns);this.columnPickerModel.on("change:columnConfig",this._onModelChangeColumnConfig);this.columnPickerModel.onChangeColumnConfigDisabled(this._onModelChangeColumnConfigDisabled);this.columnPickerModel.onDestroyColumnConfig(this._onModelDestroyColumnConfig)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:columnpicker', location = 'columnpicker/ColumnConfigModel.js' */
JIRA.Issues.ColumnConfigModel=JIRA.Issues.Brace.Model.extend({namedAttributes:["name","columns","autoUpdate","savedColumns","description","previousColumns","actionBarText","isActive"],namedEvents:["columnsSync"],defaults:{actionBarText:"Restore Defaults",isActive:false},idAttribute:"name",initialize:function(a,b){_.extend(this,b)},getDefaultColumns:function(){var a=jQuery.Deferred();this.defaultColumns().done(_.bind(function(b){var c=this.parse(b);if(c&&c.columns){a.resolve(c.columns)}else{a.reject(null)}},this));return a.promise()},parse:function(a){if(!a){return{}}return{columns:_.compact(_.pluck(a,"value"))}},isDisabled:function(){return false},isEditDisabled:function(){return false},defaultColumns:function(){var a=jQuery.Deferred();a.resolve([]);return a.promise()},_sortColumnsUsingOriginalOrder:function(a,b){return _.intersection(a,b).concat(_.difference(b,a))},setUnsortedColumns:function(a){a=this._sortColumnsUsingOriginalOrder(this.getColumns(),a);this.setPreviousColumns(this.getColumns(),{silent:true});this.setColumns(a)},toJSON:function(){return{columns:this.getColumns()}},revertUnsavedColumns:function(a){if(this.getSavedColumns()!=this.getColumns()){this.setColumns(this.getSavedColumns(),a)}},loadDefaultColumns:function(){this.getDefaultColumns().done(_.bind(function(a){this.setColumns(a)},this))},shouldRefreshSearchOnActivation:function(){return true},shouldCloseOnActivation:function(){return true},shouldLoadDefaultsOnActivation:function(){return false},shouldRevertOnHide:function(){return true}});JIRA.Issues.ColumnConfigModel.create=function(b,d,c,a){return new JIRA.Issues.ColumnConfigModel({autoUpdate:a,name:b,description:d},c)};
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:columnpicker', location = 'columnpicker/ColumnPickerSparklerView.js' */
JIRA.Issues.ColumnPickerSparklerView=JIRA.Issues.Brace.View.extend({initialize:function(a){this._maxResults=(typeof a.maxResults=="number")?a.maxResults:this.MAX_DISPLAYED_ITEMS;this._autoUpdate=!!a.autoUpdate;this.$el.scrollLock(".aui-list-scroll");if(!this._autoUpdate){this.model.on("change:columns",_.bind(this._setSelectedColumns,this))}},MAX_DISPLAYED_ITEMS:25,_sparkler:null,activate:function(){this.model.setIsActive(true)},deactivate:function(){this.model.setIsActive(false)},hide:function(){this.model.revertUnsavedColumns({silent:true});this.$el.addClass("hidden");var a=this.$el.find("input[id *= column-sparkler-input]");a.val("")},show:function(){this.$el.removeClass("hidden");this._setSelectedColumns();var a=this.$el.find("input[id *= column-sparkler-input]");if(!a.is(":disabled")){a.focus()}},addMessage:function(a){if(this.$el.find(".aui-message."+a.type).length===0){AJS.messages[a.type](this.$el,{body:a.content,closeable:false,insert:"prepend",id:a.id})}},_disableEditIfNeeded:function(){if(this.model.isEditDisabled()){this._disableEdit()}else{this._enableEdit()}},_showEditDisabledMessage:function(){this.addMessage({content:"You cannot update the columns for a filter owned by another user.",type:"warning",id:this.model.getName()+"-edit-disabled-message"})},_hideEditDisabledMessage:function(){this.$el.find("#"+this.model.getName()+"-edit-disabled-message").remove()},_disableEdit:function(){this._sparkler.disable();this.$el.find("input[type='checkbox']").attr("disabled","disabled");this.$el.find(".check-list-item").addClass("disabled");this.$el.find(".no-suggestions").addClass("disabled");this.$el.find(".restore-defaults").attr("aria-disabled","true");this._showEditDisabledMessage()},_enableEdit:function(){this._sparkler.enable();this.$el.find("input[type='checkbox']").removeAttr("disabled");this.$el.find(".check-list-item").removeClass("disabled");this.$el.find(".no-suggestions").removeClass("disabled");this.$el.find(".restore-defaults").removeAttr("aria-disabled");this._hideEditDisabledMessage()},createSparklerControl:function(a){if(this._sparkler){this._sparkler.remove()}var b=this._buildQueryableSelect(a);this.$el.append(b);this._sparkler=new AJS.CheckboxMultiSelect({element:b,maxInlineResultsDisplayed:this._maxResults,suggestionsHandler:JIRA.Issues.ColumnPickerSuggestHandler,actionBar:this.model.getActionBarText()});this._setSelectedColumns();if(this._autoUpdate){b.bind("selected",_.bind(this.saveColumns,this));b.bind("unselect",_.bind(this.saveColumns,this))}this._sparkler.$field.focus();this.$el.on("actionclick",_.bind(function(c){c.preventDefault();this.model.unset("columns");this.model.destroy()},this));this.model.on("change:editDisabled",_.bind(this._disableEditIfNeeded,this))},saveColumns:function(){this.model.setUnsortedColumns(this._sparkler.model.getSelectedValues());this.model.save(null,{wait:false})},_setSelectedColumns:function(){var a=this.model.getColumns();var b=this._sparkler;if(b&&a&&a.length){_.each(b.model.getDisplayableUnSelectedDescriptors(),function(c){if(_.contains(a,c.value())){b.selectItem(c)}});_.each(b.model.getDisplayableSelectedDescriptors(),function(c){if(!_.contains(a,c.value())){b.unselectItem(c)}});b.render();this._disableEditIfNeeded()}},_buildQueryableSelect:function(c){var a=this;var b=_.map(c,function(d){return new AJS.ItemDescriptor(_.extend(d,{title:d.label}))});return jQuery(AJS.Templates.queryableSelect({id:a.model.getName()+"-column-sparkler",descriptors:[new AJS.GroupDescriptor({items:b})]}))}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:columnpicker', location = 'columnpicker/ColumnPickerSuggestHandler.js' */
JIRA.Issues.ColumnPickerSuggestHandler=AJS.SelectSuggestHandler.extend({createActionBar:function(b){if(!b){return null}var a=jQuery(JIRA.Templates.Dialogs.ColumnPicker.restoreDefaultsLink({linkText:b}));a.click(function(c){if(jQuery(c.target).attr("aria-disabled")!=="true"){a.trigger("actionclick")}c.preventDefault()});return jQuery("<li class='check-list-group-actions'></li>").append(a)},formatSuggestions:function(d,e){var f=AJS.SuggestHelper.removeDuplicates(this.model.getDisplayableSelectedDescriptors());var c=new AJS.GroupDescriptor({styleClass:"selected-group",items:f});d.splice(0,0,c);var a=_.find(d,function(g){return g.items().length});if(a){a.actionBarHtml(this.createActionBar(this.options.actionBar))}if(e.length>0){d=AJS.SuggestHelper.removeDuplicates(d);var b=AJS.SuggestHelper.extractItems(d).sort(function(h,g){h=h.label().toLowerCase();g=g.label().toLowerCase();return h.localeCompare(g)});d=[new AJS.GroupDescriptor({items:b})]}return d}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-table', location = 'content/templates/splitview.soy' */
// This file was automatically generated from splitview.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.SplitView == 'undefined') { JIRA.Templates.SplitView = {}; }


JIRA.Templates.SplitView.fullSplitView = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-group split-view"><div class="aui-item list-results-panel"><div class="list-panel"><div class="list-ordering"></div><div class="list-content">');
  if (opt_data.issuePanelData) {
    JIRA.Templates.SplitView.issueList(opt_data.issuePanelData, output);
  }
  output.append('</div></div><div class="end-of-stable-message"></div><div class="aui-group pagination-view count-pagination"><a href="#" class="refresh-table" title="', soy.$$escapeHtml("Refresh results"), '">', soy.$$escapeHtml("Refresh"), '</a><div class="pagination">');
  if (opt_data.pagination) {
    JIRA.Templates.IssueNavTable.pagination(opt_data.pagination, output);
  }
  output.append('</div></div></div><div class="aui-item detail-panel navigator-issue-only"><div></div></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.SplitView.structure = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.SplitView.fullSplitView({issuePanelData: null, pagination: null}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.SplitView.issueList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ol class="issue-list">');
  var iLimit22 = opt_data.issues.length;
  for (var i22 = 0; i22 < iLimit22; i22++) {
    var issue__soy23 = opt_data.issues[i22];
    var issueID__soy24 = opt_data.issueIDs[i22];
    var isHighlighted__soy25 = issueID__soy24 == opt_data.highlightedID;
    if (issue__soy23) {
      output.append('<li ', (isHighlighted__soy25) ? 'class="focused"' : '', ' data-id="', soy.$$escapeHtml(issueID__soy24), '" data-key="', soy.$$escapeHtml(issue__soy23.key), '" title="', soy.$$escapeHtml(issue__soy23.summary), '">');
      JIRA.Templates.SplitView.issueRow(issue__soy23, output);
      output.append('</li>');
    } else {
      JIRA.Templates.SplitView.inaccessibleIssueRow({isHighlighted: isHighlighted__soy25, issueID: issueID__soy24}, output);
    }
  }
  output.append('</ol>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.SplitView.orderBy = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.sortBy) ? '<a class="order-by ' + ((opt_data.sortBy.order == 'ASC') ? 'ascending' : 'descending') + '" data-field-id="' + soy.$$escapeHtml(opt_data.sortBy.fieldId) + '" data-direction="' + soy.$$escapeHtml(opt_data.sortBy.order) + '" href="#" title="' + soy.$$escapeHtml(AJS.format("Order by {0}",opt_data.sortBy.fieldName)) + '"><span>' + soy.$$escapeHtml(AJS.format("Order by {0}",opt_data.sortBy.fieldName)) + '</span></a>' : '<a class="order-by" title="' + soy.$$escapeHtml("Order by") + '"><span>' + soy.$$escapeHtml("Order by") + '</span></a>', '<a class="order-options" title="', soy.$$escapeHtml("Order options"), '">', soy.$$escapeHtml("Order options"), '</a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.SplitView.orderByOptions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<select id="order-by-options" multiple="multiple" class="hidden"><optgroup data-footer-text="', soy.$$escapeHtml(opt_data.footer), '">');
  var optionList79 = opt_data.options;
  var optionListLen79 = optionList79.length;
  for (var optionIndex79 = 0; optionIndex79 < optionListLen79; optionIndex79++) {
    var optionData79 = optionList79[optionIndex79];
    output.append('<option title="', soy.$$escapeHtml(optionData79.fieldName), '" value="', soy.$$escapeHtml(optionData79.fieldId), '" data-meta="', soy.$$escapeHtml(optionData79.meta), '">', soy.$$escapeHtml(optionData79.fieldName), '</option>');
  }
  output.append('</optgroup></select>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.SplitView.issueRow = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<img height="16" width="16" alt="', soy.$$escapeHtml(opt_data.type.name), '" title="', soy.$$escapeHtml(opt_data.type.name), ' - ', soy.$$escapeHtml(opt_data.type.description), '" src="', soy.$$escapeHtml(opt_data.type.iconUrl), '" /><a class="splitview-issue-link issue-link-key" data-issue-key="', soy.$$escapeHtml(opt_data.key), '" href="', soy.$$escapeHtml(""), '/browse/', soy.$$escapeHtml(opt_data.key), '"> ', soy.$$escapeHtml(opt_data.key), ' </a><a class="splitview-issue-link issue-link-summary" data-issue-key="', soy.$$escapeHtml(opt_data.key), '" href="', soy.$$escapeHtml(""), '/browse/', soy.$$escapeHtml(opt_data.key), '"> ', soy.$$escapeHtml(opt_data.summary), ' </a><div class="aui-group"><div class="aui-item"><span>', soy.$$escapeHtml(opt_data.status), '</span></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.SplitView.inaccessibleIssueRow = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="inaccessible-issue ', (opt_data.isHighlighted) ? 'focused' : '', '" data-id="', soy.$$escapeHtml(opt_data.issueID), '">', soy.$$escapeHtml("This issue can no longer be opened"), '</li>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.SplitView.issueDetailsNoSelection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-table', location = 'content/templates/issuenav-table.soy' */
// This file was automatically generated from issuenav-table.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNavTable == 'undefined') { JIRA.Templates.IssueNavTable = {}; }


JIRA.Templates.IssueNavTable.noResults = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="jira-adbox jira-adbox-medium no-results ', soy.$$escapeHtml(opt_data.cssClass), '"><h3>', opt_data.message, '</h3>', (opt_data.hint) ? '<p class="no-results-hint">' + opt_data.hint + '</p>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.resultsCount = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.IssueNavTable.resultsCountHelper({start: '<span class="results-count-start">' + soy.$$escapeHtml(opt_data.start) + '</span>', end: '<span class="results-count-end">' + soy.$$escapeHtml(opt_data.end) + '</span>', total: '<span class="results-count-total results-count-link">' + soy.$$escapeHtml(opt_data.total) + '</span>'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.TopResultsCountBar = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="issue-table-info-bar"><div class="results-count"></div><div class="column-picker-trigger-container"></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.resultsCountHelper = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="results-count aui-item"><span class="results-count-text">', AJS.format("{0}\x26ndash;{1} of {2}",opt_data.start,opt_data.end,opt_data.total), '</span><a href="#" class="refresh-table" title="', soy.$$escapeHtml("Refresh results"), '">', soy.$$escapeHtml("Refresh"), '</a></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.listOptions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-list">');
  var groupList43 = opt_data.groups;
  var groupListLen43 = groupList43.length;
  for (var groupIndex43 = 0; groupIndex43 < groupListLen43; groupIndex43++) {
    var groupData43 = groupList43[groupIndex43];
    output.append((groupData43.label) ? '<h5>' + soy.$$escapeHtml(groupData43.label) + '</h5>' : '', '<ul ', (groupData43.id) ? 'id="' + soy.$$escapeHtml(groupData43.id) + '"' : '', ' class="aui-list-section', (groupIndex43 == 0) ? ' aui-first' : '', (groupIndex43 == groupListLen43 - 1) ? ' aui-last' : '', '">');
    var itemList63 = groupData43.items;
    var itemListLen63 = itemList63.length;
    for (var itemIndex63 = 0; itemIndex63 < itemListLen63; itemIndex63++) {
      var itemData63 = itemList63[itemIndex63];
      output.append('<li class="aui-list-item"><a class="aui-list-item-link" ', (itemData63.id) ? 'id="' + soy.$$escapeHtml(itemData63.id) + '"' : '', ' ', (itemData63.rel) ? 'rel="' + soy.$$escapeHtml(itemData63.rel) + '"' : '', ' href="', (! itemData63.relativeLink) ? soy.$$escapeHtml("") : '', soy.$$escapeHtml(itemData63.link), '" ', (itemData63.title) ? 'title="' + soy.$$escapeHtml(itemData63.title) + '"' : '', '>', soy.$$escapeHtml(itemData63.label), '</a></li>');
    }
    output.append('</ul>');
  }
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.views = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.sections.issue && opt_data.sections.issue.length > 0) {
    output.append('<div class="issue-panel aui-dropdown2-section">');
    JIRA.Templates.IssueNavTable.listOptions({groups: opt_data.sections.issue}, output);
    output.append('</div>');
  }
  if (opt_data.sections.filter && opt_data.sections.filter.length > 0) {
    output.append('<div class="filter-panel aui-dropdown2-section">');
    JIRA.Templates.IssueNavTable.listOptions({groups: opt_data.sections.filter}, output);
    output.append('</div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.tools = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.IssueNavTable.listOptions(opt_data, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.endOfStableMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<p>', soy.$$escapeHtml("Too many search results to display. Refine your search criteria and try again."), '</p>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.inaccessibleIssueRow = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<tr class="issuerow inaccessible-issue" rel="', soy.$$escapeHtml(opt_data.issueID), '"><td class="nav" colspan="', soy.$$escapeHtml(opt_data.columnCount), '">', soy.$$escapeHtml("This issue can no longer be opened"), '</td></tr>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-table', location = 'content/templates/issuenav-pagination.soy' */
// This file was automatically generated from issuenav-pagination.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNavTable == 'undefined') { JIRA.Templates.IssueNavTable = {}; }


JIRA.Templates.IssueNavTable.pagination = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="pagination aui-item" data-displayable-total="', soy.$$escapeHtml(opt_data.displayableTotal), '">');
  var MAX_PAGES_DISPLAYED__soy6 = 5;
  var lastPage__soy7 = Math.floor((opt_data.displayableTotal - 1) / opt_data.pageSize);
  var pageNumber__soy8 = Math.floor(opt_data.startIndex / opt_data.pageSize);
  var urlFragment__soy9 = new soy.StringBuilder(soy.$$escapeHtml(""), '/', opt_data.searchQuery, '&startIndex=');
  urlFragment__soy9 = urlFragment__soy9.toString();
  var prevStartIndex__soy15 = opt_data.startIndex - opt_data.pageSize;
  output.append((prevStartIndex__soy15 >= 0) ? '<a href="' + soy.$$escapeHtml(urlFragment__soy9) + soy.$$escapeHtml(prevStartIndex__soy15) + '" data-start-index="' + soy.$$escapeHtml(prevStartIndex__soy15) + '" class="icon icon-previous" title="' + soy.$$escapeHtml(AJS.format("Go to page {0} of {1}",pageNumber__soy8,lastPage__soy7 + 1)) + '"><span>&lt;&lt; ' + soy.$$escapeHtml("Previous") + '</span></a>' : '');
  JIRA.Templates.IssueNavTable.numberLinksLogicBranch({startPage: pageNumber__soy8 - Math.floor(MAX_PAGES_DISPLAYED__soy6 / 2), endPage: pageNumber__soy8 + Math.floor(MAX_PAGES_DISPLAYED__soy6 / 2), lastPage: lastPage__soy7, urlFragment: urlFragment__soy9, currentPage: pageNumber__soy8 + 1, maxPagesDisplayed: MAX_PAGES_DISPLAYED__soy6, pageSize: opt_data.pageSize, displayableTotal: opt_data.displayableTotal}, output);
  var nextStartIndex__soy37 = Math.min(opt_data.startIndex + opt_data.pageSize, opt_data.displayableTotal);
  output.append((nextStartIndex__soy37 < opt_data.displayableTotal) ? '<a href="' + soy.$$escapeHtml(urlFragment__soy9) + soy.$$escapeHtml(nextStartIndex__soy37) + '" data-start-index="' + soy.$$escapeHtml(nextStartIndex__soy37) + '" class="icon icon-next" title="' + soy.$$escapeHtml(AJS.format("Go to page {0} of {1}",pageNumber__soy8 + 2,lastPage__soy7 + 1)) + '"><span>' + soy.$$escapeHtml("Next") + ' &gt;&gt;</span></a>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.numberLinksLogicBranch = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.lastPage < opt_data.maxPagesDisplayed) {
    JIRA.Templates.IssueNavTable.numberLinks(soy.$$augmentData(opt_data, {startPage: 0, endPage: opt_data.lastPage}), output);
  } else {
    if (opt_data.startPage < 0) {
      JIRA.Templates.IssueNavTable.numberLinks(soy.$$augmentData(opt_data, {startPage: 0, endPage: opt_data.endPage - opt_data.startPage}), output);
    } else if (opt_data.endPage > opt_data.lastPage) {
      JIRA.Templates.IssueNavTable.numberLinks(soy.$$augmentData(opt_data, {startPage: opt_data.startPage - (opt_data.endPage - opt_data.lastPage), endPage: opt_data.lastPage}), output);
    } else {
      JIRA.Templates.IssueNavTable.numberLinks(opt_data, output);
    }
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.numberLinks = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var size__soy72 = opt_data.endPage - opt_data.startPage + 1;
  if (size__soy72 > 1) {
    var iLimit75 = Math.round(size__soy72);
    for (var i75 = 0; i75 < iLimit75; i75++) {
      var pageIndex__soy76 = i75 + opt_data.startPage;
      var pageNumber__soy77 = pageIndex__soy76 + 1;
      var pageStartIndex__soy78 = pageIndex__soy76 * opt_data.pageSize;
      var pageEndIndex__soy79 = Math.min(pageStartIndex__soy78 + opt_data.pageSize, opt_data.displayableTotal);
      var pageBoundaries__soy80 = new soy.StringBuilder(soy.$$escapeHtml(AJS.format("Issues {0} - {1}",pageStartIndex__soy78 + 1,pageEndIndex__soy79)));
      pageBoundaries__soy80 = pageBoundaries__soy80.toString();
      output.append(' ', (pageNumber__soy77 == opt_data.currentPage) ? '<strong title="' + soy.$$escapeHtml(pageBoundaries__soy80) + '">' + soy.$$escapeHtml(pageNumber__soy77) + '</strong>' : '<a href="' + soy.$$escapeHtml(opt_data.urlFragment) + soy.$$escapeHtml(pageStartIndex__soy78) + '" data-start-index="' + soy.$$escapeHtml(pageStartIndex__soy78) + '" title="' + soy.$$escapeHtml(pageBoundaries__soy80) + '">' + soy.$$escapeHtml(pageNumber__soy77) + '</a>');
    }
  }
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-table', location = 'content/js/components/table/ColumnPicker.js' */
JIRA.Issues.ColumnPicker=JIRA.Components.ColumnPicker.extend({initialize:function(a,b){var c=[this._getUserColumnProvider(),this._getFilterColumnProvider()];if(JIRA.isAdmin()){c.push(this._getSystemColumnProvider())}JIRA.Components.ColumnPicker.prototype.initialize.call(this,null,{providers:c});this.search=b.search;this.search.on("change:filter",function(){var d=this.filterColumn;var f=d.isEditDisabled();var e=d.isDisabled();d.trigger("change:isDisabled",d,e);d.trigger("change:editDisabled",d,e||f)},this)},isSystemMode:function(){return this.columnPickerModel.getColumnConfig()==="system"},sanitizeColumnConfig:function(a){a=a.toLowerCase();var b=a=="system"&&!this.isSystemMode();return b?"user":a},syncColumns:function(a,b){a=this.sanitizeColumnConfig(a);return JIRA.Components.ColumnPicker.prototype.syncColumns.call(this,a,b)},clearFilterConfiguration:function(){this.filterColumn.unset("columns");this.filterColumn.unset("savedColumns")},setCurrentColumnConfig:function(a){a=this.sanitizeColumnConfig(a);return JIRA.Components.ColumnPicker.prototype.setCurrentColumnConfig.call(this,a)},_getFilterColumnProvider:function(){var a=this;return this.filterColumn=JIRA.Issues.ColumnConfigModel.create("filter","Filter",{url:function(){return AJS.contextPath()+"/rest/api/2/filter/"+a.search.getState().filter+"/columns"},isDisabled:function(){return !a.search.getFilter()||a.search.getFilter().getIsSystem()},isEditDisabled:function(){return !a.search.filterModule.canEditColumns()},shouldRefreshSearchOnActivation:function(){return this.has("savedColumns")},shouldCloseOnActivation:function(){return this.has("savedColumns")},shouldLoadDefaultsOnActivation:function(){return !this.has("savedColumns")},defaultColumns:_.bind(function(){if(this.userColumns.has("columns")){var b=jQuery.Deferred();b.resolve(_.map(this.userColumns.getColumns(),function(c){return{value:c}}));return b.promise()}else{return jQuery.ajax(this.userColumns.url()).promise()}},this)})},_getSystemColumnProvider:function(){return JIRA.Issues.ColumnConfigModel.create("system","System",{url:_.lambda(AJS.contextPath()+"/rest/api/2/settings/columns"),defaultColumns:function(){return jQuery.ajax(this.url()).promise()},shouldRefreshSearchOnActivation:function(){return true},shouldCloseOnActivation:function(){return false},shouldLoadDefaultsOnActivation:function(){return true},shouldRevertOnHide:function(){return false}})},_getUserColumnProvider:function(){this.userColumns=JIRA.Issues.ColumnConfigModel.create("user","My Defaults",{url:_.lambda(AJS.contextPath()+"/rest/api/2/user/columns")});return this.userColumns}});JIRA.Issues.ColumnPicker.create=function(a){return new JIRA.Issues.ColumnPicker(null,a)};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-table', location = 'content/js/components/table/IssueSearchManager.js' */
Backbone.define("JIRA.Issues.IssueSearchManager",JIRA.Issues.BaseEvented.extend({namedEvents:["beforeSearch","searchError"],initialize:function(a){_.extend(this,a);this.issueKeys=new JIRA.Issues.AsyncData()},hasInitialSearch:function(){return !!this.initialIssueTableState},search:function(c){var b,a;c=_.defaults({},c,{startIndex:0});if(this.activeResultsReq){if(JSON.stringify(this.activeRequestData)===JSON.stringify(c)){return jQuery.Deferred().reject().promise()}else{this.activeResultsReq.abort()}}this.activeRequestData=c;this.triggerBeforeSearch();if(this.hasInitialSearch()){b=jQuery.Deferred().resolve(this.initialIssueTableState);a="jira.search.finished.initial";this.initialIssueTableState=null;this.initialIssueIds=null}else{b=this.activeResultsReq=this._doSearch(c);a="jira.search.finished.secondary"}b.always(_.bind(function(){this.activeResultsReq=null;this.activeRequestData=null;JIRA.trace(a)},this));b.done(_.bind(this._updateIssueKeysOnSearchSuccess,this));b.fail(_.bind(function(){this.issueKeys.reset();this.triggerSearchError();_.defer(JIRA.trace,"jira.search.finished")},this));return b.pipe(function(d){if(d.issueTable){delete d.issueTable.issueKeys}return d}).promise()},_doSearch:function(c){var b=/^-?\d+$/;if(c.filterId&&!b.test(c.filterId)){var a={status:400,responseText:JSON.stringify({errors:[AJS.format("Invalid filter id \'\'{0}\'\'. Filter id must be a number.",c.filterId)]})};return jQuery.Deferred().reject(a).promise()}return jQuery.ajax({type:"POST",url:AJS.contextPath()+"/rest/issueNav/1/issueTable",headers:JIRA.Issues.XsrfTokenHeader,data:_.extend(c,{layoutKey:JIRA.Issues.LayoutPreferenceManager.getPreferredLayoutKey()})})},_updateIssueKeysOnSearchSuccess:function(a){var c=a.issueTable.issueIds;var b=a.issueTable.issueKeys;if(c&&b){var d={};_.each(c,function(f,e){d[f]={value:b[e],error:false}});this.issueKeys.reset(d)}else{var d=JIRA.Issues.IssueSearchManager._extractIssueKeysFromTable(a.issueTable.table);this.issueKeys.reset(d)}},getRowsForIds:function(b,a){if(!b.length){return jQuery.Deferred().resolve({}).promise()}var c=jQuery.ajax({data:_.extend({id:b,layoutKey:JIRA.Issues.LayoutPreferenceManager.getPreferredLayoutKey()},a),type:"POST",headers:JIRA.Issues.XsrfTokenHeader,url:AJS.contextPath()+"/rest/issueNav/1/issueTable/stable"});c.fail(_.bind(function(){this.triggerSearchError()},this));return c.pipe(function(d){return d.issueTable}).done(_.bind(function(d){this.issueKeys.setMultiple(JIRA.Issues.IssueSearchManager._extractIssueKeysFromTable(d.table,b));_.defer(JIRA.trace,"jira.search.finished")},this)).promise()},setAsInaccessible:function(a){return this.issueKeys.setError(a)}},{_extractIssueKeysFromTable:function(a,b){var c={};AJS.$(a).find(".issuerow").each(function(f){var d=AJS.$(this);var g=b?b[f]:d.attr("rel");var e=d.data("issuekey")||null;if(g){c[g]=e?{value:e,error:false}:{error:true}}});return c}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-table', location = 'content/js/components/table/IssueTableDecorator.js' */
(function(a){AJS.namespace("JIRA.Issues.IssueTableDecorator",window,{decorate:function(d){var c=d.$table;var b=d.issueIDs;var e=d.sortByField;var f=d.sortByOrder;this._decorateTableWithWrap(c);this._decorateTableResultsWithClasses(c);this._decorateTableWithIssueIDs(c,b);this._decorateTableHeaderWithSortOptions(c,e,f);if(this._isIE9()){this._removeEmptyTextNodes(c)}return c},_isIE9:function(){return(a.browser.msie&&parseInt(a.browser.version,10)===9)},_decorateTableWithWrap:function(b){b.find("#issuetable").wrap('<div class="issue-table-container"/>')},_decorateTableResultsWithClasses:function(b){b.children().addClass("navigator-results")},_decorateTableWithIssueIDs:function(c,b){c.find(".issuerow").attr("rel",function(d){return b[d]})},_decorateTableHeaderWithSortOptions:function(d,c,b){d.find(".sortable").each(function(){this.onclick=null});if(c){var g=d.find(".rowHeader .sortable").filter('[data-id="'+c+'"]');if(g.size()&&!g.hasClass("descending")&&!g.hasClass("ascending")){var e=d.find(".rowHeader .sortable");e.filter(".descending").removeClass("descending active").addClass("colHeaderLink");e.filter(".ascending").removeClass("ascending active").addClass("colHeaderLink");var f=b=="DESC"?"descending":"ascending";g.removeClass("colHeaderLink").addClass("active "+f)}}},_removeEmptyTextNodes:function(b){b.find("table, tbody, thead, tr").contents().filter(function(){return this.nodeType===3}).remove()}})})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-table', location = 'content/js/components/table/IssueTableView.js' */
(function(a){Backbone.define("JIRA.Issues.IssueTableView",JIRA.Issues.BaseView.extend({events:{"blur .hidden-link":"_onHiddenLinkBlur","click .sortable":"_onSort","click tr.issuerow":"_onClickRow"},inaccessibleIssueRowTemplate:JIRA.Templates.IssueNavTable.inaccessibleIssueRow,syncSystemModeMessage:function(){var c=a("#system-mode-warning-msg");var d=this.columnConfig.isSystemMode();if(d&&!c.length){var b=JIRA.Messages.showWarningMsg("You are on System Mode. The column changes might affect all users. \u003ca href=# class=exit>Exit System Mode\u003c\/a>.",{id:"system-mode-warning-msg",closeable:false,timeout:0});b.find(".exit").click(_.bind(function(f){f.preventDefault();this.columnConfig.setCurrentColumnConfig("user")},this))}else{c.remove()}},initialize:function(b){this.search=b.search;this.searchPromise=this._createSearchPromise({done:this._onSearchDone,fail:this._onSearchFail});this.columnConfig=b.columnConfig;this.searchResults=b.searchResults;this.addListener(this.searchResults,"issueDeleted",this.handleIssueDeleted,this);this.addListener(this.searchResults,"issueUpdated",this.handleIssueUpdated,this);this.addListener(this.searchResults,"highlightedIssueChange",this.focusHighlightedIssue,this);this.addListener(this.searchResults,"newPayload",this.renderNewSearch,this);this.addListener(this.searchResults,"startIndexChange",this.renderNewSearch,this);this.addListener(this.searchResults,"stableUpdate",this.renderNewSearch,this);this.emptyResultsView=new JIRA.Issues.EmptyResultsView({searchResults:this.searchResults,el:this.$el});this.columnConfig.on("change:columnConfig",this.syncSystemModeMessage,this);this.lastRenderedState={requestId:null,startIndex:null};this.topResultsCountView=new JIRA.Issues.ResultsCountView({model:this.searchResults,search:this.search});this.paginationView=new JIRA.Issues.ResultsCountView({el:this.$(".count-pagination"),model:this.searchResults,search:this.search});this.paginationView.setEndOfStableSearchMessage(this.$(".end-of-stable-message"));JIRA.Issues.onVerticalResize(_.bind(this.adjustColumnConfigHeight,this))},deactivate:function(){this.searchPromise.reset();this.paginationView.deactivate();JIRA.Issues.offVerticalResize(this.adjustColumnConfigHeight);JIRA.Issues.BaseView.prototype.deactivate.apply(this,arguments)},getIssueRowById:function(c,b){b=b?jQuery(b):this.$el;return b.find("#issuerow"+c)},handleIssueDeleted:function(b){this.getIssueRowById(b.id).hide();this._showPending();this.render({force:true})},handleIssueInaccessible:function(b){this.getIssueRowById(b).replaceWith(this.inaccessibleIssueRowTemplate({columnCount:this.$el.find("thead > tr > th").length,issueID:b}))},handleIssueUpdated:function(d,b){var c=this.getIssueRowById(d,b.table);this.getIssueRowById(d).replaceWith(c);JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[c,JIRA.CONTENT_ADDED_REASON.issueTableRowRefreshed]);this.focusIssue(d);JIRA.trace("jira.search.finished")},show:function(){this.focusHighlightedIssue()},_onSort:function(b){b.preventDefault();if(!this._isPending()){this._killDragtable();this.search.doSort({fieldId:a(b.currentTarget).data("id")})}},selectNext:function(){var b=this.getSelectedRow().next();if(b.length===1&&b.hasClass("issuerow")){this.selectInModel(b)}else{this.searchResults.nextPage().done(_.bind(function(){this.selectInModel(this.$(".issuerow:first"));jQuery(window).scrollTop(0)},this))}},selectPrev:function(){var b=this.getSelectedRow().prev();if(b.length===1&&b.hasClass("issuerow")){this.selectInModel(b)}else{this.searchResults.previousPage().done(_.bind(function(){this.selectInModel(this.$(".issuerow:last"))},this))}},getSelectedRow:function(){return this.$(".issuerow").eq(this.searchResults.getSelectedIssueIndex())},selectIssueById:function(c){var b=this.$(".issuerow[rel='"+c+"']");if(b.length){this.selectInModel(b)}else{this.searchResults.clearSelectedIssue()}},focusHighlightedIssue:function(){var b=this.searchResults.getHighlightedIssue();b&&this.focusIssue(b.getId(),true)},focusIssue:function(e,d){var c=this.$(".issuerow.focused"),b;if(e!=null){c.removeClass("focused");b=this.$(".issuerow[rel='"+e+"']");b.addClass("focused");this._postFocusRenderActions(b,d)}},_postFocusRenderActions:function(b,c){if(b.is(":visible")){_.defer(function(){b.scrollIntoView({marginBottom:50});if(!c){b.find(".hidden-link").removeAttr("tabIndex").focus()}})}},render:function(c){c=_.defaults({},c,{force:false});if(this._updateLastRenderedState()||c.force){var b=this.getFilterId();return this.searchPromise.add(this.searchResults.getResultsForPage({jql:this.search.getEffectiveJql(),filterId:b}))}else{return jQuery.Deferred().resolve().promise()}},renderNewSearch:function(b){if(this._updateLastRenderedState()||b.force){this._killDragtable();this._showPending();this.searchPromise.add(this.searchResults.getResultsForPage({jql:this.search.getEffectiveJql(),filterId:this.getFilterId(),columnConfig:b.columnConfig}))}},_postRenderActions:function(){var c=this.$el;var b=this;_.defer(_.bind(function(){jQuery("#issuetable").dragtable({maxMovingRows:1,containment:"body",axis:false,revert:false,clickDelay:250,tolerance:"intersect",dragaccept:":not(.headerrow-actions)",persistState:_.bind(function(d){var e=[];d.el.find("th").each(function(f){var g=jQuery(this).data("id");if(_.isNotBlank(g)){e.push(g)}});this.columnConfig.saveColumns(e)},this)});this._triggerTableUpdatedEvent()},this))},_triggerTableUpdatedEvent:function(){JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.issueTableRefreshed])},_handleRowSelection:function(){if(this.searchResults.initialSelectedIssueId){this.selectIssueById(this.searchResults.initialSelectedIssueId);this.searchResults.initialSelectedIssueId=null}},_handleError:function(){this._hidePending()},_handleAndRenderError:function(b){this._handleError();JIRA.Messages.showMessageAtTarget(b,{closeable:true,target:this.$el.empty(),type:JIRA.Templates.Issues.Util.errorMessage})},_onClickRow:function(c){var b=a(c.target).closest("tr.issuerow");if(b.length){this.searchResults.highlightIssueById(b.attr("rel"),{preventFocus:true})}},_onHiddenLinkBlur:function(b){a(b.target).attr("tabIndex",-1)},_createSearchPromise:function(b){var c=jQuery.RecurringPromise();b=b||{};b.done&&c.done(_.bind(b.done,this));b.fail&&c.fail(_.bind(b.fail,this));return c},_onSearchDone:function(c){var c=a(c),b=a("<div/>").addClass("list-view").append(JIRA.Templates.IssueNavTable.TopResultsCountBar()).append(c);this.topResultsCountView.setElement(b.find(".issue-table-info-bar"));if(!this.searchResults.hasIssues()){this.emptyResultsView.render()}else{this.topResultsCountView.render();if(c.length>0){var d=this.searchResults.getSortBy()||{};this.$el.empty().append(JIRA.Issues.IssueTableDecorator.decorate({$table:b,issueIDs:this.searchResults.getPageIssueIds(),sortByField:d.fieldId,sortByOrder:d.order}))}this.paginationView.setElement(this.$(".count-pagination"));this.paginationView.setEndOfStableSearchMessage(this.$(".end-of-stable-message"));this.paginationView.render();this.columnConfig.setElement(this.$(".column-picker-trigger-container")).render();if(!this.searchResults.hasHighlightedIssue()){this.searchResults.highlightFirstInPage()}this.focusHighlightedIssue()}this._hidePending();this._postRenderActions();JIRA.trace("jira.search.stable.update")},adjustColumnConfigHeight:function(){this.columnConfig.adjustHeight()},_onSearchFail:function(){this.$el.removeClass("pending");this.emptyResultsView.render()},_updateLastRenderedState:function(){var c,b=this.lastRenderedState;c=this.lastRenderedState={resultsId:this.searchResults.getResultsId(),startIndex:this.searchResults.getStartIndex()};return !_.isEqual(b,c)},_isPending:function(){return this.$el.hasClass("pending")},_hidePending:function(){this.$el.removeClass("pending empty-results")},_showPending:function(){this.$el.addClass("pending")},_killDragtable:function(){jQuery("#issuetable").dragtable("destroy")},isSystemFilter:function(){return this.search.getFilterId()<0},getFilterId:function(){var b=this.search.getFilterId();return(this.isSystemFilter()||_.isNull(b))?undefined:b}}))})(jQuery);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-table', location = 'content/js/components/table/HeaderOperationsView.js' */
JIRA.Issues.IssueTableHeaderOperationsView=JIRA.Issues.BaseView.extend({initialize:function(a){_.bindAll(this);_.extend(this,a);this.initTools();this.initViews();this.initShare();this._results=this.search.getResults();this._results.onNewPayload(this._onSearchSuccess)},initViews:function(){var a=this.searchPageModule;a.on("change",this._updateFilterPageResources);this._updateFilterPageResources();new JIRA.Issues.Tipsy({el:this.$el.find(".header-views"),showCondition:":not(.active)"});var b=this._spinnerTimeoutKeeper(".header-views");AJS.Dropdown.create({styleClass:"header-views-menu aui-style-default",trigger:AJS.$(".header-views",this.$el),ajaxOptions:function(){var d={jql:a.getEffectiveJql()},c=a.getFilter();if(c&&!c.getIsSystem()){d.filterId=c.getId();if(a.isDirty()){d.jql=a.getJql();d.modified=true}}b.start();return{url:contextPath+"/rest/issueNav/1/issueNav/operations/views",type:"POST",headers:JIRA.Issues.XsrfTokenHeader,data:d,dataType:"json",cache:false,formatSuccess:function(e){b.end();return AJS.$(JIRA.Templates.IssueNavTable.views({sections:e,contextPath:contextPath}))}}}})},initTools:function(){var a=this,b=this.searchPageModule;AJS.$("body").delegate("#use-cols","click",function(d){d.preventDefault();a.searchPageModule.columnConfig.setCurrentColumnConfig("user");a.searchPageModule.columnConfig.refreshSearchWithColumns()});AJS.$("body").delegate("#use-filter-cols","click",function(d){d.preventDefault();a.searchPageModule.columnConfig.setCurrentColumnConfig("filter");a.searchPageModule.columnConfig.refreshSearchWithColumns()});new JIRA.Issues.Tipsy({el:this.$el.find(".header-tools"),showCondition:":not(.active)",tipsy:{gravity:"ne"}});var c=this._spinnerTimeoutKeeper(".header-tools");AJS.Dropdown.create({styleClass:"header-tools-menu",trigger:AJS.$(".header-tools",a.$el),ajaxOptions:function(){var e,d=b.getFilter();e={jql:b.getEffectiveJql(),searchResultsTotal:a._results.getDisplayableTotal(),searchResultsPages:a._results.getNumberOfPages(),useColumns:a.searchPageModule.columnConfig.getCurrentColumnConfig().getName()!="user",skipColumns:b.getActiveLayout().id==="split-view"};if(d&&!d.getIsSystem()){e.filterId=d.getId();if(b.isDirty()){e.jql=b.getJql()}}c.start();return{url:contextPath+"/rest/issueNav/1/issueNav/operations/tools",type:"POST",headers:JIRA.Issues.XsrfTokenHeader,data:e,dataType:"json",cache:false,formatSuccess:function(f){c.end();if(f&&f.length==0){return AJS.$('<div class="menu-empty-content"></span>'+"No Available Option(s)"+"<div>")}else{return AJS.$(JIRA.Templates.IssueNavTable.tools({groups:f,contextPath:contextPath}))}}}}})},initShare:function(){new JIRA.Issues.Tipsy({el:this.$el.find(".issuenav-share"),showCondition:":not(.active)"})},_onSearchSuccess:function(){AJS.$(".header-tools").toggle(this.search.getResults().getDisplayableTotal()>0)},_updateFilterPageResources:function(){var d=this.$el.find(".operations-view-data > fieldset"),b=this.searchPageModule;d.empty();if(b.getFilter()&&!b.isDirty()){AJS.$('<input type="hidden" id="filterId" />').val(b.getFilter().getId()).appendTo(d);AJS.$('<input type="hidden" id="jql" />').val("").appendTo(d)}else{AJS.$('<input type="hidden" id="filterId" />').val("");AJS.$('<input type="hidden" id="jql" />').val(b.getJql()).appendTo(d)}var c=b.getFilter(),a=c&&c.getId();if(a&&!c.getIsSystem()&&!b.isDirty()){AJS.Meta.set("filter-id",a);AJS.Meta.set("filter-jql",undefined)}else{AJS.Meta.set("filter-id",undefined);AJS.Meta.set("filter-jql",b.getEffectiveJql())}},_spinnerTimeoutKeeper:function(a){var b=undefined;return{start:function(){if(b){b=clearTimeout(b)}b=setTimeout(function(){b=undefined;AJS.$(a).addClass("spinner")},1000)},end:function(){b=clearTimeout(b);AJS.$(a).removeClass("spinner")}}}});
/* module-key = 'jira.webresources:jqlautocomplete', location = '/includes/jira/autocomplete/JQLAutoComplete.js' */
(function(){var jql_order_by=[{value:"ORDER BY",displayName:"ORDER BY"}];var jql_operators=[{value:"=",displayName:"="},{value:"!=",displayName:"!="},{value:"~",displayName:"~"},{value:"<=",displayName:"&lt;="},{value:">=",displayName:"&gt;="},{value:">",displayName:"&gt;"},{value:"<",displayName:"&lt;"},{value:"!~",displayName:"!~"},{value:"is not",displayName:"is not"},{value:"is",displayName:"is"},{value:"not in",displayName:"not in"},{value:"in",displayName:"in"},{value:"was",displayName:"was"},{value:"was not",displayName:"was not"},{value:"was in",displayName:"was in"},{value:"was not in",displayName:"was not in"},{value:"changed",displayName:"changed"}];var jql_logical_operators=[{value:"AND",displayName:"AND"},{value:"OR",displayName:"OR"}];var jql_logical_operators_and_order_by=jql_logical_operators.concat(jql_order_by);var jql_order_by_direction=[{value:"ASC",displayName:"ASC"},{value:"DESC",displayName:"DESC"}];var empty_operand=[{value:"EMPTY",displayName:"EMPTY",types:["java.lang.Object"]}];var jql_not_logical_operator=[{value:"NOT",displayName:"NOT"}];var jql_was_predicates=[{value:"AFTER",displayName:"AFTER",type:"java.util.Date",supportsList:"false"},{value:"BEFORE",displayName:"BEFORE",type:"java.util.Date",supportsList:"false"},{value:"BY",displayName:"BY",type:"com.atlassian.crowd.embedded.api.User",supportsList:"false",auto:"true"},{value:"DURING",displayName:"DURING",type:"java.util.Date",supportsList:"true"},{value:"ON",displayName:"ON",type:"java.util.Date",supportsList:"false"}];var jql_changed_predicates=jql_was_predicates.concat([{value:"FROM",displayName:"FROM",type:"java.lang.String",supportsList:"true",auto:"true"},{value:"TO",displayName:"TO",type:"java.lang.String",supportsList:"true",auto:"true"}]);var jql_was_predicates_and_order_by=jql_was_predicates.concat(jql_logical_operators_and_order_by);var jql_was_predicates_and_logical_operators=jql_was_predicates.concat(jql_logical_operators);var jql_changed_predicates_and_order_by=jql_changed_predicates.concat(jql_logical_operators_and_order_by);var jql_changed_predicates_and_logical_operators=jql_changed_predicates.concat(jql_logical_operators);var REGEXP_ANDS=/^AND\s/i;var REGEXP_ORS=/^OR\s/i;var REGEXP_NOTS=/^NOT\s/i;var REGEXP_SNOT=/^\s+not/i;var REGEXP_SIN=/^\s+in/i;var REGEXP_SNOT_IN=/^\s+(not\s+in|not|in)/i;var REGEXP_COMMA_DELIMITER=/^\s*,/;var REGEXP_ASCENDING=/^\s+asc/i;var REGEXP_DESCENDING=/^\s+desc/i;var REGEXP_ORDER_BY=/^order\s+by/i;var REGEXP_WHITESPACE=/^\s/;var REGEXP_UNICODE=/^u[a-fA-F0-9]{4}/;var REGEXP_FIELD_NAME=/^\s-\scf\[\d\d\d\d\d\]/;var REGEXP_NEW_LINE=/[\r\n]/;var REGEXP_NUMBER=/\d/;var REGEXP_TOKEN_CHAR=/[^=!~<>(),\s&|]/;var REGEXP_SPECIAL_CHAR=/[{}*\/%+$#@?.;\][]/;var REGEXP_SPACE_OR_ELSE=/[\s(]/;var REGEXP_CHARS_TO_ESCAPE=/[^trn"'\\\s]/;var REGEXP_NOTSTART=/^NO?$/i;var REGEXP_INSTART=/^IN?$/i;var REGEXP_PREDICATE=/^(after|before|by|during|from|on|to)/i;JIRA.JQLAutoComplete=function(options){var that=begetObject(JIRA.AutoComplete);var parser=options.parser;var result;var jql_field_names=jQuery.grep(options.jqlFieldNames,function(arrValue){return arrValue.searchable});var jql_order_by_field_names=jQuery.grep(options.jqlFieldNames,function(arrValue){return arrValue.orderable});var jql_function_names=options.jqlFunctionNames;var PARSE_INDICATOR=jQuery("#"+options.errorID);var suggestionCount=0;var jqlcolumnnum=jQuery("#jqlcolumnnum");var jqlrownum=jQuery("#jqlrownum");var autoCompleteUrl=options.autoCompleteUrl||contextPath+"/rest/api/1.0/jql/autocomplete";that.textToSuggestionCursorPosition=function(){return this.field.selectionRange().textBefore};that.pushSuggestionsOnHtmlStack=function(suggestions,suggestionNodes,htmlParts,listItemIdentifier,mayNeedParenthesis){var length=Math.min(15,suggestions.length);for(var i=0;i<length;i++){var actualValueSug;var displayNameSug;if(suggestions[i].value){var resultSug=suggestions[i];if(result&&mayNeedParenthesis){actualValueSug=((result.getNeedsOpenParen())?"(":"")+resultSug.value}else{actualValueSug=resultSug.value}displayNameSug=resultSug.displayName}else{displayNameSug=suggestions[i];actualValueSug=displayName}suggestionNodes.push(actualValueSug);htmlParts.push('<li id="',listItemIdentifier,i,'">',displayNameSug,"</li>")}};that.renderSuggestions=function(suggestions,moreSuggestions,operatorSuggestions){var suggestionNodes=[];if(suggestions instanceof Array){if(suggestions.length<1&&(moreSuggestions&&moreSuggestions.length<1)&&(operatorSuggestions&&operatorSuggestions.length<1)){return suggestionNodes}var htmlParts=["<ul>"];if(operatorSuggestions&&operatorSuggestions.length>0){that.pushSuggestionsOnHtmlStack(operatorSuggestions,suggestionNodes,htmlParts,"jql_operator_suggest_",false)}that.pushSuggestionsOnHtmlStack(suggestions,suggestionNodes,htmlParts,"jql_value_suggest_",true);if(moreSuggestions&&moreSuggestions.length>0){that.pushSuggestionsOnHtmlStack(moreSuggestions,suggestionNodes,htmlParts,"jql_function_suggest_",false)}htmlParts.push("</ul>");var syntaxHelpLink=AJS.$('<a class="syntax-help" target="_jiraHelp"></a>').attr("title",AJS.Meta.get("advanced-search-help-title")).attr("href",AJS.Meta.get("advanced-search-help-url")).text("Syntax Help");var syntaxHelpContainer=AJS.$('<div class="syntax-help-container">').append(syntaxHelpLink);that.responseContainer.html(htmlParts.join("")).append(syntaxHelpContainer).find("li").each(function(i){suggestionNodes[i]=[jQuery(this),suggestionNodes[i]]});that.addSuggestionControls(suggestionNodes)}return suggestionNodes};that.completeField=function(value){var start=that.getReplacementStartIndex(result,value);var end=that.getReplacementEndIndex(result,start);that.replaceValue(start,end,value);var newToken=parser.parse(this.field.val());that.updateParseIndicator(newToken)};that.prepareOperandSuggestions=function(canAutoComplete,fieldName,functionSuggestions,operatorSuggestions,suggestedValue){if(canAutoComplete){var currentSuggestionCount=suggestionCount;var fieldValue=(suggestedValue==null)?((result.getLastOperand()===null)?"":that.stripEscapeCharacters(result.getLastOperand())):suggestedValue;var fieldNameValueKey=fieldName+":"+fieldValue;var data={fieldName:that.stripEscapeCharacters(fieldName)};if(result.getLastOperand()!==null||suggestedValue!==null){data.fieldValue=fieldValue}var includeEmpty=that.isWasOperator(result.getLastOperator());if(!that.getSavedResponse(fieldNameValueKey)){that.dropdownController.dropdown.removeClass("dropdown-ready");this.delay(function(){that._makeRequest({url:autoCompleteUrl,dataType:"json",data:data,success:function(response){var results;if(response!==null&&response.results!==null){results=response.results}else{results=[]}if(includeEmpty){var suggestion=data.fieldValue;results=that.appendEmpty(suggestion,results)}that.saveResponse(fieldNameValueKey,results);that.renderSuggestionsForOperands(fieldValue,results,functionSuggestions,operatorSuggestions,currentSuggestionCount)},error:function(){that.renderSuggestionsForOperands(fieldValue,[],functionSuggestions,operatorSuggestions,currentSuggestionCount)}})},that.queryDelay)}else{that.renderSuggestionsForOperands(fieldValue,that.getSavedResponse(fieldNameValueKey),functionSuggestions,operatorSuggestions,currentSuggestionCount)}}else{that.renderSuggestionsForOperands(that.stripEscapeCharacters(result.getLastOperand()),[],functionSuggestions,operatorSuggestions,suggestionCount)}};that.preparePredicateSuggestions=function(predicateName,suggestedValue){var currentSuggestionCount=suggestionCount;if(typeof suggestedValue=="undefined"){suggestedValue=null}var functionSuggestions=that.slimListForPredicates(suggestedValue,jql_function_names,predicateName);that.boldMatchingString(suggestedValue,functionSuggestions);var predicateValue=(suggestedValue==null)?((result.getLastOperand()===null)?"":that.stripEscapeCharacters(result.getLastOperand())):suggestedValue;var predicateNameValueKey=predicateName+":"+predicateValue;var data={predicateName:that.stripEscapeCharacters(predicateName)};if(result.getLastOperand()!==null||suggestedValue!==null){data.predicateValue=predicateValue}if(result.getLastFieldName()!==null){data.fieldName=result.getLastFieldName();predicateNameValueKey=result.getLastFieldName()+":"+predicateNameValueKey}if(that.predicateSupportsAutoComplete(predicateName)){if(!that.getSavedResponse(predicateNameValueKey)){that.dropdownController.dropdown.removeClass("dropdown-ready");this.delay(function(){that._makeRequest({url:autoCompleteUrl,dataType:"json",data:data,success:function(response){var results;if(response!==null&&response.results!==null){results=response.results}else{results=[]}var suggestion=data.predicateValue;results=that.appendEmpty(suggestion,results);that.saveResponse(predicateNameValueKey,results);that.renderSuggestions(results,functionSuggestions)},error:function(){that.renderSuggestionsForOperands(predicateValue,[])}})},that.queryDelay)}else{that.renderSuggestions(that.getSavedResponse(predicateNameValueKey),functionSuggestions)}}else{that.renderSuggestions([],functionSuggestions)}};that.incompleteOperator=function(){var tokens=result.getTokens();if(tokens==null||tokens.length<2){return""}else{var tokens=that.textToSuggestionCursorPosition().split(" ");if(tokens.length>2){return tokens[tokens.length-1]}}return""};that.incompletePredicateValue=function(){var tokens=result.getTokens();if(tokens==null||tokens.length<3){return""}else{var tokens=that.textToSuggestionCursorPosition().split(/[\s(,]+/);if(tokens.length>3){return tokens[tokens.length-1]}}return""};that.appendEmpty=function(suggestion,results){var empty_list=that.slimListForMapResults(suggestion,empty_operand,true);if(suggestion!=null){that.boldMatchingString(suggestion,empty_list)}if(results.length<15){results=results.concat(empty_list)}else{results[14]=empty_list[0]}return results};that.dispatcher=function(val){var that=this;var selectionRange=jQuery(that.field).selectionRange();var parseValue=val.substring(0,selectionRange.start);result=parser.parse(parseValue).getResult();suggestionCount++;if(result.getNeedsField()){that.renderSuggestionsFromMap(that.stripEscapeCharacters(result.getLastFieldName()),jql_field_names,jql_not_logical_operator,true)}else{if(result.getNeedsOperatorOrOperand()){var operator=result.getLastOperator();var operatorLength=operator.length;var parsedOperator=(operator.length>0)?parseValue.substr(result.getLastOperatorStartIndex()):null;var functionSuggestions=(that.isEmptyOnlyOperator(result.getLastOperator()))?empty_operand:jql_function_names;var operatorSuggestions=that.getSuggestionsForOperators(parsedOperator,jql_operators);if(operatorLength>0){var numSpaces=operator.length-(operator.replace(/\s+/g,"")).length;result.setLastOperandStartIndex(result.getLastOperatorStartIndex()+operatorLength+numSpaces+1)}if(operatorSuggestions&&operatorSuggestions.length>0){var tokens=result.getTokens();var operandSuggestion=that.incompleteOperator();that.prepareOperandSuggestions(true,result.getLastFieldName(),functionSuggestions,operatorSuggestions,operandSuggestion)}}else{if(result.getNeedsOperator()){that.renderSuggestionsForOperators(result.getLastOperator(),jql_operators)}else{if(result.getNeedsPredicateOperand()){var predicate=result.getLastWasPredicate();that.preparePredicateSuggestions(predicate,that.stripEscapeCharacters(result.getLastOperand()))}else{if(result.getNeedsLogicalOperator()){if(result.getNeedsWasPredicate()){if(result.getNeedsOrderBy()){var value=(result.getLastOrderBy()===null)?result.getLastWasPredicate():result.getLastOrderBy();if(result.getLastOperator()=="was"){that.renderSuggestionsFromMap(value,jql_was_predicates_and_order_by,false)}else{that.renderSuggestionsFromMap(value,jql_changed_predicates_and_order_by,false)}}else{if(result.getLastOperator()=="was"){that.renderSuggestionsFromMap(result.getLastWasPredicate(),jql_was_predicates_and_logical_operators,false)}else{that.renderSuggestionsFromMap(result.getLastWasPredicate(),jql_changed_predicates_and_logical_operators,false)}}}else{if(result.getNeedsOrderBy()){var value=(result.getLastOrderBy()===null)?result.getLastLogicalOperator():result.getLastOrderBy();that.renderSuggestionsFromMap(value,jql_logical_operators_and_order_by,false)}else{that.renderSuggestionsFromMap(result.getLastLogicalOperator(),jql_logical_operators,false)}}}else{if(result.getNeedsOrderByField()){that.renderSuggestionsFromMap(that.stripEscapeCharacters(result.getLastOrderByFieldName()),jql_order_by_field_names,true)}else{if(result.getNeedsOrderByDirection()){that.renderSuggestionsFromMap(result.getLastOrderByDirection(),jql_order_by_direction,false)}else{if(result.getNeedsOperand()){var fieldName=result.getLastFieldName();var canAutoComplete=false;if(!that.isEmptyOnlyOperator(result.getLastOperator())){for(var i=0;i<jql_field_names.length;i++){if(that.equalsIgnoreCase(result.getUnquotedString(jql_field_names[i].value),fieldName)||(jql_field_names[i].cfid&&that.equalsIgnoreCase(jql_field_names[i].cfid,fieldName))){canAutoComplete=jql_field_names[i].auto;break}}}var functionSuggestions=(that.isEmptyOnlyOperator(result.getLastOperator()))?empty_operand:jql_function_names;that.prepareOperandSuggestions(canAutoComplete,fieldName,functionSuggestions,{})}else{if(result.getNeedsOrderBy()){that.renderSuggestionsFromMap(result.getLastOrderBy(),jql_logical_operators_and_order_by,false)}else{that.dropdownController.hideDropdown()}}}}}}}}}that.parse(val)};that.stripEscapeCharacters=function(val){if(val==null){return val}var newVal="";var strArr=val.split("");for(var i=0;i<strArr.length;i++){if(strArr[i]=="\\"){if(!REGEXP_UNICODE.test(val.substring(i,val.length))){i++;if(i>=val.length){break}}}newVal+=strArr[i]}return newVal};that.parse=function(val){var newToken=parser.parse(val);that.updateParseIndicator(newToken);that.updateColumnLineCount();return newToken.getResult()};that.renderSuggestionsFromMap=function(stringVal,list,otherSuggestions,showFull){if(!otherSuggestions){otherSuggestions={}}var suggestions=that.slimListForMapResults(stringVal,list,showFull);var relevantOtherSuggestions=that.slimListForMapResults(stringVal,otherSuggestions,showFull);that.boldMatchingString(stringVal,relevantOtherSuggestions);that.boldMatchingString(stringVal,suggestions);that.renderSuggestions(suggestions,relevantOtherSuggestions);if(suggestions.length===0&&relevantOtherSuggestions.length===0){that.dropdownController.hideDropdown()}};that.getSuggestionsForOperators=function(stringVal,list){var suggestions=that.slimListForMapResults(stringVal,list,false);var fieldName=result.getLastFieldName();var supportedOperators;for(var i=0;i<jql_field_names.length;i++){if(that.equalsIgnoreCase(result.getUnquotedString(jql_field_names[i].value),fieldName)||(jql_field_names[i].cfid&&that.equalsIgnoreCase(jql_field_names[i].cfid,fieldName))){supportedOperators=jql_field_names[i].operators;break}}if(supportedOperators){suggestions=jQuery.grep(suggestions,function(arrValue){return jQuery.inArray(arrValue.value,supportedOperators)>-1})}that.boldMatchingString(stringVal,suggestions);return suggestions};that.renderSuggestionsForOperators=function(stringVal,list){var suggestions=that.getSuggestionsForOperators(stringVal,list);that.renderSuggestions(suggestions);if(suggestions.length===0){that.dropdownController.hideDropdown()}};that.renderSuggestionsForOperands=function(stringVal,ajaxSuggestions,functions,operatorSuggestions,providedSuggestionCount){if(providedSuggestionCount===suggestionCount){var functionsSuggestions=that.slimListForFunctionResults(stringVal,functions,result.getLastOperator());that.boldMatchingString(stringVal,functionsSuggestions);that.renderSuggestions(ajaxSuggestions,functionsSuggestions,operatorSuggestions);if(ajaxSuggestions.length===0&&functionsSuggestions.length===0&&operatorSuggestions.length==0){that.dropdownController.hideDropdown()}}};that.boldMatchingString=function(stringVal,list){if(stringVal==null||list.length===0){return }var boldLength=stringVal.length;for(var j=0,n=boldLength;j<n;j++){switch(stringVal.charAt(j)){case"<":case">":boldLength+=3;break;case"&":boldLength+=4;break;case'"':boldLength+=5;break}}for(var i=0;i<list.length;i++){if(list[i].displayName){var origVal=list[i].displayName;list[i]={value:list[i].value,displayName:"<b>"+origVal.substring(0,boldLength)+"</b>"+origVal.substring(boldLength)}}else{list[i]={value:list[i],displayName:"<b>"+list[i].substring(0,boldLength)+"</b>"+list[i].substring(boldLength)}}}};that.htmlEscape=function(stringVal){if(stringVal==null){return null}var escapedVal="";var strArr=stringVal.split("");for(var j=0;j<strArr.length;j++){if(strArr[j]==="<"){escapedVal+="&lt;"}else{if(strArr[j]===">"){escapedVal+="&gt;"}else{if(strArr[j]==="&"){escapedVal+="&amp;"}else{if(strArr[j]==='"'){escapedVal+="&quot;"}else{escapedVal+=strArr[j]}}}}}return escapedVal},that.getReplacementStartIndex=function(result,value){var jQueryReference=jQuery(this.field);var start;if(result.getNeedsField()){start=result.getLastFieldNameStartIndex()}else{if(result.getNeedsOperatorOrOperand()){if(result.getNeedsOperator()&&that.isWasOperator(value)){start=result.getLastOperatorStartIndex()}else{start=result.getLastOperandStartIndex()}}else{if(result.getNeedsOperand()){start=result.getLastOperandStartIndex()}else{if(result.getNeedsOperator()){start=result.getLastOperatorStartIndex()}else{if(result.getNeedsOrderByField()){start=result.getLastOrderByFieldNameStartIndex()}else{if(result.getNeedsOrderByDirection()){start=result.getLastOrderByDirectionStartIndex()}else{if(result.getNeedsPredicateOperand()){start=result.getLastOperandStartIndex()}else{if(result.getNeedsLogicalOperator()){if(result.getLastLogicalOperatorStartIndex()!==null&&result.getLastLogicalOperatorStartIndex()!==0){start=result.getLastLogicalOperatorStartIndex()}else{if(result.getLastOrderBy()!==null&&result.getLastOrderByStartIndex()!==0){start=result.getLastOrderByStartIndex()}else{if(result.getLastWasPredicate()!=null&&result.getLastWasPredicateStartIndex()!==0){start=result.getLastWasPredicateStartIndex()}else{if(result.getMustBeOperatorOrPredicate()===true){start=jQueryReference.selectionRange().start}else{start=jQueryReference.selectionRange().start-1}}}}}else{if(result.getNeedsWasPredicate()){start=result.getLastWasPredicateStartIndex()}else{if(result.getNeedsOrderBy()){start=result.getLastOrderByStartIndex()}else{start=jQueryReference.selectionRange().start-1}}}}}}}}}}return start!=null?start:jQueryReference.selectionRange().start};that.getReplacementEndIndex=function(result,start){var jQueryReference=jQuery(this.field);var selectionRange=jQueryReference.selectionRange();var end=null;if(selectionRange.start===selectionRange.end&&selectionRange.end!==this.field.val().length){var currentTokenIdx=result.getTokens().length-1;var token=parser.parse(this.field.val());if(!token.getParseError()){var fullTokenValue=token.getResult().getTokens()[currentTokenIdx];if(fullTokenValue!==null&&fullTokenValue!=="("&&fullTokenValue!==")"){var fullTextVal=this.field.val();var remainingString=fullTextVal.substring(start,fullTextVal.length);var remainingStringArr=remainingString.split("");var whitespaceCount=0;for(var i=0;i<remainingStringArr.length;i++){if(REGEXP_WHITESPACE.test(remainingStringArr[i])){whitespaceCount++}else{break}}end=start+fullTokenValue.length+whitespaceCount}}}if(end===null){end=selectionRange.end}if(end<start){that.replaceValue(start,end," ");end=start}return end};that.replaceValue=function(start,end,newValue){var jQueryReference=jQuery(this.field);jQueryReference.selectionRange(start,end);jQueryReference.selection(newValue);var newEnd=jQueryReference.selectionRange().end;jQueryReference.selectionRange(newEnd,newEnd)};that.slimListForMapResults=function(stringVal,list,showFull){var escString=that.htmlEscape(stringVal);var slimedList=jQuery.grep(list,function(arrValue){return that.startsWithIgnoreCaseNullsMeanAll(escString,arrValue.displayName)});if(!showFull){if(slimedList.length===1&&!that.startsWithNotEqualsIgnoreCaseNullMeansAll(escString,slimedList[0].displayName)){return{}}}return slimedList};that.slimListForFunctionResults=function(stringVal,list,operator){var fieldName=result.getLastFieldName();var supportedTypes;for(var i=0;i<jql_field_names.length;i++){if(that.equalsIgnoreCase(result.getUnquotedString(jql_field_names[i].value),fieldName)||(jql_field_names[i].cfid&&that.equalsIgnoreCase(jql_field_names[i].cfid,fieldName))){supportedTypes=jql_field_names[i].types;break}}var slimedList=jQuery.grep(list,function(arrValue){if((arrValue.isList&&!that.isListSupportingOperator(operator))||(!arrValue.isList&&that.isListSupportingOperator(operator))){return false}if(supportedTypes){var supportsFunction=jQuery.inArray("java.lang.Object",arrValue.types)>-1||jQuery.inArray("java.lang.Object",supportedTypes)>-1;for(var i=0;i<supportedTypes.length&&!supportsFunction;i++){supportsFunction=jQuery.inArray(supportedTypes[i],arrValue.types)!==-1}if(!supportsFunction){return false}}else{return false}return that.startsWithIgnoreCaseNullsMeanAll(stringVal,arrValue.value)||that.startsWithIgnoreCaseNullsMeanAll(stringVal,arrValue.displayName)});if(slimedList.length===1&&!that.startsWithNotEqualsIgnoreCaseNullMeansAll(stringVal,slimedList[0].displayName)){return{}}return slimedList};that.slimListForPredicates=function(stringVal,list,predicate){var supportedType;var supportsList;for(var i=0;i<jql_changed_predicates.length;i++){if(that.equalsIgnoreCase(result.getUnquotedString(jql_changed_predicates[i].value),predicate)){supportedType=jql_changed_predicates[i].type;supportsList=jql_changed_predicates[i].supportsList;break}}var slimedList=jQuery.grep(list,function(arrValue){if(typeof arrValue.isList!="undefined"){if((arrValue.isList&&!!supportsList)||(!arrValue.isList&&supportsList)){return false}}var supportsFunction=jQuery.inArray(supportedType,arrValue.types)!==-1;return supportsFunction?that.startsWithIgnoreCaseNullsMeanAll(stringVal,arrValue.value)||that.startsWithIgnoreCaseNullsMeanAll(stringVal,arrValue.displayName):false});if(slimedList.length===1&&!that.startsWithNotEqualsIgnoreCaseNullMeansAll(stringVal,slimedList[0].displayName)){return{}}return slimedList};that.predicateSupportsAutoComplete=function(predicate){var auto;for(var i=0;i<jql_changed_predicates.length;i++){if(that.equalsIgnoreCase(result.getUnquotedString(jql_changed_predicates[i].value),predicate)){auto=jql_changed_predicates[i].auto;break}}return auto};that.isListSupportingOperator=function(operator){return operator==="in"||operator==="not in"||operator=="was not in"||operator=="was in"};that.isEmptyOnlyOperator=function(operator){return operator==="is"||operator==="is not"};that.isWasOperator=function(operator){return operator==="was"||operator==="was in"||operator=="was not in"||operator=="was not"};that.isChangedOperator=function(operator){return operator==="changed"};that.isHistoryOperator=function(operator){return this.isWasOperator(operator)||this.isChangedOperator(operator)};that.startsWithIgnoreCaseNullsMeanAll=function(startStr,str){if(str===null||startStr===null){return true}if(str.length<startStr.length){return false}else{return startStr.toLowerCase()==str.substr(0,startStr.length).toLowerCase()}};that.startsWithNotEqualsIgnoreCaseNullMeansAll=function(startStr,str){if(str===null||startStr===null){return true}if(str.length<startStr.length){return false}else{var subStrEquals=startStr.toLowerCase()==str.substr(0,startStr.length).toLowerCase();if(subStrEquals){var equalsString=null;if(REGEXP_FIELD_NAME.test(str.substr(startStr.length,str.length))){equalsString=str.substr(0,startStr.length)}else{equalsString=str}return startStr.toLowerCase()!=equalsString.toLowerCase()}return false}};that.equalsIgnoreCase=function(str1,str2){if(str1===null&&str2===null){return true}else{if(str1===null||str1===null){return false}else{return str1.toLowerCase()===str2.toLowerCase()}}};that.getSavedResponse=function(val){if(!this.requested){this.requested={}}return this.requested[val]};that.saveResponse=function(val,response){if(typeof val==="string"&&typeof response==="object"){if(!this.requested){this.requested={}}this.requested[val]=response}};that.startsWithIgnoreCase=function(startStr,str){if(str===null||startStr===null||str.length<startStr.length){return false}else{return startStr.toLowerCase()==str.substr(0,startStr.length).toLowerCase()}};that.updateParseIndicator=function(token){if(token.getParseError()){PARSE_INDICATOR.attr("title",token.getResult().getParseErrorMsg()).removeClass("jqlgood").addClass("jqlerror")}else{PARSE_INDICATOR.attr("title","").removeClass("jqlerror").addClass("jqlgood")}};that.updateColumnLineCount=function(){var jQueryReference=jQuery(that.field);var totalCharCountToCursor=0;if(that.field[0]===document.activeElement){var selectionRange=jQueryReference.selectionRange();totalCharCountToCursor=selectionRange.start}else{totalCharCountToCursor=that.field[0].value.length}var rowCount=1;var colCount=1;var fieldValue=that.field.val();for(var i=0;i<totalCharCountToCursor;i++){if(REGEXP_NEW_LINE.test(fieldValue.charAt(i))){rowCount++;colCount=1}else{colCount++}}jqlcolumnnum.text(colCount);jqlrownum.text(rowCount)};that.init(options);return that};JIRA.JQLAutoComplete.MyParser=function(jqlReservedWords){var jql_reserved_words=jqlReservedWords;return{parse:function(input){var token=JIRA.JQLAutoComplete.Token();token.init(input);this.jql(token);return token},orderByClause:function(token){var remainingString=token.remainingString();var matchArray=remainingString.match(REGEXP_ORDER_BY);if(matchArray){var orderByString=remainingString.substring(0,matchArray[0].length);token.consumeCharacters(orderByString.length);token.getResult().setLastOrderBy(orderByString,token);if(!token.isComplete()){remainingString=token.remainingString();if(REGEXP_WHITESPACE.test(remainingString)){this.chewWhitespace(token);this.orderByFields(token)}else{token.getResult().resetLogicalOperators();token.setParseError()}}else{token.getResult().resetLogicalOperators();token.setParseError()}}else{token.consumeCharacters(remainingString.length);token.getResult().setLastOrderBy(remainingString,token);token.setParseError()}},orderByFields:function(token){this.orderByField(token);this.chewWhitespace(token);if(token.isComplete()){if(!token.getResult().getNeedsOrderByField()){token.getResult().setLastOrderByDirection("",token)}}else{var remainingString=token.remainingString();if(this.startsWithIgnoreCase(",",remainingString)){token.consumeCharacter();this.orderByFields(token);this.chewWhitespace(token)}else{remainingString=token.remainingString();if(remainingString!==null){token.consumeCharacters(remainingString.length)}token.getResult().setNeedsOrderByDirection();token.getResult().setLastOrderByDirection(remainingString,token);token.setParseError()}}},orderByField:function(token){this.chewWhitespace(token);var fieldName=this.fieldName(token);if(fieldName.length!==0){token.getResult().setLastOrderByFieldName(fieldName,token);var remainingString=token.remainingString();if(!token.isComplete()&&!REGEXP_COMMA_DELIMITER.test(remainingString)){if(REGEXP_ASCENDING.test(remainingString)){this.chewWhitespace(token);token.consumeCharacters(3);token.getResult().setLastOrderByDirection("asc",token);token.getResult().setNeedsOrderByComma()}else{if(REGEXP_DESCENDING.test(remainingString)){this.chewWhitespace(token);token.consumeCharacters(4);token.getResult().setLastOrderByDirection("desc",token);token.getResult().setNeedsOrderByComma()}else{token.getResult().setNeedsOrderByDirection()}}}else{token.getResult().setNeedsOrderByField();this.chewWhitespace(token)}}else{token.getResult().setLastOrderByFieldName("",token);token.getResult().setNeedsOrderByField();token.setParseError()}},jql:function(token){this.orClause(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("ord",remainingString)){this.orderByClause(token)}},orClause:function(token){while(!token.isComplete()&&!this.startsWithIgnoreCase(")",token.remainingString())){this.chewWhitespace(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("ord",remainingString)){break}if(token.getResult().getMustBeOperatorOrPredicate()){token.getResult().resetLastPredicates()}else{token.getResult().resetLogicalOperators();this.andClause(token)}if(!token.isComplete()&&token.getResult().getLastLogicalOperator()===null){if(token.getResult().getNeedsWasPredicate()){this.predicateClause(token)}if(token.isComplete()){return }remainingString=token.remainingString();if(this.startsWithIgnoreCase("ord",remainingString)){break}else{if(remainingString!==null&&(REGEXP_ORS.test(remainingString)||this.startsWithIgnoreCase("|",remainingString)||this.startsWithIgnoreCase("||",remainingString))){if(this.startsWithIgnoreCase("||",remainingString)){token.getResult().setLastLogicalOperator("||",token.getTokenStringIdx());token.consumeCharacters(2)}else{if(REGEXP_ORS.test(remainingString)){token.getResult().setLastLogicalOperator("OR",token.getTokenStringIdx());token.consumeCharacters(3)}else{token.getResult().setLastLogicalOperator("|",token.getTokenStringIdx());token.consumeCharacters(1)}}token.getResult().resetTerminalClause();if(token.isComplete()){token.setParseError()}token.getResult().setNeedsField()}else{if(!this.startsWithIgnoreCase(")",remainingString)||!token.getInParens()){this.chewWhitespace(token);var errorIdx=(remainingString===null)?token.getMaxTokenStringIdx():token.getMaxTokenStringIdx()-remainingString.length;var tokens;if(remainingString!=null){tokens=remainingString.split(" ");token.getResult().setLastLogicalOperator(tokens[0],errorIdx);token.getResult().setLastWasPredicate(tokens[0],token);token.getResult().setNeedsLogicalOperator(token)}if(token.getResult().getLastWasOperator()==null){token.setParseError()}else{if(tokens!=null){if(REGEXP_PREDICATE.test(tokens[0])){token.getResult().setLastLogicalOperator(null);token.getResult().resetNeedsPredicateOperand()}else{if(REGEXP_ANDS.test(remainingString)){token.consumeCharacters(4);token.getResult().resetTerminalClause();token.getResult().setNeedsField()}if(token.isComplete()||tokens.length==1){token.setParseError()}}}}}}}}}},andClause:function(token){this.chewWhitespace(token);this.notClause(token);if(!token.isComplete()&&token.getResult().getLastLogicalOperator()===null){this.chewWhitespace(token);var remainingString=token.remainingString();if(remainingString!==null&&(REGEXP_ANDS.test(remainingString)||this.startsWithIgnoreCase("&",remainingString)||this.startsWithIgnoreCase("&&",remainingString))){if(this.startsWithIgnoreCase("&&",remainingString)){token.getResult().setLastLogicalOperator("&&",token.getTokenStringIdx());token.consumeCharacters(2)}else{if(this.startsWithIgnoreCase("&",remainingString)){token.getResult().setLastLogicalOperator("&",token.getTokenStringIdx());token.consumeCharacters(1)}else{token.getResult().setLastLogicalOperator("AND",token.getTokenStringIdx());token.consumeCharacters(4)}}token.getResult().resetTerminalClause();if(token.isComplete()){token.setParseError()}token.getResult().setNeedsField()}else{token.getResult().setNeedsLogicalOperator(token);if(token.isComplete()){token.getResult().setLastLogicalOperator(null,token.getMaxTokenStringIdx())}}}},notClause:function(token){this.chewWhitespace(token);if(!token.isComplete()){this.chewWhitespace(token);var remainingString=token.remainingString();if(remainingString!==null&&(REGEXP_NOTS.test(remainingString)||this.startsWithIgnoreCase("!",remainingString))){token.getResult().needsField=false;if(this.startsWithIgnoreCase("!",remainingString)){token.getResult().setLastLogicalOperator("!",token.getTokenStringIdx());token.consumeCharacters(1)}else{token.getResult().setLastLogicalOperator("NOT",token.getTokenStringIdx());token.consumeCharacters(4)}token.getResult().resetTerminalClause();if(token.isComplete()){token.setParseError()}token.getResult().setNeedsField()}else{this.terminalClause(token)}}else{this.terminalClause(token);token.setParseError()}},predicateClause:function(token){this.chewWhitespace(token);if(!token.isComplete()){var remainingString=token.remainingString();var tokens=remainingString.split(/[\s(]+/);if(remainingString!==null){token.getResult().setMustBeOperatorOrPredicate(false);if(this.startsWithLogicalOperator(remainingString)){if(tokens.length==1){token.getResult().setLastWasPredicate(tokens[0],token);token.setParseError();return }return }token.getResult().resetNeedsPredicateOperand();token.consumeCharacters(tokens[0].length);token.getResult().setLastWasPredicate(tokens[0],token);if(tokens.length==1){token.setParseError();return }if(this.wasPredicateComplete(tokens[0])){token.getResult().setNeedsPredicateOperand();token.getResult().setLastOperand(null,token);this.predicateOperand(token)}else{token.setParseError()}}}else{token.setParseError()}},predicateOperand:function(token){this.chewWhitespace(token);var predicateOperand=this.collectPredicateOperands(token);if(predicateOperand==null||predicateOperand==""){token.getResult().setLastOperandStartIndex(token.getTokenStringIdx());token.setParseError()}if(token.remainingString()!=null){token.getResult().resetNeedsPredicateOperand();token.getResult().resetLastPredicates();token.getResult().setMustBeOperatorOrPredicate(true);token.getResult().setNeedsLogicalOperator(token);this.chewWhitespace(token)}},collectPredicateOperands:function(token){if(token.getResult().getLastWasPredicate()==="DURING"){token.getResult().setNeedsOpenParen(true)}var predicateOperand=this.listOperand(token,true);if(predicateOperand.length===0){predicateOperand=this.functionOperand(token);if(predicateOperand.length===0){predicateOperand=this.singleValueOperand(token)}else{token.getResult().setNeedsOpenParen(false)}}else{token.getResult().setNeedsOpenParen(false)}return token.getResult().getUnquotedString(predicateOperand)},terminalClause:function(token){token.getResult().resetTerminalClause();this.chewWhitespace(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("(",remainingString)){token.getResult().addToken("(");token.setInParens();token.consumeCharacter();this.orClause(token);this.chewWhitespace(token);remainingString=token.remainingString();if(this.startsWithIgnoreCase(")",remainingString)){token.getResult().addToken(")");token.consumeCharacter();token.setOutOfParens();if(token.isComplete()){token.getResult().resetLogicalOperators();token.getResult().resetLastPredicates()}}else{token.setParseError()}}else{this.field(token);if(!token.isComplete()){this.oper(token);if(!token.isComplete()){if(token.getResult().getLastWasOperator()==="changed"){token.getResult().setNeedsLogicalOperator(token);return }this.operand(token);if(token.getResult().getOperandComplete()){var lastWasOperator=token.getResult().getLastWasOperator();token.getResult().setNeedsNothing();if(lastWasOperator){token.getResult().setLastWasOperator(lastWasOperator)}}else{if(token.isComplete()&&!token.getResult().getNeedsListComma()){token.getResult().setNeedsOperand()}}}else{if(token.getResult().getLastOperator()=="was"||token.getResult().getLastOperator()=="was not"){token.getResult().setNeedsOperandOrOperator()}else{if(token.getResult().getLastWasOperator()==="changed"){var currentChar=token.currentCharacter();if(currentChar!==null&&REGEXP_SPACE_OR_ELSE.test(currentChar)){token.getResult().setNeedsLogicalOperator(token)}else{token.getResult().resetLogicalOperators();token.getResult().setNeedsOrderBy(false)}return }else{token.getResult().setNeedsOperator()}}token.setParseError()}}else{token.getResult().setNeedsField();token.setParseError()}}},field:function(token){var fieldName=this.fieldName(token);if(fieldName.length!==0){token.getResult().setLastFieldName(fieldName,token)}else{if(token.getResult().getLastFieldName()===null){remainingString=token.remainingString();token.getResult().setNeedsField();token.getResult().setLastFieldName(remainingString,token);token.setParseError()}}},fieldName:function(token){this.chewWhitespace(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("cf",remainingString)){var origIdx=token.getTokenStringIdx();var origString=token.remainingString();token.consumeCharacters(2);this.chewWhitespace(token);remainingString=token.remainingString();if(this.startsWithIgnoreCase("[",remainingString)){token.consumeCharacter();remainingString=token.remainingString();var custFieldId=this.numberValue(token);if(custFieldId.length!==0){this.chewWhitespace(token);remainingString=token.remainingString();if(this.startsWithIgnoreCase("]",remainingString)){token.consumeCharacter();return origString.substring(0,token.getTokenStringIdx()-origIdx)}}}token.setParseError();return origString}else{return this.fieldOrFunctionName(token)}},oper:function(token){this.chewWhitespace(token);var remainingString=token.remainingString();var operator=this.getLongestOperatorMatch(remainingString,jql_operators);if(operator!==null){token.getResult().setLastOperator(operator,token.getTokenStringIdx());if(this.isWasOperator(operator)||this.isChangedOperator(operator)){token.getResult().setLastWasOperator(operator)}token.consumeCharacters(operator.length);if(operator=="in"||operator=="is"||operator=="is not"||operator=="not in"||operator=="was"||operator=="was not"||operator=="was in"||operator=="was not in"){var currentChar=token.currentCharacter();if(currentChar!==null&&!REGEXP_SPACE_OR_ELSE.test(currentChar)){token.setParseError()}}if(operator=="was"){token.getResult().setNeedsOperandOrOperator();this.chewWhitespace(token);var remainingString=token.remainingString();if(remainingString!=null&&(REGEXP_NOTSTART.test(remainingString)||REGEXP_INSTART.test(remainingString))){token.setParseError()}}else{if(operator=="was not"){token.getResult().setNeedsOperandOrOperator();this.chewWhitespace(token);var remainingString=token.remainingString();if(remainingString!=null&&(REGEXP_INSTART.test(remainingString))){token.setParseError()}}else{if(operator=="changed"){token.getResult().setNeedsLogicalOperator(token)}else{token.getResult().setNeedsOperand()}}}}else{if(token.getResult().getLastOperator()===null){var errorIdx=(remainingString===null)?token.getMaxTokenStringIdx():token.getMaxTokenStringIdx()-remainingString.length;token.getResult().setLastOperator(remainingString,errorIdx);token.getResult().setNeedsOperator();token.setParseError()}}},operand:function(token){this.chewWhitespace(token);if(token.getResult().getLastOperator()==="in"||token.getResult().getLastOperator()==="not in"||token.getResult().getLastOperator()==="was not in"||token.getResult().getLastOperator()==="was in"){token.getResult().setNeedsOpenParen(true)}var operand=this.listOperand(token,true);if(operand.length===0){operand=this.functionOperand(token);if(operand.length===0){operand=this.singleValueOperand(token)}else{token.getResult().setNeedsOpenParen(false)}}else{token.getResult().setNeedsOpenParen(false)}if(operand===null||operand.length===0){var remainingString=token.remainingString();token.getResult().setLastOperand(remainingString,token);token.getResult().setNeedsOperand();token.setParseError()}if(operand.length!==0){return operand}return""},singleValueOperand:function(token){var operand=this.stringValue(token);if(operand.length!==0){token.getResult().setLastOperand(operand,token);if(operand.toLowerCase()!="empty"&&operand.toLowerCase()!="null"&&this.isReservedWord(operand.toLowerCase())){token.setParseError()}return operand}return""},functionOperand:function(token){var startIdx=token.getTokenStringIdx();var functionName=this.fieldOrFunctionName(token);this.chewWhitespace(token);var listArguments=this.listOperand(token,false);if(functionName.length!==0&&listArguments.length!==0){var operand=functionName+listArguments;token.getResult().setLastOperand(operand,token);return operand}else{token.backTrackToIdx(startIdx);return""}},listOperand:function(token,treatAsOperands){if(token.currentCharacter()=="("){token.consumeCharacter();var listValue=this.collectListValues(token,treatAsOperands);var operandVal="("+listValue;this.chewWhitespace(token);if(token.currentCharacter()==")"){token.consumeCharacter();operandVal+=")";if(operandVal=="()"&&treatAsOperands){token.getResult().setLastOperand(operandVal,token)}if(treatAsOperands){token.getResult().setOperandComplete();token.getResult().resetNeedsPredicateOperand()}}else{token.setParseError()}return operandVal}else{return""}},collectListValues:function(token,treatAsOperands){if(treatAsOperands){token.getResult().setNeedsOperand()}this.chewWhitespace(token);var currentOperand=(treatAsOperands)?this.operand(token):this.stringValue(token);if(currentOperand.length!==0){if(this.chewWhitespace(token)&&treatAsOperands){token.getResult().setNeedsListComma()}if(token.currentCharacter()==","){token.consumeCharacter();var nextValue=this.collectListValues(token,treatAsOperands);if(nextValue.length===0){token.setParseError()}return currentOperand+", "+nextValue}else{return currentOperand}}else{return""}},startsWithIgnoreCase:function(startStr,str){if(str===null||startStr===null||str.length<startStr.length){return false}else{return startStr.toLowerCase()==str.substr(0,startStr.length).toLowerCase()}},startsWithLogicalOperator:function(str){if(str===null){return false}else{return this.startsWithOr(str)||this.startsWithAnd(str)||this.startsWithNot(str)||this.startsWithBraces(str)}},startsWithOr:function(str){return this.startsWithIgnoreCase("|",str)||this.startsWithIgnoreCase("||",str)||this.startsWithIgnoreCase("or",str)},startsWithAnd:function(str){return this.startsWithIgnoreCase("&",str)||this.startsWithIgnoreCase("&&",str)||this.startsWithIgnoreCase("and",str)},startsWithNot:function(str){return this.startsWithIgnoreCase("!",str)||this.startsWithIgnoreCase("not",str)},startsWithBraces:function(str){return this.startsWithIgnoreCase("(",str)||this.startsWithIgnoreCase(")",str)},chewWhitespace:function(token){var foundWhiteSpace=false;var currentChar=token.currentCharacter();while(currentChar!==null&&REGEXP_WHITESPACE.test(currentChar)){token.consumeCharacter();currentChar=token.currentCharacter();foundWhiteSpace=true}return foundWhiteSpace},getLongestOperatorMatch:function(value,listOfValues){var longestMatch=null;if(this.startsWithIgnoreCase("is",value)){var matchArray=value.substring(2).match(REGEXP_SNOT);if(matchArray){longestMatch=value.substring(0,matchArray[0].length+2)}else{longestMatch="is"}}if(this.startsWithIgnoreCase("was",value)){var matchArray=value.substring(3).match(REGEXP_SNOT_IN);if(matchArray){longestMatch=value.substring(0,matchArray[0].length+3)}else{longestMatch="was"}}else{if(this.startsWithIgnoreCase("not",value)){var matchArrayNot=value.substring(3).match(REGEXP_SIN);if(matchArrayNot){longestMatch=value.substring(0,matchArrayNot[0].length+3)}}else{for(var i=0;i<listOfValues.length;i++){if(this.startsWithIgnoreCase(listOfValues[i].value,value)){if(longestMatch===null||jql_operators[i].value.length>longestMatch){longestMatch=jql_operators[i].value}}}}}return longestMatch},getValueMinusExtraWhitespace:function(value){if(value===null){return null}var newValue="";var firstWhitespace=true;var valueArr=value.split("");for(var i=0;i<valueArr.length;i++){var currentChar=valueArr[i];if(REGEXP_WHITESPACE.test(currentChar)){if(firstWhitespace){firstWhitespace=false;newValue=newValue+currentChar}}else{firstWhitespace=true;newValue=newValue+currentChar}}return newValue},fieldOrFunctionName:function(token){var stringValue=this.stringValue(token);if(stringValue==='""'||stringValue==="''"){token.setParseError()}if(this.isReservedWord(stringValue.toLowerCase())){token.setParseError()}return stringValue},isReservedWord:function(word){return jQuery.inArray(word,jql_reserved_words)!==-1},isWasOperator:function(operator){return operator==="was"||operator==="was in"||operator=="was not in"||operator=="was not"},isChangedOperator:function(operator){return operator==="changed"},stringValue:function(token){var stringValue="";var inQuote=false;var inSingleQuote=false;var currentChar=token.currentCharacter();while(currentChar!==null&&(inQuote||inSingleQuote||REGEXP_TOKEN_CHAR.test(currentChar))){stringValue=stringValue+currentChar;token.consumeCharacter();if(currentChar=="\\"){currentChar=token.currentCharacter();if(currentChar===null){token.setParseError();break}else{if(REGEXP_CHARS_TO_ESCAPE.test(currentChar)){var remainingString=token.remainingString();if(!REGEXP_UNICODE.test(remainingString)){token.setParseError();break}}}stringValue=stringValue+currentChar;token.consumeCharacter()}else{if(REGEXP_SPECIAL_CHAR.test(currentChar)&&!(inQuote||inSingleQuote)){token.setParseError();break}else{if(currentChar=='"'&&!inSingleQuote){inQuote=!inQuote}else{if(currentChar=="'"&&!inQuote){inSingleQuote=!inSingleQuote}}}}currentChar=token.currentCharacter()}if(token.isComplete()&&(inQuote||inSingleQuote)){token.setParseError()}return stringValue},numberValue:function(token){var numberVal="";this.chewWhitespace(token);var currentChar=token.currentCharacter();while(currentChar!==null){if(REGEXP_NUMBER.test(currentChar)){numberVal=numberVal+currentChar;token.consumeCharacter()}else{break}currentChar=token.currentCharacter()}return numberVal},wasPredicateComplete:function(predicate){var foundPredicate=false;var arLen=jql_changed_predicates.length;for(var i=0,len=arLen;i<len;++i){if(predicate.toLowerCase()==jql_changed_predicates[i].value.toLowerCase()){foundPredicate=true;break}}return foundPredicate}}};JIRA.JQLAutoComplete.ParseResult=function(){var tokens=[];var tokenIdx=0;return{getTokens:function(){return tokens},addToken:function(token){tokens[tokenIdx++]=token},setLastFieldName:function(lastFieldName,token){this.fieldNameStartIndex=(lastFieldName===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastFieldName.length);this.lastFieldName=this.getUnquotedString(lastFieldName);tokens[tokenIdx++]=lastFieldName},getLastFieldName:function(){return this.lastFieldName},getLastFieldNameStartIndex:function(){return this.fieldNameStartIndex},setLastOrderByFieldName:function(lastFieldName,token){this.orderByFieldNameStartIndex=(lastFieldName===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastFieldName.length);this.lastOrderByFieldName=this.getUnquotedString(lastFieldName);this.lastOrderByDirection=null;tokens[tokenIdx++]=lastFieldName},getLastOrderByFieldName:function(){return this.lastOrderByFieldName},getLastOrderByFieldNameStartIndex:function(){return this.orderByFieldNameStartIndex},setLastOrderByDirection:function(lastDirection,token){this.orderByDirectionStartIndex=(lastDirection===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastDirection.length);this.lastOrderByDirection=lastDirection;tokens[tokenIdx++]=lastDirection},getLastOrderByDirection:function(){return this.lastOrderByDirection},getLastOrderByDirectionStartIndex:function(){return this.orderByDirectionStartIndex},setNeedsField:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=true;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false;this.needsWasPredicate=false;this.lastWasOperator=null},getNeedsField:function(){return this.needsField},setNeedsOrderByField:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=true;this.needsOrderByDirection=false;this.lastOrderByDirection=null;this.needsListComma=false},getNeedsOrderByField:function(){return this.needsOrderByField},setNeedsOrderByDirection:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=true;this.needsListComma=false},getNeedsOrderByDirection:function(){return this.needsOrderByDirection},setNeedsOrderByComma:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false},setNeedsListComma:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=true},getNeedsListComma:function(){return this.needsListComma},setLastOperator:function(lastOperator,startIndex){this.lastOperator=lastOperator;this.operatorStartIndex=startIndex;tokens[tokenIdx++]=lastOperator},setLastWasOperator:function(lastWasOperator){this.lastWasOperator=lastWasOperator},getLastWasOperator:function(){return this.lastWasOperator},getLastOperator:function(){return this.lastOperator},getLastOperatorStartIndex:function(){return this.operatorStartIndex},setLastOperand:function(lastOperand,token){this.operandStartIndex=(lastOperand===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastOperand.length);this.lastOperand=this.getUnquotedString(lastOperand);tokens[tokenIdx++]=lastOperand},getLastOperand:function(){return this.lastOperand},setNeedsOperand:function(){this.needsField=false;this.needsOperator=false;this.needsLogicalOperator=false;this.needsOperand=true;this.needsOrderBy=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false},setNeedsOperandOrOperator:function(){this.needsField=false;this.needsOperator=true;this.needsLogicalOperator=false;this.needsOperand=true;this.needsOrderBy=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false},getNeedsOperand:function(){return this.needsOperand},setNeedsPredicateOperand:function(){this.needsPredicateOperand=true},resetNeedsPredicateOperand:function(){this.needsPredicateOperand=false;this.needsOperand=false},getNeedsPredicateOperand:function(){return this.needsPredicateOperand},getLastOperandStartIndex:function(){return this.operandStartIndex},setLastOperandStartIndex:function(index){this.operandStartIndex=index},setLastLogicalOperator:function(lastLogicalOperator,startIndex){this.lastLogicalOperator=lastLogicalOperator;this.logicalOperatorStartIndex=startIndex;tokens[tokenIdx++]=lastLogicalOperator},setNeedsOperator:function(){this.needsField=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsOperator=true;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false},getNeedsOperatorOrOperand:function(){return this.needsOperator&&this.needsOperand},getNeedsOperator:function(){return this.needsOperator},getLastLogicalOperator:function(){return this.lastLogicalOperator},getLastLogicalOperatorStartIndex:function(){return this.logicalOperatorStartIndex},setNeedsLogicalOperator:function(token){this.needsLogicalOperator=true;this.needsOperator=false;this.needsOperand=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false;this.needsOrderBy=!token.getInParens();if(this.lastWasOperator!=null){this.needsWasPredicate=true}},setNeedsOpenParen:function(value){this.needsOpenParen=value},getNeedsOpenParen:function(){return this.needsOpenParen},getNeedsLogicalOperator:function(){return this.needsLogicalOperator},setNeedsOrderBy:function(value){this.needsOrderBy=value},getNeedsOrderBy:function(){return this.needsOrderBy},getNeedsWasPredicate:function(){return this.needsWasPredicate},setLastWasPredicate:function(lastWasPredicate,token){this.wasPredicateStartIndex=(lastWasPredicate===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastWasPredicate.length);this.lastWasPredicate=lastWasPredicate;tokens[tokenIdx++]=lastWasPredicate},getLastWasPredicate:function(){return this.lastWasPredicate},resetLastPredicates:function(){this.lastLogicalOperator=null;this.lastWasPredicate=null;this.lastOperand=null;this.wasPredicateStartIndex=null;this.operandStartIndex=null},getLastWasPredicateStartIndex:function(){return this.wasPredicateStartIndex},setLastOrderBy:function(lastOrderBy,token){this.orderByStartIndex=(lastOrderBy===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastOrderBy.length);this.lastOrderBy=lastOrderBy;tokens[tokenIdx++]=lastOrderBy},getLastOrderBy:function(){return this.lastOrderBy},getLastOrderByStartIndex:function(){return this.orderByStartIndex},resetLogicalOperators:function(){this.lastLogicalOperator=null;this.logicalOperatorStartIndex=null;this.needsLogicalOperator=null},getUnquotedString:function(value){var secondToLastNotEsacape=value!=null&&value.length>=3&&value.charAt(value.length-2)!="\\";if(value!=null&&value.charAt(0)=='"'){value=value.substring(1,value.length);if(value.charAt(value.length-1)=='"'&&secondToLastNotEsacape){value=value.substring(0,value.length-1)}}else{if(value!=null&&value.charAt(0)=="'"){value=value.substring(1,value.length);if(value.charAt(value.length-1)=="'"&&secondToLastNotEsacape){value=value.substring(0,value.length-1)}}}return value},setParseError:function(message){this.parseError=true;this.parseErrorMsg=message},getParseError:function(){return this.parseError},getParseErrorMsg:function(){return this.parseErrorMsg},setNeedsNothing:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsOpenParen=false;this.needsListComma=false;this.needsWasPredicate=null;this.needsPredicateOperand=null;this.mustBeOperatorOrPredicate=null;this.lastWasOperator=null},setOperandComplete:function(){this.operandComplete=true},getOperandComplete:function(){return this.operandComplete},setMustBeOperatorOrPredicate:function(state){this.mustBeOperatorOrPredicate=state},getMustBeOperatorOrPredicate:function(){return this.mustBeOperatorOrPredicate},resetTerminalClause:function(){this.lastFieldName=null;this.fieldNameStartIndex=null;this.needsField=null;this.lastOperator=null;this.operatorStartIndex=null;this.needsOperator=null;this.lastOperand=null;this.operandStartIndex=null;this.needsOperand=null;this.operandComplete=null;this.needsOpenParen=null;this.needsListComma=false;this.mustBeOperatorOrPredicate=null},init:function(){this.lastFieldName=null;this.fieldNameStartIndex=null;this.needsField=null;this.lastOperator=null;this.operatorStartIndex=null;this.needsOperator=null;this.lastOperand=null;this.operandStartIndex=null;this.needsOperand=null;this.lastLogicalOperator=null;this.logicalOperatorStartIndex=null;this.lastOrderByFieldName=null;this.lastOrderByFieldNameStartIndex=null;this.lastOrderByDirection=null;this.lastOrderByDirectionStartIndex=null;this.orderByStartIndex=null;this.lastOrderBy=null;this.needsOrderBy=null;this.needsOrderByField=null;this.needsOrderByDirection=null;this.operandComplete=null;this.needsOpenParen=null;this.needsListComma=null;this.wasPredicateStartIndex=null;this.lastWasPredicate=null;this.needsWasPredicate=null;this.needsPredicateOperand=null;this.mustBeOperatorOrPredicate=null;this.lastWasOperator=null}}};JIRA.JQLAutoComplete.Token=function(){return{init:function(tokenString){this.tokenStringIdx=0;this.tokenString=tokenString;this.parseError=false;this.parseErrorMsg=null;this.result=JIRA.JQLAutoComplete.ParseResult();this.result.init();this.inParens=0},consumeCharacter:function(){this.tokenStringIdx++},consumeCharacters:function(numChars){this.tokenStringIdx=this.tokenStringIdx+numChars},backTrackToIdx:function(backTrackIdx){this.tokenStringIdx=backTrackIdx;this.parseError=false;this.parseErrorMsg=null;this.result.parseError=false;this.result.parseErrorMsg=null},getTokenStringIdx:function(){return this.tokenStringIdx},currentCharacter:function(){if(this.tokenStringIdx>=this.tokenString.length){return null}return this.tokenString.charAt(this.tokenStringIdx)},remainingString:function(){if(this.tokenStringIdx>=this.tokenString.length){return null}return this.tokenString.substr(this.tokenStringIdx,this.tokenString.length)},getMaxTokenStringIdx:function(){return this.tokenString.length},isComplete:function(){if(this.parseError){return true}return this.tokenStringIdx>=this.tokenString.length},setInParens:function(){this.inParens++},setOutOfParens:function(){if(this.inParens!==0){this.inParens--}},getInParens:function(){return this.inParens!==0},setParseError:function(){this.parseError=true;var preFixIdx=((this.tokenStringIdx-9)<0)?0:this.tokenStringIdx-9;var errorPrefix=this.tokenString.substring(preFixIdx,this.tokenStringIdx-1);this.result.setParseError("..."+errorPrefix+"^"+this.tokenString.substring(this.tokenStringIdx,this.tokenString.length))},getParseError:function(){return this.parseError},getResult:function(){return this.result}}};jQuery(function(){restore("jqlHistory");jQuery(".jql-autocomplete-params").each(function(){var params={};jQuery(this).find("input").each(function(){var $this=jQuery(this);params[$this.attr("id")]=$this.val()});var jqlFieldNames=JSON.parse(jQuery("#jqlFieldz").text());var jqlFunctionNames=JSON.parse(jQuery("#jqlFunctionNamez").text());var jqlReservedWords=JSON.parse(jQuery("#jqlReservedWordz").text());var jqlAutoComplete=JIRA.JQLAutoComplete({fieldID:"jqltext",parser:JIRA.JQLAutoComplete.MyParser(jqlReservedWords),queryDelay:0.65,jqlFieldNames:jqlFieldNames,jqlFunctionNames:jqlFunctionNames,minQueryLength:0,allowArrowCarousel:true,autoSelectFirst:false,errorID:"jqlerrormsg"});var jQueryRef=jQuery("#jqltext");jQueryRef.unbind("keypress",submitOnEnter).keypress(function(e){if(jqlAutoComplete.dropdownController===null||!jqlAutoComplete.dropdownController.displayed||jqlAutoComplete.selectedIndex<0){if(e.keyCode==13&&!e.ctrlKey&&!e.shiftKey){jQuery("#jqlform").submit();return false}else{return true}}});jqlAutoComplete.buildResponseContainer();jqlAutoComplete.parse(jQueryRef.text());jqlAutoComplete.updateColumnLineCount();jQueryRef.click(function(){jqlAutoComplete.dropdownController.hideDropdown()})})})})();AJS.namespace("jira.widget.autocomplete.JQL",null,JIRA.JQLAutoComplete);
/* module-key = 'jira.webresources:searchers', location = '/includes/jira/searchers/datePicker.soy' */
// This file was automatically generated from datePicker.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DateSearcher == 'undefined') { JIRA.Templates.DateSearcher = {}; }


JIRA.Templates.DateSearcher.dateMeasurement = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<select class="js-measurement"><option value="m">', soy.$$escapeHtml("minutes"), '</option><option value="h">', soy.$$escapeHtml("hours"), '</option><option value="d">', soy.$$escapeHtml("days"), '</option><option value="w">', soy.$$escapeHtml("weeks"), '</option></select>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.renderWithinTheLast = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("Within the last {0} {1}",opt_data.inputField,opt_data.dateMeasurementField));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.withinTheLast = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input type="radio" class="js-dp-type-toggle" id="withinTheLastRadio"/>');
  var param19 = new soy.StringBuilder();
  JIRA.Templates.DateSearcher.dateMeasurement(null, param19);
  JIRA.Templates.DateSearcher.renderWithinTheLast({inputField: '<input class="js-val" type="text" maxlength="15" />', dateMeasurementField: param19.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.nowOverdue = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<label><input type="radio" class="js-dp-type-toggle" />', soy.$$escapeHtml("Now overdue"), '</label>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.renderMoreThan = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("More than {0} {1} ago",opt_data.inputField,opt_data.dateMeasurementField));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.moreThan = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input type="radio" tabIndex="-1" class="js-dp-type-toggle" id="moreThanRadio"/>');
  var param33 = new soy.StringBuilder();
  JIRA.Templates.DateSearcher.dateMeasurement(null, param33);
  JIRA.Templates.DateSearcher.renderMoreThan({inputField: '<input class="js-val" type="text" maxlength="15" />', dateMeasurementField: param33.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.renderDueMoreThan = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("More than {0} {1} overdue",opt_data.inputField,opt_data.dateMeasurementField));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.dueMoreThan = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input type="radio" tabIndex="-1" class="js-dp-type-toggle" id="moreThanRadio"/>');
  var param43 = new soy.StringBuilder();
  JIRA.Templates.DateSearcher.dateMeasurement(null, param43);
  JIRA.Templates.DateSearcher.renderDueMoreThan({inputField: '<input class="js-val" type="text" maxlength="15" />', dateMeasurementField: param43.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.renderDueInNext = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("Due in next {0} {1} {2} overdue",opt_data.inputField,opt_data.dateMeasurementField,opt_data.clauseField));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.dueInNext = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input type="radio" tabIndex="-1" class="js-dp-type-toggle" id="dueInNextRadio"/>');
  var param53 = new soy.StringBuilder();
  JIRA.Templates.DateSearcher.dateMeasurement(null, param53);
  JIRA.Templates.DateSearcher.renderDueInNext({inputField: '<input class="js-val" maxlength="15" type="text" />', dateMeasurementField: param53.toString(), clauseField: '<select class="js-clause"><option value="orIs">' + soy.$$escapeHtml("or is") + '</option><option value="andNot">' + soy.$$escapeHtml("and not") + '</option></select>'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.renderDateBetween = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("Between {0} and {1}",opt_data.startField,opt_data.endField));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.dateBetween = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input type="radio" tabIndex="-1" class="js-dp-type-toggle" id="dateBetweenRadio"/>');
  JIRA.Templates.DateSearcher.renderDateBetween({startField: '<input class="js-start-date" maxlength="15" placeholder="11-Jan-2012" type="text" /><span class="js-start-date-trigger aui-icon icon-date">' + soy.$$escapeHtml("Select a date") + '</span>', endField: '<input class="js-end-date" maxlength="12" placeholder="30-Jan-2012" type="text" /><span class="js-end-date-trigger aui-icon icon-date">' + soy.$$escapeHtml("Select a date") + '</span>'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.renderInRange = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("In range {0} to {1}",opt_data.startInput,opt_data.endInput));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.inRange = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input type="radio" tabIndex="-1" maxlength="15" class="js-dp-type-toggle" id="inRangeRadio"/>');
  JIRA.Templates.DateSearcher.renderInRange({startInput: '<input class="js-start-range" placeholder="-3w 4d 12h" type="text" />', endInput: '<input class="js-end-range" maxlength="15" placeholder="3w 4d 12h" type="text" />'}, output);
  return opt_sb ? '' : output.toString();
};

/* module-key = 'jira.webresources:searchers', location = '/includes/jira/searchers/DateSearcher.js' */
(function($){var _excludeList=["js-dp-type-toggle","js-val","js-measurement","js-clause","js-start-date","js-end-date","js-start-range","js-end-range"];var _labelfyContent=function(content,radioKey){var $content=jQuery("<div></div>").html(content).contents();var transformed=[];$content.each(function(index,element){var $element=jQuery(element);var value=jQuery("<div/>").html(element).html();if(!_.contains(_excludeList,$element.attr("class"))){value=value.replace(/^\s+|\s+$/g,"&nbsp;");transformed.push("<label for='"+radioKey+"'>"+value+"</label>")}else{transformed.push(value)}});return transformed.join("")};var _generateSearcherAndBindHandler=function(data){var radioKey=data.radioKey+"Radio";var outputContent=data.$el.html(_labelfyContent(data.rawTemplate,radioKey));outputContent.find(":not(.js-dp-type-toggle):not(select):input").mousedown(function(){var $label=outputContent.find("label");if($label.length>0){$label[0].click()}});return outputContent};var NowOverdue=Backbone.View.extend({className:"field-group",attributes:{"data-date-type":"nowOverdue"},template:JIRA.Templates.DateSearcher.nowOverdue,getValues:function(){return{to:0}},updateFromValues:function(values){if(!values.from&&values.to==="0"){return true}},render:function(){return this.$el.html(this.template())}});var WithinTheLast=Backbone.View.extend({className:"field-group",attributes:{"data-date-type":"withinTheLast"},template:JIRA.Templates.DateSearcher.withinTheLast,getValues:function(){var val=this.$(".js-val").val();if(val){return{from:"-"+val+this.$el.find(".js-measurement").val()}}},updateFromValues:function(values){if(!values.to&&values.from&&values.from.charAt(0)=="-"){var vals=this.model.parseRelativeStr(values.from);this.$(".js-val").val(vals.val.slice(1));if(vals.measurement){this.$(".js-measurement").val(vals.measurement)}return true}},render:function(verb){return _generateSearcherAndBindHandler({$el:this.$el,rawTemplate:this.template(),radioKey:this.attributes["data-date-type"]})}});var MoreThan=Backbone.View.extend({className:"field-group",attributes:{"data-date-type":"moreThan"},template:JIRA.Templates.DateSearcher.moreThan,getValues:function(){var val=this.$(".js-val").val();if(val){return{to:"-"+val+this.$el.find(".js-measurement").val()}}},updateFromValues:function(values){if(!values.from&&values.to&&values.to.charAt(0)=="-"){var vals=this.model.parseRelativeStr(values.to);this.$(".js-val").val(vals.val.slice(1));if(vals.measurement){this.$(".js-measurement").val(vals.measurement)}return true}},render:function(verb){return _generateSearcherAndBindHandler({$el:this.$el,rawTemplate:this.template(),radioKey:this.attributes["data-date-type"]})}});var DueMoreThan=MoreThan.extend({className:"field-group",template:JIRA.Templates.DateSearcher.dueMoreThan});var DueInNext=Backbone.View.extend({className:"field-group",attributes:{"data-date-type":"dueInNext"},template:JIRA.Templates.DateSearcher.dueInNext,getValues:function(){var val=this.$el.find(".js-val").val();if(val){return{from:this.$el.find(".js-clause").val()==="andNot"?"0":null,to:val+this.$(".js-measurement").val()}}},updateFromValues:function(values){if((!values.from||values.from==="0")&&values.to){var vals=this.model.parseRelativeStr(values.to);var clause=values.from==="0"?"andNot":"orIs";this.$(".js-val").val(vals.val);this.$(".js-clause").val(clause);if(vals.measurement){this.$(".js-measurement").val(vals.measurement)}return true}},render:function(){return _generateSearcherAndBindHandler({$el:this.$el,rawTemplate:this.template(),radioKey:this.attributes["data-date-type"]})}});var DatesBetween=Backbone.View.extend({className:"field-group",attributes:{"data-date-type":"dateBetween"},template:JIRA.Templates.DateSearcher.dateBetween,getValues:function(){return{startDate:this.$el.find(".js-start-date").val(),endDate:this.$el.find(".js-end-date").val()}},updateFromValues:function(values){if(values.startDate||values.endDate){this.$el.find(".js-start-date").val(values.startDate);this.$el.find(".js-end-date").val(values.endDate);return true}},bindCalendar:function(inputClass,triggerClass){var trigger=this.$el.find("."+triggerClass)[0];var input=this.$el.find("."+inputClass)[0];var calendarParams=_.extend({},this.model.calendarConfig,{inputField:input,button:trigger});Calendar.setup(calendarParams)},render:function(){_generateSearcherAndBindHandler({$el:this.$el,rawTemplate:this.template(),radioKey:this.attributes["data-date-type"]});this.bindCalendar("js-end-date","js-end-date-trigger");this.bindCalendar("js-start-date","js-start-date-trigger");return this.$el}});var InRange=Backbone.View.extend({className:"field-group",attributes:{"data-date-type":"inRange"},template:JIRA.Templates.DateSearcher.inRange,getValues:function(){return{from:this.$el.find(".js-start-range").val(),to:this.$el.find(".js-end-range").val()}},updateFromValues:function(values){if(values.from||values.to){this.$el.find(".js-start-range").val(values.from);this.$el.find(".js-end-range").val(values.to);return true}},render:function(){return _generateSearcherAndBindHandler({$el:this.$el,rawTemplate:this.template(),radioKey:this.attributes["data-date-type"]})}});var DateSeacherModel=Backbone.Model.extend({initialize:function(options){this.from$El=options.$el.find(".js-date-picker-from").hide();this.to$El=options.$el.find(".js-date-picker-to").hide();this.startDate$El=options.$el.find(".js-date-picker-start-date").hide();this.endDate$El=options.$el.find(".js-date-picker-end-date").hide();this.errors=JIRA.parseOptionsFromFieldset(options.$el.find("fieldset.js-date-picker-errors"));this.calendarConfig=JIRA.parseOptionsFromFieldset(options.$el.find("fieldset.datepicker-params"))},parseRelativeStr:function(str){var measurement=str.slice(str.length-1);var val=str.slice(0,str.length-1);return{val:val,measurement:measurement}},update:function(updateParams){this.clear();if(updateParams){if(typeof updateParams.from!=="undefined"){this.from$El.val(updateParams.from)}if(typeof updateParams.to!=="undefined"){this.to$El.val(updateParams.to)}if(typeof updateParams.startDate!=="undefined"){this.startDate$El.val(updateParams.startDate)}if(typeof updateParams.endDate!=="undefined"){this.endDate$El.val(updateParams.endDate)}}},toJSON:function(){return{from:this.from$El.val(),to:this.to$El.val(),startDate:this.startDate$El.val(),endDate:this.endDate$El.val(),errors:this.errors}},clear:function(){this.from$El.val("");this.to$El.val("");this.startDate$El.val("");this.endDate$El.val("")}});JIRA.DateSearcher=Backbone.View.extend({initialize:function(options){var instance=this;this.verb=options.verb;this.model=new DateSeacherModel({$el:this.$el});this.setElement($("<div />").addClass("js-picker-ui").appendTo(this.$el));this.views=[];var useInputEvent=!jQuery.browser.msie||parseInt(jQuery.browser.version,10)<10;_.each(options.dateTypes,function(dateType){var view=new dateType({model:instance.model});instance.views.push(view);if(useInputEvent){view.$el.delegate(":text","input",function(){instance.update(view)})}else{view.$el.delegate(":text","keydown",function(){var $this=jQuery(this);var currentVal=$this.val();$this.one("keyup",function(){if($this.val()!==currentVal){instance.update(view)}})});view.$el.delegate(":text","change",function(){instance.update(view)})}view.$el.delegate(":radio,select,input","change",function(){instance.update(view)}).delegate(".icon-date","click",function(){instance.update(view)})})},update:function(selectedView,error){this.model.update(selectedView.getValues());_.each(this.views,function(view){if(view===selectedView){view.$(":radio").prop("checked",true)}else{view.$(":radio").prop("checked",false)}})},render:function(){var instance=this;var values=this.model.toJSON();_.each(this.views,function(view){instance.$el.append(view.render(instance.verb))});$.each(this.views,function(i,view){if(this.updateFromValues(values)){instance.update(this);if(values.errors){$.each(values.errors,function(i,error){$("<div />").addClass("error").text(error).appendTo(view.$el);return false})}return false}});window.setTimeout(function(){instance.$el.find(":radio:checked").focus()},30)}});JIRA.DateSearcher.createDueDateSearcher=function(el){return new JIRA.DateSearcher({el:el,dateTypes:[NowOverdue,DueMoreThan,DueInNext,DatesBetween,InRange]}).render()};JIRA.DateSearcher.createResolvedDateSearcher=function(el){return new JIRA.DateSearcher({el:el,dateTypes:[WithinTheLast,MoreThan,DatesBetween,InRange]}).render()};JIRA.DateSearcher.createCreatedDateSearcher=function(el){return new JIRA.DateSearcher({el:el,dateTypes:[WithinTheLast,MoreThan,DatesBetween,InRange]}).render()};JIRA.DateSearcher.createUpdatedDateSearcher=function(el){return new JIRA.DateSearcher({el:el,dateTypes:[WithinTheLast,MoreThan,DatesBetween,InRange]}).render()};JIRA.DateSearcher.createCustomDateSearcher=function(el){return new JIRA.DateSearcher({el:el,dateTypes:[WithinTheLast,MoreThan,DatesBetween,InRange]}).render()}})(AJS.$);
/* module-key = 'jira.webresources:searchers', location = '/includes/jira/searchers/initDateSearchers.js' */
jQuery(function(){function initDueDateSearcher($ctx){$ctx.find(".js-duedate-searcher").each(function(){JIRA.DateSearcher.createDueDateSearcher(this)})}function initResolvedDateSearcher($ctx){$ctx.find(".js-resolutiondate-searcher").each(function(){JIRA.DateSearcher.createResolvedDateSearcher(this)})}function initCreatedDateSearcher($ctx){$ctx.find(".js-created-searcher").each(function(){JIRA.DateSearcher.createCreatedDateSearcher(this)})}function initUpdatedDateSearcher($ctx){$ctx.find(".js-updated-searcher").each(function(){JIRA.DateSearcher.createUpdatedDateSearcher(this)})}function initCustomFieldDateSearcher($ctx){$ctx.find(".js-customdate-searcher").each(function(){JIRA.DateSearcher.createCustomDateSearcher(this)})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason===JIRA.CONTENT_ADDED_REASON.criteriaPanelRefreshed){initDueDateSearcher(context);initResolvedDateSearcher(context);initCreatedDateSearcher(context);initUpdatedDateSearcher(context);initCustomFieldDateSearcher(context)}})});
/* module-key = 'jira.webresources:searchers', location = '/includes/jira/searchers/initSparklers.js' */
jQuery(function(){function initSparklers($ctx){$ctx.find(".js-default-checkboxmultiselect").each(function(){var $select=AJS.$(this);if(!$select.data("checkboxmultiselect")){$select.data("checkboxmultiselect",new AJS.CheckboxMultiSelect({element:this}))}else{$select.data("checkboxmultiselect").render()}})}function initLabelSparkler($ctx){$ctx.find(".js-label-checkboxmultiselect").each(function(){var cms=new AJS.CheckboxMultiSelect({element:this,ajaxOptions:{url:contextPath+"/rest/api/1.0/labels/suggest",query:true,minQueryLength:0,formatResponse:function(response){var selectedValues=cms.model.getSelectedValues();return[new AJS.GroupDescriptor({items:_.map(_.sortBy(_.reject(response.suggestions,function(suggestion){return _.contains(selectedValues,suggestion.label)}),"label"),function(suggestion){return new AJS.ItemDescriptor({highlighted:true,html:suggestion.html,label:suggestion.label,value:suggestion.label,title:suggestion.label})})})]}}})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,$context,reason){if(reason===JIRA.CONTENT_ADDED_REASON.criteriaPanelRefreshed){initSparklers($context);initLabelSparkler($context)}})});
/* module-key = 'jira.webresources:searchers', location = '/includes/jira/searchers/initUserSparkler.js' */
JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,$ctx){function _formatUserGroupResponse(response){var users=_formatUserResponse(response.users,true);var groups=_formatGroupResponse(response.groups,true);var items=[].concat(users).concat(groups);return[new AJS.GroupDescriptor({items:items})]}function _formatUserResponse(response,prefix){return _.map(response.users,function(item){return new AJS.ItemDescriptor({highlighted:true,html:item.html,icon:item.avatarUrl,label:item.displayName,value:(prefix?"user:":"")+item.name})})}function _formatGroupResponse(response,prefix){return _.map(response.groups,function(item){return new AJS.ItemDescriptor({highlighted:true,html:item.html,icon:AJS.contextPath()+"/images/icons/icon_groups_16.png",label:item.name,value:(prefix?"group:":"")+item.name})})}jQuery(".js-usergroup-checkboxmultiselect",$ctx).each(function(){new AJS.CheckboxMultiSelect({element:this,maxInlineResultsDisplayed:10,content:"mixed",ajaxOptions:{url:AJS.contextPath()+"/rest/api/latest/groupuserpicker",data:{showAvatar:true},query:true,formatResponse:_formatUserGroupResponse}})});jQuery(".js-user-checkboxmultiselect",$ctx).each(function(){new AJS.CheckboxMultiSelect({element:this,maxInlineResultsDisplayed:5,content:"mixed",ajaxOptions:{url:AJS.contextPath()+"/rest/api/latest/user/picker",data:{showAvatar:true},query:true,formatResponse:function(items){return _formatUserResponse(items,false)}}})});jQuery(".js-group-checkboxmultiselect",$ctx).each(function(){new AJS.CheckboxMultiSelect({element:this,maxInlineResultsDisplayed:5,content:"mixed",ajaxOptions:{url:AJS.contextPath()+"/rest/api/latest/groups/picker",data:{showAvatar:true},query:true,formatResponse:function(items){return _formatGroupResponse(items,false)}}})})});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'util/utils.js' */
_.mixin({lambda:function(a){return function(){return a}},isNotBlank:function(a){return !!a}});if(!JIRA.Issues){JIRA.Issues={}}JIRA.bind(JIRA.Events.CHECKBOXMULITSELECT_READY,function(b,a){a.closest(".form-body").addClass("checkboxmultiselect-container")});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/templates/util.soy' */
// This file was automatically generated from util.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Issues == 'undefined') { JIRA.Templates.Issues = {}; }
if (typeof JIRA.Templates.Issues.ComponentUtil == 'undefined') { JIRA.Templates.Issues.ComponentUtil = {}; }


JIRA.Templates.Issues.ComponentUtil.throbber = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="icon throbber" />');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.simpleLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a', (opt_data.link.id) ? ' id="' + soy.$$escapeHtml(opt_data.link.id) + '"' : '', 'href="', (opt_data.link.href) ? soy.$$escapeHtml(opt_data.link.href) : '#', '"', (opt_data.link.styleClass || opt_data.additionalStyleClass) ? 'class="' + soy.$$escapeHtml(opt_data.link.styleClass) + ((opt_data.additionalStyleClass) ? ' ' + soy.$$escapeHtml(opt_data.additionalStyleClass) : '') + '"' : '', (opt_data.link.title) ? 'title="' + soy.$$escapeHtml(opt_data.link.title) + '"' : '', '><span>', soy.$$escapeHtml(opt_data.link.label), '</span></a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.issueNotFound = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("issues.components.query.search.selected.issue.nonexistent.html",opt_data.issueAnchor));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.issueAnchor = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="issue-key" href="', soy.$$escapeHtml(""), '/browse/', soy.$$escapeHtml(opt_data.issueKey), '"> ', soy.$$escapeHtml(opt_data.issueKey), ' </a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.buildMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.messages.length == 1) {
    output.append(soy.$$escapeHtml(opt_data.messages[0]));
  } else {
    output.append('<ul>');
    var messageList52 = opt_data.messages;
    var messageListLen52 = messageList52.length;
    for (var messageIndex52 = 0; messageIndex52 < messageListLen52; messageIndex52++) {
      var messageData52 = messageList52[messageIndex52];
      output.append('<li>', soy.$$escapeHtml(messageData52), '</li>');
    }
    output.append('</ul>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.auiMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.messages.length > 0) {
    output.append('<div class="aui-message ', soy.$$escapeHtml(opt_data.typeClass), '"><span class="aui-icon icon-', soy.$$escapeHtml(opt_data.typeClass), '"></span>');
    JIRA.Templates.Issues.ComponentUtil.buildMessage(opt_data, output);
    output.append('</div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.errorMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.Issues.ComponentUtil.auiMessage({typeClass: 'error', messages: opt_data.messages ? opt_data.messages : [opt_data.msg]}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.warningMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.Issues.ComponentUtil.auiMessage({typeClass: 'warning', messages: opt_data.messages ? opt_data.messages : [opt_data.msg]}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.anonymousErrorDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content"><div class="form-body"><h2 class="dialog-title">', soy.$$escapeHtml("Session Expired"), '</h2>');
  JIRA.Templates.Issues.ComponentUtil.auiMessage({typeClass: 'warning', messages: ["It looks like your session has timed out, or you have been logged out of JIRA. You will need to log back in to continue."]}, output);
  output.append('</div><div class="buttons-container form-footer"><div class="buttons"><a accesskey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="aui-button submit" href="', soy.$$escapeHtml(""), '/login.jsp?os_destination=', soy.$$escapeHtml(opt_data.redirect), '">', soy.$$escapeHtml("Log in again"), '</a><a accesskey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="aui-button aui-button-link cancel">', soy.$$escapeHtml("Ignore"), '</a></div></div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/SingleSelectMixin.js' */
AJS.namespace("JIRA.Issues.Mixin.SingleSelect");JIRA.Issues.Mixin.SingleSelect={namedAttributes:["collection"],selectById:function(a){this.setSelected(this.getCollection().get(a))},selectAt:function(a){this.setSelected(this.getCollection().at(a))},clearSelection:function(){this.setSelected()},next:function(){var d=this.getSelected(),c=this.getCollection();if(!d){if(c.length>0){this.setSelected(c.first())}}else{var b=c.indexOf(d);var a=(b+1)%c.length;this.setSelected(c.at(a))}},prev:function(){var d=this.getSelected(),c=this.getCollection();if(!d){if(c.length>0){this.setSelected(c.last())}}else{var b=c.indexOf(d);var a=(b+c.length-1)%c.length;this.setSelected(c.at(a))}}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'util/ScrollLock.js' */
(function(b){var a=30;b.fn.scrollLock=function(c,d){if(typeof c!=="string"){d=c;c=null}if(!d){d=a}this.on("DOMMouseScroll mousewheel",c,function(f){f.preventDefault();var g;if(f.originalEvent.wheelDelta){g=f.originalEvent.wheelDelta/120}if(f.originalEvent.detail){g=-f.originalEvent.detail/3}this.scrollTop-=g*d})}})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'util/CatchExceptions.js' */
(function(b){var a=function(c){return function(d){try{c.apply(this,arguments)}catch(f){}return this}};b.fn.htmlCatchExceptions=a(b.fn.html);b.fn.appendCatchExceptions=a(b.fn.append);b.fn.prependCatchExceptions=a(b.fn.prepend);b.catchExceptions=function(c){return b("<div>").htmlCatchExceptions(c).children()}})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/templates/query-basic.soy' */
// This file was automatically generated from query-basic.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNavQueryBasic == 'undefined') { JIRA.Templates.IssueNavQueryBasic = {}; }


JIRA.Templates.IssueNavQueryBasic.basicQueryView = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="search-criteria"><ul class="criteria-list"><li class="text-query hidden"><div class="text-query-container"><input class="search-entry text ajs-dirty-warning-exempt" id="searcher-query" type="text" name="text" placeholder="', soy.$$escapeHtmlAttribute("Contains text"), '" /></div></li><li class="criteria-actions"></li><li><button class="aui-button aui-button-subtle search-button" type="button" title="', soy.$$escapeHtmlAttribute("Search for issues"), '"><span class="aui-icon aui-icon-small aui-iconfont-search">', soy.$$escapeHtml("Search"), '</span></button></li><li class="switcher"></li></ul></div><div class="search-criteria-extended"><ul class="criteria-list"></ul></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQueryBasic.criteriaButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<button type="button" data-id="', soy.$$escapeHtmlAttribute(opt_data.id), '" class="criteria-selector aui-button aui-button-subtle drop-arrow" /><a href="#" class="remove-filter" title="', soy.$$escapeHtmlAttribute("Remove criterion"), '" tabindex="-1"><span class="aui-icon aui-icon-small aui-iconfont-remove"></span></a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQueryBasic.criteriaButtonContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="criteria-wrap">', (opt_data.extended || ! opt_data.viewHtml) ? '<span class="fieldLabel">' + soy.$$escapeHtml(opt_data.name) + ':</span> ' : '', (opt_data.viewHtml) ? opt_data.viewHtml : soy.$$escapeHtml("All"), '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQueryBasic.lozengeDropdownContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form id="issue-filter" action="#" class="searchfilter aui top-label aui-popup-content"><div class="form-body"></div>', (opt_data.displayBackButton) ? '<a href="#" class="back">' + soy.$$escapeHtml("Back") + '</a>' : '', (opt_data.displayUpdateCancel) ? '<div class="buttons-container form-footer"><div class="buttons"><input type="submit" name="filter" class="aui-button filter" value="' + soy.$$escapeHtmlAttribute("Update") + '" /><a href="#" class="aui-button aui-button-link cancel-update">' + soy.$$escapeHtml("Close") + '</a></div></div>' : '', '</form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQueryBasic.lozengeDropdownCannotEdit = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="searcher-no-edit-content">');
  JIRA.Templates.Issues.ComponentUtil.auiMessage({typeClass: 'info', messages: [AJS.format("To search by {0} please switch to advanced.",opt_data.fieldName)]}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQueryBasic.clauseButtonView = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<button type="button" class="add-criteria aui-button aui-button-subtle drop-arrow" title="', soy.$$escapeHtmlAttribute("Add more fields to search with"), '">', soy.$$escapeHtml("More"), '</button>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQueryBasic.searcherDropdownContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="searcher-groups available"><ul>');
  var groupList59 = opt_data.searcherGroups;
  var groupListLen59 = groupList59.length;
  for (var groupIndex59 = 0; groupIndex59 < groupListLen59; groupIndex59++) {
    var groupData59 = groupList59[groupIndex59];
    output.append('<li class="twixi-block ', (groupIndex59 == 0) ? 'expanded' : 'collapsed', '" data-id="', soy.$$escapeHtmlAttribute(groupData59.id), '"><div class="twixi-trigger">', soy.$$escapeHtml(groupData59.name), '</div><ul class="twixi-content">');
    var searcherList71 = groupData59.searchers;
    var searcherListLen71 = searcherList71.length;
    for (var searcherIndex71 = 0; searcherIndex71 < searcherListLen71; searcherIndex71++) {
      var searcherData71 = searcherList71[searcherIndex71];
      output.append('<li><a href="#" data-id="', soy.$$escapeHtmlAttribute(searcherData71.id), '" class="searcher-option" >', soy.$$escapeHtml(searcherData71.name), '</a></li>');
    }
    output.append('</ul></li>');
  }
  output.append('</ul><div class="buttons-container"><div class="buttons"><a href="#" class="aui-button aui-button-link">', soy.$$escapeHtml("Close"), '</a></div></div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/TextQueryBuilder.js' */
AJS.namespace("JIRA.Issues.TextQueryBuilder");JIRA.Issues.TextQueryBuilder={BACKSLASH_PATTERN:/\\/g,MULTIPLE_WHITESPACE_PATTERN:/\s+/g,QUOTE_PATTERN:/\"/g,DOUBLE_BACKSLASH:"\\\\",buildJql:function(a){if(!a){return""}a=""+a;a=AJS.$.trim(a);a=a.replace(this.BACKSLASH_PATTERN,this.DOUBLE_BACKSLASH);a=a.replace(this.MULTIPLE_WHITESPACE_PATTERN," ");a=a.replace(this.QUOTE_PATTERN,'\\"');return this.createQueryClause(a)},createQueryClause:function(a){return'text ~ "'+a+'"'}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/BasicQueryModule.js' */
JIRA.Issues.BasicQueryModule=JIRA.Issues.Brace.Evented.extend({namedEvents:["jqlTooComplex","searchRequested","basicModeCriteriaCountWhenSearching","verticalResize"],initialize:function(a){this._queryStateModel=a.queryStateModel;this.searcherCollection=new JIRA.Issues.SearcherCollection([],{fixedLozenges:a.primaryClauses,queryStateModel:a.queryStateModel,initData:a.initialSearcherCollectionState});this.view=new JIRA.Issues.BasicQueryView({queryStateModel:a.queryStateModel,searcherCollection:this.searcherCollection}).onVerticalResize(this.triggerVerticalResize,this);this.searcherCollection.onSearchRequested(_.bind(function(b){this.triggerBasicModeCriteriaCountWhenSearching({count:this.searcherCollection.getAllSelectedCriteriaCount()});var c=this._attachOrderByClause(b);this.triggerSearchRequested(c)},this));this.searcherCollection.onJqlTooComplex(_.bind(function(b){this.triggerJqlTooComplex(b)},this))},hasErrors:function(){var a=this.searcherCollection.any(function(b){return b.hasErrorInEditHtml()});return a},clear:function(){this.searcherCollection.clear()},queryChanged:function(){this.searcherCollection.restoreFromQuery(this._queryStateModel.getJql())},queryReset:function(a){this.searcherCollection.setInteractive(false);return this.searcherCollection.restoreFromQuery(a,true).always(_.bind(function(){this.searcherCollection.setInteractive(true)},this))},searchersReady:function(){return this.searcherCollection.searchersReady()},createView:function(){return this.view},getSelectedCriteria:function(){return this.searcherCollection.getAllSelectedCriteria()},_attachOrderByClause:function(a){var b=/\bORDER\s+BY\b.*$/i;var c=b.exec(this._queryStateModel.getJql());if(c&&b.exec(a)===null){a=a?a+" "+c[0]:c[0]}return a}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/CriteriaView.js' */
JIRA.Issues.CriteriaView=JIRA.Issues.Brace.View.extend({tagName:"li",template:JIRA.Templates.IssueNavQueryBasic.criteriaButton,contentTemplate:JIRA.Templates.IssueNavQueryBasic.criteriaButtonContent,events:{click:"hideTipsy","click .criteria-selector":"_onClickCriteriaSelector","click .remove-filter":"_onClickRemoveCriteria","mousedown .remove-filter":"_preventFocusWhileDisabled",keydown:"_onKeydown"},initialize:function(a){this.extended=a.extended;this.searcherCollection=a.searcherCollection;this.searcherCollection.onCollectionChanged(this.update,this);this.searcherCollection.onInteractiveChanged(this._handleInteractiveChanged,this);this.searcherCollection.bind("change:isSelected",this._onCriteriaSelectionChanged,this);JIRA.Issues.SearcherDialog.instance.onHide(_.bind(this._addTooltip,this));JIRA.Issues.SearcherDialog.instance.onShow(_.bind(this._onCriteriaDialogShow,this))},render:function(){this.$el.html(this.template({id:this.model.getId()}));this.$el.attr("data-id",this.model.getId());if(this.extended){this.$el.addClass("extended-searcher")}this.update();this.prepareForDisplay()},prepareForDisplay:function(){this._addTooltip();this.delegateEvents()},hideTipsy:function(){if(this.tipsy){this.tipsy.hide()}},update:function(){var g=this.searcherCollection.length===0;var f=this._getSearcher();var b=this._isValidSearcher();var e=!g&&!f;var a=g||!b;var d=this.$("button");var c=this.$(".remove-filter");this.$el.toggleClass("hidden",e);d.attr("aria-disabled",a?"true":null).html(this.contentTemplate({name:f&&f.getName()||this.model.getName(),viewHtml:f&&f.getViewHtml(),extended:this.extended}));this.$el.toggleClass("invalid-searcher",!b).toggleClass("partial-invalid-searcher",(b&&d.find(".invalid_sel").length!==0));c.toggle(!b||!!this.extended);return this},destroy:function(){this.hideTipsy();this.$el.remove()},_getSearcher:function(){return this.searcherCollection.get(this.model.getId())},_isValidSearcher:function(){var a=this._getSearcher();return !a||!(a.getValidSearcher()===false)},_containsInvalidValue:function(a){return(AJS.$(a.getViewHtml()).find(".invalid_sel").length>0)},_showDialog:function(){if(this.searcherCollection.isInteractive()&&this._getSearcher()&&this._isValidSearcher()){JIRA.Issues.SearcherDialog.instance.show(this._getSearcher())}},_removeCriteria:function(b){var a=this.extended||!this._isValidSearcher();if(this.searcherCollection.isInteractive()&&a){this.searcherCollection.triggerBeforeCriteriaRemoved(this.model.getId(),b);_.defer(_.bind(function(){this.searcherCollection.clearClause(this.model.getId())},this))}},_getTooltipText:function(){var b=this.searcherCollection.get(this.model.getId());var a;if(!this._isValidSearcher()){a="This criteria is not valid for the project and\/or issue type"}else{if(this._containsInvalidValue(b)){a="This criteria contains invalid value(s)"}else{a=b.getTooltipText()}}return b&&a||""},_addTooltip:function(){this.tipsy=new JIRA.Issues.Tipsy({el:this.$el,showCondition:this.searcherCollection.isInteractive,tipsy:{title:_.bind(this._getTooltipText,this)}})},_handleInteractiveChanged:function(a){this.$("button, .remove-filter").attr("aria-disabled",(a)?null:"true")},_onClickCriteriaSelector:function(a){if(this.searcherCollection.isInteractive()&&this._getSearcher()&&this._isValidSearcher()){JIRA.Issues.SearcherDialog.instance.toggle(this._getSearcher())}a.preventDefault()},_onClickRemoveCriteria:function(a){this._removeCriteria();a.preventDefault()},_onKeydown:function(a){switch(a.which){case AJS.$.ui.keyCode.DOWN:this._showDialog();break;case AJS.$.ui.keyCode.ESCAPE:this.$("button:focus").blur();break;case AJS.$.ui.keyCode.BACKSPACE:this._removeCriteria(-1);break;case AJS.$.ui.keyCode.DELETE:this._removeCriteria(1);break;default:return}a.preventDefault()},_onCriteriaDialogShow:function(){var a=JIRA.Issues.SearcherDialog.instance.getCurrentSearcher();if(a==this._getSearcher()){this.tipsy&&this.tipsy.remove()}},_preventFocusWhileDisabled:function(a){if(jQuery(a.target).closest("[aria-disabled=true]").length>0){a.preventDefault()}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/SearcherModel.js' */
JIRA.Issues.SearcherModel=JIRA.Issues.Brace.Model.extend({namedAttributes:["id","name","isShown","viewHtml","editHtml","groupId","groupName","initParams","isSelected","jql","position","serializedParams","validSearcher","key","lastViewed"],namedEvents:["readyForDisplay"],initialize:function(){this._onEditHtmlUpdated();this.bind("change:editHtml",this._onEditHtmlUpdated,this)},parse:function(a){if(a.viewHtml){a.viewHtml=this._cleanViewHtml(a.viewHtml)}return a},_cleanViewHtml:function(b){var a=AJS.$("<div/>").appendCatchExceptions(b);a.find(".fieldLabel").remove();a.find("a").replaceWith(function(){return AJS.$(this).html()});a.find(".searcherValue").slice(0,-1).each(function(){AJS.$(this).after("-")});a.find("*").removeAttr("title");return a.html()},createOrUpdateClauseWithQueryString:function(){return this.collection.createOrUpdateClauseWithQueryString(this.id)},getQueryString:function(){var a={};if(this.collection.QUERY_ID===this.getId()){if(this.getViewHtml()){a[this.collection.QUERY_PARAM]=this.getDisplayText();return AJS.$.param(a)}return null}if((!this.getValidSearcher()||/^\s*$/.test(this.getEditHtml()))&&this.getJql()){a={};a[this.collection.JQL_INVALID_QUERY_PREFIX+this.getId()]=this.getJql();return AJS.$.param(a)}return this.getSerializedParams()},getDisplayText:function(){var a=this.getViewHtml();var c="";if(a){var b=AJS.$("<div>").appendCatchExceptions(a);c=AJS.$.trim(b.text()).replace(/[\n\r\s]+/g," ")}return c},hasClause:function(){if(this.collection.QUERY_ID===this.getId()){return !!this.getViewHtml()}else{if(!this.getValidSearcher()){return !!this.getJql()}else{return !!this.getQueryString()}}},clearSearchState:function(){this.set({viewHtml:null,editHtml:null,jql:null,validSearcher:null,isSelected:false})},_now:Date.now||function(){return new Date().getTime()},select:function(){this.set({isSelected:true,position:this.collection.getNextPosition(),validSearcher:true,lastViewed:this._now()})},retrieveEditHtml:function(){var a=this.collection.createJql();if(this.getEditHtml()){return jQuery.Deferred().resolve(this.getEditHtml())}return JIRA.SmartAjax.makeRequest({type:"POST",url:contextPath+"/secure/QueryComponentRendererEdit!Default.jspa",success:_.bind(this.setEditHtml,this),dataType:"html",error:JIRA.Issues.displayFailSearchMessage,data:{fieldId:this.getId(),decorator:"none",jqlContext:a}})},hasErrorInEditHtml:function(){var a=jQuery("<div>").htmlCatchExceptions(this.getEditHtml());if(!a){return false}else{return a.find(".error, .has-errors").length>0}},clearEditHtml:function(){this.setEditHtml(null)},_onEditHtmlUpdated:function(){this.setSerializedParams(jQuery("<form/>").appendCatchExceptions(this.getEditHtml()).serialize())},getTooltipText:function(){if(this.getValidSearcher!==false){var a=this.getDisplayText()||"All";return this.getName()+": "+a}else{return "This criteria is not valid for the project and\/or issue type"}},searchersReady:function(){return this.collection.searchersReady()}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/SearcherCollection.js' */
JIRA.Issues.SearcherCollection=JIRA.Issues.Brace.Collection.extend({model:JIRA.Issues.SearcherModel,namedEvents:["searchRequested","collectionChanged","jqlTooComplex","textFieldChanged","requestUpdateFromView","interactiveChanged","beforeCriteriaRemoved"],QUERY_PARAM:"text",QUERY_ID:"text",JQL_INVALID_QUERY_PREFIX:"__jql_",initialize:function(b,a){_.bindAll(this);if(b&&b.length){this._searcherCache=b}this.fixedLozenges=a&&a.fixedLozenges?a.fixedLozenges:[];this.queryStateModel=a&&a.queryStateModel;this.initData=a&&a.initData;this._interactive=true},_createItemDescriptors:function(a){return _.map(a,function(b){return new AJS.ItemDescriptor({meta:{isShown:b.isShown},label:b.name,title:b.isShown?b.name:b.name+" "+"is not applicable for the current project and\/or issue type.",selected:b.isSelected||b.jql,value:b.id})})},getAddMenuGroupDescriptors:function(){this._updateSearcherCache();var d=this.fixedLozengeIds().concat(this.QUERY_ID);var a=_.filter(this._searcherCache,function(e){var g=_.contains(d,e.id);var f=!!e.groupName;return !g&&f});if(a.length){var b=new AJS.GroupDescriptor({label:"All Criteria",items:this._createItemDescriptors(_.sortBy(a,function(e){return e.name.toLowerCase()}))});var c=new AJS.GroupDescriptor({label:"Recent Criteria",items:this._createItemDescriptors(_.first(_.sortBy(_.filter(a,function(e){return e.lastViewed}),function(e){return -e.lastViewed}),AJS.Meta.getNumber("max-recent-searchers")))});return[c,b]}else{return[]}},getSearcher:function(b){var a=this.get(b);if(!a){this.add(this._searcherCache[b]);a=this.get(b)}return a},setJql:function(b,a){this._addOrSet(b,{jql:a})},createJql:function(){var a=this.pluck("jql");return _.filter(a,_.isNotBlank).join(" AND ")||""},isDirty:function(){return this.any(function(a){return a.getJql()!==undefined&&a.getJql()!==""})},clearSearchState:function(){this.each(function(a){a.clearSearchState()});this._querySearchersAndValues("")},clearClause:function(c){var b=this.get(c);var a=b&&b.hasClause();if(b){b.clearSearchState()}this.triggerCollectionChanged();this.triggerRequestUpdateFromView();if(a){this.triggerSearchRequested(this.createJql())}},getTextQuery:function(){var a=this.get(this.QUERY_ID);return a?a.getViewHtml():""},setInteractive:function(a){if(a!==this._interactive){this._interactive=a;this.triggerInteractiveChanged(a)}},isInteractive:function(){return this._interactive},handleBasicViewSubmit:function(){this.triggerRequestUpdateFromView();this.triggerSearchRequested(this.createJql())},updateTextQuery:function(a){if(a){var b=AJS.escapeHtml(a);this._addOrSet(this.QUERY_ID,{viewHtml:b,editHtml:b,jql:JIRA.Issues.TextQueryBuilder.buildJql(a)})}else{this.remove(this.QUERY_ID)}this.triggerTextFieldChanged()},getQueryString:function(){var a=[];this.each(function(c){var b=c.getQueryString();if(b){a.push(b)}});return a.join("&")},_addOrSet:function(e,d,b){var a=this.get(e);if(a){if(b&&b.parse&&a.parse){d=a.parse(d);delete b.parse}if(d.jql){d.isSelected=true}a.set(d,b)}else{var c=_.clone(d);c.id=e;c.isSelected=!!d.jql;this.add(c,b);a=this.get(e)}return a},restoreFromQuery:function(a,d){this.queryStateModel.setJql(a);var c={jql:this.queryStateModel.getJql()||"",decorator:"none"};this.initData=false;if(this.initData){if(!this.initData.errorMessages){this._onQuerySearchersAndValues(this.initData);this.initData=null;return jQuery.Deferred().resolve()}else{this._handleSearcherError(c.jql,this.initData);this.initData=null;return jQuery.Deferred().reject()}}else{var b=AJS.$.ajax({url:AJS.contextPath()+"/secure/QueryComponent!Jql.jspa",headers:{"X-SITEMESH-OFF":true},data:c,type:"POST"});b.success(_.bind(function(e){if(d){this.clearExpectingUpdate(d)}this._onQuerySearchersAndValues(e)},this));b.error(_.bind(function(h){if(d){this.clearExpectingUpdate()}try{var f=JSON.parse(h.responseText);if(f){this._handleSearcherError(c.jql,f)}}catch(g){console.log("search response error - not JSON?")}},this));b.always(function(){JIRA.trace("jira.search.searchers.updated")});return b}},clearExpectingUpdate:function(){this.reset();this.updateTextQuery("")},_handleSearcherError:function(a,b){if(_.include(b.errorMessages,"jqlTooComplex")||_.include(b.errorMessages,"jqlInvalid")){window.setTimeout(_.bind(function(){this.triggerJqlTooComplex(a)},this),0)}},searcherAffectsContext:function(a){return"project"===a||"issuetype"===a},createOrUpdateClauseWithQueryString:function(b){this.triggerRequestUpdateFromView();var a;if(this.searcherAffectsContext(b)){a=this._querySearchersAndValues(this.getQueryString())}else{a=this._querySearchersByValue(b)}a.done(_.bind(function(){if(!this.containsInvalidSearchers()){this.triggerSearchRequested(this.createJql())}},this));return a},containsInvalidSearchers:function(){return this.any(function(a){return a.hasErrorInEditHtml()})},_querySearchersByValue:function(d){var a=this.get(d);var c=AJS.$.param({decorator:"none",jqlContext:this.queryStateModel.getJql()});if(a){var b=a.getQueryString();if(b){c=c+"&"+b}}if(this._activeSearcherReq){this._activeSearcherReq.abort()}return this._activeSearcherReq=JIRA.SmartAjax.makeRequest({type:"POST",data:c,processData:false,url:contextPath+"/secure/QueryComponentRendererValue!Default.jspa",success:_.bind(function(f){var e=this.get(d);if(e){if(f[d]){f[d].groupName=e.getGroupName();f[d].groupId=e.getGroupId()}else{f[d]=_.extend(e.toJSON(),{editHtml:null,jql:null,viewHtml:null})}}this._setSearchersFromData(f,true)},this),dataType:"json",error:function(e){JIRA.Issues.displayFailSearchMessage(e)}}).always(_.bind(function(){this._activeSearcherReq=null},this))},_parseSearcherGroups:function(c){var a={};var b=this.queryStateModel.getWithout();_.each(c.groups,function(d){_.each(d.searchers,function(e){if(!_.contains(b,e.id)){e.groupId=d.type;e.groupName=d.title;a[e.id]=e}})});return a},_querySearchersAndValues:function(b){var a="decorator=none";if(this._activeSearcherReq){if(this._activeSearcherQuery===b){return jQuery.Deferred().reject()}this._activeSearcherReq.abort()}this._activeSearcherQuery=b;if(b){a+="&"+b}this._activeSearcherReq=AJS.$.ajax({url:contextPath+"/secure/QueryComponent!Default.jspa",headers:{"X-SITEMESH-OFF":true},type:"POST",data:a,processData:false});this._activeSearcherReq.done(_.bind(function(c){this._onQuerySearchersAndValues(c)},this));this._activeSearcherReq.fail(_.bind(function(c){JIRA.Issues.displayFailSearchMessage(c)},this));this._activeSearcherReq.always(_.bind(function(){this._activeSearcherReq=null},this));return this._activeSearcherReq},clear:function(){this.reset([],{silent:true});this.updateTextQuery("");this.triggerCollectionChanged()},searchersReady:function(){if(this._activeSearcherReq){return this._activeSearcherReq}else{return jQuery.Deferred().resolve()}},_onQuerySearchersAndValues:function(c){var d=this,a=this._parseSearcherGroups(c.searchers);_.each(c.values,_.bind(function(f,g){var e=a[g];if(!e){a[g]=f}else{_.extend(e,f)}},this));var b=[];this.each(function(f){var e=f.id;if(!_.any(a,function(g){return g.id===e})){if(f.getIsSelected()){f.setValidSearcher(false)}else{b.push(f)}}});if(b.length){this.remove(b)}this._setSearchersFromData(a)},_updateSearcherCache:function(){if(this._searcherCache){this.each(_.bind(function(a){this._searcherCache[a.id]=a.toJSON();this._searcherCache[a.id].id=a.id},this))}},_setSearchersFromData:function(a,b){_.each(a,_.bind(function(c,d){this._addOrSet(d,{groupId:c.groupId,groupName:c.groupName,isShown:c.isShown,name:c.name,viewHtml:c.viewHtml,jql:c.jql,editHtml:c.editHtml,validSearcher:c.validSearcher,key:c.key,lastViewed:c.lastViewed},{parse:true})},this));if(b){this._updateSearcherCache()}else{this._searcherCache=a}this.triggerCollectionChanged();JIRA.trace("jira.search.searchers.updated")},getVariableClauses:function(){var a=[];this.each(_.bind(function(b){if(!this.isFixed(b)&&b.hasClause()){a.push(b)}},this));return a},getSelectedCriteria:function(){var a=this;var b=function(c){return !a.isFixed(c)&&(c.hasClause()||c.getIsSelected())};return this.chain().filter(b).sortBy(function(c){return c.getPosition()}).value()},getAllSelectedCriteriaCount:function(){return this.getAllSelectedCriteria().length},getAllSelectedCriteria:function(){var a=[];this.each(_.bind(function(b){if(b.hasClause()||b.getIsSelected()){a.push(b)}},this));return a},isFixed:function(a){return _.contains(this.fixedLozengeIds(),a.getId())||a.getId()===this.QUERY_ID},fixedLozengeIds:function(){return _.pluck(this.fixedLozenges,"id")},getNextPosition:function(){return this.reduce(function(b,c){var a=Math.max(b,c.getPosition());return isNaN(a)?b:a},-1)+1}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/CriteriaModel.js' */
JIRA.Issues.CriteriaModel=JIRA.Issues.Brace.Model.extend({namedAttributes:["id","name"]});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/CardView.js' */
AJS.namespace("JIRA.Issues.CardView");JIRA.Issues.CardView=JIRA.Issues.Brace.View.extend({namedEvents:["viewChanged"],initialize:function(a){_.bindAll(this);this.views=a.views;if(a.activeView){this.activeView=a.activeView}else{var b=_.keys(this.views);if(b.length>0){this.activeView=b[0]}}},render:function(){this._renderActiveView()},changeToView:function(a){if(a===this.activeView){return}this.activeView=a;if(this.$el){this._renderActiveView(a)}this.triggerViewChanged(a)},_renderActiveView:function(){var a=this.views[this.activeView];a.setElement(this.$el);a.render()}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/BasicQueryView.js' */
JIRA.Issues.BasicQueryView=JIRA.Issues.Brace.View.extend({namedEvents:["verticalResize"],template:JIRA.Templates.IssueNavQueryBasic.basicQueryView,initialize:function(a){this.searcherCollection=a.searcherCollection;this.queryStateModel=a.queryStateModel;this.textFieldView=new JIRA.Issues.TextFieldView({collection:this.searcherCollection});this.primaryCriteriaContainerView=new JIRA.Issues.PrimaryCriteriaContainerView({collection:this.searcherCollection});this.extendedCriteriaContainerView=new JIRA.Issues.ExtendedCriteriaContainerView({collection:this.searcherCollection}).onVerticalResize(this.triggerVerticalResize,this);this.clauseButtonView=new JIRA.Issues.ClauseButtonView({searcherCollection:this.searcherCollection});this.searcherCollection.onInteractiveChanged(this._handleInteractiveChanged,this);this.searcherCollection.onBeforeCriteriaRemoved(this._handleBeforeCriteriaRemoved,this)},_handleInteractiveChanged:function(a){this.$el.toggleClass("loading",!a)},_handleBeforeCriteriaRemoved:function(b,a){if(a){this._shiftFocus(b,a)}},hasPdl:function(){var a=AJS.Meta.get("version-number");if(a){return parseInt(a.charAt(0),10)>=6}},render:function(){this.$el.html(this.template({hasPdl:this.hasPdl()}));this.primaryCriteriaContainerView.setElement(this.$el.find(".search-criteria .criteria-list"));this.textFieldView.setElement(this.$el.find("input.search-entry"));this.clauseButtonView.setElement(this.$el.find(".criteria-actions"));this.extendedCriteriaContainerView.setElement(this.$el.find(".search-criteria-extended .criteria-list"));this.primaryCriteriaContainerView.render();this.$el.find(".text-query").removeClass("hidden");this.textFieldView.render();this.clauseButtonView.render();this.extendedCriteriaContainerView.render();this._handleInteractiveChanged(this.searcherCollection.isInteractive());this.triggerVerticalResize();new JIRA.Issues.Tipsy({el:this.$el.find(".search-button"),tipsy:{trigger:"hover",delayIn:300}});return this},search:function(){this.searcherCollection.handleBasicViewSubmit()},_shiftFocus:function(b,f){var e=this.primaryCriteriaContainerView.getFocusableForCriteria(b);if(!e.length){e=this.extendedCriteriaContainerView.getFocusableForCriteria(b)}var d=this.primaryCriteriaContainerView.getFocusables().add(this.extendedCriteriaContainerView.getFocusables());var c=d.index(e);var a;if(c===0){a=1}else{if(c===d.length-1){a=d.length-2}else{a=c+f}}d.eq(a).focus()},focus:function(){this.primaryCriteriaContainerView.getFocusables().first().focus()}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/TextFieldView.js' */
AJS.namespace("JIRA.Issues.TextFieldView");JIRA.Issues.TextFieldView=JIRA.Issues.Brace.View.extend({namedEvents:["searchRequested"],events:{keypress:"handleKeypress"},initialize:function(){_.bindAll(this);this.collection.on("remove change add",_.bind(function(a){if(a.getId()===this.collection.QUERY_ID){this.render()}},this));this.collection.onTextFieldChanged(this.render);this.collection.onRequestUpdateFromView(this._updateSearcherCollectionTextField);this.collection.onInteractiveChanged(this._handleInteractiveChanged)},handleKeypress:function(a){if(a.keyCode===13){this.collection.handleBasicViewSubmit();a.preventDefault()}},render:function(){var a=this.collection.get(this.collection.QUERY_ID);if(a){var c=a.getEditHtml();var b=AJS.$("<div></div>").html(c||"").text();this.setQuery(b)}else{this.setQuery("")}},setQuery:function(a){this.$el.val(a)},_updateSearcherCollectionTextField:function(){if(this.$el.is("input")){var a=AJS.$.trim(this.$el.val());this.collection.updateTextQuery(a)}},_handleInteractiveChanged:function(a){this.$el.prop("disabled",!a)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/PrimaryCriteriaContainerView.js' */
JIRA.Issues.PrimaryCriteriaContainerView=JIRA.Issues.Brace.View.extend({initialize:function(){this._criteriaViews=_.map(this.collection.fixedLozenges,function(a){return new JIRA.Issues.CriteriaView({model:new JIRA.Issues.CriteriaModel(a),searcherCollection:this.collection})},this)},render:function(){_.each(this._criteriaViews,function(a){a.render()});this.$el.prepend(_.pluck(this._criteriaViews,"el"))},getCriteriaViews:function(){return this._criteriaViews},getFocusables:function(){return this.$(".criteria-selector, #searcher-query, .add-criteria, .search-button")},getFocusableForCriteria:function(a){return this.$('.criteria-selector[data-id="'+a+'"]')}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/ExtendedCriteriaContainerView.js' */
JIRA.Issues.ExtendedCriteriaContainerView=JIRA.Issues.Brace.View.extend({namedEvents:["verticalResize"],initialize:function(a){this.collection.on("change:isSelected",this._onCriteriaSelectionChanged,this);this.collection.on("add",this._onCriteriaSelectionChanged,this);this.collection.on("remove",this._removeViewForSearcher,this);this.collection.on("reset",this._onReset,this);this._criteriaViews=_.map(this.collection.getSelectedCriteria(),_.bind(function(b){if(b.getPosition()==null){b.setPosition(this.collection.getNextPosition())}return this._buildCriteriaViewForSearcher(b)},this))},render:function(){_.each(this._criteriaViews,_.bind(function(a){a.render();this.$el.append(a.$el)},this))},getFocusables:function(){return this.$(".criteria-selector")},getFocusableForCriteria:function(a){return this.$('.criteria-selector[data-id="'+a+'"]')},_buildCriteriaViewForSearcher:function(a){return new JIRA.Issues.CriteriaView({model:new JIRA.Issues.CriteriaModel({id:a.get("id"),name:a.get("name")}),searcherCollection:this.collection,extended:true})},_onCriteriaSelectionChanged:function(a){if(a.getIsSelected()&&!this.collection.isFixed(a)){this._addViewForSearcher(a)}else{this._removeViewForSearcher(a)}},_addViewForSearcher:function(b){var a=this._buildCriteriaViewForSearcher(b);a.render();this.$el.append(a.$el);this._criteriaViews.push(a);this.triggerVerticalResize()},_removeViewForSearcher:function(a){this._criteriaViews=_.reject(this._criteriaViews,function(b){if(b.model.getId()===a.getId()){b.destroy();return true}return false});this.triggerVerticalResize()},_onReset:function(){_.each(this._criteriaViews,function(a){a.destroy()});this._criteriaViews=[]}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/SearcherGroupListDialogView.js' */
(function(){var a;JIRA.Issues.SearcherGroupListDialogView=JIRA.Issues.Brace.View.extend({template:JIRA.Templates.IssueNavQueryBasic.searcherDropdownContent,namedEvents:["searcherSelected","hideRequested"],events:{keydown:"_keyPressed"},initialize:function(b){this.searcherCollection=b.searcherCollection;this.$el.scrollLock(".aui-list-scroll")},render:function(){var f=this.searcherCollection.getAddMenuGroupDescriptors(),e=f.length&&f[0].properties.items.length>JIRA.Issues.SearcherGroupListDialogView.CRITERIA_DISPLAY_LIMIT;var c=jQuery(AJS.Templates.queryableSelect({descriptors:f,id:"criteria"}));this.$el.empty().append(c);var d={element:c,suggestionsHandler:JIRA.Issues.SearcherGroupListDialogView.SuggestHandler,hideFooterButtons:true};var h="...excluding \u003cspan class=hidden-no>\u003c\/span> hidden",g="These criteria are hidden because they are not applicable to the current project and\/or issue type";if(e){d.maxInlineResultsDisplayed=JIRA.Issues.SearcherGroupListDialogView.CRITERIA_DISPLAY_LIMIT;h="...excluding \u003cspan class=hidden-no>\u003c\/span> hidden. Please enter a keyword to refine.";g="These criteria are hidden because there are either too many to display or they are not applicable to the current project and\/or issue type"}var b=new AJS.CheckboxMultiSelect(d);a=jQuery("<div class='more-criteria-footer' />").html(h);this.$el.append(a);new JIRA.Issues.Tipsy({el:a,tipsy:{title:function(){return g},className:"tipsy-front"}});this.$el.unbind("selected").bind("selected",_.bind(this._searcherSelected,this));this.$el.unbind("unselect").bind("unselect",_.bind(this._searcherUnselected,this));return this.$el},_searcherUnselected:function(c,b){this.searcherCollection.clearClause(b.properties.value)},_searcherSelected:function(d,c){var b=this.searcherCollection.getSearcher(c.properties.value);b.select();JIRA.Issues.SearcherDialog.instance.hide();JIRA.Issues.SearcherDialog.instance.show(b)},_keyPressed:function(f){if(f.keyCode===AJS.$.ui.keyCode.TAB){var b=AJS.$(":tabbable",this.$el);var c=(b.length===0);var e=(f.shiftKey&&(document.activeElement===b.first()[0]));var d=(!f.shiftKey&&(document.activeElement===b.last()[0]));if(c||e||d){this.triggerHideRequested(AJS.HIDE_REASON.tabbedOut);f.preventDefault()}}}},{CRITERIA_DISPLAY_LIMIT:100});JIRA.Issues.SearcherGroupListDialogView.SuggestHandler=AJS.CheckboxMultiSelectSuggestHandler.extend({formatSuggestions:function(b,c){var e=0,d=AJS.SuggestHelper.removeDuplicates(this.model.getDisplayableSelectedDescriptors());b.splice(0,0,new AJS.GroupDescriptor({actionBarHtml:d.length>1?this.createClearAll():null,items:d,styleClass:"selected-group"}));_.each(b,function(g){if(c.length===0){var f=_.filter(g.items(),function(i,h){var j=i.meta();return j&&j.isShown&&h<JIRA.Issues.SearcherGroupListDialogView.CRITERIA_DISPLAY_LIMIT});e+=g.items().length-f.length;g.items(f)}else{_.each(g.items(),function(h){var i=h.meta();h.disabled(!(i&&i.isShown))})}});_.defer(function(){if(a){if(e){a.show().find(".hidden-no").text(e)}else{a.hide()}}});return b}})})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/SearcherEditDialogView.js' */
JIRA.Issues.SearcherEditDialogView=JIRA.Issues.Brace.View.extend({namedEvents:["backRequested","hideRequested"],autoUpdate:[".js-default-checkboxmultiselect",".js-default-checkboxmultiselectstatuslozenge",".js-user-checkboxmultiselect",".js-usergroup-checkboxmultiselect",".js-group-checkboxmultiselect",".js-label-checkboxmultiselect"],events:function(){var a={"click .cancel-update":"_onCancelClicked",click:"_stopPropagation",submit:"_onSubmit",keydown:"_keyPressed"};if(this.queryStateModel.getBasicAutoUpdate()){a["selected "+this.autoUpdate.join(",")]="applyChanges";a["unselect "+this.autoUpdate.join(",")]="applyChanges"}return a},template:JIRA.Templates.IssueNavQueryBasic.lozengeDropdownContent,initialize:function(a){this._formData="";this.queryStateModel=a.queryStateModel;this.$el.scrollLock(".aui-list-scroll")},renderDeferred:function(){var a=jQuery.Deferred();this.model.retrieveEditHtml().done(_.bind(function(b){a.resolve(this.render(b))},this));return a.promise()},hasAutoUpdate:function(a){return this.queryStateModel.getBasicAutoUpdate()&&jQuery(a).find(this.autoUpdate.join(",")).length!==0},render:function(b){var a=!(/^\s*$/.test(b));var c;if(a){c=AJS.$(this.template({displayBackButton:this.displayBackButton,displayUpdateCancel:!this.hasAutoUpdate(b)&&!jQuery(b).hasClass("searchfilter-not-found")}))}else{c=AJS.$(JIRA.Templates.IssueNavQueryBasic.lozengeDropdownCannotEdit({fieldName:this.model.getName()}))}this.$el.html(c);this.$el.find(".form-body").appendCatchExceptions(b);this.$el.find("form").addClass(this.model.id+"-criteria");this.$el.find("label:first").remove();JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.criteriaPanelRefreshed]);this._formData=this.$el.find("form").serialize();this.model.setInitParams(this._formData);return this.$el},_stopPropagation:function(a){a.stopPropagation()},_preventDefault:function(a){a.preventDefault()},applyFilter:function(){var b=this.$el.find("form").serialize();var a=(b!==this._formData);this._formData=b;this.model.setSerializedParams(this._formData);return a},applyChanges:function(){if(this.applyFilter()){this.model.createOrUpdateClauseWithQueryString()}},_onCancelClicked:function(a){a.preventDefault();this.triggerHideRequested(AJS.HIDE_REASON.cancelClicked)},_onSubmit:function(a){a.preventDefault();this.triggerHideRequested(AJS.HIDE_REASON.submit)},_keyPressed:function(e){if(e.keyCode===AJS.$.ui.keyCode.TAB){var a=AJS.$(":tabbable",this.$el);var b=(a.length===0);var d=(e.shiftKey&&(document.activeElement===a.first()[0]));var c=(!e.shiftKey&&(document.activeElement===a.last()[0]));if(b||d||c){this.triggerHideRequested(AJS.HIDE_REASON.tabbedOut);e.preventDefault()}}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/ClauseListDialogView.js' */
AJS.namespace("JIRA.Issues.ClauseListDialogView");JIRA.Issues.ClauseListDialogView=JIRA.Issues.Brace.View.extend({events:{"click .clauses .searcherValue":"_clauseSelected","click .remove-filter":"_removeFilterRequested"},template:JIRA.Templates.IssueNavQueryBasic.enabledClauses,namedEvents:["clauseSelected","hideRequested"],initialize:function(a){_.bindAll(this);this.searcherCollection=a.searcherCollection;this.searcherCollection.onCollectionChanged(this._renderAndCheckForClose)},render:function(){this.$el.html(this.template({clauses:this._getClauses()}))},_renderAndCheckForClose:function(){this.render();if(!this._getClauses().length){this.triggerHideRequested()}},_clauseSelected:function(b){b.preventDefault();var a=AJS.$(b.target),c=a.parents("li").first().data("id");this.triggerClauseSelected(c)},_removeFilterRequested:function(b){b.preventDefault();var a=this;_.defer(function(){var c=AJS.$(b.target),e=c.parents("li").first();var d=e.data("id");a.searcherCollection.clearClause(d);e.remove();a.triggerHideRequested()})},_getClauses:function(){var b=this.searcherCollection.getVariableClauses();var a=_.map(b,function(c){return c.toJSON()});_.each(a,this._formatForTemplate);return a},_formatForTemplate:function(a){if(a.validSearcher){a.invalidMessage=""}else{a.invalidMessage="This criteria is not valid for the project and\/or issue type"}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/ClauseButtonView.js' */
JIRA.Issues.ClauseButtonView=JIRA.Issues.Brace.View.extend({template:JIRA.Templates.IssueNavQueryBasic.clauseButtonView,addCriteriaButton:".add-criteria",events:{"click .add-criteria":"_showDialog","keydown .add-criteria":"_onKeydown"},initialize:function(c){_.bindAll(this);var a=this;this.searcherCollection=c.searcherCollection;this.searcherCollection.onCollectionChanged(this._showOrHideClauseButtons);this.searcherCollection.onInteractiveChanged(this._handleInteractiveChanged);var d=this.dialog=new AJS.InlineLayer({width:"auto",alignment:AJS.LEFT,offsetTarget:function(){return a.$el.find(a.addCriteriaButton)},content:function(){return b.render()}});d.bind(AJS.InlineLayer.EVENTS.hide,function(h,f,g){if(g===AJS.HIDE_REASON.escPressed||g===AJS.HIDE_REASON.toggle||g==AJS.HIDE_REASON.tabbedOut){a.$(a.addCriteriaButton).focus()}});var b=new JIRA.Issues.SearcherGroupListDialogView({searcherCollection:this.searcherCollection,dialog:d});b.onHideRequested(function(e){d.hide(e)});d.bind(AJS.InlineLayer.EVENTS.show,function(f,e){jQuery("#criteria-input").focus();e.find(".aui-list-scroll").scrollTop(0)})},render:function(){this.$el.html(this.template());this._showOrHideClauseButtons();this._addToolTip();return this.$el},_addToolTip:function(){new JIRA.Issues.Tipsy({el:this.$el.find(this.addCriteriaButton),showCondition:":not(.active)"})},_showOrHideClauseButtons:function(){var a=this.$(this.addCriteriaButton);if(this.searcherCollection.getAddMenuGroupDescriptors().length>0){a.show()}else{a.hide()}},_showDialog:function(a){if(this.searcherCollection.isInteractive()){this.dialog.toggle()}a.preventDefault()},_handleInteractiveChanged:function(a){this.$(this.addCriteriaButton).attr("aria-disabled",(a)?null:"true")},_onKeydown:function(a){switch(a.which){case AJS.$.ui.keyCode.DOWN:this._showDialog(a);break;case AJS.$.ui.keyCode.ESCAPE:jQuery(a.target).blur();break;case AJS.$.ui.keyCode.BACKSPACE:break;default:return}a.preventDefault()}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/SearcherDialog.js' */
JIRA.Issues.SearcherDialog=function(){return{initialize:function(b){if(!this.instance){this.instance=a(b)}}};function a(b){AJS.HIDE_REASON.switchLozenge="switchLozenge";var f=[AJS.HIDE_REASON.escPressed,AJS.HIDE_REASON.toggle,AJS.HIDE_REASON.cancelClicked,AJS.HIDE_REASON.submit,AJS.HIDE_REASON.tabbedOut];function e(i){return i?jQuery(".criteria-selector[data-id='"+i.getId()+"']"):jQuery()}var h;var d;var c;var g=new AJS.InlineLayer({width:"auto",alignment:AJS.LEFT,offsetTarget:function(){return e(d)},content:function(){c=new JIRA.Issues.SearcherEditDialogView({model:d,queryStateModel:b.queryStateModel});c.onHideRequested(function(i){g.hide(i)});return c.renderDeferred()}});g.bind(AJS.InlineLayer.EVENTS.show,function(k,i){var j=i.find(":input:not(submit):visible:first");j.focus();if((AJS.$.browser.msie&&parseInt(AJS.$.browser.version,10)<9)){j.focus()}i.find(".aui-list-scroll").scrollTop(0)});g.bind(AJS.InlineLayer.EVENTS.beforeHide,function(l,j,k,m,i){if(k===AJS.HIDE_REASON.clickOutside&&i&&jQuery(i).closest(".calendar").length){l.preventDefault()}});g.bind(AJS.InlineLayer.EVENTS.hide,function(l,i,k){var j=d;if(_.contains(f,k)){e(j).focus()}if(k!==AJS.HIDE_REASON.cancelClicked&&k!==AJS.HIDE_REASON.escPressed&&k!==AJS.HIDE_REASON.tabbedOut){if(c.applyFilter()){h=d.createOrUpdateClauseWithQueryString();h.done(function(){if(j.hasErrorInEditHtml()){if(b.queryStateModel.getSearchMode()==="basic"){JIRA.Issues.SearcherDialog.instance.show(j)}}if(AJS.InlineLayer.current){AJS.InlineLayer.current.setPosition()}});h.always(function(){h=null});j.clearEditHtml()}}else{JIRA.trace("jira.search.searchers.hiddenWithoutUpdate")}c.$el.remove();c=null;d=null});b.queryStateModel.on("change:searchMode",function(){g.hide()});return{getCurrentSearcher:function(){return d},toggle:function(i){if(d!=null){if(d!==i){g.hide(AJS.HIDE_REASON.switchLozenge);this.show(i)}else{g.hide(AJS.HIDE_REASON.toggle)}}else{this.show(i)}},_show:function(i){_.defer(function(){d=i;g.show();g.setPosition()})},show:function(k){var j;if(JIRA.Issues.SearcherDialog.waitingToShow){j=true}var i=this;JIRA.Issues.SearcherDialog.waitingToShow=function(){i._show(k);JIRA.Issues.SearcherDialog.waitingToShow=null};if(!j){k.searchersReady().done(function(){if(h){h.done(function(){JIRA.Issues.SearcherDialog.waitingToShow()})}else{JIRA.Issues.SearcherDialog.waitingToShow()}})}},onShow:function(i){g.bind(AJS.InlineLayer.EVENTS.show,i)},hide:function(){g.hide()},onHide:function(i){g.bind(AJS.InlineLayer.EVENTS.hide,i)}}}}();
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/templates/query-jql.soy' */
// This file was automatically generated from query-jql.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNavQueryJql == 'undefined') { JIRA.Templates.IssueNavQueryJql = {}; }


JIRA.Templates.IssueNavQueryJql.jqlQueryView = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="advanced-search-container"><div class="aui-group"><div class="aui-item atlassian-autocomplete"><label for="advanced-search"><span id="jqlerrormsg" class="icon jqlgood"><span>', soy.$$escapeHtml("parse"), '</span></span> <span class="jql-label">', soy.$$escapeHtml("Query"), ' <span id="jqlcolrowcount">', soy.$$escapeHtml("line"), ':<span id="jqlrownum">0</span>', soy.$$escapeHtml("character"), ':<span id="jqlcolumnnum">0</span></span></span></label><textarea id="advanced-search" class="search-entry advanced-search ajs-dirty-warning-exempt" name="jql" maxlength="2000"></textarea></div><div class="aui-item search-button-container"><button class="aui-item aui-button aui-button-subtle search-button" type="button" title="', soy.$$escapeHtml("Search for issues"), '"><span class="aui-icon aui-icon-small aui-iconfont-search">', soy.$$escapeHtml("Search"), '</span></button><span class="switcher"></span></div></div><a class="syntax-help" href="', soy.$$escapeHtml(opt_data.helpUrl), '" title="', soy.$$escapeHtml("Syntax Help"), '" target="_jirahelp" tabindex="-1"><span class="aui-icon aui-icon-small aui-iconfont-help">', soy.$$escapeHtml("Syntax Help"), '</span></a></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/jql/JqlAutoCompleteView.js' */
JIRA.Issues.JQLAutoCompleteView=JIRA.Issues.Brace.View.extend({namedEvents:["jqlValid","jqlInvalid","searchRequested"],events:{focus:"_onFocus"},getJqlAutoCompleteData:function(){var b=jQuery.Deferred();if(this.jqlFieldNames==null||this.jqlFunctionNames==null||this.jqlReservedWords==null){var c=jQuery("#jqlFieldz");var d=jQuery("#jqlFunctionNamez");var a=jQuery("#jqlReservedWordz");if(c.length>0&&d.length>0&&a.length>0){this.jqlFieldNames=JSON.parse(c.text());this.jqlFunctionNames=JSON.parse(d.text());this.jqlReservedWords=JSON.parse(a.text())}else{AJS.$.ajax({url:AJS.contextPath()+"/rest/querycomponent/latest/jqlAutoComplete"}).done(_.bind(function(f){var e=JSON.parse(f);this.jqlFieldNames=_.reject(JSON.parse(e.jqlFieldz),_.bind(function(g){return _.contains(this.model.getWithout(),g.value)},this));this.jqlFunctionNames=JSON.parse(e.jqlFunctionNamez);this.jqlReservedWords=JSON.parse(e.jqlReservedWordz);b.resolve()},this));return b.promise()}}return b.resolve().promise()},_initJQLAutoComplete:function(){var d=this.$el;var b=JIRA.JQLAutoComplete({fieldID:d.attr("id"),parser:JIRA.JQLAutoComplete.MyParser(this.jqlReservedWords),queryDelay:0.65,jqlFieldNames:this.jqlFieldNames,jqlFunctionNames:this.jqlFunctionNames,minQueryLength:0,allowArrowCarousel:true,autoSelectFirst:false,errorID:"jqlerrormsg"});var a=this;d.keypress(function(e){if(b.dropdownController===null||!b.dropdownController.displayed||b.selectedIndex<0){if(e.keyCode==13&&!e.ctrlKey&&!e.shiftKey){e.preventDefault();b.dropdownController.hideDropdown();a.triggerSearchRequested(d.val())}}});var a=this;var c=b.updateParseIndicator;b.updateParseIndicator=function(e){c.apply(this,arguments);if(!e.getParseError()){a.triggerJqlValid(d.val())}else{a.triggerJqlInvalid(d.val())}};b.buildResponseContainer();b.parse(d.val());b.updateColumnLineCount();d.bind("expandedOnInput",function(){b.positionResponseContainer()}).bind("updateParseIndicator",function(){b.parse(d.val())}).click(function(){b.dropdownController.hideDropdown()})},_onFocus:function(){if(!this.model.getAutocompleteEnabled()||this.$el.data("JQLAutoComplete_init")){return}this.$el.data("JQLAutoComplete_init",true);this.getJqlAutoCompleteData().done(_.bind(this._initJQLAutoComplete,this))}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/jql/JqlQueryModule.js' */
JIRA.Issues.JqlQueryModule=JIRA.Issues.Brace.Evented.extend({namedEvents:["searchRequested","verticalResize"],initialize:function(a){this._queryStateModel=a.queryStateModel;this.view=new JIRA.Issues.JqlQueryView({queryStateModel:a.queryStateModel}).onVerticalResize(this.triggerVerticalResize,this).onSearchRequested(this.triggerSearchRequested,this)},search:function(){var a=this.view.readJql();this.triggerSearchRequested(a)},setQuery:function(){this.view.setQuery()},createView:function(){return this.view}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/jql/JqlQueryView.js' */
JIRA.Issues.JqlQueryView=JIRA.Issues.Brace.View.extend({template:JIRA.Templates.IssueNavQueryJql.jqlQueryView,namedEvents:["verticalResize","searchRequested"],events:{expandedOnInput:"_handleExpandOnInput"},initialize:function(a){_.bindAll(this);this.queryStateModel=a.queryStateModel;this.queryStateModel.on("change:jql",this.setQuery);AJS.$(document).bind("issueNavWidthChanged",this._resizeHeight);if(JIRA.Issues.JQLAutoCompleteView){this.JQLAutoCompleteView=new JIRA.Issues.JQLAutoCompleteView({model:this.queryStateModel});this.JQLAutoCompleteView.onJqlValid(function(b){if(this.queryStateModel.getAdvancedAutoUpdate()){this.triggerSearchRequested(b)}},this);this.JQLAutoCompleteView.onSearchRequested(this.triggerSearchRequested,this)}},render:function(){this.$el.html(this.template({helpUrl:AJS.Meta.get("advanced-search-help-url"),helpTitle:AJS.Meta.get("advanced-search-help-title")}));this.$el.addClass("loading");if(this.JQLAutoCompleteView){this.JQLAutoCompleteView.setElement(this.$el.find(".advanced-search"));this.JQLAutoCompleteView.getJqlAutoCompleteData()}new JIRA.Issues.Tipsy({el:this.$el.find(".search-button"),tipsy:{trigger:"hover",delayIn:300}});this.setQuery();return this},readJql:function(){var a=this._getInputField();var b=a.val()||"";var c=AJS.$.trim(b);if(b!==c){a.val(c)}this._resizeHeight();return c},_handleExpandOnInput:function(){this.triggerVerticalResize()},_resizeHeight:function(){var a=this._getInputField();if(a.val()){a.height(0).expandOnInput()}else{a.expandOnInput().height(0).trigger("refreshInputHeight")}},setQuery:function(){this.$el.removeClass("loading");this._getInputField().val(this.queryStateModel.getJql());this._getInputField().trigger("updateParseIndicator");this._resizeHeight()},focus:function(){this._getInputField().focus()},_getInputField:function(){return this.$el?this.$el.find("textarea"):AJS.$()}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/templates/query.soy' */
// This file was automatically generated from query.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNavQuery == 'undefined') { JIRA.Templates.IssueNavQuery = {}; }


JIRA.Templates.IssueNavQuery.searchSwitcher = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var itemList3 = opt_data.items;
  var itemListLen3 = itemList3.length;
  for (var itemIndex3 = 0; itemIndex3 < itemListLen3; itemIndex3++) {
    var itemData3 = itemList3[itemIndex3];
    JIRA.Templates.IssueNavQuery.searchSwitcherItem({id: itemData3.id, isActive: itemData3.id == opt_data.selectedId}, output);
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQuery.searchSwitcherItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a href="#" class="switcher-item', soy.$$escapeHtml(opt_data.isActive ? ' active' : ''), ' " data-id=\'', soy.$$escapeHtml(opt_data.id), '\' title="', (opt_data.id == 'basic') ? soy.$$escapeHtml("Switch to advanced search using JQL") : soy.$$escapeHtml("Switch to basic search"), '">', (opt_data.id == 'basic') ? soy.$$escapeHtml("Advanced") : soy.$$escapeHtml("Basic"), '</a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQuery.queryView = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-group"><div class="aui-item search-wrap"><div class="search-container"></div><div class="save-filter-controls"></div></div><div class="aui-item view-selector" id="layout-switcher-toggle"></div></div><div class="notifications"></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/QueryModule.js' */
JIRA.Issues.QueryModule=JIRA.Issues.Brace.Evented.extend({namedEvents:["jqlChanged","jqlTooComplex","jqlError","jqlSuccess","searchRequested","queryTooComplexSwitchToAdvanced","changedPreferredSearchMode","basicModeCriteriaCountWhenSearching","verticalResize"],initialize:function(a){this._queryStateModel=a.queryStateModel;this._queryStateModel.on("change:preferredSearchMode",_.bind(function(){this.triggerChangedPreferredSearchMode(this._queryStateModel.getPreferredSearchMode())},this));JIRA.Issues.SearcherDialog.initialize({queryStateModel:this._queryStateModel});this._jqlQueryModule=new JIRA.Issues.JqlQueryModule({queryStateModel:this._queryStateModel}).onSearchRequested(this.handleAdvancedSearchRequested,this).onVerticalResize(this.triggerVerticalResize,this);this._errors={};this._errors[this._queryStateModel.BASIC_SEARCH]=[];this._errors[this._queryStateModel.ADVANCED_SEARCH]=[];this._queryStateModel.on("change:searchMode",this.showSearchErrors,this);this._basicQueryModule=new JIRA.Issues.BasicQueryModule({queryStateModel:this._queryStateModel,primaryClauses:a.primaryClauses,initialSearcherCollectionState:a.searchers}).onSearchRequested(this.clearSearchErrors,this).onJqlTooComplex(this.handleJqlTooComplex,this).onSearchRequested(this.handleSearchRequested,this).onVerticalResize(this.triggerVerticalResize,this).onBasicModeCriteriaCountWhenSearching(this.triggerBasicModeCriteriaCountWhenSearching,this)},handleAdvancedSearchRequested:function(a){this.handleSearchRequested(a);this._basicQueryModule.queryChanged()},handleSearchRequested:function(a){this._queryStateModel.setJql(a);this.clearSearchErrors()},handleJqlTooComplex:function(a){if(this.getSearchMode()!==this._queryStateModel.ADVANCED_SEARCH){this.triggerQueryTooComplexSwitchToAdvanced()}this.setSearchMode(this._queryStateModel.ADVANCED_SEARCH);this.triggerJqlTooComplex(a);if(this._queryView){this._queryView.switcherViewModel.disableSwitching()}},getJql:function(){return this._queryStateModel.getJql()},getSearcherCollection:function(){return this._basicQueryModule.searcherCollection},isBasicMode:function(){return this._queryStateModel.getSearchMode()===this._queryStateModel.BASIC_SEARCH},resetToQuery:function(a,b){this.clearSearchErrors();return this._basicQueryModule.queryReset(a).always(_.bind(function(){this._queryStateModel.switchToPreferredSearchMode();this._jqlQueryModule.setQuery();if(b&&b.focusQuery===true){this._queryView.getView().focus()}this._basicQueryModule.off("searchRequested",this.publishJqlChanges);this._jqlQueryModule.off("searchRequested",this.publishJqlChanges);this._basicQueryModule.onSearchRequested(this.publishJqlChanges,this);this._jqlQueryModule.onSearchRequested(this.publishJqlChanges,this)},this))},publishJqlChanges:function(a){this.triggerJqlChanged(a)},setVisible:function(a){this._queryView.setVisible(a)},queryChanged:function(){this.clearSearchErrors();this._basicQueryModule.queryChanged()},onSearchSuccess:function(a){if(this._queryView){this._queryView.showWarnings(a)}this.triggerJqlSuccess()},searchersReady:function(){return this._basicQueryModule.searchersReady()},onSearchError:function(b){this._errors.renderFunction="showErrors";var c=(b.errorMessages)?b.errorMessages.concat():[];var a=[];_.each(b.errors,function(e,d){if(d==="jql"){a.push(e)}else{c.push(e)}});if(this.getSearchMode()===this._queryStateModel.BASIC_SEARCH&&!this._basicQueryModule.hasErrors()&&a.length>0){this.setSearchMode(this._queryStateModel.ADVANCED_SEARCH)}this._errors[this._queryStateModel.BASIC_SEARCH]=c;this._errors[this._queryStateModel.ADVANCED_SEARCH]=a.concat(c);this.showSearchErrors();this.triggerJqlError()},showSearchErrors:function(){if(this._queryView){this._queryView.clearNotifications();var a=this._errors.renderFunction||"showErrors";this._queryView[a](this._errors[this.getSearchMode()])}},clearSearchErrors:function(){if(this._queryView){this._queryView.clearNotifications();this._queryView.switcherViewModel.enableSwitching()}this._errors[this._queryStateModel.BASIC_SEARCH].length=0;this._errors[this._queryStateModel.ADVANCED_SEARCH].length=0},getSearchMode:function(){return this._queryStateModel.getSearchMode()},getActiveBasicModeSearchers:function(){return this._basicQueryModule.getSelectedCriteria()},setSearchMode:function(a){if(this.getSearchMode()!==a){this._queryStateModel.switchToSearchMode(a);return true}return false},createAndRenderView:function(a){this._queryView=new JIRA.Issues.QueryView({el:a,queryStateModel:this._queryStateModel,basicQueryModule:this._basicQueryModule,jqlQueryModule:this._jqlQueryModule}).onVerticalResize(this.triggerVerticalResize,this);this._queryView.render()},isQueryValid:function(){return(this._errors&&this._errors[this._queryStateModel.BASIC_SEARCH].length===0&&this._errors[this._queryStateModel.ADVANCED_SEARCH].length===0)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/QueryStateModel.js' */
JIRA.Issues.QueryStateModel=JIRA.Issues.Brace.Model.extend({BASIC_SEARCH:"basic",ADVANCED_SEARCH:"advanced",namedAttributes:["searchMode","preferredSearchMode","jql","without","autocompleteEnabled","advancedAutoUpdate","basicAutoUpdate"],defaults:{searchMode:"basic",preferredSearchMode:"basic"},switchToSearchMode:function(a){this.setSearchMode(a)},switchPreferredSearchMode:function(a){this.switchToSearchMode(a);this.setPreferredSearchMode(a);this._savePreferredSearchMode()},switchToPreferredSearchMode:function(){this.switchToSearchMode(this.getPreferredSearchMode())},_savePreferredSearchMode:function(){jQuery.ajax({url:AJS.contextPath()+"/rest/querycomponent/latest/userSearchMode",type:"POST",headers:{"X-Atlassian-Token":"nocheck"},data:{searchMode:this.getPreferredSearchMode()},error:_.bind(function(a){if(JIRA.Issues.displayFailSearchMessage){JIRA.Issues.displayFailSearchMessage(a)}},this),success:function(){JIRA.trace("jira.search.mode.changed")}})}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/SwitcherModel.js' */
JIRA.Issues.SwitcherModel=JIRA.Issues.Brace.Model.extend({namedAttributes:["id","name","view","text"]});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/SwitcherCollection.js' */
JIRA.Issues.SwitcherCollection=JIRA.Issues.Brace.Collection.extend({model:JIRA.Issues.SwitcherModel});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/QuerySwitcherViewModel.js' */
JIRA.Issues.QuerySwitcherViewModel=JIRA.Issues.Brace.Model.extend({mixins:[JIRA.Issues.Mixin.SingleSelect],namedAttributes:["disabled"],namedEvents:["selectionChanged"],initialize:function(a,b){this.queryStateModel=b.queryStateModel;this.queryStateModel.on("change:searchMode",_.bind(function(){this.triggerSelectionChanged.apply(this,arguments)},this))},getSelected:function(){var a=this.queryStateModel.getSearchMode();return a?this.getCollection().get(a):null},setSelected:function(a){this.queryStateModel.switchPreferredSearchMode(a?a.id:null)},enableSwitching:function(){this.setDisabled(false)},disableSwitching:function(){this.setDisabled(true)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/QueryView.js' */
JIRA.Issues.QueryView=JIRA.Issues.Brace.View.extend({namedEvents:["verticalResize"],template:JIRA.Templates.IssueNavQuery.queryView,events:{"click .search-button":"search",submit:"preventDefault"},initialize:function(a){_.bindAll(this);this.queryStateModel=a.queryStateModel;var b=new JIRA.Issues.SwitcherCollection([{id:this.queryStateModel.BASIC_SEARCH,name:"Basic",view:a.basicQueryModule.createView()},{id:this.queryStateModel.ADVANCED_SEARCH,name:"Advanced",view:a.jqlQueryModule.createView()}]);this.jqlQueryModule=a.jqlQueryModule;this.switcherViewModel=new JIRA.Issues.QuerySwitcherViewModel({collection:b},{queryStateModel:this.queryStateModel});this.switcherView=new JIRA.Issues.SwitcherView({template:JIRA.Templates.IssueNavQuery.searchSwitcher,model:this.switcherViewModel,containerClass:".search-container"}).onVerticalResize(this.triggerVerticalResize,this)},render:function(){this.$el.html(this.template());this.switcherView.setElement(this.$el).render();return this},preventDefault:function(a){a.preventDefault()},clearNotifications:function(){this.$(".notifications").empty()},search:function(){if(this.queryStateModel.ADVANCED_SEARCH===this.switcherViewModel.getSelected().getId()){this.jqlQueryModule.search()}else{this.getView().search()}},getView:function(){return this.switcherViewModel.getSelected().getView()},showErrors:function(a){this.$(".notifications").append(JIRA.Templates.Issues.ComponentUtil.errorMessage({messages:a}))},showWarnings:function(a){this.$(".notifications").append(JIRA.Templates.Issues.ComponentUtil.warningMessage({messages:a}))},setVisible:function(a){this.$(".search-container").toggle(a);this.switcherView.setVisible(a)}});jQuery(function(){if(jQuery.browser.msie&&jQuery.browser.version<=8){JIRA.bind(AJS.InlineLayer.EVENTS.hide,function(){jQuery(".text-query-container").parent().append(jQuery(".text-query-container").detach())})}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/SwitcherView.js' */
JIRA.Issues.SwitcherView=JIRA.Issues.Brace.View.extend({namedEvents:["verticalResize"],tagName:"div",events:{"click .switcher-item":"_onSwitcherClick"},initialize:function(a){_.bindAll(this);this.containerClass=a.containerClass;this.model=a.model;this.template=a.template;this.model.onSelectionChanged(this._onSelect);this.switchEl=AJS.$();this.model.on("change:disabled",this._setSwitching)},render:function(){this._onSelect();this._render()},_render:function(){var a=this.model.getSelected();this.switchEl=this.$el.find(".switcher");this.switchEl.html(this.template({items:this.model.getCollection().toJSON(),selectedId:a&&a.id}));new JIRA.Issues.Tipsy({el:this.$el.find(".switcher-item.active")})},getSwitcherTrigger:function(){return this.switchEl.find(".switcher-item.active")},_onSelect:function(){var a=this.$el.find(this.containerClass).empty(),b=this.model.getSelected();if(b){b.getView().setElement(a).render().$el.attr("data-mode",b.id)}this._render();this.triggerVerticalResize()},_onSwitcherClick:function(b){b.preventDefault();if(!this.model.getDisabled()){this.model.next();var a=this.model.getSelected().getView();a.focus&&a.focus()}},_setSwitching:function(){if(this.model.getDisabled()){this.disableSwitching()}else{this.enableSwitching()}},disableSwitching:function(){this.switchEl.addClass("disabled");this.getSwitcherTrigger().attr("title","This query is too complex to display in Simple mode.")},enableSwitching:function(){this.switchEl.removeClass("disabled");this.$el.find(".switcher-item").removeAttr("title")},setVisible:function(a){this.switchEl.toggleClass("hidden",!a)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/Query.js' */
if(!JIRA.Components){JIRA.Components={}}JIRA.Components.Query=function(){var a={project:"Project",issuetype:"Type",status:"Status",assignee:"Assignee",reporter:"Reporter",labels:"Labels",resolution:"Resolution",created:"Created Date",updated:"Updated Date",resolutiondate:"Resolution Date",description:"Description",duedate:"Due Date",comment:"Comment",fixfor:"Fix Version",version:"Affects Version",component:"Component"};return{DEFAULT_CLAUSES:["project","issuetype","status","assignee"],create:function(c){c=_.defaults(c,{primaryClauses:this.DEFAULT_CLAUSES,without:[],autocompleteEnabled:true,advancedAutoUpdate:false,basicAutoUpdate:true,preferredSearchMode:"basic"});c.primaryClauses=_.reject(c.primaryClauses,function(d){return _.contains(c.without,d.id)});_.each(c.primaryClauses,function(e,d){if(typeof e==="string"){if(a[e]){c.primaryClauses[d]={id:e,name:a[e]}}else{console.error("JIRA.Components.Query: You have specified clause ["+e+"]. But we do not have the i18n string for it, probably a custom field. Instead use {id:"+e+", name: '[NAME_HERE]'}")}}});var b=new JIRA.Issues.QueryModule({queryStateModel:new JIRA.Issues.QueryStateModel({jql:c.jql,without:c.without,autocompleteEnabled:c.autocompleteEnabled,advancedAutoUpdate:c.advancedAutoUpdate,basicAutoUpdate:c.basicAutoUpdate,preferredSearchMode:c.preferredSearchMode}),primaryClauses:c.primaryClauses,searchers:c.searchers});b.createAndRenderView(c.el);if(c.jql||c.jql===""){b.resetToQuery(c.jql).done(function(){jQuery(c.el).addClass("ready")})}return b}}}();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-query', location = 'content/js/search/query/SearchShifter.js' */
JIRA.Issues.SearchShifter=function(d){var b,c,a,e;b=function(){var f=d.searcherCollection.chain().filter(a).map(e).value();return function(){return jQuery.Deferred().resolve(f).promise()}};c=function(h){var f=JIRA.Issues.SearcherDialog.instance.getCurrentSearcher(),g=d.searcherCollection.get(h);if(!g.getIsSelected()){g.select()}if(!f||f.getId()!==g.getId()){JIRA.Issues.SearcherDialog.instance.toggle(g)}};a=function(f){return f.getIsShown()};e=function(f){return{label:f.getName(),value:f.getId()}};return function(){if(!d.isBasicMode()||d.isFullScreenIssue()){return null}return{getSuggestions:b(),name:"Search Criteria",onSelection:c,weight:150}}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/search/enhanceIssueLinks.js' */
JIRA.Issues.enhanceLinks={withPushState:function(a){a=_.defaults(a,{selector:".push-state"});AJS.$(document).delegate(a.selector,"simpleClick",function(d){if(this.href){d.preventDefault();var b=parseUri(this.href);var c=b.path;if(b.query){c+="?"+b.query}c=c.replace(Backbone.history.options.root,"");if(Backbone.history.fragment==c||Backbone.history.fragment==decodeURIComponent(c)){Backbone.history.loadUrl(c)}else{a.router.navigate(c,{trigger:true})}}})},toIssueNav:function(a){var c="a.filter-link[data-filter-id], a.filter-link[data-jql]",b="#issues_new_search_link_lnk";if(JIRA.Issues.DarkFeatures.KILL_SWITCH.enabled()){return}AJS.$(document).on("simpleClick",c,function(h){h.preventDefault();var g=AJS.$(h.target).closest("a"),f=g.data("filter-id"),d=g.data("jql");a.searchPageModule.reset({filter:f,jql:d})});AJS.$(document).on("simpleClick",b,function(d){d.preventDefault();a.searchPageModule.resetToBlank()})},isIssueTableDropdown:function(a){if(AJS.InlineLayer.current){var b=jQuery(AJS.InlineLayer.current.offsetTarget());if(b.closest(".list-view table#issuetable").size()){return true}}},toIssue:function(b){if(JIRA.Issues.DarkFeatures.KILL_SWITCH.enabled()){return}AJS.$(document).on("simpleClick",["#attachment-sorting-options a","#attachment-sorting-order-options a","#subtasks-show-all","#subtasks-show-open"].join(","),function(g){if(this.href){g.preventDefault();g.stopPropagation();var f=parseUri(this.href);if(f.queryKey){b.issueModule.updateIssueWithQuery(f.queryKey);AJS.$(this).parents("ul").find("a.aui-checked").removeClass("aui-checked");AJS.$(this).addClass("aui-checked")}}});var d="a.issue-link[data-issue-key]",c=".parentIssue",a=".list-view table#issuetable a.issue-link[data-issue-key]";AJS.$(document).on("simpleClick",d,function(k){k.preventDefault();k.stopPropagation();var i=b.searchPageModule.searchResults;var f=AJS.$(k.target).closest("a").data("issue-key");var g=i._getIssueIdForKey(f);var l=parseInt(g,10);var j=AJS.$(k.target).is(a);var m=AJS.$(k.target).is(c);var h=JIRA.Issues.enhanceLinks.isIssueTableDropdown(a);if((j&&!m)||h){JIRA.Issues.Analytics._loadIssueReason="click-issue-link";JIRA.Issues.Analytics.trigger("kickass.openIssueFromTable",{issueId:g,absolutePosition:i.getPositionOfIssueInSearchResults(l)+1,relativePosition:i.getPositionOfIssueInPage(l)+1});b.searchPageModule.update({selectedIssueKey:f})}else{b.searchPageModule.reset({selectedIssueKey:f})}})},transformToAjax:function(){if(JIRA.Issues.DarkFeatures.KILL_SWITCH.enabled()){return}AJS.$(document).on("simpleClick",".subtask-reorder a",function(a){if(this.href){a.preventDefault();a.stopPropagation();AJS.$.ajax({type:"GET",data:{disableRedirect:true},url:this.href}).done(function(){JIRA.Issues.Api.refreshSelectedIssue({reason:JIRA.Issues.Actions.UPDATE})}).fail(function(b){JIRA.Messages.showErrorMsg(JIRA.SmartAjax.buildSimpleErrorContent(b),{closeable:true})})}})}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/components/table/ResultsCountView.js' */
(function(a){Backbone.define("JIRA.Issues.ResultsCountView",JIRA.Issues.BaseView.extend({events:{"simpleClick .pagination a[data-start-index]":"_onPaginationClick","click .refresh-table":"_onRefreshTable"},initialize:function(b){this.model.bindIssueDeleted(this.render,this);this.search=b.search},setEndOfStableSearchMessage:function(b){this.$endOfStableSearchMessage=b},render:function(){JIRA.Issues.Tipsy.revalidate();this._renderResultsCount();this._renderPaginationLinks();this._renderEndOfStableMessage();this.$("[title]").each(function(b,c){new JIRA.Issues.Tipsy({el:AJS.$(c),showCondition:":not(.active)",tipsy:{gravity:JIRA.Issues.Tipsy.autoBounds(60,["s"])}})})},_onRefreshTable:function(b){b.preventDefault();JIRA.Issues.Analytics.trigger("kickass.issueTableRefresh");this.search.refresh()},_onPaginationClick:function(b){b.preventDefault();var c=AJS.$(b.target).closest("a").data("start-index");this.model.goToPage(c)},_renderResultsCount:function(){var b=this.$(".results-count");var c=this.model.getTotal();if(c===0){b.empty()}else{b.replaceWith(JIRA.Templates.IssueNavTable.resultsCount({start:JIRA.NumberFormatter.format(this.model.getStartIndex()+1),end:JIRA.NumberFormatter.format(this.model.getPositionOfLastIssueInPage()),total:JIRA.NumberFormatter.format(c)}))}},_renderPaginationLinks:function(){var d=this.$(".pagination");var b=this.model.getDisplayableTotal();if(b===0){d.empty();return}var c=JIRA.Issues.URLSerializer.getURLFromState({selectedIssueKey:null,jql:this.search.getJql(),filter:this.search.getFilterId()});d.replaceWith(JIRA.Templates.IssueNavTable.pagination({startIndex:this.model.getStartIndex(),pageSize:this.model.getPageSize(),searchQuery:c,displayableTotal:b}))},_renderEndOfStableMessage:function(){if(!this.$endOfStableSearchMessage){return}var c=!!(this.model.getTotal()-this.model.getDisplayableTotal()),b=this.model.getPageNumber()===this.model.getNumberOfPages();if(c&&b){this.$endOfStableSearchMessage.addClass("visible");this.$endOfStableSearchMessage.html(JIRA.Templates.IssueNavTable.endOfStableMessage())}else{this.$endOfStableSearchMessage.empty();this.$endOfStableSearchMessage.removeClass("visible")}},_getPagingUri:function(b){return AJS.contextPath()+"/"+JIRA.Issues.URLSerializer.getURLFromState({selectedIssueKey:null,startIndex:b,jql:this.search.getJql(),filter:this.search.getFilterId()})}}))})(jQuery);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/splitview/SplitScreenDetailView.js' */
Backbone.define("JIRA.Issues.SplitScreenDetailView",JIRA.Issues.BaseView.extend({events:{"focus #addcomment textarea":"scrollToBottom"},issueDetailsNoSelectionTemplate:JIRA.Templates.SplitView.issueDetailsNoSelection,initialize:function(a){_.bindAll(this);this.issueCacheManager=a.issueCacheManager;this.issueModule=a.issueModule;this.search=a.search;this.searchResults=a.search.getResults();this.issueModule.bindFieldSubmitted(this.focus);this.issueModule.bindReplacedFocusedPanel(this.focus);this.adjustHeight=_.debounce(this.adjustHeight,a.easeOff)},adjustHeight:function(){_.defer(_.bind(function(){var b=this.getIssueContainer(),a,c;if(b.length){a=b.length&&b.offset().top;c=jQuery(window).height();b.css("height",c-a)}},this))},getIssueContainer:function(){return this.$el.find(".issue-container")},scrollToTop:function(){var a=this.getIssueContainer();if(a.size()){a.scrollTop(0)}},scrollToBottom:function(){var a=this.getIssueContainer();if(a.size()){a.scrollTop(a.prop("scrollHeight"))}},activate:function(){if(this.isActive){return this}var a=this;this.$el.focusin(function(){a.focused=true});this.$el.focusout(function(){a.focused=false});this.addListener(this.searchResults,"selectedIssueChange",this.render,this);this.addListener(this.searchResults,"issueUpdated",this.onIssueUpdated,this);this.addListener(this.searchResults,"issueDoesNotExist",this._onIssueDoesNotExist,this);JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,this.fixMentionsDropdownInMentionableFields);JIRA.Issues.onVerticalResize(this.adjustHeight);this.issueModule.bindLoadComplete(this.adjustHeight,this);this.isActive=true;return this},deactivate:function(){this.issueModule.abortPending();JIRA.Issues.offVerticalResize(this.adjustHeight);this.issueModule.unbindLoadComplete(this.adjustHeight);JIRA.unbind(JIRA.Events.NEW_CONTENT_ADDED,this.fixMentionsDropdownInMentionableFields);JIRA.Issues.BaseView.prototype.deactivate.apply(this,arguments);this.isActive=false},fixMentionsDropdownInMentionableFields:function(b,a,c){if(c===JIRA.CONTENT_ADDED_REASON.panelRefreshed||c===JIRA.CONTENT_ADDED_REASON.inlineEditStarted){a.find(".mentionable:not([data-follow-scroll])").attr("follow-scroll",".split-view .issue-container");a.find(".mentionable:not([data-push-scroll])").attr("push-scroll",".issue-body-content")}},onIssueUpdated:function(c,a,b){if(b.action!==JIRA.Issues.Actions.INLINE_EDIT&&b.action!==JIRA.Issues.Actions.ROW_UPDATE){return this.issueModule.refreshIssue(b)}else{return jQuery.Deferred().resolve()}},render:function(b,a){a=a||{};if(this.searchResults.hasIssues()&&!this.search.isStandAloneIssue()&&a.reason!=="issueLoaded"){if(this.searchResults.hasSelectedIssue()){this.issueModule.abortPending();JIRA.Issues.Utils.debounce(this,"_renderIssue",this.searchResults.getSelectedIssue())}else{this._renderNoIssue()}}this.adjustHeight();return this},_renderIssue:function(a){this.issueModule.loadIssue({id:a.getId(),key:a.getKey(),splitViewMode:true}).always(_.bind(function(){this.issueModule.updateIssuePager(_.extend({},this.searchResults.getPager(),{isSplitView:true}));if(this.searchResults.isFirstIssueSelected()&&this.searchResults.getDisplayableTotal()>1){this.issueCacheManager.scheduleIssueToBePrefetched(this.searchResults.getNextIssueForSelectedIssue())}this.issueCacheManager.prefetchIssues();this.$el.addClass("active");this.scrollToTop()},this))},focus:function(){if(!this.hasFocus()){this.getIssueContainer().focus()}},blur:function(){this.getIssueContainer().blur()},_onIssueDoesNotExist:function(){this._renderNoIssue();this.issueModule.renderIssueDoesNotExist(this.$el)},_renderNoIssue:function(){this.$el.html(this.issueDetailsNoSelectionTemplate())},hasFocus:function(){return this.focused===true}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/splitview/SplitScreenOrderByView.js' */
Backbone.define("JIRA.Issues.SplitScreenOrderByView",JIRA.Issues.BaseView.extend({template:JIRA.Templates.SplitView.orderBy,events:{"simpleClick a.order-by":"_onClickOrderBy","simpleClick a.order-options":"_toggleShowDropDown"},initialize:function(a){this.search=a.search;this.searchResults=a.search.getResults()},render:function(){this.$el.html(this.template({sortBy:this.searchResults.getSortBy()}));return this},deactivate:function(){this.orderByDropDown&&this.orderByDropDown.deactivate();JIRA.Issues.BaseView.prototype.deactivate.apply(this,arguments)},_onClickOrderBy:function(b){b.preventDefault();var a=AJS.$(b.currentTarget).data("field-id");if(a){this.search.doSort({fieldId:a})}},_toggleShowDropDown:function(a){a.preventDefault();if(!this.orderByDropDown){this.orderByDropDown=new JIRA.Issues.OrderByDropDownView({search:this.search,offsetTarget:this.$("a.order-by"),onHideCallback:_.bind(function(){this.orderByDropDown=null},this)})}this.orderByDropDown.toggle()}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/splitview/OrderByDropDownView.js' */
Backbone.define("JIRA.Issues.OrderByDropDownView",JIRA.Issues.BaseView.extend({initialize:function(a){_.bindAll(this,"_onDropdownHidden","_onDropdownShown");this.search=a.search;this.offsetTarget=a.offsetTarget;this._onHideCallback=a.onHideCallback;this._pending=null;this._inlineLayer=null},deactivate:function(){this._inlineLayer&&this._inlineLayer.hide();JIRA.Issues.BaseView.prototype.deactivate.apply(this,arguments)},toggle:function(){if(!this._inlineLayer){this._pending=AJS.$.ajax(this._ajaxDefaults());this._inlineLayer=this._createInlineLayer(this._pending);this._inlineLayer.bind(AJS.InlineLayer.EVENTS.show,this._onDropdownShown);this._inlineLayer.bind(AJS.InlineLayer.EVENTS.hide,this._onDropdownHidden);this._inlineLayer.show()}else{this._inlineLayer.hide()}},_createInlineLayer:function(a){var b=_.bind(function(d){this._deferredAddTipsyToFooter(d);return this._renderInitialContent(d)},this);var c=new AJS.InlineLayer({offsetTarget:this.offsetTarget,content:function(){return a.pipe(b)},width:218});if(this._onHideCallback){c.bind(AJS.InlineLayer.EVENTS.hide,this._onHideCallback)}return c},_initSingleSelect:function(b){var c=b.find("select");c.bind("selected",_.bind(this._onFieldSelected,this));new AJS.CheckboxMultiSelect({element:c,itemAttrDisplayed:"label",suggestionsHandler:AJS.SelectSuggestHandler,ajaxOptions:this._ajaxDefaults({data:_.bind(function(d){return JSON.stringify(this._ajaxOptionsData(d))},this),query:true,minQueryLength:0,formatResponse:_.bind(function(d){this._removeTipsy();var f=new AJS.GroupDescriptor();_.each(d.fields,function(g){f.addItem(new AJS.ItemDescriptor({title:g.fieldName,value:g.fieldId,label:g.fieldName,meta:{sortJql:g.sortJql}}))});var e=this._getFooterText(d);if(e){f.footerText(e);this._deferredAddTipsyToFooter(d)}return[f]},this)})});var a=b.find("#order-by-options-input");a.focus()},_ajaxDefaults:function(b){var a={url:AJS.contextPath()+"/rest/issueNav/1/orderByOptions",type:"POST",contentType:"application/json",data:JSON.stringify(this._ajaxOptionsData())};return _.extend(a,b)},_ajaxOptionsData:function(c){var a=this.search.getEffectiveJql();var b=this.search.getFilterId();var d=this.search.getResults().getSortBy();return{query:c,jql:a?a:undefined,filter:b?b:undefined,sortBy:d?d.fieldId:undefined}},_renderInitialContent:function(a){var b=_.map(a.fields,function(c){return _.extend({},c,{meta:JSON.stringify({sortJql:c.sortJql})})});return AJS.$("<div></div>").addClass("order-dropdown").html(JIRA.Templates.SplitView.orderByOptions({options:b,footer:this._getFooterText(a)}))},_onDropdownShown:function(b,a,c){this._initSingleSelect(a)},_onDropdownHidden:function(b,a,c){this._removeTipsy();AJS.$("div.order-dropdown").remove();this._inlineLayer=null},_onFieldSelected:function(b,a){_.defer(_.bind(function(){AJS.InlineLayer.current.hide();var c=a.meta();this.search.doSort({jql:c.sortJql})},this))},_getFooterText:function(a){if(typeof a.matchesCount==="number"&&typeof a.maxResults==="number"){var b=a.matchesCount-a.maxResults;if(b>0){return AJS.format("{0} more fields...",b)}}return""},_deferredAddTipsyToFooter:function(d){var b=d.matchesCount;var e=Math.min(d.matchesCount,d.maxResults);var c=AJS.format("Showing {0} of {1} matching fields. Find more fields by typing in the search box.",e,b);var a=this;_.defer(function(){a._tipsyTrigger=new JIRA.Issues.Tipsy({el:a._inlineLayer.$layer.find(".aui-list-section-footer"),tipsy:{title:function(){return c},className:"tipsy-front"}})})},_removeTipsy:function(){if(this._tipsyTrigger){this._tipsyTrigger.hide();this._tipsyTrigger=null}}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/splitview/SplitScreenListView.js' */
Backbone.define("JIRA.Issues.SplitScreenListView",JIRA.Issues.BaseView.extend({inaccessibleIssueRowTemplate:JIRA.Templates.SplitView.inaccessibleIssueRow,template:JIRA.Templates.SplitView.issueList,events:{"simpleClick .issue-list li":"_onClickIssue"},initialize:function(a){_.bindAll(this);if(a.easeOff){this._adjustHeight=_.debounce(this._adjustHeight,a.easeOff)}this.search=a.search;this.searchContainer=a.searchContainer;this.searchPromise=this._createSearchPromise({done:this._onSearchDone,fail:this._onSearchFail});this.searchResults=a.search.getResults();this.serverRendered=!!a.serverRendered&&this._issuesRendered(a);this.paginationView=new JIRA.Issues.ResultsCountView({model:this.searchResults,search:this.search});JIRA.Issues.onVerticalResize(this._adjustHeight);this.addListener(this.searchResults,"highlightedIssueChange",this._onHighlightedIssueChange,this);this.addListener(this.searchResults,"issueUpdated",this._onIssueUpdated,this);this.addListener(this.searchResults,"startIndexChange",this.render,this)},_issuesRendered:function(a){return !!a.searchContainer.find(".issue-list").length},_adjustHeight:function(){var b=jQuery(".end-of-stable-message").outerHeight(),a=this.$el.offset().top+this.searchContainer.find(".list-panel").scrollTop(),d=jQuery(".pagination-view:last").outerHeight(),c=jQuery(window).height();this.$el.css("height",c-a-b-d)},scrollToFocused:function(){var b=this.searchContainer.find(".list-panel");var a=this.$el.find(".focused");if(b.size()&&a.size()){b.scrollTop(a.position().top)}},deactivate:function(){this.searchPromise.reset();JIRA.Issues.offVerticalResize(this._adjustHeight);this.paginationView.deactivate();JIRA.Issues.BaseView.prototype.deactivate.apply(this,arguments)},_onClickIssue:function(c){var b=AJS.$(c.target).closest("[data-id]").data("id"),a=this.searchResults.getSelectedIssue().getId()==b;c.preventDefault();if(!a){this.searchResults.selectIssueById(b,{replace:true});JIRA.Issues.Analytics.trigger("kickass.openIssueFromTable",{issueId:b,absolutePosition:this.searchResults.getPositionOfIssueInSearchResults(b)+1,relativePosition:this.searchResults.getPositionOfIssueInPage(b)+1})}},_createSearchPromise:function(a){var b=jQuery.RecurringPromise();a=a||{};a.done&&b.done(_.bind(a.done,this));a.fail&&b.fail(_.bind(a.fail,this));return b},getIssueById:function(a){return this.$el.find("[data-id="+a+"]")},_highlightIssue:function(a){this.$el.find(".focused").removeClass("focused");a&&this.getIssueById(a.getId()).addClass("focused").scrollIntoView()},markIssueInaccessible:function(a){this.getIssueById(a).replaceWith(this.inaccessibleIssueRowTemplate({isHighlighted:this.searchResults.getHighlightedIssue().getId()===a,issueID:a}))},_onHighlightedIssueChange:function(){this._highlightIssue(this.searchResults.getHighlightedIssue())},_onIssueUpdated:function(b,a){if(a.table[0]===null){this.markIssueInaccessible(b)}else{this.getIssueById(b).html(JIRA.Templates.SplitView.issueRow(a.table[0]))}},_onSearchDone:function(a){if(a instanceof Array){if(this.searchResults.hasIssues()){if(!a.serverRendered){this.$el.html(this.template({highlightedID:this.searchResults.getHighlightedIssue().getId(),issueIDs:this.searchResults.getPageIssueIds(),issues:a}))}this.paginationView.render()}_.defer(_.bind(function(){this._adjustHeight();this.scrollToFocused()},this))}},_onSearchFail:function(){var a=this.searchContainer.find(".navigator-content");a.html(JIRA.Templates.Issues.Util.errorMessage({msg:"Error occurred communicating with the server. Please reload the page and try again."}))},render:function(){var a=this.serverRendered;this.serverRendered=false;if(this.searchResults.hasIssues()){if(!this.searchResults.hasHighlightedIssue()&&!this.searchResults.hasSelectedIssue()){this.searchResults.highlightFirstInPage();return}return this.searchPromise.add(this.searchResults.getResultsForPage({jql:this.search.getEffectiveJql()}).then(function(b){return _.extend(b,{serverRendered:a})}))}else{return jQuery.Deferred().resolve()}}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/splitview/SplitScreenLayout.js' */
(function(a){Backbone.define("JIRA.Issues.SplitScreenLayout",JIRA.Issues.BaseView.extend({initialize:function(b,c){_.bindAll(this);if(c.easeOff){this.applyResponsiveDesign=a.noop}c=_.extend(c,{serverRendered:this._consumeServerRenderedSplitView(c)});this.search=c.search;this.fullScreenIssue=c.fullScreenIssue;this.issueModule=c.issueModule;this.navigatorContent=c.searchContainer.find(".navigator-content");this.searchResults=c.search.getResults();this.emptyResultsView=new JIRA.Issues.EmptyResultsView({searchResults:this.searchResults,el:this.navigatorContent});this.detailsView=new JIRA.Issues.SplitScreenDetailView(c);this.listView=new JIRA.Issues.SplitScreenListView(c);this.orderByView=new JIRA.Issues.SplitScreenOrderByView(c);JIRA.Issues.onVerticalResize(this._adjustNoResultsMessageHeight);JIRA.Issues.onHorizontalResize(this._updateSidebarPosition);JIRA.Issues.onVerticalResize(this._updateSidebarPosition);this.addListener(c.search,"beforeSearch",this._showPending,this);this.addListener(this.searchResults,"issueDeleted",this._onIssueDeleted,this);this.addListener(this.searchResults,"newPayload",this._hidePending,this);this.addListener(this.searchResults,"newPayload",this.render,this);this.addListener(this.searchResults,"startIndexChange",this._onStartIndexChange,this);this.addListener(this.searchResults,"highlightedIssueChange",this._onHighlightedIssueChange,this);this.addListener(this.searchResults,"selectedIssueChange",this._onSelectedIssueChange,this);this.search.onSearchError(this._onSearchFail,this);this.issueModule.bindLoadError(this._onIssueLoadError,this);this.listView.searchPromise.done(_.bind(function(){this._makeVisible()},this));this.fullScreenIssue.hide();JIRA.Issues.overrideScrollIntoViewForSplit();this.setElement(this.navigatorContent);if(c.serverRendered){this._activateSubviews()}},_adjustNoResultsMessageHeight:function(){var d=this.searchResults.hasIssues(),c=AJS.$(window).outerHeight(true);if(d){this.navigatorContent.css("height","")}else{var b=this.navigatorContent.offset().top;this.navigatorContent.css("height",c-b)}},_consumeServerRenderedSplitView:function(c){var d=!!AJS.Meta.get("consumed-server-rendered-split-view"),b=!!c.searchContainer.find(".split-view").length;AJS.Meta.set("consumed-server-rendered-split-view",true);return !d&&b},deactivate:function(){JIRA.Issues.offVerticalResize(this._adjustNoResultsMessageHeight);JIRA.Issues.offHorizontalResize(this._updateSidebarPosition);JIRA.Issues.restoreScrollIntoViewForNormal();jQuery("body").removeClass("page-type-split");this.issueModule.unbindLoadError(this._onIssueLoadError,this);this.navigatorContent.addClass("pending").css("height","");this.search.offSearchError(this._onSearchFail,this);if(this._isIOS()){this._deactivateIOSSpecificBehaviour()}this.detailsView.deactivate();this.listView.deactivate();jQuery(window).unbind("resize",this.applyResponsiveDesign);JIRA.Issues.BaseView.prototype.deactivate.apply(this,arguments);if(!this.searchResults.hasIssue(this.searchResults.getSelectedIssue().getId())){this.searchResults.selectFirstInPage()}},_handleInitialIssueSelection:function(){if(!this.searchResults.hasSelectedIssue()){if(this.searchResults.hasHighlightedIssue()){this.searchResults.selectIssueById(this.searchResults.getHighlightedIssue().getId(),{replace:true})}else{this.searchResults.selectFirstInPage({replace:true})}}},_hidePending:function(){this.navigatorContent.removeClass("pending")},_isInitialRender:function(){return !this.navigatorContent.find(".split-view").length},_makeVisible:function(){this.navigatorContent.removeClass("pending");if(this._isInitialRender()){this.navigatorContent.html(this.$el)}this.$el.find(".list-results-panel").sidebar({id:"splitview",minWidth:function(b){return 250},maxWidth:_.bind(function(){return this.$el.width()-500},this),resize:this.applyResponsiveDesign});jQuery(window).resize(this.applyResponsiveDesign);JIRA.trigger(JIRA.Events.LAYOUT_RENDERED);this.applyResponsiveDesign()},_updateSidebarPosition:function(){var b=this.$el.find(".list-results-panel");b.sidebar("updatePosition")},applyResponsiveDesign:function(){this.$el.toggleClass("skinny",this.detailsView.$el.width()<900);this.$el.toggleClass("very-skinny",this.detailsView.$el.width()<600)},nextIssue:function(){this.searchResults.selectNextIssue({replace:true})},_onHighlightedIssueChange:function(c,b){b=_.defaults({},b,{replace:true});var d=this.searchResults.getHighlightedIssue().getId();this.searchResults.selectIssueById(d,b)},_onIssueDeleted:function(b){this.listView.getIssueById(b.id).hide();this._showPending();if(this.searchResults.hasIssues()){this.listView.render()}else{this._renderEmptyResults()}},_onIssueLoadError:function(b){if(b.response.status===404){this.listView.markIssueInaccessible(b.issueId)}},_onSearchFail:function(){this._renderEmptyResults();this._hidePending()},_onSelectedIssueChange:function(){this._setIssueModuleContainer()},_onStartIndexChange:function(){if(this.searchResults.hasIssues()){this._showPending()}},prevIssue:function(){this.searchResults.selectPrevIssue({replace:true})},render:function(){var c=this.searchResults.hasIssues(),b=this._isInitialRender();jQuery("body").addClass("page-type-split");if(this._isIOS()){this._activateIOSSpecificBehaviour()}if(c){this._handleInitialIssueSelection();this.navigatorContent.removeClass("empty-results");if(b){this.$el.html(JIRA.Templates.SplitView.structure())}this._activateSubviews();this.detailsView.render();this.listView.render()}else{this._hidePending();this._renderEmptyResults()}this._adjustNoResultsMessageHeight();this.orderByView.render();return this},_renderEmptyResults:function(){this.emptyResultsView.render()},_setIssueModuleContainer:function(){this.issueModule.setContainer(this.$(".split-view .detail-panel > div"))},_showPending:function(){this.navigatorContent.addClass("pending")},_activateSubviews:function(){this.detailsView.setElement(this.$(".detail-panel")).activate();this.orderByView.setElement(this.$(".list-ordering"));this.listView.setElement(this.$(".list-content"));this.listView.paginationView.setElement(this.$(".pagination-view"));this.listView.paginationView.setEndOfStableSearchMessage(this.$(".end-of-stable-message"));this._setIssueModuleContainer()},handleLeft:function(){this.detailsView.blur()},handleRight:function(){this.detailsView.focus()},isIssueViewActive:function(){return this.detailsView.hasFocus()},_isIOS:function(){var b=navigator.platform;return b==="iPod"||b==="iPhone"||b==="iPad"},_activateIOSSpecificBehaviour:function(){jQuery(document).on("touchmove.iOSSpecific",function(b){b.preventDefault()});jQuery("body").on("touchstart.iOSSpecific",".issue-container, .list-panel",function(b){if(b.currentTarget.scrollTop===0){b.currentTarget.scrollTop=1}else{if(b.currentTarget.scrollHeight===b.currentTarget.scrollTop+b.currentTarget.offsetHeight){b.currentTarget.scrollTop-=1}}});jQuery("body").on("touchmove.iOSSpecific",".issue-container, .list-panel",function(b){b.stopPropagation()})},_deactivateIOSSpecificBehaviour:function(){jQuery(document).off("touchmove.iOSSpecific");jQuery("body").off("touchstart.iOSSpecific");jQuery("body").off("touchmove.iOSSpecific")}}))})(jQuery);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/search/FullScreenLayout.js' */
Backbone.define("JIRA.Issues.FullScreenLayout",JIRA.Issues.BaseView.extend({initialize:function(a,b){_.bindAll(this);_.extend(this,b);this.$searchContainer=b.searchContainer;this.$navigatorContent=this.$searchContainer.find(".navigator-content");this.searchResults=this.search.getResults();this.columnConfig=b.columnConfig;this.issueTableView=new JIRA.Issues.IssueTableView({el:this.$navigatorContent,search:this.search,searchResults:this.searchResults,columnConfig:this.columnConfig});this.addListener(this.search,"beforeSearch",this._onBeforeSearch,this);this.addListener(this.searchResults,"newPayload",this.render,this);this.addListener(this.searchResults,"selectedIssueChange",this.handleIssueSelectionChanged,this);this.addListener(this.searchResults,"issueUpdated",this.handleIssueUpdated,this);this.issueModule.bindLoadError(this.handleIssueLoadError,this)},handleIssueUpdated:function(c,a,b){if(b.action!=="inlineEdit"&&b.action!=="rowUpdate"){return this.fullScreenIssue.updateIssue(b)}},deactivate:function(){this.issueModule.unbindLoadError(this.handleIssueLoadError,this);this.$navigatorContent.addClass("pending");this.fullScreenIssue.deactivate();this.issueTableView.deactivate();JIRA.Issues.BaseView.prototype.deactivate.apply(this,arguments)},handleIssueSelectionChanged:function(a,b){if(a.hasIssue()){this.handleSelectedIssue(a,b)}else{this.handleIssueUnselected()}},render:function(){if(!this.searchResults.hasSelectedIssue()){this.fullScreenIssue.hide();this.issueTableView.render().done(_.bind(function(){this.$navigatorContent.removeClass("pending");JIRA.trigger(JIRA.Events.LAYOUT_RENDERED,["list-view"])},this))}return this},handleIssueLoadError:function(a){if(a.response.status===404){this.issueTableView.handleIssueInaccessible(a.issueId)}if(!this.fullScreenIssue.isVisible()){this.searchResults.selectIssueByKey(null)}this.fullScreenIssue.showError(a)},handleIssueUnselected:function(){if(this.fullScreenIssue.isVisible()){this.fullScreenIssue.hide();JIRA.trace("jira.returned.to.search");JIRA.trace("jira.psycho.returned.to.search");JIRA.Issues.Analytics.trigger("kickass.returntosearch")}this.$navigatorContent.removeClass("pending");this.issueTableView.show()},_loadIssue:function(a){this.fullScreenIssue.show({id:a.getId(),key:a.getKey(),pager:this.searchResults.getPager()})},handleSelectedIssue:function(a,b){b=b||{};if(b.reason!=="issueLoaded"){this.issueModule.abortPending();JIRA.Issues.Utils.debounce(this,"_loadIssue",a)}this.fullScreenIssue.updatePager(this.searchResults.getPager())},_onBeforeSearch:function(){this.$navigatorContent.addClass("pending")},nextIssue:function(){this.searchResults.highlightNextIssue();if(this.searchResults.hasSelectedIssue()){this.searchResults.selectNextIssue()}},prevIssue:function(){this.searchResults.highlightPrevIssue();if(this.searchResults.hasSelectedIssue()){this.searchResults.selectPrevIssue()}},returnToSearch:function(){this.searchResults.unselectIssue()},searchIsVisible:function(){return this.searchContainer.closest("body").length>0},handleLeft:function(){},handleRight:function(){},isIssueViewActive:function(){return this.fullScreenIssue.isVisible()}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/search/SearchResults.js' */
(function(a){Backbone.define("JIRA.Issues.SearchResults",JIRA.Issues.BaseModel.extend({defaults:{issueIds:[],selectedIssue:new JIRA.Issues.SimpleIssue(),highlightedIssue:new JIRA.Issues.SimpleIssue(),total:0},properties:["columnSortJql","highlightedIssue","issueIds","issueIdsForPage","jiraHasIssues","pageSize","resultsId","selectedIssue","startIndex","sortBy","columns","table","total","initialPayload","columnConfig"],namedEvents:["prevIssueSelected","nextIssueSelected","issueUpdated","issueDeleted","issueDoesNotExist","stableUpdate"],initialize:function(b,c){JIRA.Issues.ModelUtils.makeTransactional(this,"resetFromSearch","selectNextIssue","selectPrevIssue");this.issueUpdateCallbacks=[];this._issueSearchManager=c.issueSearchManager;this._initialHighlightedIssueId=c.initialHighlightedIssueId;this._initialSelectedIssue=c.initialSelectedIssue;this._columnConfig=c.columnConfig},getStartIndexForPage:function(b){return b*this.getPageSize()},hasIssue:function(b){return _.indexOf(this.getIssueIds(),b)!==-1},getPager:function(){if(this.hasIssue(this.getSelectedIssue().getId())){var e=this.getIssueIds();var f=this.getSelectedIssue().getId();var c=_.indexOf(e,f);var g=this.getTotal();var h=e.length;var d={position:JIRA.NumberFormatter.format(c+1),resultCount:JIRA.NumberFormatter.format(g),stableSearchLimit:h};if(c>0){var i=this._getPrevIssueId(f);if(i){d.previousIssue={id:i,key:this._getIssueKeyForId(i)}}}if(c<g-1&&c<h-1){var b=this._getNextIssueId(f);if(b){d.nextIssue={id:b,key:this._getIssueKeyForId(b)}}}return d}},getNumberOfPages:function(){return this._getPageNumberForStartIndex(this.getDisplayableTotal()-1)},removeIssue:function(e){e=parseInt(e,10);var d=this.getIssueIds()[0]===e,c=this.getHighlightedIssue().getId()===e,b=_.last(this.getIssueIds())===e;if(c){if(!b){this.highlightNextIssue({replace:true})}else{if(!d){this.highlightPrevIssue({replace:true})}}}this.setIssueIds(_.without(this.getIssueIds(),e));this.setTotal(this.getTotal()-1);this.triggerIssueDeleted({id:e,key:this._getIssueKeyForId(e)})},isFirstIssueHighlighted:function(){if(!this.hasHighlightedIssue()){return false}return this.getHighlightedIssue().getId()===this.getIssueIds()[0]},updateIssueById:function(c,b){return this.updateIssue(c,b)},updateIssue:function(f,b){var d=f.action===JIRA.Issues.Actions.DELETE,e=f.id,c=[];b=_.defaults({},b,{showMessage:true,filter:null});if(d){this.removeIssue(e);b.showMessage&&this._notifyOfIssueUpdate(f);return jQuery.Deferred().resolve().promise()}else{return this.getResultForId(e,b.filter).done(_.bind(function(g){_.each(this.issueUpdateCallbacks,function(i){var h=i.handler.call(i.ctx||window,e,g,f);if(h&&h.promise){c.push(h)}});a.when(c).done(_.bind(function(){b.showMessage&&this._notifyOfIssueUpdate(f)},this))},this))}},_notifyOfIssueUpdate:function(b){b.message&&JIRA.Issues.showNotification(b.message,b.key);JIRA.trace("jira.search.stable.update")},getResultForId:function(d,c){var b={columnConfig:this._columnConfig.columnPickerModel.getColumnConfig()};if(c&&!c.getIsSystem()){b=_.extend({filterId:c.getId()},b)}return this._issueSearchManager.getRowsForIds([d],b)},isHighlightedIssueAccessible:function(){if(!this.hasHighlightedIssue()){return null}return !this._issueSearchManager.issueKeys.hasError(this.getHighlightedIssue().getId())},getDisplayableTotal:function(){return this.getIssueIds().length},selectIssueByKey:function(c,b){if(!c){this.unselectIssue();return}var d=this._getIssueIdForKey(c);if(!d){this._unhighlightIssue();this.getSelectedIssue().set({id:-1,key:c});this.triggerIssueDoesNotExist()}else{this._selectExistingIssueById(d,b)}},_unhighlightIssue:function(){this.getHighlightedIssue().set({id:null,key:null})},selectFirstInPage:function(b){this.selectIssueById(this.getIssueIds()[this.getStartIndex()],b)},getPrevPageStartIndex:function(){var b=(this.getStartIndex()||0)-this.getPageSize();return(b<0)?null:b},getNextPageStartIndex:function(){var b=this.getPositionOfLastIssueInPage();return(b>=this.getDisplayableTotal())?null:b},getPositionOfLastIssueInPage:function(){var c=this.getStartIndex();var b=this._pageSize();return Math.min(c+b,this.getDisplayableTotal())},highlightFirstInPage:function(){this.highlightIssueById(this.getIssueIds()[this.getStartIndex()])},selectIssueById:function(c,b){if(!c){this.unselectIssue()}else{this._selectExistingIssueById(c,b)}},_selectExistingIssueById:function(c,b){if(c!==this.getSelectedIssue().getId()){c=c?parseInt(c,10):null;this.getSelectedIssue().set({id:c,key:c?this._getIssueKeyForId(c):null},b);if(JIRA.Issues.DarkFeatures.KILL_SWITCH.enabled()){this._postSelectionToServer(c)}this.highlightIssueById(c)}},_postSelectionToServer:function(d){var b=_.indexOf(this.getIssueIds(),d),c=this.getIssueIds[b+1];AJS.$.get(contextPath+"/secure/SetSelectedIssue.jspa",{atl_token:atl_token(),selectedIssueId:d,selectedIssueIndex:b,nextIssueId:c},function(){JIRA.trace("jira.search.set.selected.issue.complete")})},highlightIssueById:function(c,b){b=_.defaults({},b,{replace:false});if(c&&c!==this.getHighlightedIssue().getId()){c=c?parseInt(c,10):null;this.getHighlightedIssue().set({id:c,key:c?this._getIssueKeyForId(c):null},b);if(c){this.setStartIndex(this._getStartIndexForIssueId(c))}if(JIRA.Issues.DarkFeatures.KILL_SWITCH.enabled()){this._postSelectionToServer(c)}}},getState:function(){return{selectedIssueKey:this.getSelectedIssue().getKey(),startIndex:this.getStartIndex()}},resetFromSearch:function(b){b.resultsId=_.uniqueId();this.getSelectedIssue().set({id:null,key:null});this.set("sortBy",null);this.set(_.pick(b,this.properties));if(typeof b.selectedIssueKey==="string"){this.selectIssueByKey(b.selectedIssueKey)}else{if(this.isIssueOnPage(this._initialHighlightedIssueId)){this.highlightIssueById(this._initialHighlightedIssueId)}else{if(this.hasIssues()){this.highlightFirstInPage()}else{this.getHighlightedIssue().set({id:null,key:null})}}}this._initialHighlightedIssueId=null},hasIssues:function(){return !!this.getIssueIds().length},isIssueOnPage:function(b){return _.indexOf(this.getPageIssueIds(),b)!==-1},isFirstIssueSelected:function(){if(this.hasIssue(this.getSelectedIssue().getId())){var c=this.getIssueIds();var d=this.getSelectedIssue().getId();var b=_.indexOf(c,d);return b===0}return false},getResultsForPage:function(c){if(this.getTable()){var b=this.getTable();this.setTable(null);_.defer(function(){JIRA.trace("jira.search.finished")});return a.Deferred().resolve(b).promise()}return this.getResultsForIds(this.getPageIssueIds(),c)},getResultsForIds:function(e,d){var b=this;var c=a.Deferred();this._issueSearchManager.getRowsForIds(e,d).done(function(f){b.setColumnConfig(f.columnConfig);b.setColumns(f.columns);b.setColumnSortJql(f.columnSortJql);c.resolve(f.table)}).fail(c.fail).always(function(){_.defer(function(){JIRA.trace("jira.search.finished")})});return c},applyState:function(b){this.set(_.pick(b,this.properties))},unselectIssue:function(b){var c=this.getSelectedIssue();if(c.getId()){c.set({id:null,key:null},b)}},hasSelectedIssue:function(){return !!this.getSelectedIssue().getId()},hasHighlightedIssue:function(){return !!this.getHighlightedIssue().getId()},getPageIssueIds:function(){var d=this.getStartIndex();var c=this._pageSize();var b=this.getIssueIds();return b?b.slice(d,Math.min(d+c,b.length)):[]},getPageIssues:function(){return _.map(this.getPageIssueIds(),function(b){return{id:b,key:this._getIssueKeyForId(b)}},this)},getPageNumber:function(){return Math.floor(this.getStartIndex()/this._pageSize())},getPositionOfIssueInPage:function(b){return this.getPositionOfIssueInSearchResults(b)%this._pageSize()},getPositionOfIssueInSearchResults:function(b){return _.indexOf(this.getIssueIds(),b)},selectNextIssue:function(b){if(!this.hasSelectedIssue()){return a.Deferred().reject().promise()}var c=this._getNextIssueId(this.getSelectedIssue().getId());this._triggerNextIssueSelectedEvent(c);return this._selectIssue(c,b)},selectPrevIssue:function(b){if(!this.hasSelectedIssue()){return a.Deferred().reject().promise()}var c=this._getPrevIssueId(this.getSelectedIssue().getId());this._triggerPrevIssueSelectedEvent(c);return this._selectIssue(c,b)},_selectIssue:function(c,b){this.selectIssueById(c,b);return a.Deferred().resolve(c).promise()},highlightNextIssue:function(b){if(!this.hasHighlightedIssue()){return a.Deferred().reject().promise()}var c=this._getNextIssueId(this.getHighlightedIssue().getId());this.highlightIssueById(c,b);return a.Deferred().resolve(c).promise()},highlightPrevIssue:function(b){if(!this.hasHighlightedIssue()){return a.Deferred().reject().promise()}var c=this._getPrevIssueId(this.getHighlightedIssue().getId());this.highlightIssueById(c,b);return a.Deferred().resolve(c).promise()},goToPage:function(d,c){c=_.defaults({},c,{replace:false});if(d===null||d===this.getStartIndex()){return a.Deferred().resolve().promise()}var b=this.getIssueIds()[d];this.highlightIssueById(b,c);return a.Deferred().resolve(b).promise()},onHighlightedIssueChange:function(c,b){this.getHighlightedIssue().on("change",c,b)},offHighlightedIssueChange:function(c,b){this.getHighlightedIssue().off("change",c,b)},onSelectedIssueChange:function(c,b){this.getSelectedIssue().on("change",c,b)},offSelectedIssueChange:function(c,b){this.getSelectedIssue().off("change",c,b)},onColumnConfigChange:function(c,b){this.on("change:columnConfig",c,b)},offColumnConfigChange:function(c,b){this.off("change:columnConfig",c,b)},onColumnsChange:function(c,b){this.on("change:columns",c,b)},offColumnsChange:function(c,b){this.off("change:columns",c,b)},onStartIndexChange:function(c,b){this.on("change:startIndex",c,b)},onNewIssueIds:function(c,b){this.on("change:issueIds",c,b)},offNewIssueIds:function(c,b){this.off("change:issueIds",c,b)},offStartIndexChange:function(c,b){this.off("change:startIndex",c,b)},onNewPayload:function(c,b){this.on("change:resultsId",c,b)},offNewPayload:function(c,b){this.off("change:resultsId",c,b)},onIssueUpdated:function(c,b){this.issueUpdateCallbacks.push({handler:c,ctx:b})},offIssueUpdated:function(c){var b=[];this.issueUpdateCallbacks=_.each(this.issueUpdateCallbacks,function(d){if(d.handler!==c){b.push(d)}});this.issueUpdateCallbacks=b},_getNextIssueId:function(c){var b=this.getIssueIds();return b[Math.min(_.indexOf(b,c)+1,this.getDisplayableTotal()-1)]},getNextIssueForId:function(c){var b=this._getNextIssueId(c);return{id:b,key:this._getIssueKeyForId(b)}},getNextIssueForSelectedIssue:function(){return this.getNextIssueForId(this.getSelectedIssue().getId())},_getPrevIssueId:function(c){var b=this.getIssueIds();return b[Math.max(0,_.indexOf(this.getIssueIds(),c)-1)]},_getStartIndexForIssueId:function(d){var c=_.indexOf(this.getIssueIds(),d),b=this._pageSize();return Math.max(0,Math.floor(c/b)*b)},_getIssueIdForKey:function(b){if(this._initialSelectedIssue&&b===this._initialSelectedIssue.key){return this._initialSelectedIssue.id}return this._getIssueKeysToIds()[b]},_getIssueKeyForId:function(b){if(this._initialSelectedIssue&&b===this._initialSelectedIssue.id){return this._initialSelectedIssue.key}return this._getIssueIdsToKeys()[b]},_getIssueIdsToKeys:function(){return this._issueSearchManager.issueKeys.getAllCached()},_getIssueKeysToIds:function(){var b={};var c=this._issueSearchManager.issueKeys.getAllCached();_.each(c,function(e,d){b[e]=d});return b},_getPageNumberForStartIndex:function(b){return Math.floor(b/this._pageSize())},_pageSize:function(){return this.getPageSize()},_triggerPrevIssueSelectedEvent:function(c){if(c!==this.getSelectedIssue().getId()){var b=this._getPrevIssueId(c);this.trigger("prevIssueSelected",{prevIssue:{id:c,key:this._getIssueKeyForId(c)},prevPrevIssue:{id:b,key:this._getIssueKeyForId(b)}})}},_triggerNextIssueSelectedEvent:function(b){if(b!==this.getSelectedIssue().getId()){var c=this._getNextIssueId(b);this.trigger("nextIssueSelected",{nextIssue:{id:b,key:this._getIssueKeyForId(b)},nextNextIssue:{id:c,key:this._getIssueKeyForId(c)}})}}}))})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/search/SearchModule.js' */
Backbone.define("JIRA.Issues.SearchModule",JIRA.Issues.BaseEvented.extend({initialize:function(a){this._issueSearchManager=a.issueSearchManager;this._searchPageModule=a.searchPageModule;this._searchResults=new JIRA.Issues.SearchResults(null,{issueSearchManager:this._issueSearchManager,initialHighlightedIssueId:a.initialHighlightedIssueId,initialSelectedIssue:a.initialSelectedIssue,columnConfig:this._searchPageModule.columnConfig})},doSort:function(c){if(!(c.fieldId||c.jql)){throw"one of sortOptions.fieldId or sortOptions.jql must be provided"}var a=c.jql;if(c.fieldId){var b=this.getResults().getColumnSortJql();a=b?b[c.fieldId]:null}if(a){this._searchPageModule.update({jql:a,startIndex:null,selectedIssueKey:null},true)}},getFilterId:function(){var a=this._searchPageModule.getFilter();return a&&a.getId()},getJql:function(){return this._searchPageModule.getJql()},getEffectiveJql:function(){return this._searchPageModule.getEffectiveJql()},getResults:function(){return this._searchResults},getState:function(){return this._searchPageModule.getState()},isStandAloneIssue:function(a){a=a||this._searchPageModule.getState();return !!a.selectedIssueKey&&!_.isString(a.jql)&&!a.filter},onBeforeSearch:function(b,a){this._issueSearchManager.bindBeforeSearch(b,a)},offBeforeSearch:function(b,a){this._issueSearchManager.unbindBeforeSearch(b,a)},onSearchError:function(b,a){this._issueSearchManager.bindSearchError(b,a)},offSearchError:function(b,a){this._issueSearchManager.unbindSearchError(b,a)},refresh:function(){return this._searchPageModule.refreshSearch()},stableUpdate:function(a){this._searchResults.triggerStableUpdate(_.extend({force:true},a))}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/search/IssueAPI.js' */
JIRA.Issues.IssueAPI=(function(){var a;var b={getIssueId:function(){return JIRA.Issues.Api.getSelectedIssueId()},getIssueKey:function(){return JIRA.Issues.Api.getSelectedIssueKey()}};return{override:function(c){c=_.defaults({},c,{target:JIRA.Issue});a=c.searchPageModule;_.extend(c.target,b)}}})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/search/IssuesApi.js' */
JIRA.Issues.Api=(function(){var a,d;function c(){var e=a&&a.issueModule&&a.issueModule.viewIssueController;return e||undefined}function b(){var f=c(),e=f&&f.getSelectedEditIssueController();return e||undefined}return{initialize:function(e){a=e.searchPageModule;d=e.saveInProgressManager},editFieldOnSelectedIssue:function(f){var e=JIRA.Issues.Api.getFieldsOnSelectedIssue(),g=e&&e.get(f),h=g&&g.isEditable();h&&a.issueModule.editField(g);return h},focusSearch:function(){AJS.$(".criteria-selector:first, #advanced-search").focus().select()},getSelectedIssue:function(){return a.getEffectiveIssue()},getSelectedIssueId:function(){return a.getEffectiveIssueId()},getSelectedIssueKey:function(){return a.getEffectiveIssueKey()},getFieldsOnSelectedIssue:function(){var e=b();if(e){return e.getFields()}},hasSavesInProgress:function(){return d.hasSavesInProgress()},isCurrentlyLoadingIssue:function(){return a.isCurrentlyLoadingIssue()},isSelectedIssueAccessible:function(){return a.isHighlightedIssueAccessible()},issueIsVisible:function(){return a.isIssueVisible()},nextIssue:function(){a.nextIssue()},openFocusShifter:function(){if(a.isIssueVisible()){a.openFocusShifter()}},prevIssue:function(){a.prevIssue()},refreshSelectedIssue:function(e){var f;if(a&&a.issueModule){f=a.issueModule.refreshIssue(e)}else{f=jQuery.Deferred().resolve().promise()}return f},returnToSearch:function(e){a.returnToSearch({ignoreDirtiness:e})},showInlineIssueLoadError:function(e){a.showInlineIssueLoadError(e)},switchLayouts:function(f){var e=-1,g=a.getCurrentLayout(),i=a.getSortedLayouts(),h;_.find(i,function(k,j){if(g instanceof k.view){e=j;return true}});h=i[(e+1)%i.length];a.changeLayout(h.id,f)},isQueryValid:function(){return a.queryModule.isQueryValid()},isFullScreenIssueVisible:function(){return a.isFullScreenIssueVisible()},viewSelectedIssue:function(){if(!JIRA.Issues.Api.isSelectedIssueAccessible()){return}var e=JIRA.Issues.Api.getSelectedIssueKey(),f=JIRA.Issues.DarkFeatures.KILL_SWITCH.enabled();if(f){try{window.location=AJS.contextPath()+"/browse/"+e}catch(g){}}else{if(!a.isIssueVisible()){JIRA.Issues.Analytics._loadIssueReason="issues-api-view-selected";a.update({selectedIssueKey:e})}}},toggleFilterPanel:function(){a.toggleFilterPanel()},waitForSavesToComplete:function(){var e=jQuery.Deferred();window.setTimeout(function(){if(!JIRA.Issues.Api.hasSavesInProgress()){e.resolve()}else{JIRA.bind(JIRA.Events.INLINE_EDIT_SAVE_COMPLETE,function(f){if(!JIRA.Issues.Api.hasSavesInProgress()){e.resolve()}})}},10)},updateIssue:function(e,f){f=f||"thanks_issue_updated";return a.updateIssue({key:e.key,id:e.id,action:JIRA.Issues.Actions.UPDATE,message:f,meta:{}})}}})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/search/LayoutPreferenceManager.js' */
JIRA.Issues.LayoutPreferenceManager={PREFERRED_LAYOUT_KEY:"jira.issues.preferred.layout.key",getPreferredLayoutKey:function(){return AJS.Meta.get(this.PREFERRED_LAYOUT_KEY)},setPreferredLayoutKey:function(b,a){a=_.defaults({},a,{ajax:true});AJS.Meta.set(this.PREFERRED_LAYOUT_KEY,b);a.ajax&&AJS.$.ajax({data:{layoutKey:b},type:"POST",headers:JIRA.Issues.XsrfTokenHeader,url:AJS.contextPath()+"/rest/issueNav/latest/preferredSearchLayout"})}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/search/SearchPageModule.js' */
Backbone.define("JIRA.Issues.SearchPageModule",JIRA.Issues.BaseModel.extend({namedEvents:["changeFilterProps"],properties:["currentLayout","layouts","filter","jql","searchId"],defaults:function(){return{filter:null,jql:null}},initialize:function(a,b){_.bindAll(this);_.extend(this,b);this.registerColumnPicker();this.setLayouts({});this.registerLayout("list-view",{label:"List View",iconClass:"icon-view-list",view:JIRA.Issues.FullScreenLayout});this.registerLayout("split-view",{label:"Detail View",iconClass:"icon-view-split",view:JIRA.Issues.SplitScreenLayout});this._onFilterChanged();this.on("change:filter",this._onFilterChanged)},registerColumnPicker:function(){this.columnConfig=JIRA.Issues.ColumnPicker.create({search:this})},getInactiveLayouts:function(){var a=[];_.each(this.getLayouts(),function(c,b){if(b!==JIRA.Issues.LayoutPreferenceManager.getPreferredLayoutKey()){a.push(c)}},this);return a},getActiveLayout:function(){return this.getLayouts()[JIRA.Issues.LayoutPreferenceManager.getPreferredLayoutKey()]},changeLayout:function(c,b){var d=this.getLayout(c),e,a=this.getCurrentLayout();JIRA.Issues.changingLayout=true;jQuery("body, html").scrollTop(0);b=_.defaults({},b,{ajax:true,render:true});if(d){if(a instanceof d.view){return}if(a&&a.deactivate){a.deactivate();this.searchResults.unselectIssue({replace:true})}JIRA.Issues.LayoutPreferenceManager.setPreferredLayoutKey(c,b);e=new d.view({},{fullScreenIssue:this.fullScreenIssue,issueContainer:this.issueContainer,issueModule:this.issueModule,issueCacheManager:this.issueCacheManager,search:this.search,searchContainer:this.searchContainer,searchHeaderModule:this.searchHeaderModule,columnConfig:this.columnConfig});b.render&&e.render();this.setCurrentLayout(e);this.standalone=false}},createLayout:function(){if(!this.getCurrentLayout()){this.changeLayout(JIRA.Issues.LayoutPreferenceManager.getPreferredLayoutKey(),{render:false});this.fullScreenIssue.deactivate()}},_onFilterChanged:function(){var a=this.previous("filter");if(a){a.off("change",this.triggerChangeFilterProps,this)}var b=this.getFilter();if(b){b.on("change",this.triggerChangeFilterProps,this)}},getLayout:function(a){return this.getLayouts()[a]||null},getSortedLayouts:function(){return _.sortBy(this.getLayouts(),"label")},registerLayout:function(a,b){b.id=a;this.getLayouts()[a]=b},getJqlDeferred:function(){var b=jQuery.Deferred();var a=this;_.defer(function(){a.queryModule.searchersReady().always(function(){_.defer(function(){b.resolve(a.getEffectiveJql())})})});return b.promise()},registerIssueSearchManager:function(a){this.issueSearchManager=a},registerIssueCacheManager:function(a){this.issueCacheManager=a},registerQueryModule:function(a){this.queryModule=a;this.queryModule.onJqlChanged(this.queryModuleSearchRequested,this);this.queryModule.onJqlError(this.disableLayoutSwitcher,this);this.queryModule.onJqlSuccess(this.enableLayoutSwitcher,this);this.queryModule.onVerticalResize(JIRA.Issues.triggerVerticalResize);this.queryModule.onQueryTooComplexSwitchToAdvanced(function(){JIRA.Issues.Analytics.trigger("kickass.queryTooComplexSwitchToAdvanced")});this.queryModule.onBasicModeCriteriaCountWhenSearching(function(b){JIRA.Issues.Analytics.trigger("kickass.basicModeCriteriaCountWhenSearching",b)});this.queryModule.onChangedPreferredSearchMode(function(b){JIRA.Issues.Analytics.trigger("kickass.switchto"+b)});JIRA.Shifter.register(JIRA.Issues.SearchShifter({isBasicMode:_.bind(this.queryModule.isBasicMode,this.queryModule),isFullScreenIssue:_.bind(this.isFullScreenIssueVisible,this),searcherCollection:this.queryModule.getSearcherCollection()}))},disableLayoutSwitcher:function(){if(this.layoutSwitcher){this.layoutSwitcher.disableLayoutSwitcher()}},enableLayoutSwitcher:function(){if(this.layoutSwitcher){this.layoutSwitcher.enableLayoutSwitcher()}},registerLayoutSwitcher:function(a){this.layoutSwitcher=a},registerFilterModule:function(a){this.filterModule=a},registerSearch:function(b){this.search=b;this.searchResults=this.search.getResults();this.searchResults.onStartIndexChange(this._handleSearchResultsChange);this.searchResults.onSelectedIssueChange(this._handleSearchResultsChange);var a=this.columnConfig;this.on("change:filter",function(){a.clearFilterConfiguration()});this.searchResults.onColumnsChange(function(c){var d=c.getColumnConfig();if(d){a.syncColumns(d,c.getColumns())}});this.searchResults.onColumnConfigChange(function(c){var d=c.getColumnConfig();if(d){a.setCurrentColumnConfig(d);a.syncColumns(d,c.getColumns())}});a.onColumnsSync(function(c){b.stableUpdate({columnConfig:c})})},_handleSearchResultsChange:function(b,a){a=a||{};a.replace?this.issueNavRouter.replaceState(this.getState()):this.issueNavRouter.pushState(this.getState())},registerSearchHeaderModule:function(a){this.searchHeaderModule=a},registerFullScreenIssue:function(a){this.fullScreenIssue=a;this.fullScreenIssue.bindIssueHidden(function(){this.issueModule.dismiss();this.searchHeaderModule.handleIssueSearchAppeared()},this)},registerIssueModule:function(a){this.issueModule=a;this.issueModule.bindReturnToSearch(this.returnToSearch);this.searchResults.onSelectedIssueChange(_.bind(function(b){if(!b.hasIssue()){this.issueModule.removeIssueMetadata()}},this));this.issueModule.bindLoadComplete(function(b,c){if(!this.standalone&&!c.reason){this.searchResults.selectIssueById(b.getId(),{reason:"issueLoaded"})}},this);this.issueModule.getLoading().done(_.bind(function(b){if(!this.standalone){this.searchResults.updateIssueById({id:b.issue.id,action:"rowUpdate"},{filter:this.getFilter()})}},this));this.issueModule.getUpdating().done(_.bind(function(c){if(c.taskKey==="issue"){var b=c.data[0]&&c.data[0].issue.key;if(b){var d=this._getUpdateState({selectedIssueKey:b});if(this._validateNavigate(d)){this.issueNavRouter.replaceState(d)}}}},this));this.issueModule.bindSaveSuccess(function(b){this.searchResults.updateIssueById({id:b,action:"inlineEdit"},{filter:this.getFilter()})},this)},registerViewContainers:function(a){this.issueContainer=a.issueContainer;this.searchContainer=a.searchContainer},registerIssueNavRouter:function(a){this.issueNavRouter=a},prevIssue:function(){if(this._overlayIsVisible()){return false}if(this.issueModule.canDismissComment()&&!this.standalone){JIRA.Issues.Analytics._loadIssueReason="issues-api-next-prev";this.getCurrentLayout().prevIssue();return true}return false},nextIssue:function(){if(this._overlayIsVisible()){return false}if(this.issueModule.canDismissComment()&&!this.standalone){JIRA.Issues.Analytics._loadIssueReason="issues-api-next-prev";this.getCurrentLayout().nextIssue();return true}return false},isCurrentlyLoadingIssue:function(){return this.issueModule.isCurrentlyLoading()},_overlayIsVisible:function(){return AJS.$(".aui-blanket:visible").length>0},getEffectiveIssueId:function(a){return this.getEffectiveIssue().getId()},updateIssue:function(c){var b=c.action===JIRA.Issues.Actions.DELETE,a=this.fullScreenIssue.isVisible();if(b){return this._deleteIssue(c)}else{if(a){return this.fullScreenIssue.updateIssue(c).done(_.bind(function(){!this.standalone&&this.searchResults.updateIssue(c,{showMessage:false,filter:this.getFilter()})},this))}else{return this.searchResults.updateIssue(c,{filter:this.getFilter()})}}},_deleteIssue:function(c){var a=this.fullScreenIssue.isVisible(),b=c.key==this.issueModule.getIssueKey();if(!a){return this.searchResults.updateIssue(c)}else{if(!b){return this.fullScreenIssue.updateIssue(c)}else{if(this.standalone){this.resetToBlank();JIRA.Issues.showNotification(c.message,c.key);return jQuery.Deferred().resolve().promise()}else{this.returnToSearch();return this.searchResults.updateIssue(c)}}}},getEffectiveIssueKey:function(){return this.getEffectiveIssue().getKey()},getEffectiveIssue:function(){var b=this.searchResults.hasHighlightedIssue(),c=this.searchResults.hasSelectedIssue(),a;a=new JIRA.Issues.SimpleIssue({id:this.issueModule.getIssueId(),key:this.issueModule.getIssueKey()});if(this.standalone){return a}else{if(c){return this.searchResults.getSelectedIssue()}else{if(b){return this.searchResults.getHighlightedIssue()}else{return a}}}},isHighlightedIssueAccessible:function(){return this.search.getResults().isHighlightedIssueAccessible()},returnToSearch:function(){if(this.standalone){this.resetToBlank();JIRA.trace("jira.returned.to.search")}else{if(this.fullScreenIssue.isVisible()){this.searchResults.unselectIssue();this.issueModule.beforeHide()}else{JIRA.trace("jira.returned.to.search")}}jQuery.event.trigger("updateOffsets.popout")},toggleFilterPanel:function(){return this.filterModule.toggleFilterPanel()},issueTableSortRequested:function(a,b){this.update({jql:a,startIndex:b})},issueTableSearchError:function(a){if(a.status!==0){this.searchHeaderModule.handleJqlError();var c;try{c=JSON.parse(a.responseText)}catch(b){c={errorMessages:["Error occurred communicating with the server. Please reload the page and try again."]}}this.queryModule.onSearchError(c)}},issueTableSearchSuccess:function(a){this.update({startIndex:a.startIndex});this.searchHeaderModule.handleJqlSuccess();this.queryModule.onSearchSuccess(a.warnings)},issueTableStableUpdate:function(a){this.update({startIndex:a})},confirmNavigation:function(a){a=_.defaults({},a,{confirm:function(c){return window.confirm(c)},ignoreDirtiness:false});var b=JIRA.DirtyForm.getDirtyWarning()||JIRA.Issue.getDirtyCommentWarning();return !!a.ignoreDirtiness||b===undefined||a.confirm(b)},isFullScreenIssueVisible:function(){return this.fullScreenIssue&&this.fullScreenIssue.isVisible()},isIssueVisible:function(){var a=JIRA.Issues.LayoutPreferenceManager.getPreferredLayoutKey();if(this.isFullScreenIssueVisible()){return true}else{if(a==="list-view"){return this.fullScreenIssue.isVisible()}else{if(a==="split-view"){return this.search.getResults().hasIssues()}}}return false},queryModuleSearchRequested:function(a){this.update({jql:a,startIndex:0,selectedIssueKey:null,searchId:_.uniqueId()})},filterModuleSaved:function(b,a){if(a){this.reset({filter:b.getId()})}if(b.getFavourite()){this.filterModule.addFavouriteFilter(b)}},discardFilterChanges:function(){this.update({jql:null,selectedIssueKey:null},true)},getState:function(){var a=this.getFilter();var b={filter:a&&a.getId(),filterJql:a&&a.getJql(),jql:this.getJql()};if(this.standalone){b.selectedIssueKey=this.issueModule.getIssueKey()}else{_.extend(b,this.search.getResults().getState())}return b},_doSearch:function(a){a=a||{};var b={};var d;var c=this.getFilter();b.startIndex=a.startIndex;if(c){b.filterId=c.getId()}if(a.columnConfig){b.columnConfig=a.columnConfig}b.jql=this.getEffectiveJql();d=this.issueSearchManager.search(b);d.done(_.bind(function(e){if(this.fullScreenIssue.isVisible()&&!AJS.Meta.get("serverRenderedViewIssue")){this.issueModule.beforeHide()}this.searchResults.resetFromSearch(_.extend(a,e.issueTable));this.queryModule.onSearchSuccess(e.warnings);jQuery.event.trigger("updateOffsets.popout")},this)).fail(_.bind(function(e){if(e.statusText!=="abort"){if(e.status==400&&a.selectedIssueKey){this.reset({selectedIssueKey:a.selectedIssueKey},{replace:true})}else{this.searchResults.resetFromSearch(_.extend(_.pick(a,"selectedIssueKey"),this.searchResults.defaults));this.issueTableSearchError(e)}}},this));return d},_applyState:function(d,g,c){c=c||{};var f=_.extend(this.toJSON(),this.search.getResults().toJSON());var b=_.pick(d,this.properties);this.set(b);var e=_.extend(this.toJSON(),d);if(g){var a=(d.filter&&d.jql==null)?d.filter.getJql():d.jql;this.queryModule.resetToQuery(a,{focusQuery:c.isNewSearch}).always(_.bind(function(){this.queryModule.setVisible(!d.filter||d.filter.getIsValid())},this))}if(this.shouldPerformNewSearch(f,e)){var h=this._doSearch(e)}else{var h=jQuery.Deferred().resolve();if("selectedIssueKey" in d){this.searchResults.selectIssueByKey(d.selectedIssueKey)}if("startIndex" in d&&!d.selectedIssueKey){this.searchResults.goToPage(d.startIndex)}}this._showIntroDialogs(h)},shouldPerformNewSearch:function(f,e){var g=f.filter&&f.filter.getId();var a=e.filter&&e.filter.getId();var c=g!==a;var d=e.jql!==f.jql;var b=e.searchId!==f.searchId;return c||d||b},refreshSearch:function(){return this._doSearch(_.extend({},this.getState(),{selectedIssueKey:undefined}))},_navigateToState:function(b,c,a){a=a||{};if(!this.issueModule.canDismissComment()){this.queryModule.queryChanged();AJS.InlineLayer.current&&AJS.InlineLayer.current.hide();return null}if(this._validateNavigate(b)){a.replace?this.issueNavRouter.replaceState(b):this.issueNavRouter.pushState(b)}if(this.search.isStandAloneIssue(b)){this.resetToStandaloneIssue(b)}else{return this.applyState(b,c,a)}},_validateNavigate:function(b){var a=JIRA.Issues.URLSerializer.getURLFromState;return a(b)!==a(this.getState())},_getUpdateState:function(a){return _.extend({},this.getState(),a)},update:function(b,c,a){this._navigateToState(this._getUpdateState(b),c,a)},reset:function(c,b){var a=_.extend({},this.defaults(),c);a.searchId=_.uniqueId();this._navigateToState(a,true,b)},_deactivateCurrentLayout:function(){var a=this.getCurrentLayout();if(a){a.deactivate&&a.deactivate();this.setCurrentLayout(null)}},resetToStandaloneIssue:function(a){this._deactivateCurrentLayout();this.set(this.defaults());this.standalone=true;this.fullScreenIssue.show({key:a.selectedIssueKey,viewIssueQuery:a.viewIssueQuery})},applyState:function(d,f,c){var b,a=d.filter&&!(d.filter instanceof JIRA.Issues.FilterModel),e=this.initSystemFilters();this.issueModule.abortPending();this.createLayout();if(a){b=jQuery.Deferred();e.always(_.bind(function(){this.filterModule.getFilterById(d.filter).always(function(g){d.filter=g;b.resolve()})},this))}jQuery.when(b,e).always(_.bind(function(){this._applyState(d,f,c)},this))},updateFromRouter:function(a){if(this.search.isStandAloneIssue(a)){this.resetToStandaloneIssue(a)}else{this.applyState(a,!this._isSearchStateEqual(a))}},hasSelectedIssue:function(){return this.search.getResults().getSelectedIssue().getKey()},resetToFilter:function(a){this.reset({filter:a,searchId:_.uniqueId()})},resetToBlank:function(a){this.reset({jql:""},a)},isDirty:function(){var a=this.getFilter();return !!a&&a.getJql()!==this.getEffectiveJql()},getSearchMode:function(){return this.queryModule.getSearchMode()},getActiveBasicModeSearchers:function(){return this.queryModule.getActiveBasicModeSearchers()},setSessionSearch:function(a){AJS.$.ajax({data:{filterId:a.getId()},type:"PUT",url:AJS.contextPath()+"/rest/issueNav/1/issueTable/sessionSearch/"})},openFocusShifter:function(){this.issueModule.openFocusShifter()},setAsInaccessible:function(a){this.issueTableModule.setAsInaccessible(a)},showInlineIssueLoadError:function(b){var a=JIRA.Templates.ViewIssue.Body.errorsLoading({});JIRA.Messages.showErrorMsg(a,{closeable:true})},getEffectiveJql:function(){var b=this.getFilter(),a=this.getJql();if(_.isString(a)){return a}else{if(b){return b.getJql()||""}else{return""}}},initSystemFilters:function(){return this.filterModule.initSystemFilters()},addOwnerToSystemFilters:function(c){var d=AJS.Meta.get("remote-user");if(!d){return c}var b=AJS.Meta.get("remote-user-fullname");var a=AJS.Meta.get("remote-user-avatar-url");return _.map(c,function(e){e.ownerUserName=d;e.ownerDisplayName=b;e.avatarUrl=a;return e})},handleLeft:function(){if(this._allowLeftRightNavigation()){this.getCurrentLayout()&&this.getCurrentLayout().handleLeft()}},handleRight:function(){if(this._allowLeftRightNavigation()){this.getCurrentLayout()&&this.getCurrentLayout().handleRight()}},handleUp:function(){if(!this._allowUpDownNavigation()){return false}if(this.searchResults.isFirstIssueHighlighted()){return false}return this.prevIssue()},handleDown:function(){if(!this._allowUpDownNavigation()){return false}return this.nextIssue()},_allowLeftRightNavigation:function(){return !AJS.keyboardShortcutsDisabled},_allowUpDownNavigation:function(){if(AJS.keyboardShortcutsDisabled){return false}if(AJS.InlineLayer.current||AJS.Dropdown.current||JIRA.Dialog.current||AJS.$(".aui-dropdown2:visible").length>0){return false}return this.getCurrentLayout()&&!this.getCurrentLayout().isIssueViewActive()},_isSearchStateEqual:function(a){var b=["filter","jql","startIndex"];return _.isEqual(_.pick(a,b),_.pick(this.getState(),b))},removeOpenTipsies:JIRA.Issues.Tipsy.revalidate,_showIntroDialogs:function(a){if(!this._shownIntroDialog&&this.layoutSwitcher){jQuery.when(a,this.filterModule.filterPanelView.panelReady).done(_.bind(function(){var b="split-view-intro";if(this.layoutSwitcher.$el.is(":visible")&&this.search.getResults().hasIssues()){new AJS.HelpTip({id:b,title:"Choose how you view issues",url:AJS.Meta.get("issue-search-help-url"),bodyHtml:"Switch between the details and list views to suit your preference.",anchor:".view-selector button",isSequence:true,weight:1})}this.filterModule.createHelptipForFilterPanelDocking();AJS.HelpTip.Manager.showSequences()},this));this._shownIntroDialog=true}}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/search/EmptyResultsView.js' */
Backbone.define("JIRA.Issues.EmptyResultsView",JIRA.Issues.BaseView.extend({initialize:function(a){this.searchResults=a.searchResults},render:function(){var d;var e;var b;var a;var c=JIRA.Issues.UserParms.get().createIssue;if(!JIRA.Issues.LoginUtils.isLoggedIn()){d="No issues were found to match your search";e="Try \u003ca>logging in\u003c\/a> to see more results";b="not-logged-in-message";a="login"}else{if(this.searchResults.getJiraHasIssues()===false){d="No issues have been created (yet)";e=c?"Be the first to \u003ca>create an issue\u003c\/a>":null;b="empty-results-message";a="create"}else{d="No issues were found to match your search";e=c?"Try modifying your search criteria or \u003ca>creating a new issue\u003c\/a>":"Try modifying your search criteria";b="no-results-message";a="create"}}this.$el.addClass("empty-results");this.$el.html(JIRA.Templates.IssueNavTable.noResults({message:d,hint:e,cssClass:b}));var f=this.$(".no-results-hint a");switch(a){case"create":f.addClass("create-issue").attr("href",AJS.contextPath()+"/secure/CreateIssue!default.jspa");break;case"login":f.attr("href",JIRA.Issues.LoginUtils.redirectUrlToCurrent()).addClass("login-link");break}_.defer(jQuery.event.trigger,"updateOffsets.popout");_.defer(JIRA.trace,"jira.search.finished")}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/util/URLSerializer.js' */
(function(){var b="browse/",d="issues/";var c=function(e){return e};var a=function(e){if(typeof e==="string"){return parseInt(e,10)}return e};JIRA.Issues.URLSerializer={getURLFromState:function(g){g=g||{};var f=[];var e;if(g.selectedIssueKey){e=b+g.selectedIssueKey}else{e=d}if(g.filter!=null){f.push("filter="+g.filter)}if(g.jql!=null&&(g.filterJql==null||g.jql!==g.filterJql)){f.push("jql="+encodeURIComponent(g.jql))}if(g.startIndex&&!g.selectedIssueKey){f.push("startIndex="+g.startIndex)}return e+(f.length?"?"+f.join("&"):"")},getStateFromURL:function(e){var g={},i=e.split("?")[0],j,h;h={filter:null,jql:null,selectedIssueKey:null,startIndex:0};if(e.indexOf(b)==0){h.selectedIssueKey=i.split("/")[1]}if(e.indexOf("?")!==-1){j=e.substr(e.indexOf("?"));g=JIRA.Issues.QueryStringParser.parse(j);var f=_.pick(g,"focusedCommentId","attachmentSortBy","attachmentOrder");if(!_.isEmpty(f)){h.viewIssueQuery=f}}return _.inject(this.PARAMETER_TRANSFORM,function(n,k,l){var m=g[l];if(m!==undefined){n[l]=k(m)}return n},_.extend(h))},PARAMETER_TRANSFORM:{filter:c,jql:c,startIndex:a}}})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/js/viewissue/util/Overrides.js' */
JIRA.Messages.showMsgOnReload=function(b,a){JIRA.one(JIRA.Events.ISSUE_REFRESHED,function(){a.type=JIRA.Messages.Types[a.type];JIRA.Messages.showMsg(b,a)})};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/templates/viewissue-header-content.soy' */
// This file was automatically generated from viewissue-header-content.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ViewIssue == 'undefined') { JIRA.Templates.ViewIssue = {}; }
if (typeof JIRA.Templates.ViewIssue.Header == 'undefined') { JIRA.Templates.ViewIssue.Header = {}; }


JIRA.Templates.ViewIssue.Header.pager = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul class="ajax ops page-navigation ', (opt_data.invalidSearchContext) ? ' pager-invalid-search-context ' : '', '"><li class="previous">', (opt_data.previousIssue) ? '<a data-id="' + soy.$$escapeHtml(opt_data.previousIssue.id) + '" data-key="' + soy.$$escapeHtml(opt_data.previousIssue.key) + '" href="' + soy.$$escapeHtml("") + '/browse/' + soy.$$escapeHtml(opt_data.previousIssue.key) + '" id="previous-issue" rel="' + soy.$$escapeHtml(opt_data.previousIssue.key) + '" title="' + soy.$$escapeHtml("Previous Issue") + ' \'' + soy.$$escapeHtml(opt_data.previousIssue.key) + '\'"><span class="icon icon-page-prev"><span>' + soy.$$escapeHtml("Previous Issue") + ' \'' + soy.$$escapeHtml(opt_data.previousIssue.key) + '\'</span></span></a>' : (! opt_data.invalidSearchContext) ? '<span class="icon icon-page-prev-deactivated" title="' + soy.$$escapeHtml("Not available - this is the first issue") + '"></span>' : '', '</li><li class="showing">', (opt_data.invalidSearchContext) ? '<span class="aui-icon icon-warning" title="' + soy.$$escapeHtml(opt_data.invalidSearchContext) + '"></span>' : (opt_data.position && opt_data.resultCount) ? soy.$$escapeHtml(AJS.format("{0} of {1}",opt_data.position,opt_data.resultCount)) : '', '</li><li class="next">', (opt_data.nextIssue) ? '<a data-id="' + soy.$$escapeHtml(opt_data.nextIssue.id) + '" data-key="' + soy.$$escapeHtml(opt_data.nextIssue.key) + '" href="' + soy.$$escapeHtml("") + '/browse/' + soy.$$escapeHtml(opt_data.nextIssue.key) + '" id="next-issue" rel="' + soy.$$escapeHtml(opt_data.nextIssue.key) + '" title="' + soy.$$escapeHtml("Next Issue") + ' \'' + soy.$$escapeHtml(opt_data.nextIssue.key) + '\'"><span class="icon icon-page-next"><span>' + soy.$$escapeHtml("Next Issue") + ' \'' + soy.$$escapeHtml(opt_data.nextIssue.key) + '\'</span></span></a>' : (! opt_data.invalidSearchContext) ? '<span class="icon icon-page-next-deactivated" title="' + soy.$$escapeHtml("Not available - this is the last issue") + '"></span>' : '', '</li>', (opt_data.returnToSearch) ? '<li class="return"><a id="return-to-search" href="' + soy.$$escapeHtml("") + '/issues/" title="' + soy.$$escapeHtml("Return to Search") + '">' + soy.$$escapeHtml("Return to Search") + '</a></li>' : '', '</ul>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ViewIssue.Header.linkGroup = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.group.header && opt_data.group.header.label) {
    if (opt_data.group.links.length > 0 || opt_data.group.groups.length > 0) {
      JIRA.Templates.ViewIssue.Header.dropdownLink(opt_data.group, output);
    }
  } else {
    output.append('<ul ', (opt_data.group.id) ? 'id="opsbar-' + soy.$$escapeHtml(opt_data.group.id) + '" ' : '', 'class="toolbar-group pluggable-ops">');
    var linkList93 = opt_data.group.links;
    var linkListLen93 = linkList93.length;
    for (var linkIndex93 = 0; linkIndex93 < linkListLen93; linkIndex93++) {
      var linkData93 = linkList93[linkIndex93];
      JIRA.Templates.ViewIssue.Header.toolbarItem({link: linkData93}, output);
    }
    var subGroupList97 = opt_data.group.groups;
    var subGroupListLen97 = subGroupList97.length;
    for (var subGroupIndex97 = 0; subGroupIndex97 < subGroupListLen97; subGroupIndex97++) {
      var subGroupData97 = subGroupList97[subGroupIndex97];
      JIRA.Templates.ViewIssue.Header.linkGroup({group: subGroupData97}, output);
    }
    output.append('</ul>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ViewIssue.Header.dropdownLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="toolbar-item toolbar-dropdown"><div><a href="#" ', (opt_data.header.id) ? ' id="' + soy.$$escapeHtml(opt_data.header.id) + '"' : '');
  JIRA.Templates.ViewIssue.Header.titleAttr({title: opt_data.header.title, label: opt_data.header.label}, output);
  output.append(' data-hide-on-scroll=".split-view .issue-container" data-contain-to-window="true" class="toolbar-trigger ', (opt_data.links.length > 0 || opt_data.groups.length > 0) ? ' js-default-dropdown' : '', (opt_data.header.styleClass) ? ' ' + soy.$$escapeHtml(opt_data.header.styleClass) : '', '" >', (opt_data.header.iconClass) ? '<span class="icon ' + soy.$$escapeHtml(opt_data.header.iconClass) + '"></span> ' : '', '<span class="dropdown-text">', soy.$$truncate(soy.$$escapeHtml(opt_data.header.label), 25, true), '</span><span class="icon drop-menu"></span></a><div class="aui-list hidden">');
  if (opt_data.links.length > 0) {
    output.append('<ul class="aui-list-section aui-first', (opt_data.groups.length == 0) ? ' aui-last' : '', '">');
    var linkList137 = opt_data.links;
    var linkListLen137 = linkList137.length;
    for (var linkIndex137 = 0; linkIndex137 < linkListLen137; linkIndex137++) {
      var linkData137 = linkList137[linkIndex137];
      JIRA.Templates.ViewIssue.Header.dropdownItem(linkData137, output);
    }
    output.append('</ul>');
  }
  var groupList141 = opt_data.groups;
  var groupListLen141 = groupList141.length;
  for (var groupIndex141 = 0; groupIndex141 < groupListLen141; groupIndex141++) {
    var groupData141 = groupList141[groupIndex141];
    output.append('<ul class="aui-list-section', (opt_data.links.length == 0 && groupIndex141 == 0) ? ' aui-first' : '', (groupIndex141 == groupListLen141 - 1) ? ' aui-last' : '', '">');
    var linkList150 = groupData141.links;
    var linkListLen150 = linkList150.length;
    for (var linkIndex150 = 0; linkIndex150 < linkListLen150; linkIndex150++) {
      var linkData150 = linkList150[linkIndex150];
      JIRA.Templates.ViewIssue.Header.dropdownItem(linkData150, output);
    }
    output.append('</ul>');
  }
  output.append('</div></div></li>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ViewIssue.Header.dropdownItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="aui-list-item"><a  href="', (opt_data.href) ? soy.$$escapeHtml(opt_data.href) : '#', '" class="aui-list-item-link', (opt_data.styleClass) ? ' ' + soy.$$escapeHtml(opt_data.styleClass) : '', '"');
  JIRA.Templates.ViewIssue.Header.titleAttr(opt_data, output);
  output.append((opt_data.id) ? 'id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', '><span class="trigger-label">', soy.$$truncate(soy.$$escapeHtml(opt_data.label), 25, true), '</span></a></li>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ViewIssue.Header.toolbarItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="toolbar-item"><a id="', soy.$$escapeHtml(opt_data.link.id), '"');
  JIRA.Templates.ViewIssue.Header.titleAttr({title: opt_data.link.title, label: opt_data.link.label}, output);
  output.append('class="toolbar-trigger', (opt_data.link.styleClass) ? ' ' + soy.$$escapeHtml(opt_data.link.styleClass) : '', '" href="', (opt_data.link.href) ? soy.$$escapeHtml(opt_data.link.href) : '#', '">', (opt_data.link.iconClass) ? '<span class="icon ' + soy.$$escapeHtml(opt_data.link.iconClass) + '"></span> <span class="trigger-label">' + soy.$$truncate(soy.$$escapeHtml(opt_data.link.label), 25, true) + '</span>' : '<span class="trigger-label">' + soy.$$truncate(soy.$$escapeHtml(opt_data.link.label), 25, true) + '</span>', '</a></li>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ViewIssue.Header.titleAttr = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.title) ? 'title="' + soy.$$escapeHtml(opt_data.title) + '"' : (opt_data.label && opt_data.label.length && opt_data.label.length > 25) ? 'title="' + soy.$$escapeHtml(opt_data.label) + '"' : '');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ViewIssue.Header.opsbar = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="ops-cont"><div class="ops-menus aui-toolbar">');
  var linkGroupList226 = opt_data.issue.operations.linkGroups;
  var linkGroupListLen226 = linkGroupList226.length;
  for (var linkGroupIndex226 = 0; linkGroupIndex226 < linkGroupListLen226; linkGroupIndex226++) {
    var linkGroupData226 = linkGroupList226[linkGroupIndex226];
    if (linkGroupData226.id && linkGroupData226.id == 'view.issue.opsbar') {
      output.append('<div class="toolbar-split toolbar-split-left">');
      var subGroupList230 = linkGroupData226.groups;
      var subGroupListLen230 = subGroupList230.length;
      for (var subGroupIndex230 = 0; subGroupIndex230 < subGroupListLen230; subGroupIndex230++) {
        var subGroupData230 = subGroupList230[subGroupIndex230];
        JIRA.Templates.ViewIssue.Header.linkGroup({group: subGroupData230, parentGroup: linkGroupData226}, output);
      }
      output.append('</div>');
    } else if (linkGroupData226.id && linkGroupData226.id == 'jira.issue.tools') {
      output.append('<div class="toolbar-split toolbar-split-right">');
      JIRA.Templates.ViewIssue.Header.linkGroup({group: linkGroupData226}, output);
      output.append('</div>');
    }
  }
  output.append('</div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/templates/viewissue-header.soy' */
// This file was automatically generated from viewissue-header.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ViewIssue == 'undefined') { JIRA.Templates.ViewIssue = {}; }
if (typeof JIRA.Templates.ViewIssue.Header == 'undefined') { JIRA.Templates.ViewIssue.Header = {}; }


JIRA.Templates.ViewIssue.Header.legacyIssueHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="issue-header-content"><div id="issue-header-pager">');
  if (opt_data.pager) {
    JIRA.Templates.ViewIssue.Header.pager(opt_data.pager, output);
  }
  output.append('</div><div id="heading-avatar"><img id="project-avatar" alt="" class="project-avatar-48" height="48" src="', soy.$$escapeHtml(opt_data.issue.project.avatarUrls['48x48']), '" width="48"></div><ul class="breadcrumbs"><li><a id="project-name-val" href="', soy.$$escapeHtml(""), '/browse/', soy.$$escapeHtml(opt_data.issue.project.key), '">', soy.$$escapeHtml(opt_data.issue.project.name), '</a> </li>', (opt_data.issue.parent && opt_data.issue.parent.id) ? '<li><a class="issue-link" data-issue-key="' + soy.$$escapeHtml(opt_data.issue.parent.key) + '" href="' + soy.$$escapeHtml("") + '/browse/' + soy.$$escapeHtml(opt_data.issue.parent.key) + '" id="parent_issue_summary" title="' + soy.$$escapeHtml(opt_data.issue.parent.summary) + '">' + soy.$$escapeHtml(opt_data.issue.parent.key) + ' ' + soy.$$escapeHtml(opt_data.issue.parent.summary) + '</a> </li>' : '', '<li><a class="issue-link" data-issue-key="', soy.$$escapeHtml(opt_data.issue.key), '" href="', soy.$$escapeHtml(""), '/browse/', soy.$$escapeHtml(opt_data.issue.key), '" id="key-val" rel="', soy.$$escapeHtml(opt_data.issue.id), '">', soy.$$escapeHtml(opt_data.issue.key), '</a></li></ul><h1 id="summary-val">', soy.$$escapeHtml(opt_data.issue.summary), '</h1><div class="command-bar">');
  if (opt_data.serverRenderedViewIssue) {
    JIRA.Templates.ViewIssue.Header.opsbar(opt_data, output);
  }
  output.append('</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ViewIssue.Header.issueHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="issue-header-content">');
  var param51 = new soy.StringBuilder();
  var param52 = new soy.StringBuilder();
  JIRA.Templates.Headers.projectAvatar({id: soy.$$escapeHtml(opt_data.issue.project.id), projectKey: soy.$$escapeHtml(opt_data.issue.project.key), projectName: soy.$$escapeHtml(opt_data.issue.project.name), avatarUrl: soy.$$escapeHtml(opt_data.issue.project.avatarUrls['48x48']), avatarAlt: soy.$$escapeHtml(opt_data.issue.project.name), isSystemAvatar: opt_data.issue.project.systemAvatar, hasProjectShortcut: opt_data.hasProjectShortcut}, param52);
  aui.page.pageHeaderImage({content: param52.toString()}, param51);
  aui.page.pageHeaderMain({content: '<ol class="aui-nav aui-nav-breadcrumbs"><li><a id="project-name-val" href="' + soy.$$escapeHtml("") + '/browse/' + soy.$$escapeHtml(opt_data.issue.project.key) + '">' + soy.$$escapeHtml(opt_data.issue.project.name) + '</a></li>' + ((opt_data.issue.parent && opt_data.issue.parent.id) ? '<li><a class="issue-link" data-issue-key="' + soy.$$escapeHtml(opt_data.issue.parent.key) + '" href="' + soy.$$escapeHtml("") + '/browse/' + soy.$$escapeHtml(opt_data.issue.parent.key) + '" id="parent_issue_summary" title="' + soy.$$escapeHtml(opt_data.issue.parent.summary) + '">' + soy.$$escapeHtml(opt_data.issue.parent.key) + ' ' + soy.$$escapeHtml(opt_data.issue.parent.summary) + '</a></li>' : '') + '<li><a class="issue-link" data-issue-key="' + soy.$$escapeHtml(opt_data.issue.key) + '" href="' + soy.$$escapeHtml("") + '/browse/' + soy.$$escapeHtml(opt_data.issue.key) + '" id="key-val" rel="' + soy.$$escapeHtml(opt_data.issue.id) + '">' + soy.$$escapeHtml(opt_data.issue.key) + '</a></li></ol><h1 id="summary-val">' + soy.$$escapeHtml(opt_data.issue.summary) + '</h1>'}, param51);
  var param104 = new soy.StringBuilder('<div id="issue-header-pager">');
  if (opt_data.pager) {
    JIRA.Templates.ViewIssue.Header.pager(opt_data.pager, param104);
  }
  param104.append('</div>');
  aui.page.pageHeaderActions({content: param104.toString()}, param51);
  aui.page.pageHeader({content: param51.toString()}, output);
  output.append('<div class="command-bar">');
  if (opt_data.serverRenderedViewIssue) {
    JIRA.Templates.ViewIssue.Header.opsbar(opt_data, output);
  }
  output.append('</div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/templates/viewissue-body.soy' */
// This file was automatically generated from viewissue-body.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ViewIssue == 'undefined') { JIRA.Templates.ViewIssue = {}; }
if (typeof JIRA.Templates.ViewIssue.Body == 'undefined') { JIRA.Templates.ViewIssue.Body = {}; }


JIRA.Templates.ViewIssue.Body.issueBody = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-group issue-body"><div class="aui-item issue-main-column"></div><div id="viewissuesidebar" class="aui-item issue-side-column"></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ViewIssue.Body.issueBodyWithPanels = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-group issue-body"><div class="aui-item issue-main-column">');
  if (opt_data.serverRenderedViewIssue) {
    var panelList10 = opt_data.panels.leftPanels;
    var panelListLen10 = panelList10.length;
    for (var panelIndex10 = 0; panelIndex10 < panelListLen10; panelIndex10++) {
      var panelData10 = panelList10[panelIndex10];
      JIRA.Templates.ViewIssue.Body.issuePanel(panelData10, output);
    }
  }
  output.append('</div><div id="viewissuesidebar" class="aui-item issue-side-column">');
  if (opt_data.serverRenderedViewIssue) {
    var panelList16 = opt_data.panels.rightPanels;
    var panelListLen16 = panelList16.length;
    for (var panelIndex16 = 0; panelIndex16 < panelListLen16; panelIndex16++) {
      var panelData16 = panelList16[panelIndex16];
      JIRA.Templates.ViewIssue.Body.issuePanel(panelData16, output);
    }
  }
  output.append('</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ViewIssue.Body.issuePanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.renderHeader) {
    output.append('<div id=', soy.$$escapeHtml(opt_data.id), ' class="module toggle-wrap"><div id="', soy.$$escapeHtml(opt_data.id), '_heading" class="mod-header"><ul class="ops">');
    var linkList28 = opt_data.headerLinks.links;
    var linkListLen28 = linkList28.length;
    for (var linkIndex28 = 0; linkIndex28 < linkListLen28; linkIndex28++) {
      var linkData28 = linkList28[linkIndex28];
      output.append('<li>');
      JIRA.Templates.Issues.Util.simpleLink({link: linkData28}, output);
      output.append('</li>');
    }
    if (opt_data.headerLinks.groups.length > 0) {
      output.append('<li class="drop"><div class="aui-dd-parent"><a href="#" class="icon drop-menu js-default-dropdown" title="', soy.$$escapeHtml("Options"), '"><span>', soy.$$escapeHtml("Options"), '</span></a><div class="aui-dropdown-content aui-list">');
      var groupList41 = opt_data.headerLinks.groups;
      var groupListLen41 = groupList41.length;
      for (var groupIndex41 = 0; groupIndex41 < groupListLen41; groupIndex41++) {
        var groupData41 = groupList41[groupIndex41];
        output.append((groupData41.header && groupData41.header.label) ? '<h5>' + soy.$$escapeHtml(groupData41.header.label) + '</h5>' : '', '<ul ', (groupData41.header && groupData41.header.id) ? 'id="' + soy.$$escapeHtml(groupData41.header.id) + '"' : '', 'class="aui-list-section', (groupData41.header && groupData41.header.styleClass) ? ' ' + soy.$$escapeHtml(groupData41.header.styleClass) : '', (groupIndex41 == 0) ? ' aui-first' : '', (groupIndex41 == groupListLen41 - 1) ? ' aui-last' : '', '">');
        var linkList65 = groupData41.links;
        var linkListLen65 = linkList65.length;
        for (var linkIndex65 = 0; linkIndex65 < linkListLen65; linkIndex65++) {
          var linkData65 = linkList65[linkIndex65];
          output.append('<li class="aui-list-item">');
          JIRA.Templates.Issues.Util.simpleLink({link: linkData65, additionalStyleClass: 'aui-list-item-link'}, output);
          output.append('</li>');
        }
        output.append('</ul>');
      }
      output.append('</div></div></li>');
    }
    output.append('</ul>');
    if (opt_data.subpanelHtmls.length > 0) {
      output.append('<div class="mod-header-panels">');
      var subPanelList79 = opt_data.subpanelHtmls;
      var subPanelListLen79 = subPanelList79.length;
      for (var subPanelIndex79 = 0; subPanelIndex79 < subPanelListLen79; subPanelIndex79++) {
        var subPanelData79 = subPanelList79[subPanelIndex79];
        output.append('<div class="mod-header-panel">', subPanelData79, '</div>');
      }
      output.append('</div>');
    }
    output.append('<h2 class="toggle-title">', soy.$$escapeHtml(opt_data.label), '</h2></div><div class="mod-content">', opt_data.html, '</div></div>');
  } else {
    output.append(opt_data.html);
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ViewIssue.Body.viewIssueNoPermissionError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.ViewIssue.Body.viewIssueError({title: "Permission Violation", body: "It seems that you have tried to perform an operation which you are not permitted to perform.", error: 'warning', returnToSearch: false, pager: opt_data.pager}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ViewIssue.Body.viewIssueDoesNotExistError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.ViewIssue.Body.viewIssueError({title: "Issue Does Not Exist", body: "The issue you are trying to view does not exist.", error: 'error', returnToSearch: ! opt_data.hideReturnToSearch, pager: opt_data.pager}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ViewIssue.Body.viewIssueGenericError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.ViewIssue.Body.viewIssueError({title: "Unexpected Error", body: "There was an unexpected error while loading the issue.", error: 'error', returnToSearch: false, pager: opt_data.pager}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ViewIssue.Body.viewIssueError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="issue-content" class="form-body"><header class="issue-header"><div class="issue-header-content"><header class="aui-page-header"><div class="aui-page-header-inner"><div class="aui-page-header-main"><h1>', soy.$$escapeHtml(opt_data.title), '</h1></div><div class="aui-page-header-actions"><div id="issue-header-pager">');
  if (opt_data.pager) {
    JIRA.Templates.ViewIssue.Header.pager(opt_data.pager, output);
  }
  output.append('</div></div></div></header></div></header><div class="issue-body-content"><div class="aui-message ', soy.$$escapeHtml(opt_data.error), '"><span class="aui-icon icon-', soy.$$escapeHtml(opt_data.error), '"></span><p>', soy.$$escapeHtml(opt_data.body), '</p><p>', soy.$$escapeHtml("If you think this message is wrong, please contact your"), '<a href="', soy.$$escapeHtml(""), '/secure/ContactAdministrators!default.jspa"> ', soy.$$escapeHtml("JIRA administrators"), '</a>.</p>', (opt_data.returnToSearch) ? '<p><a id="return-to-search" class="push-state" href="' + soy.$$escapeHtml("") + '/issues/" title="' + soy.$$escapeHtml("Return to Search") + '">' + soy.$$escapeHtml("Return to Search") + '</a></p>' : '', '</div></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ViewIssue.Body.errorsLoading = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.isTimeout) ? soy.$$escapeHtml("The JIRA server could not be contacted.  This may be a temporary glitch or the server may be down.") : soy.$$escapeHtml("There were errors loading the issue."));
  if (opt_data.errorMessages) {
    output.append('<ul>');
    var msgList155 = opt_data.errorMessages;
    var msgListLen155 = msgList155.length;
    for (var msgIndex155 = 0; msgIndex155 < msgListLen155; msgIndex155++) {
      var msgData155 = msgList155[msgIndex155];
      output.append('<li>', soy.$$escapeHtml(msgData155), '</li>');
    }
    output.append('</ul>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ViewIssue.Body.focusShifter = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message closeable" id="focus-shifter"><label><span>', soy.$$escapeHtml("Go to field:"), '</span><div id="focus-shifter-content"></div></label><span class="aui-icon icon-close"></span></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/templates/viewissue-fields.soy' */
// This file was automatically generated from viewissue-fields.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ViewIssue == 'undefined') { JIRA.Templates.ViewIssue = {}; }
if (typeof JIRA.Templates.ViewIssue.Fields == 'undefined') { JIRA.Templates.ViewIssue.Fields = {}; }


JIRA.Templates.ViewIssue.Fields.saveErrorMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var issueLink__soy3 = new soy.StringBuilder();
  if (opt_data.isAccessible) {
    JIRA.Templates.Issues.Util.issueAnchor(opt_data, issueLink__soy3);
  } else {
    issueLink__soy3.append(soy.$$escapeHtml(opt_data.issueKey));
  }
  issueLink__soy3 = issueLink__soy3.toString();
  output.append(AJS.format("Saving of \x3cstrong\x3e{0}\x3c/strong\x3e failed!",issueLink__soy3), '<ul>');
  var messageList12 = opt_data.errors;
  var messageListLen12 = messageList12.length;
  for (var messageIndex12 = 0; messageIndex12 < messageListLen12; messageIndex12++) {
    var messageData12 = messageList12[messageIndex12];
    output.append('<li>', soy.$$escapeHtml(messageData12), '</li>');
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ViewIssue.Fields.field = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form id="', soy.$$escapeHtml(opt_data.issue.id), '-form" class="ajs-dirty-warning-exempt aui" action= "#"><div class="inline-edit-fields">', opt_data.issue.editHtml, '</div><span class="overlay-icon throbber" /><div class="save-options"><button type="submit" class="aui-button submit" accessKey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.accessKey)), '"><span class="icon icon-save">', soy.$$escapeHtml("Save"), '</span></button><button type="cancel" class="aui-button cancel" accessKey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.accessKey)), '"><span class="icon icon-cancel">', soy.$$escapeHtml("Cancel"), '</span></button></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ViewIssue.Fields.modalField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content"><h2 class="dialog-title">', soy.$$escapeHtml(AJS.format("Edit {0}",opt_data.field.label,opt_data.issue.key)), '</h2><form action="" class="aui" method="post"><div class="form-body">', opt_data.field.editHtml, '</div><div class="buttons-container form-footer"><div class="buttons"><input class="button" type="submit" value="', soy.$$escapeHtml("Submit"), '"/><a class="cancel" href="#">', soy.$$escapeHtml("Cancel"), '</a></div></div></form></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ViewIssue.Fields.modalFieldGeneralErrors = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="error">');
  if (opt_data.messages.length == 1) {
    output.append(soy.$$escapeHtml(opt_data.messages[0]));
  } else {
    output.append('<ul>');
    var messageList55 = opt_data.messages;
    var messageListLen55 = messageList55.length;
    for (var messageIndex55 = 0; messageIndex55 < messageListLen55; messageIndex55++) {
      var messageData55 = messageList55[messageIndex55];
      output.append('<li>', soy.$$escapeHtml(messageData55), '</li>');
    }
    output.append('</ul>');
  }
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ViewIssue.Fields.resumableSaveErrorMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.ViewIssue.Fields.saveErrorMessage(opt_data, output);
  output.append('<p><a href="#" id="fix" class="fix" data-key="', soy.$$escapeHtml(opt_data.issueKey), '">', (opt_data.isCurrentIssue) ? soy.$$escapeHtml("Fix errors") : soy.$$escapeHtml("Return to Issue"), '</a></p>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/templates/util.soy' */
// This file was automatically generated from util.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Issues == 'undefined') { JIRA.Templates.Issues = {}; }
if (typeof JIRA.Templates.Issues.Util == 'undefined') { JIRA.Templates.Issues.Util = {}; }


JIRA.Templates.Issues.Util.throbber = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="icon throbber" />');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.Util.simpleLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a', (opt_data.link.id) ? ' id="' + soy.$$escapeHtml(opt_data.link.id) + '"' : '', 'href="', (opt_data.link.href) ? soy.$$escapeHtml(opt_data.link.href) : '#', '"', (opt_data.link.styleClass || opt_data.additionalStyleClass) ? 'class="' + soy.$$escapeHtml(opt_data.link.styleClass) + ((opt_data.additionalStyleClass) ? ' ' + soy.$$escapeHtml(opt_data.additionalStyleClass) : '') + '"' : '', (opt_data.link.title) ? 'title="' + soy.$$escapeHtml(opt_data.link.title) + '"' : '', '><span>', soy.$$escapeHtml(opt_data.link.label), '</span></a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.Util.issueNotFound = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("The issue {0} does not exist in the search.",opt_data.issueAnchor));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.Util.issueAnchor = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="issue-key" href="', soy.$$escapeHtml(""), '/browse/', soy.$$escapeHtml(opt_data.issueKey), '"> ', soy.$$escapeHtml(opt_data.issueKey), ' </a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.Util.buildMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.messages.length == 1) {
    output.append(soy.$$escapeHtml(opt_data.messages[0]));
  } else {
    output.append('<ul>');
    var messageList52 = opt_data.messages;
    var messageListLen52 = messageList52.length;
    for (var messageIndex52 = 0; messageIndex52 < messageListLen52; messageIndex52++) {
      var messageData52 = messageList52[messageIndex52];
      output.append('<li>', soy.$$escapeHtml(messageData52), '</li>');
    }
    output.append('</ul>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.Util.auiMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.messages.length > 0) {
    output.append('<div class="aui-message ', soy.$$escapeHtml(opt_data.typeClass), '"><span class="aui-icon icon-', soy.$$escapeHtml(opt_data.typeClass), '"></span>');
    JIRA.Templates.Issues.Util.buildMessage(opt_data, output);
    output.append('</div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.Util.errorMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.Issues.Util.auiMessage({typeClass: 'error', messages: opt_data.messages ? opt_data.messages : [opt_data.msg]}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.Util.warningMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.Issues.Util.auiMessage({typeClass: 'warning', messages: opt_data.messages ? opt_data.messages : [opt_data.msg]}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.Util.anonymousErrorDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content"><div class="form-body"><h2 class="dialog-title">', soy.$$escapeHtml("Session Expired"), '</h2>');
  JIRA.Templates.Issues.Util.auiMessage({typeClass: 'warning', messages: ["It looks like your session has timed out, or you have been logged out of JIRA. You will need to log back in to continue."]}, output);
  output.append('</div><div class="buttons-container form-footer"><div class="buttons"><a accesskey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="aui-button submit" href="', soy.$$escapeHtml(""), '/login.jsp?os_destination=', soy.$$escapeHtml(opt_data.redirect), '">', soy.$$escapeHtml("Log in again"), '</a><a accesskey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="aui-button aui-button-link cancel">', soy.$$escapeHtml("Ignore"), '</a></div></div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/js/pigsty/SerializeToObject.js' */
jQuery.fn.serializeObject=function(){var b={};var a=this.find(":input").serializeArray();jQuery.each(a,function(){if(b[this.name]){if(!b[this.name].push){b[this.name]=[b[this.name]]}b[this.name].push(this.value||"")}else{b[this.name]=this.value||""}});return b};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/js/editissue/model/EditIssueController.js' */
Backbone.define("JIRA.Issues.EditIssueController",JIRA.Issues.BaseModel.extend({properties:["issueId","issueKey","issueViewContext","fields","issueEventBus"],namedEvents:["save"],initialize:function(){_.bindAll(this);this.set({fields:new JIRA.Issues.IssueFieldCollection()},{silent:true});this.getFields().bind("add",this.createFieldView).bind("updated",this.handleFieldUpdate).bind("save",this.save);this.getIssueEventBus().bindSavingStarted(this._handleSavingStarted);this.getIssueEventBus().bindSaveSuccess(this._handleSaveSuccess);this.getIssueEventBus().bindSaveError(this._handleSaveError);this.getIssueEventBus().bindSave(this.save);this.getIssueEventBus().bindSave(this.cancelUneditedFields)},_saveById:function(b){var a=this.getFields().get(b);if(a){a.blurEdit()}},_handleSaveError:function(d,c,b){var a=this;if(b){this.applyErrors(b)}else{_.each(c,function(f){var e=a.getFields().get(f);if(e){e.handleSaveError()}})}},_handleSavingStarted:function(a){this.getFields().each(function(b){if(_.include(a,b.id)){b.handleSaveStarted()}})},handleFieldUpdate:function(b){var a=jQuery(JIRA.Issues.IssueFieldUtil.getFieldSelector(b.id));if(!a.hasClass("editable-field")){this.createFieldView(b)}},applyErrors:function(d,c){var a=d.errorCollection;if(a&&a.errors){this.getFields().each(function(e){if(a.errors[e.id]){var f=_.find(d.fields,function(g){return g.id==e.id});if(f){e.setValidationError(f.editHtml,a.errors[e.id],c);c=false}}})}if(a.errorMessages&&a.errorMessages.length){var b=JIRA.Templates.ViewIssue.Fields.saveErrorMessage({errors:a.errorMessages,issueKey:this.getIssueKey()});JIRA.Messages.showErrorMsg(b,{closeable:true})}},reset:function(){this.getFields().reset()},cancelEdit:function(){this.getFields().each(function(a){a.cancelEdit()})},_handleSaveSuccess:function(c,a,d){var b=this.getFields().filter(function(e){return _.indexOf(d,e.id)>=0});_.each(b,function(e){e.handleSaveSuccess()})},getDirtyEditsInProgress:function(){return _.pluck(this.getFields().filter(function(a){return a.getEditing()&&a.isDirty()}),"id")},getEditsInProgress:function(){return _.pluck(this.getFields().filter(function(a){return a.getEditing()}),"id")},save:function(b,a){var e={},d=[];var c=[b];if(!b){c=this.getFields().filter(function(f){return !f.getSaving()&&f.getEditing()&&f.isDirty()})}else{if(!b.getEditing()||b.getSaving()){return}}_.each(c,function(f){d.push(f.getId());_.extend(e,f.getCurrentParams())});if(d.length>0){this.triggerSave(this.getIssueId(),this.getIssueKey(),d,e,a)}},cancelUneditedFields:function(){this.getFields().each(function(a){if(a.getEditing()&&!a.isDirty()&&!a.hasValidationError()){a.cancelEdit()}})},update:function(b,a){this.getFields().update(b,a)},createFieldView:function(b){var a=jQuery(JIRA.Issues.IssueFieldUtil.getFieldSelector(b.id),this.getIssueViewContext());if(a.length===1){new JIRA.Issues.IssueFieldView({model:b,el:a,issueEventBus:this.getIssueEventBus()})}}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/js/editissue/model/SaveInProgressManager.js' */
Backbone.define("JIRA.Issues.SaveInProgressManager",JIRA.Issues.BaseModel.extend({properties:["savesInProgress"],namedEvents:["beforeSaving","savingStarted","saveSuccess","saveError"],initialize:function(){this.setSavesInProgress([])},saveIssue:function(g,b,d,c,h){this.triggerBeforeSaving();var i=this,a,e;e=_.extend(c,{issueId:g,atl_token:atl_token(),singleFieldEdit:true,fieldsToForcePresent:d});var f=_.extend({type:"POST",url:contextPath+"/secure/IssueAction.jspa?decorator=none",headers:{"X-SITEMESH-OFF":true},error:function(j){i._handleSaveError(g,b,d,j)},success:function(n,l,m,j){var k=j.data;if(typeof k=="string"){i._handleHtmlResponse(g,b,d,k)}else{i.triggerSaveSuccess(g,b,d,k)}},complete:function(){i.removeSaveInProgress(a);JIRA.trigger(JIRA.Events.INLINE_EDIT_SAVE_COMPLETE)},data:e},h);a=JIRA.SmartAjax.makeRequest(f);this.addSaveInProgress(a);this.triggerSavingStarted(g,d,c)},hasSavesInProgress:function(){return this.getSavesInProgress().length>0},removeSaveInProgress:function(a){this.setSavesInProgress(_.without(this.getSavesInProgress(),a))},addSaveInProgress:function(a){var b=this.getSavesInProgress();b.push(a);this.setSavesInProgress(b)},_handleHtmlResponse:function(h,b,c,e){var a=this;var g=AJS.$(AJS.extractBodyFromResponse(e));var f=g.find("#atl_token").val();if(f){AJS.$("#atlassian-token").attr("content",f)}var d=new JIRA.FormDialog({offsetTarget:"body",content:g});this.triggerSaveError(h,b,c);d._handleServerSuccess=function(i){d.hide();var j=a._parseResponse(i);if(j){a.triggerSaveSuccess(h,b,c,j)}};d._handleServerError=function(j){d.hide();var i=a._parseResponse(j.responseText);if(i){a.triggerSaveError(h,b,c,i)}};d.show()},_handleSaveError:function(e,a,b,d){var c=this._parseResponse(d.responseText);if(c){this.triggerSaveError(e,a,b,c)}},_parseResponse:function(a){try{return JSON.parse(a)}catch(b){this._showFatalErrorMessage();return null}},_showFatalErrorMessage:function(){var a="<p>"+"Communications Breakdown"+"</p><p>"+"Close this dialog and press refresh in your browser"+"</p>";JIRA.Messages.showErrorMsg(a,{closeable:true})}}));JIRA.Events.INLINE_EDIT_SAVE_COMPLETE="inlineEditSaveComplete";
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/js/editissue/model/IssueFieldModel.js' */
Backbone.define("JIRA.Issues.IssueFieldModel",JIRA.Issues.BaseModel.extend({namedEvents:["editingStarted","focusRequested","editingCancelled","save","saveError","savingStarted","saveComplete","saveSuccess","updateRequired","validationError","modelDestroyed"],properties:["id","initParams","params","editHtml","viewHtml","required","fieldType","editing","saving","error","label","contentId"],initialize:function(){if(this.collection){var a=this;this.collection.on("reset",function(){a.triggerModelDestroyed()})}this.on("change:viewHtml",function(){var b=this.previous("viewHtml");if(b){jQuery.cleanData(b)}});this.bindModelDestroyed(function(){var b=this.getViewHtml();if(b){jQuery.cleanData(b)}})},blurEdit:function(){if(this.getEditing()){if(this.isDirty()||this.hasValidationError()){this.save()}else{this.cancelEdit()}}},setValidationError:function(c,b,a){this.setSaving(false);this.setError(b);this.edit({ignoreBlur:true});this.triggerSaveError();this.triggerValidationError(c,a)},handleSaveError:function(){this.setSaving(false);this.triggerSaveError()},cancelEdit:function(b){if(!this.cancelLocked){var a=new AJS.$.Event(JIRA.Events.BEFORE_INLINE_EDIT_CANCEL);JIRA.trigger(a,[this.getId(),this.getFieldType(),b]);if(!a.isDefaultPrevented()){this.cancelLocked=true;if(this.getEditing()||this.getSaving()){this.setEditing(false);this.setSaving(false);this.unset("params");this.unset("initParams");this.triggerEditingCancelled();this.unset("viewHtml")}delete this.cancelLocked}}},edit:function(a){if(!this.getEditing()){this.setEditing(true);this.triggerEditingStarted(this,a)}else{if(!a||!a.ignoreBlur){this.triggerFocusRequested(this,a)}}},getCurrentParams:function(){this.triggerUpdateRequired();var c={};if(this.getParams()){c=this.getParams()}else{if(this.getInitParams()){c=this.getInitParams()}else{var b=AJS.$("<div />").html(this.getEditHtml());this.setInitParams(b.serializeObject());c=this.getInitParams()}}var a={};_.each(c,function(e,d){a[d]=e});return a},isEditable:function(){if(this.getEditHtml()){return AJS.$(this.getEditHtml()).find("textarea, :text,:radio,:checkbox, select").length!==0}return false},hasValidationError:function(){return !!this.getError()},switchElToEdit:function(a){if(!this.getViewHtml()){this.setViewHtml(a.contents())}a.contents().detach();a.html(JIRA.Templates.ViewIssue.Fields.field({issue:this.toJSON(),accessKey:JIRA.Issues.IssueFieldUtil.getAccessKeyModifier()}));if(!this.getInitParams()){this.setInitParams(a.serializeObject())}this.setEditing(true)},update:function(a){if(this.getEditing()){this.setParams(a.serializeObject())}},handleSaveSuccess:function(){this.setSaving(false);this.setEditing(false);this.unset("viewHtml");this.unset("initParams");this.setError(null);this.triggerSaveSuccess()},handleSaveStarted:function(){this.setSaving(true);this.triggerSavingStarted()},save:function(){if(!this.getSaving()){this.triggerUpdateRequired();this.triggerSave(this)}},isDirty:function(){this.triggerUpdateRequired();return this._isDirty(this.getCurrentParams())},_isDirty:function(a){return JSON.stringify(a)!==JSON.stringify(this.getInitParams())},matchesFieldSelector:function(){return JIRA.Issues.IssueFieldUtil.matchesFieldSelector(this.id)}},{IS_EDITABLE:function(a){return a.isEditable()}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/js/editissue/model/IssueFieldCollection.js' */
Backbone.define("JIRA.Issues.IssueFieldCollection",JIRA.Issues.BaseCollection.extend({model:JIRA.Issues.IssueFieldModel,initialize:function(){_.bindAll(this);this.bind("editingStarted",this._handleEditingStarted)},_handleEditingStarted:function(b,a){a=a||{};if(a.ignoreBlur){return}this.each(function(c){if(b!==c&&c.getEditing()){c.blurEdit()}})},update:function(e,c){var a=this;if(c&&c.changed){var b=c.changed;var f=b.updated?b.updated.fields:[];var d=b.added?b.added.fields:[];_.each(e,function(h){if(_.contains(f,h.id)){var g=a.get(h.id);if(g){if(g.hasValidationError()){delete h.editHtml}g.set(h,{silent:true});a.trigger("updated",g)}else{a.add(h)}}else{if(_.contains(d,h.id)){a.add(h)}}})}else{_.each(e,function(h){var g=a.get(h.id);if(g){if(g.hasValidationError()){delete h.editHtml}g.set(h,{silent:true});a.trigger("updated",g)}else{a.add(h)}})}},cancelEdit:function(){this.each(function(a){a.cancelEdit()})},isDirty:function(){return this.any(function(a){return a.isDirty()})},getDirtyFields:function(){return this.filter(function(a){return a.isDirty()})}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/js/editissue/util/InlineEditUtils.js' */
JIRA.Events.INLINE_EDIT_STARTED="inlineEditStarted";JIRA.Events.BEFORE_INLINE_EDIT_CANCEL="inlineEditCancelled";JIRA.Events.INLINE_EDIT_BLURRED="inlineEditBlurred";JIRA.Events.INLINE_EDIT_FOCUSED="inlineEditFocused";JIRA.Events.INLINE_EDIT_REQUESTED="inlineEditRequested";JIRA.Events.PANEL_REFRESHED="panelRefreshed";JIRA.Events.LOCK_PANEL_REFRESHING="lockPanelRefreshing";JIRA.Events.UNLOCK_PANEL_REFRESHING="unlockPanelRefreshing";JIRA.Events.REFRESH_ISSUE_PAGE="refreshIssuePage";JIRA.Issues.CANCEL_REASON={escPressed:"escPressed"};AJS.$(function(){AJS.namespace("JIRA.Issues.InlineEdit");JIRA.Issues.InlineEdit.BLUR_FOCUS_TIMEOUT=50;var a=JIRA.Issues.InlineEdit.BlurTriggers={Default:function(e,i){i=i.nextAll(".save-options").andSelf();var h=":input, a[href], [tabindex]";var g;var f=b(i);var d={focus:function(){if(!f){f=true;JIRA.trigger(JIRA.Events.INLINE_EDIT_FOCUSED,[e])}},blur:function(){if(g){clearTimeout(g)}g=setTimeout(c,JIRA.Issues.InlineEdit.BLUR_FOCUS_TIMEOUT)}};i.attr("tabindex",1).bind(d).delegate(h,d);function c(){if(!b(i)){f=false;JIRA.trigger(JIRA.Events.INLINE_EDIT_BLURRED,[e])}}}};function b(d){var c=document.activeElement;return d.find(c).length>0||d.filter(c).length>0}JIRA.Issues.InlineEdit.BlurTriggerMapping={system:{summary:a.Default,priority:a.Default,issuetype:a.Default,components:a.Default,versions:a.Default,fixVersions:a.Default,assignee:a.Default,reporter:a.Default,environment:a.Default,description:a.Default,labels:a.Default,duedate:a.Default},custom:{"com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:datepicker":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:datetime":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:float":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:grouppicker":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:labels":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:multigrouppicker":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:multiselect":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:multiversion":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:project":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:select":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:textarea":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:textfield":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:url":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:userpicker":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:version":a.Default}};JIRA.bind(JIRA.Events.INLINE_EDIT_STARTED,function(h,d,c,i){var g;if(c){g=JIRA.Issues.InlineEdit.BlurTriggerMapping.custom[c];if(!g){var f=c.replace(/.+:(.+)/,"$1");g=JIRA.Issues.InlineEdit.BlurTriggerMapping.custom[f]}}else{g=JIRA.Issues.InlineEdit.BlurTriggerMapping.system[d]}if(g){g(d,i)}})});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/js/viewissue/view/UnhandledSaveErrorView.js' */
Backbone.define("JIRA.Issues.UnhandledSaveErrorView",JIRA.Issues.BaseView.extend({events:{"click .fix,.issue-key":"_onFix","click .ignore":"_onIgnore"},initialize:function(a){this.viewIssueLoader=a.viewIssueLoader;this.isCurrentIssue=a.isCurrentIssue;this.issueId=a.issueEntity.id;this.issueEntity=a.issueEntity;this.attemptedSavedIds=a.attemptedSavedIds;this.response=a.response},render:function(){if(!this.response||!this.response.errorCollection){return}var a=this.response.errorCollection;var d=a.errorMessages.concat(_.values(a.errors));var c=this._getTemplate();var b;b=JIRA.Templates.ViewIssue.Fields[c]({errors:d,issueKey:this.issueEntity.key,isAccessible:this._isAccessible(),isCurrentIssue:this.isCurrentIssue});this.setElement(JIRA.Messages.showErrorMsg(b,{closeable:true,timeout:0}))},_onIgnore:function(a){this.hide();a.preventDefault()},hide:function(){this.$el.remove()},_onFix:function(a){this.fix();a.preventDefault()},fix:function(){this.hide();return this.viewIssueLoader.replaySaveError(this.issueEntity,this.attemptedSavedIds,this.response)},isVisible:function(){return this.$el.closest("body").length===1},getId:function(){return this.issueId},_isAccessible:function(){return !!(this.response.fields&&this.response.fields.length)},_getTemplate:function(){var a=_.any(this.response.fields,function(b){return b.id===this.attemptedSavedIds[0]&&b.editHtml},this);return a?"resumableSaveErrorMessage":"saveErrorMessage"}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/js/viewissue/util/ViewIssueController.js' */
Backbone.define("JIRA.Issues.ViewIssueController",JIRA.Issues.BaseModel.extend({namedEvents:["issueDataUpdated","issueError","issueLoaded","issueLoading","issueRequested","returnToSearch","unhandledSaveError","issueViewUpdated","saveSuccess","fieldSubmitted","replacedFocusedPanel"],defaults:{selectedIssue:new JIRA.Issues.SimpleIssue()},properties:["saveInProgressManager","viewIssueModel","selectedEditIssueController","selectedIssue","viewIssueContext"],initialize:function(e,d){var b=this,a=!JIRA.Issues.DarkFeatures.KILL_SWITCH.enabled()&&!JIRA.Issues.DarkFeatures.NO_PREFETCH.enabled();_.bindAll(this);this.viewIssueData=(d&&d.viewIssueData)?d.viewIssueData:new JIRA.Issues.ViewIssueData();this.issuePagerModel=new JIRA.Issues.IssuePagerModel();this.issuePagerModel.bindReturnToSearch(function(){if(this.canDismissComment()){this._destroySelectedViewIssue();this.triggerReturnToSearch()}},this);this.loadingPromiseManager=jQuery.RecurringPromise();this.loading=this.loadingPromiseManager.sub();this.loading.done(_.bind(this._onLoadFromViewIssueData,this));this.loading.fail(_.bind(this._handleFailure,this));if(a){this.loading.always(_.bind(this._refresh,this))}this.updating=this.loadingPromiseManager.sub();this.updating.done(_.bind(this._onUpdated,this));this.updating.fail(_.bind(this._onUpdatedFailure,this));var c=window.onbeforeunload;window.onbeforeunload=function(){return c.apply(this,arguments)||b._handleUnload.apply(this,arguments)};this.on("destroy",function(){window.onbeforeunload=c});JIRA.bind(JIRA.Events.REFRESH_ISSUE_PAGE,function(g,h,f){if(b.isCurrentIssue(h)){b.getViewIssueModel().getIssueEventBus().triggerRefreshIssue(f)}});JIRA.Issues.FocusShifter.init();this.getSaveInProgressManager().bindSaveSuccess(function(j,g,k,i){if(b.isCurrentIssue(j)){if(!b.shouldSkipSaveIssueSuccessHandler()){b._handleSelectedIssueSaveSuccess(j,g,k,i)}else{var h=b.getSelectedEditIssueController(),f=b.getViewIssueModel();b._handleLoadComplete({editIssueController:h,issueViewModel:f,issueId:j,fieldsSaved:k,fieldsInProgress:h.getEditsInProgress(),initialize:false})}}b.triggerSaveSuccess(j)});this.getSaveInProgressManager().bindSaveError(function(j,f,h,g){if(g){b._parseLoadResponseData(g)}if(b._shouldShowDeferredError(j,h)){var i=b.isCurrentIssue(j);b.unhandledSaveError=new JIRA.Issues.UnhandledSaveErrorView({issueEntity:{id:j,key:f},attemptedSavedIds:h,response:g,viewIssueLoader:b,isCurrentIssue:i});b.unhandledSaveError.render();if(i){b.getSelectedEditIssueController().cancelEdit()}}else{b._handleSelectedIssueSaveError(j,h,g)}b._checkRefreshIssueRowData(j)});this.getSaveInProgressManager().bindBeforeSaving(function(){var g=b.getViewIssueModel();if(g){var f=g.getEntity();b.triggerIssueViewUpdated(f.id,f.key)}});this.getSaveInProgressManager().bindSavingStarted(function(g,f){b._recordTimeStampForAnalytic();if(b.isCurrentIssue(g)){b.getViewIssueModel().getIssueEventBus().triggerSavingStarted(f)}})},isCurrentIssue:function(a){return parseInt(this.getSelectedIssue().getId(),10)===parseInt(a,10)},_shouldShowDeferredError:function(f,e){var c=AJS.$(".aui-blanket:visible").length>0;if(!this.isCurrentIssue(f)){return true}if(e.length>1){return c}var b=JIRA.Issues.IssueFieldUtil.matchesFieldSelector(e[0]);var a=AJS.$("#modal-field-view").data("field-id");var d=e[0]===a;return !d&&(!b||c)},replaySaveError:function(b,d,c){var g=this.getViewIssueModel()&&b.id===this.getViewIssueModel().id;if(g){var a=this.getSelectedEditIssueController().getFields();if(d.length===1){var f=a.get(d[0]);if(!f.matchesFieldSelector()){new JIRA.Issues.ModalIssueFieldView({issueEventBus:this.getViewIssueModel().getIssueEventBus(),model:f}).show()}}this._handleSelectedIssueSaveError(b.id,d,c);var e=a.filter(function(h){return h.getEditing()});if(e.length===1){e[0].triggerFocusRequested()}return JIRA.Issues.Utils.resolvedPromise()}return this.load(b,c)},_destroySelectedViewIssue:function(){var b=this.getViewIssueModel();var a=this.getSelectedEditIssueController();this.getSelectedIssue().clear();if(a){a.reset()}if(this.getViewIssueModel()){this.setViewIssueModel(undefined);b.dismiss()}},_getFieldsData:function(d,a){var c=jQuery.ajax({url:contextPath+"/secure/EditAction!default.jspa?decorator=none",headers:{"X-SITEMESH-OFF":true},data:{issueId:d}});var b=c.pipe(function(e){var f=JIRA.Issues.IssueFieldUtil.transformFieldHtml(e);return{issueId:d,issueKey:a,fields:f.fields}},function(j){var g={};var h=true;if(j.status===400||j.status===401){h=false;if(j.status===400){try{var f=JSON.parse(j.responseText)||{};g=f.errorCollection}catch(i){}}else{g=null}}return{issueId:d,fields:null,errorCollection:g,isTimeout:"timeout"===j.statusText,fatalError:h}});b.abort=function(){c.abort.apply(c,arguments)};return b},_checkRefreshIssueRowData:function(b){if(this._refreshRowDataAfterUpdate){var a=this;return jQuery.ajax({url:contextPath+"/rest/api/latest/issue/"+b+"?expand=operations",success:function(c){a.triggerIssueDataUpdated(b,c)}})}},refreshRowDataAfterUpdate:function(){this._refreshRowDataAfterUpdate=true;return this},_parsePanelData:function(a){return{leftPanels:a.leftPanels,rightPanels:a.rightPanels,infoPanels:a.infoPanels}},showLoadingIndicator:function(){this.hideLoadingIndicator();this.loadingWait=window.setTimeout(function(){JIRA.Loading.showLoadingIndicator()},200)},hideLoadingIndicator:function(){clearInterval(this.loadingWait);if(this.loadingWait){JIRA.Loading.hideLoadingIndicator();delete this.loadingWait}},_update:function(a){this.startIssueLoad={date:new Date()};this._addViewIssueDataGetToUpdating(a.issueEntity.key,a);this._triggerIssueViewUpdatedEvent(a.issueEntity.id,a.issueEntity.key)},_showError:function(b,a){var d=b.errorMessages||{};var c=JIRA.Templates.ViewIssue.Body.errorsLoading({errorMessages:d,isTimeout:a});JIRA.Messages.showErrorMsg(c,{closeable:true,timeout:0})},_handleLoadSuccess:function(b,c){this._parseLoadResponseData(c);this._checkRefreshIssueRowData(b.issueId);if(c){var a=b.editable=c.fields&&c.fields.length;if(a){b.issueViewModel.update(c,b);b.editIssueController.update(c.fields,b);b.fieldsInProgress=b.editIssueController.getEditsInProgress();if(b.lastEditData&&b.lastEditData.errorCollection){b.editIssueController.applyErrors(b.lastEditData,true)}}else{b.editIssueController.reset();b.issueViewModel.update(c,b)}}this._handleLoadComplete(b);this.triggerIssueLoaded(b.issueViewModel,b);if(b.success){b.success()}if(b.complete){b.complete()}},conditionallyRenderAccessError:function(a,d){var e;var c;var b;if(d.status===403){e="Permission Violation";c=JIRA.Templates.ViewIssue.Body.viewIssueNoPermissionError({pager:a})}else{if(d.status===404){e="Issue Does Not Exist";b=new JIRA.Issues.IssueMissingErrorView({el:this.getViewIssueContext(),searchPageModule:this.searchPageModule,pager:a})}else{if(d.status!==401){e="Unexpected Error";c=JIRA.Templates.ViewIssue.Body.viewIssueGenericError({pager:a})}}}if(e){document.title=e+" - "+AJS.Meta.get("app-title");if(c){this.getViewIssueContext().html(c)}else{if(b){b.render()}}new JIRA.Issues.IssuePagerView({model:this.issuePagerModel,el:this.getViewIssueContext().find("#issue-header-pager")});return true}return false},conditionallyRedirectToLogin:function(b,c){if(c.status===401){var a=AJS.contextPath()+"/login.jsp?os_destination="+encodeURIComponent("/browse/"+b);window.location.replace(a);return true}return false},_handleLoadError:function(a,b){if(b&&(!b.fields||!b.fields.length)){a.editIssueController.reset();a.issueViewModel.update(b,a)}this._handleLoadComplete(a);if(a.error){a.error()}if(a.success){a.success()}},_handleLoadComplete:function(b){if(this.startIssueLoad){JIRA.Issues.Analytics.trigger("kickass.issueLoadDuration",{issueId:b.issueId,duration:new Date()-this.startIssueLoad.date,loadReason:JIRA.Issues.Analytics._loadIssueReason,fromCache:this.startIssueLoad.fromCache});this.startIssueLoad=null;delete JIRA.Issues.Analytics._loadIssueReason}this.hideLoadingIndicator();this.hideDropdown();if(b.issueViewModel){b.issueViewModel.getIssueEventBus().triggerIssueRefreshed(b.issueId)}var a={id:b.issueId};JIRA.trace("jira.issue.refreshed",a);if(this._checkChangedData(b)){JIRA.trace("jira.psycho.issue.refreshed.cached",a)}JIRA.trigger(JIRA.Events.ISSUE_REFRESHED,[b.issueId]);this._logAnalyticAfterUpdate()},_checkChangedData:function(b){if(!b.mergeIntoCurrent){return false}var a=b.changed;if(!a){return false}return this._checkChangedDataCategory(a.added)||this._checkChangedDataCategory(a.updated)||this._checkChangedDataCategory(a.deleted)},_checkChangedDataCategory:function(a){if(a){if(!_.isEmpty(a.fields)){return true}if(!_.isEmpty(a.issue)){return true}if(a.panels&&(!_.isEmpty(a.panels.leftPanels)||!_.isEmpty(a.panels.rightPanels)||!_.isEmpty(a.panels.infoPanels))){return true}if(a.groups&&(!_.isEmpty(a.groups["view.issue.opsbar"])||a.groups["jira.issue.tools"])){return true}}return false},_parseLoadResponseData:function(a){a=JIRA.Issues.IssueFieldUtil.transformFieldHtml(a);if(a.panels){a.panels=this._parsePanelData(a.panels)}},dismiss:function(){this.deactivateViewIssueScrolling();this._destroySelectedViewIssue()},deactivateViewIssueScrolling:function(){if(this.getViewIssueModel()){this.trigger("issueDismissed",this.getViewIssueModel())}},_recordTimeStampForAnalytic:function(){if(!this._saveStarted){this._saveStarted=[]}this._saveStarted.push((new Date()).getTime())},_logAnalyticAfterUpdate:function(){if(this._saveStarted&&this._saveStarted.length){var a=this._saveStarted.shift();JIRA.Issues.Analytics.trigger("kickass.issueTotalSaveDuration",{duration:(new Date()).getTime()-a})}},_handleSelectedIssueSaveError:function(h,d,e){var c=this.getSelectedEditIssueController(),b=this.getViewIssueModel().getIssueEventBus(),a=this.getViewIssueModel(),g,f;if(e){g=_.keys(e.errorCollection.errors);f=_.without(d,g)}b.triggerSaveError(h,d,e);this._handleLoadError({editIssueController:c,issueViewModel:a,issueId:h,fieldsSaved:f,initialize:false},e)},_handleSelectedIssueSaveSuccess:function(f,c,g,e){var d=this.getSelectedEditIssueController(),b=this.getViewIssueModel().getIssueEventBus(),a=this.getViewIssueModel();b.triggerSaveSuccess.apply(b,arguments);this.viewIssueData.set(c,e);this._handleLoadSuccess({editIssueController:d,issueViewModel:a,issueId:f,fieldsSaved:g,fieldsInProgress:d.getEditsInProgress(),initialize:false},e)},shouldSkipSaveIssueSuccessHandler:function(){return this._shouldSkipSaveIssueSuccessHandler},setSkipSaveIssueSuccessHandler:function(a){this._shouldSkipSaveIssueSuccessHandler=a},_handleUnload:function(){var a=this.getSelectedEditIssueController();if(a){if(a.getDirtyEditsInProgress().length>0){return "You are still editing this page. Are you sure you want to leave?"}}},_initIssueObjects:function(c){var d=new JIRA.Issues.IssueEventBus({issueId:c.id});d.bindOpenFocusShifter(this._openFocusShifter);d.bindRefreshIssue(_.bind(function(e){e=e||{};this._update({editIssueController:b,issueViewModel:a,viewIssueQuery:c.viewIssueQuery,issueEntity:c,reason:e.reason,success:e.success,error:e.error,complete:e.complete,initialize:false})},this));d.bindFieldSubmitted(this.triggerFieldSubmitted);d.bindReplacedFocusedPanel(this.triggerReplacedFocusedPanel);var a=new JIRA.Issues.IssueViewModel({id:c.id,issuePagerModel:this.issuePagerModel,issueEventBus:d,splitViewMode:c.splitViewMode});this.setViewIssueModel(a);var b=new JIRA.Issues.EditIssueController({issueId:c.id,issueKey:c.key,issueViewContext:jQuery(this.getViewIssueContext()),issueEventBus:d});b.bindSave(_.bind(this._onSaveComplete,this));this.setSelectedEditIssueController(b);this.issueView=new JIRA.Issues.IssueView({model:a,el:this.getViewIssueContext()});return{issueEventBus:d,issueViewModel:a,editIssueController:b}},_onSaveComplete:function(e,a,c,d,b){this.setSkipSaveIssueSuccessHandler(false);this.getSaveInProgressManager().saveIssue(e,a,c,d,b)},applyToDom:function(c){var b;c.id=+c.id;b=this._initIssueObjects(c);var a=this;var e={id:c.id};var d=function(g){var h=g.fields&&g.fields.length;if(h){b.editIssueController.update(g.fields)}JIRA.trace("jira.issue.fields.loaded",e)};var f;if(AJS.Meta.get("server-view-issue-is-editable")||JIRA.Issues.DarkFeatures.KILL_SWITCH.enabled()){f=this._getFieldsData(c.id,c.key);AJS.Meta.set("server-view-issue-is-editable",null)}else{f=jQuery.Deferred().reject({fields:[]}).promise()}f.done(d).fail(function(g){if(!g.fatalError){d(g)}else{JIRA.trace("jira.issue.fields.loaded",e)}});this.getSelectedIssue().set({key:c.key,id:c.id});b.issueViewModel.updateFromDom(c);b.issueEventBus.triggerUpdateFromDom(this.getViewIssueContext());this.triggerIssueLoaded(b.issueViewModel,{isNewIssue:true})},updatePager:function(a){this.issuePagerModel.update(a)},_createPager:function(){},canDismissComment:function(){var b;var a=JIRA.Issue.CommentForm;if(!a.getForm().data("dismissed")){b=a.handleBrowseAway();if(b){if(!confirm(b)){a.focus();return false}else{a.getForm().data("dismissed",true)}}}return true},isCurrentlyLoading:function(){return this._currentlyLoading},load:function(a,b){if(!this.canDismissComment()||!a.key){return jQuery.Deferred().reject()}if(this._shouldReplaySaveError(a.id)){return this.unhandledSaveError.fix()}this._currentlyLoading=true;var c=jQuery.Deferred().always(_.bind(function(){this._currentlyLoading=false},this));this.getSelectedIssue().set({key:a.key,id:a.id});this.showLoadingIndicator();this.issuePagerModel.clear();this.startIssueLoad={date:new Date()};this.loading.add(this.viewIssueData.get(a.key,false,{issueEntity:a,lastEditData:b,loadCompletely:c,loadFields:false}));return c},_shouldReplaySaveError:function(a){return this.unhandledSaveError&&this.unhandledSaveError.isVisible()&&this.unhandledSaveError.getId()===a},cancelLoad:function(){this.loading.reset();this.updating.reset();this.hideLoadingIndicator()},isNewIssue:function(b){var a=this.getViewIssueModel()&&this.getViewIssueModel().getEntity();return !a||a.id!==b},_onLoadFromViewIssueData:function(c,i,j){var g=j.issueEntity;g.id=c.issue.id;var h=this.isNewIssue(g.id);var d=!i.mergeIntoCurrent&&j.initialize!==false;if(this.startIssueLoad){this.startIssueLoad.fromCache=i.fromCache}var e={id:g.id};if(i.fromCache){JIRA.trace("jira.issue.loadFromCache",e);JIRA.trace("jira.issue.fields.loaded",e)}else{JIRA.trace("jira.issue.loadFromServer",e)}if(g.key!==c.issue.key){g.key=c.issue.key}if(d){this._destroySelectedViewIssue()}this.getSelectedIssue().set({key:g.key,id:g.id});if(!c.pager){c.pager=g.pager}var a;var b;if(d){var f=this._initIssueObjects(g);a=f.editIssueController;b=f.issueViewModel}else{a=this.getSelectedEditIssueController();b=this.getViewIssueModel()}this._handleLoadSuccess({editIssueController:a,issueViewModel:b,issueId:g.id,issueKey:g.key,lastEditData:j.lastEditData,initialize:d,isNewIssue:h,splitViewMode:g.splitViewMode,changed:i.changed,mergeIntoCurrent:i.mergeIntoCurrent,success:j.success,error:j.error,complete:j.complete},c);if(g.bringToFocus){g.bringToFocus()}this.addIssueMetadata();if(j.loadCompletely){j.loadCompletely.resolve()}this._triggerRefreshToggleBlocks(g.id)},_handleFailure:function(d,e,b){var a=b.issueEntity,c;c={issueId:a.id,issueKey:a.key,pager:a.pager,response:d,error:b.error,success:b.success};if(!this.conditionallyRedirectToLogin(a.key,d)){if(!a.preventErrorRendering){this.conditionallyRenderAccessError(a.pager,d)}this._handleLoadError(c);this.triggerIssueError(c)}this.removeIssueMetadata();if(b.loadCompletely){b.loadCompletely.reject()}},_refresh:function(c,d,b){var a=b.issueEntity;if(d.fromCache){JIRA.Issues.Analytics._loadIssueReason="issues-cache-refresh";this.startIssueLoad={date:new Date()};b.mergeIntoCurrent=!d.error;delete b.loadFields;this._addViewIssueDataGetToUpdating(a.key,b)}else{if(d.initialLoad&&!d.error&&c.issue.isEditable){this.updating.add(this._updatingTask(this._getFieldsDataTask(a.id,a.key),"fields",b.lastEditData))}}},_addViewIssueDataGetToUpdating:function(a,b){this.updating.add(this._updatingTask(this.viewIssueData.get(a,true,b),"issue"))},_getFieldsDataTask:function(c,a){var b=jQuery.Deferred();this.viewIssueData.setPending(c,this._getFieldsData(c,a),function(d){b.resolve(d)},function(d){if(d.fatalError){b.reject(d)}else{b.resolve(d)}});return b.promise()},_updatingTask:function(a,c,b){return a.pipe(function(){return{taskKey:c,data:arguments,lastEditData:b}},function(){return{taskKey:c,data:arguments,lastEditData:b}})},_onUpdated:function(a){if(a.taskKey==="issue"){this._onLoadFromViewIssueData.apply(this,a.data)}else{if(a.taskKey==="fields"){this._onFieldsLoaded(a.data[0],a.lastEditData)}}},_onFieldsLoaded:function(a,d){if(a.errorCollection||a.isTimeout){this._showError(a.errorCollection,a.isTimeout)}var c=this.viewIssueData.getMeta(a.issueKey);if(c&&c.value){c.value.fields=a.fields||{}}var b=a.fields&&a.fields.length;if(b){this.getSelectedEditIssueController().update(a.fields);if(d&&d.errorCollection){this.getSelectedEditIssueController().applyErrors(d,true)}}this._traceFieldsLoaded(a.issueId)},_traceFieldsLoaded:function(b){var a={id:b};JIRA.trace("jira.issue.fields.loaded",a)},_onUpdatedFailure:function(a){if(a.taskKey==="issue"){this._handleFailure.apply(this,a.data)}else{if(a.taskKey==="fields"){this._handleLoadFieldsFailure.apply(this,a.data)}}},_handleLoadFieldsFailure:function(a){if(a.errorCollection||a.isTimeout){this._showError(a.errorCollection,a.isTimeout)}this._traceFieldsLoaded(a.issueId)},_openFocusShifter:function(){JIRA.Issues.FocusShifter.show()},hideLightbox:function(){AJS.$.fancybox.close()},hideDropdown:function(){if(AJS.InlineDialog.current&&_.contains(JIRA.Issues.IntroDialog.dialogs,AJS.InlineDialog.current)&&AJS.InlineDialog.current.id!=="column-picker-dialog"){AJS.InlineDialog.current.hide()}if(AJS.InlineLayer.current){var a=AJS.InlineLayer.current.options.offsetTarget();if(a instanceof jQuery){if(!a.is(":visible")){AJS.InlineLayer.current.hide()}}}},_triggerIssueViewUpdatedEvent:function(b,a){this.trigger("issueViewUpdated",{issueId:b,issueKey:a})},_triggerRefreshToggleBlocks:function(a){if(JIRA.Events.REFRESH_TOGGLE_BLOCKS){JIRA.trigger(JIRA.Events.REFRESH_TOGGLE_BLOCKS,[a])}},changeViewIssueContext:function(b){var a=this.getSelectedEditIssueController(),c=this.issueView;if(a){a.setIssueViewContext(b)}if(c){c.setElement(b)}this.setViewIssueContext(b)},removeIssueMetadata:function(c){var b=c||this.getViewIssueModel();var a=(b&&b.getEntity())||{};if(a.metadata){_.each(a.metadata,function(e,d){AJS.Meta.set(d,null)})}else{if(AJS.Meta.get("issue-key")){AJS.Meta.set("issue-key",null)}}},addIssueMetadata:function(c){var b=c||this.getViewIssueModel();var a=(b&&b.getEntity())||{};_.each(a.metadata,function(e,d){AJS.Meta.set(d,e)})},updateIssueWithQuery:function(c){var a=this.getViewIssueModel();if(!a){return}var b=a.getEntity();if(!b.key||!b.id){return}b.viewIssueQuery=c||{};this._addViewIssueDataGetToUpdating(b.key,{mergeIntoCurrent:true,issueEntity:b})}}));JIRA.Events.ISSUE_REFRESHED="issueRefreshed";
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/js/viewissue/util/FocusShifter.js' */
AJS.namespace("JIRA.Issues.FocusShifter");JIRA.Issues.FocusShifter.init=function(){return JIRA.Shifter.register(function(){var b;if(JIRA.Issues.Api.issueIsVisible&&!JIRA.Issues.Api.issueIsVisible()){b=[]}else{var a=JIRA.Issues.Api.getFieldsOnSelectedIssue();b=a?JIRA.Issues.FocusShifter.getSuggestions(a):[]}return{id:"edit-fields",name:"Edit Fields",context:JIRA.Issue.getIssueKey(),weight:100,getSuggestions:function(){return jQuery.Deferred().resolve(b)},onSelection:function(c){JIRA.Issues.Api.editFieldOnSelectedIssue(c)}}})};JIRA.Issues.FocusShifter.show=function(){JIRA.Shifter.show()};JIRA.Issues.FocusShifter.getSuggestions=function(a){return _.chain(a.models).filter(JIRA.Issues.IssueFieldModel.IS_EDITABLE).filter(function(b){return b.id!=="comment"}).map(function(b){return{label:b.getLabel(),value:b.id}}).value()};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/js/editissue/view/IssueFieldView.js' */
Backbone.define("JIRA.Issues.IssueFieldView",JIRA.Issues.BaseView.extend({events:{"click .cancel":"onClickCancel",keyup:"onKeyCancel","click .submit":"onSubmit",click:"onEdit",mousedown:"saveSelectedText","submit form":"onSubmit",'keydown select[multiple="multiple"]':"_enterToSubmitMultiSelect","keypress select":"_enterToSubmitSelect","beforeBlurInput *":"_preventBlurByEsc"},initialize:function(b){this.model.bind("validationError",this.handleValidationError,this);this.model.bind("editingStarted",this.switchToEdit,this);this.model.bind("focusRequested",this.focus,this);this.model.bind("editingCancelled",this.switchToRead,this);this.model.bind("saveError",this.handleSaveError,this);this.model.bind("updateRequired",this.updateModel,this);this.model.bind("savingStarted",this.handleSavingStarted,this);this.model.bind("modelDestroyed",this.destroy,this);this.decorate();this.issueEventBus=b.issueEventBus;this.issueEventBus.bind("panelRendered",this.handlePanelRendered,this);this.model.setFieldType(this.$el.data("fieldtypecompletekey"));this._editDelay=0;var a=this;JIRA.bind(JIRA.Events.INLINE_EDIT_BLURRED,function(d,c){if(c===a.model.getId()){a._onPossibleBlur()}});JIRA.bind(JIRA.Events.INLINE_EDIT_REQUESTED,function(d,c){if(c!==a.model.getId()&&a._editDelay!==0){clearTimeout(a._editDelay);a._editDelay=0}})},destroy:function(){this.issueEventBus.off("panelRendered",this.handlePanelRendered)},decorate:function(){if(this.model.isEditable()&&!this.model.getEditing()){this.$el.addClass("editable-field inactive");this.$el.append('<span class="overlay-icon icon icon-edit-sml" />');this._addToolTip()}},getEditElements:function(){return this.$el.find(".inline-edit-fields")},_addToolTip:function(){this.$el.attr("title","Click to edit");jQuery("a:not([title])",this.$el).attr("title","Follow link")},_removeToolTip:function(){this.$el.removeAttr("title")},_stealAccessKeys:function(){jQuery("[accessKey='"+"s"+"']").attr("accessKey","_s");jQuery("[accessKey='"+"`"+"']").attr("accessKey","_x")},_returnAccessKeys:function(){jQuery("[accessKey=_s]").attr("accessKey","s");jQuery("[accessKey=_x]").attr("accessKey","`")},_handleEditingStarted:function(a){var b=this.$el.find(".field-tools");JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.inlineEditStarted]);JIRA.trigger(JIRA.Events.INLINE_EDIT_STARTED,[this.model.getId(),this.model.getFieldType(),this.getEditElements(),this.$el]);this.$el.find(".textarea").css("height",Math.max(this._originalHeight,60)).expandOnInput(jQuery(window).height()-jQuery("#stalker").height()-100);if(a){this.$el.find(":input:visible:first").focus()}if(!this.$el.find(".error").size()){this.$el.find("select.aui-ss-select").each(function(){var c=jQuery(this);if(c.data("static-suggestions")){c.trigger("showSuggestions")}})}this.$el.find(".save-options").attr("tabindex",1).prepend(b)},handleValidationError:function(b,a){this.$el.html(JIRA.Templates.ViewIssue.Fields.field({issue:{id:this.model.id,editHtml:b},accessKey:JIRA.Issues.IssueFieldUtil.getAccessKeyModifier()}));this.$el.find(".error").addClass("inline-edit-error").attr("data-field",this.model.id);this._handleEditingStarted(a)},handlePanelRendered:function(a,b){var c=jQuery(JIRA.Issues.IssueFieldUtil.getFieldSelector(this.model.id),b);if(c.length===1){this.$el=c;this.el=this.$el[0];this.decorate();this.delegateEvents()}},handleSaveError:function(){this.$el.find(":input").removeAttr("disabled").trigger("enable");this.$el.removeClass("saving saving-"+this.model.id)},handleSavingStarted:function(){this.$el.find(":input").attr("disabled","disabled").trigger("disable");this.$el.addClass("saving saving-"+this.model.id)},updateModel:function(){this.model.update(this.$el)},reveal:function(){var a=40;this.$el.scrollIntoView({direction:"y",marginBottom:a,marginTop:AJS.$("#stalker").outerHeight(true)+a});this.$el.trigger("reveal")},focus:function(){this.reveal();this.$el.find(":input").removeAttr("disabled");if(jQuery(".aui-blanket").length===0){var a=this.$el.find(":input:visible:first");a.focus();if(!this.$el.hasClass("field-ignore-highlight")){a.select()}}},switchToEdit:function(){var a={fieldId:this.model.getId()};JIRA.Issues.Analytics.trigger("kickass.editField",a);this._stealAccessKeys();this._removeToolTip();this.$el.removeClass("inactive saving").addClass("active");this._originalHeight=this.$el.height();this.model.switchElToEdit(this.$el);this._handleEditingStarted();this.focus()},switchToRead:function(){this._addToolTip();this.$el.addClass("inactive").removeClass("active");this.$el.html(this.model.getViewHtml());this.$el.closest("form").unbind("submit",this.onSubmit);this._returnAccessKeys()},onKeyCancel:function(a){if(a.keyCode===27){this.model.cancelEdit(JIRA.Issues.CANCEL_REASON.escPressed);a.preventDefault()}},onClickCancel:function(a){this.model.cancelEdit();a.preventDefault()},onSubmit:function(b){var a=new jQuery.Event("before-submit");this.$el.find("form").trigger(a);if(!a.isDefaultPrevented()){this.$el.find(":focus").blur();this.issueEventBus.triggerFieldSubmitted();this.model.save();this._returnAccessKeys()}b.preventDefault()},onEdit:function(f){var e=AJS.$(f.target).is(".overlay-icon.icon-edit-sml");var c=AJS.$(f.target).closest("a, .uneditable").length===0&&this.$el.hasClass("inactive");var d=this._getCurrentlySelectedText()===""&&!this._previouslySelectedText;var b=c&&(e||d);if(this._editDelay!==0){clearTimeout(this._editDelay);this._editDelay=0}else{if(b){JIRA.trigger(JIRA.Events.INLINE_EDIT_REQUESTED,[this.model.getId()]);var a=this;if(e){jQuery(document).one("click",function(g){if(!g.isDefaultPrevented()){a.model.edit()}})}else{this._editDelay=setTimeout(function(){if(!f.isDefaultPrevented()&&a.$el.hasClass("inactive")&&a._getCurrentlySelectedText()===""){a.model.edit()}a._editDelay=0},250)}}}},_onPossibleBlur:function(){if(this.model.getSaving()){return}if(jQuery(".aui-blanket").length>0){return}this.model.blurEdit()},_preventBlurByEsc:function(a){a.preventDefault()},_getCurrentlySelectedText:function(){if(jQuery(document.activeElement).is(":input")){return""}if(document.selection&&document.selection.createRange){return document.selection.createRange().text||""}if(window.getSelection){return window.getSelection().toString()}return""},_enterToSubmitSelect:function(a){if(!a.isDefaultPrevented()){if(a.which===13){a.preventDefault();jQuery(a.target).closest("form").submit()}}},_enterToSubmitMultiSelect:function(a){if(!a.isDefaultPrevented()){if(a.which===13){jQuery(a.target).blur()}}},saveSelectedText:function(){this._previouslySelectedText=this._getCurrentlySelectedText()}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/js/editissue/view/ModalIssueFieldView.js' */
Backbone.define("JIRA.Issues.ModalIssueFieldView",JIRA.Issues.BaseView.extend({errorsTemplate:JIRA.Templates.ViewIssue.Fields.modalFieldGeneralErrors,template:JIRA.Templates.ViewIssue.Fields.modalField,initialize:function(a){_.bindAll(this);JIRA.bind("Dialog.hide",this._onHide);this.issueEventBus=a.issueEventBus;this.issueEventBus.bindSaveError(this._showGeneralError);this.model.bindSaveSuccess(this._remove);this.model.bindUpdateRequired(this._updateModel);this.model.bindValidationError(this._showValidationError)},_enable:function(){var b=this._getDialog();b.hideFooterLoadingIndicator();var a=b.$popup;a.find(":input").removeAttr("disabled").trigger("enable");a.find(":input:first").focus().select();a.find(":submit").removeAttr("disabled")},_getDialog:function(){if(!this._dialog){this._dialog=new JIRA.FormDialog({id:"modal-field-view",submitHandler:this._onSubmit,content:_.bind(function(a){a(this.template({field:this.model.toJSON(),issue:this.options.issue}))},this)});this._dialog.get$popup().data("field-id",this.model.getId())}return this._dialog},_onHide:function(a,b){if(b===this._getDialog().get$popup()){this._remove()}},_onSubmit:function(c,b){c.preventDefault();this.model.save();b();var a=this._getDialog();a.showFooterLoadingIndicator();a.$popup.find(":input").attr("disabled","disabled").trigger("disable")},_remove:function(b){var a=this._getDialog();if(a.get$popup().is(":visible")){a.hide()}a.destroy();this.model.cancelEdit();JIRA.unbind("Dialog.hide",this._onHide);this.issueEventBus.unbindSaveError(this._showGeneralError);this.model.unbindSaveSuccess(this._remove);this.model.unbindUpdateRequired(this._updateModel);this.model.unbindValidationError(this._showValidationError)},show:function(){this.model.edit();this._getDialog().show()},_showGeneralError:function(f,b,a){this._enable();var d=this._getDialog().$popup;var g=a&&a.errorCollection;if(g){var c=!_.isEmpty(g.errors),e=!_.isEmpty(g.errorMessages);if(!c&&e){d.find(".form-body").append(this.errorsTemplate({messages:g.errorMessages}))}}},_showValidationError:function(a){this._enable();this._getDialog().$popup.find(".form-body").html(a)},_updateModel:function(){this.model.update(this._getDialog().$popup)}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/js/pigsty/IssueFieldUtil.js' */
JIRA.Issues.IssueFieldUtil={getFieldSelector:function(a){if(a==="issuetype"){return"#type-val"}else{if(a==="fixVersions"){return"#fixfor-val"}else{if(a==="summary"){return"#summary-val"}else{if(a==="labels"){return"#wrap-labels .value"}else{if(a==="duedate"){return"#due-date"}else{return"#"+a+"-val"}}}}}},matchesFieldSelector:function(a){return jQuery(JIRA.Issues.IssueFieldUtil.getFieldSelector(a)).length===1},transformFieldHtml:function(a){a.fields=_.map(a.fields,function(c){var b=AJS.$("<div />").htmlCatchExceptions(c.editHtml);b.find("legend,label").eq(0).remove();return{id:c.id,label:c.label,editHtml:b.html(),required:c.required,contentId:c.contentId}});return a},getAccessKeyModifier:function(){var b=AJS.$("#home_link_drop").attr("title"),a=/\(([\w\+]+)\+\w\)/i;if(a.test(b)){return a.exec(b)[1]}else{return"Alt"}}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/js/viewissue/view/IssuePanelView.js' */
(function(a){Backbone.define("JIRA.Issues.IssuePanelView",JIRA.Issues.BaseView.extend({tagName:"div",template:JIRA.Templates.ViewIssue.Body.issuePanel,initialize:function(b){_.bindAll(this);this.issueEventBus=b.issueEventBus;this.model.bindUpdated(this.applyDomUpdate)},applyDomUpdate:function(f){var c=this.model.applyUpdates(this._renderPanel(),this.$el,f.fieldsSaved,f.fieldsInProgress);if(c){if(c.type==="replace"){var h=document.activeElement;var b=this.$el.find(h).length>0;var g=!!jQuery.browser.msie&&jQuery.browser.version<=8;if(!g){this.$el.replaceWith(c.$el)}else{var e=this.$el[0].nextSibling;var d=this.$el[0].parentNode;this.$el.remove();if(e){jQuery(e).before(c.$el)}else{jQuery(d).append(c.$el)}}if(b){this.issueEventBus.triggerReplacedFocusedPanel()}this.setElement(c.$el)}JIRA.trigger(JIRA.Events.PANEL_REFRESHED,[this.model.id,this.$el,c.$existing]);this.issueEventBus.triggerPanelRendered(this.model.id,this.$el);_.each(c.updates,function(i){JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[i,JIRA.CONTENT_ADDED_REASON.panelRefreshed])})}},render:function(){return this.$el=this._renderPanel()},_renderPanel:function(){var c;var b=this.model.getEntity();c=a(this.template(b));if(b.styleClass){c.addClass(b.styleClass)}return c}}))})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/js/viewissue/view/IssueBodyView.js' */
(function(a){Backbone.define("JIRA.Issues.IssueBodyView",JIRA.Issues.BaseView.extend({tagName:"div",className:"issue-body-content",panelLocations:{leftPanels:".issue-main-column",rightPanels:".issue-side-column",infoPanels:".issue-body"},template:JIRA.Templates.ViewIssue.Body.issueBody,initialize:function(){_.bindAll(this);this.model.getPanels().bindPanelRemoved(this.removePanel);this.model.getPanels().bindPanelAdded(this.addPanel);this.model.getIssueEventBus().bindUpdateFromDom(this.updateFromDom)},updateFromDom:function(d){var b=this;this.setElement(d.find(".issue-body-content"));function c(h,f){var g=f.id;if(g==="addcomment"){g="addcommentmodule"}var e=b.model.getPanels().createPlaceholderModel(h,g);if(e){new JIRA.Issues.IssuePanelView({el:f,model:e,issueEventBus:b.model.getIssueEventBus()})}}this.$el.find(this.panelLocations.leftPanels+" .module").each(function(){c("leftPanels",this)});this.$el.find(this.panelLocations.rightPanels+" .module").each(function(){c("rightPanels",this)});this.$el.find(this.panelLocations.infoPanels+". module").each(function(){c("infoPanels",this)})},render:function(){var c=this.model.getPanels();var b=a(this.template());this.$el.html(b);this._renderPanels(c.getLeftPanels(),"leftPanels");this._renderPanels(c.getRightPanels(),"rightPanels");this._renderPanels(c.getInfoPanels(),"infoPanels");return this.$el},removePanel:function(c){var b=this._convertLocation(c.location);this.$(b).find("#"+c.panel.getPanelId()).remove()},addPanel:function(d,f){var e=new JIRA.Issues.IssuePanelView({model:d.panel,issueEventBus:this.model.getIssueEventBus()});var j=this.$(this._convertLocation(d.location));var h=e.render();var c=false;var b=d.index;while(b>0){b--;var g=j.find("#"+f[b].id);if(g.length>0){h.insertAfter(g);c=true;break}}if(!c){h.appendTo(j)}JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[h,JIRA.CONTENT_ADDED_REASON.panelRefreshed])},_convertLocation:function(b){return this.panelLocations[b]},_renderPanels:function(d,c){var b=this;_.each(d,function(e,f){b.addPanel({location:c,panel:e,index:f},d)})}}))})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/js/viewissue/view/IssueHeaderView.js' */
Backbone.define("JIRA.Issues.IssueHeaderView",JIRA.Issues.BaseView.extend({className:"issue-header js-stalker",id:"stalker",tagName:"header",template:null,initialize:function(){_.bindAll(this);this.template=this._issueHeaderTemplate();this.model.bindUpdated(this._modelUpdated);this.model.getIssueEventBus().bindUpdateFromDom(this.updateFromDom)},_issueHeaderTemplate:function(){if(AJS.DarkFeatures.isEnabled("com.atlassian.jira.config.PDL")){return JIRA.Templates.ViewIssue.Header.issueHeader}return JIRA.Templates.ViewIssue.Header.legacyIssueHeader},_modelUpdated:function(a){if(a.initialize){this.updateWindowTitle()}else{var b=_.include(a.fieldsInProgress,"summary");if(b){this.renderOpsBar()}else{this.render(a);this.updateWindowTitle()}this.model.getIssueEventBus().triggerPanelRendered("header",this.$el)}},updateFromDom:function(a){this.setElement(a.find("header.issue-header"));this._processCommentButton()},updateWindowTitle:function(){var b=this.$el.find("#key-val").first().text();var a=this.$el.find("#summary-val").first().text();var c=AJS.Meta.get("app-title");if(!c||!a||!b){console.warn("JIRA.Issues.IssueHeaderView: Parsing of title failed")}else{document.title="["+b+"] "+a+" - "+c}},renderOpsBar:function(){this.opsbarView=new JIRA.Issues.IssueOpsbarView({el:this.$el.find(".command-bar"),model:this.model});this.opsbarView.render();JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.panelRefreshed])},render:function(a){var e=this.$el.find("#issue-comment-add").detach(),a=a||{};if(a.changed){if(a.changed.updated.issue&&_.contains(a.changed.updated.issue,"summary")){this.$el.find("#summary-val").text(this.model.getEntity().summary)}if(!this.opsbarView){this.renderOpsBar()}this.opsbarView.update(a);JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.panelRefreshed])}else{if(!a.mergeIntoCurrent){var c=this.$el.find("#issue-header-pager").detach();var d=this.template({issue:this.model.getEntity(),hasProjectShortcut:JIRA.Issues.DarkFeatures.PROJECT_SHORTCUTS.enabled()});this.$el.attr("class",this.className).empty().append(d);this.opsbarView=new JIRA.Issues.IssueOpsbarView({el:this.$el.find(".command-bar"),model:this.model});this.opsbarView.render();if(c.length){this.$el.find("#issue-header-pager").replaceWith(c)}var b=this._processCommentButton();if(e.length===1){this.$el.addClass("action").find(".ops-cont").append(e);b.addClass("active")}JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.panelRefreshed])}}return this.$el},_onAssigneeUpdate:function(){this.model.getIssueEventBus().triggerRefreshIssue()},_processCommentButton:function(){return this.$el.find("#comment-issue").addClass("inline-comment")}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/js/viewissue/view/IssueOpsbarView.js' */
(function(a){Backbone.define("JIRA.Issues.IssueOpsbarView",JIRA.Issues.BaseView.extend({template:JIRA.Templates.ViewIssue.Header.opsbar,render:function(){var b=AJS.$(this.template({issue:this.model.getEntity()}));if(this.model.getSplitViewMode()){b.find("#ops-login-lnk").hide()}this.$el.empty().append(b);this._addTipsy();return this.$el},_addTipsy:function(){new JIRA.Issues.Tipsy({el:this.$el.find(".viewissue-share"),showCondition:":not(.active)"});new JIRA.Issues.Tipsy({el:this.$el.find("#viewissue-export"),showCondition:":not(.active)",tipsy:{gravity:"ne"}})},update:function(j){if(j&&j.changed&&(j.changed.added.groups)){var g=this.model.getEntity().operations.linkGroups;var e=null;var d=null;_.each(g,function(n){if("view.issue.opsbar"==n.id){e=n}else{if("jira.issue.tools"==n.id){d=n}}});var c=j.changed.added.groups["view.issue.opsbar"];var i=j.changed.updated.groups["view.issue.opsbar"];var m=j.changed.deleted.groups["view.issue.opsbar"];if(c.length>0||i.length>0||m.length>0){var k=this.$el.find(".toolbar-split-left");if(i.length>0||m.length>0){var h=k.find(".toolbar-group");h.each(function(o,p){p=AJS.$(p);var q=p.attr("id").substr("opsbar-".length);if(_.contains(m,q)){p.remove()}else{if(_.contains(i,q)){var n=_.find(e.groups,function(r){return q===r.id});p.replaceWith(JIRA.Templates.ViewIssue.Header.linkGroup({group:n,parentGroup:e}))}}})}if(c.length>0){var l=this;var b=_.clone(c);_.each(c,function(r){for(var q=0;q<e.groups.length;q++){var p=e.groups[q];if(p.id===r){var u=JIRA.Templates.ViewIssue.Header.linkGroup({group:p,parentGroup:e});if(q===e.groups.length-1){k.append(u)}else{var s=false;for(var o=q+1;o<e.groups.length;o++){var n=e.groups[o];if(!_.contains(b,n.id)){var t=l.$el.find("#opsbar-"+n.id);t.before(u);s=true;break}}if(!s){k.append(u)}}b.splice(0,1);break}}})}}if(j.changed.updated.groups["jira.issue.tools"]){var f=this.$el.find(".toolbar-split-right");f.html(JIRA.Templates.ViewIssue.Header.linkGroup({group:d}))}}}}))})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/js/viewissue/view/IssueView.js' */
(function(a){Backbone.define("JIRA.Issues.IssueView",JIRA.Issues.BaseView.extend({mixins:[JIRA.Issues.Mixin.LoadingClass],ISSUE_ACTION_SELECTOR:"a[class*='issueaction-'], .toggle-title",initialize:function(){var b=this;_.bindAll(this);a(document).delegate(this.ISSUE_ACTION_SELECTOR,"click",this._handleActionClicked);this.model.getIssueEventBus().bindUpdateStatusColor(this.updateStatusClass);this.model.getIssueEventBus().bindDismiss(this.destroy);this.model.getIssueEventBus().bindUpdateFromDom(this.updateFromDom);this.model.getIssueEventBus().bindRefreshIssue(this.addLoadingClass);this.model.getIssueEventBus().bindIssueRefreshed(this.removeLoadingClass);this.model.bindUpdated(this._handleUpdated);this.body=new JIRA.Issues.IssueBodyView({model:this.model});this.pager=new JIRA.Issues.IssuePagerView({model:this.model.getIssuePagerModel()});this.header=new JIRA.Issues.IssueHeaderView({model:this.model})},_handleUpdated:function(b){var c=b.reason;if(b.initialize){this.render()}else{if(c&&c.action===JIRA.Issues.Actions.EDIT_COMMENT){this.focusComment(c.meta.commentId)}}},_handleActionClicked:function(){this.model.getIssueEventBus().trigger("save")},focusComment:function(b){this.$("#activitymodule .focused").removeClass("focused");this.$("#comment-"+b).addClass("focused");this.$(".js-stalker").trigger("refresh")},renderPager:function(){this.pager.setElement(this.$("#issue-header-pager")).render()},updateFromDom:function(b){this.setElement(b);this.renderPager();this.$form=this.$el},destroy:function(){this.undelegateEvents();this.pager.destroy();a(document).undelegate(this.ISSUE_ACTION_SELECTOR,"click",this._handleActionClicked)},render:function(){AJS.log("IssueView: Render started for issue ["+this.model.getEntity().key+"]");this.$el.empty();this.$form=a("<div />").attr({id:"issue-content"}).addClass("issue-edit-form").appendTo(this.$el);this.updateStatusClass();this.$el.attr("tabindex","-1");this.$form.prepend(this.header.render());this.$form.append(this.body.render());var c={id:this.model.getId()};if(this.isVisible()){JIRA.trace("jira.psycho.issue.refreshed",c)}var b=this.$form;JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[b,JIRA.CONTENT_ADDED_REASON.pageLoad]);this.renderPager();return this.$el},updateStatusClass:function(){this.$el.attr("class","issue-container")},isVisible:function(){return this.$el.closest("body").length>0}}))})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/js/viewissue/view/IssuePagerView.js' */
(function(a){Backbone.define("JIRA.Issues.IssuePagerView",JIRA.Issues.BaseView.extend({template:JIRA.Templates.ViewIssue.Header.pager,events:{"simpleClick .ajax #next-issue":"_onPagerClick","simpleClick .ajax #previous-issue":"_onPagerClick","simpleClick .ajax #return-to-search":"_onReturnToSearchClick"},namedEvents:["issueRequested","returnToSearch"],initialize:function(){this.model.bind("change:pager",this.render,this)},destroy:function(){this.model.unbind("change:pager",this.render)},render:function(){var b=this.model.getPager();if(b){var c=this.template(_.extend({},b,{returnToSearch:!b.isSplitView}));this.$el.html(c)}if(AJS.activeShortcuts){AJS.activeShortcuts.j&&AJS.activeShortcuts.j._addShortcutTitle(this.$el.find("#next-issue"));AJS.activeShortcuts.k&&AJS.activeShortcuts.k._addShortcutTitle(this.$el.find("#previous-issue"));AJS.activeShortcuts.u&&AJS.activeShortcuts.u._addShortcutTitle(this.$el.find("#return-to-search"))}},_onPagerClick:function(c){if(!JIRA.Issues.DarkFeatures.KILL_SWITCH.enabled()){JIRA.Issues.Analytics._loadIssueReason="click-pager";c.preventDefault();var b=AJS.$(c.target).closest("a");if(b.is("#next-issue")){JIRA.Issues.Api.nextIssue()}else{JIRA.Issues.Api.prevIssue()}}},_onReturnToSearchClick:function(b){if(!JIRA.Issues.DarkFeatures.KILL_SWITCH.enabled()){b.preventDefault();this.model.triggerReturnToSearch();jQuery("body").focus()}}}))})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/js/viewissue/view/IssueMissingErrorView.js' */
(function(){Backbone.define("JIRA.Issues.IssueMissingErrorView",JIRA.Issues.BaseView.extend({template:JIRA.Templates.ViewIssue.Body.viewIssueDoesNotExistError,events:{"simpleClick #return-to-search":"_onReturnToSearchClick"},render:function(){var b=(JIRA.Issues.LayoutPreferenceManager.getPreferredLayoutKey()==="split-view");var a=this.template({pager:this.options.pager,hideReturnToSearch:b});this.$el.html(a)},_onReturnToSearchClick:function(a){a.preventDefault();this.options.searchPageModule.returnToSearch()}}))})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav', location = 'content/templates/issuenav.soy' */
// This file was automatically generated from issuenav.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNav == 'undefined') { JIRA.Templates.IssueNav = {}; }


JIRA.Templates.IssueNav.issueTable = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<thead><tr></tr></thead><tbody></tbody>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.columnHeader_issuetype = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<th class="issue-type issue-icon-result persist-result"><div>', soy.$$escapeHtml("T"), '</div></th>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.column_issuetype = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="issue-type issue-icon-result persist-result"><img src="', soy.$$escapeHtml(opt_data.issue.fields.issuetype.iconUrl), '" alt="', soy.$$escapeHtml(opt_data.issue.fields.issuetype.name), '" title="', soy.$$escapeHtml(opt_data.issue.fields.issuetype.description), '" align="absmiddle" border="0" height="16" width="16"></td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.columnHeader_keysummary = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<th class="issue-key persist-result"><div>', soy.$$escapeHtml("Key"), '</div></th><th class="issue-summary issue-text-result persist-result"><div>', soy.$$escapeHtml("Summary"), '</div></th>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.column_keysummary = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="issue-key-summary issue-text-result persist-result" colspan="2"><div><a href="', soy.$$escapeHtml(opt_data.contextPath), '/browse/', soy.$$escapeHtml(opt_data.issue.key), '" class="issue"><span class="secondary-text">', soy.$$escapeHtml(opt_data.issue.key), '</span>', soy.$$escapeHtml(opt_data.issue.fields.summary), '</a></div></td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.columnHeader_status = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<th class="issue-status"><div>', soy.$$escapeHtml("Status"), '</div></th>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.column_status = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="issue-status"><div class="status-lozenge">', soy.$$escapeHtml(opt_data.issue.fields.status.name), '</div></td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.columnHeader_assignee = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<th class="issue-user"><div>', soy.$$escapeHtml("Assignee"), '</div></th>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.column_assignee = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="issue-user">', (opt_data.issue.fields.assignee) ? '<img src="' + soy.$$escapeHtml(opt_data.issue.fields.assignee.avatarUrls['16x16']) + '" alt="' + soy.$$escapeHtml(opt_data.issue.fields.assignee.name) + '" height="16" width="16" /><a class="user-hover" rel="' + soy.$$escapeHtml(opt_data.issue.fields.assignee.name) + '" href="#">' + soy.$$escapeHtml(opt_data.issue.fields.assignee.displayName) + '</a>' : soy.$$escapeHtml("Unassigned"), '</td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.columnHeader_updated = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<th class="issue-datetime"><div>', soy.$$escapeHtml("Updated"), '</div></th>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.column_updated = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="issue-datetime"><time datetime="', soy.$$escapeHtml(opt_data.issue.fields.updated), '">', soy.$$escapeHtml(opt_data.TMP_FORMATTED_DATE), '</time></td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.columnHeader_resolution = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<th class="issue-resolution"><div>', soy.$$escapeHtml("Resolution"), '</div></th>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.column_resolution = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="issue-resolution">', (opt_data.issue.fields.resolution) ? soy.$$escapeHtml(opt_data.issue.fields.resolution.name) : soy.$$escapeHtml("Unresolved"), '</td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.issueResultsError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<tr class="error"><td colspan="', soy.$$escapeHtml(opt_data.columnCount), '">', soy.$$escapeHtml(opt_data.errorText), '</td></tr>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav', location = 'content/js/search/Notifications.js' */
JIRA.Issues.showNotification=function(){var a={thanks_issue_updated:"{0} has been updated.",thanks_issue_transitioned:"{0} has been updated.",thanks_issue_assigned:"{0} has been assigned.",thanks_issue_commented:"{0} has been updated with your comment.",thanks_issue_worklogged:"Work has been logged on {0}.",thanks_issue_voted:"Your vote on {0} has been updated.",thanks_issue_watched:"Your watcher status on {0} has been updated.",thanks_issue_moved:"{0} has been moved.",thanks_issue_linked:"The links on {0} have been updated.",thanks_issue_cloned:"{0} has been cloned.",thanks_issue_labelled:"The labels on {0} have been updated.",thanks_issue_deleted:"{0} has been deleted.",thanks_issue_attached:"The file(s) have been attached to {0}."};return function(c,b){var d;if(!c){c="thanks_issue_updated"}d=a[c];if(d&&b){d=AJS.format(d,b)}JIRA.Messages.showSuccessMsg(d||c,{closeable:true})}}();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav', location = 'content/js/search/IssueNavRouter.js' */
Backbone.define("JIRA.Issues.IssueNavRouter",JIRA.Issues.BaseRouter.extend({initialize:function(a){_.extend(this,a);_.bindAll(this)},routes:{"":"_restoreSessionSearch","issues/":"_restoreSessionSearch","*fragment":"_route"},navigate:function(){this.searchPageModule.removeOpenTipsies();this.trigger("navigate");JIRA.Issues.BaseRouter.prototype.navigate.apply(this,arguments)},pushState:function(a){this._setStatePermalink(a);this.navigate(JIRA.Issues.URLSerializer.getURLFromState(a),{trigger:false})},replaceState:function(a){this._setStatePermalink(a);this.navigate(JIRA.Issues.URLSerializer.getURLFromState(a),{trigger:false,replace:true})},_validateNav:function(a){return a!==Backbone.history.getFragment()},_restoreSessionSearch:function(){var b=this.initialSessionSearchState,a=JIRA.Issues.URLSerializer.getURLFromState(b||this.searchPageModule.getState());this.navigate(a,{replace:true,trigger:true})},_route:function(a){if(JIRA.Issues.ignorePopState){return}var b=JIRA.Issues.URLSerializer.getStateFromURL(a);if(!this._navigateToLoginIfNeeded(b)){this._navigateUsingState(b)}},_navigateToLoginIfNeeded:function(c,d){if(!JIRA.Issues.IssueNavRouter.usePushState(d)&&c.selectedIssueKey&&!JIRA.Issues.LoginUtils.isLoggedIn()){var a=this;var b={};if(c.filter!=null){b.filterId=c.filter}jQuery.ajax({url:AJS.contextPath()+"/rest/issueNav/1/issueNav/anonymousAccess/"+c.selectedIssueKey,headers:{"X-SITEMESH-OFF":true},data:b,success:function(){a._navigateUsingState(c)},error:function(e){if(e.status===401){a._redirectToLogin(c)}else{a._navigateUsingState(c)}}});return true}return false},_navigateUsingState:function(a){this._setStatePermalink(a);this.navigate(JIRA.Issues.URLSerializer.getURLFromState(a),{replace:true,trigger:false});this.searchPageModule.updateFromRouter(a)},_redirectToLogin:function(b){var a=AJS.contextPath()+"/login.jsp?permissionViolation=true&os_destination="+encodeURIComponent(JIRA.Issues.URLSerializer.getURLFromState(b));window.location.replace(a)},_getQueryMap:function(b){var a={};var c=b.indexOf("?");if(c!==-1){var d=b&&b.substring(c+1)||"";a=JIRA.Issues.QueryStringParser.parse(d)}return a},_updateUrl:function(){var a=this.searchPageModule.getState();this._setStatePermalink(a);this.navigate(JIRA.Issues.URLSerializer.getURLFromState(a))},navigateBySearchPageModule:function(b,c){var a=c?_.pick(c,"replace"):{};this.navigate(this._getViewIssueFragmentWithSearchContext(b,c),a)},_getViewIssueFragmentWithSearchContext:function(a,b){if(a.standalone){return"browse/"+b.key}else{return JIRA.Issues.URLSerializer.getURLFromState(_.extend(a.getState(),{startIndex:undefined}))}},_setStatePermalink:function(d){var b=_.pick(d,"selectedIssueKey");var c=AJS.Meta.get("jira-base-url");if(!_.isEmpty(b)){AJS.Meta.set("viewissue-permlink",c+"/"+JIRA.Issues.URLSerializer.getURLFromState(b))}var a=_.omit(d,"selectedIssueKey");if(!_.isEmpty(a)){AJS.Meta.set("issuenav-permlink",c+"/"+JIRA.Issues.URLSerializer.getURLFromState(a))}}},{getBackboneRoot:function(a){return AJS.contextPath()+(this.usePushState(a)?"/":"/i")},usePushState:function(c){var a=(c=c||window.history)&&c.pushState,b=AJS.DarkFeatures.isEnabled("ka.I_ROOT");return a&&!b}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav', location = 'content/js/search/util/HandlePushStateInIE.js' */
JIRA.Issues.hashTheUrl=function(b){var d=parseUri(b);var a={changed:false,uri:d};if(d.anchor===""&&d.query!==""){var c=d.protocol+"://"+d.authority+d.path;a.uri=c+"#?"+d.query;a.changed=true}return a};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav', location = 'content/js/search/util/DialogCleanup.js' */
JIRA.Issues.dialogCleaner=function(a){a.on("navigate",function(){if(JIRA.Dialog.current){JIRA.Dialog.current.hide()}if(AJS.HelpTip&&AJS.HelpTip.Manager){AJS.HelpTip.Manager.hideSequences();AJS.HelpTip.Manager.clearSequences()}})};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav', location = 'content/js/search/IssueNavCreator.js' */
JIRA.Issues.IssueNavCreator=function(){};JIRA.Issues.IssueNavCreator.prototype={create:function(r,c){JIRA.Events.LAYOUT_RENDERED="layoutRendered";JIRA.Issues.IssueNavCreated=new Date();var o=this.searchPageModule=new JIRA.Issues.SearchPageModule({},{initialIssueTableState:c.initialIssueTableState});o.registerViewContainers({issueContainer:jQuery(".issue-container"),searchContainer:jQuery(".navigator-container")});var p=this.searchHeaderModule=new JIRA.Issues.SearchHeaderModule({searchPageModule:o});var a=p.createView({searchHeaderEl:r.find("#search-header-view")});var n=new JIRA.Issues.FilterModule({searchPageModule:o,systemFilters:o.addOwnerToSystemFilters(c.systemFilters)});n.createView({$filterPanelEl:r.find(".navigator-sidebar")});var d=JIRA.Components.Query.create({el:r.find("form.navigator-search"),preferredSearchMode:AJS.Meta.get("user.search.mode"),autocompleteEnabled:AJS.params.autocompleteEnabled,basicAutoUpdate:AJS.Meta.getBoolean("hasCriteriaAutoUpdate")});if(!JIRA.Issues.DarkFeatures.KILL_SWITCH.enabled()){this.layoutSwitcherView=new JIRA.Issues.LayoutSwitcherView({searchPageModule:o});this.layoutSwitcherView.setElement(r.find("#layout-switcher-toggle")).render()}var h=this.saveInProgressManager=new JIRA.Issues.SaveInProgressManager();var b=new JIRA.Issues.ViewIssueData();var f=new JIRA.Issues.IssueModule({container:jQuery("#issue-content"),searchPageModule:o,saveInProgressManager:h,viewIssueData:b});var g=new JIRA.Issues.IssueSearchManager({initialIssueTableState:c.initialIssueTableState,initialIssueIds:c.initialIssueIds});var q=new JIRA.Issues.SearchModule({searchPageModule:o,queryModule:d,issueSearchManager:g,initialHighlightedIssueId:c.initialHighlightedIssueId,initialSelectedIssue:c.initialSelectedIssue});var e=new JIRA.Issues.Cache.IssueCacheManager({searchResults:q.getResults(),viewIssueData:b});var l=r.find(".saved-search-selector");var k=new JIRA.Issues.FullScreenIssue({issueModule:f,issueContainer:o.issueContainer,searchContainer:o.searchContainer,issueCacheManager:e});o.registerSearch(q);o.registerSearchHeaderModule(p);o.registerFilterModule(n);o.registerQueryModule(d);o.registerIssueModule(f);o.registerFullScreenIssue(k);o.registerIssueSearchManager(g);o.registerIssueCacheManager(e);o.registerLayoutSwitcher(this.layoutSwitcherView);a.render();p.registerSearch(q);p.createToolsView(l);var m=this.issueNavRouter=new JIRA.Issues.IssueNavRouter({searchPageModule:o,initialSessionSearchState:c.initialSessionSearchState});o.registerIssueNavRouter(m);JIRA.Issues.enhanceLinks.toIssueNav({searchPageModule:o});JIRA.Issues.enhanceLinks.withPushState({router:m});JIRA.Issues.enhanceLinks.toIssue({searchPageModule:o,issueModule:f});JIRA.Issues.enhanceLinks.transformToAjax();JIRA.Issues.dialogCleaner(m);JIRA.Issues.overrideIssueDialogs({getIssueId:o.getEffectiveIssueId,isNavigator:true,updateIssue:function(s){var t=JIRA.Issues.Utils.getUpdateCommandForDialog(s);return o.updateIssue(t)}});var i=AJS.$("#quicksearch-message");if(i.length){var j=JIRA.Messages.showWarningMsg(i.find("p").html(),{closeable:true});AJS.$("a",j).click(function(){j.remove()})}jQuery(document).keydown(function(u){var w=jQuery("div.aui-blanket").length>0,s=(u.which===AJS.$.ui.keyCode.ENTER||u.which===AJS.$.ui.keyCode.LEFT||u.which===AJS.$.ui.keyCode.UP||u.which===AJS.$.ui.keyCode.RIGHT||u.which===AJS.$.ui.keyCode.DOWN);if(!w&&s){var t=AJS.$(u.target),v=t.is(":not(:input)");if(t==undefined||v){if(u.which===AJS.$.ui.keyCode.ENTER){if(t==undefined||t.is(":not(a)")){JIRA.Issues.Api.viewSelectedIssue()}}else{if(u.which===AJS.$.ui.keyCode.LEFT){o.handleLeft()}else{if(u.which===AJS.$.ui.keyCode.RIGHT){o.handleRight()}else{if(u.which===AJS.$.ui.keyCode.UP){if(o.handleUp()){u.preventDefault()}}else{if(u.which===AJS.$.ui.keyCode.DOWN){if(o.handleDown()){u.preventDefault()}}}}}}}}});this._autoUpdateLoginLinks(q.getResults());return this},_autoUpdateLoginLinks:function(a){this.searchResults=a;this.searchPageModule.on("change",this._changeLoginUrl,this);a.on("change",this._changeLoginUrl,this);a.getSelectedIssue().on("change",this._changeLoginUrl,this)},_changeLoginUrl:function(){var a=JIRA.Issues.LoginUtils.redirectUrlToCurrent();jQuery(".login-link").attr("href",a);if(!JIRA.Issues.LoginUtils.isLoggedIn()){jQuery("#header-details-user > a.lnk").attr("href",a)}}};
/* module-key = 'com.atlassian.jira.gadgets:searchrequestview-charts', location = 'script/chartpopup/popupuserprefstore.js' */
/**
 * @fileoverview Implements the gadgets.UserPrefStore interface storing data in a javascript store.
 */
jQuery.namespace("jira.plugin.chartingstore", true);

jira.plugin.chartingstore = function() {
    var userPrefMap = {};
    return {
        get: function (gadgetId) {
            var userPrefs = userPrefMap[gadgetId];
            if(!userPrefs) {
                return {};
            }
            return userPrefs;
        },
        set: function (gadgetId, name, value) {
            var prefs = this.get(gadgetId);
            prefs[name] = value;
            userPrefMap[gadgetId] = prefs;
        },
        clear: function() {
            userPrefMap = {};
        }
    };
}();

gadgets.IfrGadgetService.prototype.setUserPref = function(editToken, name, value) {
    var gadgetId = this.f;
    if(gadgetId) {
        gadgetId = gadgetId.substr("gadget-".length);
    }
    jira.plugin.chartingstore.set(gadgetId, name, value);
};

/* module-key = 'com.atlassian.jira.gadgets:searchrequestview-charts', location = 'script/chartpopup/chartdialog.js' */
/**
 * @module jira.plugin.charting
 * @author Scott Harwood
 * @since 4.0
 * @requires jQuery > v1.6, jQuery.aop
 */

 /*JSLINT options*/
 /*jslint white: true, browser: true, onevar: true, plusplus: true, regexp: true, eqeqeq: true */
 /*global window, document, jQuery, dhtmlHistory, jira*/

jQuery.namespace("jira.plugin.charting");

// singleton
jira.plugin.charting = function () {
    var dialog, /* {Object} jquery object */
    DIALOG_ID = "charts-dialog",
    CHARTS_CATEGORY = "Charts",
    CHART_HEIGHT = 522,
    saveFormLoaded = false,
    idToUriMap = {},
    dialogThrobber = AJS.$('<span class="icon throbber"></span>'),

    getPostData = function(formData) {
        var postData = {};
        jQuery.each(formData, function(i, field) {
            postData[field.name] = field.value;
        });
        var filterId = getFilterId();
        if(filterId) {
            postData.filterId = filterId;
        } else {
            postData.jql = getFilterJql() || "";
        }
        var chartPanelId = dialog.getPage(0).curtab;
        postData.gadgetUri = idToUriMap[chartPanelId];
        var userPrefs = jira.plugin.chartingstore.get(chartPanelId);
        if(userPrefs) {
            var prefsMap = {};
            for (var key in userPrefs) {
                prefsMap[key] = userPrefs[key];
            }
            postData.userPrefs = prefsMap;
        }

        return postData;
    },

    loadSaveToDashboardForm = function() {
        if(!saveFormLoaded) {
            var saveFormUrl = contextPath + "/rest/gadget/1.0/chart/add";
            var filterId = getFilterId();
            if(filterId) {
                saveFormUrl = saveFormUrl + "?filterId=" + encodeURIComponent(filterId);
            } else {
                saveFormUrl = saveFormUrl + "?jql=" + encodeURIComponent(getFilterJql());
            }

            var saveFormPanel = jQuery("#saveToDashboardPanel");
            saveFormPanel.empty();
            jQuery.ajax({
                url: saveFormUrl,
                success: function(data) {
                    saveFormPanel.html(data);
                    saveFormLoaded = true;
                    var chartForm = saveFormPanel.find("form#savetodashboardform");
                    var saveButton = saveFormPanel.find("#save-btn1");
                    chartForm.submit(function(e) {
                        e.preventDefault();
                        chartForm.find(".error").remove();
                        chartForm.find(".form-errors p").remove();
                        chartForm.find(".form-errors").hide();
                        saveButton.attr("disabled", "true");

                        var postData = getPostData(chartForm.serializeArray());
                        jQuery.ajax({
                            url: chartForm.attr("action"),
                            contentType:'application/json',
                            dataType: "text",
                            data: JSON.stringify(postData),
                            type:'POST',
                            success: function (data) {
                                chartForm.trigger("fakesubmit");
                                saveButton.removeAttr("disabled", "false");
                                window.location = data;
                            },
                            error: function(XMLHttpRequest, textStatus, errorThrown) {
                                saveButton.removeAttr("disabled", "false");
                                if(XMLHttpRequest.status === 400) {
                                    var errorCollection = eval("(" + XMLHttpRequest.responseText + ")");
                                    if(errorCollection.generic.length > 0) {
                                        jQuery(errorCollection.generic).each(function(i, item) {
                                        chartForm.find(".form-errors").append("<p>" + item + "</p>");
                                        });
                                        chartForm.find(".form-errors").show();
                                    }
                                    if(errorCollection.fields.length > 0) {
                                        jQuery(errorCollection.fields).each(function(i, item) {
                                            chartForm.find("#" + item.field).after("<div class=\"error\">" + item.error + "</div>");
                                        });
                                    }
                                }
                            }
                        });

                    });
                    saveFormPanel.find("#cancel-btn1").click(function(e) {
                        dialog.prevPage();
                        saveButton.removeAttr("disabled", "false");
                        chartForm.find(".form-errors").hide();
                        chartForm.find(".error").remove();
                        e.preventDefault();
                    });
                }
            });
        }
    },

    /**
     * Appends loading indicator (throbber) to all ajax requests. Indicator, controlled via css, appears in the top
     * right corner of the dialog.
     *
     * @method addThrobber
     * @private
     */
    addThrobber = function () {
        dialog.popup.element.find(".dialog-button-panel").prepend(dialogThrobber);
        jQuery().ajaxSend(function(a,xhr) {
            if (dialog.popup.element.is(":visible")) {
                jQuery(xhr).throbber({target: dialogThrobber});
            }
        });
    },

    /**
     * Handles failed ajax requests. Will subsitute the page body with the 500 error that occured.
     *
     * @method addErrorHandler
     * @private
     */
    addErrorHandler = function () {
        jQuery().ajaxError(function(e,XMLHttpRequest,ajaxOptions){
            if (XMLHttpRequest.status == 500) {
                dialog.hide();
                jQuery("body").html(XMLHttpRequest.responseText);
            }
        });
    },

    /**
     * ESC hides the dialog
     */
    keypressListener = function(e) {       
        if (e.keyCode === 27) {
            dialog.hide();
        }
    },

    /**
     * Creates dialog box. Adds global functionality including error handling and ajax throbber indicator.
     *
     * @method createDialog
     * @private
     * @param {String, Number} width - width of dialog box
     * @param {String, Number} height - height of dialog box
     */
    createDialog = function (width, height, data) {
        dialog = new AJS.Dialog(width, height, DIALOG_ID);
        dialog.addHeader("Gadgets");
        resetPanels(data);
        dialog.addButton("Save to Dashboard",
                function(dialog) {
                    loadSaveToDashboardForm();
                    dialog.nextPage();
                },
                "save-to-dashboard");
        dialog.addCancel("Cancel", function(dialog) {
            dialog.hide();
        });
        dialog.addPage();
        dialog.page[1].addPanel("saveToDashBoard", "<div id=\"saveToDashboardPanel\"</div>");
        dialog.page[1].addHeader("Save gadget to a Dashboard");
        addThrobber();
        addErrorHandler();
        AJS.$(document).keydown(keypressListener);
    },

    /**
     * Resets the dialog to the original state when it pops up.
     *
     * @method resetDialog
     * @param {Number} initialPanel - the panel index to go to after resetting the dialog
     * @private
     */
    resetDialog = function(initialPanel) {
        if(dialog) {
            saveFormLoaded = false;
            jQuery("form[name=chartpopup]").show();
            jQuery("input[name=filterName]").val("");
            dialog.gotoPage(0);
            for(var i = 0; dialog.getPanel(i); i++) {
                var panel = dialog.getPanel(i);
                panel.loaded = false;
            }
            dialog.gotoPanel(initialPanel);
        }
    },

    /**
     * Given a directory JSON object this method figures out all the chart gadgets to display in the popup.
     *
     * @method createDialog
     * @private
     * @param {json} data -
     */
    loadChartGadgets = function(data) {
        // Fill items on the right
        var chartGadgets = [], filterResultsGadget, uri = parseUri(window.location);
        var baseUrl = uri.protocol + "://" + uri.authority;
        jQuery(data.gadgets).each(function(i, gadget) {
            //JRADEV-4419: Only add gadgets that are hosted locally to the dialog!
            if(gadget.gadgetSpecUri.indexOf("http") !== 0 || gadget.gadgetSpecUri.indexOf(baseUrl) === 0) {
                jQuery([gadget.categories]).each(function(i, catKey) {
                    var g = {title:gadget.title, specUri:gadget.gadgetSpecUri};
                    // we want to stick the Filter Results gadget at the front of the list of gadgets, so keep a reference to it
                    if (g.specUri.indexOf("filter-results") > -1) {
                        filterResultsGadget = g;
                    }
                    if(catKey.constructor==Array) { // if there are multiple categories for this gadget, loop through all of them
                        for(var j=0; j<catKey.length; ++j) {
                            // don't add the Filter Results gadget to the array - we'll do it later
                            if(catKey[j] === CHARTS_CATEGORY && filterResultsGadget != g) {
                                chartGadgets.push(g);
                            }
                        }
                    }
                    else {
                        // don't add the Filter Results gadget to the array - we'll do it later
                        if(catKey === CHARTS_CATEGORY && filterResultsGadget != g) {
                            chartGadgets.push(g);
                        }
                    }
                });
            }
        });

        chartGadgets.sort(function(one, two) { return (one.title > two.title ? 1 : -1); });
        // add the Filter Results gadget to the start
        if (filterResultsGadget) {
            chartGadgets.unshift(filterResultsGadget);
        }
        return chartGadgets;
    },

    /**
     * Renders the contents of a particular panel for a particular chart.
     *
     * @method renderPanelContents
     * @private
     * @param {Object} panel - the panel to render
     * @param {Object} data - json object with the directory contents
     */
    renderPanelContents = function(panel, data) {
        panel.body.html(data);
        panel.loaded = true;
    },

    /**
     * Sets up all the panels when the dialog loads
     *
     * @method resetPanels
     * @private
     * @param {Object} data - json object of the directory contents
     */
    resetPanels = function(data) {
        var chartGadgets = loadChartGadgets(data);
        dialog.gotoPage(0);
        jQuery(chartGadgets).each(function(i, gadget) {
            dialog.page[0].addPanel(gadget.title, "<div class=\"loadingPanel\">&nbsp;</div>");
            var panel = dialog.getPanel(i);
            if(panel) {
                panel.loaded = false;
                idToUriMap[i] = gadget.specUri;
                panel.body.show = function (panel, show) {
                    return function() {
                        if(!panel.loaded) {
                            var rendererUrl = contextPath + "/rest/gadget/1.0/chart/render?id=" + i + "&gadgetUri=" + encodeURIComponent(gadget.specUri);
                            var filterId = getFilterId();
                            if(filterId) {
                                rendererUrl = rendererUrl + "&filterId=" + encodeURIComponent(filterId);
                            } else {
                                rendererUrl = rendererUrl + "&jql=" + encodeURIComponent(getFilterJql());
                            }

                            jQuery.ajax({
                                url: rendererUrl,
                                success: function(data) {
                                    renderPanelContents(panel, data);
                                }
                            });
                        }
                        show.call(panel.body);
                    };
                }(panel, panel.body.show);
            }
        });
    },

    /**
     * Creates a new dialog (if necessary and displays it)
     *
     * @method launchDialog
     * @private
     * @param {String} url - the url to get the direcotry JSON object from
     * @param {String, Number} width - width of dialog box
     * @param {String, Number} height - height of dialog box
     * @param {String, Number} initialPanel - the first panel to load
     */
    launchDialog = function (url, width, height, initialPanel) {
        if(dialog) {
            //this ensures that all the panels will get loaded from the server again.
            resetDialog(initialPanel);
            dialog.show();
        } else {
            jQuery(jQuery.ajax({
                url: url,
                dataType: 'json',
                success: function (data) {
                    if (!dialog) {
                        createDialog(width, height, data);
                    }
                    dialog.show();
                    dialog.gotoPage(0);
                    dialog.gotoPanel(initialPanel);
                }
            })).throbber({target: jQuery("#throbber-space")});
        }
    },

    getFilterId = function()
    {
        var filterId = AJS.Meta.get('filter-id');

        if (filterId && filterId >= 0) {
            return filterId;
        }

        return null;
    },

    getFilterJql = function()
    {
        return AJS.Meta.get('filter-jql');
    };

    return function () {
        // if they clicked on Charts we default to the first chart i.e. Panel 1
        jQuery("body").delegate("#charts", "click", function(e) {
            AJS.populateParameters();
            launchDialog(contextPath + "/rest/config/1.0/directory.json", 800, CHART_HEIGHT, 1);
            e.preventDefault();
        });
        // if they clicked on On Dashboard we default to the Filter Results gadget i.e. Panel 0
        jQuery("body").delegate("#onDashboard", "click", function(e) {
            AJS.populateParameters();
            launchDialog(contextPath + "/rest/config/1.0/directory.json", 800, CHART_HEIGHT, 0);
            e.preventDefault();
        });
    };
}();

// wait for page to fully load to make sure we have all the elements we need
jQuery(document).ready(jira.plugin.charting);


/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:standalone-issue-nav', location = 'content/js/search/IssueNavInit.js' */
(function(){if(history&&history.pushState===undefined){var a=JIRA.Issues.hashTheUrl(window.location);if(a.changed){window.location=a.uri}}jQuery("html").addClass("hide-until-domready");jQuery(function(){jQuery("html").removeClass("hide-until-domready")});jQuery(document).on("keydown",function(b){if(b.which===27){b.preventDefault()}})})();AJS.$(function(){var g=AJS.$(".navigator-content");var j=g.data("issue-table-model-state");if(j&&!j.table){var a=AJS.$("<div></div>").append(g.children().clone());j.issueTable.table=a.html()}var e=g.data("highlighted-issue-id");var f=AJS.$("#stableSearchIds").data("ids");var i=g.data("selected-issue");var c=jQuery.parseJSON(jQuery("#criteriaJson").text());var d=g.data("session-search-state");var h=jQuery.parseJSON(jQuery("#systemFiltersJson").text());var b=new JIRA.Issues.IssueNavCreator().create(AJS.$(document),{initialIssueTableState:j,initialSearcherCollectionState:c,initialSessionSearchState:d,initialSelectedIssue:i,initialHighlightedIssueId:e,initialIssueIds:f,systemFilters:h});Backbone.history.start({pushState:!AJS.DarkFeatures.isEnabled("ka.I_ROOT"),root:JIRA.Issues.IssueNavRouter.getBackboneRoot()});if(jQuery.browser.webkit){JIRA.Issues.ignorePopState=true;window.addEventListener("load",function(){setTimeout(function(){JIRA.Issues.ignorePopState=false},0)})}JIRA.Issues.Api.initialize({searchPageModule:b.searchPageModule,saveInProgressManager:b.saveInProgressManager});JIRA.Issues.IssueAPI.override({searchPageModule:b.searchPageModule});JIRA.Issues.IssueNavigatorAPI.override({searchPageModule:b.searchPageModule});JIRA.Dialogs.BeforeShowIssueDialogHandler.add(JIRA.Issues.Api.waitForSavesToComplete);AJS.KeyboardShortcut.addIgnoreCondition(function(n,m,l){return l==="issueaction"&&JIRA.Issues.Api.isCurrentlyLoadingIssue()});var k=parseInt(jQuery("body").css("minWidth"),10);jQuery(document).bind("resultsWidthChanged",function(){var l=jQuery(".contained-content");var p=l.parent();if(l.length>0){var o=l.offset().left;var n=jQuery(window).width();var q=Math.max(n,k)-o;var m=q/p.width()*100;if(m<100){l.css("width",m+"%")}else{l.css("width","")}jQuery(document).trigger("issueNavWidthChanged")}});AJS.$(document).trigger("resultsWidthChanged");JIRA.Issues.onVerticalResize(function(){jQuery.event.trigger("updateOffsets.popout")});JIRA.bind(JIRA.Events.LAYOUT_RENDERED,function(){_.defer(function(){jQuery.event.trigger("updateOffsets.popout")})})});JIRA.Issues.displayFailSearchMessage=function(a){if(a&&a.statusText!=="abort"){return JIRA.Messages.showErrorMsg(JIRA.SmartAjax.buildSimpleErrorContent(a),{closeable:true})}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:standalone-issue-nav', location = 'content/js/search/util/OverrideSparklerPadding.js' */
JIRA.bind(JIRA.Events.CHECKBOXMULITSELECT_READY,function(b,a){a.closest(".form-body").addClass("checkboxmultiselect-container")});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:standalone-issue-nav', location = 'content/js/search/util/OverrideIssueDialogs.js' */
(function(){var e,f,b;JIRA.Dialogs.getDefaultAjaxOptions=function(){var g=this.options.url||this.getRequestUrlFromTrigger();this.issueId=JIRA.Issues.Api.getSelectedIssueId();this.issueKey=JIRA.Issues.Api.getSelectedIssueKey();if(/id=\{0\}/.test(g)){if(!this.issueId){return false}else{g=g.replace(/(id=\{0\})/,"id="+this.issueId)}}return{data:{decorator:"dialog",inline:"true"},url:g}};JIRA.Issues.overrideIssueDialogs=function(g){g=_.defaults({},g,{isNavigator:false});e=g.getIssueId;f=!!g.isNavigator;b=g.updateIssue;if(f){JIRA.LabelsDialog.prototype._handleSubmitResponse=JIRA.FormDialog.prototype._handleSubmitResponse}JIRA.unbind("QuickEdit.sessionComplete");JIRA.bind("QuickEdit.sessionComplete",function(){b(JIRA.Dialog.current)});JIRA.unbind("QuickCreateSubtask.sessionComplete");JIRA.bind("QuickCreateSubtask.sessionComplete",function(){b(JIRA.Dialog.current)});JIRA.bind("Dialog.show",function(j,i,h){if(h){h.issueId=e(JIRA.Dialog.current)}});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(i,h){h.find(".issueaction-workflow-transition").each(function(){var k=AJS.$(this);var j=k.attr("href");j=j.replace(/atl_token=[^&]*/,"atl_token="+atl_token());k.attr("href",j)})});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(l,j){var k=AJS.$("#ops-login-lnk");if(k.length==0){return}var h=window.location;var i=parseUri(k.attr("href"));i.queryKey.os_destination=h.pathname.slice(contextPath.length)+h.search;k.attr("href",i.path+"?"+AJS.$.param(i.queryKey))})};var d=JIRA.FormDialog.prototype._getDefaultOptions;JIRA.FormDialog.prototype._getDefaultOptions=function(){var g=d.call(this),h=g.onDialogFinished;g.onDialogFinished=function(){if(this.isIssueDialog()){c.apply(this,arguments)}else{h.apply(this,arguments)}};return g};var a=JIRA.FormDialog.prototype._performRedirect;JIRA.FormDialog.prototype._performRedirect=function(){if(this.isIssueDialog()){c.apply(this,arguments)}else{a.apply(this,arguments)}};function c(){if(this.options.id==="clone-issue-dialog"){a.apply(this,arguments)}else{if(this.options.id==="delete-issue-dialog"){if(f){this.hide();b(this)}else{var h=this._getTargetUrlValue();if(h&&h!==""){AJS.reloadViaWindowLocation(h)}else{if(AJS.$(".page-navigation #next-issue").length>0){AJS.reloadViaWindowLocation(AJS.$(".page-navigation #next-issue").attr("href"))}else{if(AJS.$(".page-navigation #return-to-search").length>0){AJS.reloadViaWindowLocation(AJS.$(".page-navigation #return-to-search").attr("href"))}else{AJS.reloadViaWindowLocation(AJS.$("#find_link").attr("href"))}}}}}else{var g=this;this.showFooterLoadingIndicator();b(this).always(function(){JIRA.trace("jira.issue.update");g.hideFooterLoadingIndicator();g.hide()})}}}})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:standalone-issue-nav', location = 'content/js/search/IssueNavigatorAPI.js' */
JIRA.Issues.IssueNavigatorAPI=(function(){var a;var b={isNavigator:function(){return a.isIssueVisible()}};var c={focusSearch:JIRA.Issues.Api.focusSearch,isNavigator:b.isNavigator,selectNextIssue:JIRA.Issues.Api.nextIssue,selectPreviousIssue:JIRA.Issues.Api.prevIssue,viewSelectedIssue:JIRA.Issues.Api.viewSelectedIssue};return{override:function(d){a=d.searchPageModule;JIRA.IssueNavigator=_.extend(JIRA.IssueNavigator,b);JIRA.IssueNavigator.Shortcuts=_.extend(JIRA.IssueNavigator.Shortcuts,c)}}})();
/* module-key = 'com.pyxis.greenhopper.jira:gh-globalissueoperations', location = 'includes/js/gh-globalissueoperations.js' */
(function(){var b=JIRA.FormDialog.extend({_performRedirect:function(d){AJS.$(AJS).trigger("gh.issueaction.gotorapidboard",{action:"direct"});window.location.href=d}});var c=new b({id:"gh-rapidboard-dialog",trigger:"a.issueaction-greenhopper-rapidboard-operation",ajaxOptions:JIRA.Dialogs.getDefaultAjaxOptions});var a=function(e){var f="";var d=AJS.$(e);if(d.hasClass("js-rapidboard-operation-sprint")){f="sprint"}else{if(d.hasClass("js-rapidboard-operation-issue")){f="issue"}}return f};AJS.$(function(){AJS.$(document).delegate(".issueaction-greenhopper-rapidboard-operation","click",function(d){d.preventDefault();var e=a(d.currentTarget);AJS.$(AJS).trigger("gh.issueaction.gotorapidboard",{eventSuffix:e,action:"open"});c.show()});AJS.$(document).delegate(".js-select-rapidboard","click",function(d){var e=a(d.currentTarget);AJS.$(AJS).trigger("gh.issueaction.gotorapidboard",{eventSuffix:e,action:"chosen"})})})})();
/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/initFieldPickers.js' */
(function(c){function b(d){c(".js-epic-picker",d).each(function(){var f=c(this);var e=new JIRA.EpicPicker({element:f});c(document).trigger(JIRA.EpicPicker.READY_EVENT,e)})}function a(d){c(".js-sprint-picker",d).each(function(){var f=c(this);var e=new JIRA.SprintPicker({element:f});c(document).trigger(JIRA.SprintPicker.READY_EVENT,e)})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(g,d,f){if(f!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){b(d);a(d)}})})(AJS.$);
/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/EpicPicker.js' */
JIRA.EpicPicker=AJS.SingleSelect.extend({init:function(d){var f=d.element;var c=this;function a(h){return{searchQuery:h,projectKey:AJS.$(f).attr("data-project-key"),maxResults:10}}function e(o,j,l){o=soy.$$escapeHtml(o);j=soy.$$escapeHtml(j);l=soy.$$escapeHtml(l);var p=l.toUpperCase();var k=o.toUpperCase();var q=j.toUpperCase();var p=(p+"").replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g,"\\$1");var h=new RegExp("("+p+")","gi");var m=k.search(h);var n;if(m>-1){n=o.slice(m,m+l.length);o=o.replace(n,"<em>"+n+"</em>")}m=q.search(h);if(m>-1){n=j.slice(m,m+l.length);j=j.replace(n,"<em>"+n+"</em>")}return o+" - ("+j+")"}function g(l){if(!l.epicNames){return[]}var q=[];var k=l.epicNames;var r=c.getQueryVal();var m=new AJS.GroupDescriptor({weight:1,id:"epic-names",label:r.length===0?"Suggestions":AJS.format("Showing {0} of {1} matching epics",k.length,l.total),replace:true});for(var n=0,o=k.length;n<o;n++){var j=k[n];var h=j.key;var p=j.name;var s=p+" - ("+h+")";var t=e(p,h,r);m.addItem(new AJS.ItemDescriptor({value:"key:"+h,fieldText:p,label:t,html:t,allowDuplicate:false,highlighted:true}))}q.push(m);return q}function b(j,k,i){var h=AJS.$(f);h.siblings(".ghx-error").remove();h.before(GH.tpl.rapid.notification.renderAuiMessage({message:("Error"+": "+i),type:"error",className:"ghx-error aui-ss"}))}AJS.$.extend(d,{submitInputVal:true,showDropdownButton:true,removeDuplicates:true,ajaxOptions:{url:contextPath+"/rest/greenhopper/1.0/epics",query:true,data:a,formatResponse:g,error:b}});this._super(d)}});JIRA.EpicPicker.READY_EVENT="gh.epic-picker.ready";
/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/SprintPicker.js' */
JIRA.SprintPicker=AJS.SingleSelect.extend({init:function(e){var m={ACTIVE:"ACTIVE",FUTURE:"FUTURE",CLOSED:"CLOSED"};var i=10;var k,n;var s=e.element.data("saved-state"),r=e.element.data("saved-id");var g,p=this;var d=AJS.SelectSuggestHandler.extend({formatSuggestions:function(v,w){v=this._super(v,w);if(w.length===0){v[v.length-1].footerText("Start typing for sprints.")}return v}});AJS.$.extend(e,{submitInputVal:false,showDropdownButton:true,removeOnUnSelect:false,maxInlineResultsDisplayed:i,ajaxOptions:{url:contextPath+"/rest/greenhopper/1.0/sprint/picker",query:true,formatResponse:t}});o();function h(w){var v=k.apply(this,arguments);v.find("a").append(GH.tpl.customfields.sprintpicker.renderSuggestionMeta(w.properties));return v}function u(x){var w=this.getSelectedDescriptor(),v;if(!x&&!w){b(null)}j();this.hideErrorMessage();if(!w){v=c(x)}else{v=q(w)}if(v.message){this.options.errorMessage=v.message;n.apply(this,arguments);this.$errorMessage.addClass("inline-edit-error")}if(v.needsScopeChangeWarning){l()}}function c(x){var w=null,v=false;if(x&&x.length>0){if(s){w=AJS.format("{0} is not a valid sprint name. This issue will be returned to the backlog.",x);if(s===m.ACTIVE){v=true}}else{w=AJS.format("{0} is not a valid sprint name.",x)}}else{if(s===m.ACTIVE){v=true}}return{message:w,needsScopeChangeWarning:v}}function q(w){var v=false;if(s===m.ACTIVE){if(r!=w.properties.value){v=true}}else{if(s===m.FUTURE){if(w.properties.stateKey===m.ACTIVE){v=true}}else{if(!s){if(w.properties.stateKey===m.ACTIVE){v=true}}}}return{message:null,needsScopeChangeWarning:v}}function l(){if(!g){g=AJS.$(GH.tpl.rapid.notification.renderAuiMessage({type:"warning",className:"ghx-sprint-picker-scope-warning",icon:true,title:"Sprint scope will be affected by this action."}));var v=p.$container.closest(".inline-edit-fields");if(v.size()>0){v.closest(".editable-field").append(g)}else{p.$container.closest(".field-group").append(g)}}g.show()}function j(){if(g){g.remove();g=null}}function t(v){if(!v.suggestions&&!v.allMatches){return[]}var x=new AJS.GroupDescriptor({weight:0,label:"Suggestions"});var w=new AJS.GroupDescriptor({weight:1,label:"All sprints"});_.each(a(v.suggestions),function(y){x.addItem(f(y,true))});_.each(a(v.allMatches),function(y){w.addItem(f(y,false))});return[x,w]}function f(x,w){var v=soy.$$escapeHtml(x.name);return new AJS.ItemDescriptor({value:x.id.toString(),label:x.name,html:v,stateKey:x.stateKey,boardName:x.boardName,allowDuplicate:false,isSuggestion:w})}function a(v){return _.sortBy(v,function(w){return w.name.toLowerCase()})}function b(v){if(GH.SprintConfig){AJS.$(GH).trigger("QuickEdit.fieldChange",{fieldId:GH.SprintConfig.getSprintFieldId(),fieldChangeData:{original:r,updated:v?v.properties.value:null}})}}function o(){p._super(e);k=p.listController._renders.suggestion;n=p.showErrorMessage;p.listController._renders.suggestion=h;p.showErrorMessage=u;e.element.bind("selected",function(x,w,v){v.showErrorMessage(v.getQueryVal());b(w)});p.suggestionsHandler=new d(p.options,p.model)}}});JIRA.SprintPicker.READY_EVENT="gh.sprint-picker.ready";
/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/SprintPicker.soy' */
// This file was automatically generated from SprintPicker.soy.
// Please don't edit this file by hand.

if (typeof GH == 'undefined') { var GH = {}; }
if (typeof GH.tpl == 'undefined') { GH.tpl = {}; }
if (typeof GH.tpl.customfields == 'undefined') { GH.tpl.customfields = {}; }
if (typeof GH.tpl.customfields.sprintpicker == 'undefined') { GH.tpl.customfields.sprintpicker = {}; }


GH.tpl.customfields.sprintpicker.renderSuggestionMeta = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.boardName && ! opt_data.isSuggestion) {
    output.append('<span class=\'ghx-sprint-picker-meta\'> (');
    GH.tpl.customfields.sprintpicker.renderMetaWithBoardName(opt_data, output);
    output.append(')</span>');
  } else {
    output.append('<span class=\'ghx-sprint-picker-meta\'> (');
    GH.tpl.customfields.sprintpicker.renderMetaWithoutBoardName(opt_data, output);
    output.append(')</span>');
  }
  return opt_sb ? '' : output.toString();
};


GH.tpl.customfields.sprintpicker.renderMetaWithoutBoardName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.stateKey == 'ACTIVE') ? soy.$$escapeHtml("Active sprint") : (opt_data.stateKey == 'FUTURE') ? soy.$$escapeHtml("Future sprint") : '');
  return opt_sb ? '' : output.toString();
};


GH.tpl.customfields.sprintpicker.renderMetaWithBoardName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.stateKey == 'ACTIVE') ? soy.$$escapeHtml(AJS.format("Active sprint in {0}",opt_data.boardName)) : (opt_data.stateKey == 'FUTURE') ? soy.$$escapeHtml(AJS.format("Future sprint in {0}",opt_data.boardName)) : '');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/rapid/ui/notification/Notification.js' */
GH.Notification={};GH.Notification.showErrors=function(d,a){var b=GH.Notification.prepareNotificationDiv();var c=GH.tpl.rapid.notification.renderErrorMessages(d);if(typeof a=="undefined"){a=true}AJS.messages.error(b,{title:"Error",body:c,closeable:a});if(GH.Notification._divStyle(b)){b.css(GH.Notification._divStyle(b))}b.show()};GH.Notification.showWarnings=function(f,e){var b={autoHide:true,autoHideDelay:5000,preRendered:false,showTitle:false};e=_.extend({},b,e);var c=GH.Notification.prepareNotificationDiv();var a;if(!e.preRendered){a=GH.tpl.rapid.notification.renderErrorMessages({errors:f})}else{a=f}var d={body:a,closeable:true};if(e.showTitle){d.title="Warning"}AJS.messages.warning(c,d);if(GH.Notification._divStyle(c)){c.css(GH.Notification._divStyle(c))}c.show();if(e.autoHide){setTimeout(function(){c.hide()},e.autoHideDelay)}};GH.Notification.showWarning=function(b){var a=GH.Notification.prepareNotificationDiv();AJS.messages.warning(a,{body:b,closeable:true});if(GH.Notification._divStyle(a)){a.css(GH.Notification._divStyle(a))}a.show()};GH.Notification.clear=function(){GH.Notification.prepareNotificationDiv().hide()};GH.Notification.handleDateFormatMismatchError=function(c){var b='<a href="'+GH.Ajax.CONTEXT_PATH+'/secure/admin/AdvancedApplicationProperties.jspa">';b+="Advanced Settings";b+="</a>";var a=AJS.format("It appears your JIRA date format settings are misconfigured. Please check the {0} and ensure that \'\'jira.date.time.picker.java.format\'\' and \'\'jira.date.time.picker.javascript.format\'\' have matching output.",b);GH.Notification.showWarnings(a,{autoHide:false,preRendered:true})};GH.Notification.auiMessage=function(b){var a=_.extend({type:"generic",icon:true,messageHtml:false},b);return GH.tpl.rapid.notification.renderAuiMessage({type:a.type,title:a.title,icon:a.icon,messageHtml:a.messageHtml,message:a.message})};GH.Notification.Handler={_defaultNotificationHandler:function(){var a=AJS.$("<div/>");AJS.$(".global-msg").remove();a.addClass("global-msg").appendTo("body");return a},_defaultDivStyleHandler:function(a){return{marginLeft:-a.outerWidth()/2,top:20}},setCustomDivStyleHandler:function(a){this._customDivStyleHandler=a;this._useDefault=false},_useDefault:true,setCustomNotificationHandler:function(a){this._customNotificationHandler=a;this._useDefault=false},removeCustomHandlers:function(){this._useDefault=true},getNotificationHandler:function(){if(!this._useDefault&&this._customNotificationHandler!=null){return this._customNotificationHandler}else{return this._defaultNotificationHandler}},getDivStyleHandler:function(){if(!this._useDefault&&this._customDivStyleHandler!=null){return this._customDivStyleHandler}else{return this._defaultDivStyleHandler}}};GH.Notification._divStyle=function(b){var a=GH.Notification.Handler.getDivStyleHandler();return a(b)};GH.Notification.prepareNotificationDiv=function(){var a=GH.Notification.Handler.getNotificationHandler();return a()};GH.Notification.showSuccess=function(d,b){clearTimeout(GH.Notification.current);var a={timeout:5000,closeable:true,shadowed:true};b=_.extend(a,b,{body:d});var c=GH.Notification.prepareNotificationDiv();AJS.messages.success(c,b);if(GH.Notification._divStyle(c)){c.css(GH.Notification._divStyle(c))}c.show();GH.Notification.current=setTimeout(function(){AJS.$(".global-msg").hide()},b.timeout)};GH.Notification.showIssueMessage=function(d){var c=JIRA.SessionStorage;var b=null;var a=null;if(!d){d=c.getItem("selectedIssueId")}if(d){a=c.getItem("selectedIssueKey");b=c.getItem("selectedIssueMsg");GH.Notification.showIssueMessageImpl(d,b,a)}c.removeItem("selectedIssueId");c.removeItem("selectedIssueKey");c.removeItem("selectedIssueMsg")};GH.Notification.showIssueMessageImpl=function(d,c,a){if(!c){c="thanks_issue_updated"}var b=AJS.params[c];if(b&&a){b=AJS.format(b,a);GH.Notification.showSuccess(b)}};GH.Notification.addPageLoadMessage=function(c,a){var b=GH.storage.get("gh.pageloadmessages",true)||[];b.push({message:c,type:a||"success"});GH.storage.put("gh.pageloadmessages",b,true)};GH.Notification._displayPageLoadMessages=function(){var c=GH.storage.get("gh.pageloadmessages",true);if(c){var a=c[0].type;var b="";_.each(c,function(d){if(b.length>0){b+="<br>"}b+=d.message});switch(a){case"warning":GH.Notification.showWarning(b);break;case"success":default:GH.Notification.showSuccess(b);break}GH.storage.put("gh.pageloadmessages",null,true)}};GH.Notification.showBoardUpdatedMessage=function(){GH.Notification.clearBoardUpdatedMessage();var b=AJS.$.Deferred();var a=AJS.$(GH.tpl.rapid.notification.renderGHtvMessage()).appendTo("#gh");a.data("deferred",b);a.find(".js-refresh-now").click(function(c){c.preventDefault();a.removeData("deferred");GH.Notification.clearBoardUpdatedMessage();b.resolve()});a.find(".js-ignore-refresh").click(function(c){c.preventDefault();GH.Notification.clearBoardUpdatedMessage()});AJS.$(".ghx-feedback").css({visibility:"hidden"});return b.promise()};GH.Notification.clearBoardUpdatedMessage=function(){var a=AJS.$("#ghx-update-message");if(a.length){var b=a.data("deferred");if(b&&b.reject){b.reject()}a.remove()}AJS.$(".ghx-feedback").css({visibility:""})};GH.Notification.isBoardUpdatedMessageVisible=function(){var a=AJS.$("#ghx-update-message");return a.length>0};AJS.$(document).ready(function(){GH.Notification.showIssueMessage();if(GH.storage){GH.Notification._displayPageLoadMessages()}});
/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/rapid/ui/notification/Notification.soy' */
// This file was automatically generated from Notification.soy.
// Please don't edit this file by hand.

if (typeof GH == 'undefined') { var GH = {}; }
if (typeof GH.tpl == 'undefined') { GH.tpl = {}; }
if (typeof GH.tpl.rapid == 'undefined') { GH.tpl.rapid = {}; }
if (typeof GH.tpl.rapid.notification == 'undefined') { GH.tpl.rapid.notification = {}; }


GH.tpl.rapid.notification.renderErrorMessages = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.errors.length > 1) {
    output.append('<ul>');
    var errorList6 = opt_data.errors;
    var errorListLen6 = errorList6.length;
    for (var errorIndex6 = 0; errorIndex6 < errorListLen6; errorIndex6++) {
      var errorData6 = errorList6[errorIndex6];
      output.append('<li>', (errorData6.noAutoescape) ? errorData6.message : soy.$$escapeHtml(errorData6.message), '</li>');
    }
    output.append('</ul>');
  } else {
    var errorList18 = opt_data.errors;
    var errorListLen18 = errorList18.length;
    for (var errorIndex18 = 0; errorIndex18 < errorListLen18; errorIndex18++) {
      var errorData18 = errorList18[errorIndex18];
      output.append('<p>', (errorData18.noAutoescape) ? errorData18.message : soy.$$escapeHtml(errorData18.message), '</p>');
    }
  }
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderContextualErrors = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var errorList29 = opt_data.errors;
  var errorListLen29 = errorList29.length;
  for (var errorIndex29 = 0; errorIndex29 < errorListLen29; errorIndex29++) {
    var errorData29 = errorList29[errorIndex29];
    output.append('<div class="ghx-error">', soy.$$escapeHtml(errorData29.message), '</div>');
  }
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderMessageHolder = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="ghx-body-warning">', soy.$$escapeHtml(AJS.format("This version of {0} is not a supported browser.",opt_data.browser)), ' <a href="', soy.$$escapeHtml(opt_data.docsUrl), '">', soy.$$escapeHtml("See our documentation for the list of supported browsers."), '</a></div>');
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderAuiMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message ', soy.$$escapeHtml(opt_data.type), (opt_data.className) ? ' ' + soy.$$escapeHtml(opt_data.className) : '', '">', (opt_data.title) ? '<p class="title">' + ((opt_data.icon) ? '<span class="aui-icon icon-' + soy.$$escapeHtml(opt_data.type) + '"></span>' : '') + '<strong>' + soy.$$escapeHtml(opt_data.title) + '</strong></p>' : '', (opt_data.message) ? '<p>' + ((! opt_data.title && opt_data.icon) ? '<span class="aui-icon icon-' + soy.$$escapeHtml(opt_data.type) + '"></span>' : '') + ((opt_data.messageHtml) ? opt_data.message : soy.$$escapeHtml(opt_data.message)) + '</p>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderGHtvMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="ghx-update-message" class="ghx-tv-message"><p>', soy.$$escapeHtml("This board has been updated"), ': <a href="" class="js-refresh-now">', soy.$$escapeHtml("Refresh"), '</a><span class="ghx-divider">&bull;</span><a href="" class="js-ignore-refresh">', soy.$$escapeHtml("Ignore"), '</a></p></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.pyxis.greenhopper.jira:gh-globalkeyboardshortcuts', location = 'includes/js/gh-globalkeyboardshortcuts.js' */
(function(b){b.namespace("gh.app.globalkeyboardshortcuts");var a=gh.app.globalkeyboardshortcuts;a.findSelectedIssueId=function(){var c;if(jira&&jira.app&&jira.app.issuenavigator&&jira.app.issuenavigator.getSelectedIssueId){c=jira.app.issuenavigator.getSelectedIssueId()}if(!c&&jira&&jira.app&&jira.app.issue&&jira.app.issue.getIssueId){c=jira.app.issue.getIssueId()}return c};a.goToAgile=function(){var c=(contextPath?contextPath:"")+"/secure/GreenHopper.jspa";window.location.href=c};a.followLink=function(c){var d=b(c);if(d.length>0&&(d[0].nodeName.toLowerCase()==="a"||d[0].nodeName.toLowerCase()==="link")){d.click();window.location.href=d.attr("href")}};a.sendToTop=function(d,e){if(window.GH&&GH.RapidBoard&&GH.Shortcut&&GH.Shortcut.sendToTop){GH.Shortcut.sendToTop(d);a.closeDialogAndPopMessage();return}if(d!="Action"){return}var c=e||a.findSelectedIssueId();if(!contextPath){contextPath=""}JIRA.SmartAjax.makeRequest({type:"post",contentType:"application/json",url:contextPath+"/rest/greenhopper/1.0/rank/global/first",data:JSON.stringify({issueId:c}),success:a.handleRankSuccess});AJS.$(AJS).trigger("gh.global.rankissues",{action:"rankToTop"+(d?d:""),count:1})};a.sendToBottom=function(d,e){if(window.GH&&GH.RapidBoard&&GH.Shortcut&&GH.Shortcut.sendToBottom){GH.Shortcut.sendToBottom(d);a.closeDialogAndPopMessage();return}if(d!="Action"){return}var c=e||a.findSelectedIssueId();if(!contextPath){contextPath=""}JIRA.SmartAjax.makeRequest({type:"post",contentType:"application/json",url:contextPath+"/rest/greenhopper/1.0/rank/global/last",data:JSON.stringify({issueId:c}),success:a.handleRankSuccess});AJS.$(AJS).trigger("gh.global.rankissues",{action:"rankToBottom"+(d?d:""),count:1})};a.closeDialogAndPopMessage=function(){if(JIRA.IssueNavigator.isNavigator()){AJS.reloadViaWindowLocation()}else{if(JIRA.Dialog&&JIRA.Dialog.current){JIRA.Dialog.current.hide()}if(window.GH){if(GH.Message&&GH.Message.showIssueMessage){GH.Message.showIssueMessage()}else{if(GH.RapidBoard&&GH.Notification&&GH.Notification.showIssueMessage){GH.Notification.showIssueMessage()}}if(window.Boards){Boards.refreshAll()}}else{if(JIRA.IssueNavigator&&JIRA.IssueNavigator.Shortcuts&&JIRA.IssueNavigator.Shortcuts.flashIssueRow){JIRA.IssueNavigator.Shortcuts.flashIssueRow()}}}};a.handleRankSuccess=function(c,e,d){a.storeSuccessMessage(c.issueId,c.issueKey,"thanks_issue_updated");a.closeDialogAndPopMessage()};a.storeSuccessMessage=function(e,c,d){var f=JIRA.SessionStorage;f.setItem("selectedIssueId",e);f.setItem("selectedIssueKey",c);f.setItem("selectedIssueMsg",d)};AJS.$(function(){AJS.$(document).delegate(".issueaction-greenhopper-rank-top-operation","click",function(c){c.preventDefault();var d=AJS.$(this).attr("data-issueid");a.sendToTop("Action",d)});AJS.$(document).delegate(".issueaction-greenhopper-rank-bottom-operation","click",function(c){c.preventDefault();var d=AJS.$(this).attr("data-issueid");a.sendToBottom("Action",d)})})})(AJS.$);
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-public', location = 'js/applinks.public.js' */
var ApplinksUtils=ApplinksUtils||(function(f){var c={},b={};var p="com_atlassian_applinks_authentication";function o(r){var q=f('<span class="aui-icon icon-close"></span>').click(function(){r.trigger("messageClose",[this]).remove()});r.append(q)}function g(){if(window===parent.window){return null}var r=null,q=window;f("iframe",parent.document.body).each(function(s){if(this.contentWindow.window===q){r=this}});return r}function d(r,w,v,q,s){if(w in c){var t=c[w];if(v){t.authAdminUri=q;delete c[w]}j(t,v)}if(!s&&parent&&(parent!==window)){var u=window;f("iframe",parent.document.body).each(function(x,z){var y=z.contentWindow;if(y!==u){if(y.AJS&&y.AJS.$){y.AJS.$(y.document).trigger("applinks.auth.completion",[w,v,q,true])}}})}}function j(q,t){var s=f(document);if(t){var r=function(u){if(u.isDefaultPrevented()){m(q)}else{h(q);document.location.reload(true)}};s.bind("applinks.auth.approved",r);s.trigger("applinks.auth.approved",q);s.unbind("applinks.auth.approved",r)}else{s.trigger("applinks.auth.denied",q)}}function k(r,q){var s=r.find("a.applink-authenticate");if(r.hasClass("aui-message")){o(r)}s.click(function(t){window.open(q.authUri,p);t.preventDefault()});c[q.id]=q;return r}function n(){f(".applinks-auth-request").each(function(t){var s=f(this),v=s.find(".applinkId").val(),q=s.find(".appName").val(),r=s.find(".appUri").val(),u=s.find(".authUri").val();if(v&&u){k(s,{id:v,appName:q,appUri:r,authUri:u})}})}function i(q){var r=f('<div class="aui-message warning closeable applinks-auth-request"><p><span class="aui-icon icon-applinks-key"></span></p></div>');r.append(AJS.format("Additional information may be available, please \u003ca class=\"applink-authenticate\" href=\"{0}\">authenticate\u003c\/a> with \u003ca href=\"{1}\">{2}\u003c\/a>.",AJS.escapeHtml(q.authUri),AJS.escapeHtml(q.appUri),AJS.escapeHtml(q.appName)));k(r,q);return r}function e(u,r){var q=f('<span class="applinks-auth-request"></span>'),s=f('<span class="applinks-request-description"></span>'),t=AJS.format("\u003ca class=\"applink-authenticate\" href=\"{0}\">Authenticate\u003c\/a> to see additional information.",AJS.escapeHtml(r.authUri));if(u){s.append(u);s.append(" - ")}s.append(t);q.append(s);k(q,r);return q}function h(q){var r=g();if((!r)||(!r.id)){return}if(!parent.ApplinksUtils.pendingConfirmations){parent.ApplinksUtils.pendingConfirmations={}}if(!(r.id in parent.ApplinksUtils.pendingConfirmations)){parent.ApplinksUtils.pendingConfirmations[r.id]=[]}parent.ApplinksUtils.pendingConfirmations[r.id].push(q);return}function l(){if(parent&&parent.ApplinksUtils&&parent.ApplinksUtils.pendingConfirmations){var r=g();if(r){if(r.id in parent.ApplinksUtils.pendingConfirmations){var s=parent.ApplinksUtils.pendingConfirmations[r.id];delete parent.ApplinksUtils.pendingConfirmations[r.id];for(var q=0,t=s.length;q<t;q++){m(s[q])}}}}}function m(s){var t=f(document),r=f('<div class="aui-message success closeable applinks-auth-confirmation"><p><span class="aui-icon icon-applinks-key-success"></span></p></div>'),q=t.find("div.applinks-auth-confirmation-container");if(!q.length){q=t.find("body")}r.append(AJS.format("This application is now using \u003ca href=\"{0}\">{1}\u003c\/a>\'\'s credentials. Revoke access at any time by going to \u003ca href=\"{2}\">OAuth access tokens\u003c\/a>.",AJS.escapeHtml(s.appUri),AJS.escapeHtml(s.appName),AJS.escapeHtml(s.authAdminUri)));o(r);q.prepend(r);setTimeout(function(){r.fadeOut(1000,function(){f(this).remove()})},5000)}function a(){if(parent&&!(parent===window)){if(!parent.ApplinksUtils){parent.ApplinksUtils={}}}f(document).bind("applinks.auth.completion",d);n();l()}f(document).ready(a);return{createAuthRequestBanner:i,createAuthRequestInline:e}})(AJS.$);
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/fecru-compatibility.js' */
if(jQuery!=undefined&&AJS!=undefined){jQuery=AJS.$};
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/rest-service.js' */
AppLinks=AJS.$.extend(window.AppLinks||{},{Event:{NAMESPACE:"applinks",}});AppLinks.Event=AJS.$.extend(window.AppLinks.Event,{PREREADY:AppLinks.Event.NAMESPACE+".preready",READY:AppLinks.Event.NAMESPACE+".ready"});if(AJS.AppLinksInitialisationBinder){AppLinks.initialisationBinder=AJS.AppLinksInitialisationBinder}else{AppLinks.initialisationBinder=function(a){AJS.toInit(a)}}AppLinks.initialisationBinder(function(){var b=AJS.$;AppLinks=b.extend(window.AppLinks||{},{failure:function(e){if(e.status==401){window.location.reload()}else{var c=AppLinks.parseError(e);var d=b(".page-error");if(d.length>0){d.html(c).fadeIn("slow")}else{alert("REST request failed: "+c)}}},jsonRequest:function(d,e,f,g,c){if(f){f=JSON.stringify(f)}b(".page-error").fadeOut("fast");if(!c){c=AppLinks.failure}return jQuery.ajax({url:d,type:e,data:f,dataType:"json",contentType:"application/json; charset=utf-8",cache:false,success:g,error:c})},xmlRequest:function(d,e,f,g,c){if(f){f=JSON.stringify(f)}b(".page-error").fadeOut("fast");if(!c){c=AppLinks.failure}return jQuery.ajax({url:d,type:e,data:f,dataType:"xml",contentType:"application/xml; charset=utf-8",cache:false,success:g,error:c})},parseError:function(f){var c;try{c=JSON.parse(f.responseText)}catch(d){if(f.statusText){return c=f.statusText}else{return f}}if(c.message){if(b.isArray(c.message)){return c.message.join(" ")}return c.message}else{return f.statusText}},put:function(d,e,f,c){return AppLinks.jsonRequest(d,"PUT",e,f,c)},post:function(d,e,f,c){return AppLinks.jsonRequest(d,"POST",e,f,c)},update:function(d,e,c){AppLinks.put(AppLinks.self_link(d),d,e,c)},get:function(d,e,c){return AppLinks.jsonRequest(d,"GET",null,e,c)},getXml:function(d,e,c){return AppLinks.xmlRequest(d,"GET",null,e,c)},self_link:function(e){for(var c=0,f=e.link.length;c<f;c++){var d=e.link[c];if(d.rel=="self"){return d.href}}throw"No self-link found"},del:function(f,e,d){var c;if(typeof(f)=="string"){c=f}else{c=AppLinks.self_link(f)}return AppLinks.jsonRequest(c,"DELETE",null,e,d)},SPI:b.extend({},{API_VERSION:"1.0",REST_RESOURCE_URL:AJS.contextPath()+"/rest/applinks/",BASE_URL:AJS.contextPath()+"/rest/applinks/1.0",setApiVersion:function(c){AppLinks.SPI.API_VERSION=c;AppLinks.SPI.setBaseUrl(AppLinks.SPI.REST_RESOURCE_URL+AppLinks.SPI.API_VERSION)},setBaseUrl:function(c){AppLinks.SPI.BASE_URL=c},getRemoteRestBaseUrl:function(c){return c+"/rest/applinks/"+AppLinks.SPI.API_VERSION},getRemotePluginServletBaseUrl:function(c){return c+"/plugins/servlet"},getAllLinks:function(e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink";return AppLinks.get(c,e,d)},getAllLinksWithAuthInfo:function(e,d){var c=AppLinks.SPI.BASE_URL+"/listApplicationlinks";return AppLinks.get(c,e,d)},getLinksOfType:function(e,f,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/type/"+e;return AppLinks.get(c,f,d)},tryToFetchManifest:function(e,f,d){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/manifest.json?url="+encodeURIComponent(e);return AppLinks.get(c,f,d)},getManifestFor:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/manifest/"+f+".json";return AppLinks.get(c,e,d)},getLocalManifest:function(e,d){var c=AppLinks.SPI.BASE_URL+"/manifest.json";return AppLinks.get(c,e,d)},getRemoteManifest:function(e,f,d){var c=AppLinks.SPI.getRemoteRestBaseUrl(e)+"/manifest.json";return AppLinks.get(c,f,d)},getRemoteOAuthConsumerInfo:function(e,f,d){var c=AppLinks.SPI.getRemotePluginServletBaseUrl(e)+"/oauth/consumer-info";return AppLinks.getXml(c,f,d)},createStaticUrlAppLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/createStaticUrlAppLink?typeId="+f;return AppLinks.post(c,null,e,d)},createLink:function(j,h,l,d,i,k,f,m,e){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/createAppLink";var g={applicationLink:j,username:h,password:l,createTwoWayLink:d,customRpcURL:i,rpcUrl:k,configFormValues:f};return AppLinks.post(c,g,m,e)},createLinkWithOrphanedTrust:function(j,h,m,d,i,k,f,l,n,e){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/createAppLink";var g={applicationLink:j,username:h,password:m,createTwoWayLink:d,customRpcURL:i,rpcUrl:k,configFormValues:f,orphanedTrust:l};return AppLinks.post(c,g,n,e)},verifyTwoWayLinkDetails:function(c,i,j,f,h,e){var d=AppLinks.SPI.BASE_URL+"/applicationlinkForm/details";var g={username:j,password:f,remoteUrl:c,rpcUrl:i};return AppLinks.post(d,g,h,e)},getApplicationLinkInfo:function(e,f,d){var c=AppLinks.SPI.BASE_URL+"/applicationlinkInfo/id/"+e;return AppLinks.get(c,f,d)},deleteLink:function(g,c,f,e){var d=AppLinks.SPI.BASE_URL+"/applicationlink/"+g.id;if(c){d+="?reciprocate=true"}return AppLinks.del(d,f,e)},makePrimary:function(e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/primary/"+e.id;return AppLinks.post(c,null,d)},relocate:function(h,f,c,g,e){var d=AppLinks.SPI.BASE_URL+"/relocateApplicationlink/"+h.id+"?newUrl="+encodeURIComponent(f)+"&nowarning="+(c?"true":"false");return AppLinks.post(d,null,g,e)},legacyUpgrade:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/upgrade/legacy/"+f.id;return AppLinks.post(c,null,e,d)},ualUpgrade:function(g,c,f,e){var d=AppLinks.SPI.BASE_URL+"/upgrade/ual/"+g.id;return AppLinks.post(d,c,f,e)},getEntityTypesForApplicationType:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/type/entity/"+f;return AppLinks.get(c,e,d)},getLocalEntitiesWithLinksToApplication:function(c,f,e){var d=AppLinks.SPI.BASE_URL+"/entitylink/localEntitiesWithLinksTo/"+c+".json";return AppLinks.get(d,f,e)},getEntityLinksForApplication:function(c,f,e){var d=AppLinks.SPI.BASE_URL+"/entities/"+c+".json";AppLinks.get(d,f,e)},getEntityLinksForApplicationUsingAnonymousAccess:function(c,f,e){var d=AppLinks.SPI.BASE_URL+"/entities/anonymous/"+c+".json";return AppLinks.get(d,f,e)},createNonUalEntityLink:function(l,g,d,f,j,e,k,i){var c=AppLinks.SPI.BASE_URL+"/entitylink/"+l+"/"+g+"?reciprocate=false";var h={applicationId:d,typeId:f,key:j,name:e,isPrimary:false};return AppLinks.put(c,h,k,i)},createEntityLink:function(h,g,d,c,i,f){var e=AppLinks.SPI.BASE_URL+"/entitylink/"+h+"/"+g+"?reciprocate=";e+=(c?"true":"false");return AppLinks.put(e,d,i,f)},getConfiguredEntityLinks:function(f,e,g,d){var c=AppLinks.SPI.BASE_URL+"/entitylink/primaryLinks/"+f+"/"+e+".json";return AppLinks.get(c,g,d)},deleteEntityLink:function(h,g,d,c,i,f){var e=AppLinks.SPI.BASE_URL+"/entitylink/"+h+"/"+g+"?typeId="+d.typeId+"&key="+d.key+"&applicationId="+d.applicationId+"&reciprocate="+c;return AppLinks.del(e,i,f)},makePrimaryEntityLink:function(g,f,c,h,e){var d=AppLinks.SPI.BASE_URL+"/entitylink/primary/"+g+"/"+f+"?typeId="+c.typeId+"&key="+c.key+"&applicationId="+c.applicationId;return AppLinks.post(d,null,h,e)},canDeleteAppLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/permission/reciprocate-application-delete/"+f;return AppLinks.get(c,e,d)},canDeleteEntityLink:function(g,f,c,h,e){var d=AppLinks.SPI.BASE_URL+"/permission/reciprocate-entity-delete/"+c.applicationId+"/"+g+"/"+f+"/"+c.typeId+"/"+c.key;return AppLinks.get(d,h,e)},canCreateReciprocateEntityLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/permission/reciprocate-entity-create/"+f;return AppLinks.get(c,e,d)},processPermissionCode:function(d){var c={noPermission:function(){},missing:function(){},credentialsRequired:function(e){},authenticationFailed:function(e){},noAuthentication:function(e){},noAuthenticationConfigured:function(){},noConnection:function(){},allowed:function(){},unrecognisedCode:function(e){},updateView:function(g,f,e){}};if(!d){d={}}d=b.extend(c,d);return function(f){var e=f.code;if(e=="NO_PERMISSION"){d.noPermission()}else{if(e=="MISSING"){d.missing()}else{if(e=="CREDENTIALS_REQUIRED"){d.credentialsRequired(f.url)}else{if(e=="AUTHENTICATION_FAILED"){d.authenticationFailed(f.url)}else{if(e=="NO_AUTHENTICATION"){d.noAuthentication(f.url)}else{if(e=="NO_AUTHENTICATION_CONFIGURED"){d.noAuthenticationConfigured()}else{if(e=="NO_CONNECTION"){d.noConnection()}else{if(e=="ALLOWED"){d.allowed()}else{d.unrecognisedCode(f.code)}}}}}}}}}},addAuthenticationTrigger:function(e,c,d){if(!d){d={}}if(typeof d.onSuccess=="undefined"){d.onSuccess=function(){location.reload()}}if(typeof d.onFailure=="undefined"){d.onFailure=function(){return true}}b(e).unbind("click");b(e).click(function(){if(d.before){d.before()}AppLinks.authenticateRemoteCredentials(c,d.onSuccess,d.onFailure)})},deleteOrphanedTrust:function(g,e,f,d){var c=AppLinks.SPI.BASE_URL+"/orphaned-trust/"+e+"/"+g;return AppLinks.del(c,f,d)},getOrphanedTrust:function(e,d){var c=AppLinks.SPI.BASE_URL+"/orphaned-trust/";return AppLinks.get(c,e,d)},showCreateEntityLinkSuggestion:function(){return true},getApplicationLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/"+f;return AppLinks.get(c,e,d)},createApplicationLink:function(f,d,i,j,c,k,g){var e=AppLinks.SPI.BASE_URL+"/applicationlink";var h={id:f,name:d,rpcUrl:i,displayUrl:j,typeId:c};return AppLinks.put(e,h,k,g)},createConsumer:function(e,n,d,m,i,l,g,p,h,k,o,f){var c=AppLinks.SPI.BASE_URL+"/applicationlink/"+e+"/authentication/consumer";var j={key:n,name:d,description:m,sharedSecret:i,publicKey:l,outgoing:k,twoLOAllowed:g,executingTwoLOUser:p,twoLOImpersonationAllowed:h};return AppLinks.put(c,j,o,f)},createConsumerAutoConfigure:function(j,i,f,c,h,e){var d=AppLinks.SPI.BASE_URL+"/applicationlink/"+j+"/authentication/consumer?autoConfigure=true";var g={twoLOAllowed:i,executingTwoLOUser:f,twoLOImpersonationAllowed:c};return AppLinks.put(d,g,h,e)},registerProvider:function(i,h,e,g,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/"+i+"/authentication/provider";var f={config:e,provider:h};return AppLinks.put(c,f,g,d)}},(window.AppLinks&&window.AppLinks.SPI)||{})});var a="applinks";AppLinks.UI={showInfoBox:function(c){b(".aui-message.success").remove();AppLinks.UI.createMessage("success",c,"page-info")},hideInfoBox:function(){b(".aui-message.success").remove()},showErrorBox:function(c){AppLinks.UI.createMessage("error",c,"page-error")},hideErrorBox:function(){b(".aui-message.error").remove()},showWarningBox:function(d){if(b.isArray(d)&&d.length>0){var c=b("<ul></ul>");b(d).each(function(f){c.append(b("<li/>",{text:d[f]}))});var e=b('<div class="page-warning"></div>').append(c);AppLinks.UI.createMessage("warning",e.html(),"page-warning")}else{AppLinks.UI.createMessage("warning",d,"page-warning")}},hideWarningBox:function(){b(".aui-message.warning").remove()},shortenString:function(d,c){if(d.length>c){d=d.substring(0,c)+"..."}return d},createMessage:function(d,e,c){var f=b('<div class="'+c+'">');f.html(e);AJS.messages[d](".applinks-message-bar",{title:"",body:f.wrap("<div></div>").parent().html(),closeable:true})},displayValidationErrorMessages:function(c,f,e){if(b.isArray(e)){b(e).each(function(j,h){var k=b('<div class="error applinks-error">');k.text(h);b(f).find("."+c).append(k)})}else{if(typeof e!="undefined"){var g=b('<div class="error applinks-error">');g.text(e.toString());b(f).find("."+c).append(g)}}},displayValidationError:function(c,d,e){return function(j){if(j.status==401){window.location.reload();return}b(".applinks-error").remove();b(".loading").remove();var h=j.responseText;var i=b.parseJSON(h);var g=i.message;if(typeof i.fields=="undefined"){AppLinks.UI.displayValidationErrorMessages(c,d,g)}else{var f=i.fields;b(f).each(function(k){var l=b('<div class="error applinks-error" id="'+f[k]+'-error">');l.text(g[k]);if(b(d).find("."+f[k]).length>0){l.insertAfter(b(d).find("."+f[k]))}else{l.insertAfter(b(d).find("."+c).append(l))}})}b(d).find("."+c).addClass("fully-populated-errors");if(e){e()}}},addProtocolToURL:function(c){var f=b.trim(c);var e=f.toLowerCase();var d=false;if(e.length>=7){if(e.substring(0,7).indexOf("http")!=-1){d=true}}if(!d){f="http://"+f}return f},prettyJoin:function(d,g,f){if(!f){f=AppLinks.I18n.getText("applinks.and")}var c=d.length;var e="";b.each(d,function(h,i){if(h==(c-1)&&c>1){e+=" "+f+"  "+g(i)}else{e+=g(i);if(h+2<c){e+=", "}}});return e},showLoadingIcon:function(c){b('<span class="loading">&nbsp;</span>').insertAfter(c)},hideLoadingIcon:function(c){b(c).next(".loading").remove()},findUrl:function(f){var e=undefined;var g=f.toLowerCase();var d=g.indexOf("http:");if(d==-1){d=g.indexOf("https:")}if(d>-1){var c=g.indexOf(" ",d);if(c==-1){c=g.length}e=f.substring(d,c)}return e},findApplicationType:function(c){c=c.toLowerCase();if(c.indexOf("jira")!=-1){return"jira"}else{if(c.indexOf("fisheye")!=-1){return"fecru"}else{if(c.indexOf("confluence")!=-1){return"confluence"}else{if(c.indexOf("refapp")!=-1){return"refapp"}else{return undefined}}}}},escapeSelector:function(c){return c.replace(/([#;&,\.\+\*\~':"\!\^$\[\]\(\)=>\|])/g,"\\$1")},sanitiseHTML:function(c){var d={"<":"&lt;",'"':"&quot;","&":"&amp;"};return c.replace(/[<"&]/g,function(e){return d[e]})},refreshOrphanedTrust:function(){var c=function(d){b("tr.orphaned-trust-row").each(function(){var j=b(this);var k=j.attr("data-id");var g=j.attr("data-type");var f=false;for(var e=0;e<d.orphanedTrust.length;e++){var h=d.orphanedTrust[e];if(k==h.id&&g==h.type){f=true;break}}if(!f){j.remove();if(d.orphanedTrust.length==0){b(".orphaned-trust-warning").hide()}}})};AppLinks.SPI.getOrphanedTrust(c)},removeCssClass:function(c,d){b(c).removeClass(function(f,h){var g=h.split(" ");var e="";b.each(g,function(i,j){if(j.indexOf(d)!=-1){e=j}});return e})}};(function(){var c=b({});b.each(["bind","unbind","trigger"],function(d,e){AppLinks.UI[e]=function(){return c[e].apply(c,arguments)}})})();AppLinks.I18n={interpolate:function(d,c){if(c){if(!b.isArray(c)){c=[new String(c)]}c.unshift(d);d=AJS.format.apply(AJS,c)}return d},getTextWithPrefix:function(c,d){return AppLinks.I18n.interpolate(appLinksI18n.entries[a+"."+c],d)},getText:function(c,d){return AppLinks.I18n.interpolate(AppLinks.I18n.resolveValue(c),d)},getApplicationTypeName:function(c){return appLinksI18n.entries["applinks.application.type."+c]},getEntityTypeName:function(c){return appLinksI18n.entries["applinks.entity.type."+c]},getPluralizedEntityTypeName:function(c){return appLinksI18n.entries["applinks.entity.type.plural."+c]},getAuthenticationTypeName:function(c){return appLinksI18n.entries["applinks.auth.provider."+c]},resolveValue:function(c){var d=appLinksI18n.entries[c];return typeof d=="undefined"?c:d}};AppLinks.Docs={createDocLink:function(d,e,c){if(!c){c=""}else{c=" "+c}return b("<a/>",{"class":"ual-help-link"+c,href:AppLinks.Docs.getDocHref(d,e),target:"_blank",text:AppLinks.I18n.getText("applinks.help"),title:AppLinks.I18n.getText("applinks.help")})},getDocHref:function(d,e){var c=AppLinks.Docs.resolveValue("applinks.docs.root")+"/"+AppLinks.Docs.resolveValue(d);if(e){c+="#"+AppLinks.Docs.resolveValue(e)}return c},resolveValue:function(c){var d=applinksDocs.entries[c];return typeof d=="undefined"?c:d}};b(document).trigger(AppLinks.Event.PREREADY);b(document).trigger(AppLinks.Event.READY)});
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/json2.js' */
if(!this.JSON){this.JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/autocomplete.js' */
AJS.$(document).bind(AppLinks.Event.READY,function(){AppLinks.autoComplete={cacheManager:function(c){var a={},b=[],c=c||30;return{get:function(d){return a[d]},put:function(d,e){a[d]=e;b.push(d);if(b.length>c){delete a[b.shift()]}},clear:function(){a={};b=[]}}}};(function(d){var c=function(f){AJS.log("InputDrivenDropDown: truncating text");var h=f.$.closest(".aui-dropdown").width(),g=20;d("a span:not(.icon)",f.$).each(function(){var j=d(this),i=AJS("var","&#8230;"),l=i.width(),k=false;j.wrapInner(d("<em>"));d("em",j).each(function(){var m=d(this);m.show();if(this.offsetLeft+this.offsetWidth>h){var t=this.childNodes,s=false;for(var o=t.length-1;o>=0;o--){var p=t[o],n=1,r=(p.nodeType==3)?"nodeValue":"innerHTML",q=p[r];do{if(n<=q.length){p[r]=q.substr(0,q.length-n++)}else{break}}while(this.offsetLeft+this.offsetWidth+l>h-g);if(n<=q.length){s=true;break}}if(s){k=true}else{m.hide()}}});if(k){j.append(i);this.elpss=i}})};var b=function(f,l){if(!l.length||!l[0]){return}AJS.log("InputDrivenDropDown: highlighting tokens");for(var h=0,j=l.length;h<j;h++){var g=l[h];l[h]=g?g.replace(/[\.\*\+\?\|\(\)\[\]{}\\]/g,"\\$"):""}var k=new RegExp("("+l.join("|")+")","gi");d("li a:not(.dropdown-prevent-highlight) span",f.$).each(function(){var m=d(this),i=m.html().replace(k,"<strong>$1</strong>");m.html(i)})};var e=function(j,g){var i=j.options,h=j.dd;if(h){h.hide();h.$.remove()}i.ajsDropDownOptions=i.ajsDropDownOptions||{};if(i.ajsDropDownOptions&&!i.ajsDropDownOptions.alignment){i.ajsDropDownOptions.alignment="left"}i.ajsDropDownOptions.selectionHandler=i.ajsDropDownOptions.selectionHandler||function(l,k){if(l.type!="click"){l.preventDefault();d("a",k).click();document.location=d("a",k).attr("href")}};i.ajsDropDownOptions.displayHandler=function(k){return AJS.escapeHtml(k.name)};var f=j.dd=new AJS.dropDown(g.matrix,i.ajsDropDownOptions)[0];if(i.ajsDropDownOptions&&i.ajsDropDownOptions.className){f.$.addClass(i.ajsDropDownOptions.className)}if(i.dropdownPlacement){i.dropdownPlacement(f.$)}else{AJS.log("No dropdownPlacement function specified. Appending dropdown to the body.");d("body").append(f.$)}b(f,g.queryTokens||[g.query]);c(f);if(i.dropdownPostprocess){i.dropdownPostprocess(f.$)}f.show(j._effect);if(typeof i.onShow=="function"){i.onShow.call(f,f.$)}return f};function a(g,f){this._effect="appear";this._timer=null;this.id=g;this.options=f;this.inactive=false;this.busy=false;this.cacheManager=AppLinks.autoComplete.cacheManager()}a.prototype.clearCache=function(){this.cacheManager.clear()};a.prototype.change=function(h,g){var f=this;if(h!=f._value||g){f._value=h;f.busy=false;clearTimeout(f._timer);if(g||(/\S{0,}/).test(h)){var i=f.cacheManager.get(h);if(i){e(f,i)}else{f.busy=true;f._timer=setTimeout(function(){f.options.getDataAndRunCallback.call(f,h,f.show)},200)}}else{f.dd&&f.dd.hide()}}};a.prototype.dropDownLength=function(){return this.dd.links?this.dd.links.length:0};a.prototype.dropDownItem=function(f){return this.dropDownLength()>f?this.dd.links[f]:null};a.prototype.hide=function(){this.dd&&this.dd.hide()};a.prototype.remove=function(){var f=this.dd;if(f){this.hide();f.$.remove()}this.inactive=true;this.options.onDeath&&this.options.onDeath()};a.prototype.show=function(g,i,h){if(this.inactive){AJS.log("Quick search abandoned before server response received, ignoring. "+this);return}var f={matrix:g,query:i,queryTokens:h};this.cacheManager.put(i,f);e(this,f);this.busy=false};AppLinks.inputDrivenDropdown=function(f){return new a("inputdriven-dropdown",f)}})(jQuery)});
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/wizard.js' */
AJS.$(document).bind(AppLinks.Event.PREREADY,function(){(function(d){d.fn.wizard=function(v){var u={width:500,height:350,onshow:function(w,x){return true},aftershow:function(){return true},oncancel:function(){return true},onsubmit:function(){return true},aftersubmit:function(){return true},onnext:function(){return true},onprevious:function(){return true},cancelLabel:AppLinks.I18n.getText("applinks.cancel"),submitLabel:AppLinks.I18n.getText("applinks.create"),nextLabel:AppLinks.I18n.getText("applinks.next"),previousLabel:AppLinks.I18n.getText("applinks.previous"),id:""};if(!v){v={}}v=d.extend(u,v);var t=this;this.each(function(){var D=d(this);var w=new AJS.Dialog(v.width,v.height,v.id);var L=q(w,v.onshow,v.aftershow);var K=c(w,v.oncancel);var z=h(w,v.onsubmit,v.aftersubmit);var M=a(w,v.onprevious);var I=m(w,v.onnext);var G=k(w);var B=o(w);var C=g(w);var H=l(w);var J=s(w);var E=n(w);if(v.showButtonId){d("#"+v.showButtonId).click(L)}var y=f(D);for(var A=0;A<y.length;A++){var F=y[A];j(w,F);if(F.className){w.addHeader(F.title,F.className+"-header")}else{w.addHeader(F.title)}if(A!=0&&d(F.div).attr("previous")!="false"){w.addButton(v.previousLabel,M,"applinks-previous-button")}if(A<y.length-1&&d(F.div).attr("submit")!="true"&&d(F.div).attr("next")!="false"){w.addButton(v.nextLabel,I,"applinks-next-button")}if(d(F.div).attr("submit")=="true"){w.addButton(v.submitLabel,z,"wizard-submit")}if(!w.getPage(A).buttonpanel){w.addButton("",null);d(w.getPage(A).buttonpanel).empty();var x=d('<a class="button-panel-button applinks-cancel-link">'+v.cancelLabel+"</a>");w.getPage(A).buttonpanel.append(x);x.click(K)}else{var x=d('<a class="button-panel-link button-panel-cancel-link applinks-cancel-link">'+v.cancelLabel+"</a>");d(w.getPage(A).buttonpanel).append(x);x.click(K)}if(A<y.length-1){w.addPage()}}t={dialog:w,nextPage:I,prevPage:M,submit:z,cancel:K,show:L,disableNextBtn:G,enableNextBtn:B,disableSubmitBtn:C,enableSubmitBtn:H,disablePreviousBtn:J,enablePreviousBtn:E};w.gotoPage(0);w.gotoPanel(0)});return t};function s(t){return function(){b(r(t,"applinks-previous-button"))}}function n(t){return function(){i(r(t,"applinks-previous-button"))}}function k(t){return function(){b(r(t,"applinks-next-button"))}}function o(t){return function(){i(r(t,"applinks-next-button"))}}function g(t){return function(v){var u=r(t,"wizard-submit");b(u);if(typeof(v)=="undefined"||v){d('<span class="loading">&nbsp;</span>').insertBefore(u)}else{u.parent().find(".loading").remove()}}}function l(t){return function(){var u=r(t,"wizard-submit");i(u);u.parent().find(".loading").remove()}}function r(u,t){return d(u.getPage(u.curpage).buttonpanel).find("."+t)}function p(t){d(t.popup.element).find("form").each(function(){this.reset()})}function i(t){t.attr("disabled",false)}function b(t){t.attr("disabled",true)}function q(t,u,v){return function(w){if(u(t,w)!==false){t.gotoPage(0);t.gotoPanel(0);d(document).unbind("keydown.ual.dialog");d(document).bind("keydown.ual.dialog",e(t));t.show();v()}}}function c(t,u){return function(){if(u(t)!==false){t.hide();p(t)}}}function a(t,u){return function(){if(u(t)!==false){t.prevPage()}}}function m(t,u){return function(){if(u(t)!==false){t.nextPage()}}}function e(t){return function(u){if(u.keyCode===27){p(t);d(document).unbind("keydown.ual.dialog")}}}function h(u,v,t){return function(){if(v(u)!==false){t(u);p(u)}}}function j(v,w){var u=d("> div[panel]",w.div);if(u.length>0){u.each(function(y,z){var x=v.addPanel(z.title,null,z.className,"menu-"+z.id);x.getCurrentPanel().body.append(u[y])})}else{var t=v.addPanel(w.title);t.getCurrentPanel().body.append(w.div)}}function f(v){var u=d(" > div",v);var t=[];u.each(function(x){var w=d(this);t[x]={title:w.attr("title")||null,className:w.attr("class"),div:w}});return t}})(jQuery)});
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/applinkwizard.js' */
(function(a){AppLinks.Wizard={getWizard:function(){return a("#create-application-link-container").data("wizard")},initAuthenticationUI:function(d){var h=a(d);var f=h.find(".create-reciprocal-link");var c=h.find(".ual-arrow");var l=h.find(".two-way-link-details");var j=h.find(".reciprocal-link-description");var b=h.find(".no-reciprocal-link-description");f.click(function(){if(f.is(":checked")){c.removeClass("no-background");l.show();j.show();b.hide()}else{c.addClass("no-background");l.hide();j.hide();b.show()}});var i=h.find(".same-user-radio-btn");var k=h.find(".different-user-radio-btn");var e=h.find(".different-userbase-image");var g=h.find(".same-userbase-image");i.click(function(){e.addClass("different-userbase-image-grey");g.removeClass("same-userbase-image-grey")});k.click(function(){g.addClass("same-userbase-image-grey");e.removeClass("different-userbase-image-grey")})},initNonUALUI:function(e){var c=a(e);var b=c.find(".application-types");for(var d=0;d<nonAppLinksApplicationTypes.length;d++){a('<option value="'+nonAppLinksApplicationTypes[d].typeId+'">'+nonAppLinksApplicationTypes[d].label+"</option>").appendTo(b)}},fetchManifest:function(e,h,d,b){var i=h.find("#application-url");if(i.val()==""){var c=h.find("#application-types");if(c.val()==""){a('<div class="error applinks-error">'+AppLinks.I18n.getText("applinks.error.url.field.empty")+"</div>").insertAfter(i);return false}var g=function(j){e.enableSubmitBtn();e.enablePreviousBtn();e.cancel();AppLinks.UI.listApplicationLinks(j.applicationLink.id,"new",j)};AppLinks.SPI.createStaticUrlAppLink(c.val(),g,null);return true}var f=AppLinks.UI.addProtocolToURL(i.val());AppLinks.UI.showLoadingIcon(i);var g=function(l){var k=l;e.enableNextBtn();h.find(".loading").remove();h.find(".reciprocal-rpc-url").val(a("#baseUrl").val());if(typeof l.typeId!="undefined"){AppLinks.Wizard.handleUALManifest(k,h);e.dialog.gotoPage(2);h.find(".reciprocal-link-username").focus();if(d){d(k)}}else{if(l.code=="applinks.warning.redirected.host"&&!i.data("hasWarnedAboutRedirection")){AppLinks.UI.displayValidationErrorMessages("manifest-validation-errors",h,l.warning);i.data("hasWarnedAboutRedirection","true");var m=function(){a(i).removeData("hasWarnedAboutRedirection");a(i).unbind("change",m)};i.bind("change",m)}else{if(l.code=="applinks.warning.unknown.host"&&!i.data("forceWhenHostIsOffline")){AppLinks.UI.displayValidationErrorMessages("manifest-validation-errors",h,l.warning);i.data("forceWhenHostIsOffline","true");var j=function(){a(i).removeData("forceWhenHostIsOffline");a(i).unbind("change",j)};i.bind("change",j)}else{if(k.code=="applinks.warning.unknown.host"||k.code=="applinks.warning.redirected.host"){delete k.warning;delete k.code}AppLinks.Wizard.handleNonUALManifest(k,f,h);e.dialog.gotoPage(1);h.find(".application-name").focus();if(b){b(k)}}}}};e.disableNextBtn();AppLinks.SPI.tryToFetchManifest(f,g,AppLinks.UI.displayValidationError("manifest-validation-errors",h,function(){e.enableNextBtn()}));return f},handleUALManifest:function(f,e){var c=a(e);c.find(".remote-app-image").removeClass(function(j,l){var k=l.split(" ");var i="";a.each(k,function(m,n){if(n.indexOf("application-type-image-")!=-1){i=n}});return i});c.find(".remote-app-image").addClass("application-type-image-"+f.typeId);c.find(".link-to-app-type").html(AppLinks.I18n.getText("applinks.create.title.link.to",AppLinks.I18n.getApplicationTypeName(f.typeId)));c.find(".remote-app-name").text(AppLinks.UI.shortenString(f.name,20));c.find(".create-reciprocal-link").attr("checked",true);c.find("#reciprocal-link-back-to-server").html(AppLinks.I18n.getText("applinks.create.link.back.to.server",AJS.escapeHtml(f.name)));var d=["administrator",AJS.escapeHtml(f.name),'<a target="_blank" href="'+AppLinks.Docs.getDocHref("applinks.docs.adding.application.link")+'">',"</a>"];var h=f.applinksVersion.split(".");var b=parseInt(h[0]);var g=parseInt(h[1]);if((f.typeId=="jira"||f.typeId=="confluence")&&(b==3&&g<10)){d[0]="system administrator"}c.find(".reciprocal-link-description").html(AppLinks.I18n.getText("applinks.create.two.way.link",d));c.find(".no-reciprocal-link-description").hide();c.find(".no-reciprocal-link-description").html(AppLinks.I18n.getText("applinks.create.two.way.no.link",AJS.escapeHtml(f.name)));c.find(".reciprocal-link-username").val("");c.find(".reciprocal-link-password").val("");c.find(".ual-arrow").removeClass("no-background");c.find(".two-way-link-details").show();c.find(".reciprocal-link-description").show();c.find(".no-reciprocal-link-description").hide()},handleNonUALManifest:function(d,e,c){var b=a(c);b.find(".application-name").val("");b.find(".application-types option:first-child").attr("selected","selected");b.find(".non-ual-application-url").text(e);if(d.warning){b.find(".create-non-ual-warning").show();b.find(".create-non-ual-warning").html(d.warning)}else{b.find(".create-non-ual-warning").hide()}},checkReciprocalLinkFormThreeStepMode:function(c,d,g,j,f){var h=a(c);if(h.find(".create-reciprocal-link").is(":checked")){var k=a.trim(h.find(".reciprocal-rpc-url").val());if(k==""){a("<div class='error applinks-error'>"+AppLinks.I18n.getText("applinks.error.url.field.empty")+"</div>").insertAfter(h.find(".reciprocal-rpc-url"));if(f){f()}return}var e=h.find(".reciprocal-link-username");var b=h.find(".reciprocal-link-password");if(e.val()==""){a('<div class="error applinks-error">'+AppLinks.I18n.getText("applinks.error.username.empty")+"</div>").insertAfter(e);if(f){f()}return false}var i=function(l){h.find(".same-user-description").find("input").attr("checked",true);h.find(".trust-radio-btn").attr("checked",true);h.find(".same-user-radio-btn").click();g(l)};k=AppLinks.UI.addProtocolToURL(k);AppLinks.SPI.verifyTwoWayLinkDetails(j,k,e.val(),b.val(),i,AppLinks.UI.displayValidationError("two-way-link-errors",c,f));return false}else{d();return false}},checkReciprocalLinkFormTwoStepMode:function(f,h,b,i){var c=a(f);var g=a.trim(c.find(".reciprocal-rpc-url").val());if(g==""){a("<div class='error applinks-error'>"+AppLinks.I18n.getText("applinks.error.url.field.empty")+"</div>").insertAfter(c.find(".reciprocal-rpc-url"));if(i){i()}return}var d=c.find(".reciprocal-link-username");var e=c.find(".reciprocal-link-password");if(d.val()==""){a('<div class="error applinks-error">'+AppLinks.I18n.getText("applinks.error.username.empty")+"</div>").insertAfter(d);if(i){i()}return false}g=AppLinks.UI.addProtocolToURL(g);AppLinks.SPI.verifyTwoWayLinkDetails(h,g,d.val(),e.val(),b,AppLinks.UI.displayValidationError("two-way-link-errors",f,i));return false}}})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-link-applinks-common-plugin:issue-link-applinks', location = 'js/issuelink-applinks.js' */
/**
 * Initialises anything requiring OAuth authentication. Requires the following elements:
 * <div class="issue-link-applinks-authentication-message"></div>
 */
var IssueLinkAppLinks = IssueLinkAppLinks || (function($) {
    function createHelper(servers, context, settings) {
        var helper = {};
        var selectedServer = null;

        function selectServer(appId) {
            selectedServer = getServer(servers, appId);

            var authenticationRequired = selectedServer && selectedServer.requireCredentials;
            doAuthenticationRequired(authenticationRequired, context);

            return {"authenticationRequired": authenticationRequired};
        }

        function setAuthenticationRequired(appId, authenticationRequired) {
            var server = getServer(servers, appId);
            if (server) {
                server.requireCredentials = authenticationRequired;

                // Refresh the authenication message if we have updated the selected server
                if (selectedServer && selectedServer.id === appId) {
                    doAuthenticationRequired(authenticationRequired, context);
                }
            }
        }

        function doAuthenticationRequired(required, context) {
            $(".issue-link-applinks-authentication-message", context).empty();
            if (required) {
                createAuthRequiredBanner($(".issue-link-applinks-authentication-message", context), context);
                $(".issue-link-oauth-toggle").hide();
                $(".buttons-container input[type=submit]", context).attr("disabled", "disabled")
            } else {
                $(".issue-link-oauth-toggle").show();
                $(".buttons-container input[type=submit]", context).removeAttr("disabled");
            }
        }

        function createAuthRequiredBanner($container, context) {
            var oauthCallbacks = {
                onSuccess: function () {
                    selectedServer.requireCredentials = false;
                    doAuthenticationRequired(false, context);
                    if (settings.onAuthenticationSuccessCallback) {
                        settings.onAuthenticationSuccessCallback(context, selectedServer.id, helper);
                    }
                },
                onFailure: function () {
                    if (settings.onAuthenticationFailedCallback) {
                        settings.onAuthenticationFailedCallback(context, selectedServer.id, helper);
                    }
                }
            };

            var encodedServerName = AJS.escapeHtml(selectedServer.name);
            if (selectedServer.authUrl) {
                var $banner = $('<div class="aui-message warning closeable shadowed applinks-auth-request"><p><span class="aui-icon icon-applinks-key"></span></p></div>');
                $banner.append(AJS.format("Authorization required to create issue link. Please \u003ca href=\"{0}\" class=\"applink-authenticate\">authenticate\u003c\/a> with \u003ca href=\"{1}\">{2}\u003c\/a>.", selectedServer.authUrl, selectedServer.url, encodedServerName));
                $("a", $banner).addClass("applink-authenticate");
                $('.applink-authenticate', $banner).click(function (e) {
                    authenticateRemoteCredentials(selectedServer.authUrl, oauthCallbacks.onSuccess, oauthCallbacks.onFailure);
                    e.preventDefault();
                });
                $container.append($banner);
            } else {
                var warningMessage = AJS.format("Unable to create a link to \u003ca href=\"{0}\">{1}\u003c\/a> as the application does not have any authentication configured.", selectedServer.url, encodedServerName);
                AJS.messages.warning($container, {body: warningMessage});
            }
        }

        function createOAuthCallback() {
            if (!AppLinks.OAuthCallback && typeof(oauthCallback) === "undefined") {
                AppLinks.OAuthCallback = function() {

                };

                AppLinks.OAuthCallback.prototype.success = function() {
                    this.aouthWindow.close();
                    this.onSuccess();
                    delete oauthCallback;
                    delete AppLinks.OAuthCallback;
                };

                AppLinks.OAuthCallback.prototype.failure = function() {
                    this.aouthWindow.close();
                    this.onFailure();
                    delete oauthCallback;
                    delete AppLinks.OAuthCallback;
                };

                AppLinks.OAuthCallback.prototype.show = function(url, onSuccess, onFailure) {
                    this.onSuccess = onSuccess;
                    this.onFailure = onFailure;
                    this.aouthWindow = window.open(url, "com_atlassian_applinks_authentication");
                };
                // set the global oAuthCallback variable required by AppLinks
                oauthCallback = new AppLinks.OAuthCallback();
            }
        }

        function authenticateRemoteCredentials(url, onSuccess, onFailure) {
            createOAuthCallback();

            $('.applinks-error').remove();
            oauthCallback.show(url, onSuccess, onFailure);
        }

        return $.extend(helper, {
            selectServer: selectServer,
            setAuthenticationRequired: setAuthenticationRequired
        });
    }

    function getServer(servers, appId) {
        var i;
        if (servers.length) {
            for (i = 0; i < servers.length; i++) {
                if (servers[i].id === appId) {
                    return servers[i];
                }
            }
        }
        return null;
    }

    /**
     * Called only once during the initialisation to retrieve the list of servers.
     *
     * @param context the context to perform the initialisation. This is either the inline dialog or the entire document
     *                body.
     */
    function initApplinkServers(settings, context, deferred) {
        var currentAppId = settings.getCurrentAppId(context);
        var applicationType = $(".issue-link-applinks-application-type", context).val();
        $.get(AJS.contextPath() + '/rest/issueLinkAppLink/1/appLink/info?type=' + applicationType, function (servers) {
            var helper = createHelper(servers, context, settings);
            var currentRequiresCredentials;
            if (servers && servers.length) {
                var currentServer = getServer(servers, currentAppId);
                if (currentServer) {
                    currentRequiresCredentials = $(".issue-link-applinks-authentication-message", context).hasClass("required");
                    if (currentRequiresCredentials) {
                        currentServer.requireCredentials = true;
                    }
                    helper.selectServer(currentAppId);
                }
                deferred.resolve(context, helper);
            } else {
                deferred.reject(context);
            }
        });
    }

    /**
     * @return jQuery.Promise<String>
     */
    function init(settings, context) {
        var deferred = $.Deferred();

        var isIssueLinkAppLinkContent = $(".issue-link-applinks-authentication-message", context).length !== 0;
        if (isIssueLinkAppLinkContent && settings.shouldExecute(context)) {
            initApplinkServers(settings, context, deferred);
        }

        return deferred.promise();
    }

    return {
        init: init
    };
})(AJS.$);

/* module-key = 'com.atlassian.jira.jira-issue-link-remote-jira-plugin:issue-link-remote-jira-js', location = 'js/issuelink-jira.js' */
/**
 * Initialises OAuth authentication for JIRA Application Links. Requires the following elements:
 * <div class="issue-link-applinks-authentication-message"></div>
 */
(function ($) {

    var settings = {
        getCurrentAppId: function (context) {
            return $("#jira-app-link", context).val();
        },
        shouldExecute: function (context) {
            return $("#jira-app-link", context).length !== 0;
        }
    };

    var updateIssuePicker = function($select, appId) {
        if ($select.length) {
            // Update the appId param
            $select.attr("data-ajax-options.data.app-id", appId);
            if (appId && appId !== "") {
                // Set the url for remote JIRA queries
                $select.attr("data-ajax-options.url", contextPath + "/rest/remoteJiraIssueLink/1/remoteJira/picker");
            }
            else {
                // Set the url for local JIRA queries
                $select.attr("data-ajax-options.url", contextPath + "/rest/api/1.0/issues/picker");
            }
        
            $select.trigger("updateOptions");

            // Now that we have changed server, our current issue selection is no longer relevant
            $select.trigger("clearSelection");
        }
    };

    var updateCreateReciprocalCheckbox = function(appId, context) {
        var $reciprocalCheckbox = $("#create-reciprocal", context);
        if ($reciprocalCheckbox.length) {
            if (appId && appId !== "") {
                // Get default choice for creating a remote reciprocal link
                var defaultChoice = ($("#create-reciprocal-default", context).val() == "true");
                if (defaultChoice) {
                    $reciprocalCheckbox.attr("checked", "checked");
                } else {
                    $reciprocalCheckbox.removeAttr("checked");
                }
                $reciprocalCheckbox.removeAttr("disabled");
                $("#create-reciprocal-fieldset", context).removeClass("disabled");
            } else {
                // Set to checked for local links, as they always create a reciprocal link
                $reciprocalCheckbox.attr("checked", "checked");
                $reciprocalCheckbox.attr("disabled", "disabled");
                $("#create-reciprocal-fieldset", context).addClass("disabled");
            }
        }
    };

    JIRA.bind(JIRA.Events.NEW_PAGE_ADDED, function (e, context) {

        var $select = $("#jira-issue-keys", context);
        if ($select.length) {
            var appId = $("#jira-app-link", context).val();
            updateIssuePicker($select, appId);
            updateCreateReciprocalCheckbox(appId, context);
        }

        IssueLinkAppLinks.init(settings, context).done(function (context, helper) {
            $("#jira-app-link", context).change(function () {
                var appId = $(this).val();
                helper.selectServer(appId);
                updateIssuePicker($select, appId);
                updateCreateReciprocalCheckbox(appId, context);
            });
        });
    });
})(AJS.$);

AJS.keys = { "shortcuts": [{ "moduleKey": "navigator.view.issue", "keys": [["o"]], "context": "issuenavigation", "op": "execute", "param": "jira.app.issuenavigator.shortcuts.viewSelectedIssue();" }, { "moduleKey": "go-to-dashboard-kb-shortcut", "keys": [["g", "d"]], "context": "global", "op": "goTo", "param": "/secure/Dashboard.jspa" }, { "moduleKey": "edit.issue", "keys": [["e"]], "context": "issueaction", "op": "click", "param": ".issueaction-edit-issue" }, { "moduleKey": "browse-project-kb-shortcut", "keys": [["g", "p"]], "context": "global", "op": "execute", "param": "var elem = jQuery(\"#browse_link\");\n                if (elem.length > 0) {\n                    window.location.href = elem.attr(\"href\");\n                }" }, { "moduleKey": "next.issue", "keys": [["j"]], "context": "issuenavigation", "op": "evaluate", "param": "if(AJS.$(\".standalone-viewissue\").length > 0) {\n                    this.followLink(\"#next-issue\");\n                } else {\n                    this.execute(function () {\n                        jira.app.issuenavigator.shortcuts.selectNextIssue();\n                    });\n                }" }, { "moduleKey": "greenhopper-gh-shortcut", "keys": [["g", "h"]], "context": "global", "op": "execute", "param": "gh.app.globalkeyboardshortcuts.goToAgile();" }, { "moduleKey": "assign.issue", "keys": [["a"]], "context": "issueaction", "op": "click", "param": ".issueaction-assign-issue" }, { "moduleKey": "greenhopper-agile-shortcut", "keys": [["g", "a"]], "context": "global", "op": "execute", "param": "gh.app.globalkeyboardshortcuts.goToAgile();" }, { "moduleKey": "prev.issue", "keys": [["k"]], "context": "issuenavigation", "op": "evaluate", "param": "if(AJS.$(\".standalone-viewissue\").length > 0) {\n                    this.followLink(\"#previous-issue\");\n                } else {\n                    this.execute(function () {\n                        jira.app.issuenavigator.shortcuts.selectPreviousIssue();\n                    });\n                }" }, { "moduleKey": "issue-navigator-kb-shortcut", "keys": [["g", "i"]], "context": "global", "op": "execute", "param": "var elem = jQuery(\"#find_link\");\n                if (elem.length > 0) {\n                    window.location.href = elem.attr(\"href\");\n                }" }, { "moduleKey": "comment.issue", "keys": [["m"]], "context": "issueaction", "op": "execute", "param": "JIRA.Issue.invokeCommentTrigger();" }, { "moduleKey": "admin.quicksearch.dialog.shortcut", "keys": [["g", "g"]], "context": "global", "op": "execute", "param": "if (AJS.Meta.get('admin-quicksearch-show')) {\n              JIRA.Shifter.show('admin');\n            }" }, { "moduleKey": "tempo.keyboard.shortcut.global.goto.tempo", "keys": [["g", "t"]], "context": "global", "op": "followLink", "param": "#tempo_menu" }, { "moduleKey": "label.issue", "keys": [["l"]], "context": "issueaction", "op": "click", "param": "#edit-labels" }, { "moduleKey": "quicksearch", "keys": [["/"]], "context": "global", "op": "moveToAndFocus", "param": "#quickSearchInput, #admin-quick-nav-field" }, { "moduleKey": "toggle.filter.panel", "keys": [["["]], "context": "issuenavigation", "op": "execute", "param": "if (JIRA.Issues && JIRA.Issues.Api.toggleFilterPanel) {\n                    JIRA.Issues.Api.toggleFilterPanel();\n                }" }, { "moduleKey": "move.to.next.action.item", "keys": [["n"]], "context": "issuenavigation", "op": "moveToNextItem", "param": ".issue-data-block:visible" }, { "moduleKey": "shifter", "keys": [["."]], "context": "global", "op": "execute", "param": "JIRA.Shifter.show();" }, { "moduleKey": "create.issue", "keys": [["c"]], "context": "global", "op": "moveToAndClick", "param": "#header .create-issue" }, { "moduleKey": "focus.shifter", "keys": [[","]], "context": "issueaction", "op": "execute", "param": "if (JIRA.Issues && JIRA.Issues.Api.openFocusShifter) {\n                    JIRA.Issues.Api.openFocusShifter();\n                }" }, { "moduleKey": "navigator.focus.search", "keys": [["f"]], "context": "issuenavigation", "op": "execute", "param": "jira.app.issuenavigator.shortcuts.focusSearch();" }, { "moduleKey": "navigate.up", "keys": [["u"]], "context": "issuenavigation", "op": "execute", "param": "if (JIRA.Issues && JIRA.Issues.Api.returnToSearch) {\n                    JIRA.Issues.Api.returnToSearch();\n                } else {\n                    this.followLink(\"link[rel=index]:first\");\n                    this._executer();\n                }" }, { "moduleKey": "assign.issue.self", "keys": [["i"]], "context": "issuenavigation", "op": "click", "param": ".issueaction-assign-to-me" }, { "moduleKey": "tempo.keyboard.shortcut.selected.issue.log_work", "keys": [["w"]], "context": "issueaction", "op": "execute", "param": "tempo.shortcutOpenDialog({});" }, { "moduleKey": "splitview.orderby", "keys": [["z"]], "context": "issuenavigation", "op": "click", "param": ".split-view .order-options" }, { "moduleKey": "tempo.keyboard.shortcut.global.log_work", "keys": [["t"]], "context": "global", "op": "execute", "param": "if (JIRA.Issues && JIRA.Issues.Api && JIRA.Issues.Api.switchLayouts &&\n                    JIRA.Issues.Api.isQueryValid && JIRA.Issues.Api.isQueryValid() &&\n                    JIRA.Issues.Api.isFullScreenIssueVisible && !JIRA.Issues.Api.isFullScreenIssueVisible() ) {\n                    JIRA.Issues.Api.switchLayouts(); // copied from issue-nav-plugin\n                } else {\n                    tempo.shortcutOpenDialog({});\n                }" }, { "moduleKey": "tempo.keyboard.shortcut.global.plan_time", "keys": [["p"]], "context": "global", "op": "execute", "param": "tempo.shortcutOpenDialog({planning: true});" }, { "moduleKey": "help", "keys": [["?"]], "context": "global", "op": "click", "param": "#keyshortscuthelp" }] };