if (!yasoon.outlook.mail) {  yasoon.outlook.mail = {registerRenderer: function(name,cbkObj) { native function registerRenderer();return registerRenderer(name,cbkObj);},showEmail: function(entryId,storeEntryId) { native function showEmail();return showEmail(entryId,storeEntryId);},get: function(entryId,storeEntryId) { native function get();return new Promise(function(resolve, reject) {get(entryId,storeEntryId, resolve, reject);});},showConversation: function(convSubject) { native function showConversation();return showConversation(convSubject);},renderSelection: function(mail,format) { native function renderSelection();return new Promise(function(resolve, reject) {renderSelection(mail,format, resolve, reject);});},renderBody: function(mail,format) { native function renderBody();return new Promise(function(resolve, reject) {renderBody(mail,format, resolve, reject);});},send: function(to,content) { native function send();return send(to,content);},getConversationData: function(caller) { native function getConversationData();return getConversationData(caller);},setConversationData: function(caller,data) { native function setConversationData();return setConversationData(caller,data);}, on: function( eventName, func ) { native function on(); return on(eventName, func); } , new: function( func ) { yasoon.outlook.mail.on( 'new', func); }}; }